(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function a(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(o){if(o.ep)return;o.ep=!0;const u=a(o);fetch(o.href,u)}})();function bf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Xc={exports:{}},ol={};var Vh;function fv(){if(Vh)return ol;Vh=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(s,o,u){var f=null;if(u!==void 0&&(f=""+u),o.key!==void 0&&(f=""+o.key),"key"in o){u={};for(var h in o)h!=="key"&&(u[h]=o[h])}else u=o;return o=u.ref,{$$typeof:r,type:s,key:f,ref:o!==void 0?o:null,props:u}}return ol.Fragment=t,ol.jsx=a,ol.jsxs=a,ol}var qh;function dv(){return qh||(qh=1,Xc.exports=fv()),Xc.exports}var m=dv(),Zc={exports:{}},Ve={};var Xh;function pv(){if(Xh)return Ve;Xh=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function y(N){return N===null||typeof N!="object"?null:(N=x&&N[x]||N["@@iterator"],typeof N=="function"?N:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,T={};function R(N,V,oe){this.props=N,this.context=V,this.refs=T,this.updater=oe||S}R.prototype.isReactComponent={},R.prototype.setState=function(N,V){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,V,"setState")},R.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function j(){}j.prototype=R.prototype;function M(N,V,oe){this.props=N,this.context=V,this.refs=T,this.updater=oe||S}var D=M.prototype=new j;D.constructor=M,E(D,R.prototype),D.isPureReactComponent=!0;var I=Array.isArray,P={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function ie(N,V,oe,W,z,be){return oe=be.ref,{$$typeof:r,type:N,key:V,ref:oe!==void 0?oe:null,props:be}}function se(N,V){return ie(N.type,V,void 0,void 0,void 0,N.props)}function de(N){return typeof N=="object"&&N!==null&&N.$$typeof===r}function ne(N){var V={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(oe){return V[oe]})}var Z=/\/+/g;function ee(N,V){return typeof N=="object"&&N!==null&&N.key!=null?ne(""+N.key):V.toString(36)}function ae(){}function $(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(ae,ae):(N.status="pending",N.then(function(V){N.status==="pending"&&(N.status="fulfilled",N.value=V)},function(V){N.status==="pending"&&(N.status="rejected",N.reason=V)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function re(N,V,oe,W,z){var be=typeof N;(be==="undefined"||be==="boolean")&&(N=null);var ge=!1;if(N===null)ge=!0;else switch(be){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(N.$$typeof){case r:case t:ge=!0;break;case v:return ge=N._init,re(ge(N._payload),V,oe,W,z)}}if(ge)return z=z(N),ge=W===""?"."+ee(N,0):W,I(z)?(oe="",ge!=null&&(oe=ge.replace(Z,"$&/")+"/"),re(z,V,oe,"",function(Lt){return Lt})):z!=null&&(de(z)&&(z=se(z,oe+(z.key==null||N&&N.key===z.key?"":(""+z.key).replace(Z,"$&/")+"/")+ge)),V.push(z)),1;ge=0;var xe=W===""?".":W+":";if(I(N))for(var He=0;He<N.length;He++)W=N[He],be=xe+ee(W,He),ge+=re(W,V,oe,be,z);else if(He=y(N),typeof He=="function")for(N=He.call(N),He=0;!(W=N.next()).done;)W=W.value,be=xe+ee(W,He++),ge+=re(W,V,oe,be,z);else if(be==="object"){if(typeof N.then=="function")return re($(N),V,oe,W,z);throw V=String(N),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return ge}function B(N,V,oe){if(N==null)return N;var W=[],z=0;return re(N,W,"","",function(be){return V.call(oe,be,z++)}),W}function U(N){if(N._status===-1){var V=N._result;V=V(),V.then(function(oe){(N._status===0||N._status===-1)&&(N._status=1,N._result=oe)},function(oe){(N._status===0||N._status===-1)&&(N._status=2,N._result=oe)}),N._status===-1&&(N._status=0,N._result=V)}if(N._status===1)return N._result.default;throw N._result}var le=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function ve(){}return Ve.Children={map:B,forEach:function(N,V,oe){B(N,function(){V.apply(this,arguments)},oe)},count:function(N){var V=0;return B(N,function(){V++}),V},toArray:function(N){return B(N,function(V){return V})||[]},only:function(N){if(!de(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Ve.Component=R,Ve.Fragment=a,Ve.Profiler=o,Ve.PureComponent=M,Ve.StrictMode=s,Ve.Suspense=d,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(N){return P.H.useMemoCache(N)}},Ve.cache=function(N){return function(){return N.apply(null,arguments)}},Ve.cloneElement=function(N,V,oe){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var W=E({},N.props),z=N.key,be=void 0;if(V!=null)for(ge in V.ref!==void 0&&(be=void 0),V.key!==void 0&&(z=""+V.key),V)!H.call(V,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&V.ref===void 0||(W[ge]=V[ge]);var ge=arguments.length-2;if(ge===1)W.children=oe;else if(1<ge){for(var xe=Array(ge),He=0;He<ge;He++)xe[He]=arguments[He+2];W.children=xe}return ie(N.type,z,void 0,void 0,be,W)},Ve.createContext=function(N){return N={$$typeof:f,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:u,_context:N},N},Ve.createElement=function(N,V,oe){var W,z={},be=null;if(V!=null)for(W in V.key!==void 0&&(be=""+V.key),V)H.call(V,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(z[W]=V[W]);var ge=arguments.length-2;if(ge===1)z.children=oe;else if(1<ge){for(var xe=Array(ge),He=0;He<ge;He++)xe[He]=arguments[He+2];z.children=xe}if(N&&N.defaultProps)for(W in ge=N.defaultProps,ge)z[W]===void 0&&(z[W]=ge[W]);return ie(N,be,void 0,void 0,null,z)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(N){return{$$typeof:h,render:N}},Ve.isValidElement=de,Ve.lazy=function(N){return{$$typeof:v,_payload:{_status:-1,_result:N},_init:U}},Ve.memo=function(N,V){return{$$typeof:g,type:N,compare:V===void 0?null:V}},Ve.startTransition=function(N){var V=P.T,oe={};P.T=oe;try{var W=N(),z=P.S;z!==null&&z(oe,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(ve,le)}catch(be){le(be)}finally{P.T=V}},Ve.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Ve.use=function(N){return P.H.use(N)},Ve.useActionState=function(N,V,oe){return P.H.useActionState(N,V,oe)},Ve.useCallback=function(N,V){return P.H.useCallback(N,V)},Ve.useContext=function(N){return P.H.useContext(N)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(N,V){return P.H.useDeferredValue(N,V)},Ve.useEffect=function(N,V,oe){var W=P.H;if(typeof oe=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(N,V)},Ve.useId=function(){return P.H.useId()},Ve.useImperativeHandle=function(N,V,oe){return P.H.useImperativeHandle(N,V,oe)},Ve.useInsertionEffect=function(N,V){return P.H.useInsertionEffect(N,V)},Ve.useLayoutEffect=function(N,V){return P.H.useLayoutEffect(N,V)},Ve.useMemo=function(N,V){return P.H.useMemo(N,V)},Ve.useOptimistic=function(N,V){return P.H.useOptimistic(N,V)},Ve.useReducer=function(N,V,oe){return P.H.useReducer(N,V,oe)},Ve.useRef=function(N){return P.H.useRef(N)},Ve.useState=function(N){return P.H.useState(N)},Ve.useSyncExternalStore=function(N,V,oe){return P.H.useSyncExternalStore(N,V,oe)},Ve.useTransition=function(){return P.H.useTransition()},Ve.version="19.1.1",Ve}var Zh;function xf(){return Zh||(Zh=1,Zc.exports=pv()),Zc.exports}var C=xf();const Pr=bf(C);var Qc={exports:{}},ul={},Kc={exports:{}},Wc={};var Qh;function hv(){return Qh||(Qh=1,(function(r){function t(B,U){var le=B.length;B.push(U);e:for(;0<le;){var ve=le-1>>>1,N=B[ve];if(0<o(N,U))B[ve]=U,B[le]=N,le=ve;else break e}}function a(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var U=B[0],le=B.pop();if(le!==U){B[0]=le;e:for(var ve=0,N=B.length,V=N>>>1;ve<V;){var oe=2*(ve+1)-1,W=B[oe],z=oe+1,be=B[z];if(0>o(W,le))z<N&&0>o(be,W)?(B[ve]=be,B[z]=le,ve=z):(B[ve]=W,B[oe]=le,ve=oe);else if(z<N&&0>o(be,le))B[ve]=be,B[z]=le,ve=z;else break e}}return U}function o(B,U){var le=B.sortIndex-U.sortIndex;return le!==0?le:B.id-U.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;r.unstable_now=function(){return u.now()}}else{var f=Date,h=f.now();r.unstable_now=function(){return f.now()-h}}var d=[],g=[],v=1,x=null,y=3,S=!1,E=!1,T=!1,R=!1,j=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function I(B){for(var U=a(g);U!==null;){if(U.callback===null)s(g);else if(U.startTime<=B)s(g),U.sortIndex=U.expirationTime,t(d,U);else break;U=a(g)}}function P(B){if(T=!1,I(B),!E)if(a(d)!==null)E=!0,H||(H=!0,ee());else{var U=a(g);U!==null&&re(P,U.startTime-B)}}var H=!1,ie=-1,se=5,de=-1;function ne(){return R?!0:!(r.unstable_now()-de<se)}function Z(){if(R=!1,H){var B=r.unstable_now();de=B;var U=!0;try{e:{E=!1,T&&(T=!1,M(ie),ie=-1),S=!0;var le=y;try{t:{for(I(B),x=a(d);x!==null&&!(x.expirationTime>B&&ne());){var ve=x.callback;if(typeof ve=="function"){x.callback=null,y=x.priorityLevel;var N=ve(x.expirationTime<=B);if(B=r.unstable_now(),typeof N=="function"){x.callback=N,I(B),U=!0;break t}x===a(d)&&s(d),I(B)}else s(d);x=a(d)}if(x!==null)U=!0;else{var V=a(g);V!==null&&re(P,V.startTime-B),U=!1}}break e}finally{x=null,y=le,S=!1}U=void 0}}finally{U?ee():H=!1}}}var ee;if(typeof D=="function")ee=function(){D(Z)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,$=ae.port2;ae.port1.onmessage=Z,ee=function(){$.postMessage(null)}}else ee=function(){j(Z,0)};function re(B,U){ie=j(function(){B(r.unstable_now())},U)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(B){B.callback=null},r.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<B?Math.floor(1e3/B):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_next=function(B){switch(y){case 1:case 2:case 3:var U=3;break;default:U=y}var le=y;y=U;try{return B()}finally{y=le}},r.unstable_requestPaint=function(){R=!0},r.unstable_runWithPriority=function(B,U){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var le=y;y=B;try{return U()}finally{y=le}},r.unstable_scheduleCallback=function(B,U,le){var ve=r.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?ve+le:ve):le=ve,B){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=le+N,B={id:v++,callback:U,priorityLevel:B,startTime:le,expirationTime:N,sortIndex:-1},le>ve?(B.sortIndex=le,t(g,B),a(d)===null&&B===a(g)&&(T?(M(ie),ie=-1):T=!0,re(P,le-ve))):(B.sortIndex=N,t(d,B),E||S||(E=!0,H||(H=!0,ee()))),B},r.unstable_shouldYield=ne,r.unstable_wrapCallback=function(B){var U=y;return function(){var le=y;y=U;try{return B.apply(this,arguments)}finally{y=le}}}})(Wc)),Wc}var Kh;function mv(){return Kh||(Kh=1,Kc.exports=hv()),Kc.exports}var $c={exports:{}},cn={};var Wh;function gv(){if(Wh)return cn;Wh=1;var r=xf();function t(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(t(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(d,g,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:x==null?null:""+x,children:d,containerInfo:g,implementation:v}}var f=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,g){if(d==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,cn.createPortal=function(d,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(t(299));return u(d,g,null,v)},cn.flushSync=function(d){var g=f.T,v=s.p;try{if(f.T=null,s.p=2,d)return d()}finally{f.T=g,s.p=v,s.d.f()}},cn.preconnect=function(d,g){typeof d=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,s.d.C(d,g))},cn.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},cn.preinit=function(d,g){if(typeof d=="string"&&g&&typeof g.as=="string"){var v=g.as,x=h(v,g.crossOrigin),y=typeof g.integrity=="string"?g.integrity:void 0,S=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;v==="style"?s.d.S(d,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:S}):v==="script"&&s.d.X(d,{crossOrigin:x,integrity:y,fetchPriority:S,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},cn.preinitModule=function(d,g){if(typeof d=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var v=h(g.as,g.crossOrigin);s.d.M(d,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&s.d.M(d)},cn.preload=function(d,g){if(typeof d=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var v=g.as,x=h(v,g.crossOrigin);s.d.L(d,v,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},cn.preloadModule=function(d,g){if(typeof d=="string")if(g){var v=h(g.as,g.crossOrigin);s.d.m(d,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else s.d.m(d)},cn.requestFormReset=function(d){s.d.r(d)},cn.unstable_batchedUpdates=function(d,g){return d(g)},cn.useFormState=function(d,g,v){return f.H.useFormState(d,g,v)},cn.useFormStatus=function(){return f.H.useHostTransitionStatus()},cn.version="19.1.1",cn}var $h;function q0(){if($h)return $c.exports;$h=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),$c.exports=gv(),$c.exports}var Jh;function vv(){if(Jh)return ul;Jh=1;var r=mv(),t=xf(),a=q0();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function f(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(u(e)!==e)throw Error(s(188))}function d(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(s(188));return n!==e?null:e}for(var i=e,l=n;;){var c=i.return;if(c===null)break;var p=c.alternate;if(p===null){if(l=c.return,l!==null){i=l;continue}break}if(c.child===p.child){for(p=c.child;p;){if(p===i)return h(c),e;if(p===l)return h(c),n;p=p.sibling}throw Error(s(188))}if(i.return!==l.return)i=c,l=p;else{for(var b=!1,A=c.child;A;){if(A===i){b=!0,i=c,l=p;break}if(A===l){b=!0,l=c,i=p;break}A=A.sibling}if(!b){for(A=p.child;A;){if(A===i){b=!0,i=p,l=c;break}if(A===l){b=!0,l=p,i=c;break}A=A.sibling}if(!b)throw Error(s(189))}}if(i.alternate!==l)throw Error(s(190))}if(i.tag!==3)throw Error(s(188));return i.stateNode.current===i?e:n}function g(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=g(e),n!==null)return n;e=e.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),D=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),de=Symbol.for("react.activity"),ne=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function ee(e){return e===null||typeof e!="object"?null:(e=Z&&e[Z]||e["@@iterator"],typeof e=="function"?e:null)}var ae=Symbol.for("react.client.reference");function $(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ae?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case E:return"Fragment";case R:return"Profiler";case T:return"StrictMode";case P:return"Suspense";case H:return"SuspenseList";case de:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case S:return"Portal";case D:return(e.displayName||"Context")+".Provider";case M:return(e._context.displayName||"Context")+".Consumer";case I:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ie:return n=e.displayName||null,n!==null?n:$(e.type)||"Memo";case se:n=e._payload,e=e._init;try{return $(e(n))}catch{}}return null}var re=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},ve=[],N=-1;function V(e){return{current:e}}function oe(e){0>N||(e.current=ve[N],ve[N]=null,N--)}function W(e,n){N++,ve[N]=e.current,e.current=n}var z=V(null),be=V(null),ge=V(null),xe=V(null);function He(e,n){switch(W(ge,n),W(be,e),W(z,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?bh(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=bh(n),e=xh(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}oe(z),W(z,e)}function Lt(){oe(z),oe(be),oe(ge)}function Kt(e){e.memoizedState!==null&&W(xe,e);var n=z.current,i=xh(n,e.type);n!==i&&(W(be,e),W(z,i))}function Cn(e){be.current===e&&(oe(z),oe(be)),xe.current===e&&(oe(xe),al._currentValue=le)}var sn=Object.prototype.hasOwnProperty,_a=r.unstable_scheduleCallback,vn=r.unstable_cancelCallback,zn=r.unstable_shouldYield,Oa=r.unstable_requestPaint,et=r.unstable_now,Ne=r.unstable_getCurrentPriorityLevel,We=r.unstable_ImmediatePriority,Wt=r.unstable_UserBlockingPriority,ia=r.unstable_NormalPriority,$t=r.unstable_LowPriority,$o=r.unstable_IdlePriority,sa=r.log,cs=r.unstable_setDisableYieldValue,Hn=null,Mt=null;function ln(e){if(typeof sa=="function"&&cs(e),Mt&&typeof Mt.setStrictMode=="function")try{Mt.setStrictMode(Hn,e)}catch{}}var St=Math.clz32?Math.clz32:Jo,ka=Math.log,xa=Math.LN2;function Jo(e){return e>>>=0,e===0?32:31-(ka(e)/xa|0)|0}var vi=256,dt=4194304;function Jt(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Mn(e,n,i){var l=e.pendingLanes;if(l===0)return 0;var c=0,p=e.suspendedLanes,b=e.pingedLanes;e=e.warmLanes;var A=l&134217727;return A!==0?(l=A&~p,l!==0?c=Jt(l):(b&=A,b!==0?c=Jt(b):i||(i=A&~e,i!==0&&(c=Jt(i))))):(A=l&~p,A!==0?c=Jt(A):b!==0?c=Jt(b):i||(i=l&~e,i!==0&&(c=Jt(i)))),c===0?0:n!==0&&n!==c&&(n&p)===0&&(p=c&-c,i=n&-n,p>=i||p===32&&(i&4194048)!==0)?n:c}function yi(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function _f(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fs(){var e=vi;return vi<<=1,(vi&4194048)===0&&(vi=256),e}function Yr(){var e=dt;return dt<<=1,(dt&62914560)===0&&(dt=4194304),e}function on(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function Nn(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function yn(e,n,i,l,c,p){var b=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var A=e.entanglements,O=e.expirationTimes,X=e.hiddenUpdates;for(i=b&~i;0<i;){var ue=31-St(i),pe=1<<ue;A[ue]=0,O[ue]=-1;var Q=X[ue];if(Q!==null)for(X[ue]=null,ue=0;ue<Q.length;ue++){var K=Q[ue];K!==null&&(K.lane&=-536870913)}i&=~pe}l!==0&&Nt(e,l,0),p!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=p&~(b&~n))}function Nt(e,n,i){e.pendingLanes|=n,e.suspendedLanes&=~n;var l=31-St(n);e.entangledLanes|=n,e.entanglements[l]=e.entanglements[l]|1073741824|i&4194090}function Yn(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-St(i),c=1<<l;c&n|e[l]&n&&(e[l]|=n),i&=~c}}function bn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Vr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ds(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:jh(e.type))}function El(e,n){var i=U.p;try{return U.p=e,n()}finally{U.p=i}}var la=Math.random().toString(36).slice(2),Ft="__reactFiber$"+la,en="__reactProps$"+la,Sa="__reactContainer$"+la,bi="__reactEvents$"+la,xi="__reactListeners$"+la,Al="__reactHandles$"+la,Si="__reactResources$"+la,Rn="__reactMarker$"+la;function Ei(e){delete e[Ft],delete e[en],delete e[bi],delete e[xi],delete e[Al]}function xn(e){var n=e[Ft];if(n)return n;for(var i=e.parentNode;i;){if(n=i[Sa]||i[Ft]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Th(e);e!==null;){if(i=e[Ft])return i;e=Th(e)}return n}e=i,i=e.parentNode}return null}function Ea(e){if(e=e[Ft]||e[Sa]){var n=e.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return e}return null}function qr(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function La(e){var n=e[Si];return n||(n=e[Si]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function bt(e){e[Rn]=!0}var Ai=new Set,Xr={};function Vn(e,n){Sn(e,n),Sn(e+"Capture",n)}function Sn(e,n){for(Xr[e]=n,e=0;e<n.length;e++)Ai.add(n[e])}var ir=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zr={},Ua={};function Ia(e){return sn.call(Ua,e)?!0:sn.call(Zr,e)?!1:ir.test(e)?Ua[e]=!0:(Zr[e]=!0,!1)}function sr(e,n,i){if(Ia(n))if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var l=n.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+i)}}function Ti(e,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+i)}}function qn(e,n,i,l){if(l===null)e.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(n,i,""+l)}}var Qr,jt;function Ba(e){if(Qr===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);Qr=n&&n[1]||"",jt=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qr+e+jt}var wi=!1;function lr(e,n){if(!e||wi)return"";wi=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(n){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(K){var Q=K}Reflect.construct(e,[],pe)}else{try{pe.call()}catch(K){Q=K}e.call(pe.prototype)}}else{try{throw Error()}catch(K){Q=K}(pe=e())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(K){if(K&&Q&&typeof K.stack=="string")return[K.stack,Q.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=l.DetermineComponentFrameRoot(),b=p[0],A=p[1];if(b&&A){var O=b.split(`
`),X=A.split(`
`);for(c=l=0;l<O.length&&!O[l].includes("DetermineComponentFrameRoot");)l++;for(;c<X.length&&!X[c].includes("DetermineComponentFrameRoot");)c++;if(l===O.length||c===X.length)for(l=O.length-1,c=X.length-1;1<=l&&0<=c&&O[l]!==X[c];)c--;for(;1<=l&&0<=c;l--,c--)if(O[l]!==X[c]){if(l!==1||c!==1)do if(l--,c--,0>c||O[l]!==X[c]){var ue=`
`+O[l].replace(" at new "," at ");return e.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",e.displayName)),ue}while(1<=l&&0<=c);break}}}finally{wi=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?Ba(i):""}function eu(e){switch(e.tag){case 26:case 27:case 5:return Ba(e.type);case 16:return Ba("Lazy");case 13:return Ba("Suspense");case 19:return Ba("SuspenseList");case 0:case 15:return lr(e.type,!1);case 11:return lr(e.type.render,!1);case 1:return lr(e.type,!0);case 31:return Ba("Activity");default:return""}}function Tl(e){try{var n="";do n+=eu(e),e=e.return;while(e);return n}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}function Yt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function oa(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Ci(e){var n=oa(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,p=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return c.call(this)},set:function(b){l=""+b,p.call(this,b)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(b){l=""+b},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Fa(e){e._valueTracker||(e._valueTracker=Ci(e))}function Kr(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=oa(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function ja(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Wr=/[\n"\\]/g;function En(e){return e.replace(Wr,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Ga(e,n,i,l,c,p,b,A){e.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?e.type=b:e.removeAttribute("type"),n!=null?b==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+Yt(n)):e.value!==""+Yt(n)&&(e.value=""+Yt(n)):b!=="submit"&&b!=="reset"||e.removeAttribute("value"),n!=null?ps(e,b,Yt(n)):i!=null?ps(e,b,Yt(i)):l!=null&&e.removeAttribute("value"),c==null&&p!=null&&(e.defaultChecked=!!p),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?e.name=""+Yt(A):e.removeAttribute("name")}function wl(e,n,i,l,c,p,b,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||i!=null){if(!(p!=="submit"&&p!=="reset"||n!=null))return;i=i!=null?""+Yt(i):"",n=n!=null?""+Yt(n):i,A||n===e.value||(e.value=n),e.defaultValue=n}l=l??c,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=A?e.checked:!!l,e.defaultChecked=!!l,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(e.name=b)}function ps(e,n,i){n==="number"&&ja(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function or(e,n,i,l){if(e=e.options,n){n={};for(var c=0;c<i.length;c++)n["$"+i[c]]=!0;for(i=0;i<e.length;i++)c=n.hasOwnProperty("$"+e[i].value),e[i].selected!==c&&(e[i].selected=c),c&&l&&(e[i].defaultSelected=!0)}else{for(i=""+Yt(i),n=null,c=0;c<e.length;c++){if(e[c].value===i){e[c].selected=!0,l&&(e[c].defaultSelected=!0);return}n!==null||e[c].disabled||(n=e[c])}n!==null&&(n.selected=!0)}}function Cl(e,n,i){if(n!=null&&(n=""+Yt(n),n!==e.value&&(e.value=n),i==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=i!=null?""+Yt(i):""}function Ml(e,n,i,l){if(n==null){if(l!=null){if(i!=null)throw Error(s(92));if(re(l)){if(1<l.length)throw Error(s(93));l=l[0]}i=l}i==null&&(i=""),n=i}i=Yt(n),e.defaultValue=i,l=e.textContent,l===i&&l!==""&&l!==null&&(e.value=l)}function ur(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var hs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nl(e,n,i){var l=n.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?l?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":l?e.setProperty(n,i):typeof i!="number"||i===0||hs.has(n)?n==="float"?e.cssFloat=i:e[n]=(""+i).trim():e[n]=i+"px"}function Rl(e,n,i){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,i!=null){for(var l in i)!i.hasOwnProperty(l)||n!=null&&n.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var c in n)l=n[c],n.hasOwnProperty(c)&&i[c]!==l&&Nl(e,c,l)}else for(var p in n)n.hasOwnProperty(p)&&Nl(e,p,n[p])}function ms(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gs(e){return Dl.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Dn=null;function vs(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Aa=null,cr=null;function _l(e){var n=Ea(e);if(n&&(e=n.stateNode)){var i=e[en]||null;e:switch(e=n.stateNode,n.type){case"input":if(Ga(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+En(""+n)+'"][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var c=l[en]||null;if(!c)throw Error(s(90));Ga(l,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(n=0;n<i.length;n++)l=i[n],l.form===e.form&&Kr(l)}break e;case"textarea":Cl(e,i.value,i.defaultValue);break e;case"select":n=i.value,n!=null&&or(e,!!i.multiple,n,!1)}}}var ys=!1;function Mi(e,n,i){if(ys)return e(n,i);ys=!0;try{var l=e(n);return l}finally{if(ys=!1,(Aa!==null||cr!==null)&&(po(),Aa&&(n=Aa,e=cr,cr=Aa=null,_l(n),e)))for(n=0;n<e.length;n++)_l(e[n])}}function fr(e,n){var i=e.stateNode;if(i===null)return null;var l=i[en]||null;if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(s(231,n,typeof i));return i}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bs=!1;if(Xn)try{var _={};Object.defineProperty(_,"passive",{get:function(){bs=!0}}),window.addEventListener("test",_,_),window.removeEventListener("test",_,_)}catch{bs=!1}var w=null,L=null,k=null;function q(){if(k)return k;var e,n=L,i=n.length,l,c="value"in w?w.value:w.textContent,p=c.length;for(e=0;e<i&&n[e]===c[e];e++);var b=i-e;for(l=1;l<=b&&n[i-l]===c[p-l];l++);return k=c.slice(e,1<l?1-l:void 0)}function he(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function J(){return!0}function Te(){return!1}function _e(e){function n(i,l,c,p,b){this._reactName=i,this._targetInst=c,this.type=l,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var A in e)e.hasOwnProperty(A)&&(i=e[A],this[A]=i?i(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?J:Te,this.isPropagationStopped=Te,this}return v(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=J)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=J)},persist:function(){},isPersistent:J}),n}var Pe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gt=_e(Pe),vt=v({},Pe,{view:0,detail:0}),Rt=_e(vt),Dt,dr,Re,at=v({},vt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Re&&(Re&&e.type==="mousemove"?(Dt=e.screenX-Re.screenX,dr=e.screenY-Re.screenY):dr=Dt=0,Re=e),Dt)},movementY:function(e){return"movementY"in e?e.movementY:dr}}),Se=_e(at),$e=v({},at,{dataTransfer:0}),qe=_e($e),De=v({},vt,{relatedTarget:0}),Le=_e(De),Ae=v({},Pe,{animationName:0,elapsedTime:0,pseudoElement:0}),Ye=_e(Ae),je=v({},Pe,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Oe=_e(je),it=v({},Pe,{data:0}),pt=_e(it),Ut={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Et={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ua={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xs(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=ua[e])?!!n[e]:!1}function tn(){return xs}var fn=v({},vt,{key:function(e){if(e.key){var n=Ut[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=he(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Et[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tn,charCode:function(e){return e.type==="keypress"?he(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?he(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Pa=_e(fn),dn=v({},at,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_t=_e(dn),pn=v({},vt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tn}),Zn=_e(pn),tu=v({},Pe,{propertyName:0,elapsedTime:0,pseudoElement:0}),nu=_e(tu),za=v({},at,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),tt=_e(za),pr=v({},Pe,{newState:0,oldState:0}),Qn=_e(pr),ca=[9,13,27,32],$r=Xn&&"CompositionEvent"in window,_n=null;Xn&&"documentMode"in document&&(_n=document.documentMode);var fa=Xn&&"TextEvent"in window&&!_n,hr=Xn&&(!$r||_n&&8<_n&&11>=_n),Ol=" ",Kn=!1;function hn(e,n){switch(e){case"keyup":return ca.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Of(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ni=!1;function Bm(e,n){switch(e){case"compositionend":return Of(n);case"keypress":return n.which!==32?null:(Kn=!0,Ol);case"textInput":return e=n.data,e===Ol&&Kn?null:e;default:return null}}function Fm(e,n){if(Ni)return e==="compositionend"||!$r&&hn(e,n)?(e=q(),k=L=w=null,Ni=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return hr&&n.locale!=="ko"?null:n.data;default:return null}}var jm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kf(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!jm[e.type]:n==="textarea"}function Lf(e,n,i,l){Aa?cr?cr.push(l):cr=[l]:Aa=l,n=bo(n,"onChange"),0<n.length&&(i=new gt("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var Ss=null,Es=null;function Gm(e){hh(e,0)}function kl(e){var n=qr(e);if(Kr(n))return e}function Uf(e,n){if(e==="change")return n}var If=!1;if(Xn){var au;if(Xn){var ru="oninput"in document;if(!ru){var Bf=document.createElement("div");Bf.setAttribute("oninput","return;"),ru=typeof Bf.oninput=="function"}au=ru}else au=!1;If=au&&(!document.documentMode||9<document.documentMode)}function Ff(){Ss&&(Ss.detachEvent("onpropertychange",jf),Es=Ss=null)}function jf(e){if(e.propertyName==="value"&&kl(Es)){var n=[];Lf(n,Es,e,vs(e)),Mi(Gm,n)}}function Pm(e,n,i){e==="focusin"?(Ff(),Ss=n,Es=i,Ss.attachEvent("onpropertychange",jf)):e==="focusout"&&Ff()}function zm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kl(Es)}function Hm(e,n){if(e==="click")return kl(n)}function Ym(e,n){if(e==="input"||e==="change")return kl(n)}function Vm(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var On=typeof Object.is=="function"?Object.is:Vm;function As(e,n){if(On(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var c=i[l];if(!sn.call(n,c)||!On(e[c],n[c]))return!1}return!0}function Gf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pf(e,n){var i=Gf(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Gf(i)}}function zf(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?zf(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Hf(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=ja(e.document);n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=ja(e.document)}return n}function iu(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var qm=Xn&&"documentMode"in document&&11>=document.documentMode,Ri=null,su=null,Ts=null,lu=!1;function Yf(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;lu||Ri==null||Ri!==ja(l)||(l=Ri,"selectionStart"in l&&iu(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ts&&As(Ts,l)||(Ts=l,l=bo(su,"onSelect"),0<l.length&&(n=new gt("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=Ri)))}function Jr(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var Di={animationend:Jr("Animation","AnimationEnd"),animationiteration:Jr("Animation","AnimationIteration"),animationstart:Jr("Animation","AnimationStart"),transitionrun:Jr("Transition","TransitionRun"),transitionstart:Jr("Transition","TransitionStart"),transitioncancel:Jr("Transition","TransitionCancel"),transitionend:Jr("Transition","TransitionEnd")},ou={},Vf={};Xn&&(Vf=document.createElement("div").style,"AnimationEvent"in window||(delete Di.animationend.animation,delete Di.animationiteration.animation,delete Di.animationstart.animation),"TransitionEvent"in window||delete Di.transitionend.transition);function ei(e){if(ou[e])return ou[e];if(!Di[e])return e;var n=Di[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in Vf)return ou[e]=n[i];return e}var qf=ei("animationend"),Xf=ei("animationiteration"),Zf=ei("animationstart"),Xm=ei("transitionrun"),Zm=ei("transitionstart"),Qm=ei("transitioncancel"),Qf=ei("transitionend"),Kf=new Map,uu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");uu.push("scrollEnd");function da(e,n){Kf.set(e,n),Vn(n,[e])}var Wf=new WeakMap;function Wn(e,n){if(typeof e=="object"&&e!==null){var i=Wf.get(e);return i!==void 0?i:(n={value:e,source:n,stack:Tl(n)},Wf.set(e,n),n)}return{value:e,source:n,stack:Tl(n)}}var $n=[],_i=0,cu=0;function Ll(){for(var e=_i,n=cu=_i=0;n<e;){var i=$n[n];$n[n++]=null;var l=$n[n];$n[n++]=null;var c=$n[n];$n[n++]=null;var p=$n[n];if($n[n++]=null,l!==null&&c!==null){var b=l.pending;b===null?c.next=c:(c.next=b.next,b.next=c),l.pending=c}p!==0&&$f(i,c,p)}}function Ul(e,n,i,l){$n[_i++]=e,$n[_i++]=n,$n[_i++]=i,$n[_i++]=l,cu|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function fu(e,n,i,l){return Ul(e,n,i,l),Il(e)}function Oi(e,n){return Ul(e,null,null,n),Il(e)}function $f(e,n,i){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i);for(var c=!1,p=e.return;p!==null;)p.childLanes|=i,l=p.alternate,l!==null&&(l.childLanes|=i),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(c=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,c&&n!==null&&(c=31-St(i),e=p.hiddenUpdates,l=e[c],l===null?e[c]=[n]:l.push(n),n.lane=i|536870912),p):null}function Il(e){if(50<Qs)throw Qs=0,vc=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var ki={};function Km(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(e,n,i,l){return new Km(e,n,i,l)}function du(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ha(e,n){var i=e.alternate;return i===null?(i=kn(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Jf(e,n){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,n=i.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Bl(e,n,i,l,c,p){var b=0;if(l=e,typeof e=="function")du(e)&&(b=1);else if(typeof e=="string")b=$g(e,i,z.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case de:return e=kn(31,i,n,c),e.elementType=de,e.lanes=p,e;case E:return ti(i.children,c,p,n);case T:b=8,c|=24;break;case R:return e=kn(12,i,n,c|2),e.elementType=R,e.lanes=p,e;case P:return e=kn(13,i,n,c),e.elementType=P,e.lanes=p,e;case H:return e=kn(19,i,n,c),e.elementType=H,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case j:case D:b=10;break e;case M:b=9;break e;case I:b=11;break e;case ie:b=14;break e;case se:b=16,l=null;break e}b=29,i=Error(s(130,e===null?"null":typeof e,"")),l=null}return n=kn(b,i,n,c),n.elementType=e,n.type=l,n.lanes=p,n}function ti(e,n,i,l){return e=kn(7,e,l,n),e.lanes=i,e}function pu(e,n,i){return e=kn(6,e,null,n),e.lanes=i,e}function hu(e,n,i){return n=kn(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Li=[],Ui=0,Fl=null,jl=0,Jn=[],ea=0,ni=null,Ya=1,Va="";function ai(e,n){Li[Ui++]=jl,Li[Ui++]=Fl,Fl=e,jl=n}function ed(e,n,i){Jn[ea++]=Ya,Jn[ea++]=Va,Jn[ea++]=ni,ni=e;var l=Ya;e=Va;var c=32-St(l)-1;l&=~(1<<c),i+=1;var p=32-St(n)+c;if(30<p){var b=c-c%5;p=(l&(1<<b)-1).toString(32),l>>=b,c-=b,Ya=1<<32-St(n)+c|i<<c|l,Va=p+e}else Ya=1<<p|i<<c|l,Va=e}function mu(e){e.return!==null&&(ai(e,1),ed(e,1,0))}function gu(e){for(;e===Fl;)Fl=Li[--Ui],Li[Ui]=null,jl=Li[--Ui],Li[Ui]=null;for(;e===ni;)ni=Jn[--ea],Jn[ea]=null,Va=Jn[--ea],Jn[ea]=null,Ya=Jn[--ea],Jn[ea]=null}var mn=null,Tt=null,rt=!1,ri=null,Ta=!1,vu=Error(s(519));function ii(e){var n=Error(s(418,""));throw Ms(Wn(n,e)),vu}function td(e){var n=e.stateNode,i=e.type,l=e.memoizedProps;switch(n[Ft]=e,n[en]=l,i){case"dialog":Ke("cancel",n),Ke("close",n);break;case"iframe":case"object":case"embed":Ke("load",n);break;case"video":case"audio":for(i=0;i<Ws.length;i++)Ke(Ws[i],n);break;case"source":Ke("error",n);break;case"img":case"image":case"link":Ke("error",n),Ke("load",n);break;case"details":Ke("toggle",n);break;case"input":Ke("invalid",n),wl(n,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0),Fa(n);break;case"select":Ke("invalid",n);break;case"textarea":Ke("invalid",n),Ml(n,l.value,l.defaultValue,l.children),Fa(n)}i=l.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||n.textContent===""+i||l.suppressHydrationWarning===!0||yh(n.textContent,i)?(l.popover!=null&&(Ke("beforetoggle",n),Ke("toggle",n)),l.onScroll!=null&&Ke("scroll",n),l.onScrollEnd!=null&&Ke("scrollend",n),l.onClick!=null&&(n.onclick=xo),n=!0):n=!1,n||ii(e)}function nd(e){for(mn=e.return;mn;)switch(mn.tag){case 5:case 13:Ta=!1;return;case 27:case 3:Ta=!0;return;default:mn=mn.return}}function ws(e){if(e!==mn)return!1;if(!rt)return nd(e),rt=!0,!1;var n=e.tag,i;if((i=n!==3&&n!==27)&&((i=n===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||kc(e.type,e.memoizedProps)),i=!i),i&&Tt&&ii(e),nd(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8)if(i=e.data,i==="/$"){if(n===0){Tt=ha(e.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++;e=e.nextSibling}Tt=null}}else n===27?(n=Tt,Dr(e.type)?(e=Bc,Bc=null,Tt=e):Tt=n):Tt=mn?ha(e.stateNode.nextSibling):null;return!0}function Cs(){Tt=mn=null,rt=!1}function ad(){var e=ri;return e!==null&&(wn===null?wn=e:wn.push.apply(wn,e),ri=null),e}function Ms(e){ri===null?ri=[e]:ri.push(e)}var yu=V(null),si=null,qa=null;function mr(e,n,i){W(yu,n._currentValue),n._currentValue=i}function Xa(e){e._currentValue=yu.current,oe(yu)}function bu(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function xu(e,n,i,l){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var p=c.dependencies;if(p!==null){var b=c.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=c;for(var O=0;O<n.length;O++)if(A.context===n[O]){p.lanes|=i,A=p.alternate,A!==null&&(A.lanes|=i),bu(p.return,i,e),l||(b=null);break e}p=A.next}}else if(c.tag===18){if(b=c.return,b===null)throw Error(s(341));b.lanes|=i,p=b.alternate,p!==null&&(p.lanes|=i),bu(b,i,e),b=null}else b=c.child;if(b!==null)b.return=c;else for(b=c;b!==null;){if(b===e){b=null;break}if(c=b.sibling,c!==null){c.return=b.return,b=c;break}b=b.return}c=b}}function Ns(e,n,i,l){e=null;for(var c=n,p=!1;c!==null;){if(!p){if((c.flags&524288)!==0)p=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var b=c.alternate;if(b===null)throw Error(s(387));if(b=b.memoizedProps,b!==null){var A=c.type;On(c.pendingProps.value,b.value)||(e!==null?e.push(A):e=[A])}}else if(c===xe.current){if(b=c.alternate,b===null)throw Error(s(387));b.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(al):e=[al])}c=c.return}e!==null&&xu(n,e,i,l),n.flags|=262144}function Gl(e){for(e=e.firstContext;e!==null;){if(!On(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function li(e){si=e,qa=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function un(e){return rd(si,e)}function Pl(e,n){return si===null&&li(e),rd(e,n)}function rd(e,n){var i=n._currentValue;if(n={context:n,memoizedValue:i,next:null},qa===null){if(e===null)throw Error(s(308));qa=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else qa=qa.next=n;return i}var Wm=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(i,l){e.push(l)}};this.abort=function(){n.aborted=!0,e.forEach(function(i){return i()})}},$m=r.unstable_scheduleCallback,Jm=r.unstable_NormalPriority,Pt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Su(){return{controller:new Wm,data:new Map,refCount:0}}function Rs(e){e.refCount--,e.refCount===0&&$m(Jm,function(){e.controller.abort()})}var Ds=null,Eu=0,Ii=0,Bi=null;function eg(e,n){if(Ds===null){var i=Ds=[];Eu=0,Ii=Tc(),Bi={status:"pending",value:void 0,then:function(l){i.push(l)}}}return Eu++,n.then(id,id),n}function id(){if(--Eu===0&&Ds!==null){Bi!==null&&(Bi.status="fulfilled");var e=Ds;Ds=null,Ii=0,Bi=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function tg(e,n){var i=[],l={status:"pending",value:null,reason:null,then:function(c){i.push(c)}};return e.then(function(){l.status="fulfilled",l.value=n;for(var c=0;c<i.length;c++)(0,i[c])(n)},function(c){for(l.status="rejected",l.reason=c,c=0;c<i.length;c++)(0,i[c])(void 0)}),l}var sd=B.S;B.S=function(e,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&eg(e,n),sd!==null&&sd(e,n)};var oi=V(null);function Au(){var e=oi.current;return e!==null?e:ht.pooledCache}function zl(e,n){n===null?W(oi,oi.current):W(oi,n.pool)}function ld(){var e=Au();return e===null?null:{parent:Pt._currentValue,pool:e}}var _s=Error(s(460)),od=Error(s(474)),Hl=Error(s(542)),Tu={then:function(){}};function ud(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Yl(){}function cd(e,n,i){switch(i=e[i],i===void 0?e.push(n):i!==n&&(n.then(Yl,Yl),n=i),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,dd(e),e;default:if(typeof n.status=="string")n.then(Yl,Yl);else{if(e=ht,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(l){if(n.status==="pending"){var c=n;c.status="fulfilled",c.value=l}},function(l){if(n.status==="pending"){var c=n;c.status="rejected",c.reason=l}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,dd(e),e}throw Os=n,_s}}var Os=null;function fd(){if(Os===null)throw Error(s(459));var e=Os;return Os=null,e}function dd(e){if(e===_s||e===Hl)throw Error(s(483))}var gr=!1;function wu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cu(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function vr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function yr(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(st&2)!==0){var c=l.pending;return c===null?n.next=n:(n.next=c.next,c.next=n),l.pending=n,n=Il(e),$f(e,null,i),n}return Ul(e,l,n,i),Il(e)}function ks(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194048)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Yn(e,i)}}function Mu(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var c=null,p=null;if(i=i.firstBaseUpdate,i!==null){do{var b={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};p===null?c=p=b:p=p.next=b,i=i.next}while(i!==null);p===null?c=p=n:p=p.next=n}else c=p=n;i={baseState:l.baseState,firstBaseUpdate:c,lastBaseUpdate:p,shared:l.shared,callbacks:l.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}var Nu=!1;function Ls(){if(Nu){var e=Bi;if(e!==null)throw e}}function Us(e,n,i,l){Nu=!1;var c=e.updateQueue;gr=!1;var p=c.firstBaseUpdate,b=c.lastBaseUpdate,A=c.shared.pending;if(A!==null){c.shared.pending=null;var O=A,X=O.next;O.next=null,b===null?p=X:b.next=X,b=O;var ue=e.alternate;ue!==null&&(ue=ue.updateQueue,A=ue.lastBaseUpdate,A!==b&&(A===null?ue.firstBaseUpdate=X:A.next=X,ue.lastBaseUpdate=O))}if(p!==null){var pe=c.baseState;b=0,ue=X=O=null,A=p;do{var Q=A.lane&-536870913,K=Q!==A.lane;if(K?(Je&Q)===Q:(l&Q)===Q){Q!==0&&Q===Ii&&(Nu=!0),ue!==null&&(ue=ue.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Be=e,Ue=A;Q=n;var ct=i;switch(Ue.tag){case 1:if(Be=Ue.payload,typeof Be=="function"){pe=Be.call(ct,pe,Q);break e}pe=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Ue.payload,Q=typeof Be=="function"?Be.call(ct,pe,Q):Be,Q==null)break e;pe=v({},pe,Q);break e;case 2:gr=!0}}Q=A.callback,Q!==null&&(e.flags|=64,K&&(e.flags|=8192),K=c.callbacks,K===null?c.callbacks=[Q]:K.push(Q))}else K={lane:Q,tag:A.tag,payload:A.payload,callback:A.callback,next:null},ue===null?(X=ue=K,O=pe):ue=ue.next=K,b|=Q;if(A=A.next,A===null){if(A=c.shared.pending,A===null)break;K=A,A=K.next,K.next=null,c.lastBaseUpdate=K,c.shared.pending=null}}while(!0);ue===null&&(O=pe),c.baseState=O,c.firstBaseUpdate=X,c.lastBaseUpdate=ue,p===null&&(c.shared.lanes=0),Cr|=b,e.lanes=b,e.memoizedState=pe}}function pd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function hd(e,n){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)pd(i[e],n)}var Fi=V(null),Vl=V(0);function md(e,n){e=er,W(Vl,e),W(Fi,n),er=e|n.baseLanes}function Ru(){W(Vl,er),W(Fi,Fi.current)}function Du(){er=Vl.current,oe(Fi),oe(Vl)}var br=0,Xe=null,ot=null,It=null,ql=!1,ji=!1,ui=!1,Xl=0,Is=0,Gi=null,ng=0;function Ot(){throw Error(s(321))}function _u(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!On(e[i],n[i]))return!1;return!0}function Ou(e,n,i,l,c,p){return br=p,Xe=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,B.H=e===null||e.memoizedState===null?$d:Jd,ui=!1,p=i(l,c),ui=!1,ji&&(p=vd(n,i,l,c)),gd(e),p}function gd(e){B.H=Jl;var n=ot!==null&&ot.next!==null;if(br=0,It=ot=Xe=null,ql=!1,Is=0,Gi=null,n)throw Error(s(300));e===null||Vt||(e=e.dependencies,e!==null&&Gl(e)&&(Vt=!0))}function vd(e,n,i,l){Xe=e;var c=0;do{if(ji&&(Gi=null),Is=0,ji=!1,25<=c)throw Error(s(301));if(c+=1,It=ot=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}B.H=ug,p=n(i,l)}while(ji);return p}function ag(){var e=B.H,n=e.useState()[0];return n=typeof n.then=="function"?Bs(n):n,e=e.useState()[0],(ot!==null?ot.memoizedState:null)!==e&&(Xe.flags|=1024),n}function ku(){var e=Xl!==0;return Xl=0,e}function Lu(e,n,i){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~i}function Uu(e){if(ql){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}ql=!1}br=0,It=ot=Xe=null,ji=!1,Is=Xl=0,Gi=null}function An(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?Xe.memoizedState=It=e:It=It.next=e,It}function Bt(){if(ot===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=ot.next;var n=It===null?Xe.memoizedState:It.next;if(n!==null)It=n,ot=e;else{if(e===null)throw Xe.alternate===null?Error(s(467)):Error(s(310));ot=e,e={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},It===null?Xe.memoizedState=It=e:It=It.next=e}return It}function Iu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bs(e){var n=Is;return Is+=1,Gi===null&&(Gi=[]),e=cd(Gi,e,n),n=Xe,(It===null?n.memoizedState:It.next)===null&&(n=n.alternate,B.H=n===null||n.memoizedState===null?$d:Jd),e}function Zl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Bs(e);if(e.$$typeof===D)return un(e)}throw Error(s(438,String(e)))}function Bu(e){var n=null,i=Xe.updateQueue;if(i!==null&&(n=i.memoCache),n==null){var l=Xe.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(n={data:l.data.map(function(c){return c.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),i===null&&(i=Iu(),Xe.updateQueue=i),i.memoCache=n,i=n.data[n.index],i===void 0)for(i=n.data[n.index]=Array(e),l=0;l<e;l++)i[l]=ne;return n.index++,i}function Za(e,n){return typeof n=="function"?n(e):n}function Ql(e){var n=Bt();return Fu(n,ot,e)}function Fu(e,n,i){var l=e.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=i;var c=e.baseQueue,p=l.pending;if(p!==null){if(c!==null){var b=c.next;c.next=p.next,p.next=b}n.baseQueue=c=p,l.pending=null}if(p=e.baseState,c===null)e.memoizedState=p;else{n=c.next;var A=b=null,O=null,X=n,ue=!1;do{var pe=X.lane&-536870913;if(pe!==X.lane?(Je&pe)===pe:(br&pe)===pe){var Q=X.revertLane;if(Q===0)O!==null&&(O=O.next={lane:0,revertLane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),pe===Ii&&(ue=!0);else if((br&Q)===Q){X=X.next,Q===Ii&&(ue=!0);continue}else pe={lane:0,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},O===null?(A=O=pe,b=p):O=O.next=pe,Xe.lanes|=Q,Cr|=Q;pe=X.action,ui&&i(p,pe),p=X.hasEagerState?X.eagerState:i(p,pe)}else Q={lane:pe,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},O===null?(A=O=Q,b=p):O=O.next=Q,Xe.lanes|=pe,Cr|=pe;X=X.next}while(X!==null&&X!==n);if(O===null?b=p:O.next=A,!On(p,e.memoizedState)&&(Vt=!0,ue&&(i=Bi,i!==null)))throw i;e.memoizedState=p,e.baseState=b,e.baseQueue=O,l.lastRenderedState=p}return c===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function ju(e){var n=Bt(),i=n.queue;if(i===null)throw Error(s(311));i.lastRenderedReducer=e;var l=i.dispatch,c=i.pending,p=n.memoizedState;if(c!==null){i.pending=null;var b=c=c.next;do p=e(p,b.action),b=b.next;while(b!==c);On(p,n.memoizedState)||(Vt=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),i.lastRenderedState=p}return[p,l]}function yd(e,n,i){var l=Xe,c=Bt(),p=rt;if(p){if(i===void 0)throw Error(s(407));i=i()}else i=n();var b=!On((ot||c).memoizedState,i);b&&(c.memoizedState=i,Vt=!0),c=c.queue;var A=Sd.bind(null,l,c,e);if(Fs(2048,8,A,[e]),c.getSnapshot!==n||b||It!==null&&It.memoizedState.tag&1){if(l.flags|=2048,Pi(9,Kl(),xd.bind(null,l,c,i,n),null),ht===null)throw Error(s(349));p||(br&124)!==0||bd(l,n,i)}return i}function bd(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=Xe.updateQueue,n===null?(n=Iu(),Xe.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function xd(e,n,i,l){n.value=i,n.getSnapshot=l,Ed(n)&&Ad(e)}function Sd(e,n,i){return i(function(){Ed(n)&&Ad(e)})}function Ed(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!On(e,i)}catch{return!0}}function Ad(e){var n=Oi(e,2);n!==null&&Fn(n,e,2)}function Gu(e){var n=An();if(typeof e=="function"){var i=e;if(e=i(),ui){ln(!0);try{i()}finally{ln(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:e},n}function Td(e,n,i,l){return e.baseState=i,Fu(e,ot,typeof l=="function"?l:Za)}function rg(e,n,i,l,c){if($l(e))throw Error(s(485));if(e=n.action,e!==null){var p={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};B.T!==null?i(!0):p.isTransition=!1,l(p),i=n.pending,i===null?(p.next=n.pending=p,wd(n,p)):(p.next=i.next,n.pending=i.next=p)}}function wd(e,n){var i=n.action,l=n.payload,c=e.state;if(n.isTransition){var p=B.T,b={};B.T=b;try{var A=i(c,l),O=B.S;O!==null&&O(b,A),Cd(e,n,A)}catch(X){Pu(e,n,X)}finally{B.T=p}}else try{p=i(c,l),Cd(e,n,p)}catch(X){Pu(e,n,X)}}function Cd(e,n,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(l){Md(e,n,l)},function(l){return Pu(e,n,l)}):Md(e,n,i)}function Md(e,n,i){n.status="fulfilled",n.value=i,Nd(n),e.state=i,n=e.pending,n!==null&&(i=n.next,i===n?e.pending=null:(i=i.next,n.next=i,wd(e,i)))}function Pu(e,n,i){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do n.status="rejected",n.reason=i,Nd(n),n=n.next;while(n!==l)}e.action=null}function Nd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Rd(e,n){return n}function Dd(e,n){if(rt){var i=ht.formState;if(i!==null){e:{var l=Xe;if(rt){if(Tt){t:{for(var c=Tt,p=Ta;c.nodeType!==8;){if(!p){c=null;break t}if(c=ha(c.nextSibling),c===null){c=null;break t}}p=c.data,c=p==="F!"||p==="F"?c:null}if(c){Tt=ha(c.nextSibling),l=c.data==="F!";break e}}ii(l)}l=!1}l&&(n=i[0])}}return i=An(),i.memoizedState=i.baseState=n,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rd,lastRenderedState:n},i.queue=l,i=Qd.bind(null,Xe,l),l.dispatch=i,l=Gu(!1),p=qu.bind(null,Xe,!1,l.queue),l=An(),c={state:n,dispatch:null,action:e,pending:null},l.queue=c,i=rg.bind(null,Xe,c,p,i),c.dispatch=i,l.memoizedState=e,[n,i,!1]}function _d(e){var n=Bt();return Od(n,ot,e)}function Od(e,n,i){if(n=Fu(e,n,Rd)[0],e=Ql(Za)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var l=Bs(n)}catch(b){throw b===_s?Hl:b}else l=n;n=Bt();var c=n.queue,p=c.dispatch;return i!==n.memoizedState&&(Xe.flags|=2048,Pi(9,Kl(),ig.bind(null,c,i),null)),[l,p,e]}function ig(e,n){e.action=n}function kd(e){var n=Bt(),i=ot;if(i!==null)return Od(n,i,e);Bt(),n=n.memoizedState,i=Bt();var l=i.queue.dispatch;return i.memoizedState=e,[n,l,!1]}function Pi(e,n,i,l){return e={tag:e,create:i,deps:l,inst:n,next:null},n=Xe.updateQueue,n===null&&(n=Iu(),Xe.updateQueue=n),i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e),e}function Kl(){return{destroy:void 0,resource:void 0}}function Ld(){return Bt().memoizedState}function Wl(e,n,i,l){var c=An();l=l===void 0?null:l,Xe.flags|=e,c.memoizedState=Pi(1|n,Kl(),i,l)}function Fs(e,n,i,l){var c=Bt();l=l===void 0?null:l;var p=c.memoizedState.inst;ot!==null&&l!==null&&_u(l,ot.memoizedState.deps)?c.memoizedState=Pi(n,p,i,l):(Xe.flags|=e,c.memoizedState=Pi(1|n,p,i,l))}function Ud(e,n){Wl(8390656,8,e,n)}function Id(e,n){Fs(2048,8,e,n)}function Bd(e,n){return Fs(4,2,e,n)}function Fd(e,n){return Fs(4,4,e,n)}function jd(e,n){if(typeof n=="function"){e=e();var i=n(e);return function(){typeof i=="function"?i():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Gd(e,n,i){i=i!=null?i.concat([e]):null,Fs(4,4,jd.bind(null,n,e),i)}function zu(){}function Pd(e,n){var i=Bt();n=n===void 0?null:n;var l=i.memoizedState;return n!==null&&_u(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function zd(e,n){var i=Bt();n=n===void 0?null:n;var l=i.memoizedState;if(n!==null&&_u(n,l[1]))return l[0];if(l=e(),ui){ln(!0);try{e()}finally{ln(!1)}}return i.memoizedState=[l,n],l}function Hu(e,n,i){return i===void 0||(br&1073741824)!==0?e.memoizedState=n:(e.memoizedState=i,e=Vp(),Xe.lanes|=e,Cr|=e,i)}function Hd(e,n,i,l){return On(i,n)?i:Fi.current!==null?(e=Hu(e,i,l),On(e,n)||(Vt=!0),e):(br&42)===0?(Vt=!0,e.memoizedState=i):(e=Vp(),Xe.lanes|=e,Cr|=e,n)}function Yd(e,n,i,l,c){var p=U.p;U.p=p!==0&&8>p?p:8;var b=B.T,A={};B.T=A,qu(e,!1,n,i);try{var O=c(),X=B.S;if(X!==null&&X(A,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var ue=tg(O,l);js(e,n,ue,Bn(e))}else js(e,n,l,Bn(e))}catch(pe){js(e,n,{then:function(){},status:"rejected",reason:pe},Bn())}finally{U.p=p,B.T=b}}function sg(){}function Yu(e,n,i,l){if(e.tag!==5)throw Error(s(476));var c=Vd(e).queue;Yd(e,c,n,le,i===null?sg:function(){return qd(e),i(l)})}function Vd(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:le},next:null};var i={};return n.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:i},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function qd(e){var n=Vd(e).next.queue;js(e,n,{},Bn())}function Vu(){return un(al)}function Xd(){return Bt().memoizedState}function Zd(){return Bt().memoizedState}function lg(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var i=Bn();e=vr(i);var l=yr(n,e,i);l!==null&&(Fn(l,n,i),ks(l,n,i)),n={cache:Su()},e.payload=n;return}n=n.return}}function og(e,n,i){var l=Bn();i={lane:l,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null},$l(e)?Kd(n,i):(i=fu(e,n,i,l),i!==null&&(Fn(i,e,l),Wd(i,n,l)))}function Qd(e,n,i){var l=Bn();js(e,n,i,l)}function js(e,n,i,l){var c={lane:l,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null};if($l(e))Kd(n,c);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var b=n.lastRenderedState,A=p(b,i);if(c.hasEagerState=!0,c.eagerState=A,On(A,b))return Ul(e,n,c,0),ht===null&&Ll(),!1}catch{}if(i=fu(e,n,c,l),i!==null)return Fn(i,e,l),Wd(i,n,l),!0}return!1}function qu(e,n,i,l){if(l={lane:2,revertLane:Tc(),action:l,hasEagerState:!1,eagerState:null,next:null},$l(e)){if(n)throw Error(s(479))}else n=fu(e,i,l,2),n!==null&&Fn(n,e,2)}function $l(e){var n=e.alternate;return e===Xe||n!==null&&n===Xe}function Kd(e,n){ji=ql=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function Wd(e,n,i){if((i&4194048)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Yn(e,i)}}var Jl={readContext:un,use:Zl,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot},$d={readContext:un,use:Zl,useCallback:function(e,n){return An().memoizedState=[e,n===void 0?null:n],e},useContext:un,useEffect:Ud,useImperativeHandle:function(e,n,i){i=i!=null?i.concat([e]):null,Wl(4194308,4,jd.bind(null,n,e),i)},useLayoutEffect:function(e,n){return Wl(4194308,4,e,n)},useInsertionEffect:function(e,n){Wl(4,2,e,n)},useMemo:function(e,n){var i=An();n=n===void 0?null:n;var l=e();if(ui){ln(!0);try{e()}finally{ln(!1)}}return i.memoizedState=[l,n],l},useReducer:function(e,n,i){var l=An();if(i!==void 0){var c=i(n);if(ui){ln(!0);try{i(n)}finally{ln(!1)}}}else c=n;return l.memoizedState=l.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},l.queue=e,e=e.dispatch=og.bind(null,Xe,e),[l.memoizedState,e]},useRef:function(e){var n=An();return e={current:e},n.memoizedState=e},useState:function(e){e=Gu(e);var n=e.queue,i=Qd.bind(null,Xe,n);return n.dispatch=i,[e.memoizedState,i]},useDebugValue:zu,useDeferredValue:function(e,n){var i=An();return Hu(i,e,n)},useTransition:function(){var e=Gu(!1);return e=Yd.bind(null,Xe,e.queue,!0,!1),An().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,i){var l=Xe,c=An();if(rt){if(i===void 0)throw Error(s(407));i=i()}else{if(i=n(),ht===null)throw Error(s(349));(Je&124)!==0||bd(l,n,i)}c.memoizedState=i;var p={value:i,getSnapshot:n};return c.queue=p,Ud(Sd.bind(null,l,p,e),[e]),l.flags|=2048,Pi(9,Kl(),xd.bind(null,l,p,i,n),null),i},useId:function(){var e=An(),n=ht.identifierPrefix;if(rt){var i=Va,l=Ya;i=(l&~(1<<32-St(l)-1)).toString(32)+i,n=""+n+"R"+i,i=Xl++,0<i&&(n+="H"+i.toString(32)),n+=""}else i=ng++,n=""+n+"r"+i.toString(32)+"";return e.memoizedState=n},useHostTransitionStatus:Vu,useFormState:Dd,useActionState:Dd,useOptimistic:function(e){var n=An();n.memoizedState=n.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=i,n=qu.bind(null,Xe,!0,i),i.dispatch=n,[e,n]},useMemoCache:Bu,useCacheRefresh:function(){return An().memoizedState=lg.bind(null,Xe)}},Jd={readContext:un,use:Zl,useCallback:Pd,useContext:un,useEffect:Id,useImperativeHandle:Gd,useInsertionEffect:Bd,useLayoutEffect:Fd,useMemo:zd,useReducer:Ql,useRef:Ld,useState:function(){return Ql(Za)},useDebugValue:zu,useDeferredValue:function(e,n){var i=Bt();return Hd(i,ot.memoizedState,e,n)},useTransition:function(){var e=Ql(Za)[0],n=Bt().memoizedState;return[typeof e=="boolean"?e:Bs(e),n]},useSyncExternalStore:yd,useId:Xd,useHostTransitionStatus:Vu,useFormState:_d,useActionState:_d,useOptimistic:function(e,n){var i=Bt();return Td(i,ot,e,n)},useMemoCache:Bu,useCacheRefresh:Zd},ug={readContext:un,use:Zl,useCallback:Pd,useContext:un,useEffect:Id,useImperativeHandle:Gd,useInsertionEffect:Bd,useLayoutEffect:Fd,useMemo:zd,useReducer:ju,useRef:Ld,useState:function(){return ju(Za)},useDebugValue:zu,useDeferredValue:function(e,n){var i=Bt();return ot===null?Hu(i,e,n):Hd(i,ot.memoizedState,e,n)},useTransition:function(){var e=ju(Za)[0],n=Bt().memoizedState;return[typeof e=="boolean"?e:Bs(e),n]},useSyncExternalStore:yd,useId:Xd,useHostTransitionStatus:Vu,useFormState:kd,useActionState:kd,useOptimistic:function(e,n){var i=Bt();return ot!==null?Td(i,ot,e,n):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Bu,useCacheRefresh:Zd},zi=null,Gs=0;function eo(e){var n=Gs;return Gs+=1,zi===null&&(zi=[]),cd(zi,e,n)}function Ps(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function to(e,n){throw n.$$typeof===x?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function ep(e){var n=e._init;return n(e._payload)}function tp(e){function n(G,F){if(e){var Y=G.deletions;Y===null?(G.deletions=[F],G.flags|=16):Y.push(F)}}function i(G,F){if(!e)return null;for(;F!==null;)n(G,F),F=F.sibling;return null}function l(G){for(var F=new Map;G!==null;)G.key!==null?F.set(G.key,G):F.set(G.index,G),G=G.sibling;return F}function c(G,F){return G=Ha(G,F),G.index=0,G.sibling=null,G}function p(G,F,Y){return G.index=Y,e?(Y=G.alternate,Y!==null?(Y=Y.index,Y<F?(G.flags|=67108866,F):Y):(G.flags|=67108866,F)):(G.flags|=1048576,F)}function b(G){return e&&G.alternate===null&&(G.flags|=67108866),G}function A(G,F,Y,ce){return F===null||F.tag!==6?(F=pu(Y,G.mode,ce),F.return=G,F):(F=c(F,Y),F.return=G,F)}function O(G,F,Y,ce){var we=Y.type;return we===E?ue(G,F,Y.props.children,ce,Y.key):F!==null&&(F.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===se&&ep(we)===F.type)?(F=c(F,Y.props),Ps(F,Y),F.return=G,F):(F=Bl(Y.type,Y.key,Y.props,null,G.mode,ce),Ps(F,Y),F.return=G,F)}function X(G,F,Y,ce){return F===null||F.tag!==4||F.stateNode.containerInfo!==Y.containerInfo||F.stateNode.implementation!==Y.implementation?(F=hu(Y,G.mode,ce),F.return=G,F):(F=c(F,Y.children||[]),F.return=G,F)}function ue(G,F,Y,ce,we){return F===null||F.tag!==7?(F=ti(Y,G.mode,ce,we),F.return=G,F):(F=c(F,Y),F.return=G,F)}function pe(G,F,Y){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=pu(""+F,G.mode,Y),F.return=G,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case y:return Y=Bl(F.type,F.key,F.props,null,G.mode,Y),Ps(Y,F),Y.return=G,Y;case S:return F=hu(F,G.mode,Y),F.return=G,F;case se:var ce=F._init;return F=ce(F._payload),pe(G,F,Y)}if(re(F)||ee(F))return F=ti(F,G.mode,Y,null),F.return=G,F;if(typeof F.then=="function")return pe(G,eo(F),Y);if(F.$$typeof===D)return pe(G,Pl(G,F),Y);to(G,F)}return null}function Q(G,F,Y,ce){var we=F!==null?F.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return we!==null?null:A(G,F,""+Y,ce);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case y:return Y.key===we?O(G,F,Y,ce):null;case S:return Y.key===we?X(G,F,Y,ce):null;case se:return we=Y._init,Y=we(Y._payload),Q(G,F,Y,ce)}if(re(Y)||ee(Y))return we!==null?null:ue(G,F,Y,ce,null);if(typeof Y.then=="function")return Q(G,F,eo(Y),ce);if(Y.$$typeof===D)return Q(G,F,Pl(G,Y),ce);to(G,Y)}return null}function K(G,F,Y,ce,we){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return G=G.get(Y)||null,A(F,G,""+ce,we);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case y:return G=G.get(ce.key===null?Y:ce.key)||null,O(F,G,ce,we);case S:return G=G.get(ce.key===null?Y:ce.key)||null,X(F,G,ce,we);case se:var Ze=ce._init;return ce=Ze(ce._payload),K(G,F,Y,ce,we)}if(re(ce)||ee(ce))return G=G.get(Y)||null,ue(F,G,ce,we,null);if(typeof ce.then=="function")return K(G,F,Y,eo(ce),we);if(ce.$$typeof===D)return K(G,F,Y,Pl(F,ce),we);to(F,ce)}return null}function Be(G,F,Y,ce){for(var we=null,Ze=null,ke=F,Ie=F=0,Xt=null;ke!==null&&Ie<Y.length;Ie++){ke.index>Ie?(Xt=ke,ke=null):Xt=ke.sibling;var nt=Q(G,ke,Y[Ie],ce);if(nt===null){ke===null&&(ke=Xt);break}e&&ke&&nt.alternate===null&&n(G,ke),F=p(nt,F,Ie),Ze===null?we=nt:Ze.sibling=nt,Ze=nt,ke=Xt}if(Ie===Y.length)return i(G,ke),rt&&ai(G,Ie),we;if(ke===null){for(;Ie<Y.length;Ie++)ke=pe(G,Y[Ie],ce),ke!==null&&(F=p(ke,F,Ie),Ze===null?we=ke:Ze.sibling=ke,Ze=ke);return rt&&ai(G,Ie),we}for(ke=l(ke);Ie<Y.length;Ie++)Xt=K(ke,G,Ie,Y[Ie],ce),Xt!==null&&(e&&Xt.alternate!==null&&ke.delete(Xt.key===null?Ie:Xt.key),F=p(Xt,F,Ie),Ze===null?we=Xt:Ze.sibling=Xt,Ze=Xt);return e&&ke.forEach(function(Ur){return n(G,Ur)}),rt&&ai(G,Ie),we}function Ue(G,F,Y,ce){if(Y==null)throw Error(s(151));for(var we=null,Ze=null,ke=F,Ie=F=0,Xt=null,nt=Y.next();ke!==null&&!nt.done;Ie++,nt=Y.next()){ke.index>Ie?(Xt=ke,ke=null):Xt=ke.sibling;var Ur=Q(G,ke,nt.value,ce);if(Ur===null){ke===null&&(ke=Xt);break}e&&ke&&Ur.alternate===null&&n(G,ke),F=p(Ur,F,Ie),Ze===null?we=Ur:Ze.sibling=Ur,Ze=Ur,ke=Xt}if(nt.done)return i(G,ke),rt&&ai(G,Ie),we;if(ke===null){for(;!nt.done;Ie++,nt=Y.next())nt=pe(G,nt.value,ce),nt!==null&&(F=p(nt,F,Ie),Ze===null?we=nt:Ze.sibling=nt,Ze=nt);return rt&&ai(G,Ie),we}for(ke=l(ke);!nt.done;Ie++,nt=Y.next())nt=K(ke,G,Ie,nt.value,ce),nt!==null&&(e&&nt.alternate!==null&&ke.delete(nt.key===null?Ie:nt.key),F=p(nt,F,Ie),Ze===null?we=nt:Ze.sibling=nt,Ze=nt);return e&&ke.forEach(function(cv){return n(G,cv)}),rt&&ai(G,Ie),we}function ct(G,F,Y,ce){if(typeof Y=="object"&&Y!==null&&Y.type===E&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case y:e:{for(var we=Y.key;F!==null;){if(F.key===we){if(we=Y.type,we===E){if(F.tag===7){i(G,F.sibling),ce=c(F,Y.props.children),ce.return=G,G=ce;break e}}else if(F.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===se&&ep(we)===F.type){i(G,F.sibling),ce=c(F,Y.props),Ps(ce,Y),ce.return=G,G=ce;break e}i(G,F);break}else n(G,F);F=F.sibling}Y.type===E?(ce=ti(Y.props.children,G.mode,ce,Y.key),ce.return=G,G=ce):(ce=Bl(Y.type,Y.key,Y.props,null,G.mode,ce),Ps(ce,Y),ce.return=G,G=ce)}return b(G);case S:e:{for(we=Y.key;F!==null;){if(F.key===we)if(F.tag===4&&F.stateNode.containerInfo===Y.containerInfo&&F.stateNode.implementation===Y.implementation){i(G,F.sibling),ce=c(F,Y.children||[]),ce.return=G,G=ce;break e}else{i(G,F);break}else n(G,F);F=F.sibling}ce=hu(Y,G.mode,ce),ce.return=G,G=ce}return b(G);case se:return we=Y._init,Y=we(Y._payload),ct(G,F,Y,ce)}if(re(Y))return Be(G,F,Y,ce);if(ee(Y)){if(we=ee(Y),typeof we!="function")throw Error(s(150));return Y=we.call(Y),Ue(G,F,Y,ce)}if(typeof Y.then=="function")return ct(G,F,eo(Y),ce);if(Y.$$typeof===D)return ct(G,F,Pl(G,Y),ce);to(G,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,F!==null&&F.tag===6?(i(G,F.sibling),ce=c(F,Y),ce.return=G,G=ce):(i(G,F),ce=pu(Y,G.mode,ce),ce.return=G,G=ce),b(G)):i(G,F)}return function(G,F,Y,ce){try{Gs=0;var we=ct(G,F,Y,ce);return zi=null,we}catch(ke){if(ke===_s||ke===Hl)throw ke;var Ze=kn(29,ke,null,G.mode);return Ze.lanes=ce,Ze.return=G,Ze}}}var Hi=tp(!0),np=tp(!1),ta=V(null),wa=null;function xr(e){var n=e.alternate;W(zt,zt.current&1),W(ta,e),wa===null&&(n===null||Fi.current!==null||n.memoizedState!==null)&&(wa=e)}function ap(e){if(e.tag===22){if(W(zt,zt.current),W(ta,e),wa===null){var n=e.alternate;n!==null&&n.memoizedState!==null&&(wa=e)}}else Sr()}function Sr(){W(zt,zt.current),W(ta,ta.current)}function Qa(e){oe(ta),wa===e&&(wa=null),oe(zt)}var zt=V(0);function no(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||Ic(i)))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}function Xu(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:v({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Zu={enqueueSetState:function(e,n,i){e=e._reactInternals;var l=Bn(),c=vr(l);c.payload=n,i!=null&&(c.callback=i),n=yr(e,c,l),n!==null&&(Fn(n,e,l),ks(n,e,l))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=Bn(),c=vr(l);c.tag=1,c.payload=n,i!=null&&(c.callback=i),n=yr(e,c,l),n!==null&&(Fn(n,e,l),ks(n,e,l))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Bn(),l=vr(i);l.tag=2,n!=null&&(l.callback=n),n=yr(e,l,i),n!==null&&(Fn(n,e,i),ks(n,e,i))}};function rp(e,n,i,l,c,p,b){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,p,b):n.prototype&&n.prototype.isPureReactComponent?!As(i,l)||!As(c,p):!0}function ip(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&Zu.enqueueReplaceState(n,n.state,null)}function ci(e,n){var i=n;if("ref"in n){i={};for(var l in n)l!=="ref"&&(i[l]=n[l])}if(e=e.defaultProps){i===n&&(i=v({},i));for(var c in e)i[c]===void 0&&(i[c]=e[c])}return i}var ao=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function sp(e){ao(e)}function lp(e){console.error(e)}function op(e){ao(e)}function ro(e,n){try{var i=e.onUncaughtError;i(n.value,{componentStack:n.stack})}catch(l){setTimeout(function(){throw l})}}function up(e,n,i){try{var l=e.onCaughtError;l(i.value,{componentStack:i.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function Qu(e,n,i){return i=vr(i),i.tag=3,i.payload={element:null},i.callback=function(){ro(e,n)},i}function cp(e){return e=vr(e),e.tag=3,e}function fp(e,n,i,l){var c=i.type.getDerivedStateFromError;if(typeof c=="function"){var p=l.value;e.payload=function(){return c(p)},e.callback=function(){up(n,i,l)}}var b=i.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(e.callback=function(){up(n,i,l),typeof c!="function"&&(Mr===null?Mr=new Set([this]):Mr.add(this));var A=l.stack;this.componentDidCatch(l.value,{componentStack:A!==null?A:""})})}function cg(e,n,i,l,c){if(i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(n=i.alternate,n!==null&&Ns(n,i,c,!0),i=ta.current,i!==null){switch(i.tag){case 13:return wa===null?bc():i.alternate===null&&wt===0&&(wt=3),i.flags&=-257,i.flags|=65536,i.lanes=c,l===Tu?i.flags|=16384:(n=i.updateQueue,n===null?i.updateQueue=new Set([l]):n.add(l),Sc(e,l,c)),!1;case 22:return i.flags|=65536,l===Tu?i.flags|=16384:(n=i.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([l])},i.updateQueue=n):(i=n.retryQueue,i===null?n.retryQueue=new Set([l]):i.add(l)),Sc(e,l,c)),!1}throw Error(s(435,i.tag))}return Sc(e,l,c),bc(),!1}if(rt)return n=ta.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=c,l!==vu&&(e=Error(s(422),{cause:l}),Ms(Wn(e,i)))):(l!==vu&&(n=Error(s(423),{cause:l}),Ms(Wn(n,i))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,l=Wn(l,i),c=Qu(e.stateNode,l,c),Mu(e,c),wt!==4&&(wt=2)),!1;var p=Error(s(520),{cause:l});if(p=Wn(p,i),Zs===null?Zs=[p]:Zs.push(p),wt!==4&&(wt=2),n===null)return!0;l=Wn(l,i),i=n;do{switch(i.tag){case 3:return i.flags|=65536,e=c&-c,i.lanes|=e,e=Qu(i.stateNode,l,e),Mu(i,e),!1;case 1:if(n=i.type,p=i.stateNode,(i.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Mr===null||!Mr.has(p))))return i.flags|=65536,c&=-c,i.lanes|=c,c=cp(c),fp(c,e,i,l),Mu(i,c),!1}i=i.return}while(i!==null);return!1}var dp=Error(s(461)),Vt=!1;function nn(e,n,i,l){n.child=e===null?np(n,null,i,l):Hi(n,e.child,i,l)}function pp(e,n,i,l,c){i=i.render;var p=n.ref;if("ref"in l){var b={};for(var A in l)A!=="ref"&&(b[A]=l[A])}else b=l;return li(n),l=Ou(e,n,i,b,p,c),A=ku(),e!==null&&!Vt?(Lu(e,n,c),Ka(e,n,c)):(rt&&A&&mu(n),n.flags|=1,nn(e,n,l,c),n.child)}function hp(e,n,i,l,c){if(e===null){var p=i.type;return typeof p=="function"&&!du(p)&&p.defaultProps===void 0&&i.compare===null?(n.tag=15,n.type=p,mp(e,n,p,l,c)):(e=Bl(i.type,null,l,n,n.mode,c),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!ac(e,c)){var b=p.memoizedProps;if(i=i.compare,i=i!==null?i:As,i(b,l)&&e.ref===n.ref)return Ka(e,n,c)}return n.flags|=1,e=Ha(p,l),e.ref=n.ref,e.return=n,n.child=e}function mp(e,n,i,l,c){if(e!==null){var p=e.memoizedProps;if(As(p,l)&&e.ref===n.ref)if(Vt=!1,n.pendingProps=l=p,ac(e,c))(e.flags&131072)!==0&&(Vt=!0);else return n.lanes=e.lanes,Ka(e,n,c)}return Ku(e,n,i,l,c)}function gp(e,n,i){var l=n.pendingProps,c=l.children,p=e!==null?e.memoizedState:null;if(l.mode==="hidden"){if((n.flags&128)!==0){if(l=p!==null?p.baseLanes|i:i,e!==null){for(c=n.child=e.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;n.childLanes=p&~l}else n.childLanes=0,n.child=null;return vp(e,n,l,i)}if((i&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&zl(n,p!==null?p.cachePool:null),p!==null?md(n,p):Ru(),ap(n);else return n.lanes=n.childLanes=536870912,vp(e,n,p!==null?p.baseLanes|i:i,i)}else p!==null?(zl(n,p.cachePool),md(n,p),Sr(),n.memoizedState=null):(e!==null&&zl(n,null),Ru(),Sr());return nn(e,n,c,i),n.child}function vp(e,n,i,l){var c=Au();return c=c===null?null:{parent:Pt._currentValue,pool:c},n.memoizedState={baseLanes:i,cachePool:c},e!==null&&zl(n,null),Ru(),ap(n),e!==null&&Ns(e,n,l,!0),null}function io(e,n){var i=n.ref;if(i===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(s(284));(e===null||e.ref!==i)&&(n.flags|=4194816)}}function Ku(e,n,i,l,c){return li(n),i=Ou(e,n,i,l,void 0,c),l=ku(),e!==null&&!Vt?(Lu(e,n,c),Ka(e,n,c)):(rt&&l&&mu(n),n.flags|=1,nn(e,n,i,c),n.child)}function yp(e,n,i,l,c,p){return li(n),n.updateQueue=null,i=vd(n,l,i,c),gd(e),l=ku(),e!==null&&!Vt?(Lu(e,n,p),Ka(e,n,p)):(rt&&l&&mu(n),n.flags|=1,nn(e,n,i,p),n.child)}function bp(e,n,i,l,c){if(li(n),n.stateNode===null){var p=ki,b=i.contextType;typeof b=="object"&&b!==null&&(p=un(b)),p=new i(l,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Zu,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=l,p.state=n.memoizedState,p.refs={},wu(n),b=i.contextType,p.context=typeof b=="object"&&b!==null?un(b):ki,p.state=n.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(Xu(n,i,b,l),p.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&Zu.enqueueReplaceState(p,p.state,null),Us(n,l,p,c),Ls(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),l=!0}else if(e===null){p=n.stateNode;var A=n.memoizedProps,O=ci(i,A);p.props=O;var X=p.context,ue=i.contextType;b=ki,typeof ue=="object"&&ue!==null&&(b=un(ue));var pe=i.getDerivedStateFromProps;ue=typeof pe=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=n.pendingProps!==A,ue||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||X!==b)&&ip(n,p,l,b),gr=!1;var Q=n.memoizedState;p.state=Q,Us(n,l,p,c),Ls(),X=n.memoizedState,A||Q!==X||gr?(typeof pe=="function"&&(Xu(n,i,pe,l),X=n.memoizedState),(O=gr||rp(n,i,O,l,Q,X,b))?(ue||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=X),p.props=l,p.state=X,p.context=b,l=O):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{p=n.stateNode,Cu(e,n),b=n.memoizedProps,ue=ci(i,b),p.props=ue,pe=n.pendingProps,Q=p.context,X=i.contextType,O=ki,typeof X=="object"&&X!==null&&(O=un(X)),A=i.getDerivedStateFromProps,(X=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==pe||Q!==O)&&ip(n,p,l,O),gr=!1,Q=n.memoizedState,p.state=Q,Us(n,l,p,c),Ls();var K=n.memoizedState;b!==pe||Q!==K||gr||e!==null&&e.dependencies!==null&&Gl(e.dependencies)?(typeof A=="function"&&(Xu(n,i,A,l),K=n.memoizedState),(ue=gr||rp(n,i,ue,l,Q,K,O)||e!==null&&e.dependencies!==null&&Gl(e.dependencies))?(X||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(l,K,O),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(l,K,O)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===e.memoizedProps&&Q===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&Q===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=K),p.props=l,p.state=K,p.context=O,l=ue):(typeof p.componentDidUpdate!="function"||b===e.memoizedProps&&Q===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&Q===e.memoizedState||(n.flags|=1024),l=!1)}return p=l,io(e,n),l=(n.flags&128)!==0,p||l?(p=n.stateNode,i=l&&typeof i.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&l?(n.child=Hi(n,e.child,null,c),n.child=Hi(n,null,i,c)):nn(e,n,i,c),n.memoizedState=p.state,e=n.child):e=Ka(e,n,c),e}function xp(e,n,i,l){return Cs(),n.flags|=256,nn(e,n,i,l),n.child}var Wu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $u(e){return{baseLanes:e,cachePool:ld()}}function Ju(e,n,i){return e=e!==null?e.childLanes&~i:0,n&&(e|=na),e}function Sp(e,n,i){var l=n.pendingProps,c=!1,p=(n.flags&128)!==0,b;if((b=p)||(b=e!==null&&e.memoizedState===null?!1:(zt.current&2)!==0),b&&(c=!0,n.flags&=-129),b=(n.flags&32)!==0,n.flags&=-33,e===null){if(rt){if(c?xr(n):Sr(),rt){var A=Tt,O;if(O=A){e:{for(O=A,A=Ta;O.nodeType!==8;){if(!A){A=null;break e}if(O=ha(O.nextSibling),O===null){A=null;break e}}A=O}A!==null?(n.memoizedState={dehydrated:A,treeContext:ni!==null?{id:Ya,overflow:Va}:null,retryLane:536870912,hydrationErrors:null},O=kn(18,null,null,0),O.stateNode=A,O.return=n,n.child=O,mn=n,Tt=null,O=!0):O=!1}O||ii(n)}if(A=n.memoizedState,A!==null&&(A=A.dehydrated,A!==null))return Ic(A)?n.lanes=32:n.lanes=536870912,null;Qa(n)}return A=l.children,l=l.fallback,c?(Sr(),c=n.mode,A=so({mode:"hidden",children:A},c),l=ti(l,c,i,null),A.return=n,l.return=n,A.sibling=l,n.child=A,c=n.child,c.memoizedState=$u(i),c.childLanes=Ju(e,b,i),n.memoizedState=Wu,l):(xr(n),ec(n,A))}if(O=e.memoizedState,O!==null&&(A=O.dehydrated,A!==null)){if(p)n.flags&256?(xr(n),n.flags&=-257,n=tc(e,n,i)):n.memoizedState!==null?(Sr(),n.child=e.child,n.flags|=128,n=null):(Sr(),c=l.fallback,A=n.mode,l=so({mode:"visible",children:l.children},A),c=ti(c,A,i,null),c.flags|=2,l.return=n,c.return=n,l.sibling=c,n.child=l,Hi(n,e.child,null,i),l=n.child,l.memoizedState=$u(i),l.childLanes=Ju(e,b,i),n.memoizedState=Wu,n=c);else if(xr(n),Ic(A)){if(b=A.nextSibling&&A.nextSibling.dataset,b)var X=b.dgst;b=X,l=Error(s(419)),l.stack="",l.digest=b,Ms({value:l,source:null,stack:null}),n=tc(e,n,i)}else if(Vt||Ns(e,n,i,!1),b=(i&e.childLanes)!==0,Vt||b){if(b=ht,b!==null&&(l=i&-i,l=(l&42)!==0?1:bn(l),l=(l&(b.suspendedLanes|i))!==0?0:l,l!==0&&l!==O.retryLane))throw O.retryLane=l,Oi(e,l),Fn(b,e,l),dp;A.data==="$?"||bc(),n=tc(e,n,i)}else A.data==="$?"?(n.flags|=192,n.child=e.child,n=null):(e=O.treeContext,Tt=ha(A.nextSibling),mn=n,rt=!0,ri=null,Ta=!1,e!==null&&(Jn[ea++]=Ya,Jn[ea++]=Va,Jn[ea++]=ni,Ya=e.id,Va=e.overflow,ni=n),n=ec(n,l.children),n.flags|=4096);return n}return c?(Sr(),c=l.fallback,A=n.mode,O=e.child,X=O.sibling,l=Ha(O,{mode:"hidden",children:l.children}),l.subtreeFlags=O.subtreeFlags&65011712,X!==null?c=Ha(X,c):(c=ti(c,A,i,null),c.flags|=2),c.return=n,l.return=n,l.sibling=c,n.child=l,l=c,c=n.child,A=e.child.memoizedState,A===null?A=$u(i):(O=A.cachePool,O!==null?(X=Pt._currentValue,O=O.parent!==X?{parent:X,pool:X}:O):O=ld(),A={baseLanes:A.baseLanes|i,cachePool:O}),c.memoizedState=A,c.childLanes=Ju(e,b,i),n.memoizedState=Wu,l):(xr(n),i=e.child,e=i.sibling,i=Ha(i,{mode:"visible",children:l.children}),i.return=n,i.sibling=null,e!==null&&(b=n.deletions,b===null?(n.deletions=[e],n.flags|=16):b.push(e)),n.child=i,n.memoizedState=null,i)}function ec(e,n){return n=so({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function so(e,n){return e=kn(22,e,null,n),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function tc(e,n,i){return Hi(n,e.child,null,i),e=ec(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Ep(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),bu(e.return,n,i)}function nc(e,n,i,l,c){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:c}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=l,p.tail=i,p.tailMode=c)}function Ap(e,n,i){var l=n.pendingProps,c=l.revealOrder,p=l.tail;if(nn(e,n,l.children,i),l=zt.current,(l&2)!==0)l=l&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ep(e,i,n);else if(e.tag===19)Ep(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}switch(W(zt,l),c){case"forwards":for(i=n.child,c=null;i!==null;)e=i.alternate,e!==null&&no(e)===null&&(c=i),i=i.sibling;i=c,i===null?(c=n.child,n.child=null):(c=i.sibling,i.sibling=null),nc(n,!1,c,i,p);break;case"backwards":for(i=null,c=n.child,n.child=null;c!==null;){if(e=c.alternate,e!==null&&no(e)===null){n.child=c;break}e=c.sibling,c.sibling=i,i=c,c=e}nc(n,!0,i,null,p);break;case"together":nc(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Ka(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),Cr|=n.lanes,(i&n.childLanes)===0)if(e!==null){if(Ns(e,n,i,!1),(i&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,i=Ha(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Ha(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function ac(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Gl(e)))}function fg(e,n,i){switch(n.tag){case 3:He(n,n.stateNode.containerInfo),mr(n,Pt,e.memoizedState.cache),Cs();break;case 27:case 5:Kt(n);break;case 4:He(n,n.stateNode.containerInfo);break;case 10:mr(n,n.type,n.memoizedProps.value);break;case 13:var l=n.memoizedState;if(l!==null)return l.dehydrated!==null?(xr(n),n.flags|=128,null):(i&n.child.childLanes)!==0?Sp(e,n,i):(xr(n),e=Ka(e,n,i),e!==null?e.sibling:null);xr(n);break;case 19:var c=(e.flags&128)!==0;if(l=(i&n.childLanes)!==0,l||(Ns(e,n,i,!1),l=(i&n.childLanes)!==0),c){if(l)return Ap(e,n,i);n.flags|=128}if(c=n.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),W(zt,zt.current),l)break;return null;case 22:case 23:return n.lanes=0,gp(e,n,i);case 24:mr(n,Pt,e.memoizedState.cache)}return Ka(e,n,i)}function Tp(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps)Vt=!0;else{if(!ac(e,i)&&(n.flags&128)===0)return Vt=!1,fg(e,n,i);Vt=(e.flags&131072)!==0}else Vt=!1,rt&&(n.flags&1048576)!==0&&ed(n,jl,n.index);switch(n.lanes=0,n.tag){case 16:e:{e=n.pendingProps;var l=n.elementType,c=l._init;if(l=c(l._payload),n.type=l,typeof l=="function")du(l)?(e=ci(l,e),n.tag=1,n=bp(null,n,l,e,i)):(n.tag=0,n=Ku(null,n,l,e,i));else{if(l!=null){if(c=l.$$typeof,c===I){n.tag=11,n=pp(null,n,l,e,i);break e}else if(c===ie){n.tag=14,n=hp(null,n,l,e,i);break e}}throw n=$(l)||l,Error(s(306,n,""))}}return n;case 0:return Ku(e,n,n.type,n.pendingProps,i);case 1:return l=n.type,c=ci(l,n.pendingProps),bp(e,n,l,c,i);case 3:e:{if(He(n,n.stateNode.containerInfo),e===null)throw Error(s(387));l=n.pendingProps;var p=n.memoizedState;c=p.element,Cu(e,n),Us(n,l,null,i);var b=n.memoizedState;if(l=b.cache,mr(n,Pt,l),l!==p.cache&&xu(n,[Pt],i,!0),Ls(),l=b.element,p.isDehydrated)if(p={element:l,isDehydrated:!1,cache:b.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=xp(e,n,l,i);break e}else if(l!==c){c=Wn(Error(s(424)),n),Ms(c),n=xp(e,n,l,i);break e}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Tt=ha(e.firstChild),mn=n,rt=!0,ri=null,Ta=!0,i=np(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Cs(),l===c){n=Ka(e,n,i);break e}nn(e,n,l,i)}n=n.child}return n;case 26:return io(e,n),e===null?(i=Nh(n.type,null,n.pendingProps,null))?n.memoizedState=i:rt||(i=n.type,e=n.pendingProps,l=So(ge.current).createElement(i),l[Ft]=n,l[en]=e,rn(l,i,e),bt(l),n.stateNode=l):n.memoizedState=Nh(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Kt(n),e===null&&rt&&(l=n.stateNode=wh(n.type,n.pendingProps,ge.current),mn=n,Ta=!0,c=Tt,Dr(n.type)?(Bc=c,Tt=ha(l.firstChild)):Tt=c),nn(e,n,n.pendingProps.children,i),io(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&rt&&((c=l=Tt)&&(l=jg(l,n.type,n.pendingProps,Ta),l!==null?(n.stateNode=l,mn=n,Tt=ha(l.firstChild),Ta=!1,c=!0):c=!1),c||ii(n)),Kt(n),c=n.type,p=n.pendingProps,b=e!==null?e.memoizedProps:null,l=p.children,kc(c,p)?l=null:b!==null&&kc(c,b)&&(n.flags|=32),n.memoizedState!==null&&(c=Ou(e,n,ag,null,null,i),al._currentValue=c),io(e,n),nn(e,n,l,i),n.child;case 6:return e===null&&rt&&((e=i=Tt)&&(i=Gg(i,n.pendingProps,Ta),i!==null?(n.stateNode=i,mn=n,Tt=null,e=!0):e=!1),e||ii(n)),null;case 13:return Sp(e,n,i);case 4:return He(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Hi(n,null,l,i):nn(e,n,l,i),n.child;case 11:return pp(e,n,n.type,n.pendingProps,i);case 7:return nn(e,n,n.pendingProps,i),n.child;case 8:return nn(e,n,n.pendingProps.children,i),n.child;case 12:return nn(e,n,n.pendingProps.children,i),n.child;case 10:return l=n.pendingProps,mr(n,n.type,l.value),nn(e,n,l.children,i),n.child;case 9:return c=n.type._context,l=n.pendingProps.children,li(n),c=un(c),l=l(c),n.flags|=1,nn(e,n,l,i),n.child;case 14:return hp(e,n,n.type,n.pendingProps,i);case 15:return mp(e,n,n.type,n.pendingProps,i);case 19:return Ap(e,n,i);case 31:return l=n.pendingProps,i=n.mode,l={mode:l.mode,children:l.children},e===null?(i=so(l,i),i.ref=n.ref,n.child=i,i.return=n,n=i):(i=Ha(e.child,l),i.ref=n.ref,n.child=i,i.return=n,n=i),n;case 22:return gp(e,n,i);case 24:return li(n),l=un(Pt),e===null?(c=Au(),c===null&&(c=ht,p=Su(),c.pooledCache=p,p.refCount++,p!==null&&(c.pooledCacheLanes|=i),c=p),n.memoizedState={parent:l,cache:c},wu(n),mr(n,Pt,c)):((e.lanes&i)!==0&&(Cu(e,n),Us(n,null,null,i),Ls()),c=e.memoizedState,p=n.memoizedState,c.parent!==l?(c={parent:l,cache:l},n.memoizedState=c,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=c),mr(n,Pt,l)):(l=p.cache,mr(n,Pt,l),l!==c.cache&&xu(n,[Pt],i,!0))),nn(e,n,n.pendingProps.children,i),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function Wa(e){e.flags|=4}function wp(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!kh(n)){if(n=ta.current,n!==null&&((Je&4194048)===Je?wa!==null:(Je&62914560)!==Je&&(Je&536870912)===0||n!==wa))throw Os=Tu,od;e.flags|=8192}}function lo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Yr():536870912,e.lanes|=n,Xi|=n)}function zs(e,n){if(!rt)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function At(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var c=e.child;c!==null;)i|=c.lanes|c.childLanes,l|=c.subtreeFlags&65011712,l|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)i|=c.lanes|c.childLanes,l|=c.subtreeFlags,l|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function dg(e,n,i){var l=n.pendingProps;switch(gu(n),n.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(n),null;case 1:return At(n),null;case 3:return i=n.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),Xa(Pt),Lt(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(ws(n)?Wa(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,ad())),At(n),null;case 26:return i=n.memoizedState,e===null?(Wa(n),i!==null?(At(n),wp(n,i)):(At(n),n.flags&=-16777217)):i?i!==e.memoizedState?(Wa(n),At(n),wp(n,i)):(At(n),n.flags&=-16777217):(e.memoizedProps!==l&&Wa(n),At(n),n.flags&=-16777217),null;case 27:Cn(n),i=ge.current;var c=n.type;if(e!==null&&n.stateNode!=null)e.memoizedProps!==l&&Wa(n);else{if(!l){if(n.stateNode===null)throw Error(s(166));return At(n),null}e=z.current,ws(n)?td(n):(e=wh(c,l,i),n.stateNode=e,Wa(n))}return At(n),null;case 5:if(Cn(n),i=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&Wa(n);else{if(!l){if(n.stateNode===null)throw Error(s(166));return At(n),null}if(e=z.current,ws(n))td(n);else{switch(c=So(ge.current),e){case 1:e=c.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:e=c.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":e=c.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":e=c.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof l.is=="string"?c.createElement("select",{is:l.is}):c.createElement("select"),l.multiple?e.multiple=!0:l.size&&(e.size=l.size);break;default:e=typeof l.is=="string"?c.createElement(i,{is:l.is}):c.createElement(i)}}e[Ft]=n,e[en]=l;e:for(c=n.child;c!==null;){if(c.tag===5||c.tag===6)e.appendChild(c.stateNode);else if(c.tag!==4&&c.tag!==27&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===n)break e;for(;c.sibling===null;){if(c.return===null||c.return===n)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}n.stateNode=e;e:switch(rn(e,i,l),i){case"button":case"input":case"select":case"textarea":e=!!l.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Wa(n)}}return At(n),n.flags&=-16777217,null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==l&&Wa(n);else{if(typeof l!="string"&&n.stateNode===null)throw Error(s(166));if(e=ge.current,ws(n)){if(e=n.stateNode,i=n.memoizedProps,l=null,c=mn,c!==null)switch(c.tag){case 27:case 5:l=c.memoizedProps}e[Ft]=n,e=!!(e.nodeValue===i||l!==null&&l.suppressHydrationWarning===!0||yh(e.nodeValue,i)),e||ii(n)}else e=So(e).createTextNode(l),e[Ft]=n,n.stateNode=e}return At(n),null;case 13:if(l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=ws(n),l!==null&&l.dehydrated!==null){if(e===null){if(!c)throw Error(s(318));if(c=n.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(s(317));c[Ft]=n}else Cs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;At(n),c=!1}else c=ad(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return n.flags&256?(Qa(n),n):(Qa(n),null)}if(Qa(n),(n.flags&128)!==0)return n.lanes=i,n;if(i=l!==null,e=e!==null&&e.memoizedState!==null,i){l=n.child,c=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(c=l.alternate.memoizedState.cachePool.pool);var p=null;l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==c&&(l.flags|=2048)}return i!==e&&i&&(n.child.flags|=8192),lo(n,n.updateQueue),At(n),null;case 4:return Lt(),e===null&&Nc(n.stateNode.containerInfo),At(n),null;case 10:return Xa(n.type),At(n),null;case 19:if(oe(zt),c=n.memoizedState,c===null)return At(n),null;if(l=(n.flags&128)!==0,p=c.rendering,p===null)if(l)zs(c,!1);else{if(wt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(p=no(e),p!==null){for(n.flags|=128,zs(c,!1),e=p.updateQueue,n.updateQueue=e,lo(n,e),n.subtreeFlags=0,e=i,i=n.child;i!==null;)Jf(i,e),i=i.sibling;return W(zt,zt.current&1|2),n.child}e=e.sibling}c.tail!==null&&et()>co&&(n.flags|=128,l=!0,zs(c,!1),n.lanes=4194304)}else{if(!l)if(e=no(p),e!==null){if(n.flags|=128,l=!0,e=e.updateQueue,n.updateQueue=e,lo(n,e),zs(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!rt)return At(n),null}else 2*et()-c.renderingStartTime>co&&i!==536870912&&(n.flags|=128,l=!0,zs(c,!1),n.lanes=4194304);c.isBackwards?(p.sibling=n.child,n.child=p):(e=c.last,e!==null?e.sibling=p:n.child=p,c.last=p)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=et(),n.sibling=null,e=zt.current,W(zt,l?e&1|2:e&1),n):(At(n),null);case 22:case 23:return Qa(n),Du(),l=n.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(n.flags|=8192):l&&(n.flags|=8192),l?(i&536870912)!==0&&(n.flags&128)===0&&(At(n),n.subtreeFlags&6&&(n.flags|=8192)):At(n),i=n.updateQueue,i!==null&&lo(n,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),l=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),l!==i&&(n.flags|=2048),e!==null&&oe(oi),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),n.memoizedState.cache!==i&&(n.flags|=2048),Xa(Pt),At(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function pg(e,n){switch(gu(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Xa(Pt),Lt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Cn(n),null;case 13:if(Qa(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Cs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return oe(zt),null;case 4:return Lt(),null;case 10:return Xa(n.type),null;case 22:case 23:return Qa(n),Du(),e!==null&&oe(oi),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Xa(Pt),null;case 25:return null;default:return null}}function Cp(e,n){switch(gu(n),n.tag){case 3:Xa(Pt),Lt();break;case 26:case 27:case 5:Cn(n);break;case 4:Lt();break;case 13:Qa(n);break;case 19:oe(zt);break;case 10:Xa(n.type);break;case 22:case 23:Qa(n),Du(),e!==null&&oe(oi);break;case 24:Xa(Pt)}}function Hs(e,n){try{var i=n.updateQueue,l=i!==null?i.lastEffect:null;if(l!==null){var c=l.next;i=c;do{if((i.tag&e)===e){l=void 0;var p=i.create,b=i.inst;l=p(),b.destroy=l}i=i.next}while(i!==c)}}catch(A){ft(n,n.return,A)}}function Er(e,n,i){try{var l=n.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var p=c.next;l=p;do{if((l.tag&e)===e){var b=l.inst,A=b.destroy;if(A!==void 0){b.destroy=void 0,c=n;var O=i,X=A;try{X()}catch(ue){ft(c,O,ue)}}}l=l.next}while(l!==p)}}catch(ue){ft(n,n.return,ue)}}function Mp(e){var n=e.updateQueue;if(n!==null){var i=e.stateNode;try{hd(n,i)}catch(l){ft(e,e.return,l)}}}function Np(e,n,i){i.props=ci(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(l){ft(e,n,l)}}function Ys(e,n){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof i=="function"?e.refCleanup=i(l):i.current=l}}catch(c){ft(e,n,c)}}function Ca(e,n){var i=e.ref,l=e.refCleanup;if(i!==null)if(typeof l=="function")try{l()}catch(c){ft(e,n,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(c){ft(e,n,c)}else i.current=null}function Rp(e){var n=e.type,i=e.memoizedProps,l=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":i.autoFocus&&l.focus();break e;case"img":i.src?l.src=i.src:i.srcSet&&(l.srcset=i.srcSet)}}catch(c){ft(e,e.return,c)}}function rc(e,n,i){try{var l=e.stateNode;Lg(l,e.type,i,n),l[en]=n}catch(c){ft(e,e.return,c)}}function Dp(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Dr(e.type)||e.tag===4}function ic(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Dp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Dr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sc(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,n):(n=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,n.appendChild(e),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=xo));else if(l!==4&&(l===27&&Dr(e.type)&&(i=e.stateNode,n=null),e=e.child,e!==null))for(sc(e,n,i),e=e.sibling;e!==null;)sc(e,n,i),e=e.sibling}function oo(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(l===27&&Dr(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(oo(e,n,i),e=e.sibling;e!==null;)oo(e,n,i),e=e.sibling}function _p(e){var n=e.stateNode,i=e.memoizedProps;try{for(var l=e.type,c=n.attributes;c.length;)n.removeAttributeNode(c[0]);rn(n,l,i),n[Ft]=e,n[en]=i}catch(p){ft(e,e.return,p)}}var $a=!1,kt=!1,lc=!1,Op=typeof WeakSet=="function"?WeakSet:Set,qt=null;function hg(e,n){if(e=e.containerInfo,_c=Mo,e=Hf(e),iu(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var c=l.anchorOffset,p=l.focusNode;l=l.focusOffset;try{i.nodeType,p.nodeType}catch{i=null;break e}var b=0,A=-1,O=-1,X=0,ue=0,pe=e,Q=null;t:for(;;){for(var K;pe!==i||c!==0&&pe.nodeType!==3||(A=b+c),pe!==p||l!==0&&pe.nodeType!==3||(O=b+l),pe.nodeType===3&&(b+=pe.nodeValue.length),(K=pe.firstChild)!==null;)Q=pe,pe=K;for(;;){if(pe===e)break t;if(Q===i&&++X===c&&(A=b),Q===p&&++ue===l&&(O=b),(K=pe.nextSibling)!==null)break;pe=Q,Q=pe.parentNode}pe=K}i=A===-1||O===-1?null:{start:A,end:O}}else i=null}i=i||{start:0,end:0}}else i=null;for(Oc={focusedElem:e,selectionRange:i},Mo=!1,qt=n;qt!==null;)if(n=qt,e=n.child,(n.subtreeFlags&1024)!==0&&e!==null)e.return=n,qt=e;else for(;qt!==null;){switch(n=qt,p=n.alternate,e=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,i=n,c=p.memoizedProps,p=p.memoizedState,l=i.stateNode;try{var Be=ci(i.type,c,i.elementType===i.type);e=l.getSnapshotBeforeUpdate(Be,p),l.__reactInternalSnapshotBeforeUpdate=e}catch(Ue){ft(i,i.return,Ue)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,i=e.nodeType,i===9)Uc(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Uc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,qt=e;break}qt=n.return}}function kp(e,n,i){var l=i.flags;switch(i.tag){case 0:case 11:case 15:Ar(e,i),l&4&&Hs(5,i);break;case 1:if(Ar(e,i),l&4)if(e=i.stateNode,n===null)try{e.componentDidMount()}catch(b){ft(i,i.return,b)}else{var c=ci(i.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(c,n,e.__reactInternalSnapshotBeforeUpdate)}catch(b){ft(i,i.return,b)}}l&64&&Mp(i),l&512&&Ys(i,i.return);break;case 3:if(Ar(e,i),l&64&&(e=i.updateQueue,e!==null)){if(n=null,i.child!==null)switch(i.child.tag){case 27:case 5:n=i.child.stateNode;break;case 1:n=i.child.stateNode}try{hd(e,n)}catch(b){ft(i,i.return,b)}}break;case 27:n===null&&l&4&&_p(i);case 26:case 5:Ar(e,i),n===null&&l&4&&Rp(i),l&512&&Ys(i,i.return);break;case 12:Ar(e,i);break;case 13:Ar(e,i),l&4&&Ip(e,i),l&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=Ag.bind(null,i),Pg(e,i))));break;case 22:if(l=i.memoizedState!==null||$a,!l){n=n!==null&&n.memoizedState!==null||kt,c=$a;var p=kt;$a=l,(kt=n)&&!p?Tr(e,i,(i.subtreeFlags&8772)!==0):Ar(e,i),$a=c,kt=p}break;case 30:break;default:Ar(e,i)}}function Lp(e){var n=e.alternate;n!==null&&(e.alternate=null,Lp(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Ei(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var xt=null,Tn=!1;function Ja(e,n,i){for(i=i.child;i!==null;)Up(e,n,i),i=i.sibling}function Up(e,n,i){if(Mt&&typeof Mt.onCommitFiberUnmount=="function")try{Mt.onCommitFiberUnmount(Hn,i)}catch{}switch(i.tag){case 26:kt||Ca(i,n),Ja(e,n,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:kt||Ca(i,n);var l=xt,c=Tn;Dr(i.type)&&(xt=i.stateNode,Tn=!1),Ja(e,n,i),Js(i.stateNode),xt=l,Tn=c;break;case 5:kt||Ca(i,n);case 6:if(l=xt,c=Tn,xt=null,Ja(e,n,i),xt=l,Tn=c,xt!==null)if(Tn)try{(xt.nodeType===9?xt.body:xt.nodeName==="HTML"?xt.ownerDocument.body:xt).removeChild(i.stateNode)}catch(p){ft(i,n,p)}else try{xt.removeChild(i.stateNode)}catch(p){ft(i,n,p)}break;case 18:xt!==null&&(Tn?(e=xt,Ah(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),ll(e)):Ah(xt,i.stateNode));break;case 4:l=xt,c=Tn,xt=i.stateNode.containerInfo,Tn=!0,Ja(e,n,i),xt=l,Tn=c;break;case 0:case 11:case 14:case 15:kt||Er(2,i,n),kt||Er(4,i,n),Ja(e,n,i);break;case 1:kt||(Ca(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"&&Np(i,n,l)),Ja(e,n,i);break;case 21:Ja(e,n,i);break;case 22:kt=(l=kt)||i.memoizedState!==null,Ja(e,n,i),kt=l;break;default:Ja(e,n,i)}}function Ip(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{ll(e)}catch(i){ft(n,n.return,i)}}function mg(e){switch(e.tag){case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Op),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Op),n;default:throw Error(s(435,e.tag))}}function oc(e,n){var i=mg(e);n.forEach(function(l){var c=Tg.bind(null,e,l);i.has(l)||(i.add(l),l.then(c,c))})}function Ln(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var c=i[l],p=e,b=n,A=b;e:for(;A!==null;){switch(A.tag){case 27:if(Dr(A.type)){xt=A.stateNode,Tn=!1;break e}break;case 5:xt=A.stateNode,Tn=!1;break e;case 3:case 4:xt=A.stateNode.containerInfo,Tn=!0;break e}A=A.return}if(xt===null)throw Error(s(160));Up(p,b,c),xt=null,Tn=!1,p=c.alternate,p!==null&&(p.return=null),c.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)Bp(n,e),n=n.sibling}var pa=null;function Bp(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ln(n,e),Un(e),l&4&&(Er(3,e,e.return),Hs(3,e),Er(5,e,e.return));break;case 1:Ln(n,e),Un(e),l&512&&(kt||i===null||Ca(i,i.return)),l&64&&$a&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?l:i.concat(l))));break;case 26:var c=pa;if(Ln(n,e),Un(e),l&512&&(kt||i===null||Ca(i,i.return)),l&4){var p=i!==null?i.memoizedState:null;if(l=e.memoizedState,i===null)if(l===null)if(e.stateNode===null){e:{l=e.type,i=e.memoizedProps,c=c.ownerDocument||c;t:switch(l){case"title":p=c.getElementsByTagName("title")[0],(!p||p[Rn]||p[Ft]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=c.createElement(l),c.head.insertBefore(p,c.querySelector("head > title"))),rn(p,l,i),p[Ft]=e,bt(p),l=p;break e;case"link":var b=_h("link","href",c).get(l+(i.href||""));if(b){for(var A=0;A<b.length;A++)if(p=b[A],p.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&p.getAttribute("rel")===(i.rel==null?null:i.rel)&&p.getAttribute("title")===(i.title==null?null:i.title)&&p.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){b.splice(A,1);break t}}p=c.createElement(l),rn(p,l,i),c.head.appendChild(p);break;case"meta":if(b=_h("meta","content",c).get(l+(i.content||""))){for(A=0;A<b.length;A++)if(p=b[A],p.getAttribute("content")===(i.content==null?null:""+i.content)&&p.getAttribute("name")===(i.name==null?null:i.name)&&p.getAttribute("property")===(i.property==null?null:i.property)&&p.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&p.getAttribute("charset")===(i.charSet==null?null:i.charSet)){b.splice(A,1);break t}}p=c.createElement(l),rn(p,l,i),c.head.appendChild(p);break;default:throw Error(s(468,l))}p[Ft]=e,bt(p),l=p}e.stateNode=l}else Oh(c,e.type,e.stateNode);else e.stateNode=Dh(c,l,e.memoizedProps);else p!==l?(p===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):p.count--,l===null?Oh(c,e.type,e.stateNode):Dh(c,l,e.memoizedProps)):l===null&&e.stateNode!==null&&rc(e,e.memoizedProps,i.memoizedProps)}break;case 27:Ln(n,e),Un(e),l&512&&(kt||i===null||Ca(i,i.return)),i!==null&&l&4&&rc(e,e.memoizedProps,i.memoizedProps);break;case 5:if(Ln(n,e),Un(e),l&512&&(kt||i===null||Ca(i,i.return)),e.flags&32){c=e.stateNode;try{ur(c,"")}catch(K){ft(e,e.return,K)}}l&4&&e.stateNode!=null&&(c=e.memoizedProps,rc(e,c,i!==null?i.memoizedProps:c)),l&1024&&(lc=!0);break;case 6:if(Ln(n,e),Un(e),l&4){if(e.stateNode===null)throw Error(s(162));l=e.memoizedProps,i=e.stateNode;try{i.nodeValue=l}catch(K){ft(e,e.return,K)}}break;case 3:if(To=null,c=pa,pa=Eo(n.containerInfo),Ln(n,e),pa=c,Un(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{ll(n.containerInfo)}catch(K){ft(e,e.return,K)}lc&&(lc=!1,Fp(e));break;case 4:l=pa,pa=Eo(e.stateNode.containerInfo),Ln(n,e),Un(e),pa=l;break;case 12:Ln(n,e),Un(e);break;case 13:Ln(n,e),Un(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(hc=et()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,oc(e,l)));break;case 22:c=e.memoizedState!==null;var O=i!==null&&i.memoizedState!==null,X=$a,ue=kt;if($a=X||c,kt=ue||O,Ln(n,e),kt=ue,$a=X,Un(e),l&8192)e:for(n=e.stateNode,n._visibility=c?n._visibility&-2:n._visibility|1,c&&(i===null||O||$a||kt||fi(e)),i=null,n=e;;){if(n.tag===5||n.tag===26){if(i===null){O=i=n;try{if(p=O.stateNode,c)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{A=O.stateNode;var pe=O.memoizedProps.style,Q=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;A.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(K){ft(O,O.return,K)}}}else if(n.tag===6){if(i===null){O=n;try{O.stateNode.nodeValue=c?"":O.memoizedProps}catch(K){ft(O,O.return,K)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;i===n&&(i=null),n=n.return}i===n&&(i=null),n.sibling.return=n.return,n=n.sibling}l&4&&(l=e.updateQueue,l!==null&&(i=l.retryQueue,i!==null&&(l.retryQueue=null,oc(e,i))));break;case 19:Ln(n,e),Un(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,oc(e,l)));break;case 30:break;case 21:break;default:Ln(n,e),Un(e)}}function Un(e){var n=e.flags;if(n&2){try{for(var i,l=e.return;l!==null;){if(Dp(l)){i=l;break}l=l.return}if(i==null)throw Error(s(160));switch(i.tag){case 27:var c=i.stateNode,p=ic(e);oo(e,p,c);break;case 5:var b=i.stateNode;i.flags&32&&(ur(b,""),i.flags&=-33);var A=ic(e);oo(e,A,b);break;case 3:case 4:var O=i.stateNode.containerInfo,X=ic(e);sc(e,X,O);break;default:throw Error(s(161))}}catch(ue){ft(e,e.return,ue)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Fp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;Fp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Ar(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)kp(e,n.alternate,n),n=n.sibling}function fi(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Er(4,n,n.return),fi(n);break;case 1:Ca(n,n.return);var i=n.stateNode;typeof i.componentWillUnmount=="function"&&Np(n,n.return,i),fi(n);break;case 27:Js(n.stateNode);case 26:case 5:Ca(n,n.return),fi(n);break;case 22:n.memoizedState===null&&fi(n);break;case 30:fi(n);break;default:fi(n)}e=e.sibling}}function Tr(e,n,i){for(i=i&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var l=n.alternate,c=e,p=n,b=p.flags;switch(p.tag){case 0:case 11:case 15:Tr(c,p,i),Hs(4,p);break;case 1:if(Tr(c,p,i),l=p,c=l.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(X){ft(l,l.return,X)}if(l=p,c=l.updateQueue,c!==null){var A=l.stateNode;try{var O=c.shared.hiddenCallbacks;if(O!==null)for(c.shared.hiddenCallbacks=null,c=0;c<O.length;c++)pd(O[c],A)}catch(X){ft(l,l.return,X)}}i&&b&64&&Mp(p),Ys(p,p.return);break;case 27:_p(p);case 26:case 5:Tr(c,p,i),i&&l===null&&b&4&&Rp(p),Ys(p,p.return);break;case 12:Tr(c,p,i);break;case 13:Tr(c,p,i),i&&b&4&&Ip(c,p);break;case 22:p.memoizedState===null&&Tr(c,p,i),Ys(p,p.return);break;case 30:break;default:Tr(c,p,i)}n=n.sibling}}function uc(e,n){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&Rs(i))}function cc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Rs(e))}function Ma(e,n,i,l){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)jp(e,n,i,l),n=n.sibling}function jp(e,n,i,l){var c=n.flags;switch(n.tag){case 0:case 11:case 15:Ma(e,n,i,l),c&2048&&Hs(9,n);break;case 1:Ma(e,n,i,l);break;case 3:Ma(e,n,i,l),c&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Rs(e)));break;case 12:if(c&2048){Ma(e,n,i,l),e=n.stateNode;try{var p=n.memoizedProps,b=p.id,A=p.onPostCommit;typeof A=="function"&&A(b,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(O){ft(n,n.return,O)}}else Ma(e,n,i,l);break;case 13:Ma(e,n,i,l);break;case 23:break;case 22:p=n.stateNode,b=n.alternate,n.memoizedState!==null?p._visibility&2?Ma(e,n,i,l):Vs(e,n):p._visibility&2?Ma(e,n,i,l):(p._visibility|=2,Yi(e,n,i,l,(n.subtreeFlags&10256)!==0)),c&2048&&uc(b,n);break;case 24:Ma(e,n,i,l),c&2048&&cc(n.alternate,n);break;default:Ma(e,n,i,l)}}function Yi(e,n,i,l,c){for(c=c&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var p=e,b=n,A=i,O=l,X=b.flags;switch(b.tag){case 0:case 11:case 15:Yi(p,b,A,O,c),Hs(8,b);break;case 23:break;case 22:var ue=b.stateNode;b.memoizedState!==null?ue._visibility&2?Yi(p,b,A,O,c):Vs(p,b):(ue._visibility|=2,Yi(p,b,A,O,c)),c&&X&2048&&uc(b.alternate,b);break;case 24:Yi(p,b,A,O,c),c&&X&2048&&cc(b.alternate,b);break;default:Yi(p,b,A,O,c)}n=n.sibling}}function Vs(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var i=e,l=n,c=l.flags;switch(l.tag){case 22:Vs(i,l),c&2048&&uc(l.alternate,l);break;case 24:Vs(i,l),c&2048&&cc(l.alternate,l);break;default:Vs(i,l)}n=n.sibling}}var qs=8192;function Vi(e){if(e.subtreeFlags&qs)for(e=e.child;e!==null;)Gp(e),e=e.sibling}function Gp(e){switch(e.tag){case 26:Vi(e),e.flags&qs&&e.memoizedState!==null&&ev(pa,e.memoizedState,e.memoizedProps);break;case 5:Vi(e);break;case 3:case 4:var n=pa;pa=Eo(e.stateNode.containerInfo),Vi(e),pa=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=qs,qs=16777216,Vi(e),qs=n):Vi(e));break;default:Vi(e)}}function Pp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Xs(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];qt=l,Hp(l,e)}Pp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)zp(e),e=e.sibling}function zp(e){switch(e.tag){case 0:case 11:case 15:Xs(e),e.flags&2048&&Er(9,e,e.return);break;case 3:Xs(e);break;case 12:Xs(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,uo(e)):Xs(e);break;default:Xs(e)}}function uo(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];qt=l,Hp(l,e)}Pp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Er(8,n,n.return),uo(n);break;case 22:i=n.stateNode,i._visibility&2&&(i._visibility&=-3,uo(n));break;default:uo(n)}e=e.sibling}}function Hp(e,n){for(;qt!==null;){var i=qt;switch(i.tag){case 0:case 11:case 15:Er(8,i,n);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var l=i.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Rs(i.memoizedState.cache)}if(l=i.child,l!==null)l.return=i,qt=l;else e:for(i=e;qt!==null;){l=qt;var c=l.sibling,p=l.return;if(Lp(l),l===i){qt=null;break e}if(c!==null){c.return=p,qt=c;break e}qt=p}}}var gg={getCacheForType:function(e){var n=un(Pt),i=n.data.get(e);return i===void 0&&(i=e(),n.data.set(e,i)),i}},vg=typeof WeakMap=="function"?WeakMap:Map,st=0,ht=null,Qe=null,Je=0,lt=0,In=null,wr=!1,qi=!1,fc=!1,er=0,wt=0,Cr=0,di=0,dc=0,na=0,Xi=0,Zs=null,wn=null,pc=!1,hc=0,co=1/0,fo=null,Mr=null,an=0,Nr=null,Zi=null,Qi=0,mc=0,gc=null,Yp=null,Qs=0,vc=null;function Bn(){if((st&2)!==0&&Je!==0)return Je&-Je;if(B.T!==null){var e=Ii;return e!==0?e:Tc()}return ds()}function Vp(){na===0&&(na=(Je&536870912)===0||rt?fs():536870912);var e=ta.current;return e!==null&&(e.flags|=32),na}function Fn(e,n,i){(e===ht&&(lt===2||lt===9)||e.cancelPendingCommit!==null)&&(Ki(e,0),Rr(e,Je,na,!1)),Nn(e,i),((st&2)===0||e!==ht)&&(e===ht&&((st&2)===0&&(di|=i),wt===4&&Rr(e,Je,na,!1)),Na(e))}function qp(e,n,i){if((st&6)!==0)throw Error(s(327));var l=!i&&(n&124)===0&&(n&e.expiredLanes)===0||yi(e,n),c=l?xg(e,n):xc(e,n,!0),p=l;do{if(c===0){qi&&!l&&Rr(e,n,0,!1);break}else{if(i=e.current.alternate,p&&!yg(i)){c=xc(e,n,!1),p=!1;continue}if(c===2){if(p=n,e.errorRecoveryDisabledLanes&p)var b=0;else b=e.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){n=b;e:{var A=e;c=Zs;var O=A.current.memoizedState.isDehydrated;if(O&&(Ki(A,b).flags|=256),b=xc(A,b,!1),b!==2){if(fc&&!O){A.errorRecoveryDisabledLanes|=p,di|=p,c=4;break e}p=wn,wn=c,p!==null&&(wn===null?wn=p:wn.push.apply(wn,p))}c=b}if(p=!1,c!==2)continue}}if(c===1){Ki(e,0),Rr(e,n,0,!0);break}e:{switch(l=e,p=c,p){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Rr(l,n,na,!wr);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(c=hc+300-et(),10<c)){if(Rr(l,n,na,!wr),Mn(l,0,!0)!==0)break e;l.timeoutHandle=Sh(Xp.bind(null,l,i,wn,fo,pc,n,na,di,Xi,wr,p,2,-0,0),c);break e}Xp(l,i,wn,fo,pc,n,na,di,Xi,wr,p,0,-0,0)}}break}while(!0);Na(e)}function Xp(e,n,i,l,c,p,b,A,O,X,ue,pe,Q,K){if(e.timeoutHandle=-1,pe=n.subtreeFlags,(pe&8192||(pe&16785408)===16785408)&&(nl={stylesheets:null,count:0,unsuspend:Jg},Gp(n),pe=tv(),pe!==null)){e.cancelPendingCommit=pe(eh.bind(null,e,n,p,i,l,c,b,A,O,ue,1,Q,K)),Rr(e,p,b,!X);return}eh(e,n,p,i,l,c,b,A,O)}function yg(e){for(var n=e;;){var i=n.tag;if((i===0||i===11||i===15)&&n.flags&16384&&(i=n.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var l=0;l<i.length;l++){var c=i[l],p=c.getSnapshot;c=c.value;try{if(!On(p(),c))return!1}catch{return!1}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Rr(e,n,i,l){n&=~dc,n&=~di,e.suspendedLanes|=n,e.pingedLanes&=~n,l&&(e.warmLanes|=n),l=e.expirationTimes;for(var c=n;0<c;){var p=31-St(c),b=1<<p;l[p]=-1,c&=~b}i!==0&&Nt(e,i,n)}function po(){return(st&6)===0?(Ks(0),!1):!0}function yc(){if(Qe!==null){if(lt===0)var e=Qe.return;else e=Qe,qa=si=null,Uu(e),zi=null,Gs=0,e=Qe;for(;e!==null;)Cp(e.alternate,e),e=e.return;Qe=null}}function Ki(e,n){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,Ig(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),yc(),ht=e,Qe=i=Ha(e.current,null),Je=n,lt=0,In=null,wr=!1,qi=yi(e,n),fc=!1,Xi=na=dc=di=Cr=wt=0,wn=Zs=null,pc=!1,(n&8)!==0&&(n|=n&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=n;0<l;){var c=31-St(l),p=1<<c;n|=e[c],l&=~p}return er=n,Ll(),i}function Zp(e,n){Xe=null,B.H=Jl,n===_s||n===Hl?(n=fd(),lt=3):n===od?(n=fd(),lt=4):lt=n===dp?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,In=n,Qe===null&&(wt=1,ro(e,Wn(n,e.current)))}function Qp(){var e=B.H;return B.H=Jl,e===null?Jl:e}function Kp(){var e=B.A;return B.A=gg,e}function bc(){wt=4,wr||(Je&4194048)!==Je&&ta.current!==null||(qi=!0),(Cr&134217727)===0&&(di&134217727)===0||ht===null||Rr(ht,Je,na,!1)}function xc(e,n,i){var l=st;st|=2;var c=Qp(),p=Kp();(ht!==e||Je!==n)&&(fo=null,Ki(e,n)),n=!1;var b=wt;e:do try{if(lt!==0&&Qe!==null){var A=Qe,O=In;switch(lt){case 8:yc(),b=6;break e;case 3:case 2:case 9:case 6:ta.current===null&&(n=!0);var X=lt;if(lt=0,In=null,Wi(e,A,O,X),i&&qi){b=0;break e}break;default:X=lt,lt=0,In=null,Wi(e,A,O,X)}}bg(),b=wt;break}catch(ue){Zp(e,ue)}while(!0);return n&&e.shellSuspendCounter++,qa=si=null,st=l,B.H=c,B.A=p,Qe===null&&(ht=null,Je=0,Ll()),b}function bg(){for(;Qe!==null;)Wp(Qe)}function xg(e,n){var i=st;st|=2;var l=Qp(),c=Kp();ht!==e||Je!==n?(fo=null,co=et()+500,Ki(e,n)):qi=yi(e,n);e:do try{if(lt!==0&&Qe!==null){n=Qe;var p=In;t:switch(lt){case 1:lt=0,In=null,Wi(e,n,p,1);break;case 2:case 9:if(ud(p)){lt=0,In=null,$p(n);break}n=function(){lt!==2&&lt!==9||ht!==e||(lt=7),Na(e)},p.then(n,n);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:ud(p)?(lt=0,In=null,$p(n)):(lt=0,In=null,Wi(e,n,p,7));break;case 5:var b=null;switch(Qe.tag){case 26:b=Qe.memoizedState;case 5:case 27:var A=Qe;if(!b||kh(b)){lt=0,In=null;var O=A.sibling;if(O!==null)Qe=O;else{var X=A.return;X!==null?(Qe=X,ho(X)):Qe=null}break t}}lt=0,In=null,Wi(e,n,p,5);break;case 6:lt=0,In=null,Wi(e,n,p,6);break;case 8:yc(),wt=6;break e;default:throw Error(s(462))}}Sg();break}catch(ue){Zp(e,ue)}while(!0);return qa=si=null,B.H=l,B.A=c,st=i,Qe!==null?0:(ht=null,Je=0,Ll(),wt)}function Sg(){for(;Qe!==null&&!zn();)Wp(Qe)}function Wp(e){var n=Tp(e.alternate,e,er);e.memoizedProps=e.pendingProps,n===null?ho(e):Qe=n}function $p(e){var n=e,i=n.alternate;switch(n.tag){case 15:case 0:n=yp(i,n,n.pendingProps,n.type,void 0,Je);break;case 11:n=yp(i,n,n.pendingProps,n.type.render,n.ref,Je);break;case 5:Uu(n);default:Cp(i,n),n=Qe=Jf(n,er),n=Tp(i,n,er)}e.memoizedProps=e.pendingProps,n===null?ho(e):Qe=n}function Wi(e,n,i,l){qa=si=null,Uu(n),zi=null,Gs=0;var c=n.return;try{if(cg(e,c,n,i,Je)){wt=1,ro(e,Wn(i,e.current)),Qe=null;return}}catch(p){if(c!==null)throw Qe=c,p;wt=1,ro(e,Wn(i,e.current)),Qe=null;return}n.flags&32768?(rt||l===1?e=!0:qi||(Je&536870912)!==0?e=!1:(wr=e=!0,(l===2||l===9||l===3||l===6)&&(l=ta.current,l!==null&&l.tag===13&&(l.flags|=16384))),Jp(n,e)):ho(n)}function ho(e){var n=e;do{if((n.flags&32768)!==0){Jp(n,wr);return}e=n.return;var i=dg(n.alternate,n,er);if(i!==null){Qe=i;return}if(n=n.sibling,n!==null){Qe=n;return}Qe=n=e}while(n!==null);wt===0&&(wt=5)}function Jp(e,n){do{var i=pg(e.alternate,e);if(i!==null){i.flags&=32767,Qe=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!n&&(e=e.sibling,e!==null)){Qe=e;return}Qe=e=i}while(e!==null);wt=6,Qe=null}function eh(e,n,i,l,c,p,b,A,O){e.cancelPendingCommit=null;do mo();while(an!==0);if((st&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(p=n.lanes|n.childLanes,p|=cu,yn(e,i,p,b,A,O),e===ht&&(Qe=ht=null,Je=0),Zi=n,Nr=e,Qi=i,mc=p,gc=c,Yp=l,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,wg(ia,function(){return ih(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||l){l=B.T,B.T=null,c=U.p,U.p=2,b=st,st|=4;try{hg(e,n,i)}finally{st=b,U.p=c,B.T=l}}an=1,th(),nh(),ah()}}function th(){if(an===1){an=0;var e=Nr,n=Zi,i=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||i){i=B.T,B.T=null;var l=U.p;U.p=2;var c=st;st|=4;try{Bp(n,e);var p=Oc,b=Hf(e.containerInfo),A=p.focusedElem,O=p.selectionRange;if(b!==A&&A&&A.ownerDocument&&zf(A.ownerDocument.documentElement,A)){if(O!==null&&iu(A)){var X=O.start,ue=O.end;if(ue===void 0&&(ue=X),"selectionStart"in A)A.selectionStart=X,A.selectionEnd=Math.min(ue,A.value.length);else{var pe=A.ownerDocument||document,Q=pe&&pe.defaultView||window;if(Q.getSelection){var K=Q.getSelection(),Be=A.textContent.length,Ue=Math.min(O.start,Be),ct=O.end===void 0?Ue:Math.min(O.end,Be);!K.extend&&Ue>ct&&(b=ct,ct=Ue,Ue=b);var G=Pf(A,Ue),F=Pf(A,ct);if(G&&F&&(K.rangeCount!==1||K.anchorNode!==G.node||K.anchorOffset!==G.offset||K.focusNode!==F.node||K.focusOffset!==F.offset)){var Y=pe.createRange();Y.setStart(G.node,G.offset),K.removeAllRanges(),Ue>ct?(K.addRange(Y),K.extend(F.node,F.offset)):(Y.setEnd(F.node,F.offset),K.addRange(Y))}}}}for(pe=[],K=A;K=K.parentNode;)K.nodeType===1&&pe.push({element:K,left:K.scrollLeft,top:K.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<pe.length;A++){var ce=pe[A];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}Mo=!!_c,Oc=_c=null}finally{st=c,U.p=l,B.T=i}}e.current=n,an=2}}function nh(){if(an===2){an=0;var e=Nr,n=Zi,i=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||i){i=B.T,B.T=null;var l=U.p;U.p=2;var c=st;st|=4;try{kp(e,n.alternate,n)}finally{st=c,U.p=l,B.T=i}}an=3}}function ah(){if(an===4||an===3){an=0,Oa();var e=Nr,n=Zi,i=Qi,l=Yp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?an=5:(an=0,Zi=Nr=null,rh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Mr=null),Vr(i),n=n.stateNode,Mt&&typeof Mt.onCommitFiberRoot=="function")try{Mt.onCommitFiberRoot(Hn,n,void 0,(n.current.flags&128)===128)}catch{}if(l!==null){n=B.T,c=U.p,U.p=2,B.T=null;try{for(var p=e.onRecoverableError,b=0;b<l.length;b++){var A=l[b];p(A.value,{componentStack:A.stack})}}finally{B.T=n,U.p=c}}(Qi&3)!==0&&mo(),Na(e),c=e.pendingLanes,(i&4194090)!==0&&(c&42)!==0?e===vc?Qs++:(Qs=0,vc=e):Qs=0,Ks(0)}}function rh(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Rs(n)))}function mo(e){return th(),nh(),ah(),ih()}function ih(){if(an!==5)return!1;var e=Nr,n=mc;mc=0;var i=Vr(Qi),l=B.T,c=U.p;try{U.p=32>i?32:i,B.T=null,i=gc,gc=null;var p=Nr,b=Qi;if(an=0,Zi=Nr=null,Qi=0,(st&6)!==0)throw Error(s(331));var A=st;if(st|=4,zp(p.current),jp(p,p.current,b,i),st=A,Ks(0,!1),Mt&&typeof Mt.onPostCommitFiberRoot=="function")try{Mt.onPostCommitFiberRoot(Hn,p)}catch{}return!0}finally{U.p=c,B.T=l,rh(e,n)}}function sh(e,n,i){n=Wn(i,n),n=Qu(e.stateNode,n,2),e=yr(e,n,2),e!==null&&(Nn(e,2),Na(e))}function ft(e,n,i){if(e.tag===3)sh(e,e,i);else for(;n!==null;){if(n.tag===3){sh(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Mr===null||!Mr.has(l))){e=Wn(i,e),i=cp(2),l=yr(n,i,2),l!==null&&(fp(i,l,n,e),Nn(l,2),Na(l));break}}n=n.return}}function Sc(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new vg;var c=new Set;l.set(n,c)}else c=l.get(n),c===void 0&&(c=new Set,l.set(n,c));c.has(i)||(fc=!0,c.add(i),e=Eg.bind(null,e,n,i),n.then(e,e))}function Eg(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,ht===e&&(Je&i)===i&&(wt===4||wt===3&&(Je&62914560)===Je&&300>et()-hc?(st&2)===0&&Ki(e,0):dc|=i,Xi===Je&&(Xi=0)),Na(e)}function lh(e,n){n===0&&(n=Yr()),e=Oi(e,n),e!==null&&(Nn(e,n),Na(e))}function Ag(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),lh(e,i)}function Tg(e,n){var i=0;switch(e.tag){case 13:var l=e.stateNode,c=e.memoizedState;c!==null&&(i=c.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(s(314))}l!==null&&l.delete(n),lh(e,i)}function wg(e,n){return _a(e,n)}var go=null,$i=null,Ec=!1,vo=!1,Ac=!1,pi=0;function Na(e){e!==$i&&e.next===null&&($i===null?go=$i=e:$i=$i.next=e),vo=!0,Ec||(Ec=!0,Mg())}function Ks(e,n){if(!Ac&&vo){Ac=!0;do for(var i=!1,l=go;l!==null;){if(e!==0){var c=l.pendingLanes;if(c===0)var p=0;else{var b=l.suspendedLanes,A=l.pingedLanes;p=(1<<31-St(42|e)+1)-1,p&=c&~(b&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(i=!0,fh(l,p))}else p=Je,p=Mn(l,l===ht?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(p&3)===0||yi(l,p)||(i=!0,fh(l,p));l=l.next}while(i);Ac=!1}}function Cg(){oh()}function oh(){vo=Ec=!1;var e=0;pi!==0&&(Ug()&&(e=pi),pi=0);for(var n=et(),i=null,l=go;l!==null;){var c=l.next,p=uh(l,n);p===0?(l.next=null,i===null?go=c:i.next=c,c===null&&($i=i)):(i=l,(e!==0||(p&3)!==0)&&(vo=!0)),l=c}Ks(e)}function uh(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,c=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var b=31-St(p),A=1<<b,O=c[b];O===-1?((A&i)===0||(A&l)!==0)&&(c[b]=_f(A,n)):O<=n&&(e.expiredLanes|=A),p&=~A}if(n=ht,i=Je,i=Mn(e,e===n?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,i===0||e===n&&(lt===2||lt===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&vn(l),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||yi(e,i)){if(n=i&-i,n===e.callbackPriority)return n;switch(l!==null&&vn(l),Vr(i)){case 2:case 8:i=Wt;break;case 32:i=ia;break;case 268435456:i=$o;break;default:i=ia}return l=ch.bind(null,e),i=_a(i,l),e.callbackPriority=n,e.callbackNode=i,n}return l!==null&&l!==null&&vn(l),e.callbackPriority=2,e.callbackNode=null,2}function ch(e,n){if(an!==0&&an!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(mo()&&e.callbackNode!==i)return null;var l=Je;return l=Mn(e,e===ht?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(qp(e,l,n),uh(e,et()),e.callbackNode!=null&&e.callbackNode===i?ch.bind(null,e):null)}function fh(e,n){if(mo())return null;qp(e,n,!0)}function Mg(){Bg(function(){(st&6)!==0?_a(We,Cg):oh()})}function Tc(){return pi===0&&(pi=fs()),pi}function dh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:gs(""+e)}function ph(e,n){var i=n.ownerDocument.createElement("input");return i.name=n.name,i.value=n.value,e.id&&i.setAttribute("form",e.id),n.parentNode.insertBefore(i,n),e=new FormData(e),i.parentNode.removeChild(i),e}function Ng(e,n,i,l,c){if(n==="submit"&&i&&i.stateNode===c){var p=dh((c[en]||null).action),b=l.submitter;b&&(n=(n=b[en]||null)?dh(n.formAction):b.getAttribute("formAction"),n!==null&&(p=n,b=null));var A=new gt("action","action",null,l,c);e.push({event:A,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(pi!==0){var O=b?ph(c,b):new FormData(c);Yu(i,{pending:!0,data:O,method:c.method,action:p},null,O)}}else typeof p=="function"&&(A.preventDefault(),O=b?ph(c,b):new FormData(c),Yu(i,{pending:!0,data:O,method:c.method,action:p},p,O))},currentTarget:c}]})}}for(var wc=0;wc<uu.length;wc++){var Cc=uu[wc],Rg=Cc.toLowerCase(),Dg=Cc[0].toUpperCase()+Cc.slice(1);da(Rg,"on"+Dg)}da(qf,"onAnimationEnd"),da(Xf,"onAnimationIteration"),da(Zf,"onAnimationStart"),da("dblclick","onDoubleClick"),da("focusin","onFocus"),da("focusout","onBlur"),da(Xm,"onTransitionRun"),da(Zm,"onTransitionStart"),da(Qm,"onTransitionCancel"),da(Qf,"onTransitionEnd"),Sn("onMouseEnter",["mouseout","mouseover"]),Sn("onMouseLeave",["mouseout","mouseover"]),Sn("onPointerEnter",["pointerout","pointerover"]),Sn("onPointerLeave",["pointerout","pointerover"]),Vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ws="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_g=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ws));function hh(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],c=l.event;l=l.listeners;e:{var p=void 0;if(n)for(var b=l.length-1;0<=b;b--){var A=l[b],O=A.instance,X=A.currentTarget;if(A=A.listener,O!==p&&c.isPropagationStopped())break e;p=A,c.currentTarget=X;try{p(c)}catch(ue){ao(ue)}c.currentTarget=null,p=O}else for(b=0;b<l.length;b++){if(A=l[b],O=A.instance,X=A.currentTarget,A=A.listener,O!==p&&c.isPropagationStopped())break e;p=A,c.currentTarget=X;try{p(c)}catch(ue){ao(ue)}c.currentTarget=null,p=O}}}}function Ke(e,n){var i=n[bi];i===void 0&&(i=n[bi]=new Set);var l=e+"__bubble";i.has(l)||(mh(n,e,2,!1),i.add(l))}function Mc(e,n,i){var l=0;n&&(l|=4),mh(i,e,l,n)}var yo="_reactListening"+Math.random().toString(36).slice(2);function Nc(e){if(!e[yo]){e[yo]=!0,Ai.forEach(function(i){i!=="selectionchange"&&(_g.has(i)||Mc(i,!1,e),Mc(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[yo]||(n[yo]=!0,Mc("selectionchange",!1,n))}}function mh(e,n,i,l){switch(jh(n)){case 2:var c=rv;break;case 8:c=iv;break;default:c=zc}i=c.bind(null,n,i,e),c=void 0,!bs||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(c=!0),l?c!==void 0?e.addEventListener(n,i,{capture:!0,passive:c}):e.addEventListener(n,i,!0):c!==void 0?e.addEventListener(n,i,{passive:c}):e.addEventListener(n,i,!1)}function Rc(e,n,i,l,c){var p=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var b=l.tag;if(b===3||b===4){var A=l.stateNode.containerInfo;if(A===c)break;if(b===4)for(b=l.return;b!==null;){var O=b.tag;if((O===3||O===4)&&b.stateNode.containerInfo===c)return;b=b.return}for(;A!==null;){if(b=xn(A),b===null)return;if(O=b.tag,O===5||O===6||O===26||O===27){l=p=b;continue e}A=A.parentNode}}l=l.return}Mi(function(){var X=p,ue=vs(i),pe=[];e:{var Q=Kf.get(e);if(Q!==void 0){var K=gt,Be=e;switch(e){case"keypress":if(he(i)===0)break e;case"keydown":case"keyup":K=Pa;break;case"focusin":Be="focus",K=Le;break;case"focusout":Be="blur",K=Le;break;case"beforeblur":case"afterblur":K=Le;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=Se;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=qe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=Zn;break;case qf:case Xf:case Zf:K=Ye;break;case Qf:K=nu;break;case"scroll":case"scrollend":K=Rt;break;case"wheel":K=tt;break;case"copy":case"cut":case"paste":K=Oe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=_t;break;case"toggle":case"beforetoggle":K=Qn}var Ue=(n&4)!==0,ct=!Ue&&(e==="scroll"||e==="scrollend"),G=Ue?Q!==null?Q+"Capture":null:Q;Ue=[];for(var F=X,Y;F!==null;){var ce=F;if(Y=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||Y===null||G===null||(ce=fr(F,G),ce!=null&&Ue.push($s(F,ce,Y))),ct)break;F=F.return}0<Ue.length&&(Q=new K(Q,Be,null,i,ue),pe.push({event:Q,listeners:Ue}))}}if((n&7)===0){e:{if(Q=e==="mouseover"||e==="pointerover",K=e==="mouseout"||e==="pointerout",Q&&i!==Dn&&(Be=i.relatedTarget||i.fromElement)&&(xn(Be)||Be[Sa]))break e;if((K||Q)&&(Q=ue.window===ue?ue:(Q=ue.ownerDocument)?Q.defaultView||Q.parentWindow:window,K?(Be=i.relatedTarget||i.toElement,K=X,Be=Be?xn(Be):null,Be!==null&&(ct=u(Be),Ue=Be.tag,Be!==ct||Ue!==5&&Ue!==27&&Ue!==6)&&(Be=null)):(K=null,Be=X),K!==Be)){if(Ue=Se,ce="onMouseLeave",G="onMouseEnter",F="mouse",(e==="pointerout"||e==="pointerover")&&(Ue=_t,ce="onPointerLeave",G="onPointerEnter",F="pointer"),ct=K==null?Q:qr(K),Y=Be==null?Q:qr(Be),Q=new Ue(ce,F+"leave",K,i,ue),Q.target=ct,Q.relatedTarget=Y,ce=null,xn(ue)===X&&(Ue=new Ue(G,F+"enter",Be,i,ue),Ue.target=Y,Ue.relatedTarget=ct,ce=Ue),ct=ce,K&&Be)t:{for(Ue=K,G=Be,F=0,Y=Ue;Y;Y=Ji(Y))F++;for(Y=0,ce=G;ce;ce=Ji(ce))Y++;for(;0<F-Y;)Ue=Ji(Ue),F--;for(;0<Y-F;)G=Ji(G),Y--;for(;F--;){if(Ue===G||G!==null&&Ue===G.alternate)break t;Ue=Ji(Ue),G=Ji(G)}Ue=null}else Ue=null;K!==null&&gh(pe,Q,K,Ue,!1),Be!==null&&ct!==null&&gh(pe,ct,Be,Ue,!0)}}e:{if(Q=X?qr(X):window,K=Q.nodeName&&Q.nodeName.toLowerCase(),K==="select"||K==="input"&&Q.type==="file")var we=Uf;else if(kf(Q))if(If)we=Ym;else{we=zm;var Ze=Pm}else K=Q.nodeName,!K||K.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?X&&ms(X.elementType)&&(we=Uf):we=Hm;if(we&&(we=we(e,X))){Lf(pe,we,i,ue);break e}Ze&&Ze(e,Q,X),e==="focusout"&&X&&Q.type==="number"&&X.memoizedProps.value!=null&&ps(Q,"number",Q.value)}switch(Ze=X?qr(X):window,e){case"focusin":(kf(Ze)||Ze.contentEditable==="true")&&(Ri=Ze,su=X,Ts=null);break;case"focusout":Ts=su=Ri=null;break;case"mousedown":lu=!0;break;case"contextmenu":case"mouseup":case"dragend":lu=!1,Yf(pe,i,ue);break;case"selectionchange":if(qm)break;case"keydown":case"keyup":Yf(pe,i,ue)}var ke;if($r)e:{switch(e){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else Ni?hn(e,i)&&(Ie="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Ie="onCompositionStart");Ie&&(hr&&i.locale!=="ko"&&(Ni||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&Ni&&(ke=q()):(w=ue,L="value"in w?w.value:w.textContent,Ni=!0)),Ze=bo(X,Ie),0<Ze.length&&(Ie=new pt(Ie,e,null,i,ue),pe.push({event:Ie,listeners:Ze}),ke?Ie.data=ke:(ke=Of(i),ke!==null&&(Ie.data=ke)))),(ke=fa?Bm(e,i):Fm(e,i))&&(Ie=bo(X,"onBeforeInput"),0<Ie.length&&(Ze=new pt("onBeforeInput","beforeinput",null,i,ue),pe.push({event:Ze,listeners:Ie}),Ze.data=ke)),Ng(pe,e,X,i,ue)}hh(pe,n)})}function $s(e,n,i){return{instance:e,listener:n,currentTarget:i}}function bo(e,n){for(var i=n+"Capture",l=[];e!==null;){var c=e,p=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||p===null||(c=fr(e,i),c!=null&&l.unshift($s(e,c,p)),c=fr(e,n),c!=null&&l.push($s(e,c,p))),e.tag===3)return l;e=e.return}return[]}function Ji(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function gh(e,n,i,l,c){for(var p=n._reactName,b=[];i!==null&&i!==l;){var A=i,O=A.alternate,X=A.stateNode;if(A=A.tag,O!==null&&O===l)break;A!==5&&A!==26&&A!==27||X===null||(O=X,c?(X=fr(i,p),X!=null&&b.unshift($s(i,X,O))):c||(X=fr(i,p),X!=null&&b.push($s(i,X,O)))),i=i.return}b.length!==0&&e.push({event:n,listeners:b})}var Og=/\r\n?/g,kg=/\u0000|\uFFFD/g;function vh(e){return(typeof e=="string"?e:""+e).replace(Og,`
`).replace(kg,"")}function yh(e,n){return n=vh(n),vh(e)===n}function xo(){}function ut(e,n,i,l,c,p){switch(i){case"children":typeof l=="string"?n==="body"||n==="textarea"&&l===""||ur(e,l):(typeof l=="number"||typeof l=="bigint")&&n!=="body"&&ur(e,""+l);break;case"className":Ti(e,"class",l);break;case"tabIndex":Ti(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Ti(e,i,l);break;case"style":Rl(e,l,p);break;case"data":if(n!=="object"){Ti(e,"data",l);break}case"src":case"href":if(l===""&&(n!=="a"||i!=="href")){e.removeAttribute(i);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=gs(""+l),e.setAttribute(i,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(i==="formAction"?(n!=="input"&&ut(e,n,"name",c.name,c,null),ut(e,n,"formEncType",c.formEncType,c,null),ut(e,n,"formMethod",c.formMethod,c,null),ut(e,n,"formTarget",c.formTarget,c,null)):(ut(e,n,"encType",c.encType,c,null),ut(e,n,"method",c.method,c,null),ut(e,n,"target",c.target,c,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=gs(""+l),e.setAttribute(i,l);break;case"onClick":l!=null&&(e.onclick=xo);break;case"onScroll":l!=null&&Ke("scroll",e);break;case"onScrollEnd":l!=null&&Ke("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(i=l.__html,i!=null){if(c.children!=null)throw Error(s(60));e.innerHTML=i}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}i=gs(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""+l):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":l===!0?e.setAttribute(i,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,l):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(i,l):e.removeAttribute(i);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(i):e.setAttribute(i,l);break;case"popover":Ke("beforetoggle",e),Ke("toggle",e),sr(e,"popover",l);break;case"xlinkActuate":qn(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":qn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":qn(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":qn(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":qn(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":qn(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":qn(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":qn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":qn(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":sr(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Gt.get(i)||i,sr(e,i,l))}}function Dc(e,n,i,l,c,p){switch(i){case"style":Rl(e,l,p);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(i=l.__html,i!=null){if(c.children!=null)throw Error(s(60));e.innerHTML=i}}break;case"children":typeof l=="string"?ur(e,l):(typeof l=="number"||typeof l=="bigint")&&ur(e,""+l);break;case"onScroll":l!=null&&Ke("scroll",e);break;case"onScrollEnd":l!=null&&Ke("scrollend",e);break;case"onClick":l!=null&&(e.onclick=xo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xr.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(c=i.endsWith("Capture"),n=i.slice(2,c?i.length-7:void 0),p=e[en]||null,p=p!=null?p[i]:null,typeof p=="function"&&e.removeEventListener(n,p,c),typeof l=="function")){typeof p!="function"&&p!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(n,l,c);break e}i in e?e[i]=l:l===!0?e.setAttribute(i,""):sr(e,i,l)}}}function rn(e,n,i){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",e),Ke("load",e);var l=!1,c=!1,p;for(p in i)if(i.hasOwnProperty(p)){var b=i[p];if(b!=null)switch(p){case"src":l=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:ut(e,n,p,b,i,null)}}c&&ut(e,n,"srcSet",i.srcSet,i,null),l&&ut(e,n,"src",i.src,i,null);return;case"input":Ke("invalid",e);var A=p=b=c=null,O=null,X=null;for(l in i)if(i.hasOwnProperty(l)){var ue=i[l];if(ue!=null)switch(l){case"name":c=ue;break;case"type":b=ue;break;case"checked":O=ue;break;case"defaultChecked":X=ue;break;case"value":p=ue;break;case"defaultValue":A=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,n));break;default:ut(e,n,l,ue,i,null)}}wl(e,p,A,O,X,b,c,!1),Fa(e);return;case"select":Ke("invalid",e),l=b=p=null;for(c in i)if(i.hasOwnProperty(c)&&(A=i[c],A!=null))switch(c){case"value":p=A;break;case"defaultValue":b=A;break;case"multiple":l=A;default:ut(e,n,c,A,i,null)}n=p,i=b,e.multiple=!!l,n!=null?or(e,!!l,n,!1):i!=null&&or(e,!!l,i,!0);return;case"textarea":Ke("invalid",e),p=c=l=null;for(b in i)if(i.hasOwnProperty(b)&&(A=i[b],A!=null))switch(b){case"value":l=A;break;case"defaultValue":c=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(s(91));break;default:ut(e,n,b,A,i,null)}Ml(e,l,c,p),Fa(e);return;case"option":for(O in i)i.hasOwnProperty(O)&&(l=i[O],l!=null)&&(O==="selected"?e.selected=l&&typeof l!="function"&&typeof l!="symbol":ut(e,n,O,l,i,null));return;case"dialog":Ke("beforetoggle",e),Ke("toggle",e),Ke("cancel",e),Ke("close",e);break;case"iframe":case"object":Ke("load",e);break;case"video":case"audio":for(l=0;l<Ws.length;l++)Ke(Ws[l],e);break;case"image":Ke("error",e),Ke("load",e);break;case"details":Ke("toggle",e);break;case"embed":case"source":case"link":Ke("error",e),Ke("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in i)if(i.hasOwnProperty(X)&&(l=i[X],l!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:ut(e,n,X,l,i,null)}return;default:if(ms(n)){for(ue in i)i.hasOwnProperty(ue)&&(l=i[ue],l!==void 0&&Dc(e,n,ue,l,i,void 0));return}}for(A in i)i.hasOwnProperty(A)&&(l=i[A],l!=null&&ut(e,n,A,l,i,null))}function Lg(e,n,i,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,p=null,b=null,A=null,O=null,X=null,ue=null;for(K in i){var pe=i[K];if(i.hasOwnProperty(K)&&pe!=null)switch(K){case"checked":break;case"value":break;case"defaultValue":O=pe;default:l.hasOwnProperty(K)||ut(e,n,K,null,l,pe)}}for(var Q in l){var K=l[Q];if(pe=i[Q],l.hasOwnProperty(Q)&&(K!=null||pe!=null))switch(Q){case"type":p=K;break;case"name":c=K;break;case"checked":X=K;break;case"defaultChecked":ue=K;break;case"value":b=K;break;case"defaultValue":A=K;break;case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(s(137,n));break;default:K!==pe&&ut(e,n,Q,K,l,pe)}}Ga(e,b,A,O,X,ue,p,c);return;case"select":K=b=A=Q=null;for(p in i)if(O=i[p],i.hasOwnProperty(p)&&O!=null)switch(p){case"value":break;case"multiple":K=O;default:l.hasOwnProperty(p)||ut(e,n,p,null,l,O)}for(c in l)if(p=l[c],O=i[c],l.hasOwnProperty(c)&&(p!=null||O!=null))switch(c){case"value":Q=p;break;case"defaultValue":A=p;break;case"multiple":b=p;default:p!==O&&ut(e,n,c,p,l,O)}n=A,i=b,l=K,Q!=null?or(e,!!i,Q,!1):!!l!=!!i&&(n!=null?or(e,!!i,n,!0):or(e,!!i,i?[]:"",!1));return;case"textarea":K=Q=null;for(A in i)if(c=i[A],i.hasOwnProperty(A)&&c!=null&&!l.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:ut(e,n,A,null,l,c)}for(b in l)if(c=l[b],p=i[b],l.hasOwnProperty(b)&&(c!=null||p!=null))switch(b){case"value":Q=c;break;case"defaultValue":K=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(s(91));break;default:c!==p&&ut(e,n,b,c,l,p)}Cl(e,Q,K);return;case"option":for(var Be in i)Q=i[Be],i.hasOwnProperty(Be)&&Q!=null&&!l.hasOwnProperty(Be)&&(Be==="selected"?e.selected=!1:ut(e,n,Be,null,l,Q));for(O in l)Q=l[O],K=i[O],l.hasOwnProperty(O)&&Q!==K&&(Q!=null||K!=null)&&(O==="selected"?e.selected=Q&&typeof Q!="function"&&typeof Q!="symbol":ut(e,n,O,Q,l,K));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in i)Q=i[Ue],i.hasOwnProperty(Ue)&&Q!=null&&!l.hasOwnProperty(Ue)&&ut(e,n,Ue,null,l,Q);for(X in l)if(Q=l[X],K=i[X],l.hasOwnProperty(X)&&Q!==K&&(Q!=null||K!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(s(137,n));break;default:ut(e,n,X,Q,l,K)}return;default:if(ms(n)){for(var ct in i)Q=i[ct],i.hasOwnProperty(ct)&&Q!==void 0&&!l.hasOwnProperty(ct)&&Dc(e,n,ct,void 0,l,Q);for(ue in l)Q=l[ue],K=i[ue],!l.hasOwnProperty(ue)||Q===K||Q===void 0&&K===void 0||Dc(e,n,ue,Q,l,K);return}}for(var G in i)Q=i[G],i.hasOwnProperty(G)&&Q!=null&&!l.hasOwnProperty(G)&&ut(e,n,G,null,l,Q);for(pe in l)Q=l[pe],K=i[pe],!l.hasOwnProperty(pe)||Q===K||Q==null&&K==null||ut(e,n,pe,Q,l,K)}var _c=null,Oc=null;function So(e){return e.nodeType===9?e:e.ownerDocument}function bh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function xh(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function kc(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Lc=null;function Ug(){var e=window.event;return e&&e.type==="popstate"?e===Lc?!1:(Lc=e,!0):(Lc=null,!1)}var Sh=typeof setTimeout=="function"?setTimeout:void 0,Ig=typeof clearTimeout=="function"?clearTimeout:void 0,Eh=typeof Promise=="function"?Promise:void 0,Bg=typeof queueMicrotask=="function"?queueMicrotask:typeof Eh<"u"?function(e){return Eh.resolve(null).then(e).catch(Fg)}:Sh;function Fg(e){setTimeout(function(){throw e})}function Dr(e){return e==="head"}function Ah(e,n){var i=n,l=0,c=0;do{var p=i.nextSibling;if(e.removeChild(i),p&&p.nodeType===8)if(i=p.data,i==="/$"){if(0<l&&8>l){i=l;var b=e.ownerDocument;if(i&1&&Js(b.documentElement),i&2&&Js(b.body),i&4)for(i=b.head,Js(i),b=i.firstChild;b;){var A=b.nextSibling,O=b.nodeName;b[Rn]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&b.rel.toLowerCase()==="stylesheet"||i.removeChild(b),b=A}}if(c===0){e.removeChild(p),ll(n);return}c--}else i==="$"||i==="$?"||i==="$!"?c++:l=i.charCodeAt(0)-48;else l=0;i=p}while(i);ll(n)}function Uc(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var i=n;switch(n=n.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Uc(i),Ei(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function jg(e,n,i,l){for(;e.nodeType===1;){var c=i;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[Rn])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=ha(e.nextSibling),e===null)break}return null}function Gg(e,n,i){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=ha(e.nextSibling),e===null))return null;return e}function Ic(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Pg(e,n){var i=e.ownerDocument;if(e.data!=="$?"||i.readyState==="complete")n();else{var l=function(){n(),i.removeEventListener("DOMContentLoaded",l)};i.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function ha(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return e}var Bc=null;function Th(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return e;n--}else i==="/$"&&n++}e=e.previousSibling}return null}function wh(e,n,i){switch(n=So(i),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Js(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Ei(e)}var aa=new Map,Ch=new Set;function Eo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var tr=U.d;U.d={f:zg,r:Hg,D:Yg,C:Vg,L:qg,m:Xg,X:Qg,S:Zg,M:Kg};function zg(){var e=tr.f(),n=po();return e||n}function Hg(e){var n=Ea(e);n!==null&&n.tag===5&&n.type==="form"?qd(n):tr.r(e)}var es=typeof document>"u"?null:document;function Mh(e,n,i){var l=es;if(l&&typeof n=="string"&&n){var c=En(n);c='link[rel="'+e+'"][href="'+c+'"]',typeof i=="string"&&(c+='[crossorigin="'+i+'"]'),Ch.has(c)||(Ch.add(c),e={rel:e,crossOrigin:i,href:n},l.querySelector(c)===null&&(n=l.createElement("link"),rn(n,"link",e),bt(n),l.head.appendChild(n)))}}function Yg(e){tr.D(e),Mh("dns-prefetch",e,null)}function Vg(e,n){tr.C(e,n),Mh("preconnect",e,n)}function qg(e,n,i){tr.L(e,n,i);var l=es;if(l&&e&&n){var c='link[rel="preload"][as="'+En(n)+'"]';n==="image"&&i&&i.imageSrcSet?(c+='[imagesrcset="'+En(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(c+='[imagesizes="'+En(i.imageSizes)+'"]')):c+='[href="'+En(e)+'"]';var p=c;switch(n){case"style":p=ts(e);break;case"script":p=ns(e)}aa.has(p)||(e=v({rel:"preload",href:n==="image"&&i&&i.imageSrcSet?void 0:e,as:n},i),aa.set(p,e),l.querySelector(c)!==null||n==="style"&&l.querySelector(el(p))||n==="script"&&l.querySelector(tl(p))||(n=l.createElement("link"),rn(n,"link",e),bt(n),l.head.appendChild(n)))}}function Xg(e,n){tr.m(e,n);var i=es;if(i&&e){var l=n&&typeof n.as=="string"?n.as:"script",c='link[rel="modulepreload"][as="'+En(l)+'"][href="'+En(e)+'"]',p=c;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ns(e)}if(!aa.has(p)&&(e=v({rel:"modulepreload",href:e},n),aa.set(p,e),i.querySelector(c)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(tl(p)))return}l=i.createElement("link"),rn(l,"link",e),bt(l),i.head.appendChild(l)}}}function Zg(e,n,i){tr.S(e,n,i);var l=es;if(l&&e){var c=La(l).hoistableStyles,p=ts(e);n=n||"default";var b=c.get(p);if(!b){var A={loading:0,preload:null};if(b=l.querySelector(el(p)))A.loading=5;else{e=v({rel:"stylesheet",href:e,"data-precedence":n},i),(i=aa.get(p))&&Fc(e,i);var O=b=l.createElement("link");bt(O),rn(O,"link",e),O._p=new Promise(function(X,ue){O.onload=X,O.onerror=ue}),O.addEventListener("load",function(){A.loading|=1}),O.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Ao(b,n,l)}b={type:"stylesheet",instance:b,count:1,state:A},c.set(p,b)}}}function Qg(e,n){tr.X(e,n);var i=es;if(i&&e){var l=La(i).hoistableScripts,c=ns(e),p=l.get(c);p||(p=i.querySelector(tl(c)),p||(e=v({src:e,async:!0},n),(n=aa.get(c))&&jc(e,n),p=i.createElement("script"),bt(p),rn(p,"link",e),i.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},l.set(c,p))}}function Kg(e,n){tr.M(e,n);var i=es;if(i&&e){var l=La(i).hoistableScripts,c=ns(e),p=l.get(c);p||(p=i.querySelector(tl(c)),p||(e=v({src:e,async:!0,type:"module"},n),(n=aa.get(c))&&jc(e,n),p=i.createElement("script"),bt(p),rn(p,"link",e),i.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},l.set(c,p))}}function Nh(e,n,i,l){var c=(c=ge.current)?Eo(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(n=ts(i.href),i=La(c).hoistableStyles,l=i.get(n),l||(l={type:"style",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=ts(i.href);var p=La(c).hoistableStyles,b=p.get(e);if(b||(c=c.ownerDocument||c,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,b),(p=c.querySelector(el(e)))&&!p._p&&(b.instance=p,b.state.loading=5),aa.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},aa.set(e,i),p||Wg(c,e,i,b.state))),n&&l===null)throw Error(s(528,""));return b}if(n&&l!==null)throw Error(s(529,""));return null;case"script":return n=i.async,i=i.src,typeof i=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ns(i),i=La(c).hoistableScripts,l=i.get(n),l||(l={type:"script",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function ts(e){return'href="'+En(e)+'"'}function el(e){return'link[rel="stylesheet"]['+e+"]"}function Rh(e){return v({},e,{"data-precedence":e.precedence,precedence:null})}function Wg(e,n,i,l){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?l.loading=1:(n=e.createElement("link"),l.preload=n,n.addEventListener("load",function(){return l.loading|=1}),n.addEventListener("error",function(){return l.loading|=2}),rn(n,"link",i),bt(n),e.head.appendChild(n))}function ns(e){return'[src="'+En(e)+'"]'}function tl(e){return"script[async]"+e}function Dh(e,n,i){if(n.count++,n.instance===null)switch(n.type){case"style":var l=e.querySelector('style[data-href~="'+En(i.href)+'"]');if(l)return n.instance=l,bt(l),l;var c=v({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),bt(l),rn(l,"style",c),Ao(l,i.precedence,e),n.instance=l;case"stylesheet":c=ts(i.href);var p=e.querySelector(el(c));if(p)return n.state.loading|=4,n.instance=p,bt(p),p;l=Rh(i),(c=aa.get(c))&&Fc(l,c),p=(e.ownerDocument||e).createElement("link"),bt(p);var b=p;return b._p=new Promise(function(A,O){b.onload=A,b.onerror=O}),rn(p,"link",l),n.state.loading|=4,Ao(p,i.precedence,e),n.instance=p;case"script":return p=ns(i.src),(c=e.querySelector(tl(p)))?(n.instance=c,bt(c),c):(l=i,(c=aa.get(p))&&(l=v({},i),jc(l,c)),e=e.ownerDocument||e,c=e.createElement("script"),bt(c),rn(c,"link",l),e.head.appendChild(c),n.instance=c);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(l=n.instance,n.state.loading|=4,Ao(l,i.precedence,e));return n.instance}function Ao(e,n,i){for(var l=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=l.length?l[l.length-1]:null,p=c,b=0;b<l.length;b++){var A=l[b];if(A.dataset.precedence===n)p=A;else if(p!==c)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=i.nodeType===9?i.head:i,n.insertBefore(e,n.firstChild))}function Fc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function jc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var To=null;function _h(e,n,i){if(To===null){var l=new Map,c=To=new Map;c.set(i,l)}else c=To,l=c.get(i),l||(l=new Map,c.set(i,l));if(l.has(e))return l;for(l.set(e,null),i=i.getElementsByTagName(e),c=0;c<i.length;c++){var p=i[c];if(!(p[Rn]||p[Ft]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(n)||"";b=e+b;var A=l.get(b);A?A.push(p):l.set(b,[p])}}return l}function Oh(e,n,i){e=e.ownerDocument||e,e.head.insertBefore(i,n==="title"?e.querySelector("head > title"):null)}function $g(e,n,i){if(i===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function kh(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var nl=null;function Jg(){}function ev(e,n,i){if(nl===null)throw Error(s(475));var l=nl;if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=ts(i.href),p=e.querySelector(el(c));if(p){e=p._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(l.count++,l=wo.bind(l),e.then(l,l)),n.state.loading|=4,n.instance=p,bt(p);return}p=e.ownerDocument||e,i=Rh(i),(c=aa.get(c))&&Fc(i,c),p=p.createElement("link"),bt(p);var b=p;b._p=new Promise(function(A,O){b.onload=A,b.onerror=O}),rn(p,"link",i),n.instance=p}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(n,e),(e=n.state.preload)&&(n.state.loading&3)===0&&(l.count++,n=wo.bind(l),e.addEventListener("load",n),e.addEventListener("error",n))}}function tv(){if(nl===null)throw Error(s(475));var e=nl;return e.stylesheets&&e.count===0&&Gc(e,e.stylesheets),0<e.count?function(n){var i=setTimeout(function(){if(e.stylesheets&&Gc(e,e.stylesheets),e.unsuspend){var l=e.unsuspend;e.unsuspend=null,l()}},6e4);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i)}}:null}function wo(){if(this.count--,this.count===0){if(this.stylesheets)Gc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Co=null;function Gc(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Co=new Map,n.forEach(nv,e),Co=null,wo.call(e))}function nv(e,n){if(!(n.state.loading&4)){var i=Co.get(e);if(i)var l=i.get(null);else{i=new Map,Co.set(e,i);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<c.length;p++){var b=c[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(i.set(b.dataset.precedence,b),l=b)}l&&i.set(null,l)}c=n.instance,b=c.getAttribute("data-precedence"),p=i.get(b)||l,p===l&&i.set(null,c),i.set(b,c),this.count++,l=wo.bind(this),c.addEventListener("load",l),c.addEventListener("error",l),p?p.parentNode.insertBefore(c,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),n.state.loading|=4}}var al={$$typeof:D,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function av(e,n,i,l,c,p,b,A){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=on(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=on(0),this.hiddenUpdates=on(null),this.identifierPrefix=l,this.onUncaughtError=c,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function Lh(e,n,i,l,c,p,b,A,O,X,ue,pe){return e=new av(e,n,i,b,A,O,X,pe),n=1,p===!0&&(n|=24),p=kn(3,null,null,n),e.current=p,p.stateNode=e,n=Su(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:l,isDehydrated:i,cache:n},wu(p),e}function Uh(e){return e?(e=ki,e):ki}function Ih(e,n,i,l,c,p){c=Uh(c),l.context===null?l.context=c:l.pendingContext=c,l=vr(n),l.payload={element:i},p=p===void 0?null:p,p!==null&&(l.callback=p),i=yr(e,l,n),i!==null&&(Fn(i,e,n),ks(i,e,n))}function Bh(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function Pc(e,n){Bh(e,n),(e=e.alternate)&&Bh(e,n)}function Fh(e){if(e.tag===13){var n=Oi(e,67108864);n!==null&&Fn(n,e,67108864),Pc(e,67108864)}}var Mo=!0;function rv(e,n,i,l){var c=B.T;B.T=null;var p=U.p;try{U.p=2,zc(e,n,i,l)}finally{U.p=p,B.T=c}}function iv(e,n,i,l){var c=B.T;B.T=null;var p=U.p;try{U.p=8,zc(e,n,i,l)}finally{U.p=p,B.T=c}}function zc(e,n,i,l){if(Mo){var c=Hc(l);if(c===null)Rc(e,n,l,No,i),Gh(e,l);else if(lv(c,e,n,i,l))l.stopPropagation();else if(Gh(e,l),n&4&&-1<sv.indexOf(e)){for(;c!==null;){var p=Ea(c);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=Jt(p.pendingLanes);if(b!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;b;){var O=1<<31-St(b);A.entanglements[1]|=O,b&=~O}Na(p),(st&6)===0&&(co=et()+500,Ks(0))}}break;case 13:A=Oi(p,2),A!==null&&Fn(A,p,2),po(),Pc(p,2)}if(p=Hc(l),p===null&&Rc(e,n,l,No,i),p===c)break;c=p}c!==null&&l.stopPropagation()}else Rc(e,n,l,null,i)}}function Hc(e){return e=vs(e),Yc(e)}var No=null;function Yc(e){if(No=null,e=xn(e),e!==null){var n=u(e);if(n===null)e=null;else{var i=n.tag;if(i===13){if(e=f(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return No=e,null}function jh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ne()){case We:return 2;case Wt:return 8;case ia:case $t:return 32;case $o:return 268435456;default:return 32}default:return 32}}var Vc=!1,_r=null,Or=null,kr=null,rl=new Map,il=new Map,Lr=[],sv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Gh(e,n){switch(e){case"focusin":case"focusout":_r=null;break;case"dragenter":case"dragleave":Or=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":rl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":il.delete(n.pointerId)}}function sl(e,n,i,l,c,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:p,targetContainers:[c]},n!==null&&(n=Ea(n),n!==null&&Fh(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,c!==null&&n.indexOf(c)===-1&&n.push(c),e)}function lv(e,n,i,l,c){switch(n){case"focusin":return _r=sl(_r,e,n,i,l,c),!0;case"dragenter":return Or=sl(Or,e,n,i,l,c),!0;case"mouseover":return kr=sl(kr,e,n,i,l,c),!0;case"pointerover":var p=c.pointerId;return rl.set(p,sl(rl.get(p)||null,e,n,i,l,c)),!0;case"gotpointercapture":return p=c.pointerId,il.set(p,sl(il.get(p)||null,e,n,i,l,c)),!0}return!1}function Ph(e){var n=xn(e.target);if(n!==null){var i=u(n);if(i!==null){if(n=i.tag,n===13){if(n=f(i),n!==null){e.blockedOn=n,El(e.priority,function(){if(i.tag===13){var l=Bn();l=bn(l);var c=Oi(i,l);c!==null&&Fn(c,i,l),Pc(i,l)}});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ro(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=Hc(e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);Dn=l,i.target.dispatchEvent(l),Dn=null}else return n=Ea(i),n!==null&&Fh(n),e.blockedOn=i,!1;n.shift()}return!0}function zh(e,n,i){Ro(e)&&i.delete(n)}function ov(){Vc=!1,_r!==null&&Ro(_r)&&(_r=null),Or!==null&&Ro(Or)&&(Or=null),kr!==null&&Ro(kr)&&(kr=null),rl.forEach(zh),il.forEach(zh)}function Do(e,n){e.blockedOn===n&&(e.blockedOn=null,Vc||(Vc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,ov)))}var _o=null;function Hh(e){_o!==e&&(_o=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){_o===e&&(_o=null);for(var n=0;n<e.length;n+=3){var i=e[n],l=e[n+1],c=e[n+2];if(typeof l!="function"){if(Yc(l||i)===null)continue;break}var p=Ea(i);p!==null&&(e.splice(n,3),n-=3,Yu(p,{pending:!0,data:c,method:i.method,action:l},l,c))}}))}function ll(e){function n(O){return Do(O,e)}_r!==null&&Do(_r,e),Or!==null&&Do(Or,e),kr!==null&&Do(kr,e),rl.forEach(n),il.forEach(n);for(var i=0;i<Lr.length;i++){var l=Lr[i];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Lr.length&&(i=Lr[0],i.blockedOn===null);)Ph(i),i.blockedOn===null&&Lr.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(l=0;l<i.length;l+=3){var c=i[l],p=i[l+1],b=c[en]||null;if(typeof p=="function")b||Hh(i);else if(b){var A=null;if(p&&p.hasAttribute("formAction")){if(c=p,b=p[en]||null)A=b.formAction;else if(Yc(c)!==null)continue}else A=b.action;typeof A=="function"?i[l+1]=A:(i.splice(l,3),l-=3),Hh(i)}}}function qc(e){this._internalRoot=e}Oo.prototype.render=qc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var i=n.current,l=Bn();Ih(i,l,e,n,null,null)},Oo.prototype.unmount=qc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Ih(e.current,2,null,e,null,null),po(),n[Sa]=null}};function Oo(e){this._internalRoot=e}Oo.prototype.unstable_scheduleHydration=function(e){if(e){var n=ds();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Lr.length&&n!==0&&n<Lr[i].priority;i++);Lr.splice(i,0,e),i===0&&Ph(e)}};var Yh=t.version;if(Yh!=="19.1.1")throw Error(s(527,Yh,"19.1.1"));U.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=d(n),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var uv={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ko=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ko.isDisabled&&ko.supportsFiber)try{Hn=ko.inject(uv),Mt=ko}catch{}}return ul.createRoot=function(e,n){if(!o(e))throw Error(s(299));var i=!1,l="",c=sp,p=lp,b=op,A=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(b=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(A=n.unstable_transitionCallbacks)),n=Lh(e,1,!1,null,null,i,l,c,p,b,A,null),e[Sa]=n.current,Nc(e),new qc(n)},ul.hydrateRoot=function(e,n,i){if(!o(e))throw Error(s(299));var l=!1,c="",p=sp,b=lp,A=op,O=null,X=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(b=i.onCaughtError),i.onRecoverableError!==void 0&&(A=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(O=i.unstable_transitionCallbacks),i.formState!==void 0&&(X=i.formState)),n=Lh(e,1,!0,n,i??null,l,c,p,b,A,O,X),n.context=Uh(null),i=n.current,l=Bn(),l=bn(l),c=vr(l),c.callback=null,yr(i,c,l),i=l,n.current.lanes=i,Nn(n,i),Na(n),e[Sa]=n.current,Nc(e),new Oo(n)},ul.version="19.1.1",ul}var e0;function yv(){if(e0)return Qc.exports;e0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Qc.exports=vv(),Qc.exports}var bv=yv();const xv=bf(bv),Sv="modulepreload",Ev=function(r,t){return new URL(r,t).href},t0={},n0=function(t,a,s){let o=Promise.resolve();if(a&&a.length>0){let g=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),d=h?.nonce||h?.getAttribute("nonce");o=g(a.map(v=>{if(v=Ev(v,s),v in t0)return;t0[v]=!0;const x=v.endsWith(".css"),y=x?'[rel="stylesheet"]':"";if(s)for(let E=f.length-1;E>=0;E--){const T=f[E];if(T.href===v&&(!x||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${y}`))return;const S=document.createElement("link");if(S.rel=x?"stylesheet":Sv,x||(S.as="script"),S.crossOrigin="",S.href=v,d&&S.setAttribute("nonce",d),document.head.appendChild(S),x)return new Promise((E,T)=>{S.addEventListener("load",E),S.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${v}`)))})}))}function u(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return o.then(f=>{for(const h of f||[])h.status==="rejected"&&u(h.reason);return t().catch(u)})};class ma{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,a,s={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==ma.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof a!="function")throw new TypeError("The callback must be a function.");const o=new a0(t,this,a,s);return this.eventMap[t]||(this.eventMap[t]=[]),s.prepend?this.eventMap[t].unshift(o):this.eventMap[t].push(o),o}addOneTimeListener(t,a,s={}){s.remaining=1,this.addListener(t,a,s)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,a){return t===void 0?this.eventMap[ma.ANY_EVENT]&&this.eventMap[ma.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,s])=>s.length>0):this.eventMap[t]&&this.eventMap[t].length>0?a instanceof a0?this.eventMap[t].filter(o=>o===a).length>0:typeof a=="function"?this.eventMap[t].filter(o=>o.callback===a).length>0:a==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(a=>{a.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(a=>{a.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...a){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let s=[],o=this.eventMap[ma.ANY_EVENT]||[];return this.eventMap[t]&&(o=o.concat(this.eventMap[t])),o.forEach(u=>{if(u.suspended)return;let f=[...a];Array.isArray(u.arguments)&&(f=f.concat(u.arguments)),u.remaining>0&&(s.push(u.callback.apply(u.context,f)),u.count++),--u.remaining<1&&u.remove()}),s}removeListener(t,a,s={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let o=this.eventMap[t].filter(u=>a&&u.callback!==a||s.remaining&&s.remaining!==u.remaining||s.context&&s.context!==u.context);o.length?this.eventMap[t]=o:delete this.eventMap[t]}async waitFor(t,a={}){return a.duration=parseInt(a.duration),(isNaN(a.duration)||a.duration<=0)&&(a.duration=1/0),new Promise((s,o)=>{let u,f=this.addListener(t,()=>{clearTimeout(u),s()},{remaining:1});a.duration!==1/0&&(u=setTimeout(()=>{f.remove(),o("The duration expired before the event was emitted.")},a.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class a0{constructor(t,a,s,o={}){if(typeof t!="string"&&!(t instanceof String)&&t!==ma.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!a)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof s!="function")throw new TypeError("The 'callback' must be a function.");o.arguments!==void 0&&!Array.isArray(o.arguments)&&(o.arguments=[o.arguments]),o=Object.assign({context:a,remaining:1/0,arguments:void 0,duration:1/0},o),o.duration!==1/0&&setTimeout(()=>this.remove(),o.duration),this.arguments=o.arguments,this.callback=s,this.context=o.context,this.count=0,this.event=t,this.remaining=parseInt(o.remaining)>=1?parseInt(o.remaining):1/0,this.suspended=!1,this.target=a}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}class fe{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),fe.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),fe.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),fe.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),fe.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}class rs{constructor(t,a={}){this.duration=me.defaults.note.duration,this.attack=me.defaults.note.attack,this.release=me.defaults.note.release,a.duration!=null&&(this.duration=a.duration),a.attack!=null&&(this.attack=a.attack),a.rawAttack!=null&&(this.attack=ye.from7bitToFloat(a.rawAttack)),a.release!=null&&(this.release=a.release),a.rawRelease!=null&&(this.release=ye.from7bitToFloat(a.rawRelease)),Number.isInteger(t)?this.identifier=ye.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const a=ye.getNoteDetails(t);if(me.validation&&!t)throw new Error("Invalid note identifier");this._name=a.name,this._accidental=a.accidental,this._octave=a.octave}get name(){return this._name}set name(t){if(me.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(me.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(me.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(me.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(me.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(me.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return ye.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=ye.from7bitToFloat(t)}get rawRelease(){return ye.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=ye.from7bitToFloat(t)}get number(){return ye.toNoteNumber(this.identifier)}getOffsetNumber(t=0,a=0){return me.validation&&(t=parseInt(t)||0,a=parseInt(a)||0),Math.min(Math.max(this.number+t*12+a,0),127)}}class ye{static toNoteNumber(t,a=0){if(a=a==null?0:parseInt(a),isNaN(a))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const s=this.getNoteDetails(t);if(!s)throw new TypeError("Invalid note identifier");const o={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let u=(s.octave+1+a)*12;if(u+=o[s.name],s.accidental&&(s.accidental.startsWith("b")?u-=s.accidental.length:u+=s.accidental.length),u<0||u>127)throw new RangeError("Invalid octaveOffset value");return u}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const a=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!a)throw new TypeError("Invalid note identifier");const s=a[1].toUpperCase(),o=parseInt(a[3]);let u=a[2].toLowerCase();return u=u===""?void 0:u,{accidental:u,identifier:s+(u||"")+o,name:s,octave:o}}static sanitizeChannels(t){let a;if(me.validation){if(t==="all")a=["all"];else if(t==="none")return[]}return Array.isArray(t)?a=t:a=[t],a.indexOf("all")>-1&&(a=fe.MIDI_CHANNEL_NUMBERS),a.map(function(s){return parseInt(s)}).filter(function(s){return s>=1&&s<=16})}static toTimestamp(t){let a=!1;const s=parseFloat(t);return isNaN(s)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?s>=0&&(a=me.time+s):s>=0&&(a=s),a)}static guessNoteNumber(t,a){a=parseInt(a)||0;let s=!1;if(Number.isInteger(t)&&t>=0&&t<=127)s=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)s=parseInt(t);else if(typeof t=="string"||t instanceof String)try{s=this.toNoteNumber(t.trim(),a)}catch{return!1}return s}static toNoteIdentifier(t,a){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(a=a==null?0:parseInt(a),isNaN(a))throw new RangeError("Invalid octaveOffset value");const s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=Math.floor(t/12-1)+a;return s[t%12]+o.toString()}static buildNote(t,a={}){if(a.octaveOffset=parseInt(a.octaveOffset)||0,t instanceof rs)return t;let s=this.guessNoteNumber(t,a.octaveOffset);if(s===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return a.octaveOffset=void 0,new rs(s,a)}static buildNoteArray(t,a={}){let s=[];return Array.isArray(t)||(t=[t]),t.forEach(o=>{s.push(this.buildNote(o,a))}),s}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,a=0){me.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),a=Math.min(Math.max(parseInt(a)||0,0),127));const s=((t<<7)+a)/16383;return Math.min(Math.max(s,0),1)}static fromFloatToMsbLsb(t){me.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const a=Math.round(t*16383);return{msb:a>>7,lsb:a&127}}static offsetNumber(t,a=0,s=0){if(me.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");a=parseInt(a)||0,s=parseInt(s)||0}return Math.min(Math.max(t+a*12+s,0),127)}static getPropertyByValue(t,a){return Object.keys(t).find(s=>t[s]===a)}static getCcNameByNumber(t){if(!(me.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return fe.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let a=fe.CONTROL_CHANGE_MESSAGES.find(s=>s.name===t);return a?a.number:fe.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let a in fe.CHANNEL_MODE_MESSAGES)if(fe.CHANNEL_MODE_MESSAGES.hasOwnProperty(a)&&t===fe.CHANNEL_MODE_MESSAGES[a])return a;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}class Av extends ma{constructor(t,a){super(),this._output=t,this._number=a,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,a={time:0}){return this.output.send(t,a),this}sendKeyAftertouch(t,a,s={}){if(me.validation){if(s.useRawValue&&(s.rawValue=s.useRawValue),isNaN(parseFloat(a)))throw new RangeError("Invalid key aftertouch value.");if(s.rawValue){if(!(a>=0&&a<=127&&Number.isInteger(a)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(a>=0&&a<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}s.rawValue||(a=ye.fromFloatTo7Bit(a));const o=me.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),ye.buildNoteArray(t).forEach(u=>{this.send([(fe.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),u.getOffsetNumber(o),a],{time:ye.toTimestamp(s.time)})}),this}sendControlChange(t,a,s={}){if(typeof t=="string"&&(t=ye.getCcNumberByName(t)),Array.isArray(a)||(a=[a]),me.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(a=a.map(o=>{const u=Math.min(Math.max(parseInt(o),0),127);if(isNaN(u))throw new TypeError("Values must be integers between 0 and 127");return u}),a.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return a.forEach((o,u)=>{this.send([(fe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+u*32,a[u]],{time:ye.toTimestamp(s.time)})}),this}_selectNonRegisteredParameter(t,a={}){return this.sendControlChange(99,t[0],a),this.sendControlChange(98,t[1],a),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,a={}){return this.sendControlChange(101,t[0],a),this.sendControlChange(100,t[1],a),this}_setCurrentParameter(t,a={}){return t=[].concat(t),this.sendControlChange(6,t[0],a),t.length<2?this:(this.sendControlChange(38,t[1],a),this)}sendRpnDecrement(t,a={}){if(Array.isArray(t)||(t=fe.REGISTERED_PARAMETERS[t]),me.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let s=!1;if(Object.getOwnPropertyNames(fe.REGISTERED_PARAMETERS).forEach(o=>{fe.REGISTERED_PARAMETERS[o][0]===t[0]&&fe.REGISTERED_PARAMETERS[o][1]===t[1]&&(s=!0)}),!s)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,a),this.sendControlChange(97,0,a),this._deselectRegisteredParameter(a),this}sendRpnIncrement(t,a={}){if(Array.isArray(t)||(t=fe.REGISTERED_PARAMETERS[t]),me.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let s=!1;if(Object.getOwnPropertyNames(fe.REGISTERED_PARAMETERS).forEach(o=>{fe.REGISTERED_PARAMETERS[o][0]===t[0]&&fe.REGISTERED_PARAMETERS[o][1]===t[1]&&(s=!0)}),!s)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,a),this.sendControlChange(96,0,a),this._deselectRegisteredParameter(a),this}playNote(t,a={}){this.sendNoteOn(t,a);const s=Array.isArray(t)?t:[t];for(let o of s)if(parseInt(o.duration)>0){const u={time:(ye.toTimestamp(a.time)||me.time)+parseInt(o.duration),release:o.release,rawRelease:o.rawRelease};this.sendNoteOff(o,u)}else if(parseInt(a.duration)>0){const u={time:(ye.toTimestamp(a.time)||me.time)+parseInt(a.duration),release:a.release,rawRelease:a.rawRelease};this.sendNoteOff(o,u)}return this}sendNoteOff(t,a={}){if(me.validation){if(a.rawRelease!=null&&!(a.rawRelease>=0&&a.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(a.release!=null&&!(a.release>=0&&a.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");a.rawVelocity&&(a.rawRelease=a.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),a.velocity&&(a.release=a.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let s=64;a.rawRelease!=null?s=a.rawRelease:isNaN(a.release)||(s=Math.round(a.release*127));const o=me.octaveOffset+this.output.octaveOffset+this.octaveOffset;return ye.buildNoteArray(t,{rawRelease:parseInt(s)}).forEach(u=>{this.send([(fe.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),u.getOffsetNumber(o),u.rawRelease],{time:ye.toTimestamp(a.time)})}),this}stopNote(t,a={}){return this.sendNoteOff(t,a)}sendNoteOn(t,a={}){if(me.validation){if(a.rawAttack!=null&&!(a.rawAttack>=0&&a.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(a.attack!=null&&!(a.attack>=0&&a.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");a.rawVelocity&&(a.rawAttack=a.velocity,a.rawRelease=a.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),a.velocity&&(a.attack=a.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let s=64;a.rawAttack!=null?s=a.rawAttack:isNaN(a.attack)||(s=Math.round(a.attack*127));const o=me.octaveOffset+this.output.octaveOffset+this.octaveOffset;return ye.buildNoteArray(t,{rawAttack:s}).forEach(u=>{this.send([(fe.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),u.getOffsetNumber(o),u.rawAttack],{time:ye.toTimestamp(a.time)})}),this}sendChannelMode(t,a=0,s={}){if(typeof t=="string"&&(t=fe.CHANNEL_MODE_MESSAGES[t]),me.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(a))||a<0||a>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(fe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,a],{time:ye.toTimestamp(s.time)}),this}sendOmniMode(t,a={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,a):this.sendChannelMode("omnimodeoff",0,a),this}sendChannelAftertouch(t,a={}){if(me.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(a.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return a.rawValue||(t=ye.fromFloatTo7Bit(t)),this.send([(fe.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:ye.toTimestamp(a.time)}),this}sendMasterTuning(t,a={}){if(t=parseFloat(t)||0,me.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let s=Math.floor(t)+64,o=t-Math.floor(t);o=Math.round((o+1)/2*16383);let u=o>>7&127,f=o&127;return this.sendRpnValue("channelcoarsetuning",s,a),this.sendRpnValue("channelfinetuning",[u,f],a),this}sendModulationRange(t,a,s={}){if(me.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(a!=null&&(!Number.isInteger(a)||!(a>=0&&a<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return a>=0&&a<=127||(a=0),this.sendRpnValue("modulationrange",[t,a],s),this}sendNrpnValue(t,a,s={}){if(a=[].concat(a),me.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");a.forEach(o=>{if(!(o>=0&&o<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,s),this._setCurrentParameter(a,s),this._deselectNonRegisteredParameter(s),this}sendPitchBend(t,a={}){if(me.validation)if(a.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(a.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let s=0,o=0;if(a.rawValue&&Array.isArray(t))s=t[0],o=t[1];else if(a.rawValue&&!Array.isArray(t))s=t;else{const u=ye.fromFloatToMsbLsb((t+1)/2);s=u.msb,o=u.lsb}return this.send([(fe.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),o,s],{time:ye.toTimestamp(a.time)}),this}sendPitchBendRange(t,a,s={}){if(me.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(a)||!(a>=0&&a<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,a],s),this}sendProgramChange(t,a={}){if(t=parseInt(t)||0,me.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(fe.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:ye.toTimestamp(a.time)}),this}sendRpnValue(t,a,s={}){if(Array.isArray(t)||(t=fe.REGISTERED_PARAMETERS[t]),me.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(a).forEach(o=>{if(!(o>=0&&o<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,s),this._setCurrentParameter(a,s),this._deselectRegisteredParameter(s),this}sendTuningBank(t,a={}){if(me.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,a),this}sendTuningProgram(t,a={}){if(me.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,a),this}sendLocalControl(t,a={}){return t?this.sendChannelMode("localcontrol",127,a):this.sendChannelMode("localcontrol",0,a)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,a={}){return t==="mono"?this.sendChannelMode("monomodeon",0,a):this.sendChannelMode("polymodeon",0,a)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}class of extends ma{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let a=1;a<=16;a++)this.channels[a]=new Av(this,a);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let a={timestamp:me.time};t.port.connection==="open"?(a.type="opened",a.target=this,a.port=a.target,this.emit("opened",a)):t.port.connection==="closed"&&t.port.state==="connected"?(a.type="closed",a.target=this,a.port=a.target,this.emit("closed",a)):t.port.connection==="closed"&&t.port.state==="disconnected"?(a.type="disconnected",a.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",a)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,a={time:0},s=0){if(t instanceof X0&&(t=ye.isNode?t.data:t.rawData),t instanceof Uint8Array&&ye.isNode&&(t=Array.from(t)),me.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(a)&&(t=t.concat(a)),a=isNaN(s)?{time:0}:{time:s}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(o=>{if(o=parseInt(o),!(o>=0&&o<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),a||(a={time:0})}return this._midiOutput.send(t,ye.toTimestamp(a.time)),this}sendSysex(t,a=[],s={}){if(t=[].concat(t),a instanceof Uint8Array){const o=new Uint8Array(1+t.length+a.length+1);o[0]=fe.SYSTEM_MESSAGES.sysex,o.set(Uint8Array.from(t),1),o.set(a,1+t.length),o[o.length-1]=fe.SYSTEM_MESSAGES.sysexend,this.send(o,{time:s.time})}else{const o=t.concat(a,fe.SYSTEM_MESSAGES.sysexend);this.send([fe.SYSTEM_MESSAGES.sysex].concat(o),{time:s.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():me.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,a={}){if(me.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([fe.SYSTEM_MESSAGES.timecode,t],{time:a.time}),this}sendSongPosition(t=0,a={}){t=Math.floor(t)||0;var s=t>>7&127,o=t&127;return this.send([fe.SYSTEM_MESSAGES.songposition,s,o],{time:a.time}),this}sendSongSelect(t=0,a={}){if(me.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([fe.SYSTEM_MESSAGES.songselect,t],{time:a.time}),this}sendTuneRequest(t={}){return this.send([fe.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([fe.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([fe.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([fe.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([fe.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([fe.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([fe.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return me.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,a,s={}){return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o].sendKeyAftertouch(t,a,s)}),this}sendControlChange(t,a,s={},o={}){if(me.validation&&(Array.isArray(s)||Number.isInteger(s)||s==="all")){const u=s;s=o,s.channels=u,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)}return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(u=>{this.channels[u].sendControlChange(t,a,s)}),this}sendPitchBendRange(t=0,a=0,s={}){return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o].sendPitchBendRange(t,a,s)}),this}setPitchBendRange(t=0,a=0,s="all",o={}){return me.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),o.channels=s,o.channels==="all"&&(o.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,a,o)}sendRpnValue(t,a,s={}){return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o].sendRpnValue(t,a,s)}),this}setRegisteredParameter(t,a=[],s="all",o={}){return me.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),o.channels=s,o.channels==="all"&&(o.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,a,o)}sendChannelAftertouch(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendChannelAftertouch(t,a)}),this}sendPitchBend(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendPitchBend(t,a)}),this}sendProgramChange(t=0,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendProgramChange(t,a)}),this}sendModulationRange(t,a,s={}){return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o].sendModulationRange(t,a,s)}),this}setModulationRange(t=0,a=0,s="all",o={}){return me.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),o.channels=s,o.channels==="all"&&(o.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,a,o)}sendMasterTuning(t,a={}){return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(s=>{this.channels[s].sendMasterTuning(t,a)}),this}setMasterTuning(t,a={},s={}){return me.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),s.channels=a,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,s)}sendTuningProgram(t,a={}){return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(s=>{this.channels[s].sendTuningProgram(t,a)}),this}setTuningProgram(t,a="all",s={}){return me.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),s.channels=a,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,s)}sendTuningBank(t=0,a={}){return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(s=>{this.channels[s].sendTuningBank(t,a)}),this}setTuningBank(t,a="all",s={}){return me.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),s.channels=a,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,s)}sendChannelMode(t,a=0,s={},o={}){if(me.validation&&(Array.isArray(s)||Number.isInteger(s)||s==="all")){const u=s;s=o,s.channels=u,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)}return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(u=>{this.channels[u].sendChannelMode(t,a,s)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},a={}){if(me.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const s=t;t=a,t.channels=s,t.channels==="all"&&(t.channels=fe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendPolyphonicMode(t,a)}),this}sendLocalControl(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendLocalControl(t,a)}),this}sendOmniMode(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendOmniMode(t,a)}),this}sendNrpnValue(t,a,s={}){return s.channels==null&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o].sendNrpnValue(t,a,s)}),this}setNonRegisteredParameter(t,a=[],s="all",o={}){return me.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),o.channels=s,o.channels==="all"&&(o.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,a,o)}sendRpnIncrement(t,a={}){return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(s=>{this.channels[s].sendRpnIncrement(t,a)}),this}incrementRegisteredParameter(t,a="all",s={}){return me.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),s.channels=a,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,s)}sendRpnDecrement(t,a={}){return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(s=>{this.channels[s].sendRpnDecrement(t,a)}),this}decrementRegisteredParameter(t,a="all",s={}){return me.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),s.channels=a,s.channels==="all"&&(s.channels=fe.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,s)}sendNoteOff(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendNoteOff(t,a)}),this}stopNote(t,a){return this.sendNoteOff(t,a)}playNote(t,a={},s={}){if(me.validation&&(a.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),a.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].playNote(t,a)}),this}sendNoteOn(t,a={},s={}){if(me.validation&&(Array.isArray(a)||Number.isInteger(a)||a==="all")){const o=a;a=s,a.channels=o,a.channels==="all"&&(a.channels=fe.MIDI_CHANNEL_NUMBERS)}return a.channels==null&&(a.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(a.channels).forEach(o=>{this.channels[o].sendNoteOn(t,a)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}class r0{constructor(t=[],a={}){this.destinations=[],this.types=[...Object.keys(fe.SYSTEM_MESSAGES),...Object.keys(fe.CHANNEL_MESSAGES)],this.channels=fe.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),a.types&&!Array.isArray(a.types)&&(a.types=[a.types]),a.channels&&!Array.isArray(a.channels)&&(a.channels=[a.channels]),me.validation&&(t.forEach(s=>{if(!(s instanceof of))throw new TypeError("Destinations must be of type 'Output'.")}),a.types!==void 0&&a.types.forEach(s=>{if(!fe.SYSTEM_MESSAGES.hasOwnProperty(s)&&!fe.CHANNEL_MESSAGES.hasOwnProperty(s))throw new TypeError("Type must be a valid message type.")}),a.channels!==void 0&&a.channels.forEach(s=>{if(!fe.MIDI_CHANNEL_NUMBERS.includes(s))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,a.types&&(this.types=a.types),a.channels&&(this.channels=a.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(a=>{me.validation&&!(a instanceof of)||a.send(t)}))}}class Tv extends ma{constructor(t,a){super(),this._input=t,this._number=a,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const a=Object.assign({},t);a.port=this.input,a.target=this,a.type="midimessage",this.emit(a.type,a),this._parseEventForStandardMessages(a)}_parseEventForStandardMessages(t){const a=Object.assign({},t);a.type=a.message.type||"unknownmessage";const s=t.message.dataBytes[0],o=t.message.dataBytes[1];if(a.type==="noteoff"||a.type==="noteon"&&o===0)this.notesState[s]=!1,a.type="noteoff",a.note=new rs(ye.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+me.octaveOffset),{rawAttack:0,rawRelease:o}),a.value=ye.from7bitToFloat(o),a.rawValue=o,a.velocity=a.note.release,a.rawVelocity=a.note.rawRelease;else if(a.type==="noteon")this.notesState[s]=!0,a.note=new rs(ye.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+me.octaveOffset),{rawAttack:o}),a.value=ye.from7bitToFloat(o),a.rawValue=o,a.velocity=a.note.attack,a.rawVelocity=a.note.rawAttack;else if(a.type==="keyaftertouch")a.note=new rs(ye.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+me.octaveOffset)),a.value=ye.from7bitToFloat(o),a.rawValue=o,a.identifier=a.note.identifier,a.key=a.note.number,a.rawKey=s;else if(a.type==="controlchange"){a.controller={number:s,name:fe.CONTROL_CHANGE_MESSAGES[s].name,description:fe.CONTROL_CHANGE_MESSAGES[s].description,position:fe.CONTROL_CHANGE_MESSAGES[s].position},a.subtype=a.controller.name||"controller"+s,a.value=ye.from7bitToFloat(o),a.rawValue=o;const u=Object.assign({},a);u.type=`${a.type}-controller${s}`,delete u.subtype,this.emit(u.type,u);const f=Object.assign({},a);f.type=`${a.type}-`+fe.CONTROL_CHANGE_MESSAGES[s].name,delete f.subtype,f.type.indexOf("controller")!==0&&this.emit(f.type,f),a.message.dataBytes[0]>=120&&this._parseChannelModeMessage(a),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(a.message.dataBytes[0])&&this._parseEventForParameterNumber(a)}else a.type==="programchange"?(a.value=s,a.rawValue=a.value):a.type==="channelaftertouch"?(a.value=ye.from7bitToFloat(s),a.rawValue=s):a.type==="pitchbend"?(a.value=((o<<7)+s-8192)/8192,a.rawValue=(o<<7)+s):a.type="unknownmessage";this.emit(a.type,a)}_parseChannelModeMessage(t){const a=Object.assign({},t);a.type=a.controller.name,a.type==="localcontrol"&&(a.value=a.message.data[2]===127,a.rawValue=a.message.data[2]),a.type==="omnimodeon"?(a.type="omnimode",a.value=!0,a.rawValue=a.message.data[2]):a.type==="omnimodeoff"&&(a.type="omnimode",a.value=!1,a.rawValue=a.message.data[2]),a.type==="monomodeon"?(a.type="monomode",a.value=!0,a.rawValue=a.message.data[2]):a.type==="polymodeon"&&(a.type="monomode",a.value=!1,a.rawValue=a.message.data[2]),this.emit(a.type,a)}_parseEventForParameterNumber(t){const a=t.message.dataBytes[0],s=t.message.dataBytes[1];a===99||a===101?(this._nrpnBuffer=[],this._rpnBuffer=[],a===99?this._nrpnBuffer=[t.message]:s!==127&&(this._rpnBuffer=[t.message])):a===98||a===100?a===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&s!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(a===6||a===38||a===96||a===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,a,s,o){t=t==="nrpn"?"nrpn":"rpn";const u={target:o.target,timestamp:o.timestamp,message:o.message,parameterMsb:a,parameterLsb:s,value:ye.from7bitToFloat(o.message.dataBytes[1]),rawValue:o.message.dataBytes[1]};t==="rpn"?u.parameter=Object.keys(fe.REGISTERED_PARAMETERS).find(d=>fe.REGISTERED_PARAMETERS[d][0]===a&&fe.REGISTERED_PARAMETERS[d][1]===s):u.parameter=(a<<7)+s;const f=fe.CONTROL_CHANGE_MESSAGES[o.message.dataBytes[0]].name;u.type=`${t}-${f}`,this.emit(u.type,u);const h=Object.assign({},u);h.type==="nrpn-dataincrement"?h.type="nrpn-databuttonincrement":h.type==="nrpn-datadecrement"?h.type="nrpn-databuttondecrement":h.type==="rpn-dataincrement"?h.type="rpn-databuttonincrement":h.type==="rpn-datadecrement"&&(h.type="rpn-databuttondecrement"),this.emit(h.type,h),u.type=t,u.subtype=f,this.emit(u.type,u)}getChannelModeByNumber(t){return me.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),ye.getChannelModeByNumber(t)}getCcNameByNumber(t){if(me.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return ye.getCcNameByNumber(t)}getNoteState(t){t instanceof rs&&(t=t.identifier);const a=ye.guessNoteNumber(t,me.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[a]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}class X0{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=ye.getPropertyByValue(fe.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=ye.getPropertyByValue(fe.SYSTEM_MESSAGES,this.command)),this.statusByte===fe.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}class wv extends ma{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let a=1;a<=16;a++)this.channels[a]=new Tv(this,a);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let a={timestamp:me.time,target:this,port:this};t.port.connection==="open"?(a.type="opened",this.emit("opened",a)):t.port.connection==="closed"&&t.port.state==="connected"?(a.type="closed",this.emit("closed",a)):t.port.connection==="closed"&&t.port.state==="disconnected"?(a.type="disconnected",a.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",a)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const a=new X0(t.data),s={port:this,target:this,message:a,timestamp:t.timeStamp,type:"midimessage",data:a.data,rawData:a.data,statusByte:a.data[0],dataBytes:a.dataBytes};this.emit("midimessage",s),a.isSystemMessage?this._parseEvent(s):a.isChannelMessage&&this.channels[a.channel]._processMidiMessageEvent(s),this._forwarders.forEach(o=>o.forward(a))}_parseEvent(t){const a=Object.assign({},t);a.type=a.message.type||"unknownmidimessage",a.type==="songselect"&&(a.song=t.data[1]+1,a.value=t.data[1],a.rawValue=a.value),this.emit(a.type,a)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){me.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,a,s={}){if(me.validation&&typeof s=="function"){let o=a!=null?[].concat(a):void 0;a=s,s={channels:o}}if(fe.CHANNEL_EVENTS.includes(t)){s.channels===void 0&&(s.channels=fe.MIDI_CHANNEL_NUMBERS);let o=[];return ye.sanitizeChannels(s.channels).forEach(u=>{o.push(this.channels[u].addListener(t,a,s))}),o}else return super.addListener(t,a,s)}addOneTimeListener(t,a,s={}){return s.remaining=1,this.addListener(t,a,s)}on(t,a,s,o){return this.addListener(t,a,s,o)}hasListener(t,a,s={}){if(me.validation&&typeof s=="function"){let o=[].concat(a);a=s,s={channels:o}}return fe.CHANNEL_EVENTS.includes(t)?(s.channels===void 0&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),ye.sanitizeChannels(s.channels).every(o=>this.channels[o].hasListener(t,a))):super.hasListener(t,a)}removeListener(t,a,s={}){if(me.validation&&typeof s=="function"){let o=[].concat(a);a=s,s={channels:o}}if(s.channels===void 0&&(s.channels=fe.MIDI_CHANNEL_NUMBERS),t==null)return ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o]&&this.channels[o].removeListener()}),super.removeListener();fe.CHANNEL_EVENTS.includes(t)?ye.sanitizeChannels(s.channels).forEach(o=>{this.channels[o].removeListener(t,a,s)}):super.removeListener(t,a,s)}addForwarder(t,a={}){let s;return t instanceof r0?s=t:s=new r0(t,a),this._forwarders.push(s),s}removeForwarder(t){this._forwarders=this._forwarders.filter(a=>a!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return me.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}class Cv extends ma{constructor(){super(),this.defaults={note:{attack:ye.from7bitToFloat(64),release:ye.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},a=!1){if(ye.isNode)try{window.navigator}catch{let h=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,h)}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:a}),a&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const s={timestamp:this.time,target:this,type:"error",error:void 0},o={timestamp:this.time,target:this,type:"midiaccessgranted"},u={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(f){return s.error=f,this.emit("error",s),typeof t.callback=="function"&&t.callback(f),Promise.reject(f)}this.emit("midiaccessgranted",o),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(f){return s.error=f,this.emit("error",s),typeof t.callback=="function"&&t.callback(f),Promise.reject(f)}return this.emit("enabled",u),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,a={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(a.disconnected){for(let s=0;s<this._disconnectedInputs.length;s++)if(this._disconnectedInputs[s]._midiInput&&this._disconnectedInputs[s].id===t.toString())return this._disconnectedInputs[s]}else for(let s=0;s<this.inputs.length;s++)if(this.inputs[s]._midiInput&&this.inputs[s].id===t.toString())return this.inputs[s]}getInputByName(t,a={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(a.disconnected){for(let s=0;s<this._disconnectedInputs.length;s++)if(~this._disconnectedInputs[s].name.indexOf(t))return this._disconnectedInputs[s]}else for(let s=0;s<this.inputs.length;s++)if(~this.inputs[s].name.indexOf(t))return this.inputs[s]}getOutputByName(t,a={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(a.disconnected){for(let s=0;s<this._disconnectedOutputs.length;s++)if(~this._disconnectedOutputs[s].name.indexOf(t))return this._disconnectedOutputs[s]}else for(let s=0;s<this.outputs.length;s++)if(~this.outputs[s].name.indexOf(t))return this.outputs[s]}getOutputById(t,a={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(a.disconnected){for(let s=0;s<this._disconnectedOutputs.length;s++)if(this._disconnectedOutputs[s]._midiOutput&&this._disconnectedOutputs[s].id===t.toString())return this._disconnectedOutputs[s]}else for(let s=0;s<this.outputs.length;s++)if(this.outputs[s]._midiOutput&&this.outputs[s].id===t.toString())return this.outputs[s]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),ye.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?ye.getNoteDetails(ye.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),ye.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),ye.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),ye.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,a={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),ye.buildNoteArray(t,a)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),ye.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(a=>t.push(a.destroy())),this.outputs.forEach(a=>t.push(a.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let a={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?a.port=this.getOutputById(t.port.id):t.port.type==="input"&&(a.port=this.getInputById(t.port.id)),this.emit(t.port.state,a);const s=Object.assign({},a);s.type="portschanged",this.emit(s.type,s)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?a.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(a.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,a);const s=Object.assign({},a);s.type="portschanged",this.emit(s.type,s)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let a=this._inputs.length-1;a>=0;a--){const s=this._inputs[a];Array.from(this.interface.inputs.values()).find(u=>u===s._midiInput)||(this._disconnectedInputs.push(s),this._inputs.splice(a,1))}let t=[];return this.interface.inputs.forEach(a=>{if(!this._inputs.find(s=>s._midiInput===a)){let s=this._disconnectedInputs.find(o=>o._midiInput===a);s||(s=new wv(a)),this._inputs.push(s),t.push(s.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let a=this._outputs.length-1;a>=0;a--){const s=this._outputs[a];Array.from(this.interface.outputs.values()).find(u=>u===s._midiOutput)||(this._disconnectedOutputs.push(s),this._outputs.splice(a,1))}let t=[];return this.interface.outputs.forEach(a=>{if(!this._outputs.find(s=>s._midiOutput===a)){let s=this._disconnectedOutputs.find(o=>o._midiOutput===a);s||(s=new of(a)),this._outputs.push(s),t.push(s.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),ye.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),ye.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.14"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),fe.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),fe.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),fe.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),fe.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),fe.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const me=new Cv;me.constructor=null;const Mv=async()=>{if(me.enabled)return me;try{return await me.enable({sysex:!0}),console.log("WebMidi is enabled with SysEx support!"),me}catch(r){throw console.error("WebMidi could not be enabled.",r),r}},i0=()=>me.enabled?me.inputs.map(r=>({id:r.id,name:r.name})):[],Nv=(r,t)=>{if(me.enabled){const a=me.getInputById(r);if(a){const s=f=>{t({type:"noteon",note:f.note.identifier,velocity:f.velocity,controller:null,channel:f.message.channel})},o=f=>{t({type:"noteoff",note:f.note.identifier,velocity:0,controller:null,channel:f.message.channel})},u=f=>{t({type:"controlchange",controller:f.controller.number,value:f.rawValue,note:null,channel:f.message.channel})};return a.addListener("noteon",s),a.addListener("noteoff",o),a.addListener("controlchange",u),()=>{a.removeListener("noteon",s),a.removeListener("noteoff",o),a.removeListener("controlchange",u)}}}return()=>{}},Rv=r=>{if(me.enabled){const t=a=>{r(a)};return me.addListener("connected",t),me.addListener("disconnected",t),()=>{me.removeListener("connected",t),me.removeListener("disconnected",t)}}return()=>{}},Dv=(r,t)=>{if(me.enabled){const a=me.getInputById(r);if(a){const s=me.outputs.find(o=>o.name===a.name);s?(s.sendSysex(71,t),console.log(`Sent SysEx to ${s.name}`)):console.warn("Could not find matching MIDI Output for SysEx")}}},Go=(r,t,a,s)=>{if(me.enabled){const o=me.getInputById(r);if(o){const u=me.outputs.find(f=>f.name===o.name);u&&u.sendNoteOn(t,{attack:a/127,channels:s})}}},Z0=C.createContext(null),Qo=()=>C.useContext(Z0),_v=({children:r,onMidiCommand:t})=>{const[a,s]=C.useState(!1),[o,u]=C.useState([]),[f,h]=C.useState(""),[d,g]=C.useState(!1),[v,x]=C.useState(null),[y,S]=C.useState({}),[E,T]=C.useState(null),[R,j]=C.useState(!1),M=C.useRef(!1),D=C.useRef(t);C.useEffect(()=>{D.current=t},[t]),C.useEffect(()=>{(async()=>{try{await Mv(),s(!0);const B=i0();if(u(B),Rv(()=>{console.log("MIDI Device change detected, refreshing inputs..."),u(i0())}),window.electronAPI&&window.electronAPI.getSelectedMidiInput){const U=await window.electronAPI.getSelectedMidiInput();U&&B.some(le=>le.id===U)?h(U):B.length>0&&(f||h(B[0].id))}else B.length>0&&(f||h(B[0].id));if(window.electronAPI&&window.electronAPI.getMidiMappings){const U=await window.electronAPI.getMidiMappings();U&&(console.log("Loaded saved MIDI mappings:",U),S(U))}}catch(B){console.error("MIDI Init Failed:",B)}})()},[]);const I=async()=>{window.electronAPI&&window.electronAPI.saveMidiMappings&&(await window.electronAPI.saveMidiMappings(y),console.log("MIDI mappings saved to default."))},P=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(y,"midi")},H=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const re=await window.electronAPI.importMappings("midi");re.success&&re.mappings&&(S(re.mappings),console.log("MIDI mappings imported."))}},ie=re=>{const B=o.find(U=>U.id===re);B&&B.name.toLowerCase().includes("apc40")&&(console.log("Detected APC40, sending initialization SysEx..."),Dv(re,[127,41,96,0,4,65,1,1,1]))};C.useEffect(()=>{f&&window.electronAPI&&window.electronAPI.saveSelectedMidiInput&&window.electronAPI.saveSelectedMidiInput(f),f&&a&&ie(f)},[f,a,o]);const se=C.useCallback((re,B,U=null)=>{if(!f||!a)return;const le=y[re];if(le&&le.type==="note"){let ve=0;typeof B=="number"?ve=B:ve=B?127:0;const N=U!==null?U:le.channel;Go(f,le.address,ve,N)}},[f,a,y]);C.useEffect(()=>{let re=()=>{};return f&&(re=Nv(f,B=>{de.current&&T(B),ne(B)})),re},[f,d,v,y]);const de=C.useRef(d);C.useEffect(()=>{de.current=d},[d]);const ne=re=>{if(re.channel===1&&re.note==="D7"){const U=re.type==="noteon";j(U),M.current=U,console.log(`Shift ${U?"Down":"Up"}`);return}if(d&&v){if(re.type==="noteoff")return;const U=re.note||re.controller,le=M.current,ve={type:re.type==="noteon"||re.type==="noteoff"?"note":"cc",channel:re.channel,address:U,requiresShift:le,label:`${le?"":""}CH${re.channel}:${U}`};console.log(`Mapped ${v} to:`,ve),S(N=>({...N,[v]:ve})),x(null);return}Object.entries(y).forEach(([U,le])=>{const ve=(re.type==="noteon"||re.type==="noteoff")&&le.type==="note"&&re.note===le.address&&re.channel===le.channel,N=re.type==="controlchange"&&le.type==="cc"&&re.controller===le.address&&re.channel===le.channel,V=le.type==="cc"||!!le.requiresShift===M.current;if((ve||N)&&V&&D.current){let oe;re.type==="controlchange"?oe=re.value??0:re.type==="noteoff"?oe=0:oe=re.velocity??0,D.current(U,oe,127,re.type)}})},$={midiInitialized:a,midiInputs:o,selectedMidiInputId:f,setSelectedMidiInputId:h,isMapping:d,startMapping:()=>g(!0),stopMapping:()=>{g(!1),x(null)},learningId:v,setLearningId:x,mappings:y,setMappings:S,removeMapping:re=>{S(B=>{const U={...B};return delete U[re],U})},saveMappings:I,exportMappings:P,importMappings:H,initializeApc40:ie,sendFeedback:se,lastMidiEvent:E,isShiftDown:R};return m.jsx(Z0.Provider,{value:$,children:r})},Q0=C.createContext(null),Sf=()=>C.useContext(Q0),Ov=({children:r,onArtnetCommand:t})=>{const[a,s]=C.useState(!1),[o,u]=C.useState(!1),[f,h]=C.useState(null),[d,g]=C.useState({}),[v,x]=C.useState(null),y=C.useRef(t);C.useEffect(()=>{y.current=t},[t]),C.useEffect(()=>{(async()=>{try{if(window.electronAPI&&window.electronAPI.initializeArtnet&&(await window.electronAPI.initializeArtnet()).success&&(s(!0),console.log("Art-Net initialized for mapping")),window.electronAPI&&window.electronAPI.getArtnetMappings){const H=await window.electronAPI.getArtnetMappings();H&&(console.log("Loaded saved Art-Net mappings:",H),g(H))}}catch(H){console.error("Art-Net Init Failed:",H)}})()},[]);const S=async()=>{window.electronAPI&&window.electronAPI.saveArtnetMappings&&(await window.electronAPI.saveArtnetMappings(d),console.log("Art-Net mappings saved."))},E=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(d,"artnet")},T=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const P=await window.electronAPI.importMappings("artnet");P.success&&P.mappings&&(g(P.mappings),console.log("Art-Net mappings imported."))}};C.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onArtnetDataReceived)return window.electronAPI.onArtnetDataReceived(H=>{R.current&&x(H),j(H)})},[o,f,d]);const R=C.useRef(o);C.useEffect(()=>{R.current=o},[o]);const j=P=>{const{universe:H,channel:ie,value:se}=P;if(o&&f){if(se===0)return;const de={universe:H,channel:ie,label:`U${H}:CH${ie+1}`};console.log(`Mapped ${f} to Art-Net:`,de),g(ne=>({...ne,[f]:de})),h(null);return}Object.entries(d).forEach(([de,ne])=>{ne.universe===H&&ne.channel===ie&&y.current&&y.current(de,se)})},I={artnetInitialized:a,isMapping:o,startMapping:()=>u(!0),stopMapping:()=>{u(!1),h(null)},learningId:f,setLearningId:h,mappings:d,setMappings:g,saveMappings:S,exportMappings:E,importMappings:T,lastDmxEvent:v};return m.jsx(Q0.Provider,{value:I,children:r})},K0=C.createContext(null),Ef=()=>C.useContext(K0),kv=({children:r,onCommand:t,enabled:a=!1})=>{const[s,o]=C.useState(!1),[u,f]=C.useState(null),[h,d]=C.useState({}),g=C.useRef(t);C.useEffect(()=>{g.current=t},[t]),C.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getKeyboardMappings){const T=await window.electronAPI.getKeyboardMappings();T&&d(T)}})()},[]);const v=async()=>{window.electronAPI&&window.electronAPI.saveKeyboardMappings&&await window.electronAPI.saveKeyboardMappings(h)},x=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(h,"keyboard")},y=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const E=await window.electronAPI.importMappings("keyboard");E.success&&E.mappings&&d(E.mappings)}};C.useEffect(()=>{const E=T=>{if(a&&!(T.target.tagName==="INPUT"||T.target.tagName==="TEXTAREA"||T.target.isContentEditable)){if(s&&u){T.preventDefault();const R={key:T.code,label:T.code.replace("Key","").replace("Digit","")};d(j=>({...j,[u]:R})),f(null);return}Object.entries(h).forEach(([R,j])=>{T.code===j.key&&(T.preventDefault(),g.current&&g.current(R,1,1,"keydown"))})}};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[a,s,u,h]);const S={isMapping:s,startMapping:()=>o(!0),stopMapping:()=>{o(!1),f(null)},learningId:u,setLearningId:f,mappings:h,setMappings:d,saveMappings:v,exportMappings:x,importMappings:y,removeMapping:E=>d(T=>{const R={...T};return delete R[E],R})};return m.jsx(K0.Provider,{value:S,children:r})},yt=({id:r,children:t})=>{const{isMapping:a,setLearningId:s,removeMapping:o}=Qo(),{isMapping:u,setLearningId:f,removeMapping:h}=Sf()||{},{isMapping:d,setLearningId:g,removeMapping:v}=Ef()||{},x=a||u||d,y=T=>{x&&(T.preventDefault(),T.stopPropagation(),a&&s(r),u&&f(r),d&&g(r))},S=T=>{x&&(T.preventDefault(),T.stopPropagation(),a&&o(r),u&&h(r),d&&v(r))},E=Pr.Children.only(t);return Pr.cloneElement(E,{"data-mappable-id":r,onClickCapture:x?y:E.props.onClickCapture,onContextMenu:x?S:E.props.onContextMenu,className:`${E.props.className||""} ${x?"mappable-target":""}`.trim()})},Lv=({masterIntensity:r,onMasterIntensityChange:t})=>{const a=s=>{s.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_intensity",targetType:"global",label:"MASTER",min:0,max:1,step:.01}))};return m.jsx("div",{className:"master-intensity-slider",draggable:!0,onDragStart:a,children:m.jsx(yt,{id:"master_intensity",children:m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:r,className:"slider_hor",id:"masterIntensityRange",onChange:s=>t(parseFloat(s.target.value))})})})},Uv=({masterIntensity:r,onMasterIntensityChange:t,onClearAllActive:a,isGlobalBlackout:s,onToggleGlobalBlackout:o})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"global",label:h.toUpperCase()}))};return m.jsxs("div",{className:"composition-controls",children:[m.jsx("span",{className:"layer-control-button",children:"Comp"}),m.jsx(yt,{id:"comp_clear",children:m.jsx("span",{className:"layer-control-button",onClick:a,style:{cursor:"pointer"},draggable:!0,onDragStart:f=>u(f,"clear"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),m.jsx(yt,{id:"comp_blackout",style:{width:"100%",display:"flex"},children:m.jsx("span",{className:"layer-control-button",onClick:o,style:{cursor:"pointer",backgroundColor:s?"red":""},draggable:!0,onDragStart:f=>u(f,"blackout"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx(Lv,{masterIntensity:r,onMasterIntensityChange:t})]})},Iv=({name:r,index:t,onTrigger:a,onShowColumnHeaderContextMenu:s})=>{const o=f=>{f.preventDefault(),s&&s(t)},u=f=>{f.button===0&&a&&a()};return m.jsx(yt,{id:`column_${t}`,children:m.jsx("div",{className:"column-header trigger-button",onClick:u,onContextMenu:o,style:{cursor:"pointer"},children:r})})},Qt=[{id:"rotate",name:"Rotate",type:"transform",description:"Rotates the shape around its center.",defaultParams:{angle:0,speed:0,direction:"CW"},paramControls:[{id:"angle",label:"Angle",type:"range",min:0,max:360,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["CW","CCW"]}]},{id:"scale",name:"Scale",type:"transform",description:"Scales the shape.",defaultParams:{scaleX:1,scaleY:1},paramControls:[{id:"scaleX",label:"Scale X",type:"range",min:.01,max:5,step:.01},{id:"scaleY",label:"Scale Y",type:"range",min:.01,max:5,step:.01}]},{id:"translate",name:"Translate",type:"transform",description:"Moves the shape.",defaultParams:{translateX:0,translateY:0},paramControls:[{id:"translateX",label:"Translate X",type:"range",min:-1,max:1,step:.01},{id:"translateY",label:"Translate Y",type:"range",min:-1,max:1,step:.01}]},{id:"color",name:"Color",type:"color",description:"Changes the color of the shape with solid or rainbow modes.",defaultParams:{mode:"solid",r:255,g:255,b:255,cycleSpeed:0,rainbowSpread:1,rainbowOffset:0,rainbowPalette:"rainbow"},paramControls:[{id:"mode",label:"Mode",type:"select",options:["solid","rainbow"]},{id:"r",label:"Red",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"g",label:"Green",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"cycleSpeed",label:"Cycle Speed",type:"range",min:0,max:10,step:.1},{id:"rainbowSpread",label:"Rainbow Spread",type:"range",min:.1,max:10,step:.1,showIf:{mode:"rainbow"}},{id:"rainbowOffset",label:"Rainbow Offset",type:"range",min:0,max:360,step:1,showIf:{mode:"rainbow"}},{id:"rainbowPalette",label:"Palette",type:"select",options:["rainbow","fire","ice","cyber"],showIf:{mode:"rainbow"}}]},{id:"wave",name:"Wave",type:"animation",description:"Applies a wave distortion to the shape.",defaultParams:{amplitude:.1,frequency:10,speed:1,direction:"x"},paramControls:[{id:"amplitude",label:"Amplitude",type:"range",min:.01,max:1,step:.01},{id:"frequency",label:"Frequency",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["x","y"]}]},{id:"warp",name:"Warp",type:"animation",description:"Symmetrical chaotic wave distortion.",defaultParams:{amount:.1,chaos:.5,speed:1},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"chaos",label:"Chaos",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1}]},{id:"distortion",name:"Distortion",type:"transform",description:"Distorts the point data.",defaultParams:{amount:.1,scale:10,speed:.5},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"scale",label:"Scale",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:5,step:.1}]},{id:"move",name:"Move (Bounce)",type:"transform",description:"Moves points and bounces them off the borders.",defaultParams:{speedX:.1,speedY:.1},paramControls:[{id:"speedX",label:"Speed X",type:"range",min:0,max:2,step:.01},{id:"speedY",label:"Speed Y",type:"range",min:0,max:2,step:.01}]},{id:"delay",name:"Delay",type:"effect",description:"Frame or Channel based delay effect.",defaultParams:{mode:"frame",playstyle:"repeat",useCustomOrder:!1,delayDirection:"left_to_right",delayAmount:5,decay:.8,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat","bounce"]},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"delayDirection",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}},{id:"delayAmount",label:"Delay Time",type:"range",min:1,max:60,step:1},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01}]},{id:"chase",name:"Chase",type:"effect",description:"Frame or Channel based chase effect.",defaultParams:{mode:"frame",playstyle:"repeat",steps:4,decay:.8,speed:1,overlap:1,direction:"left_to_right",useCustomOrder:!1,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat","bounce"]},{id:"steps",label:"Steps",type:"range",min:2,max:16,step:1},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:5,step:.1},{id:"overlap",label:"Overlap",type:"range",min:1,max:4,step:1},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"direction",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}}]},{id:"blanking",name:"Blanking",type:"animation",description:"Controls the blanking of the laser output.",defaultParams:{blankingInterval:0,spacing:0},paramControls:[{id:"blankingInterval",label:"Blanking Interval",type:"range",min:0,max:10,step:1},{id:"spacing",label:"Spacing",type:"range",min:0,max:20,step:1}]},{id:"strobe",name:"Strobe",type:"animation",description:"Applies a strobe effect to the laser output.",defaultParams:{strobeSpeed:100,strobeAmount:.5},paramControls:[{id:"strobeSpeed",label:"Strobe Speed (ms)",type:"range",min:10,max:1e3,step:10},{id:"strobeAmount",label:"Strobe Amount (0-1)",type:"range",min:0,max:1,step:.01}]},{id:"mirror",name:"Mirror",type:"transform",description:"Mirrors the shape from the center.",defaultParams:{mode:"none"},paramControls:[{id:"mode",label:"Mirror Mode",type:"select",options:["none","x+","x-","y+","y-"]}]}],jn=(r,t)=>({...t,...r});function W0(r,t,a,s){if(!a)return t;const o=typeof a=="string"?{syncMode:a}:a;if(!o.syncMode)return t;const{time:u,progress:f=0,bpm:h=120,clipDuration:d=0,fftLevels:g={low:0,mid:0,high:0}}=s;let v=0;const x=o.speedMultiplier||1;if(o.syncMode==="fps")v=u*.001*x;else if(o.syncMode==="timeline"){const M=Math.max(.01,o.duration||1);d>0?v=f*d/M*x:v=0}else if(o.syncMode==="bpm"){const M=Math.max(.1,o.beats||4),D=h/60,I=M/(D||2);d>0?v=f*d/I*x:v=0}else if(o.syncMode==="fft"){const M=o.fftRange||"low",D=g[M]||0;return Bv(D,t,o)}const y=o.direction||"forward";if(y==="pause")return t;const S=o.style||"loop";let E=0;if(S==="once")E=Math.min(v,1),y==="backward"&&(E=1-E);else if(S==="bounce"){let M=v%1;Math.floor(v)%2===1?E=1-M:E=M,y==="backward"&&(E=1-E)}else E=v%1,y==="backward"&&(E=1-E);const T=o.range;let R=0,j=1;if(T&&Array.isArray(T)&&T.length===2)R=T[0],j=T[1];else return t;return R+(j-R)*E}function Bv(r,t,a){const s=a.range;return s&&Array.isArray(s)&&s.length===2?s[0]+(s[1]-s[0])*r:t}function pl(r,t,a={}){const{progress:s=0,time:o=performance.now(),effectStates:u,syncSettings:f={},fftLevels:h}=a;if(!t||t.length===0)return r;let d;if(Array.isArray(r.points)){d=new Float32Array(r.points.length*8);for(let x=0;x<r.points.length;x++){const y=r.points[x],S=x*8;d[S]=y.x,d[S+1]=y.y,d[S+2]=y.z||0,d[S+3]=y.r,d[S+4]=y.g,d[S+5]=y.b,d[S+6]=y.blanking?1:0,d[S+7]=y.lastPoint?1:0}}else d=new Float32Array(r.points);let g=d;const v=()=>g.length/8;for(const x of t){if(x.params.enabled===!1||!Qt.find(E=>E.id===x.id))continue;const S={...x.params};for(const E of Object.keys(S)){const T=`${x.id}.${E}`;f[T]&&(S[E]=W0(E,S[E],f[T],a))}switch(x.id){case"rotate":Fv(g,v(),S,s,o);break;case"scale":jv(g,v(),S);break;case"translate":Gv(g,v(),S);break;case"color":Pv(g,v(),S,o);break;case"wave":Hv(g,v(),S,o);break;case"blanking":Yv(g,v(),S);break;case"strobe":Vv(g,v(),S,o);break;case"mirror":g=qv(g,v(),S);break;case"warp":Xv(g,v(),S,o);break;case"distortion":Zv(g,v(),S,o);break;case"move":Qv(g,v(),S,o);break;case"delay":u&&x.instanceId&&(g=Kv(g,v(),S,u,x.instanceId,a));break;case"chase":g=Wv(g,v(),S,o,a);break}}return{...r,points:g,isTypedArray:!0}}function Fv(r,t,a,s,o){const{angle:u,speed:f,direction:h}=jn(a,Qt.find(S=>S.id==="rotate").defaultParams),d=h==="CCW"?-1:1,g=o*.001*f*d,v=u*Math.PI/180+g,x=Math.sin(v),y=Math.cos(v);for(let S=0;S<t;S++){const E=S*8,T=r[E],R=r[E+1];r[E]=T*y-R*x,r[E+1]=T*x+R*y}}function jv(r,t,a){const{scaleX:s,scaleY:o}=jn(a,Qt.find(u=>u.id==="scale").defaultParams);for(let u=0;u<t;u++){const f=u*8;r[f]*=s,r[f+1]*=o}}function Gv(r,t,a){const{translateX:s,translateY:o}=jn(a,Qt.find(u=>u.id==="translate").defaultParams);for(let u=0;u<t;u++){const f=u*8;r[f]+=s,r[f+1]+=o}}function Pv(r,t,a,s){const{mode:o,r:u,g:f,b:h,cycleSpeed:d,rainbowSpread:g,rainbowOffset:v,rainbowPalette:x}=jn(a,Qt.find(S=>S.id==="color").defaultParams),y=s*.001*d;if(o==="rainbow"){const S=x||"rainbow";for(let E=0;E<t;E++){const T=E*8,R=(E/t*g+y*.5+v/360)%1;let j,M,D;S==="rainbow"?[j,M,D]=s0(R,1,.5):[j,M,D]=zv(S,R),r[T+3]=j,r[T+4]=M,r[T+5]=D}}else if(d>0){const S=y*50%360,[E,T,R]=s0(S/360,1,.5);for(let j=0;j<t;j++){const M=j*8;r[M+3]=E,r[M+4]=T,r[M+5]=R}}else for(let S=0;S<t;S++){const E=S*8;r[E+3]=u,r[E+4]=f,r[E+5]=h}}function zv(r,t){const a={fire:[{r:255,g:0,b:0},{r:255,g:128,b:0},{r:255,g:255,b:0},{r:255,g:0,b:0}],ice:[{r:0,g:0,b:255},{r:0,g:255,b:255},{r:255,g:255,b:255},{r:0,g:0,b:255}],cyber:[{r:255,g:0,b:255},{r:0,g:255,b:255},{r:0,g:0,b:255},{r:255,g:0,b:255}]},s=a[r]||a.fire,o=t*(s.length-1),u=Math.floor(o),f=o-u,h=s[u],d=s[u+1]||s[u];return[Math.round(h.r+(d.r-h.r)*f),Math.round(h.g+(d.g-h.g)*f),Math.round(h.b+(d.b-h.b)*f)]}function s0(r,t,a){let s,o,u;{const f=(g,v,x)=>(x<0&&(x+=1),x>1&&(x-=1),x<.16666666666666666?g+(v-g)*6*x:x<.5?v:x<.6666666666666666?g+(v-g)*(.6666666666666666-x)*6:g),h=a+t-a*t,d=2*a-h;s=f(d,h,r+1/3),o=f(d,h,r),u=f(d,h,r-1/3)}return[Math.round(s*255),Math.round(o*255),Math.round(u*255)]}function Hv(r,t,a,s){const{amplitude:o,frequency:u,speed:f,direction:h}=jn(a,Qt.find(g=>g.id==="wave").defaultParams),d=s*.001*f;for(let g=0;g<t;g++){const v=g*8;h==="x"?r[v+1]+=o*Math.sin(r[v]*u+d):h==="y"&&(r[v]+=o*Math.sin(r[v+1]*u+d))}}function Yv(r,t,a){const{blankingInterval:s,spacing:o=0}=jn(a,Qt.find(f=>f.id==="blanking").defaultParams);if(s<=0)return;const u=s+1+o;for(let f=0;f<t;f++)f%u>=s&&(r[f*8+6]=1)}function Vv(r,t,a,s){const{strobeSpeed:o,strobeAmount:u}=jn(a,Qt.find(h=>h.id==="strobe").defaultParams);if(s%o/o<u)for(let h=0;h<t;h++)r[h*8+6]=1}function qv(r,t,a){const{mode:s}=jn(a,Qt.find(d=>d.id==="mirror").defaultParams);if(s==="none")return r;let o=[];for(let d=0;d<t;d++){const g=d*8,v=r[g],x=r[g+1];let y=!1;s==="x-"&&(v<=0||s==="x+"&&(v>=0||s==="y-"&&(x<=0||s==="y+"&&x>=0)))&&(y=!0),y&&o.push({x:r[g],y:r[g+1],z:r[g+2],r:r[g+3],g:r[g+4],b:r[g+5],blk:r[g+6],last:r[g+7]})}const u=o.length*2,f=new Float32Array(u*8);let h=0;for(const d of o)f[h++]=d.x,f[h++]=d.y,f[h++]=d.z,f[h++]=d.r,f[h++]=d.g,f[h++]=d.b,f[h++]=d.blk,f[h++]=d.last;for(const d of o)s==="x-"||s==="x+"?f[h++]=-d.x:f[h++]=d.x,s==="y-"||s==="y+"?f[h++]=-d.y:f[h++]=d.y,f[h++]=d.z,f[h++]=d.r,f[h++]=d.g,f[h++]=d.b,f[h++]=d.blk,f[h++]=d.last;return f}function Xv(r,t,a,s){const{amount:o,chaos:u,speed:f}=jn(a,Qt.find(d=>d.id==="warp").defaultParams),h=s*.001*f;for(let d=0;d<t;d++){const g=d*8,v=r[g],x=r[g+1],y=Math.abs(x);r[g]+=Math.sin(y*10*(1+u)+h)*o*Math.cos(h*u),r[g+1]+=Math.cos(Math.abs(v)*10*(1+u)+h)*o*Math.sin(h*u)}}function Zv(r,t,a,s){const{amount:o,scale:u,speed:f}=jn(a,Qt.find(d=>d.id==="distortion").defaultParams),h=s*.001*f;for(let d=0;d<t;d++){const g=d*8,v=Math.sin(r[g]*u+h)*Math.cos(r[g+1]*u-h),x=Math.cos(r[g]*u-h)*Math.sin(r[g+1]*u+h);r[g]+=v*o,r[g+1]+=x*o}}function Qv(r,t,a,s){const{speedX:o,speedY:u}=jn(a,Qt.find(v=>v.id==="move").defaultParams),f=s*.001,h=f*o,d=f*u,g=4;for(let v=0;v<t;v++){const x=v*8;let y=r[x]+h,S=r[x+1]+d,E=(y+1)%g;E<0&&(E+=g),E>2&&(E=4-E),y=E-1;let T=(S+1)%g;T<0&&(T+=g),T>2&&(T=4-T),S=T-1,r[x]=y,r[x+1]=S}}function Kv(r,t,a,s,o,u){const{mode:f="frame",delayAmount:h,decay:d,delayDirection:g,useCustomOrder:v,customOrder:x}=jn(a,Qt.find(S=>S.id==="delay").defaultParams);s.has(o)||s.set(o,[]);const y=s.get(o);if(y.unshift(new Float32Array(r)),f==="frame"){const E=h*10+1;y.length>E&&(y.length=E);const T=new Float32Array(r.length);for(let R=0;R<t;R++){let j=0;const M=R/t;g==="left_to_right"?j=Math.floor(M*9):g==="right_to_left"?j=Math.floor((1-M)*9):g==="center_to_out"?j=Math.floor(Math.abs(M-.5)*2*9):g==="out_to_center"&&(j=Math.floor((1-Math.abs(M-.5)*2)*9));const D=j*h,I=D<y.length?y[D]:null,P=Math.pow(d,j),H=R*8;I&&I.length===r.length?(T[H]=I[H],T[H+1]=I[H+1],T[H+2]=I[H+2],T[H+3]=I[H+3]*P,T[H+4]=I[H+4]*P,T[H+5]=I[H+5]*P,T[H+6]=I[H+6],T[H+7]=I[H+7]):(T.set(r.subarray(H,H+8),H),T[H+3]=0,T[H+4]=0,T[H+5]=0,T[H+6]=1)}return T}else{const{assignedDacs:S}=u||{};let E=new Map,T=0;if(v||a.delayMode==="channel")(x&&x.length>0?x.map(ne=>ne.originalIndex):S?S.map((ne,Z)=>Z):[0]).forEach((ne,Z)=>{E.set(ne,Z),T=Math.max(T,Z)});else{const ne=(S||[]).length||1;for(let Z=0;Z<ne;Z++){let ee=Z;g==="right_to_left"?ee=ne-1-Z:g==="center_to_out"?ee=Math.floor(Math.abs(Z-(ne-1)/2)):g==="out_to_center"&&(ee=Math.min(Z,ne-1-Z)),E.set(Z,ee),T=Math.max(T,ee)}}const j=T+1,M=h*j+1;y.length>M&&(y.length=M);const D=[];for(let de=0;de<j;de++){const ne=de*h;D.push({points:ne<y.length?y[ne]:null,factor:Math.pow(d,de),index:de})}const I=D.reduce((de,ne)=>de+(ne.points?ne.points.length/8:r.length/8),0),P=new Float32Array(I*8);let H=0;const ie=new Array(D.length);for(let de=0;de<D.length;de++){const ne=D[de],Z=ne.points,ee=Z?Z.length/8:r.length/8;ie[de]=H;for(let ae=0;ae<ee;ae++){const $=ae*8,re=H+ae*8;Z?(P[re]=Z[$],P[re+1]=Z[$+1],P[re+2]=Z[$+2],P[re+3]=Z[$+3]*ne.factor,P[re+4]=Z[$+4]*ne.factor,P[re+5]=Z[$+5]*ne.factor,P[re+6]=Z[$+6],P[re+7]=Z[$+7]):P[re+6]=1}H+=ee*8}const se=new Map;return E.forEach((de,ne)=>{de<D.length&&se.set(ne,{start:ie[de],length:D[de].points?D[de].points.length:r.length})}),P._channelDistributions=se,P}}function Wv(r,t,a,s,o={}){const{mode:u="frame",steps:f,decay:h,speed:d,overlap:g,direction:v,useCustomOrder:x,customOrder:y}=jn(a,Qt.find(S=>S.id==="chase").defaultParams);if(u==="frame"){const S=s*.001*d%f,E=new Float32Array(r.length);for(let T=0;T<t;T++){const R=T/t;let j=0;v==="left_to_right"?j=Math.floor(R*(f-1)):v==="right_to_left"?j=Math.floor((1-R)*(f-1)):v==="center_to_out"?j=Math.floor(Math.abs(R-.5)*2*(f-1)):v==="out_to_center"&&(j=Math.floor((1-Math.abs(R-.5)*2)*(f-1)));let M=Math.abs(S-j);M>f/2&&(M=f-M);let D=M<g?1-M/g:0;h>0&&(D=Math.pow(D,1-h));const I=T*8;E.set(r.subarray(I,I+8),I),E[I+3]*=D,E[I+4]*=D,E[I+5]*=D,D<.05&&(E[I+6]=1)}return E}else{const{assignedDacs:S}=o||{};let E=new Map,T=0;if(x)(y&&y.length>0?y.map(se=>se.originalIndex):S?S.map((se,de)=>de):[0]).forEach((se,de)=>{E.set(se,de),T++});else{T=(S?S.length:1)||1;for(let ie=0;ie<T;ie++){let se=ie;v==="right_to_left"?se=T-1-ie:v==="center_to_out"?se=Math.floor(Math.abs(ie-(T-1)/2)):v==="out_to_center"&&(se=Math.min(ie,T-1-ie)),E.set(ie,se)}}const R=T,j=s*.001*d%R,M=t*T,D=new Float32Array(M*8),I=new Map;let P=0;const H=Array.from(E.keys());H.length===0&&H.push(0);for(const ie of H){const se=E.get(ie)||0;let de=Math.abs(j-se);de>R/2&&(de=R-de);let ne=de<g?1-de/g:0;h>0&&(ne=Math.pow(ne,1-h));const Z=P;for(let ee=0;ee<t;ee++){const ae=ee*8,$=P+ee*8;D.set(r.subarray(ae,ae+8),$),D[$+3]*=ne,D[$+4]*=ne,D[$+5]*=ne,ne<.05&&(D[$+6]=1)}I.set(ie,{start:Z,length:t}),P+=t*8}return D._channelDistributions=I,D}}function uf(r,t){if(!t||!r||!r.points)return r;const{safetyZones:a,outputArea:s,transformationEnabled:o,transformationMode:u,flipX:f,flipY:h}=t;let d=r.points;const g=r.isTypedArray||d instanceof Float32Array,v=g?d.length/8:d.length;let x=g?new Float32Array(d):d.map(y=>({...y}));for(let y=0;y<v;y++){let S,E,T,R,j,M;if(g?(S=x[y*8],E=x[y*8+1],T=x[y*8+3],R=x[y*8+4],j=x[y*8+5],M=x[y*8+6]):(S=x[y].x,E=x[y].y,T=x[y].r,R=x[y].g,j=x[y].b,M=x[y].blanking?1:0),f&&(S=-S),h&&(E=-E),o&&s){let D=(S+1)/2,I=(1-E)/2;u==="crop"?(D<s.x||D>s.x+s.w||I<s.y||I>s.y+s.h)&&(T=0,R=0,j=0,M=1):u==="scale"&&(D=s.x+D*s.w,I=s.y+I*s.h,S=D*2-1,E=1-I*2)}if(a&&a.length>0){let D=(S+1)/2,I=(1-E)/2;for(const P of a)if(D>=P.x&&D<=P.x+P.w&&I>=P.y&&I<=P.y+P.h){T=0,R=0,j=0,M=1;break}}g?(x[y*8]=S,x[y*8+1]=E,x[y*8+3]=T,x[y*8+4]=R,x[y*8+5]=j,x[y*8+6]=M):(x[y].x=S,x[y].y=E,x[y].r=T,x[y].g=R,x[y].b=j,x[y].blanking=M>.5)}return{...r,points:x,isTypedArray:g}}class $v{constructor(t,a){if(this.canvas=t,this.type=a,this.gl=t.getContext("webgl")||t.getContext("experimental-webgl"),this.animationFrameId=null,this.frameIndexes=Array(10).fill(0),this.pointIndexes=Array(10).fill(0),this.showBeamEffect=!1,this.beamAlpha=.5,this.fadeAlpha=.13,this.beamRenderMode="both",this.positionBuffer=null,this.colorBuffer=null,this.alphaBuffer=null,this.lastPointDrawTime=0,!this.gl){console.error("WebGL not supported");return}this.setup()}setup(){const t=this.gl,a=`
      attribute vec2 aPosition;
      attribute vec3 aColor;
      attribute float aAlpha;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
        gl_PointSize = 2.0;
        vColor = aColor;
        vAlpha = aAlpha;
      }
    `,s=`
      precision mediump float;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_FragColor = vec4(vColor, vAlpha);
      }
    `,o=this.createShader(t.VERTEX_SHADER,a),u=this.createShader(t.FRAGMENT_SHADER,s),f=this.createProgram(o,u);this.program=f,this.positionAttributeLocation=t.getAttribLocation(f,"aPosition"),this.colorAttributeLocation=t.getAttribLocation(f,"aColor"),this.alphaAttributeLocation=t.getAttribLocation(f,"aAlpha"),this.quadPositionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.quadPositionBuffer);const h=[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1];t.bufferData(t.ARRAY_BUFFER,new Float32Array(h),t.STATIC_DRAW),this.quadColorUniformLocation=t.getUniformLocation(f,"uColor"),this.quadAlphaUniformLocation=t.getUniformLocation(f,"uAlpha");const d=`
      attribute vec2 aPosition;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
      }
    `,g=`
      precision mediump float;
      uniform vec4 uColor;
      void main() {
        gl_FragColor = uColor;
      }
    `,v=this.createShader(t.VERTEX_SHADER,d),x=this.createShader(t.FRAGMENT_SHADER,g);this.fadeProgram=this.createProgram(v,x),this.fadePositionAttributeLocation=t.getAttribLocation(this.fadeProgram,"aPosition"),this.fadeColorUniformLocation=t.getUniformLocation(this.fadeProgram,"uColor"),t.useProgram(f);const y=131072;this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,y*2*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,y*3*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),this.alphaBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.alphaBuffer),t.bufferData(t.ARRAY_BUFFER,y*1*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(0,0,0,1)}reset(){this.frameIndexes.fill(0),this.pointIndexes.fill(0),this.clearCanvas()}createShader(t,a){const s=this.gl,o=s.createShader(t);if(s.shaderSource(o,a),s.compileShader(o),s.getShaderParameter(o,s.COMPILE_STATUS))return o;console.error(s.getShaderInfoLog(o)),s.deleteShader(o)}createProgram(t,a){const s=this.gl,o=s.createProgram();if(s.attachShader(o,t),s.attachShader(o,a),s.linkProgram(o),s.getProgramParameter(o,s.LINK_STATUS))return o;console.error(s.getProgramInfoLog(o)),s.deleteProgram(o)}render(t){t.showBeamEffect!==void 0&&this.setBeamEffect(t.showBeamEffect),t.beamAlpha!==void 0&&this.setBeamAlpha(t.beamAlpha),t.fadeAlpha!==void 0&&this.setFadeAlpha(t.fadeAlpha),t.beamRenderMode!==void 0&&(this.beamRenderMode=t.beamRenderMode),this.type==="world"?this.renderWorld(t.worldData,t.previewScanRate,t.layerIntensities,t.masterIntensity,t.dacSettings,t.previewTime):this.renderSingle(t.ildaFrames,t.previewScanRate,t.intensity,t.effects,t.syncSettings,t.bpm,t.clipDuration,t.progress,t.previewTime)}renderSingle(t,a,s,o,u={},f=120,h=1,d=null,g=null){const v=this.gl;if(v.viewport(0,0,v.canvas.width,v.canvas.height),this.drawFadeQuad(),!t||t.length===0)return;const x=this.frameIndexes[0]%t.length,y=t[x],S=d!==null?d:x/t.length,E=g!==null?g:performance.now();this.draw(y,o,this.showBeamEffect,this.beamAlpha,a,this.beamRenderMode,s,0,S,E,u,f,h),this.frameIndexes[0]++,this.frameIndexes[0]>=t.length&&(this.frameIndexes[0]=0)}renderWorld(t,a,s,o,u,f=null){const h=this.gl;h.viewport(0,0,h.canvas.width,h.canvas.height),this.drawFadeQuad();const d=f!==null?f:performance.now();t.forEach(g=>{if(g&&g.frames&&g.frames.length>0){const v=g.frames[0];if(v){const x=g.layerIndex||0;if(g.syncSettings,g.bpm,x>=this.frameIndexes.length){const E=x+5;for(;this.frameIndexes.length<E;)this.frameIndexes.push(0),this.pointIndexes.push(0)}const S=(s[x]!==void 0?s[x]:1)*o;if(S>.001){const E=g.progress!==void 0?g.progress:this.frameIndexes[x]%g.frames.length/g.frames.length,{syncSettings:T={},bpm:R=120,clipDuration:j=1}=g;let M=v;if(u){let D=v;if(u.dimmer!==void 0&&u.dimmer<1){const I=v.points,P=v.isTypedArray||I instanceof Float32Array,H=P?I.length/8:I.length,ie=P?new Float32Array(I):I.map(se=>({...se}));for(let se=0;se<H;se++)P?(ie[se*8+3]*=u.dimmer,ie[se*8+4]*=u.dimmer,ie[se*8+5]*=u.dimmer):(ie[se].r*=u.dimmer,ie[se].g*=u.dimmer,ie[se].b*=u.dimmer);D={...v,points:ie,isTypedArray:P}}M=uf(D,u)}this.draw(M,g.effects,this.showBeamEffect,this.beamAlpha,a,this.beamRenderMode,S,x,E,d,T,R,j)}}}}),t.forEach(g=>{if(g&&g.frames){const v=g.layerIndex||0;this.frameIndexes[v]++,this.frameIndexes[v]>=g.frames.length&&(this.frameIndexes[v]=0)}})}drawFadeQuad(){const t=this.gl;this.fadeProgram&&(t.useProgram(this.fadeProgram),t.bindBuffer(t.ARRAY_BUFFER,this.quadPositionBuffer),t.enableVertexAttribArray(this.fadePositionAttributeLocation),t.vertexAttribPointer(this.fadePositionAttributeLocation,2,t.FLOAT,!1,0,0),t.uniform4f(this.fadeColorUniformLocation,0,0,0,this.fadeAlpha),t.drawArrays(t.TRIANGLES,0,6))}setBeamEffect(t){this.showBeamEffect=t}setBeamAlpha(t){this.beamAlpha=t}setFadeAlpha(t){this.fadeAlpha=t}draw(t,a,s,o,u,f,h=1,d=0,g=0,v=performance.now(),x={},y=120,S=1){if(this.gl,!t||!t.points)return;const E=pl(t,a,{progress:g,time:v,syncSettings:x,bpm:y,clipDuration:S}),T=E.points,R=E.isTypedArray,j=R?T.length/8:T.length;if(j===0)return;const M=Math.max(1,Math.floor(j/u));let D=this.pointIndexes[d]||0;D>=j&&(D=0);const I=se=>{const de=(D+se)%j;if(R){const ne=de*8;return{x:T[ne],y:T[ne+1],r:T[ne+3],g:T[ne+4],b:T[ne+5],blanking:T[ne+6]===1}}else{const ne=T[de];return{x:ne.x,y:ne.y,r:ne.r,g:ne.g,b:ne.b,blanking:ne.blanking}}},P=()=>{const se=f==="points"||f==="both",de=f==="lines"||f==="both";let ne=[],Z=[];for(let ee=0;ee<M;ee++){const ae=I(ee);if(ae.blanking){ne.length>0&&(de&&this._drawSegment(new Float32Array(ne),new Float32Array(Z),1,ne.length/2,!1),se&&this._drawSegment(new Float32Array(ne),new Float32Array(Z),1,ne.length/2,!0),ne=[],Z=[]);continue}ne.push(ae.x,ae.y),Z.push(ae.r/255*h,ae.g/255*h,ae.b/255*h)}ne.length>0&&(de&&this._drawSegment(new Float32Array(ne),new Float32Array(Z),1,ne.length/2,!1),se&&this._drawSegment(new Float32Array(ne),new Float32Array(Z),1,ne.length/2,!0))},H=()=>{const se=[],de=[];for(let ne=0;ne<M;ne++){const Z=I(ne);if(!Z.blanking){se.push(0,0,Z.x,Z.y);const ee=[Z.r/255*h,Z.g/255*h,Z.b/255*h];de.push(...ee,...ee)}}se.length>0&&this._drawLines(new Float32Array(se),new Float32Array(de),o,se.length/2)},ie=()=>{const se=[],de=[];let ne=I(0);for(let Z=1;Z<M;Z++){const ee=I(Z);if(!ne.blanking&&!ee.blanking){se.push(0,0,ne.x,ne.y,ee.x,ee.y);const ae=[ne.r/255*h,ne.g/255*h,ne.b/255*h],$=[ee.r/255*h,ee.g/255*h,ee.b/255*h],re=[(ae[0]+$[0])/2,(ae[1]+$[1])/2,(ae[2]+$[2])/2],B=.3,U=[ae[0]*B,ae[1]*B,ae[2]*B],le=[$[0]*B,$[1]*B,$[2]*B];de.push(...re,...U,...le)}ne=ee}se.length>0&&this._drawTriangles(new Float32Array(se),new Float32Array(de),o,se.length/2)};P(),s&&(f==="points"?H():f==="lines"?ie():f==="both"&&(ie(),H())),this.pointIndexes[d]=(D+M)%j}_drawSegment(t,a,s,o,u=!1){const f=this.gl;f.useProgram(this.program),f.bindBuffer(f.ARRAY_BUFFER,this.positionBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,t),f.enableVertexAttribArray(this.positionAttributeLocation),f.vertexAttribPointer(this.positionAttributeLocation,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,a),f.enableVertexAttribArray(this.colorAttributeLocation),f.vertexAttribPointer(this.colorAttributeLocation,3,f.FLOAT,!1,0,0);const h=new Float32Array(Array(o).fill(s));f.bindBuffer(f.ARRAY_BUFFER,this.alphaBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,h),f.enableVertexAttribArray(this.alphaAttributeLocation),f.vertexAttribPointer(this.alphaAttributeLocation,1,f.FLOAT,!1,0,0),f.drawArrays(u?f.POINTS:f.LINE_STRIP,0,o)}_drawLines(t,a,s,o){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,t),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,a),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0);const f=new Float32Array(Array(o).fill(s));u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.LINES,0,o)}_drawTriangles(t,a,s,o){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,t),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,a),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0);const f=new Float32Array(Array(o).fill(s));u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.TRIANGLES,0,o)}clearCanvas(){const t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}destroy(){cancelAnimationFrame(this.animationFrameId)}}const cf=({frame:r,effects:t,width:a=100,height:s=100})=>{const o=C.useRef(null),u=C.useRef(null),[f,h]=C.useState(null);return C.useEffect(()=>(o.current&&!u.current&&(u.current=new $v(o.current,"single")),()=>{u.current&&(u.current=null)}),[]),C.useEffect(()=>{if(!r){h(null);return}let d=r;if(t&&t.length>0){const g=r.points,v=r.isTypedArray||g instanceof Float32Array;let x;v?x=new Float32Array(g):x=g.map(S=>({...S}));const y={...r,points:x,isTypedArray:v};d=pl(y,t,{time:performance.now(),progress:0,effectStates:new Map})}h(d)},[r,t]),C.useEffect(()=>{u.current&&f?u.current.render({ildaFrames:[f],previewScanRate:1,intensity:1,effects:[],syncSettings:{}}):u.current&&u.current.clearCanvas()},[f]),m.jsx("div",{className:"clip-thumbnail",style:{width:"100%",height:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"black"},children:m.jsx("canvas",{ref:o,width:a,height:s,style:{width:"100%",height:"100%",backgroundColor:"black"}})})},Jv=({layerName:r,index:t,onDropEffect:a,onDropDac:s,layerEffects:o,activeClipData:u,onDeactivateLayerClips:f,onShowLayerFullContextMenu:h,thumbnailRenderMode:d,intensity:g,onIntensityChange:v,liveFrame:x,isBlackout:y,isSolo:S,onToggleBlackout:E,onToggleSolo:T,onLayerSelect:R})=>{const[j,M]=C.useState(o||[]),[D,I]=C.useState(!1),[P,H]=C.useState(!1);C.useEffect(()=>{M(o||[])},[o]);const ie=C.useMemo(()=>[...u?.effects||[],...o||[]],[u?.effects,o]),se=($,re,B,U,le)=>{$.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:re,paramName:B,targetType:U,layerIndex:t,label:le}))},de=$=>{$.preventDefault(),console.log(`Right-clicked LayerControls at index: ${t}`),h&&h(t)},ne=$=>{$.preventDefault(),$.stopPropagation(),I(!0),$.dataTransfer.dropEffect="copy"},Z=$=>{$.preventDefault(),$.stopPropagation(),I(!1)},ee=$=>{$.preventDefault(),$.stopPropagation(),I(!1);const re=$.dataTransfer.getData("application/json");if(re)try{const U=JSON.parse(re);if(U.type==="transform"||U.type==="animation"||U.type==="color"||U.type==="effect"){if(a){a(U.id||U.name);return}}else if(U.ip&&(typeof U.channel=="number"||U.allChannels)&&s){s(t,U);return}}catch(U){console.error("Error parsing drop data in LayerControls:",U)}const B=$.dataTransfer.getData("text/plain");if(B.startsWith("effect_")){const U=B.replace("effect_","");a&&a(U)}};let ae=null;return u&&(d==="active"?ae=x:d==="hover"?ae=P?x:u.stillFrame:ae=u.stillFrame),m.jsxs("div",{className:`layer-controls ${D?"dragging":""}`,onContextMenu:de,onDragOver:ne,onDragLeave:Z,onDrop:ee,children:[m.jsxs("div",{className:"grid-layer",children:[m.jsx(yt,{id:`layer_${t}_clear`,children:m.jsx("span",{className:"layer-control-button full-height",onClick:()=>f(t),draggable:!0,onDragStart:$=>se($,"toggle","clear","layer",`L${t+1} Clear`),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),m.jsxs("div",{className:"layer-control-group",children:[m.jsx(yt,{id:`layer_${t}_blackout`,children:m.jsx("span",{className:"layer-control-button half-height",onClick:E,style:{backgroundColor:y?"red":""},draggable:!0,onDragStart:$=>se($,"toggle","blackout","layer",`L${t+1} Blackout`),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx(yt,{id:`layer_${t}_solo`,children:m.jsx("span",{className:"layer-control-button half-height",onClick:T,style:{backgroundColor:S?"var(--theme-color)":"",color:S?"black":""},draggable:!0,onDragStart:$=>se($,"toggle","solo","layer",`L${t+1} Solo`),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-1-square",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z"}),m.jsx("path",{d:"M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"})]})})})]}),m.jsxs("select",{className:"layer-blend-dropdown",children:[m.jsx("option",{children:"Normal"}),m.jsx("option",{children:"Add"}),m.jsx("option",{children:"Subtract"})]})]}),m.jsx("div",{className:"layer-control-row",children:m.jsx(yt,{id:`layer_${t}_intensity`,children:m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:g,className:"slider_ver",id:"layer-intensity-slider",onChange:$=>v(parseFloat($.target.value))})})}),m.jsx("div",{className:"layer-preview-thumbnail",onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),children:u?m.jsx(cf,{frame:ae,effects:ie}):j.length>0&&m.jsx("div",{className:"applied-effects",children:j.map(($,re)=>m.jsx("span",{className:"effect-tag",children:($.name||$.id||"???").substring(0,3).toUpperCase()},$.instanceId||re))})}),m.jsx("span",{className:"layer-name-label",onClick:()=>R&&R(t),children:r})]})},ey=({clipName:r,layerIndex:t,colIndex:a,onDropGenerator:s,onDropEffect:o,clipContent:u,thumbnailFrameIndex:f,onUnsupportedFile:h,onActivateClick:d,onLabelClick:g,isSelected:v,isActive:x,ildaParserWorker:y,onDropDac:S,thumbnailRenderMode:E,liveFrame:T,stillFrame:R,onClipHover:j})=>{const[M,D]=C.useState(!1),[I,P]=C.useState(!1),H=r,ie=E==="active"||E==="hover"&&M,se=U=>{U.preventDefault(),U.stopPropagation(),P(!0),U.dataTransfer.dropEffect="copy"},de=U=>{U.preventDefault(),U.stopPropagation(),U.currentTarget.contains(U.relatedTarget)||P(!1)},ne=()=>{D(!0),j&&j(t,a,!0)},Z=()=>{D(!1),d(!1),j&&j(t,a,!1)},ee=async U=>{const le=U.name;if(!y){h("ILDA parser not available.");return}if(le.toLowerCase().endsWith(".ild"))try{const ve=await U.arrayBuffer();console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFileDrop): ${ve.byteLength}`),y.postMessage({type:"parse-ilda",arrayBuffer:ve,fileName:le,filePath:U.path,layerIndex:t,colIndex:a},[ve])}catch(ve){console.error("[Clip.jsx] handleFileDrop - Error reading file:",ve),h(`Error reading file: ${ve.message}`)}else h("Please drop a valid .ild file")},ae=async(U,le)=>{if(!le.toLowerCase().endsWith(".ild")){console.log("Unsupported file type:",le),h("Please drop a valid .ild file");return}if(!y){h("ILDA parser not available.");return}try{if(window.electronAPI&&window.electronAPI.readFileAsBinary){const N=(await window.electronAPI.readFileAsBinary(U)).slice().buffer;console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFilePathDrop): ${N.byteLength}`),y.postMessage({type:"parse-ilda",arrayBuffer:N,fileName:le,filePath:U,layerIndex:t,colIndex:a},[N])}else h("Binary file access not available")}catch(ve){console.error("Error processing file path:",ve),console.error("Error stack:",ve.stack),h(`Error processing file: ${ve.message}`)}},$=U=>{U.preventDefault(),U.stopPropagation(),P(!1);const le=U.dataTransfer.getData("application/json");if(le)try{const N=JSON.parse(le);if(N.filePath&&N.fileName){ae(N.filePath,N.fileName);return}if(N.type==="transform"||N.type==="animation"||N.type==="color"||N.type==="effect"){if(o){o(N),g();return}}else if(N.ip&&(typeof N.channel=="number"||N.allChannels)){if(S){S(t,a,N);return}}else if(N.name&&s){s(t,a,N);return}}catch(N){console.error("Error parsing dropped data:",N)}const ve=U.dataTransfer.files;if(ve&&ve.length>0){ee(ve[0]);return}console.log("No recognized data format found in drop"),h("No valid ILD file, effect, or generator dropped.")},re=U=>{U.preventDefault(),U.stopPropagation()},B=U=>{U.preventDefault(),window.electronAPI&&window.electronAPI.showClipContextMenu&&window.electronAPI.showClipContextMenu(t,a,u?.triggerStyle||"normal")};return m.jsxs("div",{className:`clip ${I?"dragging":""} ${x?"active-clip":""} `,onDragEnter:re,onDragOver:se,onDragLeave:de,onDrop:$,onContextMenu:B,children:[m.jsx(yt,{id:`clip_${t}_${a}`,children:m.jsx("div",{className:"clip-thumbnail",onMouseDown:()=>d(!0),onMouseUp:()=>d(!1),onMouseEnter:ne,onMouseLeave:Z,style:{overflow:"hidden"},children:u&&u.parsing?m.jsx("div",{className:"clip-loading-spinner"}):m.jsxs(m.Fragment,{children:[ie&&u?m.jsx(cf,{frame:T||R,effects:u?.effects}):u?.thumbnailPath&&!x?m.jsx("img",{src:`file://${u.thumbnailPath}?t=${u.thumbnailVersion||Date.now()}`,alt:"thumbnail",style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}):R&&m.jsx(cf,{frame:R,effects:u?.effects}),u?.triggerStyle&&u.triggerStyle!=="normal"&&m.jsxs("p",{className:"clip_icons",children:[u.triggerStyle==="toggle"&&m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-toggles",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M4.5 9a3.5 3.5 0 1 0 0 7h7a3.5 3.5 0 1 0 0-7zm7 6a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m-7-14a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5m2.45 0A3.5 3.5 0 0 1 8 3.5 3.5 3.5 0 0 1 6.95 6h4.55a2.5 2.5 0 0 0 0-5zM4.5 0h7a3.5 3.5 0 1 1 0 7h-7a3.5 3.5 0 1 1 0-7"})}),u.triggerStyle==="flash"&&m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-lightning-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641z"})})]})]})})}),m.jsx(yt,{id:`clip_${t}_${a}_preview`,children:m.jsx("span",{className:`clip-label ${v?"selected-clip":""}`,onClick:g,children:H})})]})},ty=Pr.memo(ey),ny=()=>{const[r,t]=C.useState(""),[a,s]=C.useState([]),o=async()=>{if(window.electronAPI){const u=await window.electronAPI.openFileExplorer();if(u){t(u);const f=await window.electronAPI.readIldFiles(u);s(f)}}};return m.jsxs("div",{className:"file-browser",children:[m.jsx("h3",{children:"ILD File Browser"}),m.jsx("button",{onClick:o,children:"Open Folder"}),r&&m.jsxs("p",{className:"fileBrowser",children:["Selected Directory: ",r.split("\\").filter(Boolean).pop()]}),m.jsx("div",{className:"ild-file-list",children:a.length>0?a.map((u,f)=>{const h=u.split("\\").pop();return m.jsx("div",{className:"ild-file-item",draggable:!0,onDragStart:d=>d.dataTransfer.setData("application/json",JSON.stringify({filePath:u,fileName:h})),children:h},f)}):m.jsx("p",{children:"No ILD files found in selected directory."})})]})},ff=[{id:"circle",name:"Circle",description:"Generates a simple circle.",defaultParams:{radius:.5,numPoints:100,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"radius",label:"Radius",type:"range",min:.01,max:1,step:.01},{id:"numPoints",label:"Number of Points",type:"range",min:3,max:360,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"square",name:"Square",description:"Generates a simple square.",defaultParams:{width:1,height:1,pointDensity:25,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"width",label:"Width",type:"range",min:.01,max:2,step:.01},{id:"height",label:"Height",type:"range",min:.01,max:2,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:100,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"line",name:"Line",description:"Generates a straight line.",defaultParams:{x1:-.5,y1:0,x2:.5,y2:0,pointDensity:50,r:255,g:255,b:255},paramControls:[{id:"x1",label:"X1",type:"range",min:-1,max:1,step:.01},{id:"y1",label:"Y1",type:"range",min:-1,max:1,step:.01},{id:"x2",label:"X2",type:"range",min:-1,max:1,step:.01},{id:"y2",label:"Y2",type:"range",min:-1,max:1,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:2,max:200,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"text",name:"Text",description:"Generates text.",defaultParams:{text:"TrueLazer",x:0,y:.3,fontSize:72,numPoints:200,fontUrl:"src/fonts/Geometr415 Blk BT Black.ttf",r:255,g:255,b:255},paramControls:[{id:"text",label:"Text Content",type:"text"},{id:"fontUrl",label:"Fonts",type:"text"},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"fontSize",label:"Font Size",type:"range",min:10,max:200,step:1},{id:"numPoints",label:"Target Points",type:"range",min:10,max:1e3,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"star",name:"Star",description:"Generates a star shape.",defaultParams:{outerRadius:.5,innerRadius:.2,numSpikes:5,pointDensity:10,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"outerRadius",label:"Outer Radius",type:"range",min:.01,max:1,step:.01},{id:"innerRadius",label:"Inner Radius",type:"range",min:.01,max:1,step:.01},{id:"numSpikes",label:"Number of Spikes",type:"range",min:3,max:20,step:1},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:50,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"ndi-source",name:"NDI Source",description:"Placeholder for NDI Video Input.",defaultParams:{sourceName:"No Source",threshold:128,edgeDetection:!1,captureWidth:1280,captureHeight:720,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Source Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"captureWidth",label:"Capture Width",type:"range",min:64,max:1280,step:8},{id:"captureHeight",label:"Capture Height",type:"range",min:64,max:720,step:8},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"spout-receiver",name:"Spout Receiver",description:"Placeholder for Spout Video Input.",defaultParams:{sourceName:"Spout Input",threshold:128,edgeDetection:!1,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Sender Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]}],ay=()=>{const[r,t]=C.useState([]);C.useEffect(()=>{const o=async()=>{if(window.electronAPI&&window.electronAPI.ndiFindSources){const f=await window.electronAPI.ndiFindSources();t(f||[])}};o();const u=setInterval(o,5e3);return()=>clearInterval(u)},[]);const a=(o,u)=>{o.dataTransfer.setData("application/json",JSON.stringify(u))},s=(o,u)=>{const f=ff.find(d=>d.id==="ndi-source"),h={...f,defaultParams:{...f.defaultParams,sourceName:u.name}};o.dataTransfer.setData("application/json",JSON.stringify(h))};return m.jsxs("div",{className:"generator-panel",children:[m.jsx("h3",{children:"Generators"}),m.jsx("div",{className:"generator-list",children:ff.filter(o=>o.id!=="ndi-source"&&o.id!=="spout-receiver").map(o=>m.jsx("div",{className:"generator-item",draggable:!0,onDragStart:u=>a(u,o),children:o.name},o.id))}),m.jsx("h3",{style:{marginTop:"10px"},children:"NDI Sources"}),m.jsx("div",{className:"generator-list",children:r.length>0?r.map((o,u)=>m.jsx("div",{className:"generator-item ndi-item",draggable:!0,onDragStart:f=>s(f,o),children:o.name},`${o.name}-${u}`)):m.jsx("div",{className:"empty-msg",children:"No NDI sources found"})})]})},ry=()=>{const r=(t,a)=>{t.dataTransfer.setData("application/json",JSON.stringify(a))};return m.jsxs("div",{className:"effect-panel",children:[m.jsx("h3",{children:"Effects"}),Qt.map(t=>m.jsx("div",{draggable:!0,onDragStart:a=>r(a,t),className:"effect-item",children:t.name},t.id))]})},is=({value:r,onChange:t,label:a,onDrop:s,size:o=40,isAssigned:u,...f})=>{const h=C.useRef(null),d=y=>{s&&(y.preventDefault(),y.dataTransfer.dropEffect="link")},g=y=>{if(s){y.preventDefault();try{const S=y.dataTransfer.getData("application/x-truelazer-param");console.log("[RadialKnob] Dropped Data Raw:",S);const E=JSON.parse(S);console.log("[RadialKnob] Dropped Data Parsed:",E),E&&(E.type==="range"||E.type==="number")?s(E):console.warn("[RadialKnob] Invalid data type for knob:",E?.type)}catch(S){console.error("[RadialKnob] Drop Error:",S)}}},v=-135+r*270,x=y=>{if(!u)return;y.preventDefault();const S=y.clientY,E=r,T=j=>{const D=(S-j.clientY)/200;let I=Math.max(0,Math.min(1,E+D));t(I)},R=()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",R)};window.addEventListener("mousemove",T),window.addEventListener("mouseup",R)};return C.useEffect(()=>{const y=h.current;if(!y)return;const S=E=>{if(!u)return;E.preventDefault(),E.stopPropagation();const T=E.deltaY*-.001;let R=Math.max(0,Math.min(1,r+T));t(R)};return y.addEventListener("wheel",S,{passive:!1}),()=>{y.removeEventListener("wheel",S)}},[r,t,u]),m.jsxs("div",{className:`quick-assign-knob ${u?"":"unassigned"}`,ref:h,style:{width:o,cursor:u?"ns-resize":"default",userSelect:"none",opacity:u?1:.5},onDragOver:d,onDrop:g,onMouseDown:x,...f,children:[m.jsx("div",{className:"knob-circle",style:{width:o*.66,height:o*.66},children:m.jsx("div",{className:"knob-indicator",style:{transform:`rotate(${v}deg)`}})}),a&&m.jsx("div",{className:"knob-label",title:a,children:a})]})},iy=({dacs:r=[],onDacSelected:t,onDacsDiscovered:a,dacSettings:s={},onUpdateDacSettings:o})=>{const[u,f]=C.useState(!1),[h,d]=C.useState(null),[g,v]=C.useState([]),[x,y]=C.useState(null),S=Pr.useRef(!1);C.useEffect(()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(M=>{v(M),M.length>0&&y(M[0])})},[]),C.useEffect(()=>{u&&!S.current&&(S.current=!0,console.log("Starting DAC scan on:",x?.address),window.electronAPI?window.electronAPI.discoverDacs(2e3,x?.address).then(async M=>{console.log("DACs discovered:",M);const D=await Promise.all(M.map(async I=>{try{const P=await window.electronAPI.getDacServices(I.ip,x?.address,I.type),H=I.type&&I.type.toLowerCase()==="etherdream"?P:P.filter(ie=>ie.serviceID!==0);return{...I,channels:H}}catch(P){return console.error(`Error fetching services for DAC ${I.ip}:`,P),{...I,channels:[]}}}));a&&a(D)}).catch(M=>{console.error("Error discovering DACs:",M)}).finally(()=>{f(!1),S.current=!1}):(console.warn("electronAPI is not available. Cannot discover DACs."),f(!1),S.current=!1))},[u,x,a]);const E=(M,D)=>{const I={...M,channel:D};d(I),t&&t(I)},T=(M,D,I)=>{M.stopPropagation();const P={...D,channel:I};M.dataTransfer.setData("application/json",JSON.stringify(P))},R=M=>{const D=M.target.value,I=g.find(P=>P.address===D);y(I)},j=(M,D)=>{M.stopPropagation();const I={...D,allChannels:!0};M.dataTransfer.setData("application/json",JSON.stringify(I))};return m.jsxs("div",{className:"dac-panel",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"DACs"})}),m.jsxs("div",{className:"network-interface-selector",style:{display:"flex",gap:5,padding:"5px 10px"},children:[m.jsxs("div",{style:{flex:1,display:"flex"},children:[m.jsx("select",{onChange:R,value:x?.address||"",style:{width:"100%",height:"100%",background:"#2a2a2a",color:"#aaa",borderRadius:"5px",marginBottom:2},children:g.map(M=>m.jsxs("option",{value:M.address,children:[M.name," (",M.address,")"]},M.address))}),m.jsx("button",{onClick:()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(M=>{v(M),M.length>0&&!x&&y(M[0])})},style:{fontSize:"9px",padding:"2px",background:"#333",border:"1px solid #555",color:"#ccc",cursor:"pointer",borderRadius:"5px"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[m.jsx("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),m.jsx("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"})]})})]}),m.jsx("label",{style:{display:"flex",alignItems:"center",fontSize:"10px"},children:m.jsx("input",{type:"checkbox",checked:u,onChange:M=>f(M.target.checked),disabled:u,style:{height:"100%"}})})]}),m.jsx("div",{className:"dac-list",children:r.map(M=>m.jsxs("div",{className:"dac-group",draggable:!0,onDragStart:D=>j(D,M),children:[m.jsxs("div",{className:"dac-ip",children:[M.hostName||M.ip," (",M.ip,")"]}),m.jsx("div",{className:"dac-channels",children:M.channels&&M.channels.length>0?M.channels.map(D=>m.jsxs("div",{className:`dac-channel-item ${h&&(h.unitID===M.unitID||h.ip===M.ip)&&h.channel===D.serviceID?"selected":""}`,onClick:()=>E(M,D.serviceID),draggable:!0,onDragStart:I=>T(I,M,D.serviceID),children:["Channel ",D.serviceID," (",D.name,")"]},`${M.unitID||M.ip}-${D.serviceID}`)):m.jsx("div",{className:"dac-channel-item no-channels",children:"No channels found"})})]},M.unitID||M.ip))}),r.length>0&&m.jsxs("div",{className:"dac-dimmers-section",children:[m.jsx("h4",{children:"Channel Dimmers"}),m.jsx("div",{className:"dac-dimmers-grid",children:r.flatMap(M=>(M.channels||[]).map(D=>({dac:M,ch:D}))).map(({dac:M,ch:D})=>{const I=`${M.ip}:${D.serviceID}`,P=s[I]||{},H=P.dimmer!==void 0?P.dimmer:1;return m.jsx(yt,{id:`dimmer_${I.replace(/\./g,"_")}`,children:m.jsx(is,{label:`${M.hostName||M.ip} Ch${D.serviceID}`,value:H,onChange:ie=>{o&&o(I,{...P,dimmer:ie})}})},`dimmer_${I}`)})})]})]})},$0=({min:r,max:t,step:a,value:s,rangeValue:o,onChange:u,onRangeChange:f,showRange:h=!1,disabled:d=!1,animSettings:g,progressRef:v,workerId:x,clipDuration:y})=>{const S=C.useRef(null),E=C.useRef(null),T=C.useRef(null),[R,j]=C.useState(null),M=r!==void 0?r:0,D=t!==void 0?t:1,I=o&&o[0]!==void 0?o[0]:M,P=o&&o[1]!==void 0?o[1]:D,H=s!==void 0?s:M,ie=de=>{const ne=D-M;return ne===0?0:(de-M)/ne*100};C.useEffect(()=>{let de;const ne=()=>{if(R==="value"){de=requestAnimationFrame(ne);return}let Z=H;if(g&&g.syncMode&&v&&v.current){const $={progress:x&&v.current[x]!==void 0?v.current[x]:0,time:performance.now(),clipDuration:y||1};Z=W0(null,H,g,$)}const ee=ie(Z);E.current&&(E.current.style.left=`${ee}%`),T.current&&(T.current.style.width=`${ee}%`),de=requestAnimationFrame(ne)};return de=requestAnimationFrame(ne),()=>cancelAnimationFrame(de)},[g,v,x,H,R,M,D]);const se=(de,ne)=>{if(d)return;de.preventDefault(),de.stopPropagation(),j(ne);const Z=ae=>{if(!S.current)return;const $=S.current.getBoundingClientRect(),re=ae.clientX-$.left;let B=Math.max(0,Math.min(100,re/$.width*100)),U=M+B/100*(D-M);a&&(U=Math.round(U/a)*a,B=(U-M)/(D-M)*100),ne==="value"?(U=Math.max(I,Math.min(P,U)),E.current&&(E.current.style.left=`${ie(U)}%`),T.current&&!h&&(T.current.style.width=`${ie(U)}%`),u&&u(U)):ne==="min"?(U=Math.max(M,Math.min(P,U)),f&&f([U,P])):ne==="max"&&(U=Math.max(I,Math.min(D,U)),f&&f([I,U]))},ee=()=>{j(null),window.removeEventListener("mousemove",Z),window.removeEventListener("mouseup",ee)};window.addEventListener("mousemove",Z),window.addEventListener("mouseup",ee)};return m.jsx("div",{className:"range-slider-container",style:{position:"relative",width:"100%",height:"20px",display:"flex",alignItems:"center"},children:m.jsxs("div",{className:"range-slider-track",ref:S,style:{width:"100%",height:"4px",background:"#444",borderRadius:"2px",position:"relative"},children:[h&&m.jsx("div",{className:"range-slider-fill",style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:`${ie(I)}%`,width:`${ie(P)-ie(I)}%`}}),!h&&m.jsx("div",{className:"value-slider-fill",ref:T,style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:"0%",borderRadius:"2px"}}),h&&m.jsx("div",{className:"range-slider-handle min-handle",style:{left:`${ie(I)}%`},onMouseDown:de=>se(de,"min"),title:`Min: ${I.toFixed(2)}`}),h&&m.jsx("div",{className:"range-slider-handle max-handle",style:{left:`${ie(P)}%`},onMouseDown:de=>se(de,"max"),title:`Max: ${P.toFixed(2)}`}),m.jsx("div",{className:"range-slider-handle value-handle",ref:E,style:{position:"absolute",width:"6px",height:"16px",top:"-50%",transform:"translate(-50%, -25%)",cursor:"pointer",zIndex:20,boxShadow:"0 0 2px rgba(0,0,0,0.5)"},onMouseDown:de=>se(de,"value"),title:`Value: ${H.toFixed(2)}`})]})})},gn=({title:r,children:t,icon:a,defaultCollapsed:s=!1,headerActions:o})=>{const[u,f]=C.useState(s);return m.jsxs("div",{className:`settings-card ${u?"collapsed":""}`,children:[m.jsxs("div",{className:"settings-card-header",onClick:()=>f(!u),style:{cursor:"pointer",userSelect:"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",style:{transform:u?"rotate(0deg)":"rotate(90deg)",transition:"transform 0.2s"},children:m.jsx("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"})}),a&&m.jsx("span",{className:`bi ${a}`}),m.jsx("h4",{children:r})]}),o&&m.jsx("div",{onClick:h=>h.stopPropagation(),children:o})]}),!u&&m.jsx("div",{className:"settings-card-content",children:t})]})},J0=({animSettings:r,onChange:t})=>{const{direction:a="forward",style:s="loop",syncMode:o=null,duration:u=1,beats:f=8,speedMultiplier:h=1}=r||{},d=(v,x)=>t({...r,[v]:x}),g=(v,x,y=!1)=>{let E=r?.[v]||(v==="beats"?8:1);y?E=x>1?E*2:E/2:E+=x,E<.01&&(E=.01),!y&&v!=="beats"&&(E=Math.round(E*100)/100),d(v,E)};return m.jsxs("div",{className:"anim-controls-container",children:[m.jsxs("div",{className:"anim-row controls-row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"5px"},children:[m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${a==="backward"?"active":""}`,onClick:()=>d("direction","backward"),title:"Backward",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",transform:"scale(-1 1)",children:m.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})}),m.jsx("button",{className:`speed-control-button ${a==="pause"?"active":""}`,onClick:()=>d("direction","pause"),title:"Pause",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"25",height:"20",viewBox:"0 0 16 16",className:"icon flat-color",children:m.jsx("path",{d:"M3 1h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m7 0h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m0 0"})})}),m.jsx("button",{className:`speed-control-button ${a==="forward"?"active":""}`,onClick:()=>d("direction","forward"),title:"Forward",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",children:m.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})})]}),m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${s==="once"?"active":""}`,onClick:()=>d("style","once"),title:"Once",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M43.8233 25.2305C43.7019 25.9889 43.5195 26.727 43.2814 27.4395 42.763 28.9914 41.9801 30.4222 40.9863 31.6785 38.4222 34.9201 34.454 37 30 37H16C9.39697 37 4 31.6785 4 25 4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M24 19V31",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M24 19 21 22 19.5 23.5",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),m.jsx("button",{className:`speed-control-button ${s==="bounce"?"active":""}`,onClick:()=>d("style","bounce"),title:"Bounce",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M42 19H5.99998",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M30 7 42 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M6.79897 29H42.799",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M6.79895 29 18.799 41",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),m.jsx("button",{className:`speed-control-button ${s==="loop"?"active":""}`,onClick:()=>d("style","loop"),title:"Loop",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M4 25C4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M44 23C44 29.6498 38.6038 35 32 35H4",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M10 41 4 35 10 29",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${o==="fps"?"active":""}`,onClick:()=>d("syncMode",o==="fps"?null:"fps"),style:{flex:1,padding:0,fontSize:"10px"},children:"F"}),m.jsx("button",{className:`speed-control-button ${o==="timeline"?"active":""}`,onClick:()=>d("syncMode",o==="timeline"?null:"timeline"),style:{flex:1,padding:0,fontSize:"10px"},children:"T"}),m.jsx("button",{className:`speed-control-button ${o==="bpm"?"active":""}`,onClick:()=>d("syncMode",o==="bpm"?null:"bpm"),style:{flex:1,padding:0,fontSize:"10px"},children:"B"}),m.jsx("button",{className:`speed-control-button ${o==="fft"?"active":""}`,onClick:()=>d("syncMode",o==="fft"?null:"fft"),style:{flex:1,padding:0,fontSize:"10px"},children:"FFT"})]})]}),o==="fft"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Range"}),m.jsxs("select",{value:r?.fftRange||"low",onChange:v=>d("fftRange",v.target.value),style:{fontSize:"10px",background:"#333",border:"1px solid #555",color:"white"},children:[m.jsx("option",{value:"low",children:"Low"}),m.jsx("option",{value:"mid",children:"Mid"}),m.jsx("option",{value:"high",children:"High"})]})]})}),o==="timeline"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Duration (s)"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",-1),children:"-1"}),m.jsx("input",{type:"number",value:typeof u=="number"?u.toFixed(2):u,onChange:v=>d("duration",parseFloat(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",1),children:"+1"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",.5,!0),children:"/2"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",2,!0),children:"*2"})]})]})}),o==="bpm"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Beats"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",-1),children:"-1"}),m.jsx("input",{type:"number",value:f,onChange:v=>d("beats",parseInt(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",1),children:"+1"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",.5,!0),children:"/2"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",2,!0),children:"*2"})]})]})}),(o==="timeline"||o==="bpm"||o==="fps")&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Speed"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("speedMultiplier",-.1),children:"-0.1"}),m.jsx("input",{type:"number",value:typeof h=="number"?h.toFixed(2):h,onChange:v=>d("speedMultiplier",parseFloat(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("speedMultiplier",.1),children:"+0.1"})]})]})})]})},sy=({control:r,value:t,onChange:a,animSettings:s,onAnimChange:o,effectId:u,context:f,progressRef:h,workerId:d,clipDuration:g})=>{const[v,x]=C.useState(!1),[y,S]=C.useState(!1),E=M=>{M.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:r.type,paramName:r.id,effectId:u,min:r.min,max:r.max,step:r.step,...f}))},T=s?.range||[r.min,r.max],R=M=>{o({...s,range:M})},j=M=>{o({range:T,...M})};return m.jsxs("div",{className:`param-editor ${v?"expanded":""}`,onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),style:{marginBottom:"8px",display:"grid",gridTemplateColumns:"1fr",gap:"2px"},children:[m.jsx("div",{className:"param-row-label",style:{width:"100%"},children:m.jsx("label",{className:"param-label",draggable:!0,onDragStart:E,style:{fontSize:"11px",color:"#aaa"},children:r.label})}),m.jsxs("div",{className:"param-row-control",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[m.jsx("button",{className:`anim-toggle-btn ${v?"active":""}`,style:{visibility:y||v||s?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>x(!v),title:"Animate",children:""}),m.jsx("div",{className:"control-input-wrapper",style:{display:"flex",alignItems:"center",height:"100%"},children:r.type==="range"?m.jsx(yt,{id:`${u}_${r.id}`,style:{width:"100%"},children:m.jsx($0,{min:r.min,max:r.max,step:r.step,value:t,rangeValue:T,onChange:a,onRangeChange:R,showRange:v,animSettings:s,progressRef:h,workerId:d,clipDuration:g})}):r.type==="text"?m.jsx("input",{type:"text",value:t,onChange:M=>a(M.target.value),className:"param-text-input"}):r.type==="checkbox"?m.jsx(yt,{id:`${u}_${r.id}`,children:m.jsx("input",{type:"checkbox",checked:t,onChange:M=>a(M.target.checked),className:"param-checkbox"})}):r.type==="select"?m.jsx("select",{value:t,onChange:M=>a(M.target.value),className:"param-select",children:r.options.map(M=>m.jsx("option",{value:M,children:M},M))}):null}),r.type==="range"&&m.jsx("input",{type:"number",value:typeof t=="number"?t.toFixed(2):t,onChange:M=>a(parseFloat(M.target.value)||0),className:"param-number-input",step:r.step,style:{width:"100%",fontSize:"10px"}})]}),v&&r.type==="range"&&m.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:m.jsx(J0,{animSettings:s,onChange:j})})]})},ly=({customOrder:r=[],assignedDacs:t=[],onChange:a})=>{const[s,o]=C.useState(null),u=r&&r.length>0?r:t.map((d,g)=>({ip:d.ip,channel:d.channel,label:`Ch ${d.channel} (${d.hostName||d.ip})`,originalIndex:g})),f=(d,g)=>{o(u[g])},h=(d,g)=>{d.preventDefault();const v=u[g];if(s===v)return;const x=u.filter(y=>y!==s);x.splice(g,0,s),a(x)};return m.jsxs("div",{className:"custom-order-editor",style:{marginBottom:"10px",padding:"5px",background:"#222",borderRadius:"4px"},children:[m.jsx("label",{style:{fontSize:"10px",color:"#888"},children:"Channel Order (Drag to Sort)"}),m.jsx("ul",{style:{listStyle:"none",padding:0,margin:"5px 0"},children:u.map((d,g)=>m.jsxs("li",{draggable:!0,onDragStart:v=>f(v,g),onDragOver:v=>h(v,g),style:{background:"#333",border:"1px solid #444",padding:"4px",marginBottom:"2px",fontSize:"10px",cursor:"grab",display:"flex",alignItems:"center"},children:[m.jsx("span",{style:{marginRight:"5px",color:"#666"},children:""}),d.label||`Ch ${d.channel} ${d.ip?`(${d.ip})`:""}`]},g))})]})},em=({effect:r,assignedDacs:t=[],onParamChange:a,onRemove:s,syncSettings:o={},onSetParamSync:u,context:f={},progressRef:h,clipDuration:d})=>{if(!r)return null;const g=Qt.find(T=>T.id===r.id);if(!g)return null;const v=r.id==="delay",x=r.id==="chase",y=r.params.enabled!==!1,S=r.params.mode==="channel",E=T=>{T.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"enabled",label:`${r.name} ON`,...f}))};return m.jsxs(gn,{title:r.name,headerActions:m.jsxs("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(v||x)&&m.jsx("button",{className:"mode-toggle-btn",onClick:()=>a("mode",S?"frame":"channel"),style:{fontSize:"9px",padding:"2px 5px",background:S?"#444":"var(--theme-color)",border:"none",color:"white",borderRadius:"3px",cursor:"pointer"},children:S?"CHANNEL":"FRAME"}),m.jsx(yt,{id:`${r.id}_blackout`,children:m.jsx("button",{className:`layer-control-button ${y?"":"active"}`,onClick:()=>a("enabled",!y),draggable:!0,onDragStart:E,style:{padding:"2px",background:y?"none":"red",border:"none",color:"white",cursor:"pointer",display:"flex"},title:"Toggle Effect",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx("button",{className:"remove-effect-btn",onClick:s,children:""})]}),children:[v&&m.jsx(m.Fragment,{children:r.params.useCustomOrder&&m.jsx(ly,{customOrder:r.params.customOrder,assignedDacs:t,onChange:T=>a("customOrder",T)})}),g.paramControls.map(T=>{if(v&&["customOrder"].includes(T.id)||T.showIf&&!Object.entries(T.showIf).every(([D,I])=>r.params[D]===I))return null;const R=`${r.id}.${T.id}`,j=typeof o[R]=="object"?o[R]:{syncMode:o[R]};return m.jsx(sy,{control:T,value:r.params[T.id],onChange:M=>a(T.id,M),animSettings:j,onAnimChange:M=>u(R,M),effectId:r.id,context:f,progressRef:h,workerId:f.workerId,clipDuration:d},T.id)})]})},oy=({control:r,value:t,onChange:a,syncSettings:s,onSetParamSync:o,layerIndex:u,colIndex:f,progressRef:h,workerId:d,generatorId:g,clipDuration:v})=>{const[x,y]=C.useState(!1),[S,E]=C.useState(!1),T=I=>{I.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:r.type,paramName:r.id,targetType:"generator",layerIndex:u,colIndex:f,min:r.min,max:r.max,step:r.step}))},R=`${g}.${r.id}`,j=typeof s[R]=="object"?s[R]:{syncMode:s[R]},M=j?.range||[r.min,r.max],D=I=>{o(R,{...j,range:I})};return m.jsxs("div",{className:`param-editor ${x?"expanded":""}`,onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),style:{marginBottom:"8px"},children:[m.jsx("div",{className:"param-label-row",style:{display:"flex",alignItems:"center"},children:m.jsx("label",{draggable:!0,onDragStart:T,className:"param-label",style:{fontSize:"11px",color:"#aaa"},children:r.label})}),m.jsxs("div",{className:"control-row",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[m.jsx("button",{className:`anim-toggle-btn ${x?"active":""}`,style:{visibility:S||x||j?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>y(!x),title:"Animate",children:""}),m.jsx("div",{className:"control-input-wrapper",children:r.type==="range"?m.jsx($0,{min:r.min,max:r.max,step:r.step,value:t,rangeValue:M,onChange:I=>a(r.id,I),onRangeChange:D,showRange:x,animSettings:j,progressRef:h,workerId:d,clipDuration:v}):r.type==="number"?m.jsx("input",{type:"number",value:t,onChange:I=>a(r.id,parseFloat(I.target.value)||0),className:"param-number-input",step:r.step}):r.type==="text"?m.jsx("input",{type:"text",value:t,onChange:I=>a(r.id,I.target.value),className:"param-text-input"}):r.type==="checkbox"?m.jsx("input",{type:"checkbox",checked:t,onChange:I=>a(r.id,I.target.checked),className:"param-checkbox"}):null}),r.type==="range"&&m.jsx("input",{type:"number",value:typeof t=="number"?t.toFixed(2):t,onChange:I=>a(r.id,parseFloat(I.target.value)||0),className:"param-number-input",step:r.step,style:{width:"100%",fontSize:"10px"}})]}),x&&r.type==="range"&&m.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:m.jsx(J0,{animSettings:j,onChange:I=>o(R,I)})})]})},uy=({selectedGeneratorId:r,selectedGeneratorParams:t,onParameterChange:a,syncSettings:s={},onSetParamSync:o,layerIndex:u,colIndex:f,progressRef:h,workerId:d,clipDuration:g})=>{const[v,x]=C.useState([]),[y,S]=C.useState([]),[E,T]=C.useState(!1);if(!r)return m.jsx("div",{className:"generator-settings-panel",children:"No generator selected."});const R=ff.find(M=>M.id===r);if(!R)return m.jsxs("div",{className:"generator-settings-panel",children:["Generator definition not found for ID: ",r]});C.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getProjectFonts)try{const D=await window.electronAPI.getProjectFonts();S(D)}catch(D){console.error("Failed to load project fonts:",D)}})()},[]);const j=async M=>{const D=M.target.value;if(D==="browse")if(window.electronAPI&&window.electronAPI.showFontFileDialog){const I=await window.electronAPI.showFontFileDialog();I&&a("fontUrl",I)}else console.error("Font file dialog API not available.");else if(D==="load-system"){T(!0);try{const P=(await window.electronAPI.getSystemFonts()).map(H=>({name:H.split(/[\\/]/).pop(),path:H})).sort((H,ie)=>H.name.localeCompare(ie.name));x(P)}catch(I){console.error("Failed to load system fonts:",I)}T(!1)}else a("fontUrl",D)};return m.jsx(gn,{title:`${R.name} Settings`,children:R.paramControls.map(M=>{if(M.id==="fontUrl"){const D=t[M.id]||"src/fonts/Geometr415 Blk BT Black.ttf";return m.jsxs("div",{className:"param-editor",children:[m.jsx("label",{className:"param-label",children:M.label}),m.jsxs("div",{className:"font-selector-container",children:[m.jsxs("select",{className:"param-select",onChange:j,value:D,children:[y.length>0?m.jsx("optgroup",{label:"Project Fonts",children:y.map(I=>m.jsx("option",{value:I.path,children:I.name},I.path))}):m.jsx("optgroup",{label:"Default Fonts",children:m.jsx("option",{value:"src/fonts/Geometr415 Blk BT Black.ttf",children:"Geometr415"})}),v.length>0?m.jsx("optgroup",{label:"System Fonts",children:v.map(I=>m.jsx("option",{value:I.path,children:I.name},I.path))}):m.jsx("option",{value:"load-system",children:E?"Loading...":"Load System Fonts..."}),m.jsx("optgroup",{label:"Actions",children:m.jsx("option",{value:"browse",children:"Browse File..."})})]}),m.jsx("span",{className:"font-path-tiny",title:D,children:D.split(/[\\/]/).pop()})]})]},M.id)}return m.jsx(oy,{control:M,value:t[M.id],onChange:a,syncSettings:s,onSetParamSync:o,layerIndex:u,colIndex:f,progressRef:h,workerId:d,generatorId:r,clipDuration:g},M.id)})})},cy=({settings:r,onUpdate:t})=>{const{mode:a="fps",duration:s=1,beats:o=8,speedMultiplier:u=1,fps:f=60}=r||{},h=g=>{t({mode:g})},d=(g,v,x=!1)=>{let y=r[g]||(g==="beats"?8:g==="fps"?60:1);x?y=v>1?y*2:y/2:y+=v,y<.01&&(y=.01),t({[g]:y})};return m.jsxs(gn,{title:"Clip Playback",children:[m.jsxs("div",{className:"playback-mode-selector",children:[m.jsx("button",{className:a==="fps"?"active":"",onClick:()=>h("fps"),children:"FPS"}),m.jsx("button",{className:a==="timeline"?"active":"",onClick:()=>h("timeline"),children:"Timeline"}),m.jsx("button",{className:a==="bpm"?"active":"",onClick:()=>h("bpm"),children:"BPM Sync"})]}),m.jsxs("div",{className:"playback-controls",children:[a==="fps"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Speed (FPS)"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("fps",-1),children:"-1"}),m.jsx("input",{type:"number",value:f,onChange:g=>t({fps:parseInt(g.target.value)||60})}),m.jsx("button",{onClick:()=>d("fps",1),children:"+1"}),m.jsx("button",{onClick:()=>d("fps",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("fps",2,!0),children:"*2"})]})]}),m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Duration (s) (for effects)"}),m.jsx("div",{className:"value-adjuster",children:m.jsx("input",{type:"number",value:s.toFixed(2),onChange:g=>t({duration:parseFloat(g.target.value)||1})})})]})]}),a==="timeline"&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Duration (s)"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("duration",-1),children:"-1"}),m.jsx("input",{type:"number",value:s.toFixed(2),onChange:g=>t({duration:parseFloat(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("duration",1),children:"+1"}),m.jsx("button",{onClick:()=>d("duration",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("duration",2,!0),children:"*2"})]})]}),a==="bpm"&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Beats"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("beats",-1),children:"-1"}),m.jsx("input",{type:"number",value:o,onChange:g=>t({beats:parseInt(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("beats",1),children:"+1"}),m.jsx("button",{onClick:()=>d("beats",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("beats",2,!0),children:"*2"})]})]}),(a==="timeline"||a==="bpm")&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Speed Multiplier"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("speedMultiplier",-.1),children:"-0.1"}),m.jsx("input",{type:"number",value:u.toFixed(2),onChange:g=>t({speedMultiplier:parseFloat(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("speedMultiplier",.1),children:"+0.1"})]})]})]})]})},fy=({selectedLayerIndex:r,selectedColIndex:t,clip:a,audioInfo:s,onAssignAudio:o,onRemoveAudio:u,onUpdateAudioVolume:f,onUpdatePlaybackSettings:h,onSetParamSync:d,onToggleDacMirror:g,onRemoveDac:v,onRemoveEffect:x,onReorderEffects:y,onAddEffect:S,onParameterChange:E,onGeneratorParameterChange:T,progressRef:R})=>{const[j,M]=C.useState({}),[D,I]=C.useState(null);if(C.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(ge=>{M(xe=>({...xe,[ge.ip]:ge.status}))})},[]),r===null||t===null)return m.jsxs("div",{className:"clip-settings-panel settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Clip Settings"})}),m.jsx("p",{className:"info-text",children:"Select a clip to view settings."})]});const P=be=>{be.preventDefault(),be.stopPropagation();try{const ge=JSON.parse(be.dataTransfer.getData("application/json"));ge&&ge.type&&S&&S(ge)}catch(ge){console.error("Failed to drop effect in ClipSettingsPanel:",ge)}},H=be=>{be.preventDefault(),be.dataTransfer.dropEffect="copy"},ie=be=>{I(be)},se=(be,ge)=>{be.preventDefault(),!(D===null||D===ge)&&y&&(y(r,t,D,ge),I(ge))},de=be=>{I(null)},{effects:ne=[],assignedDacs:Z=[],playbackSettings:ee={},syncSettings:ae={},audioFile:$=null,audioVolume:re=1,type:B=null,generatorDefinition:U=null,currentParams:le={},workerId:ve=null}=a||{},N=ne.length>0,V=B==="generator"&&!!U,oe=Z.length>0,W=(a?.totalFrames||30)/(a?.fps||30),z=s&&s.duration?s.currentTime/s.duration*100:0;return m.jsxs("div",{className:"clip-settings-panel settings-panel-base",onDrop:P,onDragOver:H,children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Clip Settings"})}),m.jsx(gn,{title:"Audio",children:$?m.jsxs("div",{className:"assigned-audio-info",style:{position:"relative"},children:[m.jsx("button",{className:"remove-effect-btn",onClick:u,style:{position:"absolute",top:"-5px",right:"-5px",fontSize:"14px"},children:""}),m.jsx("div",{className:"audio-file-name",title:$.path,style:{paddingRight:"15px"},children:$.name}),m.jsx("div",{className:"audio-progress-container",children:m.jsx("div",{className:"audio-progress-bar",style:{width:`${z}%`}})}),m.jsx("div",{className:"audio-time-info",children:s?`${s.currentTime.toFixed(1)}s / ${s.duration.toFixed(1)}s`:"0.0s / 0.0s"}),m.jsxs("div",{className:"audio-volume-control",style:{marginTop:"10px"},children:[m.jsxs("label",{style:{fontSize:"10px",display:"block",marginBottom:"2px"},children:["Volume: ",Math.round(re*100),"%"]}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:re,onChange:be=>f(r,t,parseFloat(be.target.value)),style:{width:"100%",height:"4px"}})]})]}):m.jsx("button",{className:"assign-audio-btn",onClick:o,children:"Assign Audio File"})}),m.jsx(cy,{settings:ee,onUpdate:be=>h(r,t,be)}),oe&&m.jsx(gn,{title:"Assigned DACs",children:m.jsx("ul",{className:"assigned-dacs-list",children:Z.map((be,ge)=>{const xe=j[be.ip];return m.jsxs("li",{className:"assigned-dac-item",children:[m.jsxs("div",{className:"dac-info-block",children:[m.jsxs("span",{className:"dac-name-tiny",children:[be.hostName||be.ip," - Ch ",be.channel]}),xe&&m.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",xe.playback_state===2?"PLAYING":xe.playback_state===1?"PREPARED":"IDLE"," | Buf: ",xe.buffer_fullness,xe.buffer_capacity?`/${xe.buffer_capacity}`:""," | PPS: ",xe.point_rate]})]}),m.jsxs("div",{className:"dac-mirror-controls",children:[m.jsx("button",{className:`mirror-btn ${be.mirrorX?"active":""}`,onClick:()=>g(r,t,ge,"x"),title:"Mirror X Axis",children:"X"}),m.jsx("button",{className:`mirror-btn ${be.mirrorY?"active":""}`,onClick:()=>g(r,t,ge,"y"),title:"Mirror Y Axis",children:"Y"})]}),m.jsx("button",{className:"remove-dac-btn",onClick:()=>v(ge),children:""})]},`${be.unitID||be.ip}-${be.channel}-${ge}`)})})}),V&&m.jsx(uy,{selectedGeneratorId:U.id,selectedGeneratorParams:le,onParameterChange:T,syncSettings:ae,onSetParamSync:d,layerIndex:r,colIndex:t,progressRef:R,workerId:ve,clipDuration:W}),m.jsx(gn,{title:"Clip Effects",children:m.jsx("div",{className:"clip-effects-list",style:{minHeight:"50px"},onDrop:de,children:N?ne.map((be,ge)=>m.jsx("div",{draggable:!0,onDragStart:()=>ie(ge),onDragOver:xe=>se(xe,ge),children:m.jsx(em,{effect:be,assignedDacs:Z,syncSettings:ae,onSetParamSync:d,context:{layerIndex:r,colIndex:t,effectIndex:ge,targetType:"effect",workerId:ve},onParamChange:(xe,He)=>E(r,t,ge,xe,He),onRemove:()=>x(r,t,ge),progressRef:R,clipDuration:W})},be.instanceId||be.id+ge)):m.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},dy=({selectedLayerIndex:r,autopilotMode:t,onAutopilotChange:a,layerEffects:s,assignedDacs:o=[],onToggleDacMirror:u,onRemoveDac:f,onAddEffect:h,onRemoveEffect:d,onParamChange:g})=>{const[v,x]=C.useState({});if(C.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(T=>{x(R=>({...R,[T.ip]:T.status}))})},[]),r===null)return m.jsxs("div",{className:"settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Layer Settings"})}),m.jsx("div",{className:"settings-card-content",children:m.jsx("p",{className:"info-text",children:"Select a layer to edit settings"})})]});const y=E=>{E.preventDefault(),E.stopPropagation();try{const T=JSON.parse(E.dataTransfer.getData("application/json"));T&&T.id&&h(T)}catch(T){console.error("Failed to drop effect:",T)}},S=E=>{E.preventDefault(),E.dataTransfer.dropEffect="copy"};return m.jsxs("div",{className:"settings-panel-base",onDrop:y,onDragOver:S,children:[m.jsx("h3",{children:"Layer Settings"}),o&&o.length>0&&m.jsx(gn,{title:"Assigned DACs",children:m.jsx("ul",{className:"assigned-dacs-list",children:o.map((E,T)=>{const R=v[E.ip];return m.jsxs("li",{className:"assigned-dac-item",children:[m.jsxs("div",{className:"dac-info-block",children:[m.jsxs("span",{className:"dac-name-tiny",children:[E.hostName||E.ip," - Ch ",E.channel]}),R&&m.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",R.playback_state===2?"PLAYING":R.playback_state===1?"PREPARED":"IDLE"," | Buf: ",R.buffer_fullness,R.buffer_capacity?`/${R.buffer_capacity}`:""," | PPS: ",R.point_rate]})]}),m.jsxs("div",{className:"dac-mirror-controls",children:[m.jsx("button",{className:`mirror-btn ${E.mirrorX?"active":""}`,onClick:()=>u(r,T,"x"),title:"Mirror X Axis",children:"X"}),m.jsx("button",{className:`mirror-btn ${E.mirrorY?"active":""}`,onClick:()=>u(r,T,"y"),title:"Mirror Y Axis",children:"Y"})]}),m.jsx("button",{className:"remove-dac-btn",onClick:()=>f(r,T),children:""})]},`${E.unitID||E.ip}-${E.channel}-${T}`)})})}),m.jsx(gn,{title:`Layer ${r+1} Autopilot`,children:m.jsxs("div",{className:"param-editor",children:[m.jsx("label",{children:"Mode"}),m.jsx("div",{className:"clip-playback-settings",children:m.jsxs("div",{className:"playback-mode-selector",children:[m.jsx("button",{className:t==="off"?"active":"",onClick:()=>a("off"),children:"OFF"}),m.jsx("button",{className:t==="forward"?"active":"",onClick:()=>a("forward"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-forward-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"m9.77 12.11 4.012-2.953a.647.647 0 0 0 0-1.114L9.771 5.09a.644.644 0 0 0-.971.557V6.65H2v3.9h6.8v1.003c0 .505.545.808.97.557"})})}),m.jsx("button",{className:t==="random"?"active":"",onClick:()=>a("random"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-shuffle",viewBox:"0 0 16 16",children:[m.jsx("path",{fillRule:"evenodd",d:"M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"}),m.jsx("path",{d:"M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"})]})})]})})]})}),m.jsx(gn,{title:"Layer Effects",children:m.jsx("div",{className:"layer-effects-list",style:{minHeight:"50px"},children:s&&s.length>0?s.map((E,T)=>m.jsx(em,{effect:E,onRemove:()=>d(T),onParamChange:(R,j)=>g(T,R,j),syncSettings:{},onSetParamSync:()=>{},context:{layerIndex:r,colIndex:null,effectIndex:T,targetType:"layerEffect"}},E.instanceId||T)):m.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},py=({message:r,visible:t})=>t?m.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#333",color:"white",padding:"10px 20px",borderRadius:"5px",zIndex:1e3,opacity:t?1:0,transition:"opacity 0.5s ease-in-out"},children:r}):null,tm=C.createContext(null),nm=()=>C.useContext(tm),hy=({children:r,onWorkerMessage:t})=>{const a=C.useRef(null);return a.current===null&&(a.current=new Worker(new URL(""+new URL("rendering.worker-WX0RL8So.js",import.meta.url).href,import.meta.url),{type:"module"})),C.useEffect(()=>{const s=a.current;return t&&(s.onmessage=t),()=>{s.terminate(),t&&(s.onmessage=null)}},[t]),m.jsx(tm.Provider,{value:a.current,children:r})},my=({frame:r,effects:t,showBeamEffect:a,beamAlpha:s,fadeAlpha:o,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d={},bpm:g=120,clipDuration:v=1,progress:x=0,previewTime:y=0,onToggleBeamEffect:S,onCycleDisplayMode:E})=>{const T=C.useRef(null),R=nm(),j=C.useRef(`ilda-player-${Math.random()}`);return C.useEffect(()=>{const M=T.current;if(!M||!R)return;const D=M.transferControlToOffscreen();return R.postMessage({action:"register",payload:{id:j.current,canvas:D,type:"single",data:{showBeamEffect:a,beamAlpha:s,fadeAlpha:o,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d,bpm:g,clipDuration:v,progress:x,previewTime:y}}},[D]),()=>{R.postMessage({action:"deregister",payload:{id:j.current}})}},[]),C.useEffect(()=>{if(!R)return;const M=r?[r]:[];R.postMessage({action:"update",payload:{id:j.current,data:{ildaFrames:M,effects:t,showBeamEffect:a,beamAlpha:s,fadeAlpha:o,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d,bpm:g,clipDuration:v,progress:x,previewTime:y}}})},[R,r,t,a,s,o,u,f,h,d,g,v,x,y]),m.jsxs("div",{className:"ilda-player",children:[m.jsx("h3",{children:"Selected Preview"}),m.jsxs("div",{className:"renderSettingToggle",children:[m.jsx("button",{onClick:S,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),m.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),m.jsx("button",{onClick:E,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),m.jsx("canvas",{ref:T,width:"300",height:"300",style:{backgroundColor:"black"}})]})},gy=Pr.memo(my),vy=({activeFrames:r,showBeamEffect:t,beamAlpha:a,fadeAlpha:s,previewScanRate:o,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:d,previewTime:g=0,onToggleBeamEffect:v,onCycleDisplayMode:x})=>{const y=C.useRef(null),S=nm(),E=C.useRef(`world-preview-${Math.random()}`);return C.useEffect(()=>{const T=y.current;if(!T||!S)return;const R=T.transferControlToOffscreen();return S.postMessage({action:"register",payload:{id:E.current,canvas:R,type:"world",data:{showBeamEffect:t,beamAlpha:a,fadeAlpha:s,previewScanRate:o,beamRenderMode:u,previewTime:g}}},[R]),()=>{S.postMessage({action:"deregister",payload:{id:E.current}})}},[]),C.useEffect(()=>{if(!S)return;const T=Object.entries(r).map(([R,{frame:j,effects:M,layerIndex:D,syncSettings:I,bpm:P,clipDuration:H,progress:ie}])=>({frames:[j],effects:M,workerId:R,layerIndex:D,syncSettings:I,bpm:P,clipDuration:H,progress:ie}));S.postMessage({action:"update",payload:{id:E.current,data:{worldData:T,showBeamEffect:t,beamAlpha:a,fadeAlpha:s,previewScanRate:o,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:d,previewTime:g}}})},[S,r,t,a,s,o,u,f,h,d,g]),m.jsxs("div",{className:"world-preview",children:[m.jsx("h3",{children:"World Preview"}),m.jsxs("div",{className:"renderSettingToggle",children:[m.jsx("button",{onClick:v,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),m.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),m.jsx("button",{onClick:x,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),m.jsx("canvas",{ref:y,width:"300",height:"300",style:{backgroundColor:"black"}})]})},yy=({bpm:r,onBpmChange:t})=>{const[a,s]=C.useState([]),[o,u]=C.useState(r);C.useEffect(()=>{u(r)},[r]);const f=()=>{const d=Date.now(),g=[...a,d].slice(-4);if(s(g),g.length>=2){const v=[];for(let S=1;S<g.length;S++)v.push(g[S]-g[S-1]);const x=v.reduce((S,E)=>S+E)/v.length,y=Math.round(6e4/x);t(y)}},h=d=>{const g=parseFloat(d.target.value);u(d.target.value),!isNaN(g)&&g>0&&g<999&&t(g)};return m.jsx("div",{className:"bpm-controls",children:m.jsxs("div",{className:"bpm-display",children:[m.jsx(yt,{id:"bpm_tap",children:m.jsx("button",{className:"bpm-tap-btn",onClick:f,children:"TAP"})}),m.jsxs("div",{className:"bpm-fine-controls",children:[m.jsx(yt,{id:"bpm_fine_down",children:m.jsx("button",{className:"bpm-fine-btn",onClick:()=>t(Math.max(1,r-.1)),children:"-"})}),m.jsx(yt,{id:"bpm_value",children:m.jsx("input",{type:"number",className:"bpm-input",value:o,onChange:h,min:"1",max:"999",step:"0.1"})}),m.jsx(yt,{id:"bpm_fine_up",children:m.jsx("button",{className:"bpm-fine-btn",onClick:()=>t(Math.min(999,r+.1)),children:"+"})})]}),m.jsx("span",{className:"bpm-label",children:"BPM"})]})})},by=({onPlay:r,onPause:t,onStop:a,isPlaying:s,isStopped:o})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"transport",label:h.toUpperCase()}))};return m.jsxs("div",{className:"transport-controls",children:[m.jsx(yt,{id:"transport_play",children:m.jsx("button",{className:`speed-control-button ${s?"active":""}`,onClick:r,draggable:!0,onDragStart:f=>u(f,"play"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-play-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"})})})}),m.jsx(yt,{id:"transport_pause",children:m.jsx("button",{className:`speed-control-button ${!s&&!o?"active":""}`,onClick:t,draggable:!0,onDragStart:f=>u(f,"pause"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-pause-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5m5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5"})})})}),m.jsx(yt,{id:"transport_stop",children:m.jsx("button",{className:`speed-control-button ${o?"active":""}`,onClick:a,draggable:!0,onDragStart:f=>u(f,"stop"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-stop-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"})})})})]})},xy=({value:r,onToggle:t,label:a,onDrop:s,isAssigned:o,...u})=>{const f=d=>{d.preventDefault(),d.dataTransfer.dropEffect="link"},h=d=>{d.preventDefault();try{const g=d.dataTransfer.getData("application/x-truelazer-param");console.log("[QuickButton] Dropped Data Raw:",g);const v=JSON.parse(g);console.log("[QuickButton] Dropped Data Parsed:",v),v&&(v.type==="toggle"||v.type==="checkbox")?s(v):console.warn("[QuickButton] Invalid data type for button:",v?.type)}catch(g){console.error("[QuickButton] Drop Error:",g)}};return m.jsx("div",{className:`quick-assign-button ${r?"active":""} ${o?"":"unassigned"}`,onClick:o?t:void 0,onDragOver:f,onDrop:h,...u,children:m.jsx("div",{className:"button-label",title:a||"Empty",children:a||"Assign"})})},Sy=({assigns:r,onUpdateKnob:t,onToggleButton:a,onAssign:s})=>m.jsxs("div",{className:"global-quick-assigns-panel",children:[m.jsx("div",{className:"quick-assigns-row knobs-row",children:Array.from({length:8}).map((o,u)=>{const f=!!r.knobs[u].link;return m.jsx(yt,{id:`quick_knob_${u}`,children:m.jsx(is,{value:r.knobs[u]?.value||0,label:r.knobs[u]?.label,isAssigned:f,onChange:h=>f&&t(u,h),onDrop:h=>{console.log(`[GlobalQuickAssigns] Knob ${u} Drop Data:`,h),s("knob",u,h)}})},`knob-${u}`)})}),m.jsx("div",{className:"quick-assigns-row buttons-row",children:Array.from({length:8}).map((o,u)=>{const f=!!r.buttons[u].link;return m.jsx(yt,{id:`quick_btn_${u}`,children:m.jsx(xy,{value:r.buttons[u]?.value||!1,label:r.buttons[u]?.label,isAssigned:f,onToggle:()=>a(u),onDrop:h=>{console.log(`[GlobalQuickAssigns] Button ${u} Drop Data:`,h),s("button",u,h)}})},`btn-${u}`)})})]}),Ey=({enabledShortcuts:r={},onOpenOutputSettings:t,quickAssigns:a,onUpdateKnob:s,onToggleButton:o,onAssign:u})=>{const{midiInitialized:f,midiInputs:h,selectedMidiInputId:d,setSelectedMidiInputId:g,isMapping:v,startMapping:x,stopMapping:y,learningId:S,lastMidiEvent:E,setMappings:T,saveMappings:R,exportMappings:j,importMappings:M}=Qo(),{artnetInitialized:D,isMapping:I,startMapping:P,stopMapping:H,setMappings:ie,saveMappings:se,exportMappings:de,importMappings:ne,lastDmxEvent:Z}=Sf()||{},{isMapping:ee,startMapping:ae,stopMapping:$,setMappings:re,saveMappings:B,exportMappings:U,importMappings:le}=Ef()||{},[ve,N]=C.useState([]),[V,oe]=C.useState(""),[W,z]=C.useState(!1),[be,ge]=C.useState(57121),[xe,He]=C.useState("127.0.0.1"),[Lt,Kt]=C.useState(57120),[Cn,sn]=C.useState(null);C.useEffect(()=>{const et=async()=>{if(r.artnet)try{const Wt=await window.electronAPI.getArtnetUniverses();N(Wt),Wt.length>0&&oe(Wt[0].id)}catch(Wt){console.error("Failed to fetch Art-Net universes:",Wt)}},Ne=async()=>{if(r.osc)try{if((await window.electronAPI.initializeOsc({localPort:be,remoteAddress:xe,remotePort:Lt})).success)return z(!0),window.electronAPI.onOscMessageReceived(({oscMessage:$t})=>{sn($t)})}catch(Wt){console.error("Failed to initialize OSC:",Wt)}};let We=()=>{};return et(),Ne().then(Wt=>{typeof Wt=="function"&&(We=Wt)}),()=>{typeof We=="function"&&We()}},[r]);const _a=et=>g(et.target.value),vn=()=>v?y():x(),zn=()=>I?H():P(),Oa=()=>ee?$():ae();return m.jsxs("div",{className:"settings-panel settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Global Settings"})}),a&&m.jsx(gn,{title:"Quick Assigns",children:m.jsx(Sy,{assigns:a,onUpdateKnob:s,onToggleButton:o,onAssign:u})}),m.jsxs(gn,{title:"Channel/DAC Settings",children:[m.jsx("p",{className:"info-text",children:"Output routing and safety zones configuration."}),m.jsx("button",{className:"small-btn",style:{width:"100%",marginTop:"5px"},onClick:t,children:"Open Output Settings"})]}),(r.midi||r.artnet||r.osc||r.keyboard)&&m.jsxs("div",{className:"shortcuts-settings-panel",children:[r.keyboard&&m.jsx(gn,{title:"Keyboard Shortcuts",children:m.jsxs("div",{className:"keyboard-config",children:[m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${ee?"active":""}`,onClick:Oa,style:{backgroundColor:ee?"var(--theme-color)":"",gridColumn:"span 2"},children:ee?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:B,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:U,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:le,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>re({}),children:"Clear"})]}),m.jsx("p",{className:"info-text",style:{fontSize:"9px",color:"#666",marginTop:"5px"},children:'Assign keys to buttons/sliders by activating "Start Mapping" and clicking a control.'})]})}),r.midi&&m.jsx(gn,{title:"MIDI Shortcuts",children:f?m.jsxs("div",{className:"midi-config",children:[m.jsx("select",{className:"param-select",value:d,onChange:_a,style:{marginBottom:"8px",width:"100%"},children:h.map(et=>m.jsx("option",{value:et.id,children:et.name},et.id))}),m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${v?"active":""}`,onClick:vn,style:{backgroundColor:v?"var(--theme-color)":"",gridColumn:"span 2"},children:v?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:R,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:j,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:M,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>T({}),children:"Clear"})]}),E&&m.jsxs("div",{className:"last-event-status",children:[E.type," ",E.note||E.controller," (CH",E.channel,")"]})]}):m.jsx("p",{className:"loading-text",children:"Initializing MIDI..."})}),r.artnet&&m.jsx(gn,{title:"ArtNet Shortcuts",children:D?m.jsxs("div",{className:"artnet-config",children:[m.jsx("select",{className:"param-select",value:V,onChange:et=>{oe(et.target.value);const Ne=parseInt(et.target.value.replace("universe-",""));window.electronAPI&&window.electronAPI.listenArtnetUniverse&&window.electronAPI.listenArtnetUniverse(Ne)},style:{marginBottom:"8px",width:"100%"},children:ve.map(et=>m.jsx("option",{value:et.id,children:et.name},et.id))}),m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${I?"active":""}`,onClick:zn,style:{backgroundColor:I?"var(--theme-color)":"",gridColumn:"span 2"},children:I?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:se,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:de,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:ne,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>ie({}),children:"Clear"})]}),Z&&m.jsxs("div",{className:"last-event-status",children:["UNIV ",Z.universe," CH ",Z.channel+1," (Val: ",Z.value,")"]})]}):m.jsx("p",{className:"loading-text",children:"Initializing Art-Net..."})}),r.osc&&m.jsx(gn,{title:"OSC Shortcuts",children:m.jsx("div",{className:"osc-config",children:m.jsxs("p",{className:"info-text",children:["Listening on port: ",be]})})})]})]})},Ay=({show:r,title:t,initialValue:a,onSave:s,onClose:o})=>{const[u,f]=C.useState(a||"");if(C.useEffect(()=>{r&&f(a||"")},[r,a]),!r)return null;const h=()=>{s(u),o()},d=g=>{g.key==="Enter"&&h(),g.key==="Escape"&&o()};return m.jsx("div",{className:"shortcuts-modal-overlay",style:{pointerEvents:"auto"},children:m.jsxs("div",{className:"shortcuts-modal-content",style:{maxWidth:"400px"},children:[m.jsx("h3",{children:t||"Rename"}),m.jsxs("div",{className:"settings-section",style:{border:"none"},children:[m.jsx("input",{type:"text",value:u,onChange:g=>f(g.target.value),onKeyDown:d,autoFocus:!0,style:{width:"100%",padding:"8px",backgroundColor:"#1a1a1a",color:"white",border:"1px solid var(--theme-color)",borderRadius:"4px",marginBottom:"15px"}}),m.jsxs("div",{className:"button-row",style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[m.jsx("button",{onClick:o,children:"Cancel"}),m.jsx("button",{onClick:h,style:{backgroundColor:"var(--theme-color)",color:"black"},children:"Save"})]})]})]})})},Ty=({safetyZones:r,outputArea:t,testLineY:a,testLineEnabled:s,transformationEnabled:o,transformationMode:u,flipX:f,flipY:h,onUpdateSafetyZones:d,onUpdateOutputArea:g,selectedZoneIndex:v,onSelectZone:x,gridSize:y=20,snapToGrid:S=!1})=>{const E=C.useRef(null),[T,R]=C.useState(null),j=(Z,ee,ae)=>{Z.strokeStyle="#333",Z.lineWidth=1,Z.beginPath();for(let $=0;$<=y;$++){const re=$/y,B=re*ee,U=re*ae;Z.moveTo(B,0),Z.lineTo(B,ae),Z.moveTo(0,U),Z.lineTo(ee,U)}Z.stroke(),Z.strokeStyle="#666",Z.lineWidth=2,Z.beginPath(),Z.moveTo(ee/2,0),Z.lineTo(ee/2,ae),Z.moveTo(0,ae/2),Z.lineTo(ee,ae/2),Z.stroke(),Z.fillStyle="#aaa",Z.font="10px monospace",Z.fillText("0,0",5,12),Z.fillText("1,0",ee-25,12),Z.fillText("0,1",5,ae-5),Z.fillText("1,1",ee-25,ae-5)},M=(Z,ee,ae,$=!1,re=!1)=>{const{x:B,y:U,w:le,h:ve}=ee;if(Z.fillStyle=ae,Z.fillRect(B,U,le,ve),Z.strokeStyle=$?"#fff":re?"#0089ff":"#ff0000",Z.lineWidth=$?2:1,Z.strokeRect(B,U,le,ve),$||re){Z.fillStyle="#fff";const V=(z,be)=>Z.fillRect(z-6/2,be-6/2,6,6);V(B,U),V(B+le,U),V(B,U+ve),V(B+le,U+ve);const oe=4;Z.fillStyle="#ccc";const W=(z,be)=>Z.fillRect(z-oe/2,be-oe/2,oe,oe);W(B+le/2,U),W(B+le/2,U+ve),W(B,U+ve/2),W(B+le,U+ve/2)}},D=()=>{const Z=E.current;if(!Z)return;const ee=Z.getContext("2d"),{width:ae,height:$}=Z;if(ee.clearRect(0,0,ae,$),j(ee,ae,$),o&&t&&M(ee,{x:t.x*ae,y:t.y*$,w:t.w*ae,h:t.h*$},"rgba(0, 137, 255, 0.2)",!1,!0),r.forEach((re,B)=>{M(ee,{x:re.x*ae,y:re.y*$,w:re.w*ae,h:re.h*$},"rgba(255, 0, 0, 0.3)",B===v)}),s){let re=a;h&&(re=1-re);let B=0,U=1;if(o&&t){if(u==="scale")B=t.x,U=t.x+t.w,re=t.y+re*t.h;else if(u==="crop"){if(re<t.y||re>t.y+t.h)return;B=Math.max(0,t.x),U=Math.min(1,t.x+t.w)}}const le=re*$,ve=B*ae,N=U*ae;let V=[[ve,N]];r&&r.length>0&&r.forEach(oe=>{const W=oe.y*$,z=oe.h*$,be=oe.x*ae,ge=oe.w*ae;if(le>=W&&le<=W+z){const xe=[];V.forEach(He=>{const[Lt,Kt]=He,Cn=be,sn=be+ge;sn<=Lt||Cn>=Kt?xe.push(He):(Cn>Lt&&xe.push([Lt,Cn]),sn<Kt&&xe.push([sn,Kt]))}),V=xe}}),ee.strokeStyle="#00ff00",ee.lineWidth=2,ee.beginPath(),V.forEach(oe=>{ee.moveTo(oe[0],le),ee.lineTo(oe[1],le)}),ee.stroke()}};C.useEffect(()=>{D()},[r,t,a,s,o,v,y,f,h]);const I=Z=>{const ee=E.current.getBoundingClientRect();return{x:(Z.clientX-ee.left)/ee.width,y:(Z.clientY-ee.top)/ee.height}},P=(Z,ee,ae)=>{if(!ae)return null;const $=.03;return Math.abs(Z-ae.x)<$&&Math.abs(ee-ae.y)<$?"nw":Math.abs(Z-(ae.x+ae.w))<$&&Math.abs(ee-ae.y)<$?"ne":Math.abs(Z-ae.x)<$&&Math.abs(ee-(ae.y+ae.h))<$?"sw":Math.abs(Z-(ae.x+ae.w))<$&&Math.abs(ee-(ae.y+ae.h))<$?"se":Math.abs(ee-ae.y)<$&&Z>=ae.x&&Z<=ae.x+ae.w?"n":Math.abs(ee-(ae.y+ae.h))<$&&Z>=ae.x&&Z<=ae.x+ae.w?"s":Math.abs(Z-ae.x)<$&&ee>=ae.y&&ee<=ae.y+ae.h?"w":Math.abs(Z-(ae.x+ae.w))<$&&ee>=ae.y&&ee<=ae.y+ae.h?"e":null},H=(Z,ee,ae)=>ae?Z>=ae.x&&Z<=ae.x+ae.w&&ee>=ae.y&&ee<=ae.y+ae.h:!1,ie=Z=>{const{x:ee,y:ae}=I(Z);if(v!==null&&r[v]){const $=r[v],re=P(ee,ae,$);if(re){R({type:"zone",index:v,handle:re,startX:ee,startY:ae,originalRect:{...$}});return}}for(let $=r.length-1;$>=0;$--){const re=r[$];if(re&&H(ee,ae,re)){x($);const B=P(ee,ae,re);R({type:"zone",index:$,handle:B||"move",startX:ee,startY:ae,originalRect:{...re}});return}}if(o&&t){const $=P(ee,ae,t);if($){R({type:"output",handle:$,startX:ee,startY:ae,originalRect:{...t}}),x(null);return}if(H(ee,ae,t)){R({type:"output",handle:"move",startX:ee,startY:ae,originalRect:{...t}}),x(null);return}}x(null)},se=Z=>{if(!S)return Z;const ee=1/y;return Math.round(Z/ee)*ee},de=Z=>{if(!T)return;const{x:ee,y:ae}=I(Z),$=ee-T.startX,re=ae-T.startY,B=(U,le,ve,N)=>{let V={...U};if(le==="move")V.x=se(U.x+ve),V.y=se(U.y+N);else{if(le.includes("w")){const oe=se(U.x+ve);V.w=U.x+U.w-oe,V.x=oe}if(le.includes("e")){const oe=se(U.x+U.w+ve);V.w=oe-V.x}if(le.includes("n")){const oe=se(U.y+N);V.h=U.y+U.h-oe,V.y=oe}if(le.includes("s")){const oe=se(U.y+U.h+N);V.h=oe-V.y}}return V.w<.01&&(V.w=.01),V.h<.01&&(V.h=.01),V};if(T.type==="zone"){const U=B(T.originalRect,T.handle,$,re);d(T.index,U)}else if(T.type==="output"){const U=B(T.originalRect,T.handle,$,re);g(U)}},ne=()=>{R(null)};return m.jsx("div",{className:"output-canvas-container",style:{width:"100%",height:"100%"},children:m.jsx("canvas",{ref:E,width:600,height:600,style:{width:"100%",height:"100%",display:"block"},className:"output-canvas",onMouseDown:ie,onMouseMove:de,onMouseUp:ne,onMouseLeave:ne})})},wy=({show:r,onClose:t,dacs:a=[],dacSettings:s={},onUpdateDacSettings:o})=>{const[u,f]=C.useState(null),[h,d]=C.useState(null),[g,v]=C.useState(20),[x,y]=C.useState(!1),S=C.useMemo(()=>{const D=[];return a.forEach(I=>{I.channels&&I.channels.length>0?I.channels.forEach(P=>{D.push({id:`${I.ip}:${P.serviceID}`,displayName:`${I.hostName||I.unitID||"DAC"} : ${P.name||`CH ${P.serviceID}`}`,ip:I.ip,channel:P.serviceID,dacName:I.hostName||I.unitID})}):D.push({id:`${I.ip}:0`,displayName:I.hostName||I.unitID||`DAC ${I.ip}`,ip:I.ip,channel:0,dacName:I.hostName||I.unitID})}),D},[a]);if(C.useEffect(()=>{S.length>0&&!u&&f(S[0].id)},[S,u]),!r)return null;const E=s[u]||{safetyZones:[],outputArea:{x:.1,y:.1,w:.8,h:.8},transformationEnabled:!1,transformationMode:"crop",testLineEnabled:!1,testLineY:.5,flipX:!1,flipY:!1},T=D=>{u&&o(u,{...E,...D})},R=()=>{const D={x:.4,y:.4,w:.2,h:.2};T({safetyZones:[...E.safetyZones,D]}),d(E.safetyZones.length)},j=()=>{T({safetyZones:[]}),d(null)},M=(D,I)=>{const P=[...E.safetyZones];P[D]=I,T({safetyZones:P})};return m.jsx("div",{className:"output-settings-modal-overlay",children:m.jsxs("div",{className:"output-settings-modal-content",children:[m.jsxs("div",{className:"output-settings-header",children:[m.jsx("h2",{children:"Output Settings"}),m.jsx("button",{className:"close-btn",onClick:t,children:"Close"})]}),m.jsxs("div",{className:"output-settings-body",children:[m.jsx("div",{className:"output-settings-col",children:m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Available Outputs"}),m.jsxs("ul",{className:"dac-list",children:[S.length===0?m.jsx("li",{style:{color:"#666",fontStyle:"italic"},children:"No Outputs detected"}):null,S.map((D,I)=>m.jsxs("li",{className:`dac-list-item ${u===D.id?"selected":""}`,onClick:()=>f(D.id),children:[m.jsx("span",{style:{fontWeight:"bold",fontSize:"0.9em"},children:D.displayName}),m.jsx("span",{style:{fontSize:"0.7em",color:"#888"},children:D.ip})]},D.id))]})]})}),m.jsxs("div",{className:"output-settings-col canvas-col",children:[m.jsxs("div",{className:"canvas-toolbar",children:[m.jsx("button",{className:"tool-btn",onClick:R,title:"Add Safety Zone",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-plus-square",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),m.jsx("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})]})}),m.jsx("button",{className:`tool-btn ${E.transformationEnabled?"active":""}`,onClick:()=>T({transformationEnabled:!E.transformationEnabled}),title:"Toggle Output Transformation",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-border-outer",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M7.5 1.906v.938h1v-.938zm0 1.875v.938h1V3.78h-1zm0 1.875v.938h1v-.938zM1.906 8.5h.938v-1h-.938zm1.875 0h.938v-1H3.78v1zm1.875 0h.938v-1h-.938zm2.813 0v-.031H8.5V7.53h-.031V7.5H7.53v.031H7.5v.938h.031V8.5zm.937 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zM7.5 9.406v.938h1v-.938zm0 1.875v.938h1v-.938zm0 1.875v.938h1v-.938z"}),m.jsx("path",{d:"M0 0v16h16V0zm1 1h14v14H1z"})]})}),m.jsx("button",{className:`tool-btn ${E.testLineEnabled?"active":""}`,onClick:()=>T({testLineEnabled:!E.testLineEnabled}),title:"Toggle Test Line",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),m.jsx("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})]})}),m.jsx("span",{style:{width:1,background:"#555",margin:"0 5px"}}),m.jsx("button",{className:`tool-btn ${x?"active":""}`,onClick:()=>y(!x),title:"Snap to Grid",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-magnet-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M15 12h-4v3h4zM5 12H1v3h4zM0 8a8 8 0 1 1 16 0v8h-6V8a2 2 0 1 0-4 0v8H0z"})})}),m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginLeft:5},children:[m.jsx("span",{style:{fontSize:10,color:"#aaa"},children:"Grid:"}),m.jsx("input",{type:"number",min:"5",max:"100",value:g,onChange:D=>v(parseInt(D.target.value)),className:"param-number-input",style:{width:40}})]})]}),m.jsx(Ty,{safetyZones:E.safetyZones,outputArea:E.outputArea,testLineY:E.testLineY,testLineEnabled:E.testLineEnabled,transformationEnabled:E.transformationEnabled,transformationMode:E.transformationMode,flipX:E.flipX,flipY:E.flipY,onUpdateSafetyZones:M,onUpdateOutputArea:D=>T({outputArea:D}),selectedZoneIndex:h,onSelectZone:d,gridSize:g,snapToGrid:x})]}),m.jsx("div",{className:"output-settings-col",children:u?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Output Transformation"}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Enable Editing"}),m.jsx("input",{type:"checkbox",checked:E.transformationEnabled,onChange:D=>T({transformationEnabled:D.target.checked})})]}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Flip X"}),m.jsx("input",{type:"checkbox",checked:E.flipX||!1,onChange:D=>T({flipX:D.target.checked})})]}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Flip Y"}),m.jsx("input",{type:"checkbox",checked:E.flipY||!1,onChange:D=>T({flipY:D.target.checked})})]}),E.transformationEnabled&&m.jsxs("div",{className:"control-row",children:[m.jsx("label",{style:{flex:1},children:"Mode"}),m.jsxs("select",{className:"param-select",value:E.transformationMode,onChange:D=>T({transformationMode:D.target.value}),children:[m.jsx("option",{value:"crop",children:"Crop"}),m.jsx("option",{value:"scale",children:"Scale"})]})]})]}),m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Safety Zones"}),m.jsxs("div",{className:"control-row",style:{justifyContent:"space-between",marginBottom:5},children:[m.jsx("button",{className:"small-btn",onClick:R,children:"Add New"}),m.jsx("button",{className:"small-btn clear",onClick:j,children:"Clear All"})]}),m.jsx("div",{className:"zone-list",children:E.safetyZones.map((D,I)=>m.jsxs("div",{className:`zone-item ${h===I?"selected":""}`,onClick:()=>d(I),children:[m.jsxs("span",{children:["Zone ",I+1]}),m.jsx("button",{className:"delete-zone-btn",onClick:P=>{P.stopPropagation(),h===I&&d(null);const H=E.safetyZones.filter((ie,se)=>se!==I);T({safetyZones:H})},children:""})]},I))}),h!==null&&m.jsxs("div",{style:{marginTop:10,borderTop:"1px solid #333",paddingTop:5},children:[m.jsx("label",{children:"Selected Zone Properties"}),m.jsx("div",{style:{fontSize:"0.8em",color:"#aaa"},children:"Select and drag zone on canvas to resize."})]})]}),m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Test Output"}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Enable Test Line"}),m.jsx("input",{type:"checkbox",checked:E.testLineEnabled,onChange:D=>T({testLineEnabled:D.target.checked})})]}),E.testLineEnabled&&m.jsxs("div",{className:"control-row",children:[m.jsx("label",{children:"Y Position"}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:E.testLineY,onChange:D=>T({testLineY:parseFloat(D.target.value)}),className:"param-slider"})]})]})]}):m.jsx("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"Select an Output to configure settings"})})]})]})})},Cy=C.createContext(),Af=()=>C.useContext(Cy),am=()=>{const[r,t]=C.useState([]),[a,s]=C.useState("default"),[o,u]=C.useState(1),f=C.useRef({}),h=C.useRef({}),{connectMediaElement:d}=Af()||{},g=C.useCallback(async()=>{try{const ie=(await navigator.mediaDevices.enumerateDevices()).filter(se=>se.kind==="audiooutput");if(t(ie),window.electronAPI&&window.electronAPI.setAudioDevices){const se=ie.map(de=>({deviceId:de.deviceId,label:de.label,groupId:de.groupId}));window.electronAPI.setAudioDevices(se)}}catch(H){console.error("Error enumerating audio devices:",H)}},[]);C.useEffect(()=>{g();let H;return window.electronAPI&&window.electronAPI.onUpdateAudioDeviceId&&(H=window.electronAPI.onUpdateAudioDeviceId(ie=>{s(ie)})),navigator.mediaDevices.addEventListener("devicechange",g),()=>{navigator.mediaDevices.removeEventListener("devicechange",g),H&&H()}},[g]);const v=C.useCallback(async(H,ie,se=1,de=!0)=>{if(f.current[H]&&(f.current[H].pause(),f.current[H].src=""),!ie)return;const ne=new Audio(`file://${ie}`);if(ne.crossOrigin="anonymous",ne.volume=se*o,a&&ne.setSinkId)try{await ne.setSinkId(a)}catch(Z){console.error("Error setting audio sink ID:",Z)}if(f.current[H]=ne,d){const Z=d(ne);h.current[H]=Z}if(de)try{await ne.play()}catch(Z){console.error("Error playing audio:",Z)}return ne},[a,d,o]),x=C.useCallback(H=>{f.current[H]&&(f.current[H].pause(),f.current[H].src="",delete f.current[H],h.current[H]&&(h.current[H].disconnect(),delete h.current[H]))},[]),y=C.useCallback(H=>{f.current[H]&&f.current[H].pause()},[]),S=C.useCallback(async H=>{if(f.current[H]&&f.current[H].paused)try{await f.current[H].play()}catch(ie){console.error("Error resuming audio:",ie)}},[]),E=C.useCallback(H=>{const ie=Math.max(.0625,Math.min(H,16));Object.values(f.current).forEach(se=>{try{se.playbackRate=ie}catch(de){console.warn("Failed to set playbackRate:",de)}})},[]),T=C.useCallback(H=>{u(H),Object.values(f.current).forEach(ie=>{ie.volume=H})},[]),R=C.useCallback(H=>{f.current[H]&&(f.current[H].currentTime=0)},[]),j=C.useCallback(()=>{Object.keys(f.current).forEach(H=>{x(H)})},[x]),M=C.useCallback(()=>{Object.keys(f.current).forEach(H=>{y(H)})},[y]),D=C.useCallback(()=>{Object.keys(f.current).forEach(H=>{S(H)})},[S]),I=C.useCallback(()=>{Object.keys(f.current).forEach(H=>{R(H)})},[R]),P=C.useCallback(H=>{const ie=f.current[H];return ie?{currentTime:ie.currentTime,duration:ie.duration,paused:ie.paused}:null},[]);return{devices:r,selectedDeviceId:a,setSelectedDeviceId:s,globalVolume:o,setVolume:T,playAudio:v,stopAudio:x,pauseAudio:y,resumeAudio:S,setPlaybackRate:E,resetAudio:R,stopAllAudio:j,pauseAllAudio:M,resumeAllAudio:D,resetAllAudio:I,getAudioInfo:P}},My=({show:r,onClose:t})=>{const{fftSettings:a,setFftSettings:s}=Af()||{},{devices:o,selectedDeviceId:u,setSelectedDeviceId:f,globalVolume:h,setVolume:d}=am(),[g,v]=C.useState("output");if(!r)return null;const x=(y,S,E)=>{const T={...a},R=`${y}Range`;T[R][S]=parseFloat(E),s(T)};return m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content audio-settings-window",style:{minWidth:"400px"},children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:"Audio Settings"}),m.jsx("button",{className:"close-btn",onClick:t,children:""})]}),m.jsxs("div",{className:"tab-header",style:{display:"flex",gap:"10px",marginBottom:"15px",borderBottom:"1px solid #444"},children:[m.jsx("button",{className:`tab-btn ${g==="output"?"active":""}`,onClick:()=>v("output"),style:{padding:"8px 15px",background:"none",border:"none",color:g==="output"?"var(--theme-color)":"#888",borderBottom:g==="output"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"Audio Output"}),m.jsx("button",{className:`tab-btn ${g==="fft"?"active":""}`,onClick:()=>v("fft"),style:{padding:"8px 15px",background:"none",border:"none",color:g==="fft"?"var(--theme-color)":"#888",borderBottom:g==="fft"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"FFT Settings"})]}),m.jsxs("div",{className:"modal-body",children:[g==="output"&&m.jsxs("div",{className:"audio-output-settings",children:[m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Device"}),m.jsx("select",{className:"param-select",value:u,onChange:y=>f(y.target.value),style:{width:"100%",padding:"5px"},children:o.map(y=>m.jsx("option",{value:y.deviceId,children:y.label||`Device ${y.deviceId.slice(0,5)}`},y.deviceId))})]}),m.jsxs("div",{className:"settings-row",style:{textAlign:"center"},children:[m.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Volume"}),m.jsx("div",{style:{display:"flex",justifyContent:"center"},children:m.jsx(is,{value:h,onChange:d,label:"MASTER",isAssigned:!0,size:60})})]})]}),g==="fft"&&m.jsxs("div",{className:"fft-settings",children:[m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Source"}),m.jsxs("select",{className:"param-select",value:a.source,onChange:y=>s({...a,source:y.target.value}),style:{width:"100%",padding:"5px"},children:[m.jsx("option",{value:"external",children:"External (Microphone/Loopback)"}),m.jsx("option",{value:"clip",children:"Clip FFT (Audio from active clips)"})]})]}),m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Ranges (Hz)"}),m.jsxs("div",{className:"range-controls",style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"10px",alignItems:"center"},children:[m.jsx("span",{children:"Low:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:a.lowRange[0],onChange:y=>x("low",0,y.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:a.lowRange[1],onChange:y=>x("low",1,y.target.value),style:{width:"60px"}})]}),m.jsx("span",{children:"Mid:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:a.midRange[0],onChange:y=>x("mid",0,y.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:a.midRange[1],onChange:y=>x("mid",1,y.target.value),style:{width:"60px"}})]}),m.jsx("span",{children:"High:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:a.highRange[0],onChange:y=>x("high",0,y.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:a.highRange[1],onChange:y=>x("high",1,y.target.value),style:{width:"60px"}})]})]})]}),m.jsxs("div",{className:"settings-row",style:{display:"flex",justifyContent:"space-around",textAlign:"center"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"GAIN"}),m.jsx(is,{value:a.gain/5,onChange:y=>s({...a,gain:y*5}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"HOLD"}),m.jsx(is,{value:a.holdTime/1e3,onChange:y=>s({...a,holdTime:y*1e3}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"FALL"}),m.jsx(is,{value:a.fallTime/2e3,onChange:y=>s({...a,fallTime:y*2e3}),isAssigned:!0,size:40})]})]})]})]})]}),m.jsx("style",{jsx:!0,children:`
                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .param-select, input {
                    background: #111;
                    border: 1px solid #444;
                    color: white;
                    border-radius: 4px;
                }
            `})]})};class Ny extends Pr.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,a){console.error("Uncaught error:",t,a)}render(){return this.state.hasError?m.jsx("h1",{children:"Something went wrong."}):this.props.children}}const rm=C.createContext(null),Ry=()=>C.useContext(rm),Dy=({children:r})=>{const[t,a]=C.useState(null);return C.useEffect(()=>{if(!t){const s=new Worker(new URL(""+new URL("ilda-parser.worker-Don4LfHc.js",import.meta.url).href,import.meta.url));a(s)}return()=>{t&&t.terminate()}},[t]),m.jsx(rm.Provider,{value:t,children:r})},im=C.createContext(null),_y=({children:r})=>{const t=C.useMemo(()=>{try{const a=new Worker(new URL(""+new URL("generators.worker-EkgwJKrR.js",import.meta.url).href,import.meta.url),{type:"module"});return a.onerror=s=>{console.error("Generator Worker instantiation or internal error:",s)},a}catch(a){return console.error("Failed to create Generator Worker:",a),null}},[]);return C.useEffect(()=>{if(t)return()=>{t.terminate()}},[t]),m.jsx(im.Provider,{value:t,children:r})},Oy=()=>{const r=C.useContext(im);if(r===void 0)throw new Error("useGeneratorWorker must be used within a GeneratorWorkerProvider");return r};var ky=q0();const Ly=bf(ky),Uy=()=>{const{isMapping:r,mappings:t,learningId:a}=Qo(),{isMapping:s,mappings:o,learningId:u}=Sf()||{},{isMapping:f,mappings:h,learningId:d}=Ef()||{},g=r||s||f,[v,x]=C.useState([]),y=C.useCallback(()=>{if(!g)return;const S=document.querySelectorAll("[data-mappable-id]"),E=Array.from(S).map(T=>{const R=T.getBoundingClientRect();return{id:T.getAttribute("data-mappable-id"),rect:{top:R.top,left:R.left,width:R.width,height:R.height}}});x(E)},[g]);return C.useEffect(()=>{if(g){y(),window.addEventListener("resize",y);const S=setTimeout(y,100);return()=>{window.removeEventListener("resize",y),clearTimeout(S)}}else x([])},[g,y]),g?Ly.createPortal(m.jsx("div",{className:"midi-mapping-global-overlay-container",children:v.map(S=>{const E=t[S.id],T=o?o[S.id]:null,R=h?h[S.id]:null,j=r&&a===S.id||s&&u===S.id||f&&d===S.id;let M=null;return r?M=E?E.label:null:s?M=T?T.label:null:f&&(M=R?R.label:null),m.jsx("div",{className:`midi-mapping-label-box ${j?"learning":""} ${M?"mapped":""} ${s?"artnet-mapping":""} ${f?"keyboard-mapping":""}`,style:{position:"fixed",top:S.rect.top,left:S.rect.left,width:S.rect.width,height:S.rect.height,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:m.jsx("div",{className:"mapping-label",children:M||"+"})},S.id)})}),document.body):null};String.prototype.codePointAt||(function(){var r=(function(){try{var a={},s=Object.defineProperty,o=s(a,a,a)&&s}catch{}return o})(),t=function(a){if(this==null)throw TypeError();var s=String(this),o=s.length,u=a?Number(a):0;if(u!=u&&(u=0),!(u<0||u>=o)){var f=s.charCodeAt(u),h;return f>=55296&&f<=56319&&o>u+1&&(h=s.charCodeAt(u+1),h>=56320&&h<=57343)?(f-55296)*1024+h-56320+65536:f}};r?r(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t})();function sm(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var Iy=new sm,By=new sm,lm=new Uint8Array(30),om=new Uint16Array(30),Fy=new Uint8Array(30),jy=new Uint16Array(30);function um(r,t,a,s){var o,u;for(o=0;o<a;++o)r[o]=0;for(o=0;o<30-a;++o)r[o+a]=o/a|0;for(u=s,o=0;o<30;++o)t[o]=u,u+=1<<r[o]}function Gy(r,t){var a;for(a=0;a<7;++a)r.table[a]=0;for(r.table[7]=24,r.table[8]=152,r.table[9]=112,a=0;a<24;++a)r.trans[a]=256+a;for(a=0;a<144;++a)r.trans[24+a]=a;for(a=0;a<8;++a)r.trans[168+a]=280+a;for(a=0;a<112;++a)r.trans[176+a]=144+a;for(a=0;a<5;++a)t.table[a]=0;for(t.table[5]=32,a=0;a<32;++a)t.trans[a]=a}Gy(Iy,By);um(lm,om,4,3);um(Fy,jy,2,1);lm[28]=0;om[28]=258;function as(r,t,a,s,o){return Math.pow(1-o,3)*r+3*Math.pow(1-o,2)*o*t+3*(1-o)*Math.pow(o,2)*a+Math.pow(o,3)*s}function Hr(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}Hr.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};Hr.prototype.addPoint=function(r,t){typeof r=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=r,this.x2=r),r<this.x1&&(this.x1=r),r>this.x2&&(this.x2=r)),typeof t=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))};Hr.prototype.addX=function(r){this.addPoint(r,null)};Hr.prototype.addY=function(r){this.addPoint(null,r)};Hr.prototype.addBezier=function(r,t,a,s,o,u,f,h){var d=[r,t],g=[a,s],v=[o,u],x=[f,h];this.addPoint(r,t),this.addPoint(f,h);for(var y=0;y<=1;y++){var S=6*d[y]-12*g[y]+6*v[y],E=-3*d[y]+9*g[y]-9*v[y]+3*x[y],T=3*g[y]-3*d[y];if(E===0){if(S===0)continue;var R=-T/S;0<R&&R<1&&(y===0&&this.addX(as(d[y],g[y],v[y],x[y],R)),y===1&&this.addY(as(d[y],g[y],v[y],x[y],R)));continue}var j=Math.pow(S,2)-4*T*E;if(!(j<0)){var M=(-S+Math.sqrt(j))/(2*E);0<M&&M<1&&(y===0&&this.addX(as(d[y],g[y],v[y],x[y],M)),y===1&&this.addY(as(d[y],g[y],v[y],x[y],M)));var D=(-S-Math.sqrt(j))/(2*E);0<D&&D<1&&(y===0&&this.addX(as(d[y],g[y],v[y],x[y],D)),y===1&&this.addY(as(d[y],g[y],v[y],x[y],D)))}}};Hr.prototype.addQuad=function(r,t,a,s,o,u){var f=r+.6666666666666666*(a-r),h=t+2/3*(s-t),d=f+1/3*(o-r),g=h+1/3*(u-t);this.addBezier(r,t,f,h,d,g,o,u)};function Ht(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}Ht.prototype.moveTo=function(r,t){this.commands.push({type:"M",x:r,y:t})};Ht.prototype.lineTo=function(r,t){this.commands.push({type:"L",x:r,y:t})};Ht.prototype.curveTo=Ht.prototype.bezierCurveTo=function(r,t,a,s,o,u){this.commands.push({type:"C",x1:r,y1:t,x2:a,y2:s,x:o,y:u})};Ht.prototype.quadTo=Ht.prototype.quadraticCurveTo=function(r,t,a,s){this.commands.push({type:"Q",x1:r,y1:t,x:a,y:s})};Ht.prototype.close=Ht.prototype.closePath=function(){this.commands.push({type:"Z"})};Ht.prototype.extend=function(r){if(r.commands)r=r.commands;else if(r instanceof Hr){var t=r;this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),this.close();return}Array.prototype.push.apply(this.commands,r)};Ht.prototype.getBoundingBox=function(){for(var r=new Hr,t=0,a=0,s=0,o=0,u=0;u<this.commands.length;u++){var f=this.commands[u];switch(f.type){case"M":r.addPoint(f.x,f.y),t=s=f.x,a=o=f.y;break;case"L":r.addPoint(f.x,f.y),s=f.x,o=f.y;break;case"Q":r.addQuad(s,o,f.x1,f.y1,f.x,f.y),s=f.x,o=f.y;break;case"C":r.addBezier(s,o,f.x1,f.y1,f.x2,f.y2,f.x,f.y),s=f.x,o=f.y;break;case"Z":s=t,o=a;break;default:throw new Error("Unexpected path command "+f.type)}}return r.isEmpty()&&r.addPoint(0,0),r};Ht.prototype.draw=function(r){r.beginPath();for(var t=0;t<this.commands.length;t+=1){var a=this.commands[t];a.type==="M"?r.moveTo(a.x,a.y):a.type==="L"?r.lineTo(a.x,a.y):a.type==="C"?r.bezierCurveTo(a.x1,a.y1,a.x2,a.y2,a.x,a.y):a.type==="Q"?r.quadraticCurveTo(a.x1,a.y1,a.x,a.y):a.type==="Z"&&r.closePath()}this.fill&&(r.fillStyle=this.fill,r.fill()),this.stroke&&(r.strokeStyle=this.stroke,r.lineWidth=this.strokeWidth,r.stroke())};Ht.prototype.toPathData=function(r){r=r!==void 0?r:2;function t(f){return Math.round(f)===f?""+Math.round(f):f.toFixed(r)}function a(){for(var f=arguments,h="",d=0;d<arguments.length;d+=1){var g=f[d];g>=0&&d>0&&(h+=" "),h+=t(g)}return h}for(var s="",o=0;o<this.commands.length;o+=1){var u=this.commands[o];u.type==="M"?s+="M"+a(u.x,u.y):u.type==="L"?s+="L"+a(u.x,u.y):u.type==="C"?s+="C"+a(u.x1,u.y1,u.x2,u.y2,u.x,u.y):u.type==="Q"?s+="Q"+a(u.x1,u.y1,u.x,u.y):u.type==="Z"&&(s+="Z")}return s};Ht.prototype.toSVG=function(r){var t='<path d="';return t+=this.toPathData(r),t+='"',this.fill&&this.fill!=="black"&&(this.fill===null?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>",t};Ht.prototype.toDOMElement=function(r){var t=this.toPathData(r),a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",t),a};function cm(r){throw new Error(r)}function l0(r,t){r||cm(t)}var Ge={fail:cm,argument:l0,assert:l0},o0=32768,u0=2147483648,ls={},Ee={},Fe={};function ya(r){return function(){return r}}Ee.BYTE=function(r){return Ge.argument(r>=0&&r<=255,"Byte value should be between 0 and 255."),[r]};Fe.BYTE=ya(1);Ee.CHAR=function(r){return[r.charCodeAt(0)]};Fe.CHAR=ya(1);Ee.CHARARRAY=function(r){typeof r>"u"&&(r="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],a=0;a<r.length;a+=1)t[a]=r.charCodeAt(a);return t};Fe.CHARARRAY=function(r){return typeof r>"u"?0:r.length};Ee.USHORT=function(r){return[r>>8&255,r&255]};Fe.USHORT=ya(2);Ee.SHORT=function(r){return r>=o0&&(r=-(2*o0-r)),[r>>8&255,r&255]};Fe.SHORT=ya(2);Ee.UINT24=function(r){return[r>>16&255,r>>8&255,r&255]};Fe.UINT24=ya(3);Ee.ULONG=function(r){return[r>>24&255,r>>16&255,r>>8&255,r&255]};Fe.ULONG=ya(4);Ee.LONG=function(r){return r>=u0&&(r=-(2*u0-r)),[r>>24&255,r>>16&255,r>>8&255,r&255]};Fe.LONG=ya(4);Ee.FIXED=Ee.ULONG;Fe.FIXED=Fe.ULONG;Ee.FWORD=Ee.SHORT;Fe.FWORD=Fe.SHORT;Ee.UFWORD=Ee.USHORT;Fe.UFWORD=Fe.USHORT;Ee.LONGDATETIME=function(r){return[0,0,0,0,r>>24&255,r>>16&255,r>>8&255,r&255]};Fe.LONGDATETIME=ya(8);Ee.TAG=function(r){return Ge.argument(r.length===4,"Tag should be exactly 4 ASCII characters."),[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3)]};Fe.TAG=ya(4);Ee.Card8=Ee.BYTE;Fe.Card8=Fe.BYTE;Ee.Card16=Ee.USHORT;Fe.Card16=Fe.USHORT;Ee.OffSize=Ee.BYTE;Fe.OffSize=Fe.BYTE;Ee.SID=Ee.USHORT;Fe.SID=Fe.USHORT;Ee.NUMBER=function(r){return r>=-107&&r<=107?[r+139]:r>=108&&r<=1131?(r=r-108,[(r>>8)+247,r&255]):r>=-1131&&r<=-108?(r=-r-108,[(r>>8)+251,r&255]):r>=-32768&&r<=32767?Ee.NUMBER16(r):Ee.NUMBER32(r)};Fe.NUMBER=function(r){return Ee.NUMBER(r).length};Ee.NUMBER16=function(r){return[28,r>>8&255,r&255]};Fe.NUMBER16=ya(3);Ee.NUMBER32=function(r){return[29,r>>24&255,r>>16&255,r>>8&255,r&255]};Fe.NUMBER32=ya(5);Ee.REAL=function(r){var t=r.toString(),a=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(a){var s=parseFloat("1e"+((a[2]?+a[2]:0)+a[1].length));t=(Math.round(r*s)/s).toString()}for(var o="",u=0,f=t.length;u<f;u+=1){var h=t[u];h==="e"?o+=t[++u]==="-"?"c":"b":h==="."?o+="a":h==="-"?o+="e":o+=h}o+=o.length&1?"f":"ff";for(var d=[30],g=0,v=o.length;g<v;g+=2)d.push(parseInt(o.substr(g,2),16));return d};Fe.REAL=function(r){return Ee.REAL(r).length};Ee.NAME=Ee.CHARARRAY;Fe.NAME=Fe.CHARARRAY;Ee.STRING=Ee.CHARARRAY;Fe.STRING=Fe.CHARARRAY;ls.UTF8=function(r,t,a){for(var s=[],o=a,u=0;u<o;u++,t+=1)s[u]=r.getUint8(t);return String.fromCharCode.apply(null,s)};ls.UTF16=function(r,t,a){for(var s=[],o=a/2,u=0;u<o;u++,t+=2)s[u]=r.getUint16(t);return String.fromCharCode.apply(null,s)};Ee.UTF16=function(r){for(var t=[],a=0;a<r.length;a+=1){var s=r.charCodeAt(a);t[t.length]=s>>8&255,t[t.length]=s&255}return t};Fe.UTF16=function(r){return r.length*2};var df={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};ls.MACSTRING=function(r,t,a,s){var o=df[s];if(o!==void 0){for(var u="",f=0;f<a;f++){var h=r.getUint8(t+f);h<=127?u+=String.fromCharCode(h):u+=o[h&127]}return u}};var Lo=typeof WeakMap=="function"&&new WeakMap,Uo,Py=function(r){if(!Uo){Uo={};for(var t in df)Uo[t]=new String(t)}var a=Uo[r];if(a!==void 0){if(Lo){var s=Lo.get(a);if(s!==void 0)return s}var o=df[r];if(o!==void 0){for(var u={},f=0;f<o.length;f++)u[o.charCodeAt(f)]=f+128;return Lo&&Lo.set(a,u),u}}};Ee.MACSTRING=function(r,t){var a=Py(t);if(a!==void 0){for(var s=[],o=0;o<r.length;o++){var u=r.charCodeAt(o);if(u>=128&&(u=a[u],u===void 0))return;s[o]=u}return s}};Fe.MACSTRING=function(r,t){var a=Ee.MACSTRING(r,t);return a!==void 0?a.length:0};function pf(r){return r>=-128&&r<=127}function zy(r,t,a){for(var s=0,o=r.length;t<o&&s<64&&r[t]===0;)++t,++s;return a.push(128|s-1),t}function Hy(r,t,a){for(var s=0,o=r.length,u=t;u<o&&s<64;){var f=r[u];if(!pf(f)||f===0&&u+1<o&&r[u+1]===0)break;++u,++s}a.push(s-1);for(var h=t;h<u;++h)a.push(r[h]+256&255);return u}function Yy(r,t,a){for(var s=0,o=r.length,u=t;u<o&&s<64;){var f=r[u];if(f===0||pf(f)&&u+1<o&&pf(r[u+1]))break;++u,++s}a.push(64|s-1);for(var h=t;h<u;++h){var d=r[h];a.push(d+65536>>8&255,d+256&255)}return u}Ee.VARDELTAS=function(r){for(var t=0,a=[];t<r.length;){var s=r[t];s===0?t=zy(r,t,a):s>=-128&&s<=127?t=Hy(r,t,a):t=Yy(r,t,a)}return a};Ee.INDEX=function(r){for(var t=1,a=[t],s=[],o=0;o<r.length;o+=1){var u=Ee.OBJECT(r[o]);Array.prototype.push.apply(s,u),t+=u.length,a.push(t)}if(s.length===0)return[0,0];for(var f=[],h=1+Math.floor(Math.log(t)/Math.log(2))/8|0,d=[void 0,Ee.BYTE,Ee.USHORT,Ee.UINT24,Ee.ULONG][h],g=0;g<a.length;g+=1){var v=d(a[g]);Array.prototype.push.apply(f,v)}return Array.prototype.concat(Ee.Card16(r.length),Ee.OffSize(h),f,s)};Fe.INDEX=function(r){return Ee.INDEX(r).length};Ee.DICT=function(r){for(var t=[],a=Object.keys(r),s=a.length,o=0;o<s;o+=1){var u=parseInt(a[o],0),f=r[u];t=t.concat(Ee.OPERAND(f.value,f.type)),t=t.concat(Ee.OPERATOR(u))}return t};Fe.DICT=function(r){return Ee.DICT(r).length};Ee.OPERATOR=function(r){return r<1200?[r]:[12,r-1200]};Ee.OPERAND=function(r,t){var a=[];if(Array.isArray(t))for(var s=0;s<t.length;s+=1)Ge.argument(r.length===t.length,"Not enough arguments given for type"+t),a=a.concat(Ee.OPERAND(r[s],t[s]));else if(t==="SID")a=a.concat(Ee.NUMBER(r));else if(t==="offset")a=a.concat(Ee.NUMBER32(r));else if(t==="number")a=a.concat(Ee.NUMBER(r));else if(t==="real")a=a.concat(Ee.REAL(r));else throw new Error("Unknown operand type "+t);return a};Ee.OP=Ee.BYTE;Fe.OP=Fe.BYTE;var Io=typeof WeakMap=="function"&&new WeakMap;Ee.CHARSTRING=function(r){if(Io){var t=Io.get(r);if(t!==void 0)return t}for(var a=[],s=r.length,o=0;o<s;o+=1){var u=r[o];a=a.concat(Ee[u.type](u.value))}return Io&&Io.set(r,a),a};Fe.CHARSTRING=function(r){return Ee.CHARSTRING(r).length};Ee.OBJECT=function(r){var t=Ee[r.type];return Ge.argument(t!==void 0,"No encoding function for type "+r.type),t(r.value)};Fe.OBJECT=function(r){var t=Fe[r.type];return Ge.argument(t!==void 0,"No sizeOf function for type "+r.type),t(r.value)};Ee.TABLE=function(r){for(var t=[],a=r.fields.length,s=[],o=[],u=0;u<a;u+=1){var f=r.fields[u],h=Ee[f.type];Ge.argument(h!==void 0,"No encoding function for field type "+f.type+" ("+f.name+")");var d=r[f.name];d===void 0&&(d=f.value);var g=h(d);f.type==="TABLE"?(o.push(t.length),t=t.concat([0,0]),s.push(g)):t=t.concat(g)}for(var v=0;v<s.length;v+=1){var x=o[v],y=t.length;Ge.argument(y<65536,"Table "+r.tableName+" too big."),t[x]=y>>8,t[x+1]=y&255,t=t.concat(s[v])}return t};Fe.TABLE=function(r){for(var t=0,a=r.fields.length,s=0;s<a;s+=1){var o=r.fields[s],u=Fe[o.type];Ge.argument(u!==void 0,"No sizeOf function for field type "+o.type+" ("+o.name+")");var f=r[o.name];f===void 0&&(f=o.value),t+=u(f),o.type==="TABLE"&&(t+=2)}return t};Ee.RECORD=Ee.TABLE;Fe.RECORD=Fe.TABLE;Ee.LITERAL=function(r){return r};Fe.LITERAL=function(r){return r.length};function Zt(r,t,a){if(t.length&&(t[0].name!=="coverageFormat"||t[0].value===1))for(var s=0;s<t.length;s+=1){var o=t[s];this[o.name]=o.value}if(this.tableName=r,this.fields=t,a)for(var u=Object.keys(a),f=0;f<u.length;f+=1){var h=u[f],d=a[h];this[h]!==void 0&&(this[h]=d)}}Zt.prototype.encode=function(){return Ee.TABLE(this)};Zt.prototype.sizeOf=function(){return Fe.TABLE(this)};function hl(r,t,a){a===void 0&&(a=t.length);var s=new Array(t.length+1);s[0]={name:r+"Count",type:"USHORT",value:a};for(var o=0;o<t.length;o++)s[o+1]={name:r+o,type:"USHORT",value:t[o]};return s}function hf(r,t,a){var s=t.length,o=new Array(s+1);o[0]={name:r+"Count",type:"USHORT",value:s};for(var u=0;u<s;u++)o[u+1]={name:r+u,type:"TABLE",value:a(t[u],u)};return o}function ml(r,t,a){var s=t.length,o=[];o[0]={name:r+"Count",type:"USHORT",value:s};for(var u=0;u<s;u++)o=o.concat(a(t[u],u));return o}function Ho(r){r.format===1?Zt.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(hl("glyph",r.glyphs))):r.format===2?Zt.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(ml("rangeRecord",r.ranges,function(t){return[{name:"startGlyphID",type:"USHORT",value:t.start},{name:"endGlyphID",type:"USHORT",value:t.end},{name:"startCoverageIndex",type:"USHORT",value:t.index}]}))):Ge.assert(!1,"Coverage format must be 1 or 2.")}Ho.prototype=Object.create(Zt.prototype);Ho.prototype.constructor=Ho;function Yo(r){Zt.call(this,"scriptListTable",ml("scriptRecord",r,function(t,a){var s=t.script,o=s.defaultLangSys;return Ge.assert(!!o,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+a,type:"TAG",value:t.tag},{name:"script"+a,type:"TABLE",value:new Zt("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Zt("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:o.reqFeatureIndex}].concat(hl("featureIndex",o.featureIndexes)))}].concat(ml("langSys",s.langSysRecords,function(u,f){var h=u.langSys;return[{name:"langSysTag"+f,type:"TAG",value:u.tag},{name:"langSys"+f,type:"TABLE",value:new Zt("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:h.reqFeatureIndex}].concat(hl("featureIndex",h.featureIndexes)))}]})))}]}))}Yo.prototype=Object.create(Zt.prototype);Yo.prototype.constructor=Yo;function Vo(r){Zt.call(this,"featureListTable",ml("featureRecord",r,function(t,a){var s=t.feature;return[{name:"featureTag"+a,type:"TAG",value:t.tag},{name:"feature"+a,type:"TABLE",value:new Zt("featureTable",[{name:"featureParams",type:"USHORT",value:s.featureParams}].concat(hl("lookupListIndex",s.lookupListIndexes)))}]}))}Vo.prototype=Object.create(Zt.prototype);Vo.prototype.constructor=Vo;function qo(r,t){Zt.call(this,"lookupListTable",hf("lookup",r,function(a){var s=t[a.lookupType];return Ge.assert(!!s,"Unable to write GSUB lookup type "+a.lookupType+" tables."),new Zt("lookupTable",[{name:"lookupType",type:"USHORT",value:a.lookupType},{name:"lookupFlag",type:"USHORT",value:a.lookupFlag}].concat(hf("subtable",a.subtables,s)))}))}qo.prototype=Object.create(Zt.prototype);qo.prototype.constructor=qo;var Me={Table:Zt,Record:Zt,Coverage:Ho,ScriptList:Yo,FeatureList:Vo,LookupList:qo,ushortList:hl,tableList:hf,recordList:ml};function c0(r,t){return r.getUint8(t)}function Xo(r,t){return r.getUint16(t,!1)}function Vy(r,t){return r.getInt16(t,!1)}function Tf(r,t){return r.getUint32(t,!1)}function fm(r,t){var a=r.getInt16(t,!1),s=r.getUint16(t+2,!1);return a+s/65535}function qy(r,t){for(var a="",s=t;s<t+4;s+=1)a+=String.fromCharCode(r.getInt8(s));return a}function Xy(r,t,a){for(var s=0,o=0;o<a;o+=1)s<<=8,s+=r.getUint8(t+o);return s}function Zy(r,t,a){for(var s=[],o=t;o<a;o+=1)s.push(r.getUint8(o));return s}function Qy(r){for(var t="",a=0;a<r.length;a+=1)t+=String.fromCharCode(r[a]);return t}var Ky={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function te(r,t){this.data=r,this.offset=t,this.relativeOffset=0}te.prototype.parseByte=function(){var r=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,r};te.prototype.parseChar=function(){var r=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,r};te.prototype.parseCard8=te.prototype.parseByte;te.prototype.parseUShort=function(){var r=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,r};te.prototype.parseCard16=te.prototype.parseUShort;te.prototype.parseSID=te.prototype.parseUShort;te.prototype.parseOffset16=te.prototype.parseUShort;te.prototype.parseShort=function(){var r=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,r};te.prototype.parseF2Dot14=function(){var r=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,r};te.prototype.parseULong=function(){var r=Tf(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,r};te.prototype.parseOffset32=te.prototype.parseULong;te.prototype.parseFixed=function(){var r=fm(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,r};te.prototype.parseString=function(r){var t=this.data,a=this.offset+this.relativeOffset,s="";this.relativeOffset+=r;for(var o=0;o<r;o++)s+=String.fromCharCode(t.getUint8(a+o));return s};te.prototype.parseTag=function(){return this.parseString(4)};te.prototype.parseLongDateTime=function(){var r=Tf(this.data,this.offset+this.relativeOffset+4);return r-=2082844800,this.relativeOffset+=8,r};te.prototype.parseVersion=function(r){var t=Xo(this.data,this.offset+this.relativeOffset),a=Xo(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,r===void 0&&(r=4096),t+a/r/10};te.prototype.skip=function(r,t){t===void 0&&(t=1),this.relativeOffset+=Ky[r]*t};te.prototype.parseULongList=function(r){r===void 0&&(r=this.parseULong());for(var t=new Array(r),a=this.data,s=this.offset+this.relativeOffset,o=0;o<r;o++)t[o]=a.getUint32(s),s+=4;return this.relativeOffset+=r*4,t};te.prototype.parseOffset16List=te.prototype.parseUShortList=function(r){r===void 0&&(r=this.parseUShort());for(var t=new Array(r),a=this.data,s=this.offset+this.relativeOffset,o=0;o<r;o++)t[o]=a.getUint16(s),s+=2;return this.relativeOffset+=r*2,t};te.prototype.parseShortList=function(r){for(var t=new Array(r),a=this.data,s=this.offset+this.relativeOffset,o=0;o<r;o++)t[o]=a.getInt16(s),s+=2;return this.relativeOffset+=r*2,t};te.prototype.parseByteList=function(r){for(var t=new Array(r),a=this.data,s=this.offset+this.relativeOffset,o=0;o<r;o++)t[o]=a.getUint8(s++);return this.relativeOffset+=r,t};te.prototype.parseList=function(r,t){t||(t=r,r=this.parseUShort());for(var a=new Array(r),s=0;s<r;s++)a[s]=t.call(this);return a};te.prototype.parseList32=function(r,t){t||(t=r,r=this.parseULong());for(var a=new Array(r),s=0;s<r;s++)a[s]=t.call(this);return a};te.prototype.parseRecordList=function(r,t){t||(t=r,r=this.parseUShort());for(var a=new Array(r),s=Object.keys(t),o=0;o<r;o++){for(var u={},f=0;f<s.length;f++){var h=s[f],d=t[h];u[h]=d.call(this)}a[o]=u}return a};te.prototype.parseRecordList32=function(r,t){t||(t=r,r=this.parseULong());for(var a=new Array(r),s=Object.keys(t),o=0;o<r;o++){for(var u={},f=0;f<s.length;f++){var h=s[f],d=t[h];u[h]=d.call(this)}a[o]=u}return a};te.prototype.parseStruct=function(r){if(typeof r=="function")return r.call(this);for(var t=Object.keys(r),a={},s=0;s<t.length;s++){var o=t[s],u=r[o];a[o]=u.call(this)}return a};te.prototype.parseValueRecord=function(r){if(r===void 0&&(r=this.parseUShort()),r!==0){var t={};return r&1&&(t.xPlacement=this.parseShort()),r&2&&(t.yPlacement=this.parseShort()),r&4&&(t.xAdvance=this.parseShort()),r&8&&(t.yAdvance=this.parseShort()),r&16&&(t.xPlaDevice=void 0,this.parseShort()),r&32&&(t.yPlaDevice=void 0,this.parseShort()),r&64&&(t.xAdvDevice=void 0,this.parseShort()),r&128&&(t.yAdvDevice=void 0,this.parseShort()),t}};te.prototype.parseValueRecordList=function(){for(var r=this.parseUShort(),t=this.parseUShort(),a=new Array(t),s=0;s<t;s++)a[s]=this.parseValueRecord(r);return a};te.prototype.parsePointer=function(r){var t=this.parseOffset16();if(t>0)return new te(this.data,this.offset+t).parseStruct(r)};te.prototype.parsePointer32=function(r){var t=this.parseOffset32();if(t>0)return new te(this.data,this.offset+t).parseStruct(r)};te.prototype.parseListOfLists=function(r){for(var t=this.parseOffset16List(),a=t.length,s=this.relativeOffset,o=new Array(a),u=0;u<a;u++){var f=t[u];if(f===0){o[u]=void 0;continue}if(this.relativeOffset=f,r){for(var h=this.parseOffset16List(),d=new Array(h.length),g=0;g<h.length;g++)this.relativeOffset=f+h[g],d[g]=r.call(this);o[u]=d}else o[u]=this.parseUShortList()}return this.relativeOffset=s,o};te.prototype.parseCoverage=function(){var r=this.offset+this.relativeOffset,t=this.parseUShort(),a=this.parseUShort();if(t===1)return{format:1,glyphs:this.parseUShortList(a)};if(t===2){for(var s=new Array(a),o=0;o<a;o++)s[o]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:s}}throw new Error("0x"+r.toString(16)+": Coverage format must be 1 or 2.")};te.prototype.parseClassDef=function(){var r=this.offset+this.relativeOffset,t=this.parseUShort();if(t===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(t===2)return{format:2,ranges:this.parseRecordList({start:te.uShort,end:te.uShort,classId:te.uShort})};throw new Error("0x"+r.toString(16)+": ClassDef format must be 1 or 2.")};te.list=function(r,t){return function(){return this.parseList(r,t)}};te.list32=function(r,t){return function(){return this.parseList32(r,t)}};te.recordList=function(r,t){return function(){return this.parseRecordList(r,t)}};te.recordList32=function(r,t){return function(){return this.parseRecordList32(r,t)}};te.pointer=function(r){return function(){return this.parsePointer(r)}};te.pointer32=function(r){return function(){return this.parsePointer32(r)}};te.tag=te.prototype.parseTag;te.byte=te.prototype.parseByte;te.uShort=te.offset16=te.prototype.parseUShort;te.uShortList=te.prototype.parseUShortList;te.uLong=te.offset32=te.prototype.parseULong;te.uLongList=te.prototype.parseULongList;te.struct=te.prototype.parseStruct;te.coverage=te.prototype.parseCoverage;te.classDef=te.prototype.parseClassDef;var f0={reserved:te.uShort,reqFeatureIndex:te.uShort,featureIndexes:te.uShortList};te.prototype.parseScriptList=function(){return this.parsePointer(te.recordList({tag:te.tag,script:te.pointer({defaultLangSys:te.pointer(f0),langSysRecords:te.recordList({tag:te.tag,langSys:te.pointer(f0)})})}))||[]};te.prototype.parseFeatureList=function(){return this.parsePointer(te.recordList({tag:te.tag,feature:te.pointer({featureParams:te.offset16,lookupListIndexes:te.uShortList})}))||[]};te.prototype.parseLookupList=function(r){return this.parsePointer(te.list(te.pointer(function(){var t=this.parseUShort();Ge.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var a=this.parseUShort(),s=a&16;return{lookupType:t,lookupFlag:a,subtables:this.parseList(te.pointer(r[t])),markFilteringSet:s?this.parseUShort():void 0}})))||[]};te.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var r=this.parseUShort(),t=this.parseUShort();Ge.argument(r===1&&t<1,"GPOS/GSUB feature variations table unknown.");var a=this.parseRecordList32({conditionSetOffset:te.offset32,featureTableSubstitutionOffset:te.offset32});return a})||[]};var ze={getByte:c0,getCard8:c0,getUShort:Xo,getCard16:Xo,getShort:Vy,getULong:Tf,getFixed:fm,getTag:qy,getOffset:Xy,getBytes:Zy,bytesToString:Qy,Parser:te};function Wy(r,t){t.parseUShort(),r.length=t.parseULong(),r.language=t.parseULong();var a;r.groupCount=a=t.parseULong(),r.glyphIndexMap={};for(var s=0;s<a;s+=1)for(var o=t.parseULong(),u=t.parseULong(),f=t.parseULong(),h=o;h<=u;h+=1)r.glyphIndexMap[h]=f,f++}function $y(r,t,a,s,o){r.length=t.parseUShort(),r.language=t.parseUShort();var u;r.segCount=u=t.parseUShort()>>1,t.skip("uShort",3),r.glyphIndexMap={};for(var f=new ze.Parser(a,s+o+14),h=new ze.Parser(a,s+o+16+u*2),d=new ze.Parser(a,s+o+16+u*4),g=new ze.Parser(a,s+o+16+u*6),v=s+o+16+u*8,x=0;x<u-1;x+=1)for(var y=void 0,S=f.parseUShort(),E=h.parseUShort(),T=d.parseShort(),R=g.parseUShort(),j=E;j<=S;j+=1)R!==0?(v=g.offset+g.relativeOffset-2,v+=R,v+=(j-E)*2,y=ze.getUShort(a,v),y!==0&&(y=y+T&65535)):y=j+T&65535,r.glyphIndexMap[j]=y}function Jy(r,t){var a={};a.version=ze.getUShort(r,t),Ge.argument(a.version===0,"cmap table version should be 0."),a.numTables=ze.getUShort(r,t+2);for(var s=-1,o=a.numTables-1;o>=0;o-=1){var u=ze.getUShort(r,t+4+o*8),f=ze.getUShort(r,t+4+o*8+2);if(u===3&&(f===0||f===1||f===10)||u===0&&(f===0||f===1||f===2||f===3||f===4)){s=ze.getULong(r,t+4+o*8+4);break}}if(s===-1)throw new Error("No valid cmap sub-tables found.");var h=new ze.Parser(r,t+s);if(a.format=h.parseUShort(),a.format===12)Wy(a,h);else if(a.format===4)$y(a,h,r,t,s);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+a.format+").");return a}function e1(r,t,a){r.segments.push({end:t,start:t,delta:-(t-a),offset:0,glyphIndex:a})}function t1(r){r.segments.push({end:65535,start:65535,delta:1,offset:0})}function n1(r){var t=!0,a;for(a=r.length-1;a>0;a-=1){var s=r.get(a);if(s.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),t=!1;break}}var o=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:t?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:t?12:20}];t||(o=o.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),o=o.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var u=new Me.Table("cmap",o);for(u.segments=[],a=0;a<r.length;a+=1){for(var f=r.get(a),h=0;h<f.unicodes.length;h+=1)e1(u,f.unicodes[h],a);u.segments=u.segments.sort(function(M,D){return M.start-D.start})}t1(u);var d=u.segments.length,g=0,v=[],x=[],y=[],S=[],E=[],T=[];for(a=0;a<d;a+=1){var R=u.segments[a];R.end<=65535&&R.start<=65535?(v=v.concat({name:"end_"+a,type:"USHORT",value:R.end}),x=x.concat({name:"start_"+a,type:"USHORT",value:R.start}),y=y.concat({name:"idDelta_"+a,type:"SHORT",value:R.delta}),S=S.concat({name:"idRangeOffset_"+a,type:"USHORT",value:R.offset}),R.glyphId!==void 0&&(E=E.concat({name:"glyph_"+a,type:"USHORT",value:R.glyphId}))):g+=1,!t&&R.glyphIndex!==void 0&&(T=T.concat({name:"cmap12Start_"+a,type:"ULONG",value:R.start}),T=T.concat({name:"cmap12End_"+a,type:"ULONG",value:R.end}),T=T.concat({name:"cmap12Glyph_"+a,type:"ULONG",value:R.glyphIndex}))}if(u.segCountX2=(d-g)*2,u.searchRange=Math.pow(2,Math.floor(Math.log(d-g)/Math.log(2)))*2,u.entrySelector=Math.log(u.searchRange/2)/Math.log(2),u.rangeShift=u.segCountX2-u.searchRange,u.fields=u.fields.concat(v),u.fields.push({name:"reservedPad",type:"USHORT",value:0}),u.fields=u.fields.concat(x),u.fields=u.fields.concat(y),u.fields=u.fields.concat(S),u.fields=u.fields.concat(E),u.cmap4Length=14+v.length*2+2+x.length*2+y.length*2+S.length*2+E.length*2,!t){var j=16+T.length*4;u.cmap12Offset=20+u.cmap4Length,u.fields=u.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:j},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:T.length/3}]),u.fields=u.fields.concat(T)}return u}var a1={parse:Jy,make:n1},Po=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],r1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],i1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],d0=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function dm(r){this.font=r}dm.prototype.charToGlyphIndex=function(r){var t=r.codePointAt(0),a=this.font.glyphs;if(a){for(var s=0;s<a.length;s+=1)for(var o=a.get(s),u=0;u<o.unicodes.length;u+=1)if(o.unicodes[u]===t)return s}return null};function Zo(r,t){this.encoding=r,this.charset=t}Zo.prototype.charToGlyphIndex=function(r){var t=r.codePointAt(0),a=this.encoding[t];return this.charset.indexOf(a)};function s1(r,t,a,s,o){r.beginPath(),r.moveTo(t,a),r.lineTo(s,o),r.stroke()}var hi={line:s1};function l1(r,t){var a=t||new Ht;return{configurable:!0,get:function(){return typeof a=="function"&&(a=a()),a},set:function(s){a=s}}}function ra(r){this.bindConstructorValues(r)}ra.prototype.bindConstructorValues=function(r){this.index=r.index||0,this.name=r.name||null,this.unicode=r.unicode||void 0,this.unicodes=r.unicodes||r.unicode!==void 0?[r.unicode]:[],"xMin"in r&&(this.xMin=r.xMin),"yMin"in r&&(this.yMin=r.yMin),"xMax"in r&&(this.xMax=r.xMax),"yMax"in r&&(this.yMax=r.yMax),"advanceWidth"in r&&(this.advanceWidth=r.advanceWidth),Object.defineProperty(this,"path",l1(this,r.path))};ra.prototype.addUnicode=function(r){this.unicodes.length===0&&(this.unicode=r),this.unicodes.push(r)};ra.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};ra.prototype.getPath=function(r,t,a,s,o){r=r!==void 0?r:0,t=t!==void 0?t:0,a=a!==void 0?a:72;var u,f;s||(s={});var h=s.xScale,d=s.yScale;if(s.hinting&&o&&o.hinting&&(f=this.path&&o.hinting.exec(this,a)),f)u=o.hinting.getCommands(f),r=Math.round(r),t=Math.round(t),h=d=1;else{u=this.path.commands;var g=1/(this.path.unitsPerEm||1e3)*a;h===void 0&&(h=g),d===void 0&&(d=g)}for(var v=new Ht,x=0;x<u.length;x+=1){var y=u[x];y.type==="M"?v.moveTo(r+y.x*h,t+-y.y*d):y.type==="L"?v.lineTo(r+y.x*h,t+-y.y*d):y.type==="Q"?v.quadraticCurveTo(r+y.x1*h,t+-y.y1*d,r+y.x*h,t+-y.y*d):y.type==="C"?v.curveTo(r+y.x1*h,t+-y.y1*d,r+y.x2*h,t+-y.y2*d,r+y.x*h,t+-y.y*d):y.type==="Z"&&v.closePath()}return v};ra.prototype.getContours=function(){if(this.points===void 0)return[];for(var r=[],t=[],a=0;a<this.points.length;a+=1){var s=this.points[a];t.push(s),s.lastPointOfContour&&(r.push(t),t=[])}return Ge.argument(t.length===0,"There are still points left in the current contour."),r};ra.prototype.getMetrics=function(){for(var r=this.path.commands,t=[],a=[],s=0;s<r.length;s+=1){var o=r[s];o.type!=="Z"&&(t.push(o.x),a.push(o.y)),(o.type==="Q"||o.type==="C")&&(t.push(o.x1),a.push(o.y1)),o.type==="C"&&(t.push(o.x2),a.push(o.y2))}var u={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,a),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,a),leftSideBearing:this.leftSideBearing};return isFinite(u.xMin)||(u.xMin=0),isFinite(u.xMax)||(u.xMax=this.advanceWidth),isFinite(u.yMin)||(u.yMin=0),isFinite(u.yMax)||(u.yMax=0),u.rightSideBearing=this.advanceWidth-u.leftSideBearing-(u.xMax-u.xMin),u};ra.prototype.draw=function(r,t,a,s,o){this.getPath(t,a,s,o).draw(r)};ra.prototype.drawPoints=function(r,t,a,s){function o(x,y,S,E){r.beginPath();for(var T=0;T<x.length;T+=1)r.moveTo(y+x[T].x*E,S+x[T].y*E),r.arc(y+x[T].x*E,S+x[T].y*E,2,0,Math.PI*2,!1);r.closePath(),r.fill()}t=t!==void 0?t:0,a=a!==void 0?a:0,s=s!==void 0?s:24;for(var u=1/this.path.unitsPerEm*s,f=[],h=[],d=this.path,g=0;g<d.commands.length;g+=1){var v=d.commands[g];v.x!==void 0&&f.push({x:v.x,y:-v.y}),v.x1!==void 0&&h.push({x:v.x1,y:-v.y1}),v.x2!==void 0&&h.push({x:v.x2,y:-v.y2})}r.fillStyle="blue",o(f,t,a,u),r.fillStyle="red",o(h,t,a,u)};ra.prototype.drawMetrics=function(r,t,a,s){var o;t=t!==void 0?t:0,a=a!==void 0?a:0,s=s!==void 0?s:24,o=1/this.path.unitsPerEm*s,r.lineWidth=1,r.strokeStyle="black",hi.line(r,t,-1e4,t,1e4),hi.line(r,-1e4,a,1e4,a);var u=this.xMin||0,f=this.yMin||0,h=this.xMax||0,d=this.yMax||0,g=this.advanceWidth||0;r.strokeStyle="blue",hi.line(r,t+u*o,-1e4,t+u*o,1e4),hi.line(r,t+h*o,-1e4,t+h*o,1e4),hi.line(r,-1e4,a+-f*o,1e4,a+-f*o),hi.line(r,-1e4,a+-d*o,1e4,a+-d*o),r.strokeStyle="green",hi.line(r,t+g*o,-1e4,t+g*o,1e4)};function Bo(r,t,a){Object.defineProperty(r,t,{get:function(){return r.path,r[a]},set:function(s){r[a]=s},enumerable:!0,configurable:!0})}function wf(r,t){if(this.font=r,this.glyphs={},Array.isArray(t))for(var a=0;a<t.length;a++){var s=t[a];s.path.unitsPerEm=r.unitsPerEm,this.glyphs[a]=s}this.length=t&&t.length||0}wf.prototype.get=function(r){if(this.glyphs[r]===void 0){this.font._push(r),typeof this.glyphs[r]=="function"&&(this.glyphs[r]=this.glyphs[r]());var t=this.glyphs[r],a=this.font._IndexToUnicodeMap[r];if(a)for(var s=0;s<a.unicodes.length;s++)t.addUnicode(a.unicodes[s]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+r:t.name=this.font.cffEncoding.charset[r]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(r)),this.glyphs[r].advanceWidth=this.font._hmtxTableData[r].advanceWidth,this.glyphs[r].leftSideBearing=this.font._hmtxTableData[r].leftSideBearing}else typeof this.glyphs[r]=="function"&&(this.glyphs[r]=this.glyphs[r]());return this.glyphs[r]};wf.prototype.push=function(r,t){this.glyphs[r]=t,this.length++};function o1(r,t){return new ra({index:t,font:r})}function u1(r,t,a,s,o,u){return function(){var f=new ra({index:t,font:r});return f.path=function(){a(f,s,o);var h=u(r.glyphs,f);return h.unitsPerEm=r.unitsPerEm,h},Bo(f,"xMin","_xMin"),Bo(f,"xMax","_xMax"),Bo(f,"yMin","_yMin"),Bo(f,"yMax","_yMax"),f}}function c1(r,t,a,s){return function(){var o=new ra({index:t,font:r});return o.path=function(){var u=a(r,o,s);return u.unitsPerEm=r.unitsPerEm,u},o}}var Da={GlyphSet:wf,glyphLoader:o1,ttfGlyphLoader:u1,cffGlyphLoader:c1};function pm(r,t){if(r===t)return!0;if(Array.isArray(r)&&Array.isArray(t)){if(r.length!==t.length)return!1;for(var a=0;a<r.length;a+=1)if(!pm(r[a],t[a]))return!1;return!0}else return!1}function mf(r){var t;return r.length<1240?t=107:r.length<33900?t=1131:t=32768,t}function Fr(r,t,a){var s=[],o=[],u=ze.getCard16(r,t),f,h;if(u!==0){var d=ze.getByte(r,t+2);f=t+(u+1)*d+2;for(var g=t+3,v=0;v<u+1;v+=1)s.push(ze.getOffset(r,g,d)),g+=d;h=f+s[u]}else h=t+2;for(var x=0;x<s.length-1;x+=1){var y=ze.getBytes(r,f+s[x],f+s[x+1]);a&&(y=a(y)),o.push(y)}return{objects:o,startOffset:t,endOffset:h}}function f1(r,t){var a=[],s=ze.getCard16(r,t),o,u;if(s!==0){var f=ze.getByte(r,t+2);o=t+(s+1)*f+2;for(var h=t+3,d=0;d<s+1;d+=1)a.push(ze.getOffset(r,h,f)),h+=f;u=o+a[s]}else u=t+2;return{offsets:a,startOffset:t,endOffset:u}}function d1(r,t,a,s,o){var u=ze.getCard16(a,s),f=0;if(u!==0){var h=ze.getByte(a,s+2);f=s+(u+1)*h+2}var d=ze.getBytes(a,f+t[r],f+t[r+1]);return d}function p1(r){for(var t="",a=15,s=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var o=r.parseByte(),u=o>>4,f=o&15;if(u===a||(t+=s[u],f===a))break;t+=s[f]}return parseFloat(t)}function h1(r,t){var a,s,o,u;if(t===28)return a=r.parseByte(),s=r.parseByte(),a<<8|s;if(t===29)return a=r.parseByte(),s=r.parseByte(),o=r.parseByte(),u=r.parseByte(),a<<24|s<<16|o<<8|u;if(t===30)return p1(r);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return a=r.parseByte(),(t-247)*256+a+108;if(t>=251&&t<=254)return a=r.parseByte(),-(t-251)*256-a-108;throw new Error("Invalid b0 "+t)}function m1(r){for(var t={},a=0;a<r.length;a+=1){var s=r[a][0],o=r[a][1],u=void 0;if(o.length===1?u=o[0]:u=o,t.hasOwnProperty(s)&&!isNaN(t[s]))throw new Error("Object "+t+" already has key "+s);t[s]=u}return t}function hm(r,t,a){t=t!==void 0?t:0;var s=new ze.Parser(r,t),o=[],u=[];for(a=a!==void 0?a:r.length;s.relativeOffset<a;){var f=s.parseByte();f<=21?(f===12&&(f=1200+s.parseByte()),o.push([f,u]),u=[]):u.push(h1(s,f))}return m1(o)}function fl(r,t){return t<=390?t=Po[t]:t=r[t-391],t}function mm(r,t,a){for(var s={},o,u=0;u<t.length;u+=1){var f=t[u];if(Array.isArray(f.type)){var h=[];h.length=f.type.length;for(var d=0;d<f.type.length;d++)o=r[f.op]!==void 0?r[f.op][d]:void 0,o===void 0&&(o=f.value!==void 0&&f.value[d]!==void 0?f.value[d]:null),f.type[d]==="SID"&&(o=fl(a,o)),h[d]=o;s[f.name]=h}else o=r[f.op],o===void 0&&(o=f.value!==void 0?f.value:null),f.type==="SID"&&(o=fl(a,o)),s[f.name]=o}return s}function g1(r,t){var a={};return a.formatMajor=ze.getCard8(r,t),a.formatMinor=ze.getCard8(r,t+1),a.size=ze.getCard8(r,t+2),a.offsetSize=ze.getCard8(r,t+3),a.startOffset=t,a.endOffset=t+4,a}var gm=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],vm=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function v1(r,t){var a=hm(r,0,r.byteLength);return mm(a,gm,t)}function ym(r,t,a,s){var o=hm(r,t,a);return mm(o,vm,s)}function p0(r,t,a,s){for(var o=[],u=0;u<a.length;u+=1){var f=new DataView(new Uint8Array(a[u]).buffer),h=v1(f,s);h._subrs=[],h._subrsBias=0,h._defaultWidthX=0,h._nominalWidthX=0;var d=h.private[0],g=h.private[1];if(d!==0&&g!==0){var v=ym(r,g+t,d,s);if(h._defaultWidthX=v.defaultWidthX,h._nominalWidthX=v.nominalWidthX,v.subrs!==0){var x=g+v.subrs,y=Fr(r,x+t);h._subrs=y.objects,h._subrsBias=mf(h._subrs)}h._privateDict=v}o.push(h)}return o}function y1(r,t,a,s){var o,u,f=new ze.Parser(r,t);a-=1;var h=[".notdef"],d=f.parseCard8();if(d===0)for(var g=0;g<a;g+=1)o=f.parseSID(),h.push(fl(s,o));else if(d===1)for(;h.length<=a;){o=f.parseSID(),u=f.parseCard8();for(var v=0;v<=u;v+=1)h.push(fl(s,o)),o+=1}else if(d===2)for(;h.length<=a;){o=f.parseSID(),u=f.parseCard16();for(var x=0;x<=u;x+=1)h.push(fl(s,o)),o+=1}else throw new Error("Unknown charset format "+d);return h}function b1(r,t,a){var s,o={},u=new ze.Parser(r,t),f=u.parseCard8();if(f===0)for(var h=u.parseCard8(),d=0;d<h;d+=1)s=u.parseCard8(),o[s]=d;else if(f===1){var g=u.parseCard8();s=1;for(var v=0;v<g;v+=1)for(var x=u.parseCard8(),y=u.parseCard8(),S=x;S<=x+y;S+=1)o[S]=s,s+=1}else throw new Error("Unknown encoding format "+f);return new Zo(o,a)}function h0(r,t,a){var s,o,u,f,h=new Ht,d=[],g=0,v=!1,x=!1,y=0,S=0,E,T,R,j;if(r.isCIDFont){var M=r.tables.cff.topDict._fdSelect[t.index],D=r.tables.cff.topDict._fdArray[M];E=D._subrs,T=D._subrsBias,R=D._defaultWidthX,j=D._nominalWidthX}else E=r.tables.cff.topDict._subrs,T=r.tables.cff.topDict._subrsBias,R=r.tables.cff.topDict._defaultWidthX,j=r.tables.cff.topDict._nominalWidthX;var I=R;function P(se,de){x&&h.closePath(),h.moveTo(se,de),x=!0}function H(){var se;se=d.length%2!==0,se&&!v&&(I=d.shift()+j),g+=d.length>>1,d.length=0,v=!0}function ie(se){for(var de,ne,Z,ee,ae,$,re,B,U,le,ve,N,V=0;V<se.length;){var oe=se[V];switch(V+=1,oe){case 1:H();break;case 3:H();break;case 4:d.length>1&&!v&&(I=d.shift()+j,v=!0),S+=d.pop(),P(y,S);break;case 5:for(;d.length>0;)y+=d.shift(),S+=d.shift(),h.lineTo(y,S);break;case 6:for(;d.length>0&&(y+=d.shift(),h.lineTo(y,S),d.length!==0);)S+=d.shift(),h.lineTo(y,S);break;case 7:for(;d.length>0&&(S+=d.shift(),h.lineTo(y,S),d.length!==0);)y+=d.shift(),h.lineTo(y,S);break;case 8:for(;d.length>0;)s=y+d.shift(),o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),y=u+d.shift(),S=f+d.shift(),h.curveTo(s,o,u,f,y,S);break;case 10:ae=d.pop()+T,$=E[ae],$&&ie($);break;case 11:return;case 12:switch(oe=se[V],V+=1,oe){case 35:s=y+d.shift(),o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),re=u+d.shift(),B=f+d.shift(),U=re+d.shift(),le=B+d.shift(),ve=U+d.shift(),N=le+d.shift(),y=ve+d.shift(),S=N+d.shift(),d.shift(),h.curveTo(s,o,u,f,re,B),h.curveTo(U,le,ve,N,y,S);break;case 34:s=y+d.shift(),o=S,u=s+d.shift(),f=o+d.shift(),re=u+d.shift(),B=f,U=re+d.shift(),le=f,ve=U+d.shift(),N=S,y=ve+d.shift(),h.curveTo(s,o,u,f,re,B),h.curveTo(U,le,ve,N,y,S);break;case 36:s=y+d.shift(),o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),re=u+d.shift(),B=f,U=re+d.shift(),le=f,ve=U+d.shift(),N=le+d.shift(),y=ve+d.shift(),h.curveTo(s,o,u,f,re,B),h.curveTo(U,le,ve,N,y,S);break;case 37:s=y+d.shift(),o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),re=u+d.shift(),B=f+d.shift(),U=re+d.shift(),le=B+d.shift(),ve=U+d.shift(),N=le+d.shift(),Math.abs(ve-y)>Math.abs(N-S)?y=ve+d.shift():S=N+d.shift(),h.curveTo(s,o,u,f,re,B),h.curveTo(U,le,ve,N,y,S);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+oe),d.length=0}break;case 14:d.length>0&&!v&&(I=d.shift()+j,v=!0),x&&(h.closePath(),x=!1);break;case 18:H();break;case 19:case 20:H(),V+=g+7>>3;break;case 21:d.length>2&&!v&&(I=d.shift()+j,v=!0),S+=d.pop(),y+=d.pop(),P(y,S);break;case 22:d.length>1&&!v&&(I=d.shift()+j,v=!0),y+=d.pop(),P(y,S);break;case 23:H();break;case 24:for(;d.length>2;)s=y+d.shift(),o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),y=u+d.shift(),S=f+d.shift(),h.curveTo(s,o,u,f,y,S);y+=d.shift(),S+=d.shift(),h.lineTo(y,S);break;case 25:for(;d.length>6;)y+=d.shift(),S+=d.shift(),h.lineTo(y,S);s=y+d.shift(),o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),y=u+d.shift(),S=f+d.shift(),h.curveTo(s,o,u,f,y,S);break;case 26:for(d.length%2&&(y+=d.shift());d.length>0;)s=y,o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),y=u,S=f+d.shift(),h.curveTo(s,o,u,f,y,S);break;case 27:for(d.length%2&&(S+=d.shift());d.length>0;)s=y+d.shift(),o=S,u=s+d.shift(),f=o+d.shift(),y=u+d.shift(),S=f,h.curveTo(s,o,u,f,y,S);break;case 28:de=se[V],ne=se[V+1],d.push((de<<24|ne<<16)>>16),V+=2;break;case 29:ae=d.pop()+r.gsubrsBias,$=r.gsubrs[ae],$&&ie($);break;case 30:for(;d.length>0&&(s=y,o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),y=u+d.shift(),S=f+(d.length===1?d.shift():0),h.curveTo(s,o,u,f,y,S),d.length!==0);)s=y+d.shift(),o=S,u=s+d.shift(),f=o+d.shift(),S=f+d.shift(),y=u+(d.length===1?d.shift():0),h.curveTo(s,o,u,f,y,S);break;case 31:for(;d.length>0&&(s=y+d.shift(),o=S,u=s+d.shift(),f=o+d.shift(),S=f+d.shift(),y=u+(d.length===1?d.shift():0),h.curveTo(s,o,u,f,y,S),d.length!==0);)s=y,o=S+d.shift(),u=s+d.shift(),f=o+d.shift(),y=u+d.shift(),S=f+(d.length===1?d.shift():0),h.curveTo(s,o,u,f,y,S);break;default:oe<32?console.log("Glyph "+t.index+": unknown operator "+oe):oe<247?d.push(oe-139):oe<251?(de=se[V],V+=1,d.push((oe-247)*256+de+108)):oe<255?(de=se[V],V+=1,d.push(-(oe-251)*256-de-108)):(de=se[V],ne=se[V+1],Z=se[V+2],ee=se[V+3],V+=4,d.push((de<<24|ne<<16|Z<<8|ee)/65536))}}}return ie(a),t.advanceWidth=I,h}function x1(r,t,a,s){var o=[],u,f=new ze.Parser(r,t),h=f.parseCard8();if(h===0)for(var d=0;d<a;d++){if(u=f.parseCard8(),u>=s)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+s+")");o.push(u)}else if(h===3){var g=f.parseCard16(),v=f.parseCard16();if(v!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+v);for(var x,y=0;y<g;y++){if(u=f.parseCard8(),x=f.parseCard16(),u>=s)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+s+")");if(x>a)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+x);for(;v<x;v++)o.push(u);v=x}if(x!==a)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+x)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+h);return o}function S1(r,t,a,s){a.tables.cff={};var o=g1(r,t),u=Fr(r,o.endOffset,ze.bytesToString),f=Fr(r,u.endOffset),h=Fr(r,f.endOffset,ze.bytesToString),d=Fr(r,h.endOffset);a.gsubrs=d.objects,a.gsubrsBias=mf(a.gsubrs);var g=p0(r,t,f.objects,h.objects);if(g.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+g.length);var v=g[0];if(a.tables.cff.topDict=v,v._privateDict&&(a.defaultWidthX=v._privateDict.defaultWidthX,a.nominalWidthX=v._privateDict.nominalWidthX),v.ros[0]!==void 0&&v.ros[1]!==void 0&&(a.isCIDFont=!0),a.isCIDFont){var x=v.fdArray,y=v.fdSelect;if(x===0||y===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");x+=t;var S=Fr(r,x),E=p0(r,t,S.objects,h.objects);v._fdArray=E,y+=t,v._fdSelect=x1(r,y,a.numGlyphs,E.length)}var T=t+v.private[1],R=ym(r,T,v.private[0],h.objects);if(a.defaultWidthX=R.defaultWidthX,a.nominalWidthX=R.nominalWidthX,R.subrs!==0){var j=T+R.subrs,M=Fr(r,j);a.subrs=M.objects,a.subrsBias=mf(a.subrs)}else a.subrs=[],a.subrsBias=0;var D;s.lowMemory?(D=f1(r,t+v.charStrings),a.nGlyphs=D.offsets.length):(D=Fr(r,t+v.charStrings),a.nGlyphs=D.objects.length);var I=y1(r,t+v.charset,a.nGlyphs,h.objects);if(v.encoding===0?a.cffEncoding=new Zo(r1,I):v.encoding===1?a.cffEncoding=new Zo(i1,I):a.cffEncoding=b1(r,t+v.encoding,I),a.encoding=a.encoding||a.cffEncoding,a.glyphs=new Da.GlyphSet(a),s.lowMemory)a._push=function(ie){var se=d1(ie,D.offsets,r,t+v.charStrings);a.glyphs.push(ie,Da.cffGlyphLoader(a,ie,h0,se))};else for(var P=0;P<a.nGlyphs;P+=1){var H=D.objects[P];a.glyphs.push(P,Da.cffGlyphLoader(a,P,h0,H))}}function bm(r,t){var a,s=Po.indexOf(r);return s>=0&&(a=s),s=t.indexOf(r),s>=0?a=s+Po.length:(a=Po.length+t.length,t.push(r)),a}function E1(){return new Me.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function A1(r){var t=new Me.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var a=0;a<r.length;a+=1)t.names.push({name:"name_"+a,type:"NAME",value:r[a]});return t}function xm(r,t,a){for(var s={},o=0;o<r.length;o+=1){var u=r[o],f=t[u.name];f!==void 0&&!pm(f,u.value)&&(u.type==="SID"&&(f=bm(f,a)),s[u.op]={name:u.name,type:u.type,value:f})}return s}function m0(r,t){var a=new Me.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return a.dict=xm(gm,r,t),a}function g0(r){var t=new Me.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:r}],t}function T1(r){var t=new Me.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var a=0;a<r.length;a+=1)t.strings.push({name:"string_"+a,type:"STRING",value:r[a]});return t}function w1(){return new Me.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function C1(r,t){for(var a=new Me.Record("Charsets",[{name:"format",type:"Card8",value:0}]),s=0;s<r.length;s+=1){var o=r[s],u=bm(o,t);a.fields.push({name:"glyph_"+s,type:"SID",value:u})}return a}function M1(r){var t=[],a=r.path;t.push({name:"width",type:"NUMBER",value:r.advanceWidth});for(var s=0,o=0,u=0;u<a.commands.length;u+=1){var f=void 0,h=void 0,d=a.commands[u];if(d.type==="Q"){var g=.3333333333333333,v=2/3;d={type:"C",x:d.x,y:d.y,x1:Math.round(g*s+v*d.x1),y1:Math.round(g*o+v*d.y1),x2:Math.round(g*d.x+v*d.x1),y2:Math.round(g*d.y+v*d.y1)}}if(d.type==="M")f=Math.round(d.x-s),h=Math.round(d.y-o),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rmoveto",type:"OP",value:21}),s=Math.round(d.x),o=Math.round(d.y);else if(d.type==="L")f=Math.round(d.x-s),h=Math.round(d.y-o),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rlineto",type:"OP",value:5}),s=Math.round(d.x),o=Math.round(d.y);else if(d.type==="C"){var x=Math.round(d.x1-s),y=Math.round(d.y1-o),S=Math.round(d.x2-d.x1),E=Math.round(d.y2-d.y1);f=Math.round(d.x-d.x2),h=Math.round(d.y-d.y2),t.push({name:"dx1",type:"NUMBER",value:x}),t.push({name:"dy1",type:"NUMBER",value:y}),t.push({name:"dx2",type:"NUMBER",value:S}),t.push({name:"dy2",type:"NUMBER",value:E}),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rrcurveto",type:"OP",value:8}),s=Math.round(d.x),o=Math.round(d.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function N1(r){for(var t=new Me.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),a=0;a<r.length;a+=1){var s=r.get(a),o=M1(s);t.charStrings.push({name:s.name,type:"CHARSTRING",value:o})}return t}function R1(r,t){var a=new Me.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return a.dict=xm(vm,r,t),a}function D1(r,t){for(var a=new Me.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),s=1/t.unitsPerEm,o={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[s,0,0,s,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},u={},f=[],h,d=1;d<r.length;d+=1)h=r.get(d),f.push(h.name);var g=[];a.header=E1(),a.nameIndex=A1([t.postScriptName]);var v=m0(o,g);a.topDictIndex=g0(v),a.globalSubrIndex=w1(),a.charsets=C1(f,g),a.charStringsIndex=N1(r),a.privateDict=R1(u,g),a.stringIndex=T1(g);var x=a.header.sizeOf()+a.nameIndex.sizeOf()+a.topDictIndex.sizeOf()+a.stringIndex.sizeOf()+a.globalSubrIndex.sizeOf();return o.charset=x,o.encoding=0,o.charStrings=o.charset+a.charsets.sizeOf(),o.private[1]=o.charStrings+a.charStringsIndex.sizeOf(),v=m0(o,g),a.topDictIndex=g0(v),a}var _1={parse:S1,make:D1};function O1(r,t){var a={},s=new ze.Parser(r,t);return a.version=s.parseVersion(),a.fontRevision=Math.round(s.parseFixed()*1e3)/1e3,a.checkSumAdjustment=s.parseULong(),a.magicNumber=s.parseULong(),Ge.argument(a.magicNumber===1594834165,"Font header has wrong magic number."),a.flags=s.parseUShort(),a.unitsPerEm=s.parseUShort(),a.created=s.parseLongDateTime(),a.modified=s.parseLongDateTime(),a.xMin=s.parseShort(),a.yMin=s.parseShort(),a.xMax=s.parseShort(),a.yMax=s.parseShort(),a.macStyle=s.parseUShort(),a.lowestRecPPEM=s.parseUShort(),a.fontDirectionHint=s.parseShort(),a.indexToLocFormat=s.parseShort(),a.glyphDataFormat=s.parseShort(),a}function k1(r){var t=Math.round(new Date().getTime()/1e3)+2082844800,a=t;return r.createdTimestamp&&(a=r.createdTimestamp+2082844800),new Me.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:a},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],r)}var L1={parse:O1,make:k1};function U1(r,t){var a={},s=new ze.Parser(r,t);return a.version=s.parseVersion(),a.ascender=s.parseShort(),a.descender=s.parseShort(),a.lineGap=s.parseShort(),a.advanceWidthMax=s.parseUShort(),a.minLeftSideBearing=s.parseShort(),a.minRightSideBearing=s.parseShort(),a.xMaxExtent=s.parseShort(),a.caretSlopeRise=s.parseShort(),a.caretSlopeRun=s.parseShort(),a.caretOffset=s.parseShort(),s.relativeOffset+=8,a.metricDataFormat=s.parseShort(),a.numberOfHMetrics=s.parseUShort(),a}function I1(r){return new Me.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],r)}var B1={parse:U1,make:I1};function F1(r,t,a,s,o){for(var u,f,h=new ze.Parser(r,t),d=0;d<s;d+=1){d<a&&(u=h.parseUShort(),f=h.parseShort());var g=o.get(d);g.advanceWidth=u,g.leftSideBearing=f}}function j1(r,t,a,s,o){r._hmtxTableData={};for(var u,f,h=new ze.Parser(t,a),d=0;d<o;d+=1)d<s&&(u=h.parseUShort(),f=h.parseShort()),r._hmtxTableData[d]={advanceWidth:u,leftSideBearing:f}}function G1(r,t,a,s,o,u,f){f.lowMemory?j1(r,t,a,s,o):F1(t,a,s,o,u)}function P1(r){for(var t=new Me.Table("hmtx",[]),a=0;a<r.length;a+=1){var s=r.get(a),o=s.advanceWidth||0,u=s.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+a,type:"USHORT",value:o}),t.fields.push({name:"leftSideBearing_"+a,type:"SHORT",value:u})}return t}var z1={parse:G1,make:P1};function H1(r){for(var t=new Me.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:r.length}]),a="",s=12+r.length*4,o=0;o<r.length;++o){var u=a.indexOf(r[o]);u<0&&(u=a.length,a+=r[o]),t.fields.push({name:"offset "+o,type:"USHORT",value:s+u}),t.fields.push({name:"length "+o,type:"USHORT",value:r[o].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:a}),t}function Y1(r,t){var a=new ze.Parser(r,t),s=a.parseULong();Ge.argument(s===1,"Unsupported ltag table version."),a.skip("uLong",1);for(var o=a.parseULong(),u=[],f=0;f<o;f++){for(var h="",d=t+a.parseUShort(),g=a.parseUShort(),v=d;v<d+g;++v)h+=String.fromCharCode(r.getInt8(v));u.push(h)}return u}var V1={make:H1,parse:Y1};function q1(r,t){var a={},s=new ze.Parser(r,t);return a.version=s.parseVersion(),a.numGlyphs=s.parseUShort(),a.version===1&&(a.maxPoints=s.parseUShort(),a.maxContours=s.parseUShort(),a.maxCompositePoints=s.parseUShort(),a.maxCompositeContours=s.parseUShort(),a.maxZones=s.parseUShort(),a.maxTwilightPoints=s.parseUShort(),a.maxStorage=s.parseUShort(),a.maxFunctionDefs=s.parseUShort(),a.maxInstructionDefs=s.parseUShort(),a.maxStackElements=s.parseUShort(),a.maxSizeOfInstructions=s.parseUShort(),a.maxComponentElements=s.parseUShort(),a.maxComponentDepth=s.parseUShort()),a}function X1(r){return new Me.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:r}])}var Z1={parse:q1,make:X1},Sm=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Em={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Q1={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Am={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function K1(r,t,a){switch(r){case 0:if(t===65535)return"und";if(a)return a[t];break;case 1:return Em[t];case 3:return Am[t]}}var gf="utf-16",W1={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},$1={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Tm(r,t,a){switch(r){case 0:return gf;case 1:return $1[a]||W1[t];case 3:if(t===1||t===10)return gf;break}}function J1(r,t,a){for(var s={},o=new ze.Parser(r,t),u=o.parseUShort(),f=o.parseUShort(),h=o.offset+o.parseUShort(),d=0;d<f;d++){var g=o.parseUShort(),v=o.parseUShort(),x=o.parseUShort(),y=o.parseUShort(),S=Sm[y]||y,E=o.parseUShort(),T=o.parseUShort(),R=K1(g,x,a),j=Tm(g,v,x);if(j!==void 0&&R!==void 0){var M=void 0;if(j===gf?M=ls.UTF16(r,h+T,E):M=ls.MACSTRING(r,h+T,E,j),M){var D=s[S];D===void 0&&(D=s[S]={}),D[R]=M}}}return u===1&&o.parseUShort(),s}function Jc(r){var t={};for(var a in r)t[r[a]]=parseInt(a);return t}function v0(r,t,a,s,o,u){return new Me.Record("NameRecord",[{name:"platformID",type:"USHORT",value:r},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:a},{name:"nameID",type:"USHORT",value:s},{name:"length",type:"USHORT",value:o},{name:"offset",type:"USHORT",value:u}])}function eb(r,t){var a=r.length,s=t.length-a+1;e:for(var o=0;o<s;o++)for(;o<s;o++){for(var u=0;u<a;u++)if(t[o+u]!==r[u])continue e;return o}return-1}function y0(r,t){var a=eb(r,t);if(a<0){a=t.length;for(var s=0,o=r.length;s<o;++s)t.push(r[s])}return a}function tb(r,t){var a,s=[],o={},u=Jc(Sm);for(var f in r){var h=u[f];if(h===void 0&&(h=f),a=parseInt(h),isNaN(a))throw new Error('Name table entry "'+f+'" does not exist, see nameTableNames for complete list.');o[a]=r[f],s.push(a)}for(var d=Jc(Em),g=Jc(Am),v=[],x=[],y=0;y<s.length;y++){a=s[y];var S=o[a];for(var E in S){var T=S[E],R=1,j=d[E],M=Q1[j],D=Tm(R,M,j),I=Ee.MACSTRING(T,D);I===void 0&&(R=0,j=t.indexOf(E),j<0&&(j=t.length,t.push(E)),M=4,I=Ee.UTF16(T));var P=y0(I,x);v.push(v0(R,M,j,a,I.length,P));var H=g[E];if(H!==void 0){var ie=Ee.UTF16(T),se=y0(ie,x);v.push(v0(3,1,H,a,ie.length,se))}}}v.sort(function(Z,ee){return Z.platformID-ee.platformID||Z.encodingID-ee.encodingID||Z.languageID-ee.languageID||Z.nameID-ee.nameID});for(var de=new Me.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:v.length},{name:"stringOffset",type:"USHORT",value:6+v.length*12}]),ne=0;ne<v.length;ne++)de.fields.push({name:"record_"+ne,type:"RECORD",value:v[ne]});return de.fields.push({name:"strings",type:"LITERAL",value:x}),de}var nb={parse:J1,make:tb},vf=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function ab(r){for(var t=0;t<vf.length;t+=1){var a=vf[t];if(r>=a.begin&&r<a.end)return t}return-1}function rb(r,t){var a={},s=new ze.Parser(r,t);a.version=s.parseUShort(),a.xAvgCharWidth=s.parseShort(),a.usWeightClass=s.parseUShort(),a.usWidthClass=s.parseUShort(),a.fsType=s.parseUShort(),a.ySubscriptXSize=s.parseShort(),a.ySubscriptYSize=s.parseShort(),a.ySubscriptXOffset=s.parseShort(),a.ySubscriptYOffset=s.parseShort(),a.ySuperscriptXSize=s.parseShort(),a.ySuperscriptYSize=s.parseShort(),a.ySuperscriptXOffset=s.parseShort(),a.ySuperscriptYOffset=s.parseShort(),a.yStrikeoutSize=s.parseShort(),a.yStrikeoutPosition=s.parseShort(),a.sFamilyClass=s.parseShort(),a.panose=[];for(var o=0;o<10;o++)a.panose[o]=s.parseByte();return a.ulUnicodeRange1=s.parseULong(),a.ulUnicodeRange2=s.parseULong(),a.ulUnicodeRange3=s.parseULong(),a.ulUnicodeRange4=s.parseULong(),a.achVendID=String.fromCharCode(s.parseByte(),s.parseByte(),s.parseByte(),s.parseByte()),a.fsSelection=s.parseUShort(),a.usFirstCharIndex=s.parseUShort(),a.usLastCharIndex=s.parseUShort(),a.sTypoAscender=s.parseShort(),a.sTypoDescender=s.parseShort(),a.sTypoLineGap=s.parseShort(),a.usWinAscent=s.parseUShort(),a.usWinDescent=s.parseUShort(),a.version>=1&&(a.ulCodePageRange1=s.parseULong(),a.ulCodePageRange2=s.parseULong()),a.version>=2&&(a.sxHeight=s.parseShort(),a.sCapHeight=s.parseShort(),a.usDefaultChar=s.parseUShort(),a.usBreakChar=s.parseUShort(),a.usMaxContent=s.parseUShort()),a}function ib(r){return new Me.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],r)}var b0={parse:rb,make:ib,unicodeRanges:vf,getUnicodeRange:ab};function sb(r,t){var a={},s=new ze.Parser(r,t);switch(a.version=s.parseVersion(),a.italicAngle=s.parseFixed(),a.underlinePosition=s.parseShort(),a.underlineThickness=s.parseShort(),a.isFixedPitch=s.parseULong(),a.minMemType42=s.parseULong(),a.maxMemType42=s.parseULong(),a.minMemType1=s.parseULong(),a.maxMemType1=s.parseULong(),a.version){case 1:a.names=d0.slice();break;case 2:a.numberOfGlyphs=s.parseUShort(),a.glyphNameIndex=new Array(a.numberOfGlyphs);for(var o=0;o<a.numberOfGlyphs;o++)a.glyphNameIndex[o]=s.parseUShort();a.names=[];for(var u=0;u<a.numberOfGlyphs;u++)if(a.glyphNameIndex[u]>=d0.length){var f=s.parseChar();a.names.push(s.parseString(f))}break;case 2.5:a.numberOfGlyphs=s.parseUShort(),a.offset=new Array(a.numberOfGlyphs);for(var h=0;h<a.numberOfGlyphs;h++)a.offset[h]=s.parseChar();break}return a}function lb(){return new Me.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var ob={parse:sb,make:lb},ga=new Array(9);ga[1]=function(){var t=this.offset+this.relativeOffset,a=this.parseUShort();if(a===1)return{substFormat:1,coverage:this.parsePointer(te.coverage),deltaGlyphId:this.parseUShort()};if(a===2)return{substFormat:2,coverage:this.parsePointer(te.coverage),substitute:this.parseOffset16List()};Ge.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")};ga[2]=function(){var t=this.parseUShort();return Ge.argument(t===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(te.coverage),sequences:this.parseListOfLists()}};ga[3]=function(){var t=this.parseUShort();return Ge.argument(t===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(te.coverage),alternateSets:this.parseListOfLists()}};ga[4]=function(){var t=this.parseUShort();return Ge.argument(t===1,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(te.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var ss={sequenceIndex:te.uShort,lookupListIndex:te.uShort};ga[5]=function(){var t=this.offset+this.relativeOffset,a=this.parseUShort();if(a===1)return{substFormat:a,coverage:this.parsePointer(te.coverage),ruleSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{input:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,ss)}})};if(a===2)return{substFormat:a,coverage:this.parsePointer(te.coverage),classDef:this.parsePointer(te.classDef),classSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{classes:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,ss)}})};if(a===3){var s=this.parseUShort(),o=this.parseUShort();return{substFormat:a,coverages:this.parseList(s,te.pointer(te.coverage)),lookupRecords:this.parseRecordList(o,ss)}}Ge.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};ga[6]=function(){var t=this.offset+this.relativeOffset,a=this.parseUShort();if(a===1)return{substFormat:1,coverage:this.parsePointer(te.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ss)}})};if(a===2)return{substFormat:2,coverage:this.parsePointer(te.coverage),backtrackClassDef:this.parsePointer(te.classDef),inputClassDef:this.parsePointer(te.classDef),lookaheadClassDef:this.parsePointer(te.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ss)}})};if(a===3)return{substFormat:3,backtrackCoverage:this.parseList(te.pointer(te.coverage)),inputCoverage:this.parseList(te.pointer(te.coverage)),lookaheadCoverage:this.parseList(te.pointer(te.coverage)),lookupRecords:this.parseRecordList(ss)};Ge.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};ga[7]=function(){var t=this.parseUShort();Ge.argument(t===1,"GSUB Extension Substitution subtable identifier-format must be 1");var a=this.parseUShort(),s=new te(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:a,extension:ga[a].call(s)}};ga[8]=function(){var t=this.parseUShort();return Ge.argument(t===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(te.coverage),backtrackCoverage:this.parseList(te.pointer(te.coverage)),lookaheadCoverage:this.parseList(te.pointer(te.coverage)),substitutes:this.parseUShortList()}};function ub(r,t){t=t||0;var a=new te(r,t),s=a.parseVersion(1);return Ge.argument(s===1||s===1.1,"Unsupported GSUB table version."),s===1?{version:s,scripts:a.parseScriptList(),features:a.parseFeatureList(),lookups:a.parseLookupList(ga)}:{version:s,scripts:a.parseScriptList(),features:a.parseFeatureList(),lookups:a.parseLookupList(ga),variations:a.parseFeatureVariationsList()}}var os=new Array(9);os[1]=function(t){return t.substFormat===1?new Me.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Me.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new Me.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Me.Coverage(t.coverage)}].concat(Me.ushortList("substitute",t.substitute)))};os[2]=function(t){return Ge.assert(t.substFormat===1,"Lookup type 2 substFormat must be 1."),new Me.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Me.Coverage(t.coverage)}].concat(Me.tableList("seqSet",t.sequences,function(a){return new Me.Table("sequenceSetTable",Me.ushortList("sequence",a))})))};os[3]=function(t){return Ge.assert(t.substFormat===1,"Lookup type 3 substFormat must be 1."),new Me.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Me.Coverage(t.coverage)}].concat(Me.tableList("altSet",t.alternateSets,function(a){return new Me.Table("alternateSetTable",Me.ushortList("alternate",a))})))};os[4]=function(t){return Ge.assert(t.substFormat===1,"Lookup type 4 substFormat must be 1."),new Me.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Me.Coverage(t.coverage)}].concat(Me.tableList("ligSet",t.ligatureSets,function(a){return new Me.Table("ligatureSetTable",Me.tableList("ligature",a,function(s){return new Me.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:s.ligGlyph}].concat(Me.ushortList("component",s.components,s.components.length+1)))}))})))};os[6]=function(t){if(t.substFormat===1){var a=new Me.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:t.substFormat},{name:"coverage",type:"TABLE",value:new Me.Coverage(t.coverage)}].concat(Me.tableList("chainRuleSet",t.chainRuleSets,function(u){return new Me.Table("chainRuleSetTable",Me.tableList("chainRule",u,function(f){var h=Me.ushortList("backtrackGlyph",f.backtrack,f.backtrack.length).concat(Me.ushortList("inputGlyph",f.input,f.input.length+1)).concat(Me.ushortList("lookaheadGlyph",f.lookahead,f.lookahead.length)).concat(Me.ushortList("substitution",[],f.lookupRecords.length));return f.lookupRecords.forEach(function(d,g){h=h.concat({name:"sequenceIndex"+g,type:"USHORT",value:d.sequenceIndex}).concat({name:"lookupListIndex"+g,type:"USHORT",value:d.lookupListIndex})}),new Me.Table("chainRuleTable",h)}))})));return a}else if(t.substFormat===2)Ge.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(t.substFormat===3){var s=[{name:"substFormat",type:"USHORT",value:t.substFormat}];s.push({name:"backtrackGlyphCount",type:"USHORT",value:t.backtrackCoverage.length}),t.backtrackCoverage.forEach(function(u,f){s.push({name:"backtrackCoverage"+f,type:"TABLE",value:new Me.Coverage(u)})}),s.push({name:"inputGlyphCount",type:"USHORT",value:t.inputCoverage.length}),t.inputCoverage.forEach(function(u,f){s.push({name:"inputCoverage"+f,type:"TABLE",value:new Me.Coverage(u)})}),s.push({name:"lookaheadGlyphCount",type:"USHORT",value:t.lookaheadCoverage.length}),t.lookaheadCoverage.forEach(function(u,f){s.push({name:"lookaheadCoverage"+f,type:"TABLE",value:new Me.Coverage(u)})}),s.push({name:"substitutionCount",type:"USHORT",value:t.lookupRecords.length}),t.lookupRecords.forEach(function(u,f){s=s.concat({name:"sequenceIndex"+f,type:"USHORT",value:u.sequenceIndex}).concat({name:"lookupListIndex"+f,type:"USHORT",value:u.lookupListIndex})});var o=new Me.Table("chainContextTable",s);return o}Ge.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function cb(r){return new Me.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Me.ScriptList(r.scripts)},{name:"features",type:"TABLE",value:new Me.FeatureList(r.features)},{name:"lookups",type:"TABLE",value:new Me.LookupList(r.lookups,os)}])}var fb={parse:ub,make:cb};function db(r,t){var a=new ze.Parser(r,t),s=a.parseULong();Ge.argument(s===1,"Unsupported META table version."),a.parseULong(),a.parseULong();for(var o=a.parseULong(),u={},f=0;f<o;f++){var h=a.parseTag(),d=a.parseULong(),g=a.parseULong(),v=ls.UTF8(r,t+d,g);u[h]=v}return u}function pb(r){var t=Object.keys(r).length,a="",s=16+t*12,o=new Me.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:s},{name:"numTags",type:"ULONG",value:t}]);for(var u in r){var f=a.length;a+=r[u],o.fields.push({name:"tag "+u,type:"TAG",value:u}),o.fields.push({name:"offset "+u,type:"ULONG",value:s+f}),o.fields.push({name:"length "+u,type:"ULONG",value:r[u].length})}return o.fields.push({name:"stringPool",type:"CHARARRAY",value:a}),o}var hb={parse:db,make:pb};function x0(r){return Math.log(r)/Math.log(2)|0}function Cf(r){for(;r.length%4!==0;)r.push(0);for(var t=0,a=0;a<r.length;a+=4)t+=(r[a]<<24)+(r[a+1]<<16)+(r[a+2]<<8)+r[a+3];return t%=Math.pow(2,32),t}function S0(r,t,a,s){return new Me.Record("Table Record",[{name:"tag",type:"TAG",value:r!==void 0?r:""},{name:"checkSum",type:"ULONG",value:t!==void 0?t:0},{name:"offset",type:"ULONG",value:a!==void 0?a:0},{name:"length",type:"ULONG",value:s!==void 0?s:0}])}function wm(r){var t=new Me.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=r,t.numTables=r.length;var a=Math.pow(2,x0(t.numTables));t.searchRange=16*a,t.entrySelector=x0(a),t.rangeShift=t.numTables*16-t.searchRange;for(var s=[],o=[],u=t.sizeOf()+S0().sizeOf()*t.numTables;u%4!==0;)u+=1,o.push({name:"padding",type:"BYTE",value:0});for(var f=0;f<r.length;f+=1){var h=r[f];Ge.argument(h.tableName.length===4,"Table name"+h.tableName+" is invalid.");var d=h.sizeOf(),g=S0(h.tableName,Cf(h.encode()),u,d);for(s.push({name:g.tag+" Table Record",type:"RECORD",value:g}),o.push({name:h.tableName+" table",type:"RECORD",value:h}),u+=d,Ge.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!==0;)u+=1,o.push({name:"padding",type:"BYTE",value:0})}return s.sort(function(v,x){return v.value.tag>x.value.tag?1:-1}),t.fields=t.fields.concat(s),t.fields=t.fields.concat(o),t}function E0(r,t,a){for(var s=0;s<t.length;s+=1){var o=r.charToGlyphIndex(t[s]);if(o>0){var u=r.glyphs.get(o);return u.getMetrics()}}return a}function mb(r){for(var t=0,a=0;a<r.length;a+=1)t+=r[a];return t/r.length}function gb(r){for(var t=[],a=[],s=[],o=[],u=[],f=[],h=[],d,g=0,v=0,x=0,y=0,S=0,E=0;E<r.glyphs.length;E+=1){var T=r.glyphs.get(E),R=T.unicode|0;if(isNaN(T.advanceWidth))throw new Error("Glyph "+T.name+" ("+E+"): advanceWidth is not a number.");(d>R||d===void 0)&&R>0&&(d=R),g<R&&(g=R);var j=b0.getUnicodeRange(R);if(j<32)v|=1<<j;else if(j<64)x|=1<<j-32;else if(j<96)y|=1<<j-64;else if(j<123)S|=1<<j-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(T.name!==".notdef"){var M=T.getMetrics();t.push(M.xMin),a.push(M.yMin),s.push(M.xMax),o.push(M.yMax),f.push(M.leftSideBearing),h.push(M.rightSideBearing),u.push(T.advanceWidth)}}var D={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,a),xMax:Math.max.apply(null,s),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,u),advanceWidthAvg:mb(u),minLeftSideBearing:Math.min.apply(null,f),maxLeftSideBearing:Math.max.apply(null,f),minRightSideBearing:Math.min.apply(null,h)};D.ascender=r.ascender,D.descender=r.descender;var I=L1.make({flags:3,unitsPerEm:r.unitsPerEm,xMin:D.xMin,yMin:D.yMin,xMax:D.xMax,yMax:D.yMax,lowestRecPPEM:3,createdTimestamp:r.createdTimestamp}),P=B1.make({ascender:D.ascender,descender:D.descender,advanceWidthMax:D.advanceWidthMax,minLeftSideBearing:D.minLeftSideBearing,minRightSideBearing:D.minRightSideBearing,xMaxExtent:D.maxLeftSideBearing+(D.xMax-D.xMin),numberOfHMetrics:r.glyphs.length}),H=Z1.make(r.glyphs.length),ie=b0.make(Object.assign({xAvgCharWidth:Math.round(D.advanceWidthAvg),usFirstCharIndex:d,usLastCharIndex:g,ulUnicodeRange1:v,ulUnicodeRange2:x,ulUnicodeRange3:y,ulUnicodeRange4:S,sTypoAscender:D.ascender,sTypoDescender:D.descender,sTypoLineGap:0,usWinAscent:D.yMax,usWinDescent:Math.abs(D.yMin),ulCodePageRange1:1,sxHeight:E0(r,"xyvw",{yMax:Math.round(D.ascender/2)}).yMax,sCapHeight:E0(r,"HIKLEFJMNTZBDPRAGOQSUVWXY",D).yMax,usDefaultChar:r.hasChar(" ")?32:0,usBreakChar:r.hasChar(" ")?32:0},r.tables.os2)),se=z1.make(r.glyphs),de=a1.make(r.glyphs),ne=r.getEnglishName("fontFamily"),Z=r.getEnglishName("fontSubfamily"),ee=ne+" "+Z,ae=r.getEnglishName("postScriptName");ae||(ae=ne.replace(/\s/g,"")+"-"+Z);var $={};for(var re in r.names)$[re]=r.names[re];$.uniqueID||($.uniqueID={en:r.getEnglishName("manufacturer")+":"+ee}),$.postScriptName||($.postScriptName={en:ae}),$.preferredFamily||($.preferredFamily=r.names.fontFamily),$.preferredSubfamily||($.preferredSubfamily=r.names.fontSubfamily);var B=[],U=nb.make($,B),le=B.length>0?V1.make(B):void 0,ve=ob.make(),N=_1.make(r.glyphs,{version:r.getEnglishName("version"),fullName:ee,familyName:ne,weightName:Z,postScriptName:ae,unitsPerEm:r.unitsPerEm,fontBBox:[0,D.yMin,D.ascender,D.advanceWidthMax]}),V=r.metas&&Object.keys(r.metas).length>0?hb.make(r.metas):void 0,oe=[I,P,H,ie,U,de,ve,N,se];le&&oe.push(le),r.tables.gsub&&oe.push(fb.make(r.tables.gsub)),V&&oe.push(V);for(var W=wm(oe),z=W.encode(),be=Cf(z),ge=W.fields,xe=!1,He=0;He<ge.length;He+=1)if(ge[He].name==="head table"){ge[He].value.checkSumAdjustment=2981146554-be,xe=!0;break}if(!xe)throw new Error("Could not find head table with checkSum to adjust.");return W}var vb={make:wm,fontToTable:gb,computeCheckSum:Cf};function ef(r,t){for(var a=0,s=r.length-1;a<=s;){var o=a+s>>>1,u=r[o].tag;if(u===t)return o;u<t?a=o+1:s=o-1}return-a-1}function A0(r,t){for(var a=0,s=r.length-1;a<=s;){var o=a+s>>>1,u=r[o];if(u===t)return o;u<t?a=o+1:s=o-1}return-a-1}function T0(r,t){for(var a,s=0,o=r.length-1;s<=o;){var u=s+o>>>1;a=r[u];var f=a.start;if(f===t)return a;f<t?s=u+1:o=u-1}if(s>0)return a=r[s-1],t>a.end?0:a}function vl(r,t){this.font=r,this.tableName=t}vl.prototype={searchTag:ef,binSearch:A0,getTable:function(r){var t=this.font.tables[this.tableName];return!t&&r&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var r=this.getTable();return r?r.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){var r=this.getTable();if(r){for(var t=!1,a=0;a<r.scripts.length;a++){var s=r.scripts[a].tag;if(s==="DFLT")return s;s==="latn"&&(t=!0)}if(t)return"latn"}},getScriptTable:function(r,t){var a=this.getTable(t);if(a){r=r||"DFLT";var s=a.scripts,o=ef(a.scripts,r);if(o>=0)return s[o].script;if(t){var u={tag:r,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return s.splice(-1-o,0,u),u.script}}},getLangSysTable:function(r,t,a){var s=this.getScriptTable(r,a);if(s){if(!t||t==="dflt"||t==="DFLT")return s.defaultLangSys;var o=ef(s.langSysRecords,t);if(o>=0)return s.langSysRecords[o].langSys;if(a){var u={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return s.langSysRecords.splice(-1-o,0,u),u.langSys}}},getFeatureTable:function(r,t,a,s){var o=this.getLangSysTable(r,t,s);if(o){for(var u,f=o.featureIndexes,h=this.font.tables[this.tableName].features,d=0;d<f.length;d++)if(u=h[f[d]],u.tag===a)return u.feature;if(s){var g=h.length;return Ge.assert(g===0||a>=h[g-1].tag,"Features must be added in alphabetical order."),u={tag:a,feature:{params:0,lookupListIndexes:[]}},h.push(u),f.push(g),u.feature}}},getLookupTables:function(r,t,a,s,o){var u=this.getFeatureTable(r,t,a,o),f=[];if(u){for(var h,d=u.lookupListIndexes,g=this.font.tables[this.tableName].lookups,v=0;v<d.length;v++)h=g[d[v]],h.lookupType===s&&f.push(h);if(f.length===0&&o){h={lookupType:s,lookupFlag:0,subtables:[],markFilteringSet:void 0};var x=g.length;return g.push(h),d.push(x),[h]}}return f},getGlyphClass:function(r,t){switch(r.format){case 1:return r.startGlyph<=t&&t<r.startGlyph+r.classes.length?r.classes[t-r.startGlyph]:0;case 2:var a=T0(r.ranges,t);return a?a.classId:0}},getCoverageIndex:function(r,t){switch(r.format){case 1:var a=A0(r.glyphs,t);return a>=0?a:-1;case 2:var s=T0(r.ranges,t);return s?s.index+t-s.start:-1}},expandCoverage:function(r){if(r.format===1)return r.glyphs;for(var t=[],a=r.ranges,s=0;s<a.length;s++)for(var o=a[s],u=o.start,f=o.end,h=u;h<=f;h++)t.push(h);return t}};function yl(r){vl.call(this,r,"gpos")}yl.prototype=vl.prototype;yl.prototype.init=function(){var r=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(r)};yl.prototype.getKerningValue=function(r,t,a){for(var s=0;s<r.length;s++)for(var o=r[s].subtables,u=0;u<o.length;u++){var f=o[u],h=this.getCoverageIndex(f.coverage,t);if(!(h<0))switch(f.posFormat){case 1:for(var d=f.pairSets[h],g=0;g<d.length;g++){var v=d[g];if(v.secondGlyph===a)return v.value1&&v.value1.xAdvance||0}break;case 2:var x=this.getGlyphClass(f.classDef1,t),y=this.getGlyphClass(f.classDef2,a),S=f.classRecords[x][y];return S.value1&&S.value1.xAdvance||0}}return 0};yl.prototype.getKerningTables=function(r,t){if(this.font.tables.gpos)return this.getLookupTables(r,t,"kern",2)};function Gn(r){vl.call(this,r,"gsub")}function yb(r,t){var a=r.length;if(a!==t.length)return!1;for(var s=0;s<a;s++)if(r[s]!==t[s])return!1;return!0}function Mf(r,t,a){for(var s=r.subtables,o=0;o<s.length;o++){var u=s[o];if(u.substFormat===t)return u}if(a)return s.push(a),a}Gn.prototype=vl.prototype;Gn.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};Gn.prototype.getSingle=function(r,t,a){for(var s=[],o=this.getLookupTables(t,a,r,1),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++){var d=f[h],g=this.expandCoverage(d.coverage),v=void 0;if(d.substFormat===1){var x=d.deltaGlyphId;for(v=0;v<g.length;v++){var y=g[v];s.push({sub:y,by:y+x})}}else{var S=d.substitute;for(v=0;v<g.length;v++)s.push({sub:g[v],by:S[v]})}}return s};Gn.prototype.getMultiple=function(r,t,a){for(var s=[],o=this.getLookupTables(t,a,r,2),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++){var d=f[h],g=this.expandCoverage(d.coverage),v=void 0;for(v=0;v<g.length;v++){var x=g[v],y=d.sequences[v];s.push({sub:x,by:y})}}return s};Gn.prototype.getAlternates=function(r,t,a){for(var s=[],o=this.getLookupTables(t,a,r,3),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++)for(var d=f[h],g=this.expandCoverage(d.coverage),v=d.alternateSets,x=0;x<g.length;x++)s.push({sub:g[x],by:v[x]});return s};Gn.prototype.getLigatures=function(r,t,a){for(var s=[],o=this.getLookupTables(t,a,r,4),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++)for(var d=f[h],g=this.expandCoverage(d.coverage),v=d.ligatureSets,x=0;x<g.length;x++)for(var y=g[x],S=v[x],E=0;E<S.length;E++){var T=S[E];s.push({sub:[y].concat(T.components),by:T.ligGlyph})}return s};Gn.prototype.addSingle=function(r,t,a,s){var o=this.getLookupTables(a,s,r,1,!0)[0],u=Mf(o,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Ge.assert(u.coverage.format===1,"Single: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.substitute.splice(h,0,0)),u.substitute[h]=t.by};Gn.prototype.addMultiple=function(r,t,a,s){Ge.assert(t.by instanceof Array&&t.by.length>1,'Multiple: "by" must be an array of two or more ids');var o=this.getLookupTables(a,s,r,2,!0)[0],u=Mf(o,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Ge.assert(u.coverage.format===1,"Multiple: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.sequences.splice(h,0,0)),u.sequences[h]=t.by};Gn.prototype.addAlternate=function(r,t,a,s){var o=this.getLookupTables(a,s,r,3,!0)[0],u=Mf(o,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Ge.assert(u.coverage.format===1,"Alternate: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.alternateSets.splice(h,0,0)),u.alternateSets[h]=t.by};Gn.prototype.addLigature=function(r,t,a,s){var o=this.getLookupTables(a,s,r,4,!0)[0],u=o.subtables[0];u||(u={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},o.subtables[0]=u),Ge.assert(u.coverage.format===1,"Ligature: unable to modify coverage table format "+u.coverage.format);var f=t.sub[0],h=t.sub.slice(1),d={ligGlyph:t.by,components:h},g=this.binSearch(u.coverage.glyphs,f);if(g>=0){for(var v=u.ligatureSets[g],x=0;x<v.length;x++)if(yb(v[x].components,h))return;v.push(d)}else g=-1-g,u.coverage.glyphs.splice(g,0,f),u.ligatureSets.splice(g,0,[d])};Gn.prototype.getFeature=function(r,t,a){if(/ss\d\d/.test(r))return this.getSingle(r,t,a);switch(r){case"aalt":case"salt":return this.getSingle(r,t,a).concat(this.getAlternates(r,t,a));case"dlig":case"liga":case"rlig":return this.getLigatures(r,t,a);case"ccmp":return this.getMultiple(r,t,a).concat(this.getLigatures(r,t,a));case"stch":return this.getMultiple(r,t,a)}};Gn.prototype.add=function(r,t,a,s){if(/ss\d\d/.test(r))return this.addSingle(r,t,a,s);switch(r){case"aalt":case"salt":return typeof t.by=="number"?this.addSingle(r,t,a,s):this.addAlternate(r,t,a,s);case"dlig":case"liga":case"rlig":return this.addLigature(r,t,a,s);case"ccmp":return t.by instanceof Array?this.addMultiple(r,t,a,s):this.addLigature(r,t,a,s)}};function bb(){return typeof window<"u"}function xb(r){for(var t=new Buffer(r.byteLength),a=new Uint8Array(r),s=0;s<t.length;++s)t[s]=a[s];return t}function cl(r,t){if(!r)throw t}function w0(r,t,a,s,o){var u;return(t&s)>0?(u=r.parseByte(),(t&o)===0&&(u=-u),u=a+u):(t&o)>0?u=a:u=a+r.parseShort(),u}function Cm(r,t,a){var s=new ze.Parser(t,a);r.numberOfContours=s.parseShort(),r._xMin=s.parseShort(),r._yMin=s.parseShort(),r._xMax=s.parseShort(),r._yMax=s.parseShort();var o,u;if(r.numberOfContours>0){for(var f=r.endPointIndices=[],h=0;h<r.numberOfContours;h+=1)f.push(s.parseUShort());r.instructionLength=s.parseUShort(),r.instructions=[];for(var d=0;d<r.instructionLength;d+=1)r.instructions.push(s.parseByte());var g=f[f.length-1]+1;o=[];for(var v=0;v<g;v+=1)if(u=s.parseByte(),o.push(u),(u&8)>0)for(var x=s.parseByte(),y=0;y<x;y+=1)o.push(u),v+=1;if(Ge.argument(o.length===g,"Bad flags."),f.length>0){var S=[],E;if(g>0){for(var T=0;T<g;T+=1)u=o[T],E={},E.onCurve=!!(u&1),E.lastPointOfContour=f.indexOf(T)>=0,S.push(E);for(var R=0,j=0;j<g;j+=1)u=o[j],E=S[j],E.x=w0(s,u,R,2,16),R=E.x;for(var M=0,D=0;D<g;D+=1)u=o[D],E=S[D],E.y=w0(s,u,M,4,32),M=E.y}r.points=S}else r.points=[]}else if(r.numberOfContours===0)r.points=[];else{r.isComposite=!0,r.points=[],r.components=[];for(var I=!0;I;){o=s.parseUShort();var P={glyphIndex:s.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(o&1)>0?(o&2)>0?(P.dx=s.parseShort(),P.dy=s.parseShort()):P.matchedPoints=[s.parseUShort(),s.parseUShort()]:(o&2)>0?(P.dx=s.parseChar(),P.dy=s.parseChar()):P.matchedPoints=[s.parseByte(),s.parseByte()],(o&8)>0?P.xScale=P.yScale=s.parseF2Dot14():(o&64)>0?(P.xScale=s.parseF2Dot14(),P.yScale=s.parseF2Dot14()):(o&128)>0&&(P.xScale=s.parseF2Dot14(),P.scale01=s.parseF2Dot14(),P.scale10=s.parseF2Dot14(),P.yScale=s.parseF2Dot14()),r.components.push(P),I=!!(o&32)}if(o&256){r.instructionLength=s.parseUShort(),r.instructions=[];for(var H=0;H<r.instructionLength;H+=1)r.instructions.push(s.parseByte())}}}function tf(r,t){for(var a=[],s=0;s<r.length;s+=1){var o=r[s],u={x:t.xScale*o.x+t.scale01*o.y+t.dx,y:t.scale10*o.x+t.yScale*o.y+t.dy,onCurve:o.onCurve,lastPointOfContour:o.lastPointOfContour};a.push(u)}return a}function Sb(r){for(var t=[],a=[],s=0;s<r.length;s+=1){var o=r[s];a.push(o),o.lastPointOfContour&&(t.push(a),a=[])}return Ge.argument(a.length===0,"There are still points left in the current contour."),t}function Mm(r){var t=new Ht;if(!r)return t;for(var a=Sb(r),s=0;s<a.length;++s){var o=a[s],u=null,f=o[o.length-1],h=o[0];if(f.onCurve)t.moveTo(f.x,f.y);else if(h.onCurve)t.moveTo(h.x,h.y);else{var d={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5};t.moveTo(d.x,d.y)}for(var g=0;g<o.length;++g)if(u=f,f=h,h=o[(g+1)%o.length],f.onCurve)t.lineTo(f.x,f.y);else{var v=h;u.onCurve||((f.x+u.x)*.5,(f.y+u.y)*.5),h.onCurve||(v={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5}),t.quadraticCurveTo(f.x,f.y,v.x,v.y)}t.closePath()}return t}function Nm(r,t){if(t.isComposite)for(var a=0;a<t.components.length;a+=1){var s=t.components[a],o=r.get(s.glyphIndex);if(o.getPath(),o.points){var u=void 0;if(s.matchedPoints===void 0)u=tf(o.points,s);else{if(s.matchedPoints[0]>t.points.length-1||s.matchedPoints[1]>o.points.length-1)throw Error("Matched points out of range in "+t.name);var f=t.points[s.matchedPoints[0]],h=o.points[s.matchedPoints[1]],d={xScale:s.xScale,scale01:s.scale01,scale10:s.scale10,yScale:s.yScale,dx:0,dy:0};h=tf([h],d)[0],d.dx=f.x-h.x,d.dy=f.y-h.y,u=tf(o.points,d)}t.points=t.points.concat(u)}}return Mm(t.points)}function Eb(r,t,a,s){for(var o=new Da.GlyphSet(s),u=0;u<a.length-1;u+=1){var f=a[u],h=a[u+1];f!==h?o.push(u,Da.ttfGlyphLoader(s,u,Cm,r,t+f,Nm)):o.push(u,Da.glyphLoader(s,u))}return o}function Ab(r,t,a,s){var o=new Da.GlyphSet(s);return s._push=function(u){var f=a[u],h=a[u+1];f!==h?o.push(u,Da.ttfGlyphLoader(s,u,Cm,r,t+f,Nm)):o.push(u,Da.glyphLoader(s,u))},o}function Tb(r,t,a,s,o){return o.lowMemory?Ab(r,t,a,s):Eb(r,t,a,s)}var wb={getPath:Mm,parse:Tb},Rm,gi,Dm,yf;function _m(r){this.font=r,this.getCommands=function(t){return wb.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Cb(r){return r}function Om(r){return Math.sign(r)*Math.round(Math.abs(r))}function Mb(r){return Math.sign(r)*Math.round(Math.abs(r*2))/2}function Nb(r){return Math.sign(r)*(Math.round(Math.abs(r)+.5)-.5)}function Rb(r){return Math.sign(r)*Math.ceil(Math.abs(r))}function Db(r){return Math.sign(r)*Math.floor(Math.abs(r))}var km=function(r){var t=this.srPeriod,a=this.srPhase,s=this.srThreshold,o=1;return r<0&&(r=-r,o=-1),r+=s-a,r=Math.trunc(r/t)*t,r+=a,r<0?a*o:r*o},Ra={x:1,y:0,axis:"x",distance:function(r,t,a,s){return(a?r.xo:r.x)-(s?t.xo:t.x)},interpolate:function(r,t,a,s){var o,u,f,h,d,g,v;if(!s||s===this){if(o=r.xo-t.xo,u=r.xo-a.xo,d=t.x-t.xo,g=a.x-a.xo,f=Math.abs(o),h=Math.abs(u),v=f+h,v===0){r.x=r.xo+(d+g)/2;return}r.x=r.xo+(d*h+g*f)/v;return}if(o=s.distance(r,t,!0,!0),u=s.distance(r,a,!0,!0),d=s.distance(t,t,!1,!0),g=s.distance(a,a,!1,!0),f=Math.abs(o),h=Math.abs(u),v=f+h,v===0){Ra.setRelative(r,r,(d+g)/2,s,!0);return}Ra.setRelative(r,r,(d*h+g*f)/v,s,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(r,t,a,s,o){if(!s||s===this){r.x=(o?t.xo:t.x)+a;return}var u=o?t.xo:t.x,f=o?t.yo:t.y,h=u+a*s.x,d=f+a*s.y;r.x=h+(r.y-d)/s.normalSlope},slope:0,touch:function(r){r.xTouched=!0},touched:function(r){return r.xTouched},untouch:function(r){r.xTouched=!1}},nr={x:0,y:1,axis:"y",distance:function(r,t,a,s){return(a?r.yo:r.y)-(s?t.yo:t.y)},interpolate:function(r,t,a,s){var o,u,f,h,d,g,v;if(!s||s===this){if(o=r.yo-t.yo,u=r.yo-a.yo,d=t.y-t.yo,g=a.y-a.yo,f=Math.abs(o),h=Math.abs(u),v=f+h,v===0){r.y=r.yo+(d+g)/2;return}r.y=r.yo+(d*h+g*f)/v;return}if(o=s.distance(r,t,!0,!0),u=s.distance(r,a,!0,!0),d=s.distance(t,t,!1,!0),g=s.distance(a,a,!1,!0),f=Math.abs(o),h=Math.abs(u),v=f+h,v===0){nr.setRelative(r,r,(d+g)/2,s,!0);return}nr.setRelative(r,r,(d*h+g*f)/v,s,!0)},normalSlope:0,setRelative:function(r,t,a,s,o){if(!s||s===this){r.y=(o?t.yo:t.y)+a;return}var u=o?t.xo:t.x,f=o?t.yo:t.y,h=u+a*s.x,d=f+a*s.y;r.y=d+s.normalSlope*(r.x-h)},slope:Number.POSITIVE_INFINITY,touch:function(r){r.yTouched=!0},touched:function(r){return r.yTouched},untouch:function(r){r.yTouched=!1}};Object.freeze(Ra);Object.freeze(nr);function bl(r,t){this.x=r,this.y=t,this.axis=void 0,this.slope=t/r,this.normalSlope=-r/t,Object.freeze(this)}bl.prototype.distance=function(r,t,a,s){return this.x*Ra.distance(r,t,a,s)+this.y*nr.distance(r,t,a,s)};bl.prototype.interpolate=function(r,t,a,s){var o,u,f,h,d,g,v;if(f=s.distance(r,t,!0,!0),h=s.distance(r,a,!0,!0),o=s.distance(t,t,!1,!0),u=s.distance(a,a,!1,!0),d=Math.abs(f),g=Math.abs(h),v=d+g,v===0){this.setRelative(r,r,(o+u)/2,s,!0);return}this.setRelative(r,r,(o*g+u*d)/v,s,!0)};bl.prototype.setRelative=function(r,t,a,s,o){s=s||this;var u=o?t.xo:t.x,f=o?t.yo:t.y,h=u+a*s.x,d=f+a*s.y,g=s.normalSlope,v=this.slope,x=r.x,y=r.y;r.x=(v*x-g*h+d-y)/(v-g),r.y=v*(r.x-x)+y};bl.prototype.touch=function(r){r.xTouched=!0,r.yTouched=!0};function xl(r,t){var a=Math.sqrt(r*r+t*t);return r/=a,t/=a,r===1&&t===0?Ra:r===0&&t===1?nr:new bl(r,t)}function ar(r,t,a,s){this.x=this.xo=Math.round(r*64)/64,this.y=this.yo=Math.round(t*64)/64,this.lastPointOfContour=a,this.onCurve=s,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}ar.prototype.nextTouched=function(r){for(var t=this.nextPointOnContour;!r.touched(t)&&t!==this;)t=t.nextPointOnContour;return t};ar.prototype.prevTouched=function(r){for(var t=this.prevPointOnContour;!r.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var gl=Object.freeze(new ar(0,0)),_b={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function jr(r,t){switch(this.env=r,this.stack=[],this.prog=t,r){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Ra,this.round=Om}}_m.prototype.exec=function(r,t){if(typeof t!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var a=this.font,s=this._prepState;if(!s||s.ppem!==t){var o=this._fpgmState;if(!o){jr.prototype=_b,o=this._fpgmState=new jr("fpgm",a.tables.fpgm),o.funcs=[],o.font=a,exports.DEBUG&&(console.log("---EXEC FPGM---"),o.step=-1);try{gi(o)}catch(g){console.log("Hinting error in FPGM:"+g),this._errorState=3;return}}jr.prototype=o,s=this._prepState=new jr("prep",a.tables.prep),s.ppem=t;var u=a.tables.cvt;if(u)for(var f=s.cvt=new Array(u.length),h=t/a.unitsPerEm,d=0;d<u.length;d++)f[d]=u[d]*h;else s.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),s.step=-1);try{gi(s)}catch(g){this._errorState<2&&console.log("Hinting error in PREP:"+g),this._errorState=2}}if(!(this._errorState>1))try{return Dm(r,s)}catch(g){this._errorState<1&&(console.log("Hinting error:"+g),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};Dm=function(r,t){var a=t.ppem/t.font.unitsPerEm,s=a,o=r.components,u,f,h;if(jr.prototype=t,!o)h=new jr("glyf",r.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),h.step=-1),yf(r,h,a,s),f=h.gZone;else{var d=t.font;f=[],u=[];for(var g=0;g<o.length;g++){var v=o[g],x=d.glyphs.get(v.glyphIndex);h=new jr("glyf",x.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+g+"---"),h.step=-1),yf(x,h,a,s);for(var y=Math.round(v.dx*a),S=Math.round(v.dy*s),E=h.gZone,T=h.contours,R=0;R<E.length;R++){var j=E[R];j.xTouched=j.yTouched=!1,j.xo=j.x=j.x+y,j.yo=j.y=j.y+S}var M=f.length;f.push.apply(f,E);for(var D=0;D<T.length;D++)u.push(T[D]+M)}r.instructions&&!h.inhibitGridFit&&(h=new jr("glyf",r.instructions),h.gZone=h.z0=h.z1=h.z2=f,h.contours=u,f.push(new ar(0,0),new ar(Math.round(r.advanceWidth*a),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),h.step=-1),gi(h),f.length-=2)}return f};yf=function(r,t,a,s){for(var o=r.points||[],u=o.length,f=t.gZone=t.z0=t.z1=t.z2=[],h=t.contours=[],d,g=0;g<u;g++)d=o[g],f[g]=new ar(d.x*a,d.y*s,d.lastPointOfContour,d.onCurve);for(var v,x,y=0;y<u;y++)d=f[y],v||(v=d,h.push(y)),d.lastPointOfContour?(d.nextPointOnContour=v,v.prevPointOnContour=d,v=void 0):(x=f[y+1],d.nextPointOnContour=x,x.prevPointOnContour=d);if(!t.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(var S=0;S<u;S++)console.log(S,f[S].x,f[S].y)}if(f.push(new ar(0,0),new ar(Math.round(r.advanceWidth*a),0)),gi(t),f.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",t.stack);for(var E=0;E<u;E++)console.log(E,f[E].x,f[E].y)}}};gi=function(r){var t=r.prog;if(t){var a=t.length,s;for(r.ip=0;r.ip<a;r.ip++){if(exports.DEBUG&&r.step++,s=Rm[t[r.ip]],!s)throw new Error("unknown instruction: 0x"+Number(t[r.ip]).toString(16));s(r)}}};function Ko(r){for(var t=r.tZone=new Array(r.gZone.length),a=0;a<t.length;a++)t[a]=new ar(0,0)}function Lm(r,t){var a=r.prog,s=r.ip,o=1,u;do if(u=a[++s],u===88)o++;else if(u===89)o--;else if(u===64)s+=a[s+1]+1;else if(u===65)s+=2*a[s+1]+1;else if(u>=176&&u<=183)s+=u-176+1;else if(u>=184&&u<=191)s+=(u-184+1)*2;else if(t&&o===1&&u===27)break;while(o>0);r.ip=s}function C0(r,t){exports.DEBUG&&console.log(t.step,"SVTCA["+r.axis+"]"),t.fv=t.pv=t.dpv=r}function M0(r,t){exports.DEBUG&&console.log(t.step,"SPVTCA["+r.axis+"]"),t.pv=t.dpv=r}function N0(r,t){exports.DEBUG&&console.log(t.step,"SFVTCA["+r.axis+"]"),t.fv=r}function R0(r,t){var a=t.stack,s=a.pop(),o=a.pop(),u=t.z2[s],f=t.z1[o];exports.DEBUG&&console.log("SPVTL["+r+"]",s,o);var h,d;r?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.pv=t.dpv=xl(h,d)}function D0(r,t){var a=t.stack,s=a.pop(),o=a.pop(),u=t.z2[s],f=t.z1[o];exports.DEBUG&&console.log("SFVTL["+r+"]",s,o);var h,d;r?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.fv=xl(h,d)}function Ob(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"SPVFS[]",a,s),r.pv=r.dpv=xl(s,a)}function kb(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"SPVFS[]",a,s),r.fv=xl(s,a)}function Lb(r){var t=r.stack,a=r.pv;exports.DEBUG&&console.log(r.step,"GPV[]"),t.push(a.x*16384),t.push(a.y*16384)}function Ub(r){var t=r.stack,a=r.fv;exports.DEBUG&&console.log(r.step,"GFV[]"),t.push(a.x*16384),t.push(a.y*16384)}function Ib(r){r.fv=r.pv,exports.DEBUG&&console.log(r.step,"SFVTPV[]")}function Bb(r){var t=r.stack,a=t.pop(),s=t.pop(),o=t.pop(),u=t.pop(),f=t.pop(),h=r.z0,d=r.z1,g=h[a],v=h[s],x=d[o],y=d[u],S=r.z2[f];exports.DEBUG&&console.log("ISECT[], ",a,s,o,u,f);var E=g.x,T=g.y,R=v.x,j=v.y,M=x.x,D=x.y,I=y.x,P=y.y,H=(E-R)*(D-P)-(T-j)*(M-I),ie=E*j-T*R,se=M*P-D*I;S.x=(ie*(M-I)-se*(E-R))/H,S.y=(ie*(D-P)-se*(T-j))/H}function Fb(r){r.rp0=r.stack.pop(),exports.DEBUG&&console.log(r.step,"SRP0[]",r.rp0)}function jb(r){r.rp1=r.stack.pop(),exports.DEBUG&&console.log(r.step,"SRP1[]",r.rp1)}function Gb(r){r.rp2=r.stack.pop(),exports.DEBUG&&console.log(r.step,"SRP2[]",r.rp2)}function Pb(r){var t=r.stack.pop();switch(exports.DEBUG&&console.log(r.step,"SZP0[]",t),r.zp0=t,t){case 0:r.tZone||Ko(r),r.z0=r.tZone;break;case 1:r.z0=r.gZone;break;default:throw new Error("Invalid zone pointer")}}function zb(r){var t=r.stack.pop();switch(exports.DEBUG&&console.log(r.step,"SZP1[]",t),r.zp1=t,t){case 0:r.tZone||Ko(r),r.z1=r.tZone;break;case 1:r.z1=r.gZone;break;default:throw new Error("Invalid zone pointer")}}function Hb(r){var t=r.stack.pop();switch(exports.DEBUG&&console.log(r.step,"SZP2[]",t),r.zp2=t,t){case 0:r.tZone||Ko(r),r.z2=r.tZone;break;case 1:r.z2=r.gZone;break;default:throw new Error("Invalid zone pointer")}}function Yb(r){var t=r.stack.pop();switch(exports.DEBUG&&console.log(r.step,"SZPS[]",t),r.zp0=r.zp1=r.zp2=t,t){case 0:r.tZone||Ko(r),r.z0=r.z1=r.z2=r.tZone;break;case 1:r.z0=r.z1=r.z2=r.gZone;break;default:throw new Error("Invalid zone pointer")}}function Vb(r){r.loop=r.stack.pop(),exports.DEBUG&&console.log(r.step,"SLOOP[]",r.loop)}function qb(r){exports.DEBUG&&console.log(r.step,"RTG[]"),r.round=Om}function Xb(r){exports.DEBUG&&console.log(r.step,"RTHG[]"),r.round=Nb}function Zb(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"SMD[]",t),r.minDis=t/64}function Qb(r){exports.DEBUG&&console.log(r.step,"ELSE[]"),Lm(r,!1)}function Kb(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"JMPR[]",t),r.ip+=t-1}function Wb(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"SCVTCI[]",t),r.cvCutIn=t/64}function $b(r){var t=r.stack;exports.DEBUG&&console.log(r.step,"DUP[]"),t.push(t[t.length-1])}function nf(r){exports.DEBUG&&console.log(r.step,"POP[]"),r.stack.pop()}function Jb(r){exports.DEBUG&&console.log(r.step,"CLEAR[]"),r.stack.length=0}function ex(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"SWAP[]"),t.push(a),t.push(s)}function tx(r){var t=r.stack;exports.DEBUG&&console.log(r.step,"DEPTH[]"),t.push(t.length)}function nx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"LOOPCALL[]",a,s);var o=r.ip,u=r.prog;r.prog=r.funcs[a];for(var f=0;f<s;f++)gi(r),exports.DEBUG&&console.log(++r.step,f+1<s?"next loopcall":"done loopcall",f);r.ip=o,r.prog=u}function ax(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"CALL[]",t);var a=r.ip,s=r.prog;r.prog=r.funcs[t],gi(r),r.ip=a,r.prog=s,exports.DEBUG&&console.log(++r.step,"returning from",t)}function rx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"CINDEX[]",a),t.push(t[t.length-a])}function ix(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"MINDEX[]",a),t.push(t.splice(t.length-a,1)[0])}function sx(r){if(r.env!=="fpgm")throw new Error("FDEF not allowed here");var t=r.stack,a=r.prog,s=r.ip,o=t.pop(),u=s;for(exports.DEBUG&&console.log(r.step,"FDEF[]",o);a[++s]!==45;);r.ip=s,r.funcs[o]=a.slice(u+1,s)}function _0(r,t){var a=t.stack.pop(),s=t.z0[a],o=t.fv,u=t.pv;exports.DEBUG&&console.log(t.step,"MDAP["+r+"]",a);var f=u.distance(s,gl);r&&(f=t.round(f)),o.setRelative(s,gl,f,u),o.touch(s),t.rp0=t.rp1=a}function O0(r,t){var a=t.z2,s=a.length-2,o,u,f;exports.DEBUG&&console.log(t.step,"IUP["+r.axis+"]");for(var h=0;h<s;h++)o=a[h],!r.touched(o)&&(u=o.prevTouched(r),u!==o&&(f=o.nextTouched(r),u===f&&r.setRelative(o,o,r.distance(u,u,!1,!0),r,!0),r.interpolate(o,u,f,r)))}function k0(r,t){for(var a=t.stack,s=r?t.rp1:t.rp2,o=(r?t.z0:t.z1)[s],u=t.fv,f=t.pv,h=t.loop,d=t.z2;h--;){var g=a.pop(),v=d[g],x=f.distance(o,o,!1,!0);u.setRelative(v,v,x,f),u.touch(v),exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-h)+": ":"")+"SHP["+(r?"rp1":"rp2")+"]",g)}t.loop=1}function L0(r,t){var a=t.stack,s=r?t.rp1:t.rp2,o=(r?t.z0:t.z1)[s],u=t.fv,f=t.pv,h=a.pop(),d=t.z2[t.contours[h]],g=d;exports.DEBUG&&console.log(t.step,"SHC["+r+"]",h);var v=f.distance(o,o,!1,!0);do g!==o&&u.setRelative(g,g,v,f),g=g.nextPointOnContour;while(g!==d)}function U0(r,t){var a=t.stack,s=r?t.rp1:t.rp2,o=(r?t.z0:t.z1)[s],u=t.fv,f=t.pv,h=a.pop();exports.DEBUG&&console.log(t.step,"SHZ["+r+"]",h);var d;switch(h){case 0:d=t.tZone;break;case 1:d=t.gZone;break;default:throw new Error("Invalid zone")}for(var g,v=f.distance(o,o,!1,!0),x=d.length-2,y=0;y<x;y++)g=d[y],u.setRelative(g,g,v,f)}function lx(r){for(var t=r.stack,a=r.loop,s=r.fv,o=t.pop()/64,u=r.z2;a--;){var f=t.pop(),h=u[f];exports.DEBUG&&console.log(r.step,(r.loop>1?"loop "+(r.loop-a)+": ":"")+"SHPIX[]",f,o),s.setRelative(h,h,o),s.touch(h)}r.loop=1}function ox(r){for(var t=r.stack,a=r.rp1,s=r.rp2,o=r.loop,u=r.z0[a],f=r.z1[s],h=r.fv,d=r.dpv,g=r.z2;o--;){var v=t.pop(),x=g[v];exports.DEBUG&&console.log(r.step,(r.loop>1?"loop "+(r.loop-o)+": ":"")+"IP[]",v,a,"<->",s),h.interpolate(x,u,f,d),h.touch(x)}r.loop=1}function I0(r,t){var a=t.stack,s=a.pop()/64,o=a.pop(),u=t.z1[o],f=t.z0[t.rp0],h=t.fv,d=t.pv;h.setRelative(u,f,s,d),h.touch(u),exports.DEBUG&&console.log(t.step,"MSIRP["+r+"]",s,o),t.rp1=t.rp0,t.rp2=o,r&&(t.rp0=o)}function ux(r){for(var t=r.stack,a=r.rp0,s=r.z0[a],o=r.loop,u=r.fv,f=r.pv,h=r.z1;o--;){var d=t.pop(),g=h[d];exports.DEBUG&&console.log(r.step,(r.loop>1?"loop "+(r.loop-o)+": ":"")+"ALIGNRP[]",d),u.setRelative(g,s,0,f),u.touch(g)}r.loop=1}function cx(r){exports.DEBUG&&console.log(r.step,"RTDG[]"),r.round=Mb}function B0(r,t){var a=t.stack,s=a.pop(),o=a.pop(),u=t.z0[o],f=t.fv,h=t.pv,d=t.cvt[s];exports.DEBUG&&console.log(t.step,"MIAP["+r+"]",s,"(",d,")",o);var g=h.distance(u,gl);r&&(Math.abs(g-d)<t.cvCutIn&&(g=d),g=t.round(g)),f.setRelative(u,gl,g,h),t.zp0===0&&(u.xo=u.x,u.yo=u.y),f.touch(u),t.rp0=t.rp1=o}function fx(r){var t=r.prog,a=r.ip,s=r.stack,o=t[++a];exports.DEBUG&&console.log(r.step,"NPUSHB[]",o);for(var u=0;u<o;u++)s.push(t[++a]);r.ip=a}function dx(r){var t=r.ip,a=r.prog,s=r.stack,o=a[++t];exports.DEBUG&&console.log(r.step,"NPUSHW[]",o);for(var u=0;u<o;u++){var f=a[++t]<<8|a[++t];f&32768&&(f=-((f^65535)+1)),s.push(f)}r.ip=t}function px(r){var t=r.stack,a=r.store;a||(a=r.store=[]);var s=t.pop(),o=t.pop();exports.DEBUG&&console.log(r.step,"WS",s,o),a[o]=s}function hx(r){var t=r.stack,a=r.store,s=t.pop();exports.DEBUG&&console.log(r.step,"RS",s);var o=a&&a[s]||0;t.push(o)}function mx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"WCVTP",a,s),r.cvt[s]=a/64}function gx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"RCVT",a),t.push(r.cvt[a]*64)}function F0(r,t){var a=t.stack,s=a.pop(),o=t.z2[s];exports.DEBUG&&console.log(t.step,"GC["+r+"]",s),a.push(t.dpv.distance(o,gl,r,!1)*64)}function j0(r,t){var a=t.stack,s=a.pop(),o=a.pop(),u=t.z1[s],f=t.z0[o],h=t.dpv.distance(f,u,r,r);exports.DEBUG&&console.log(t.step,"MD["+r+"]",s,o,"->",h),t.stack.push(Math.round(h*64))}function vx(r){exports.DEBUG&&console.log(r.step,"MPPEM[]"),r.stack.push(r.ppem)}function yx(r){exports.DEBUG&&console.log(r.step,"FLIPON[]"),r.autoFlip=!0}function bx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"LT[]",a,s),t.push(s<a?1:0)}function xx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"LTEQ[]",a,s),t.push(s<=a?1:0)}function Sx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"GT[]",a,s),t.push(s>a?1:0)}function Ex(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"GTEQ[]",a,s),t.push(s>=a?1:0)}function Ax(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"EQ[]",a,s),t.push(a===s?1:0)}function Tx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"NEQ[]",a,s),t.push(a!==s?1:0)}function wx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"ODD[]",a),t.push(Math.trunc(a)%2?1:0)}function Cx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"EVEN[]",a),t.push(Math.trunc(a)%2?0:1)}function Mx(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"IF[]",t),t||(Lm(r,!0),exports.DEBUG&&console.log(r.step,"EIF[]"))}function Nx(r){exports.DEBUG&&console.log(r.step,"EIF[]")}function Rx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"AND[]",a,s),t.push(a&&s?1:0)}function Dx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"OR[]",a,s),t.push(a||s?1:0)}function _x(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"NOT[]",a),t.push(a?0:1)}function af(r,t){var a=t.stack,s=a.pop(),o=t.fv,u=t.pv,f=t.ppem,h=t.deltaBase+(r-1)*16,d=t.deltaShift,g=t.z0;exports.DEBUG&&console.log(t.step,"DELTAP["+r+"]",s,a);for(var v=0;v<s;v++){var x=a.pop(),y=a.pop(),S=h+((y&240)>>4);if(S===f){var E=(y&15)-8;E>=0&&E++,exports.DEBUG&&console.log(t.step,"DELTAPFIX",x,"by",E*d);var T=g[x];o.setRelative(T,T,E*d,u)}}}function Ox(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"SDB[]",a),r.deltaBase=a}function kx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"SDS[]",a),r.deltaShift=Math.pow(.5,a)}function Lx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"ADD[]",a,s),t.push(s+a)}function Ux(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"SUB[]",a,s),t.push(s-a)}function Ix(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"DIV[]",a,s),t.push(s*64/a)}function Bx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"MUL[]",a,s),t.push(s*a/64)}function Fx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"ABS[]",a),t.push(Math.abs(a))}function jx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"NEG[]",a),t.push(-a)}function Gx(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"FLOOR[]",a),t.push(Math.floor(a/64)*64)}function Px(r){var t=r.stack,a=t.pop();exports.DEBUG&&console.log(r.step,"CEILING[]",a),t.push(Math.ceil(a/64)*64)}function Fo(r,t){var a=t.stack,s=a.pop();exports.DEBUG&&console.log(t.step,"ROUND[]"),a.push(t.round(s/64)*64)}function zx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"WCVTF[]",a,s),r.cvt[s]=a*r.ppem/r.font.unitsPerEm}function rf(r,t){var a=t.stack,s=a.pop(),o=t.ppem,u=t.deltaBase+(r-1)*16,f=t.deltaShift;exports.DEBUG&&console.log(t.step,"DELTAC["+r+"]",s,a);for(var h=0;h<s;h++){var d=a.pop(),g=a.pop(),v=u+((g&240)>>4);if(v===o){var x=(g&15)-8;x>=0&&x++;var y=x*f;exports.DEBUG&&console.log(t.step,"DELTACFIX",d,"by",y),t.cvt[d]+=y}}}function Hx(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"SROUND[]",t),r.round=km;var a;switch(t&192){case 0:a=.5;break;case 64:a=1;break;case 128:a=2;break;default:throw new Error("invalid SROUND value")}switch(r.srPeriod=a,t&48){case 0:r.srPhase=0;break;case 16:r.srPhase=.25*a;break;case 32:r.srPhase=.5*a;break;case 48:r.srPhase=.75*a;break;default:throw new Error("invalid SROUND value")}t&=15,t===0?r.srThreshold=0:r.srThreshold=(t/8-.5)*a}function Yx(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"S45ROUND[]",t),r.round=km;var a;switch(t&192){case 0:a=Math.sqrt(2)/2;break;case 64:a=Math.sqrt(2);break;case 128:a=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(r.srPeriod=a,t&48){case 0:r.srPhase=0;break;case 16:r.srPhase=.25*a;break;case 32:r.srPhase=.5*a;break;case 48:r.srPhase=.75*a;break;default:throw new Error("invalid S45ROUND value")}t&=15,t===0?r.srThreshold=0:r.srThreshold=(t/8-.5)*a}function Vx(r){exports.DEBUG&&console.log(r.step,"ROFF[]"),r.round=Cb}function qx(r){exports.DEBUG&&console.log(r.step,"RUTG[]"),r.round=Rb}function Xx(r){exports.DEBUG&&console.log(r.step,"RDTG[]"),r.round=Db}function Zx(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"SCANCTRL[]",t)}function G0(r,t){var a=t.stack,s=a.pop(),o=a.pop(),u=t.z2[s],f=t.z1[o];exports.DEBUG&&console.log(t.step,"SDPVTL["+r+"]",s,o);var h,d;r?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.dpv=xl(h,d)}function Qx(r){var t=r.stack,a=t.pop(),s=0;exports.DEBUG&&console.log(r.step,"GETINFO[]",a),a&1&&(s=35),a&32&&(s|=4096),t.push(s)}function Kx(r){var t=r.stack,a=t.pop(),s=t.pop(),o=t.pop();exports.DEBUG&&console.log(r.step,"ROLL[]"),t.push(s),t.push(a),t.push(o)}function Wx(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"MAX[]",a,s),t.push(Math.max(s,a))}function $x(r){var t=r.stack,a=t.pop(),s=t.pop();exports.DEBUG&&console.log(r.step,"MIN[]",a,s),t.push(Math.min(s,a))}function Jx(r){var t=r.stack.pop();exports.DEBUG&&console.log(r.step,"SCANTYPE[]",t)}function eS(r){var t=r.stack.pop(),a=r.stack.pop();switch(exports.DEBUG&&console.log(r.step,"INSTCTRL[]",t,a),t){case 1:r.inhibitGridFit=!!a;return;case 2:r.ignoreCvt=!!a;return;default:throw new Error("invalid INSTCTRL[] selector")}}function Ir(r,t){var a=t.stack,s=t.prog,o=t.ip;exports.DEBUG&&console.log(t.step,"PUSHB["+r+"]");for(var u=0;u<r;u++)a.push(s[++o]);t.ip=o}function Br(r,t){var a=t.ip,s=t.prog,o=t.stack;exports.DEBUG&&console.log(t.ip,"PUSHW["+r+"]");for(var u=0;u<r;u++){var f=s[++a]<<8|s[++a];f&32768&&(f=-((f^65535)+1)),o.push(f)}t.ip=a}function Ce(r,t,a,s,o,u){var f=u.stack,h=r&&f.pop(),d=f.pop(),g=u.rp0,v=u.z0[g],x=u.z1[d],y=u.minDis,S=u.fv,E=u.dpv,T,R,j,M;R=T=E.distance(x,v,!0,!0),j=R>=0?1:-1,R=Math.abs(R),r&&(M=u.cvt[h],s&&Math.abs(R-M)<u.cvCutIn&&(R=M)),a&&R<y&&(R=y),s&&(R=u.round(R)),S.setRelative(x,v,j*R,E),S.touch(x),exports.DEBUG&&console.log(u.step,(r?"MIRP[":"MDRP[")+(t?"M":"m")+(a?">":"_")+(s?"R":"_")+(o===0?"Gr":o===1?"Bl":o===2?"Wh":"")+"]",r?h+"("+u.cvt[h]+","+M+")":"",d,"(d =",T,"->",j*R,")"),u.rp1=u.rp0,u.rp2=d,t&&(u.rp0=d)}Rm=[C0.bind(void 0,nr),C0.bind(void 0,Ra),M0.bind(void 0,nr),M0.bind(void 0,Ra),N0.bind(void 0,nr),N0.bind(void 0,Ra),R0.bind(void 0,0),R0.bind(void 0,1),D0.bind(void 0,0),D0.bind(void 0,1),Ob,kb,Lb,Ub,Ib,Bb,Fb,jb,Gb,Pb,zb,Hb,Yb,Vb,qb,Xb,Zb,Qb,Kb,Wb,void 0,void 0,$b,nf,Jb,ex,tx,rx,ix,void 0,void 0,void 0,nx,ax,sx,void 0,_0.bind(void 0,0),_0.bind(void 0,1),O0.bind(void 0,nr),O0.bind(void 0,Ra),k0.bind(void 0,0),k0.bind(void 0,1),L0.bind(void 0,0),L0.bind(void 0,1),U0.bind(void 0,0),U0.bind(void 0,1),lx,ox,I0.bind(void 0,0),I0.bind(void 0,1),ux,cx,B0.bind(void 0,0),B0.bind(void 0,1),fx,dx,px,hx,mx,gx,F0.bind(void 0,0),F0.bind(void 0,1),void 0,j0.bind(void 0,0),j0.bind(void 0,1),vx,void 0,yx,void 0,void 0,bx,xx,Sx,Ex,Ax,Tx,wx,Cx,Mx,Nx,Rx,Dx,_x,af.bind(void 0,1),Ox,kx,Lx,Ux,Ix,Bx,Fx,jx,Gx,Px,Fo.bind(void 0,0),Fo.bind(void 0,1),Fo.bind(void 0,2),Fo.bind(void 0,3),void 0,void 0,void 0,void 0,zx,af.bind(void 0,2),af.bind(void 0,3),rf.bind(void 0,1),rf.bind(void 0,2),rf.bind(void 0,3),Hx,Yx,void 0,void 0,Vx,void 0,qx,Xx,nf,nf,void 0,void 0,void 0,void 0,void 0,Zx,G0.bind(void 0,0),G0.bind(void 0,1),Qx,void 0,Kx,Wx,$x,Jx,eS,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ir.bind(void 0,1),Ir.bind(void 0,2),Ir.bind(void 0,3),Ir.bind(void 0,4),Ir.bind(void 0,5),Ir.bind(void 0,6),Ir.bind(void 0,7),Ir.bind(void 0,8),Br.bind(void 0,1),Br.bind(void 0,2),Br.bind(void 0,3),Br.bind(void 0,4),Br.bind(void 0,5),Br.bind(void 0,6),Br.bind(void 0,7),Br.bind(void 0,8),Ce.bind(void 0,0,0,0,0,0),Ce.bind(void 0,0,0,0,0,1),Ce.bind(void 0,0,0,0,0,2),Ce.bind(void 0,0,0,0,0,3),Ce.bind(void 0,0,0,0,1,0),Ce.bind(void 0,0,0,0,1,1),Ce.bind(void 0,0,0,0,1,2),Ce.bind(void 0,0,0,0,1,3),Ce.bind(void 0,0,0,1,0,0),Ce.bind(void 0,0,0,1,0,1),Ce.bind(void 0,0,0,1,0,2),Ce.bind(void 0,0,0,1,0,3),Ce.bind(void 0,0,0,1,1,0),Ce.bind(void 0,0,0,1,1,1),Ce.bind(void 0,0,0,1,1,2),Ce.bind(void 0,0,0,1,1,3),Ce.bind(void 0,0,1,0,0,0),Ce.bind(void 0,0,1,0,0,1),Ce.bind(void 0,0,1,0,0,2),Ce.bind(void 0,0,1,0,0,3),Ce.bind(void 0,0,1,0,1,0),Ce.bind(void 0,0,1,0,1,1),Ce.bind(void 0,0,1,0,1,2),Ce.bind(void 0,0,1,0,1,3),Ce.bind(void 0,0,1,1,0,0),Ce.bind(void 0,0,1,1,0,1),Ce.bind(void 0,0,1,1,0,2),Ce.bind(void 0,0,1,1,0,3),Ce.bind(void 0,0,1,1,1,0),Ce.bind(void 0,0,1,1,1,1),Ce.bind(void 0,0,1,1,1,2),Ce.bind(void 0,0,1,1,1,3),Ce.bind(void 0,1,0,0,0,0),Ce.bind(void 0,1,0,0,0,1),Ce.bind(void 0,1,0,0,0,2),Ce.bind(void 0,1,0,0,0,3),Ce.bind(void 0,1,0,0,1,0),Ce.bind(void 0,1,0,0,1,1),Ce.bind(void 0,1,0,0,1,2),Ce.bind(void 0,1,0,0,1,3),Ce.bind(void 0,1,0,1,0,0),Ce.bind(void 0,1,0,1,0,1),Ce.bind(void 0,1,0,1,0,2),Ce.bind(void 0,1,0,1,0,3),Ce.bind(void 0,1,0,1,1,0),Ce.bind(void 0,1,0,1,1,1),Ce.bind(void 0,1,0,1,1,2),Ce.bind(void 0,1,0,1,1,3),Ce.bind(void 0,1,1,0,0,0),Ce.bind(void 0,1,1,0,0,1),Ce.bind(void 0,1,1,0,0,2),Ce.bind(void 0,1,1,0,0,3),Ce.bind(void 0,1,1,0,1,0),Ce.bind(void 0,1,1,0,1,1),Ce.bind(void 0,1,1,0,1,2),Ce.bind(void 0,1,1,0,1,3),Ce.bind(void 0,1,1,1,0,0),Ce.bind(void 0,1,1,1,0,1),Ce.bind(void 0,1,1,1,0,2),Ce.bind(void 0,1,1,1,0,3),Ce.bind(void 0,1,1,1,1,0),Ce.bind(void 0,1,1,1,1,1),Ce.bind(void 0,1,1,1,1,2),Ce.bind(void 0,1,1,1,1,3)];function us(r){this.char=r,this.state={},this.activeState=null}function Nf(r,t,a){this.contextName=a,this.startIndex=r,this.endOffset=t}function tS(r,t,a){this.contextName=r,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=a}function va(r,t){this.context=r,this.index=t,this.length=r.length,this.current=r[t],this.backtrack=r.slice(0,t),this.lookahead=r.slice(t+1)}function Wo(r){this.eventId=r,this.subscribers=[]}function nS(r){var t=this,a=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];a.forEach(function(o){Object.defineProperty(t.events,o,{value:new Wo(o)})}),r&&a.forEach(function(o){var u=r[o];typeof u=="function"&&t.events[o].subscribe(u)});var s=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];s.forEach(function(o){t.events[o].subscribe(t.updateContextsRanges)})}function Ct(r){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],nS.call(this,r)}us.prototype.setState=function(r,t){return this.state[r]=t,this.activeState={key:r,value:this.state[r]},this.activeState};us.prototype.getState=function(r){return this.state[r]||null};Ct.prototype.inboundIndex=function(r){return r>=0&&r<this.tokens.length};Ct.prototype.composeRUD=function(r){var t=this,a=!0,s=r.map(function(u){return t[u[0]].apply(t,u.slice(1).concat(a))}),o=function(u){return typeof u=="object"&&u.hasOwnProperty("FAIL")};if(s.every(o))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:s.filter(o)};this.dispatch("composeRUD",[s.filter(function(u){return!o(u)})])};Ct.prototype.replaceRange=function(r,t,a,s){t=t!==null?t:this.tokens.length;var o=a.every(function(f){return f instanceof us});if(!isNaN(r)&&this.inboundIndex(r)&&o){var u=this.tokens.splice.apply(this.tokens,[r,t].concat(a));return s||this.dispatch("replaceToken",[r,t,a]),[u,a]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};Ct.prototype.replaceToken=function(r,t,a){if(!isNaN(r)&&this.inboundIndex(r)&&t instanceof us){var s=this.tokens.splice(r,1,t);return a||this.dispatch("replaceToken",[r,t]),[s[0],t]}else return{FAIL:"replaceToken: invalid token or index."}};Ct.prototype.removeRange=function(r,t,a){t=isNaN(t)?this.tokens.length:t;var s=this.tokens.splice(r,t);return a||this.dispatch("removeRange",[s,r,t]),s};Ct.prototype.removeToken=function(r,t){if(!isNaN(r)&&this.inboundIndex(r)){var a=this.tokens.splice(r,1);return t||this.dispatch("removeToken",[a,r]),a}else return{FAIL:"removeToken: invalid token index."}};Ct.prototype.insertToken=function(r,t,a){var s=r.every(function(o){return o instanceof us});return s?(this.tokens.splice.apply(this.tokens,[t,0].concat(r)),a||this.dispatch("insertToken",[r,t]),r):{FAIL:"insertToken: invalid token(s)."}};Ct.prototype.registerModifier=function(r,t,a){this.events.newToken.subscribe(function(s,o){var u=[s,o],f=t===null||t.apply(this,u)===!0,h=[s,o];if(f){var d=a.apply(this,h);s.setState(r,d)}}),this.registeredModifiers.push(r)};Wo.prototype.subscribe=function(r){return typeof r=="function"?this.subscribers.push(r)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};Wo.prototype.unsubscribe=function(r){this.subscribers.splice(r,1)};va.prototype.setCurrentIndex=function(r){this.index=r,this.current=this.context[r],this.backtrack=this.context.slice(0,r),this.lookahead=this.context.slice(r+1)};va.prototype.get=function(r){switch(!0){case r===0:return this.current;case(r<0&&Math.abs(r)<=this.backtrack.length):return this.backtrack.slice(r)[0];case(r>0&&r<=this.lookahead.length):return this.lookahead[r-1];default:return null}};Ct.prototype.rangeToText=function(r){if(r instanceof Nf)return this.getRangeTokens(r).map(function(t){return t.char}).join("")};Ct.prototype.getText=function(){return this.tokens.map(function(r){return r.char}).join("")};Ct.prototype.getContext=function(r){var t=this.registeredContexts[r];return t||null};Ct.prototype.on=function(r,t){var a=this.events[r];return a?a.subscribe(t):null};Ct.prototype.dispatch=function(r,t){var a=this,s=this.events[r];s instanceof Wo&&s.subscribers.forEach(function(o){o.apply(a,t||[])})};Ct.prototype.registerContextChecker=function(r,t,a){if(this.getContext(r))return{FAIL:"context name '"+r+"' is already registered."};if(typeof t!="function")return{FAIL:"missing context start check."};if(typeof a!="function")return{FAIL:"missing context end check."};var s=new tS(r,t,a);return this.registeredContexts[r]=s,this.contextCheckers.push(s),s};Ct.prototype.getRangeTokens=function(r){var t=r.startIndex+r.endOffset;return[].concat(this.tokens.slice(r.startIndex,t))};Ct.prototype.getContextRanges=function(r){var t=this.getContext(r);return t?t.ranges:{FAIL:"context checker '"+r+"' is not registered."}};Ct.prototype.resetContextsRanges=function(){var r=this.registeredContexts;for(var t in r)if(r.hasOwnProperty(t)){var a=r[t];a.ranges=[]}};Ct.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var r=this.tokens.map(function(s){return s.char}),t=0;t<r.length;t++){var a=new va(r,t);this.runContextCheck(a)}this.dispatch("updateContextsRanges",[this.registeredContexts])};Ct.prototype.setEndOffset=function(r,t){var a=this.getContext(t).openRange.startIndex,s=new Nf(a,r,t),o=this.getContext(t).ranges;return s.rangeId=t+"."+o.length,o.push(s),this.getContext(t).openRange=null,s};Ct.prototype.runContextCheck=function(r){var t=this,a=r.index;this.contextCheckers.forEach(function(s){var o=s.contextName,u=t.getContext(o).openRange;if(!u&&s.checkStart(r)&&(u=new Nf(a,null,o),t.getContext(o).openRange=u,t.dispatch("contextStart",[o,a])),u&&s.checkEnd(r)){var f=a-u.startIndex+1,h=t.setEndOffset(f,o);t.dispatch("contextEnd",[o,h])}})};Ct.prototype.tokenize=function(r){this.tokens=[],this.resetContextsRanges();var t=Array.from(r);this.dispatch("start");for(var a=0;a<t.length;a++){var s=t[a],o=new va(t,a);this.dispatch("next",[o]),this.runContextCheck(o);var u=new us(s);this.tokens.push(u),this.dispatch("newToken",[u,o])}return this.dispatch("end",[this.tokens]),this.tokens};function Gr(r){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(r)}function Um(r){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(r)}function zr(r){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(r)}function zo(r){return/[A-z]/.test(r)}function aS(r){return/\s/.test(r)}function Pn(r){this.font=r,this.features={}}function mi(r){this.id=r.id,this.tag=r.tag,this.substitution=r.substitution}function Sl(r,t){if(!r)return-1;switch(t.format){case 1:return t.glyphs.indexOf(r);case 2:for(var a=t.ranges,s=0;s<a.length;s++){var o=a[s];if(r>=o.start&&r<=o.end){var u=r-o.start;return o.index+u}}break;default:return-1}return-1}function rS(r,t){var a=Sl(r,t.coverage);return a===-1?null:r+t.deltaGlyphId}function iS(r,t){var a=Sl(r,t.coverage);return a===-1?null:t.substitute[a]}function sf(r,t){for(var a=[],s=0;s<r.length;s++){var o=r[s],u=t.current;u=Array.isArray(u)?u[0]:u;var f=Sl(u,o);f!==-1&&a.push(f)}return a.length!==r.length?-1:a}function sS(r,t){var a=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(r.context.length<a)return[];var s=sf(t.inputCoverage,r);if(s===-1)return[];var o=t.inputCoverage.length-1;if(r.lookahead.length<t.lookaheadCoverage.length)return[];for(var u=r.lookahead.slice(o);u.length&&zr(u[0].char);)u.shift();var f=new va(u,0),h=sf(t.lookaheadCoverage,f),d=[].concat(r.backtrack);for(d.reverse();d.length&&zr(d[0].char);)d.shift();if(d.length<t.backtrackCoverage.length)return[];var g=new va(d,0),v=sf(t.backtrackCoverage,g),x=s.length===t.inputCoverage.length&&h.length===t.lookaheadCoverage.length&&v.length===t.backtrackCoverage.length,y=[];if(x)for(var S=0;S<t.lookupRecords.length;S++)for(var E=t.lookupRecords[S],T=E.lookupListIndex,R=this.getLookupByIndex(T),j=0;j<R.subtables.length;j++){var M=R.subtables[j],D=this.getLookupMethod(R,M),I=this.getSubstitutionType(R,M);if(I==="12")for(var P=0;P<s.length;P++){var H=r.get(P),ie=D(H);ie&&y.push(ie)}}return y}function lS(r,t){var a=r.current,s=Sl(a,t.coverage);if(s===-1)return null;for(var o,u=t.ligatureSets[s],f=0;f<u.length;f++){o=u[f];for(var h=0;h<o.components.length;h++){var d=r.lookahead[h],g=o.components[h];if(d!==g)break;if(h===o.components.length-1)return o}}return null}function oS(r,t){var a=Sl(r,t.coverage);return a===-1?null:t.sequences[a]}Pn.prototype.getDefaultScriptFeaturesIndexes=function(){for(var r=this.font.tables.gsub.scripts,t=0;t<r.length;t++){var a=r[t];if(a.tag==="DFLT")return a.script.defaultLangSys.featureIndexes}return[]};Pn.prototype.getScriptFeaturesIndexes=function(r){var t=this.font.tables;if(!t.gsub)return[];if(!r)return this.getDefaultScriptFeaturesIndexes();for(var a=this.font.tables.gsub.scripts,s=0;s<a.length;s++){var o=a[s];if(o.tag===r&&o.script.defaultLangSys)return o.script.defaultLangSys.featureIndexes;var u=o.langSysRecords;if(u)for(var f=0;f<u.length;f++){var h=u[f];if(h.tag===r){var d=h.langSys;return d.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};Pn.prototype.mapTagsToFeatures=function(r,t){for(var a={},s=0;s<r.length;s++){var o=r[s].tag,u=r[s].feature;a[o]=u}this.features[t].tags=a};Pn.prototype.getScriptFeatures=function(r){var t=this.features[r];if(this.features.hasOwnProperty(r))return t;var a=this.getScriptFeaturesIndexes(r);if(!a)return null;var s=this.font.tables.gsub;return t=a.map(function(o){return s.features[o]}),this.features[r]=t,this.mapTagsToFeatures(t,r),t};Pn.prototype.getSubstitutionType=function(r,t){var a=r.lookupType.toString(),s=t.substFormat.toString();return a+s};Pn.prototype.getLookupMethod=function(r,t){var a=this,s=this.getSubstitutionType(r,t);switch(s){case"11":return function(o){return rS.apply(a,[o,t])};case"12":return function(o){return iS.apply(a,[o,t])};case"63":return function(o){return sS.apply(a,[o,t])};case"41":return function(o){return lS.apply(a,[o,t])};case"21":return function(o){return oS.apply(a,[o,t])};default:throw new Error("lookupType: "+r.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}};Pn.prototype.lookupFeature=function(r){var t=r.contextParams,a=t.index,s=this.getFeature({tag:r.tag,script:r.script});if(!s)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+r.tag+"' for script '"+r.script+"'.");for(var o=this.getFeatureLookups(s),u=[].concat(t.context),f=0;f<o.length;f++)for(var h=o[f],d=this.getLookupSubtables(h),g=0;g<d.length;g++){var v=d[g],x=this.getSubstitutionType(h,v),y=this.getLookupMethod(h,v),S=void 0;switch(x){case"11":S=y(t.current),S&&u.splice(a,1,new mi({id:11,tag:r.tag,substitution:S}));break;case"12":S=y(t.current),S&&u.splice(a,1,new mi({id:12,tag:r.tag,substitution:S}));break;case"63":S=y(t),Array.isArray(S)&&S.length&&u.splice(a,1,new mi({id:63,tag:r.tag,substitution:S}));break;case"41":S=y(t),S&&u.splice(a,1,new mi({id:41,tag:r.tag,substitution:S}));break;case"21":S=y(t.current),S&&u.splice(a,1,new mi({id:21,tag:r.tag,substitution:S}));break}t=new va(u,a),!(Array.isArray(S)&&!S.length)&&(S=null)}return u.length?u:null};Pn.prototype.supports=function(r){if(!r.script)return!1;this.getScriptFeatures(r.script);var t=this.features.hasOwnProperty(r.script);if(!r.tag)return t;var a=this.features[r.script].some(function(s){return s.tag===r.tag});return t&&a};Pn.prototype.getLookupSubtables=function(r){return r.subtables||null};Pn.prototype.getLookupByIndex=function(r){var t=this.font.tables.gsub.lookups;return t[r]||null};Pn.prototype.getFeatureLookups=function(r){return r.lookupListIndexes.map(this.getLookupByIndex.bind(this))};Pn.prototype.getFeature=function(t){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script);var a=this.features[t.script];return a?a.tags[t.tag]?this.features[t.script].tags[t.tag]:null:{FAIL:"No feature for script "+t.script}};function uS(r){var t=r.current,a=r.get(-1);return a===null&&Gr(t)||!Gr(a)&&Gr(t)}function cS(r){var t=r.get(1);return t===null||!Gr(t)}var fS={startCheck:uS,endCheck:cS};function dS(r){var t=r.current,a=r.get(-1);return(Gr(t)||zr(t))&&!Gr(a)}function pS(r){var t=r.get(1);switch(!0){case t===null:return!0;case(!Gr(t)&&!zr(t)):var a=aS(t);if(!a)return!0;if(a){var s=!1;if(s=r.lookahead.some(function(o){return Gr(o)||zr(o)}),!s)return!0}break;default:return!1}}var hS={startCheck:dS,endCheck:pS};function mS(r,t,a){t[a].setState(r.tag,r.substitution)}function gS(r,t,a){t[a].setState(r.tag,r.substitution)}function vS(r,t,a){r.substitution.forEach(function(s,o){var u=t[a+o];u.setState(r.tag,s)})}function yS(r,t,a){var s=t[a];s.setState(r.tag,r.substitution.ligGlyph);for(var o=r.substitution.components.length,u=0;u<o;u++)s=t[a+u+1],s.setState("deleted",!0)}var P0={11:mS,12:gS,63:vS,41:yS};function Rf(r,t,a){r instanceof mi&&P0[r.id]&&P0[r.id](r,t,a)}function bS(r){for(var t=[].concat(r.backtrack),a=t.length-1;a>=0;a--){var s=t[a],o=Um(s),u=zr(s);if(!o&&!u)return!0;if(o)return!1}return!1}function xS(r){if(Um(r.current))return!1;for(var t=0;t<r.lookahead.length;t++){var a=r.lookahead[t],s=zr(a);if(!s)return!0}return!1}function SS(r){var t=this,a="arab",s=this.featuresTags[a],o=this.tokenizer.getRangeTokens(r);if(o.length!==1){var u=new va(o.map(function(h){return h.getState("glyphIndex")}),0),f=new va(o.map(function(h){return h.char}),0);o.forEach(function(h,d){if(!zr(h.char)){u.setCurrentIndex(d),f.setCurrentIndex(d);var g=0;bS(f)&&(g|=1),xS(f)&&(g|=2);var v;switch(g){case 1:v="fina";break;case 2:v="init";break;case 3:v="medi";break}if(s.indexOf(v)!==-1){var x=t.query.lookupFeature({tag:v,script:a,contextParams:u});if(x instanceof Error)return console.info(x.message);x.forEach(function(y,S){y instanceof mi&&(Rf(y,o,S),u.context[S]=y.substitution)})}}})}}function z0(r,t){var a=r.map(function(s){return s.activeState.value});return new va(a,0)}function ES(r){var t=this,a="arab",s=this.tokenizer.getRangeTokens(r),o=z0(s);o.context.forEach(function(u,f){o.setCurrentIndex(f);var h=t.query.lookupFeature({tag:"rlig",script:a,contextParams:o});h.length&&(h.forEach(function(d){return Rf(d,s,f)}),o=z0(s))})}function AS(r){var t=r.current,a=r.get(-1);return a===null&&zo(t)||!zo(a)&&zo(t)}function TS(r){var t=r.get(1);return t===null||!zo(t)}var wS={startCheck:AS,endCheck:TS};function H0(r,t){var a=r.map(function(s){return s.activeState.value});return new va(a,0)}function CS(r){var t=this,a="latn",s=this.tokenizer.getRangeTokens(r),o=H0(s);o.context.forEach(function(u,f){o.setCurrentIndex(f);var h=t.query.lookupFeature({tag:"liga",script:a,contextParams:o});h.length&&(h.forEach(function(d){return Rf(d,s,f)}),o=H0(s))})}function ba(r){this.baseDir=r||"ltr",this.tokenizer=new Ct,this.featuresTags={}}ba.prototype.setText=function(r){this.text=r};ba.prototype.contextChecks={latinWordCheck:wS,arabicWordCheck:fS,arabicSentenceCheck:hS};function lf(r){var t=this.contextChecks[r+"Check"];return this.tokenizer.registerContextChecker(r,t.startCheck,t.endCheck)}function MS(){return lf.call(this,"latinWord"),lf.call(this,"arabicWord"),lf.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function NS(){var r=this,t=this.tokenizer.getContextRanges("arabicSentence");t.forEach(function(a){var s=r.tokenizer.getRangeTokens(a);r.tokenizer.replaceRange(a.startIndex,a.endOffset,s.reverse())})}ba.prototype.registerFeatures=function(r,t){var a=this,s=t.filter(function(o){return a.query.supports({script:r,tag:o})});this.featuresTags.hasOwnProperty(r)?this.featuresTags[r]=this.featuresTags[r].concat(s):this.featuresTags[r]=s};ba.prototype.applyFeatures=function(r,t){if(!r)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Pn(r));for(var a=0;a<t.length;a++){var s=t[a];this.query.supports({script:s.script})&&this.registerFeatures(s.script,s.tags)}};ba.prototype.registerModifier=function(r,t,a){this.tokenizer.registerModifier(r,t,a)};function Df(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function RS(){var r=this,t="arab";if(this.featuresTags.hasOwnProperty(t)){Df.call(this);var a=this.tokenizer.getContextRanges("arabicWord");a.forEach(function(s){SS.call(r,s)})}}function DS(){var r=this,t="arab";if(this.featuresTags.hasOwnProperty(t)){var a=this.featuresTags[t];if(a.indexOf("rlig")!==-1){Df.call(this);var s=this.tokenizer.getContextRanges("arabicWord");s.forEach(function(o){ES.call(r,o)})}}}function _S(){var r=this,t="latn";if(this.featuresTags.hasOwnProperty(t)){var a=this.featuresTags[t];if(a.indexOf("liga")!==-1){Df.call(this);var s=this.tokenizer.getContextRanges("latinWord");s.forEach(function(o){CS.call(r,o)})}}}ba.prototype.checkContextReady=function(r){return!!this.tokenizer.getContext(r)};ba.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(RS.call(this),DS.call(this)),this.checkContextReady("latinWord")&&_S.call(this),this.checkContextReady("arabicSentence")&&NS.call(this)};ba.prototype.processText=function(r){(!this.text||this.text!==r)&&(this.setText(r),MS.call(this),this.applyFeaturesToContexts())};ba.prototype.getBidiText=function(r){return this.processText(r),this.tokenizer.getText()};ba.prototype.getTextGlyphs=function(r){this.processText(r);for(var t=[],a=0;a<this.tokenizer.tokens.length;a++){var s=this.tokenizer.tokens[a];if(!s.state.deleted){var o=s.activeState.value;t.push(Array.isArray(o)?o[0]:o)}}return t};function mt(r){r=r||{},r.tables=r.tables||{},r.empty||(cl(r.familyName,"When creating a new Font object, familyName is required."),cl(r.styleName,"When creating a new Font object, styleName is required."),cl(r.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),cl(r.ascender,"When creating a new Font object, ascender is required."),cl(r.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:r.familyName||" "},fontSubfamily:{en:r.styleName||" "},fullName:{en:r.fullName||r.familyName+" "+r.styleName},postScriptName:{en:r.postScriptName||(r.familyName+r.styleName).replace(/\s/g,"")},designer:{en:r.designer||" "},designerURL:{en:r.designerURL||" "},manufacturer:{en:r.manufacturer||" "},manufacturerURL:{en:r.manufacturerURL||" "},license:{en:r.license||" "},licenseURL:{en:r.licenseURL||" "},version:{en:r.version||"Version 0.1"},description:{en:r.description||" "},copyright:{en:r.copyright||" "},trademark:{en:r.trademark||" "}},this.unitsPerEm=r.unitsPerEm||1e3,this.ascender=r.ascender,this.descender=r.descender,this.createdTimestamp=r.createdTimestamp,this.tables=Object.assign(r.tables,{os2:Object.assign({usWeightClass:r.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:r.widthClass||this.usWidthClasses.MEDIUM,fsSelection:r.fsSelection||this.fsSelectionValues.REGULAR},r.tables.os2)})),this.supported=!0,this.glyphs=new Da.GlyphSet(this,r.glyphs||[]),this.encoding=new dm(this),this.position=new yl(this),this.substitution=new Gn(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new _m(this)}})}mt.prototype.hasChar=function(r){return this.encoding.charToGlyphIndex(r)!==null};mt.prototype.charToGlyphIndex=function(r){return this.encoding.charToGlyphIndex(r)};mt.prototype.charToGlyph=function(r){var t=this.charToGlyphIndex(r),a=this.glyphs.get(t);return a||(a=this.glyphs.get(0)),a};mt.prototype.updateFeatures=function(r){return this.defaultRenderOptions.features.map(function(t){return t.script==="latn"?{script:"latn",tags:t.tags.filter(function(a){return r[a]})}:t})};mt.prototype.stringToGlyphs=function(r,t){var a=this,s=new ba,o=function(x){return a.charToGlyphIndex(x.char)};s.registerModifier("glyphIndex",null,o);var u=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;s.applyFeatures(this,u);for(var f=s.getTextGlyphs(r),h=f.length,d=new Array(h),g=this.glyphs.get(0),v=0;v<h;v+=1)d[v]=this.glyphs.get(f[v])||g;return d};mt.prototype.nameToGlyphIndex=function(r){return this.glyphNames.nameToGlyphIndex(r)};mt.prototype.nameToGlyph=function(r){var t=this.nameToGlyphIndex(r),a=this.glyphs.get(t);return a||(a=this.glyphs.get(0)),a};mt.prototype.glyphIndexToName=function(r){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(r):""};mt.prototype.getKerningValue=function(r,t){r=r.index||r,t=t.index||t;var a=this.position.defaultKerningTables;return a?this.position.getKerningValue(a,r,t):this.kerningPairs[r+","+t]||0};mt.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};mt.prototype.forEachGlyph=function(r,t,a,s,o,u){t=t!==void 0?t:0,a=a!==void 0?a:0,s=s!==void 0?s:72,o=Object.assign({},this.defaultRenderOptions,o);var f=1/this.unitsPerEm*s,h=this.stringToGlyphs(r,o),d;if(o.kerning){var g=o.script||this.position.getDefaultScriptName();d=this.position.getKerningTables(g,o.language)}for(var v=0;v<h.length;v+=1){var x=h[v];if(u.call(this,x,t,a,s,o),x.advanceWidth&&(t+=x.advanceWidth*f),o.kerning&&v<h.length-1){var y=d?this.position.getKerningValue(d,x.index,h[v+1].index):this.getKerningValue(x,h[v+1]);t+=y*f}o.letterSpacing?t+=o.letterSpacing*s:o.tracking&&(t+=o.tracking/1e3*s)}return t};mt.prototype.getPath=function(r,t,a,s,o){var u=new Ht;return this.forEachGlyph(r,t,a,s,o,function(f,h,d,g){var v=f.getPath(h,d,g,o,this);u.extend(v)}),u};mt.prototype.getPaths=function(r,t,a,s,o){var u=[];return this.forEachGlyph(r,t,a,s,o,function(f,h,d,g){var v=f.getPath(h,d,g,o,this);u.push(v)}),u};mt.prototype.getAdvanceWidth=function(r,t,a){return this.forEachGlyph(r,0,0,t,a,function(){})};mt.prototype.draw=function(r,t,a,s,o,u){this.getPath(t,a,s,o,u).draw(r)};mt.prototype.drawPoints=function(r,t,a,s,o,u){this.forEachGlyph(t,a,s,o,u,function(f,h,d,g){f.drawPoints(r,h,d,g)})};mt.prototype.drawMetrics=function(r,t,a,s,o,u){this.forEachGlyph(t,a,s,o,u,function(f,h,d,g){f.drawMetrics(r,h,d,g)})};mt.prototype.getEnglishName=function(r){var t=this.names[r];if(t)return t.en};mt.prototype.validate=function(){var r=this;function t(s,o){}function a(s){var o=r.getEnglishName(s);o&&o.trim().length>0}a("fontFamily"),a("weightName"),a("manufacturer"),a("copyright"),a("version"),this.unitsPerEm>0};mt.prototype.toTables=function(){return vb.fontToTable(this)};mt.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};mt.prototype.toArrayBuffer=function(){for(var r=this.toTables(),t=r.encode(),a=new ArrayBuffer(t.length),s=new Uint8Array(a),o=0;o<t.length;o++)s[o]=t[o];return a};mt.prototype.download=function(r){var t=this.getEnglishName("fontFamily"),a=this.getEnglishName("fontSubfamily");r=r||t.replace(/\s/g,"")+"-"+a+".otf";var s=this.toArrayBuffer();if(bb())if(window.URL=window.URL||window.webkitURL,window.URL){var o=new DataView(s),u=new Blob([o],{type:"font/opentype"}),f=document.createElement("a");f.href=window.URL.createObjectURL(u),f.download=r;var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!1),f.dispatchEvent(h)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var d=require("fs"),g=xb(s);d.writeFileSync(r,g)}};mt.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};mt.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};mt.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var rr=new Array(10);rr[1]=function(){var t=this.offset+this.relativeOffset,a=this.parseUShort();if(a===1)return{posFormat:1,coverage:this.parsePointer(te.coverage),value:this.parseValueRecord()};if(a===2)return{posFormat:2,coverage:this.parsePointer(te.coverage),values:this.parseValueRecordList()};Ge.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};rr[2]=function(){var t=this.offset+this.relativeOffset,a=this.parseUShort();Ge.assert(a===1||a===2,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var s=this.parsePointer(te.coverage),o=this.parseUShort(),u=this.parseUShort();if(a===1)return{posFormat:a,coverage:s,valueFormat1:o,valueFormat2:u,pairSets:this.parseList(te.pointer(te.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(o),value2:this.parseValueRecord(u)}})))};if(a===2){var f=this.parsePointer(te.classDef),h=this.parsePointer(te.classDef),d=this.parseUShort(),g=this.parseUShort();return{posFormat:a,coverage:s,valueFormat1:o,valueFormat2:u,classDef1:f,classDef2:h,class1Count:d,class2Count:g,classRecords:this.parseList(d,te.list(g,function(){return{value1:this.parseValueRecord(o),value2:this.parseValueRecord(u)}}))}}};rr[3]=function(){return{error:"GPOS Lookup 3 not supported"}};rr[4]=function(){return{error:"GPOS Lookup 4 not supported"}};rr[5]=function(){return{error:"GPOS Lookup 5 not supported"}};rr[6]=function(){return{error:"GPOS Lookup 6 not supported"}};rr[7]=function(){return{error:"GPOS Lookup 7 not supported"}};rr[8]=function(){return{error:"GPOS Lookup 8 not supported"}};rr[9]=function(){return{error:"GPOS Lookup 9 not supported"}};new Array(10);const Y0=()=>Math.random().toString(36).substr(2,9),OS=Pr.memo(({playbackFps:r,onSpeedChange:t})=>{const a=s=>{s.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_speed",targetType:"global",label:"SPEED",min:1,max:120,step:1}))};return m.jsxs("div",{className:"master-speed-slider",draggable:!0,onDragStart:a,children:[m.jsxs("label",{htmlFor:"masterSpeedRange",children:[r," FPS"]}),m.jsx(yt,{id:"master_speed",children:m.jsx("input",{type:"range",min:"1",max:"120",value:r,className:"slider_hor",id:"masterSpeedRange",onChange:s=>t(parseInt(s.target.value))})})]})}),kS=Pr.memo(({isWorldOutputActive:r,onToggleWorldOutput:t})=>{const a=s=>{s.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"laser_output",targetType:"global",label:"LASER"}))};return m.jsx("div",{className:"container",draggable:!0,onDragStart:a,children:m.jsx(yt,{id:"laser_output",children:m.jsx("input",{type:"checkbox",checked:r,onChange:t})})})}),dl=(r,t,a,s)=>!Array.isArray(r)||r.length!==t?Array(t).fill(null).map((o,u)=>Array(a).fill(null).map((f,h)=>s(u,h))):r.map((o,u)=>!Array.isArray(o)||o.length!==a?Array(a).fill(null).map((f,h)=>s(u,h)):o),Im=r=>({columns:Array.from({length:8},(t,a)=>`Col ${a+1}`),layers:Array.from({length:5},(t,a)=>`Layer ${a+1}`),clipContents:dl(r?.clipContents,5,8,()=>({parsing:!1})),clipNames:dl(r?.clipNames,5,8,(t,a)=>`Clip ${t+1}-${a+1}`),thumbnailFrameIndexes:Array(5).fill(null).map(()=>Array(8).fill(0)),layerEffects:Array(5).fill([]),layerAssignedDacs:r?.layerAssignedDacs??Array(5).fill([]),layerIntensities:Array(5).fill(1),layerAutopilots:Array(5).fill("off"),layerBlackouts:Array(5).fill(!1),layerSolos:Array(5).fill(!1),masterIntensity:1,globalBlackout:!1,selectedLayerIndex:null,selectedColIndex:null,notification:{message:"",visible:!1},dacs:[],selectedDac:r?.dacAssignment?.selectedDac??r?.selectedDac??null,ildaFrames:[],selectedIldaWorkerId:null,selectedIldaTotalFrames:0,bpm:r?.bpm??120,showBeamEffect:r?.renderSettings?.showBeamEffect??!0,beamAlpha:r?.renderSettings?.beamAlpha??.1,fadeAlpha:r?.renderSettings?.fadeAlpha??.13,playbackFps:r?.renderSettings?.playbackFps??60,previewScanRate:r?.renderSettings?.previewScanRate??1,beamRenderMode:r?.renderSettings?.beamRenderMode??"both",worldShowBeamEffect:r?.renderSettings?.worldShowBeamEffect??!0,worldBeamRenderMode:r?.renderSettings?.worldBeamRenderMode??"both",activeClipIndexes:Array(5).fill(null),isPlaying:!1,isStopped:!0,isWorldOutputActive:!1,thumbnailRenderMode:r?.thumbnailRenderMode??"still",theme:r?.theme??"orange",projectLoadTimestamp:null,clipClipboard:null,dacOutputSettings:r?.dacOutputSettings??{},quickAssigns:{knobs:Array(8).fill(null).map(()=>({value:0,label:null,link:null})),buttons:Array(8).fill(null).map(()=>({value:!1,label:null,link:null}))}});function LS(r,t){switch(t.type){case"SET_DAC_OUTPUT_SETTINGS":return{...r,dacOutputSettings:{...r.dacOutputSettings,[t.payload.id]:t.payload.settings}};case"SET_COLUMNS":return{...r,columns:t.payload};case"SET_COLUMN_NAME":{const a=[...r.columns];return a[t.payload.index]=t.payload.name,{...r,columns:a}}case"SET_LAYERS":return{...r,layers:t.payload};case"SET_LAYER_NAME":{const a=[...r.layers];return a[t.payload.index]=t.payload.name,{...r,layers:a}}case"SET_CLIP_CONTENT":{const a=[...r.clipContents];if(!a[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),r;a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s=a[t.payload.layerIndex][t.payload.colIndex]||{};return a[t.payload.layerIndex][t.payload.colIndex]={...s,...t.payload.content},{...r,clipContents:a}}case"SET_CLIP_NAME":{const a=[...r.clipNames];return a[t.payload.layerIndex]=[...a[t.payload.layerIndex]],a[t.payload.layerIndex][t.payload.colIndex]=t.payload.name,{...r,clipNames:a}}case"SET_THUMBNAIL_FRAME_INDEX":{const a=[...r.thumbnailFrameIndexes];return a[t.payload.layerIndex][t.payload.colIndex]=t.payload.index,{...r,thumbnailFrameIndexes:a}}case"ADD_LAYER_EFFECT":{const a=[...r.layerEffects],s={...t.payload.effect,instanceId:Y0(),params:{...t.payload.effect.defaultParams}};return a[t.payload.layerIndex].push(s),{...r,layerEffects:a}}case"ADD_CLIP_EFFECT":{const a=[...r.clipContents];if(!a[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),r;a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s=a[t.payload.layerIndex][t.payload.colIndex]||{},o={...t.payload.effect,instanceId:Y0(),params:{...t.payload.effect.defaultParams}},u={...s,effects:[...s.effects||[],o]};return a[t.payload.layerIndex][t.payload.colIndex]=u,{...r,clipContents:a}}case"SET_SELECTED_CLIP":return{...r,selectedLayerIndex:t.payload.layerIndex,selectedColIndex:t.payload.colIndex};case"SET_NOTIFICATION":return{...r,notification:t.payload};case"SET_ILDA_FRAMES":return{...r,ildaFrames:t.payload};case"SET_SELECTED_ILDA_DATA":return{...r,selectedIldaWorkerId:t.payload.workerId,selectedIldaTotalFrames:t.payload.totalFrames,selectedGeneratorId:t.payload.generatorId,selectedGeneratorParams:t.payload.generatorParams};case"SET_ACTIVE_CLIP":{const a=[...r.activeClipIndexes];return a[t.payload.layerIndex]=t.payload.colIndex,{...r,activeClipIndexes:a}}case"CLEAR_CLIP":{const a=[...r.clipContents];a[t.payload.layerIndex]=[...a[t.payload.layerIndex]],a[t.payload.layerIndex][t.payload.colIndex]=null;const s=[...r.clipNames];s[t.payload.layerIndex][t.payload.colIndex]=`Clip ${t.payload.layerIndex+1}-${t.payload.colIndex+1}`;const o=[...r.thumbnailFrameIndexes];o[t.payload.layerIndex][t.payload.colIndex]=0;const u=[...r.activeClipIndexes];return u[t.payload.layerIndex]===t.payload.colIndex&&(u[t.payload.layerIndex]=null),r.selectedLayerIndex===t.payload.layerIndex&&r.selectedColIndex===t.payload.colIndex?{...r,clipContents:a,clipNames:s,thumbnailFrameIndexes:o,activeClipIndexes:u,selectedLayerIndex:null,selectedColIndex:null,selectedIldaWorkerId:null,selectedIldaTotalFrames:0,selectedGeneratorId:null,selectedGeneratorParams:{}}:{...r,clipContents:a,clipNames:s,thumbnailFrameIndexes:o,activeClipIndexes:u}}case"DEACTIVATE_LAYER_CLIPS":{const a=[...r.activeClipIndexes];return a[t.payload.layerIndex]=null,{...r,activeClipIndexes:a}}case"CLEAR_ALL_ACTIVE_CLIPS":return{...r,activeClipIndexes:Array(r.layers.length).fill(null)};case"SET_LAYER_INTENSITY":{const a=[...r.layerIntensities];return a[t.payload.layerIndex]=t.payload.intensity,{...r,layerIntensities:a}}case"SET_LAYER_AUTOPILOT":{const a=[...r.layerAutopilots];return a[t.payload.layerIndex]=t.payload.mode,{...r,layerAutopilots:a}}case"TOGGLE_LAYER_BLACKOUT":{const a=[...r.layerBlackouts];return a[t.payload.layerIndex]=!a[t.payload.layerIndex],{...r,layerBlackouts:a}}case"TOGGLE_LAYER_SOLO":{const a=[...r.layerSolos],s=a[t.payload.layerIndex];return a.fill(!1),s||(a[t.payload.layerIndex]=!0),{...r,layerSolos:a}}case"SET_MASTER_INTENSITY":return{...r,masterIntensity:t.payload};case"TOGGLE_GLOBAL_BLACKOUT":return{...r,globalBlackout:!r.globalBlackout};case"SET_RENDER_SETTING":return{...r,[t.payload.setting]:t.payload.value};case"REMOVE_CLIP_EFFECT":{const a=[...r.clipContents];a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s={...a[t.payload.layerIndex][t.payload.colIndex]};if(s&&s.effects){const o=[...s.effects];o.splice(t.payload.effectIndex,1),s.effects=o,a[t.payload.layerIndex][t.payload.colIndex]=s}return{...r,clipContents:a}}case"REORDER_CLIP_EFFECTS":{const{layerIndex:a,colIndex:s,oldIndex:o,newIndex:u}=t.payload,f=[...r.clipContents];f[a]=[...f[a]];const h={...f[a][s]};if(h&&h.effects){const d=[...h.effects],[g]=d.splice(o,1);d.splice(u,0,g),h.effects=d,f[a][s]=h}return{...r,clipContents:f}}case"REMOVE_LAYER_EFFECT":{const a=[...r.layerEffects];return a[t.payload.layerIndex]&&(a[t.payload.layerIndex]=[...a[t.payload.layerIndex]],a[t.payload.layerIndex].splice(t.payload.effectIndex,1)),{...r,layerEffects:a}}case"UPDATE_LAYER_EFFECT_PARAMETER":{const a=[...r.layerEffects];if(a[t.payload.layerIndex]){a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s=t.payload.effectIndex;if(a[t.payload.layerIndex][s]){const o={...a[t.payload.layerIndex][s]};o.params={...o.params,[t.payload.paramName]:t.payload.newValue},a[t.payload.layerIndex][s]=o}}return{...r,layerEffects:a}}case"UPDATE_EFFECT_PARAMETER":{const a=[...r.clipContents];a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s={...a[t.payload.layerIndex][t.payload.colIndex]};if(s&&s.effects){const o=[...s.effects],u={...o[t.payload.effectIndex]};u.params={...u.params,[t.payload.paramName]:t.payload.newValue},o[t.payload.effectIndex]=u,s.effects=o,a[t.payload.layerIndex][t.payload.colIndex]=s}return{...r,clipContents:a}}case"UPDATE_CLIP_PLAYBACK_SETTINGS":{const a=[...r.clipContents];a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s={...a[t.payload.layerIndex][t.payload.colIndex]};return s&&(s.playbackSettings={...s.playbackSettings||{mode:"fps",duration:1,beats:8,speedMultiplier:1},...t.payload.settings},a[t.payload.layerIndex][t.payload.colIndex]=s),{...r,clipContents:a}}case"SET_CLIP_PARAM_SYNC":{const{layerIndex:a,colIndex:s,paramId:o,syncMode:u}=t.payload,f=[...r.clipContents];f[a]=[...f[a]];const h={...f[a][s]};if(h){const d=h.syncSettings||{},g=d[o]===u?null:u;h.syncSettings={...d,[o]:g},f[a][s]=h}return{...r,clipContents:f}}case"UPDATE_GENERATOR_PARAM":{const a=[...r.clipContents];a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s={...a[t.payload.layerIndex][t.payload.colIndex]};return s&&s.type==="generator"&&s.currentParams&&(s.currentParams={...s.currentParams,[t.payload.paramName]:t.payload.newValue},a[t.payload.layerIndex][t.payload.colIndex]=s,r.selectedLayerIndex===t.payload.layerIndex&&r.selectedColIndex===t.payload.colIndex)?{...r,clipContents:a,selectedGeneratorParams:s.currentParams}:{...r,clipContents:a}}case"SET_DACS":return{...r,dacs:t.payload};case"SET_BPM":return{...r,bpm:t.payload};case"SET_SELECTED_DAC":return{...r,selectedDac:t.payload};case"SET_IS_PLAYING":return{...r,isPlaying:t.payload};case"SET_IS_STOPPED":return{...r,isStopped:t.payload};case"SET_WORLD_OUTPUT_ACTIVE":return{...r,isWorldOutputActive:t.payload};case"TOGGLE_WORLD_OUTPUT_ACTIVE":return{...r,isWorldOutputActive:!r.isWorldOutputActive};case"SET_CLIPBOARD":return{...r,clipClipboard:t.payload};case"SET_CLIP_DAC":{const a=[...r.clipContents];if(!a[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),r;a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const s=a[t.payload.layerIndex][t.payload.colIndex]||{};let o=s.assignedDacs||[];const u=[],f=d=>{const{channels:g,allChannels:v,...x}=d;return x};if(t.payload.dac.allChannels&&t.payload.dac.channels)t.payload.dac.channels.forEach(d=>{o.some(g=>g.ip===t.payload.dac.ip&&g.channel===d.serviceID)||u.push({...f(t.payload.dac),channel:d.serviceID,mirrorX:!1,mirrorY:!1})});else{const d=t.payload.dac.channel;d!==void 0&&!o.some(g=>g.ip===t.payload.dac.ip&&g.channel===d)&&u.push({...f(t.payload.dac),channel:d,mirrorX:!1,mirrorY:!1})}if(u.length===0)return r;const h={...s,assignedDacs:[...o,...u]};return a[t.payload.layerIndex][t.payload.colIndex]=h,{...r,clipContents:a}}case"SET_LAYER_DAC":{const{layerIndex:a,dac:s}=t.payload,o=[...r.layerAssignedDacs],u=o[a]||[];let f=[];const h=d=>{const{channels:g,allChannels:v,...x}=d;return x};if(s.allChannels&&s.channels)s.channels.forEach(d=>{u.some(g=>g.ip===s.ip&&g.channel===d.serviceID)||f.push({...h(s),channel:d.serviceID,mirrorX:!1,mirrorY:!1})});else{const d=s.channel;d!==void 0&&!u.some(g=>g.ip===s.ip&&g.channel===d)&&f.push({...h(s),channel:d,mirrorX:!1,mirrorY:!1})}return f.length===0?r:(o[a]=[...u,...f],{...r,layerAssignedDacs:o})}case"TOGGLE_CLIP_DAC_MIRROR":{const{layerIndex:a,colIndex:s,dacIndex:o,axis:u}=t.payload,f=[...r.clipContents];f[a]=[...f[a]];const h={...f[a][s]};if(h&&h.assignedDacs){const d=[...h.assignedDacs],g={...d[o]};return u==="x"&&(g.mirrorX=!g.mirrorX),u==="y"&&(g.mirrorY=!g.mirrorY),d[o]=g,h.assignedDacs=d,f[a][s]=h,{...r,clipContents:f}}return r}case"REMOVE_CLIP_DAC":{const a=[...r.clipContents];a[t.payload.layerIndex]=[...a[t.payload.layerIndex]];const{layerIndex:s,colIndex:o,dacIndex:u}=t.payload,f=a[s][o];if(f&&f.assignedDacs){const h=[...f.assignedDacs];return h.splice(u,1),a[t.payload.layerIndex][t.payload.colIndex]={...f,assignedDacs:h},{...r,clipContents:a}}return r}case"TOGGLE_LAYER_DAC_MIRROR":{const{layerIndex:a,dacIndex:s,axis:o}=t.payload,u=[...r.layerAssignedDacs],f=u[a]?[...u[a]]:[];if(f[s]){const h={...f[s]};return o==="x"&&(h.mirrorX=!h.mirrorX),o==="y"&&(h.mirrorY=!h.mirrorY),f[s]=h,u[a]=f,{...r,layerAssignedDacs:u}}return r}case"REMOVE_LAYER_DAC":{const{layerIndex:a,dacIndex:s}=t.payload,o=[...r.layerAssignedDacs];if(o[a]){const u=[...o[a]];return u.splice(s,1),o[a]=u,{...r,layerAssignedDacs:o}}return r}case"SET_CLIP_AUDIO":{const a=[...r.clipContents],{layerIndex:s,colIndex:o,audioFile:u}=t.payload;a[s]=[...a[s]];const f=a[s][o];return f?(a[s][o]={...f,audioFile:u,audioVolume:f.audioVolume!==void 0?f.audioVolume:1},{...r,clipContents:a}):r}case"SET_CLIP_AUDIO_VOLUME":{const a=[...r.clipContents],{layerIndex:s,colIndex:o,volume:u}=t.payload;a[s]=[...a[s]];const f=a[s][o];return f?(a[s][o]={...f,audioVolume:u},{...r,clipContents:a}):r}case"REMOVE_CLIP_AUDIO":{const a=[...r.clipContents],{layerIndex:s,colIndex:o}=t.payload;a[s]=[...a[s]];const u=a[s][o];return u?(a[s][o]={...u,audioFile:null},{...r,clipContents:a}):r}case"SET_CLIP_PARSING_STATUS":{const{layerIndex:a,colIndex:s,status:o}=t.payload,u=[...r.clipContents];u[a]=[...u[a]];const f=u[a][s]||{};return u[a][s]={...f,parsing:o},{...r,clipContents:u}}case"SET_BULK_PARSING_STATUS":{const a=[...r.clipContents];return new Set(t.payload.map(o=>o.layerIndex)).forEach(o=>{a[o]&&(a[o]=[...a[o]])}),t.payload.forEach(({layerIndex:o,colIndex:u,status:f})=>{if(a[o]){const h=a[o][u]||{};a[o][u]={...h,parsing:f}}}),{...r,clipContents:a}}case"SET_THUMBNAIL_RENDER_MODE":return{...r,thumbnailRenderMode:t.payload};case"SET_CLIP_TRIGGER_STYLE":{const{layerIndex:a,colIndex:s,style:o}=t.payload,u=[...r.clipContents];u[a]=[...u[a]];const f=u[a][s]||{};return u[a][s]={...f,triggerStyle:o},{...r,clipContents:u}}case"SET_THEME":return{...r,theme:t.payload};case"UPDATE_THUMBNAIL":{const{layerIndex:a,colIndex:s,frameIndex:o}=t.payload,u=[...r.thumbnailFrameIndexes];return u[a]=[...u[a]],u[a][s]=o,{...r,thumbnailFrameIndexes:u}}case"RESET_STATE":return Im({});case"LOAD_PROJECT":{const a={...r,...t.payload};return a.clipContents=dl(a.clipContents,5,8,()=>({parsing:!1})),a.clipNames=dl(a.clipNames,5,8,(s,o)=>`Clip ${s+1}-${o+1}`),a.clipContents=a.clipContents.map(s=>s.map(o=>o&&o.type==="ilda"?{...o,workerId:null,parsing:!1}:o)),a.activeClipIndexes=Array(r.layers.length).fill(null),a.selectedLayerIndex=null,a.selectedColIndex=null,a.selectedIldaWorkerId=null,a.selectedIldaTotalFrames=0,a.selectedGeneratorId=null,a.selectedGeneratorParams={},a.projectLoadTimestamp=Date.now(),a}case"LOAD_SETTINGS":return{...r,showBeamEffect:t.payload.renderSettings?.showBeamEffect??r.showBeamEffect,beamAlpha:t.payload.renderSettings?.beamAlpha??r.beamAlpha,fadeAlpha:t.payload.renderSettings?.fadeAlpha??r.fadeAlpha,playbackFps:t.payload.renderSettings?.playbackFps??r.playbackFps,previewScanRate:t.payload.renderSettings?.previewScanRate??r.previewScanRate,beamRenderMode:t.payload.renderSettings?.beamRenderMode??r.beamRenderMode,theme:t.payload.theme??r.theme,thumbnailRenderMode:t.payload.thumbnailRenderMode??r.thumbnailRenderMode,selectedDac:t.payload.selectedDac??r.selectedDac,clipNames:t.payload.clipNames?dl(t.payload.clipNames,5,8,(a,s)=>`Clip ${a+1}-${s+1}`):r.clipNames,dacOutputSettings:t.payload.dacOutputSettings??r.dacOutputSettings};case"ASSIGN_QUICK_CONTROL":{const{type:a,index:s,link:o}=t.payload,u={knobs:[...r.quickAssigns.knobs],buttons:[...r.quickAssigns.buttons]},f=a==="knob"?"knobs":"buttons";return u[f][s]={...u[f][s],label:o.paramName||o.paramId,link:o,min:o.min,max:o.max,step:o.step},{...r,quickAssigns:u}}case"UPDATE_QUICK_CONTROL":{const{type:a,index:s,value:o}=t.payload,u={knobs:[...r.quickAssigns.knobs],buttons:[...r.quickAssigns.buttons]},f=a==="knob"?"knobs":"buttons",h=u[f][s];u[f][s]={...h,value:o};let d={...r,quickAssigns:u};if(h.link){const{layerIndex:g,colIndex:v,effectIndex:x,targetType:y}=h.link,S=h.link.paramName||h.link.paramId;let E=o;if(a==="knob"&&h.min!==void 0&&h.max!==void 0&&(E=h.min+o*(h.max-h.min),h.step&&(E=Math.round(E/h.step)*h.step),E=parseFloat(E.toFixed(5))),console.log(`Updating ${y} param ${S} to ${E} (Link: L${g} C${v} E${x})`),y==="layerEffect"){const T=[...d.layerEffects];if(T[g]&&(T[g]=[...T[g]],T[g][x])){const R={...T[g][x]};R.params={...R.params,[S]:E},T[g][x]=R,d={...d,layerEffects:T}}}else if(y==="global")S==="master_intensity"?d={...d,masterIntensity:E}:S==="master_speed"&&(d={...d,playbackFps:E});else{const T=[...d.clipContents];if(T[g]){T[g]=[...T[g]];const R=T[g][v];if(R)if(y==="effect"&&R.effects&&R.effects[x]){const j=[...R.effects],M={...j[x]};M.params={...M.params,[S]:E},j[x]=M,T[g][v]={...R,effects:j}}else y==="generator"&&(T[g][v]={...R,currentParams:{...R.currentParams,[S]:E}});d.clipContents=T}}}return d}case"TOGGLE_QUICK_BUTTON":{const{index:a}=t.payload,o=!r.quickAssigns.buttons[a].value,u={...r.quickAssigns,buttons:[...r.quickAssigns.buttons]};u.buttons[a]={...u.buttons[a],value:o};let f={...r,quickAssigns:u};const h=u.buttons[a];if(h.link){const{layerIndex:d,colIndex:g,effectIndex:v,paramName:x,targetType:y}=h.link;if(y==="layer"){if(x==="blackout"){const S=[...f.layerBlackouts];S[d]=o,f={...f,layerBlackouts:S}}else if(x==="solo"){const S=[...f.layerSolos];o?(S.fill(!1),S[d]=!0):S[d]=!1,f={...f,layerSolos:S}}else if(x==="clear"){if(o){const S=[...f.activeClipIndexes];S[d]=null,f={...f,activeClipIndexes:S},u.buttons[a].value=!1,f.quickAssigns=u}}else if(x==="autopilot"){const S=[...f.layerAutopilots];S[d]=o?"forward":"off",f={...f,layerAutopilots:S}}}else{const S=[...f.clipContents];if(S[d]){S[d]=[...S[d]];const E=S[d][g];if(E)if(y==="effect"&&E.effects&&E.effects[v]){const T=[...E.effects],R={...T[v]};R.params={...R.params,[x]:o},T[v]=R,S[d][g]={...E,effects:T}}else y==="generator"&&(S[d][g]={...E,currentParams:{...E.currentParams,[x]:o}});f.clipContents=S}}}return f}case"UPDATE_CLIP_FILE_PATH":{const{oldPath:a,newPath:s}=t.payload,o=r.clipContents.map(u=>u.map(f=>f&&f.filePath===a?{...f,filePath:s,parsingFailed:!1}:f));return{...r,clipContents:o}}case"SET_CLIP_PARSING_FAILED":{const{layerIndex:a,colIndex:s,failed:o}=t.payload,u=[...r.clipContents];if(u[a]){u[a]=[...u[a]];const f=u[a][s];f&&(u[a][s]={...f,parsingFailed:o})}return{...r,clipContents:u}}default:return r}}const jo={orange:{full:60,dim:10},yellow:{full:74,dim:15},cyan:{full:36,dim:35},"light-blue":{full:41,dim:43},blue:{full:45,dim:47},magenta:{full:53,dim:55},red:{full:5,dim:7},green:{full:21,dim:23},white:{full:3,dim:1}},US=({isPlaying:r,globalBlackout:t,layerBlackouts:a,layerSolos:s,isWorldOutputActive:o,clipContents:u,activeClipIndexes:f,theme:h,bpm:d,quickAssigns:g})=>{const{sendFeedback:v,mappings:x,selectedMidiInputId:y,midiInitialized:S}=Qo();return C.useEffect(()=>{if(!y||!S||!r){S&&y&&Go(y,"F#6",0,1);return}let E=!1;const T=6e4/(d||120),R=setInterval(()=>{E=!E,Go(y,"F#6",E?127:0,1)},T/2);return()=>{clearInterval(R),Go(y,"F#6",0,1)}},[r,d,y,S]),C.useEffect(()=>{v("transport_play",r),v("transport_stop",!r)},[r,v]),C.useEffect(()=>{v("comp_blackout",t)},[t,v]),C.useEffect(()=>{v("laser_output",o)},[o,v]),C.useEffect(()=>{a.forEach((E,T)=>{v(`layer_${T}_blackout`,E)})},[a,v]),C.useEffect(()=>{s.forEach((E,T)=>{v(`layer_${T}_solo`,E)})},[s,v]),C.useEffect(()=>{if(!u||!f)return;const E=jo[h]||jo.orange;u.forEach((T,R)=>{T.forEach((j,M)=>{const D=`clip_${R}_${M}`;if(x[D]){const I=f[R]===M,P=j!==null&&(j.type==="ilda"||j.type==="generator"),H=j?.triggerStyle||"normal";let ie=0,se=null;I?(ie=E.full,H==="toggle"&&(se=10)):P&&(ie=E.dim),v(D,ie,se)}})})},[u,f,h,x,v]),C.useEffect(()=>{if(!g)return;const E=jo[h]||jo.orange;g.buttons.forEach((T,R)=>{v(`quick_btn_${R}`,T.value?E.full:0)})},[g,h,v]),null},V0=async(r,t,a,s)=>{if(!r||!r.points)return null;let o=r;try{t&&t.length>0&&(o=pl(r,t,{progress:0,time:0,effectStates:{},assignedDacs:[]}))}catch(E){console.warn("Failed to apply effects for thumbnail:",E)}const u=128,f=128,h=document.createElement("canvas");h.width=u,h.height=f;const d=h.getContext("2d");d.fillStyle="#000000",d.fillRect(0,0,u,f);const g=o.points,v=o.isTypedArray||g instanceof Float32Array,x=v?g.length/8:g.length;d.lineWidth=1.5,d.lineCap="round";let y=null,S=null;for(let E=0;E<x;E++){let T,R,j,M,D,I;if(v)T=g[E*8],R=g[E*8+1],j=g[E*8+3],M=g[E*8+4],D=g[E*8+5],I=g[E*8+6]>.5;else{const ie=g[E];T=ie.x,R=ie.y,j=ie.r,M=ie.g,D=ie.b,I=ie.blanking}const P=(T+1)*.5*u,H=(1-(R+1)*.5)*f;if(!I&&y!==null){d.beginPath(),d.moveTo(y,S),d.lineTo(P,H);const ie=Math.floor(Math.max(0,Math.min(1,j))*255),se=Math.floor(Math.max(0,Math.min(1,M))*255),de=Math.floor(Math.max(0,Math.min(1,D))*255);d.strokeStyle=`rgb(${ie},${se},${de})`,d.stroke()}y=P,S=H}try{const T=await(await new Promise(R=>h.toBlob(R,"image/png"))).arrayBuffer();if(window.electronAPI&&window.electronAPI.saveThumbnail){const R=`thumb_L${a}_C${s}.png`;return await window.electronAPI.saveThumbnail(T,R)}}catch(E){console.error("Error generating/saving thumbnail:",E)}return null};function IS(){const r=Ry(),t=Oy(),a=C.useRef(null),{fftLevels:s}=Af()||{};C.useEffect(()=>{const _=new Worker(new URL(""+new URL("ui-generators.worker-EkgwJKrR.js",import.meta.url).href,import.meta.url),{type:"module"});a.current=_;const w=L=>{if(L.data.layerIndex!==void 0&&L.data.colIndex!==void 0){const k=`${L.data.layerIndex}-${L.data.colIndex}`;if(Ua.current.set(k,!1),Ia.current.has(k)){const{message:q,transferables:he}=Ia.current.get(k);Ia.current.delete(k),console.log(`[App.jsx] UI Generator ${k} free, processing pending seq ${q.seq}`),Ua.current.set(k,!0),_.postMessage(q,he)}}if(L.data.success){const{layerIndex:k,colIndex:q,frames:he,generatorDefinition:J,currentParams:Te,isLive:_e,seq:Pe}=L.data;if(Pe!==void 0){if(Pe<Zr.current)return;Zr.current=Pe}const gt=`generator-${k}-${q}`;if(y.current[gt]=he[0],!_e){z({type:"SET_CLIP_CONTENT",payload:{layerIndex:k,colIndex:q,content:{type:"generator",generatorDefinition:J,frames:he,currentParams:Te,playbackSettings:{mode:"timeline",duration:5,beats:8,speedMultiplier:1}}}});const Rt=xn.current[k][q],Dt=`Clip ${k+1}-${q+1}`;Rt===Dt&&z({type:"SET_CLIP_NAME",payload:{layerIndex:k,colIndex:q,name:J.name}})}}else jt(`UI Generator error: ${L.data.error}`)};return _.addEventListener("message",w),()=>{_.removeEventListener("message",w),_.terminate()}},[]);const{playAudio:o,stopAudio:u,pauseAllAudio:f,resumeAllAudio:h,setPlaybackRate:d,resetAllAudio:g,stopAllAudio:v,getAudioInfo:x}=am();C.useRef(new Set),C.useRef(0);const y=C.useRef({}),S=C.useRef(new Map),E=C.useRef({}),[T,R]=C.useState(0),j=C.useRef({}),M=C.useRef({}),[D,I]=C.useState(null),[P,H]=C.useState(!1),[ie,se]=C.useState(!1),[de,ne]=C.useState({midi:!1,artnet:!1,osc:!1,keyboard:!1}),[Z,ee]=C.useState(!1),[ae,$]=C.useState(!1),[re,B]=C.useState(!1),[U,le]=C.useState(!1),[ve,N]=C.useState({title:"",initialValue:"",onSave:()=>{}}),[V,oe]=C.useState("files"),[W,z]=C.useReducer(LS,Im(P?D:{})),{columns:be,layers:ge,clipContents:xe,clipNames:He,thumbnailFrameIndexes:Lt,layerEffects:Kt,layerAssignedDacs:Cn,layerIntensities:sn,layerAutopilots:_a,layerBlackouts:vn,layerSolos:zn,masterIntensity:Oa,globalBlackout:et,selectedLayerIndex:Ne,selectedColIndex:We,notification:Wt,dacs:ia,selectedDac:$t,ildaFrames:$o,selectedIldaWorkerId:sa,selectedIldaTotalFrames:cs,showBeamEffect:Hn,beamAlpha:Mt,fadeAlpha:ln,playbackFps:St,previewScanRate:ka,beamRenderMode:xa,worldShowBeamEffect:Jo,worldBeamRenderMode:vi,activeClipIndexes:dt,isPlaying:Jt,isWorldOutputActive:Mn,selectedGeneratorId:yi,selectedGeneratorParams:_f,thumbnailRenderMode:fs,theme:Yr,dacOutputSettings:on}=W,Nn=C.useMemo(()=>ge.map((_,w)=>{const L=dt[w];if(L!==null){const k=xe[w][L];if(k){let q,he=null;if(k.type==="ilda"&&k.workerId&&k.totalFrames)return q=k.workerId,he=k.stillFrame,{type:"ilda",workerId:q,totalFrames:k.totalFrames,effects:k.effects||[],dac:k.dac||null,assignedDacs:k.assignedDacs||[],ildaFormat:k.ildaFormat||0,stillFrame:he,layerIndex:w,syncSettings:k.syncSettings||{},fps:k.fps||null};if(k.type==="generator"&&k.frames&&k.generatorDefinition)return q=`generator-${w}-${L}`,he=k.stillFrame||k.frames?.[0]||null,{type:"generator",workerId:q,totalFrames:k.frames.length,effects:k.effects||[],dac:k.dac||null,assignedDacs:k.assignedDacs||[],ildaFormat:0,stillFrame:he,layerIndex:w,syncSettings:k.syncSettings||{},fps:k.fps||null}}}return null}).filter(Boolean),[ge,dt,xe]),yn=C.useRef(xe),Nt=C.useRef(null),Yn=C.useRef(!1),bn=C.useRef(null),Vr=C.useRef(!1);C.useEffect(()=>{xe&&(Nt.current=structuredClone(xe))},[]),C.useEffect(()=>{on&&(bn.current=structuredClone(on))},[]);const ds=C.useRef(sn),El=C.useRef(_a),la=C.useRef(Kt),Ft=C.useRef(Oa),en=C.useRef(vn),Sa=C.useRef(zn),bi=C.useRef(et),xi=C.useRef(on),Al=C.useRef(ia),Si=C.useRef([]),Rn=C.useRef(dt),Ei=C.useRef(Cn),xn=C.useRef(He),Ea=C.useRef(sa),qr=C.useRef(cs),La=C.useRef({}),bt=C.useRef(new Map),Ai=C.useRef(new Map),Xr=C.useRef(null),Vn=C.useRef({}),Sn=C.useRef(null),ir=C.useRef(0),Zr=C.useRef(0),Ua=C.useRef(new Map),Ia=C.useRef(new Map),sr=C.useRef(performance.now());C.useEffect(()=>{if(Yn.current){Yn.current=!1;return}xe&&(Nt.current=structuredClone(xe))},[xe]),C.useEffect(()=>{if(Vr.current){Vr.current=!1;return}on&&(bn.current=structuredClone(on))},[on]),C.useEffect(()=>{ds.current=sn,El.current=_a,la.current=Kt,Ft.current=Oa,en.current=vn,Sa.current=zn,bi.current=et,Al.current=ia,Si.current=Nn,yn.current=xe,Rn.current=dt,Ei.current=Cn,xn.current=He,Ea.current=sa,qr.current=cs},[sn,Cn,_a,Kt,Oa,vn,zn,et,on,ia,Nn,xe,dt,He,sa,cs]);const Ti=C.useCallback(_=>{const w=1-_*2,L=[],k=100;for(let q=0;q<k;q++){const he=q/(k-1)*2-1;L.push({x:he,y:w,r:0,g:255,b:0,blanking:!1})}return{points:L,isTypedArray:!1}},[]),qn=C.useCallback((_,w)=>{bn.current&&(bn.current[_]=w,Vr.current=!0),z({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:_,settings:w}})},[]),Qr=C.useCallback(_=>{z({type:"SET_RENDER_SETTING",payload:{setting:"playbackFps",value:_}})},[]);C.useEffect(()=>{const _=St/60;d(_)},[St,d]);const jt=_=>{z({type:"SET_NOTIFICATION",payload:{message:_,visible:!0}}),setTimeout(()=>{z({type:"SET_NOTIFICATION",payload:{message:"",visible:!1}})},3e3)};C.useEffect(()=>{const _={orange:"#ff5e00",yellow:"#ffd400",cyan:"#00fff3","light-blue":"#0089ff",blue:"#005aff",magenta:"#fb00ff",red:"#ff0000",green:"#00ff00",white:"#ffffff"},w=_[Yr]||_.orange;document.documentElement.style.setProperty("--theme-color",w);const L=parseInt(w.slice(1,3),16),k=parseInt(w.slice(3,5),16),q=parseInt(w.slice(5,7),16);document.documentElement.style.setProperty("--theme-color-transparent",`rgba(${L}, ${k}, ${q}, 0.3)`),window.electronAPI&&window.electronAPI.setTheme&&window.electronAPI.setTheme(Yr)},[Yr]),C.useEffect(()=>{window.electronAPI&&window.electronAPI.setSelectedDac&&window.electronAPI.setSelectedDac($t)},[$t]),C.useMemo(()=>{const _=new Set;return sa&&_.add(sa),Nn.forEach(w=>{w&&w.type==="ilda"&&w.workerId&&_.add(w.workerId)}),Array.from(_)},[sa,Nn]),C.useEffect(()=>{if(!r)return;const _=async Re=>{if(Re.data.type==="get-frame"&&Re.data.success)if(Re.data.isStillFrame){const{workerId:at,frame:Se,layerIndex:$e,colIndex:qe}=Re.data;let De=null;const Ae=(Nt.current?Nt.current:yn.current)?.[$e]?.[qe],Ye=Ae?.effects||[];let je=null;const Oe=Ae?.assignedDacs||[];if(Oe.length>0){const pt=Oe[0],Ut=`${pt.ip}:${pt.channel}`;je=xi.current[Ut]}else if($t){const pt=`${$t.ip}:${$t.channel}`;je=xi.current[pt]}let it=Se;je&&(it=uf(Se,je)),De=await V0(it,Ye,$e,qe),z({type:"SET_CLIP_CONTENT",payload:{layerIndex:$e,colIndex:qe,content:{stillFrame:Se,parsing:!1,thumbnailPath:De,thumbnailVersion:Date.now()}}})}else y.current[Re.data.workerId]=Re.data.frame;else if(Re.data.type==="parse-ilda"&&Re.data.success){const{workerId:at,totalFrames:Se,ildaFormat:$e,fileName:qe,filePath:De,layerIndex:Le,colIndex:Ae}=Re.data,Ye={type:"ilda",workerId:at,totalFrames:Se,ildaFormat:$e,fileName:qe,filePath:De,parsing:!0,playbackSettings:{mode:"fps",duration:Se/60,beats:8,speedMultiplier:1}};z({type:"SET_CLIP_CONTENT",payload:{layerIndex:Le,colIndex:Ae,content:Ye}});const je=xn.current[Le][Ae],Oe=`Clip ${Le+1}-${Ae+1}`;je===Oe&&z({type:"SET_CLIP_NAME",payload:{layerIndex:Le,colIndex:Ae,name:qe}})}else if(Re.data.type==="get-all-frames"&&Re.data.success){console.log("Received get-all-frames response:",Re.data);const{frames:at,workerId:Se,layerIndex:$e,colIndex:qe}=Re.data;n0(async()=>{const{framesToIlda:De}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:De}},[],import.meta.url).then(({framesToIlda:De})=>{const Le=De(at),Ye=yn.current[$e][qe].fileName||"export.ild";window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(Le,Ye).then(je=>{je.success?jt(`Exported to ${je.filePath}`):je.error&&jt(`Export failed: ${je.error}`)})}).catch(De=>console.error("Failed to load ilda-writer in response:",De))}else if(Re.data.success===!1){jt(`Worker error: ${Re.data.error}`);const{layerIndex:at,colIndex:Se}=Re.data;at!==void 0&&Se!==void 0&&z({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:at,colIndex:Se,status:!1}})}};r.addEventListener("message",_);let w,L,k,q=0,he=0;const J=60,Te=1e3/J,Pe=1e3/30,gt=Re=>{if(Re.length===0)return null;if(Re.length===1)return Re[0];let at=0;Re.forEach((qe,De)=>{const Ae=qe.points instanceof Float32Array||qe.isTypedArray?qe.points.length/8:qe.points.length;at+=Ae,De<Re.length-1&&(at+=2)});const Se=new Float32Array(at*8);let $e=0;return Re.forEach((qe,De)=>{const Le=qe.points instanceof Float32Array||qe.isTypedArray,Ae=Le?qe.points.length/8:qe.points.length;for(let Ye=0;Ye<Ae;Ye++){const je=($e+Ye)*8;if(Le){const Oe=Ye*8;Se.set(qe.points.subarray(Oe,Oe+8),je)}else{const Oe=qe.points[Ye];Se[je]=Oe.x,Se[je+1]=Oe.y,Se[je+2]=Oe.z||0,Se[je+3]=Oe.r,Se[je+4]=Oe.g,Se[je+5]=Oe.b,Se[je+6]=Oe.blanking?1:0,Se[je+7]=Oe.lastPoint?1:0}Se[je+7]=0}if($e+=Ae,De<Re.length-1){const Ye=Re[De+1],je=Ye.points instanceof Float32Array||Ye.isTypedArray,Oe=Se[($e-1)*8],it=Se[($e-1)*8+1];let pt,Ut;je?(pt=Ye.points[0],Ut=Ye.points[1]):(pt=Ye.points[0].x,Ut=Ye.points[0].y);let Et=$e*8;Se[Et]=Oe,Se[Et+1]=it,Se[Et+6]=1,Se[Et+3]=0,Se[Et+4]=0,Se[Et+5]=0;let ua=($e+1)*8;Se[ua]=pt,Se[ua+1]=Ut,Se[ua+6]=1,Se[ua+3]=0,Se[ua+4]=0,Se[ua+5]=0,$e+=2}}),Se[(at-1)*8+7]=1,{points:Se,isTypedArray:!0}},vt=Re=>{if(!Mn){cancelAnimationFrame(L);return}if(Re-q>Te){if(window.electronAPI&&Mn){const at=new Map;Si.current.forEach(Se=>{if(Se&&y.current[Se.workerId]){const $e=Ei.current[Se.layerIndex]||[],qe=Se.assignedDacs||[];let De=[...$e,...qe];De.length===0&&$t&&(De=[$t]);const Le=[],Ae=new Set;if(De.forEach(tt=>{const pr=tt.channel!==void 0?tt.channel:tt.channels&&tt.channels.length>0?tt.channels[0].serviceID:0,Qn=`${tt.ip}:${pr}`;Ae.has(Qn)||(Ae.add(Qn),Le.push({...tt,channel:pr}))}),Le.length===0)return;const je=(Nt.current||yn.current)[Se.layerIndex][Rn.current[Se.layerIndex]],Oe=je?je.effects||[]:Se.effects||[],it=Se.layerIndex,pt=la.current[it]||[],Ut=[...Oe,...pt],Et=y.current[Se.workerId],ua=ds.current[Se.layerIndex],xs=bi.current,tn=en.current[Se.layerIndex],fn=Sa.current[Se.layerIndex],Pa=Sa.current.some(tt=>tt);let dn=ua;xs?dn=0:Pa?fn?tn&&(dn=0):dn=0:tn&&(dn=0);const _t=dn*Ft.current;if(_t<=0)return;const pn=E.current[Se.workerId]||0;Se.syncSettings;const Zn={...Et,points:Rt(Et.points)?Et.points:Et.points.map(tt=>({...tt,r:Math.round(tt.r*_t),g:Math.round(tt.g*_t),b:Math.round(tt.b*_t)}))};if(Rt(Zn.points)){const tt=Zn.points,pr=tt.length/8,Qn=new Float32Array(tt);for(let ca=0;ca<pr;ca++)Qn[ca*8+3]*=_t,Qn[ca*8+4]*=_t,Qn[ca*8+5]*=_t;Zn.points=Qn}const tu=Se.fps||St||30,nu=(Se.totalFrames||30)/tu,za=pl(Zn,Ut,{progress:pn,time:Re,effectStates:S.current,assignedDacs:Se.assignedDacs,syncSettings:Se.syncSettings||{},bpm:W.bpm,clipDuration:nu,fftLevels:s});Le.forEach((tt,pr)=>{const Qn=tt.ip,ca=tt.channel||(tt.channels&&tt.channels.length>0?tt.channels[0].serviceID:0);if(ca!==void 0){const $r=`${Qn}:${ca}`;at.has($r)||at.set($r,{ip:Qn,channel:ca,type:tt.type,frames:[]});let _n=za;if(za.points&&za.points._channelDistributions){const fa=za.points._channelDistributions.get(pr);if(fa){const hr=za.points.subarray(fa.start,fa.start+fa.length);_n={...za,points:hr}}else _n={...za,points:new Float32Array(0)}}if(tt.mirrorX||tt.mirrorY){const fa=_n.points,hr=_n.isTypedArray,Ol=hr?fa.length/8:fa.length,Kn=hr?new Float32Array(fa):fa.map(hn=>({...hn}));for(let hn=0;hn<Ol;hn++)hr?(tt.mirrorX&&(Kn[hn*8]=-Kn[hn*8]),tt.mirrorY&&(Kn[hn*8+1]=-Kn[hn*8+1])):(tt.mirrorX&&(Kn[hn].x=-Kn[hn].x),tt.mirrorY&&(Kn[hn].y=-Kn[hn].y));_n={..._n,points:Kn}}at.get($r).frames.push(_n)}})}}),Al.current.forEach(Se=>{(Se.channels&&Se.channels.length>0?Se.channels.map(qe=>qe.serviceID):[0]).forEach(qe=>{const De=`${Se.ip}:${qe}`,Le=bn.current?bn.current[De]:xi.current[De];if(Le){at.has(De)||at.set(De,{ip:Se.ip,channel:qe,type:Se.type,frames:[]});const Ae=at.get(De);if(Le.testLineEnabled){const Ye=Ti(Le.testLineY!==void 0?Le.testLineY:.5);Ae.frames=[Ye]}}})}),at.forEach(Se=>{let $e=gt(Se.frames);const qe=`${Se.ip}:${Se.channel}`,De=bn.current?bn.current[qe]:xi.current[qe];if($e&&De){if(De.dimmer!==void 0&&De.dimmer<1){const Le=De.dimmer,Ae=$e.points,Ye=$e.isTypedArray,je=Ye?Ae.length/8:Ae.length;for(let Oe=0;Oe<je;Oe++)Ye?(Ae[Oe*8+3]*=Le,Ae[Oe*8+4]*=Le,Ae[Oe*8+5]*=Le):(Ae[Oe].r*=Le,Ae[Oe].g*=Le,Ae[Oe].b*=Le)}$e=uf($e,De)}$e&&window.electronAPI.sendFrame(Se.ip,Se.channel,$e,J,Se.type)})}q=Re}L=requestAnimationFrame(vt)};function Rt(Re){return!!Re&&(Re instanceof Float32Array||Re.buffer instanceof ArrayBuffer)}const Dt=Re=>{const at=1e3/St,Se=W.bpm||120,$e=(De,Le,Ae)=>{j.current[Ae]||(j.current[Ae]=Re);let Ye=Re-j.current[Ae];Ye>1e3&&(Ye=at),Jt&&(Vn.current[Ae]===void 0&&(Vn.current[Ae]=0),Vn.current[Ae]+=Ye);const je=Vn.current[Ae]||0,Oe=Rn.current[Le]!==null?x(Le):null;let it=M.current[Ae]||0,pt=0;const Ut=De.totalFrames||1,Et=De.playbackSettings||{mode:"fps",duration:Ut/60,beats:8,speedMultiplier:1};if(Oe&&Jt&&!Oe.paused)pt=Oe.duration>0?Oe.currentTime/Oe.duration:0,it=Math.floor(pt*Ut);else if(Et.mode==="timeline"){const tn=Et.duration*1e3/(Et.speedMultiplier||1);tn>0&&(pt=je/tn%1,it=Math.floor(pt*Ut))}else if(Et.mode==="bpm"){const tn=6e4/Se,fn=Et.beats*tn/(Et.speedMultiplier||1);fn>0&&(pt=je/fn%1,it=Math.floor(pt*Ut))}else{const fn=1e3/((Et.fps||60)*(Et.speedMultiplier||1));if(Ye>=fn){const Pa=Math.floor(Ye/fn);Jt?(j.current[Ae]=Re-Ye%fn,it=it+Pa):j.current[Ae]=Re,pt=Ut>0?it%Ut/Ut:0}else return}Et.mode!=="fps"&&(j.current[Ae]=Re),isNaN(it)&&(it=0),isNaN(pt)&&(pt=0);const xs=(La.current[Ae]||0)>.9&&pt<.1;if(La.current[Ae]=pt,E.current[Ae]=pt,Ut>0&&(it=it%Ut,it<0&&(it+=Ut)),xs&&Jt){const tn=El.current[Le];if(tn&&tn!=="off"){const fn=yn.current[Le],Pa=Rn.current[Le];let dn=-1;if(tn==="forward")for(let _t=1;_t<fn.length;_t++){const pn=(Pa+_t)%fn.length,Zn=fn[pn];if(Zn&&(Zn.type==="ilda"||Zn.type==="generator")){dn=pn;break}}else if(tn==="random"){const _t=fn.map((pn,Zn)=>pn&&(pn.type==="ilda"||pn.type==="generator")?Zn:-1).filter(pn=>pn!==-1);if(_t.length>0){const pn=Math.floor(Math.random()*_t.length);dn=_t[pn],dn===Pa&&_t.length>1&&(dn=_t[(pn+1)%_t.length])}}dn!==-1&&dn!==Pa&&setTimeout(()=>{Ga(Le,dn)},0)}}(M.current[Ae]!==it||!y.current[Ae])&&(M.current[Ae]=it,De.type==="ilda"?r.postMessage({type:"get-frame",workerId:Ae,frameIndex:it}):De.type==="generator"&&(De.frames&&De.frames.length>1?De.frames[it%De.frames.length]&&(y.current[Ae]=De.frames[it%De.frames.length]):!y.current[Ae]&&De.frames&&De.frames.length>0&&(y.current[Ae]=De.frames[0])))};ge.forEach((De,Le)=>{const Ae=Rn.current[Le];if(Ae===null)return;const je=(Nt.current||yn.current)[Le][Ae];if(!je)return;let Oe=je.type==="ilda"?je.workerId:je.type==="generator"?`generator-${Le}-${Ae}`:null;Oe&&$e(je,Le,Oe)});const qe=Ea.current;if(qe&&!Si.current.some(De=>De.workerId===qe)){const De=Ne,Le=We;if(De!==null&&Le!==null){const Ye=(Nt.current||yn.current)[De][Le];Ye&&$e(Ye,De,qe)}}if(Sn.current){const{layerIndex:De,colIndex:Le}=Sn.current,Ae=Rn.current[De]===Le,Ye=Ea.current;if(!Ae){const Oe=(Nt.current||yn.current)[De]?.[Le];if(Oe){let it=Oe.type==="ilda"?Oe.workerId:Oe.type==="generator"?`generator-${De}-${Le}`:null;it&&it!==Ye&&$e(Oe,De,it)}}}w=requestAnimationFrame(Dt)},dr=Re=>{Re-he>Pe&&(sr.current=performance.now(),R(at=>at+1),he=Re),k=requestAnimationFrame(dr)};return w=requestAnimationFrame(Dt),k=requestAnimationFrame(dr),Mn?L=requestAnimationFrame(vt):cancelAnimationFrame(L),()=>{r.removeEventListener("message",_),cancelAnimationFrame(w),cancelAnimationFrame(L),cancelAnimationFrame(k)}},[r,St,Jt,Mn,$t,x,W.bpm,Ne,We]),C.useEffect(()=>{let _,w,L;return window.electronAPI&&(_=window.electronAPI.onClipContextMenuCommand((k,q,he)=>{if(console.log(`Clip context menu command received: ${k} for ${q}-${he}`),k==="export-ilda"){const J=yn.current[q][he];console.log("Exporting clip:",J),J&&(J.type==="ilda"&&J.workerId&&r?(jt("Preparing ILDA export..."),console.log("Requesting frames from worker:",J.workerId),r.postMessage({type:"get-all-frames",workerId:J.workerId,layerIndex:q,colIndex:he})):J.type==="generator"&&J.frames?(console.log("Exporting generator frames with effects..."),n0(async()=>{const{framesToIlda:Te}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Te}},[],import.meta.url).then(({framesToIlda:Te})=>{const _e=St||60;let Pe=2;if(J.playbackSettings)if(J.playbackSettings.mode==="timeline"&&J.playbackSettings.duration)Pe=J.playbackSettings.duration;else if(J.playbackSettings.mode==="bpm"&&J.playbackSettings.beats){const Re=W.bpm||120;Pe=J.playbackSettings.beats/Re*60}else J.playbackSettings.mode==="fps"&&J.frames.length>1&&(Pe=J.frames.length/_e);const gt=Math.ceil(Pe*_e),vt=[],Rt=new Map;for(let Re=0;Re<gt;Re++){const at=Re*(1e3/_e),Se=Re/gt,$e=Math.floor(Se*J.frames.length)%J.frames.length,qe=J.frames[$e];if(qe){const De={...qe},Le=pl(De,J.effects,{time:at,progress:Se,effectStates:Rt,syncSettings:J.syncSettings||{},bpm:W.bpm,clipDuration:Pe,assignedDacs:J.assignedDacs||[]}),Ae=Le.points,Ye=Ae.length/8,je=[];for(let Oe=0;Oe<Ye;Oe++)je.push({x:Ae[Oe*8],y:Ae[Oe*8+1],z:Ae[Oe*8+2],r:Ae[Oe*8+3],g:Ae[Oe*8+4],b:Ae[Oe*8+5],blanking:Ae[Oe*8+6]>.5,lastPoint:Ae[Oe*8+7]>.5});vt.push({...Le,points:je,frameName:`Frame ${Re}`,companyName:"TrueLazer"})}}const Dt=Te(vt),dr=`${J.generatorDefinition?.name||"generator"}_export.ild`;window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(Dt,dr).then(Re=>{Re.success?jt(`Exported to ${Re.filePath}`):Re.error&&jt(`Export failed: ${Re.error}`)})}).catch(Te=>console.error("Failed to export generator:",Te))):(console.warn("Clip type not supported for export or missing data:",J.type,J),J.type==="ilda"&&!J.workerId?jt("Clip data not loaded. Please play the clip to load it."):J.type==="generator"&&!J.frames&&jt("Generator not rendered yet.")))}else if(k==="update-thumbnail"){const J=xe[q][he];if(J){if(J.type==="ilda"&&J.workerId&&r){const Te=M.current[J.workerId]||0;r.postMessage({type:"get-frame",workerId:J.workerId,frameIndex:Te,isStillFrame:!0,layerIndex:q,colIndex:he})}else if(J.type==="generator"&&J.generatorDefinition){const Te=M.current[`generator-${q}-${he}`]||0,_e=J.frames?.[Te%J.frames.length];if(_e){const Pe=J.effects||[];V0(_e,Pe,q,he).then(gt=>{z({type:"SET_CLIP_CONTENT",payload:{layerIndex:q,colIndex:he,content:{stillFrame:_e,thumbnailPath:gt,thumbnailVersion:Date.now()}}})})}}}}else if(k==="clear-clip")z({type:"CLEAR_CLIP",payload:{layerIndex:q,colIndex:he}});else if(k==="rename-clip"){const J=xn.current[q][he];N({title:"Rename Clip",initialValue:J,onSave:Te=>z({type:"SET_CLIP_NAME",payload:{layerIndex:q,colIndex:he,name:Te}})}),ee(!0)}else if(k==="copy-clip"){const J={content:yn.current[q][he],name:xn.current[q][he]};z({type:"SET_CLIPBOARD",payload:J}),jt("Clip copied.")}else if(k==="cut-clip"){const J={content:yn.current[q][he],name:xn.current[q][he]};z({type:"SET_CLIPBOARD",payload:J}),z({type:"CLEAR_CLIP",payload:{layerIndex:q,colIndex:he}}),jt("Clip cut.")}else if(k==="paste-clip")if(W.clipClipboard){const{content:J,name:Te}=W.clipClipboard;let _e={...J};_e.type==="ilda"&&(_e.workerId=null),z({type:"SET_CLIP_CONTENT",payload:{layerIndex:q,colIndex:he,content:_e}}),z({type:"SET_CLIP_NAME",payload:{layerIndex:q,colIndex:he,name:Te}}),jt("Clip pasted."),setTimeout(()=>{const Pe=_e;if(Pe.type==="generator"&&Pe.generatorDefinition){const gt=`${q}-${he}`,vt={...Pe.generatorDefinition.defaultParams,...Pe.currentParams};bt.current.set(gt,JSON.stringify(vt));const Rt=++ir.current;Yt(q,he,Pe.generatorDefinition,Pe.currentParams,Rt)}},100)}else jt("Clipboard is empty.");else k==="set-trigger-style-normal"?z({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:q,colIndex:he,style:"normal"}}):k==="set-trigger-style-toggle"?z({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:q,colIndex:he,style:"toggle"}}):k==="set-trigger-style-flash"&&z({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:q,colIndex:he,style:"flash"}})}),w=window.electronAPI.onLayerFullContextMenuCommand((k,q)=>{if(console.log(`Layer context menu command received: ${k} for ${q}`),k==="layer-rename"){const he=ge[q];N({title:"Rename Layer",initialValue:he,onSave:J=>z({type:"SET_LAYER_NAME",payload:{index:q,name:J}})}),ee(!0)}else k==="layer-clear-clips"&&z({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:q}})}),L=window.electronAPI.onContextMenuActionFromMain(k=>{if(console.log("General context menu action received:",k),k.type==="rename-column"){const q=be[k.index];N({title:"Rename Column",initialValue:q,onSave:he=>z({type:"SET_COLUMN_NAME",payload:{index:k.index,name:he}})}),ee(!0)}else if(k.type==="rename-layer"){const q=ge[k.index];N({title:"Rename Layer",initialValue:q,onSave:he=>z({type:"SET_LAYER_NAME",payload:{index:k.index,name:he}})}),ee(!0)}})),()=>{_&&_(),w&&w(),L&&L()}},[xe,He,ge,be,r,t,W.clipClipboard]);const Ba=C.useRef(Lt);C.useEffect(()=>{for(let _=0;_<ge.length;_++)for(let w=0;w<be.length;w++){const L=Lt[_][w],k=Ba.current[_][w],q=xe[_][w],he=q?.workerId,J=Ai.current.get(`${_}-${w}`),Te=L!==k;(Te||he&&!J)&&q&&q.type==="ilda"&&he&&(console.log(`[App.jsx] Fetching still frame for ${_}-${w} at index ${L}. Reason: ${Te?"index change":"worker ready"}`),r.postMessage({type:"get-frame",workerId:he,frameIndex:L,isStillFrame:!0,layerIndex:_,colIndex:w})),he?Ai.current.set(`${_}-${w}`,he):Ai.current.delete(`${_}-${w}`)}Ba.current=Lt},[Lt,xe,ge.length,be.length,r]),C.useEffect(()=>{t&&xe.forEach((_,w)=>{_.forEach((L,k)=>{if(L&&L.type==="generator"&&L.generatorDefinition){if(L.generatorDefinition.id==="ndi-source")return;const q=`${w}-${k}`,he={...L.generatorDefinition.defaultParams,...L.currentParams||{}},J=JSON.stringify(he);if(bt.current.get(q)!==J){console.log(`[App.jsx] Generator ${q} params changed, regenerating...`);const Te=++ir.current;Yt(w,k,L.generatorDefinition,L.currentParams,Te),bt.current.set(q,J)}}})})},[xe,t]),C.useEffect(()=>{!W.projectLoadTimestamp||!r||!t||(console.log("Project loaded, regenerating content..."),xe.forEach((_,w)=>{_.forEach((L,k)=>{if(L){if(L.type==="ilda"&&L.filePath&&!L.workerId)console.log(`Reparsing ILDA file for clip ${w}-${k}: ${L.filePath}`),r.postMessage({type:"load-and-parse-ilda",fileName:L.fileName,filePath:L.filePath,layerIndex:w,colIndex:k});else if(L.type==="generator"&&L.generatorDefinition){console.log(`Regenerating generator clip ${w}-${k} on project load`);const q=++ir.current;Yt(w,k,L.generatorDefinition,L.currentParams,q)}}})}))},[W.projectLoadTimestamp,r,t]),C.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onUpdateThumbnailRenderMode){const _=window.electronAPI.onUpdateThumbnailRenderMode(w=>{console.log("App.jsx: Received thumbnail mode update:",w),z({type:"SET_THUMBNAIL_RENDER_MODE",payload:w})});return()=>_()}},[]),C.useEffect(()=>{let _,w,L,k,q;return window.electronAPI&&(_=window.electronAPI.on("new-project",()=>z({type:"RESET_STATE"})),w=window.electronAPI.on("open-project",()=>{}),L=window.electronAPI.on("save-project",()=>window.electronAPI.send("save-project",W)),k=window.electronAPI.on("save-project-as",()=>window.electronAPI.send("save-project-as",W)),q=window.electronAPI.on("load-project-data",he=>{z({type:"LOAD_PROJECT",payload:he})})),()=>{_&&_(),w&&w(),L&&L(),k&&k(),q&&q()}},[W]),C.useEffect(()=>{let _,w;return(async()=>{if(window.electronAPI&&window.electronAPI.getAllSettings){const k=await window.electronAPI.getAllSettings();k&&(k.shortcutsState&&ne(k.shortcutsState),z({type:"LOAD_SETTINGS",payload:k}))}})(),window.electronAPI&&(_=window.electronAPI.onMenuAction(k=>{if(console.log("Menu action received:",k),k==="output-settings")$(!0);else if(k==="settings-audio-output")B(!0);else if(k==="settings-audio-fft")le(!0);else if(k.startsWith("set-theme-")){const q=k.split("set-theme-")[1];z({type:"SET_THEME",payload:q})}else if(k==="shortcuts-window"||k.startsWith("open-")&&k.endsWith("-settings"))se(!0);else if(k.startsWith("toggle-")){const q=k.split("-");if(q.length===3){const he=q[1],J=q[2]==="true";ne(Te=>({...Te,[he]:J}))}}}),w=window.electronAPI.onRenderSettingsCommand(k=>{console.log("Render settings command received:",k),z({type:"SET_RENDER_SETTING",payload:{setting:k.setting,value:k.value}})})),()=>{_&&_(),w&&w()}},[]),C.useEffect(()=>{if(!r)return;const _=async w=>{if(w.data.type==="request-file-content"){const{filePath:L,requestId:k}=w.data;try{const q=await window.electronAPI.readFileForWorker(L);r.postMessage({type:"file-content-response",requestId:k,arrayBuffer:q},[q])}catch(q){console.error(`Renderer: Failed to read file for worker: ${L}`,q);let he=!1;try{if(window.electronAPI&&window.electronAPI.showOpenDialog){const J=L.split(/[/\\]/).pop(),Te=await window.electronAPI.showOpenDialog({title:`Locate missing file: ${J}`,defaultPath:L,filters:[{name:"ILDA Files",extensions:["ild"]},{name:"All Files",extensions:["*"]}],properties:["openFile"]});if(Te){const _e=Te;z({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:L,newPath:_e}});const Pe=await window.electronAPI.readFileForWorker(_e);r.postMessage({type:"file-content-response",requestId:k,arrayBuffer:Pe},[Pe]),he=!0}}}catch(J){console.error("Retry/Locate failed:",J)}he||r.postMessage({type:"file-content-response",requestId:k,error:q.message})}}else if(w.data.type==="parsing-status"){const{layerIndex:L,colIndex:k,status:q}=w.data;z({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:L,colIndex:k,status:q}}),q||z({type:"SET_CLIP_PARSING_FAILED",payload:{layerIndex:L,colIndex:k,failed:!0}})}};return r.addEventListener("message",_),()=>{r.removeEventListener("message",_)}},[r]),C.useEffect(()=>{if(!r)return;const _=[];xe.forEach((w,L)=>{w.forEach((k,q)=>{k&&k.type==="ilda"&&k.filePath&&!k.workerId&&!k.parsing&&!k.parsingFailed&&_.push({layerIndex:L,colIndex:q,fileName:k.fileName,filePath:k.filePath})})}),_.length>0&&(console.log(`Triggering re-parse for ${_.length} clips.`),z({type:"SET_BULK_PARSING_STATUS",payload:_.map(w=>({layerIndex:w.layerIndex,colIndex:w.colIndex,status:!0}))}),_.forEach(w=>{r.postMessage({type:"load-and-parse-ilda",fileName:w.fileName,filePath:w.filePath,layerIndex:w.layerIndex,colIndex:w.colIndex})}))},[xe,r]);const wi=Nt.current||xe;let lr=[];if(Ne!==null){const _=Kt[Ne]||[];if(We!==null)lr=[...wi[Ne][We]?.effects||[],..._];else{const w=dt[Ne];w!==null?lr=[...wi[Ne][w]?.effects||[],..._]:lr=_}}const eu=C.useCallback((_,w,L,k,q)=>{if(Nt.current&&Nt.current[_]&&Nt.current[_][w]){const he=Nt.current[_][w];he&&he.effects&&he.effects[L]&&(he.effects[L].params[k]=q,Yn.current=!0)}z({type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:_,colIndex:w,effectIndex:L,paramName:k,newValue:q}})},[]);C.useEffect(()=>{if(!t)return;const _=w=>{if(w.data.layerIndex!==void 0&&w.data.colIndex!==void 0){const L=`${w.data.layerIndex}-${w.data.colIndex}`;if(Ua.current.set(L,!1),Ia.current.has(L)){const{message:k,transferables:q}=Ia.current.get(L);Ia.current.delete(L),console.log(`[App.jsx] Generator ${L} free, processing pending seq ${k.seq}`),Ua.current.set(L,!0),t.postMessage(k,q)}}if(w.data.success){const{layerIndex:L,colIndex:k,frames:q,generatorDefinition:he,currentParams:J,isLive:Te,seq:_e}=w.data;if(_e!==void 0){if(_e<Zr.current)return;Zr.current=_e}const Pe=`generator-${L}-${k}`;if(y.current[Pe]=q[0],!Te&&_e===ir.current){const gt={type:"generator",generatorDefinition:he,frames:q,stillFrame:q[0],currentParams:J,playbackSettings:{mode:"fps",duration:q.length/60,beats:8,speedMultiplier:1}};z({type:"SET_CLIP_CONTENT",payload:{layerIndex:L,colIndex:k,content:gt}});const vt=xn.current[L][k],Rt=`Clip ${L+1}-${k+1}`;vt===Rt&&z({type:"SET_CLIP_NAME",payload:{layerIndex:L,colIndex:k,name:he.name}})}else window.electronAPI&&window.electronAPI.ndiSignalReady&&window.electronAPI.ndiSignalReady()}else jt(`Error generating frames: ${w.data.error}`)};return t.addEventListener("message",_),()=>{t.removeEventListener("message",_)}},[t,W.clipContents]);const Tl=C.useCallback((_,w,L)=>{if(t){const k=`${_}-${w}`,q={...L.defaultParams};bt.current.set(k,JSON.stringify(q));const he=++ir.current;Yt(_,w,L,L.defaultParams,he)}},[t]),Yt=async(_,w,L,k,q)=>{const he={...L.defaultParams,...k},J=`${_}-${w}`;let Te=null;if(["text","ndi-source","spout-receiver"].includes(L.id)){const gt="src/fonts/Geometr415 Blk BT Black.ttf";let vt=he.fontUrl||gt;["https://raw.githubusercontent.com/google/fonts/main/ofl/roboto/Roboto-Regular.ttf","https://raw.githubusercontent.com/googlefonts/roboto-2/main/src/hinted/Roboto-Regular.ttf"].includes(vt)&&(vt=gt);try{if(vt.startsWith("http"))if(window.electronAPI&&window.electronAPI.fetchUrlAsArrayBuffer)Te=await window.electronAPI.fetchUrlAsArrayBuffer(vt);else throw new Error("URL fetching API is not available.");else if(window.electronAPI&&window.electronAPI.readFileForWorker)Te=await window.electronAPI.readFileForWorker(vt);else throw new Error("File reading API is not available.")}catch(Dt){console.error(`Failed to load font for text generator at ${_}-${w}:`,Dt),jt(`Font error: ${Dt.message}`);return}}const _e={type:"generate",layerIndex:_,colIndex:w,generator:L,params:he,fontBuffer:Te,seq:q},Pe=Te?[Te]:[];Ua.current.get(J)?(console.log(`[App.jsx] Generator ${J} busy, queuing seq ${q}`),Ia.current.set(J,{message:_e,transferables:Pe})):(Ua.current.set(J,!0),a.current&&a.current.postMessage(_e,Pe))},oa=C.useCallback(_=>{u(_),z({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:_}})},[u]),Ci=C.useCallback(()=>{v(),z({type:"CLEAR_ALL_ACTIVE_CLIPS"})},[v]),Fa=C.useCallback(()=>{h(),ge.forEach((_,w)=>{const L=dt[w];if(L!==null){const k=xe[w][L];k&&k.audioFile&&!x(w)&&o(w,k.audioFile.path,k.audioVolume??1,!0)}}),z({type:"SET_IS_PLAYING",payload:!0}),z({type:"SET_IS_STOPPED",payload:!1})},[h,ge,dt,xe,x,o]),Kr=C.useCallback(()=>{f(),z({type:"SET_IS_PLAYING",payload:!1}),z({type:"SET_IS_STOPPED",payload:!1})},[f]),ja=C.useCallback(()=>{g(),f(),z({type:"SET_IS_PLAYING",payload:!1}),z({type:"SET_IS_STOPPED",payload:!0}),M.current={}},[g,f]),Wr=C.useCallback((_,w)=>{z({type:"SET_SELECTED_CLIP",payload:{layerIndex:_,colIndex:w}});const L=xe[_][w];if(L&&L.type==="ilda")z({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:L.workerId,totalFrames:L.totalFrames,generatorId:null,generatorParams:{}}});else if(L&&L.type==="generator"){const k=`generator-${_}-${w}`;z({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:k,generatorId:L.generatorDefinition.id,generatorParams:L.currentParams,totalFrames:L.frames.length}})}else z({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:null,totalFrames:0,generatorId:null,generatorParams:{}}})},[xe]),En=C.useCallback((_,w,L)=>{L?Sn.current={layerIndex:_,colIndex:w}:Sn.current&&Sn.current.layerIndex===_&&Sn.current.colIndex===w&&(Sn.current=null)},[]),Ga=C.useCallback((_,w,L=!0)=>{const k=xe[_][w];if(!k){L&&(Wr(_,w),oa(_));return}const q=k.triggerStyle||"normal",he=dt[_];if(q==="normal"){if(!L)return}else if(q==="toggle"){if(!L)return;if(he===w){oa(_);return}}else if(q==="flash"&&!L){he===w&&oa(_);return}if(k&&k.type==="generator"&&k.frames&&k.frames.length>0){const J=`generator-${_}-${w}`;y.current[J]=k.frames[0],j.current[J]=performance.now(),M.current[J]=0}else k&&k.type==="ilda"&&k.workerId&&(j.current[k.workerId]=performance.now(),M.current[k.workerId]=0);if(k&&k.audioFile?o(_,k.audioFile.path,k.audioVolume??1,Jt):u(_),z({type:"SET_ACTIVE_CLIP",payload:{layerIndex:_,colIndex:w}}),k){if(k.type==="ilda"&&k.workerId){const J=M.current[k.workerId]||0;z({type:"UPDATE_THUMBNAIL",payload:{layerIndex:_,colIndex:w,frameIndex:J}})}else if(k.type==="generator"&&k.frames){const J=M.current[`generator-${_}-${w}`]||0,Te=k.frames[J%k.frames.length];Te&&z({type:"SET_CLIP_CONTENT",payload:{layerIndex:_,colIndex:w,content:{stillFrame:Te}}})}}},[xe,dt,oa,o,Jt,u,Wr]),wl=C.useCallback((_,w,L)=>{Yn.current=!0,z({type:"ADD_CLIP_EFFECT",payload:{layerIndex:_,colIndex:w,effect:L}})},[]),ps=C.useCallback((_,w)=>{const L=Qt.find(k=>(k.id||k.name)===w);L&&(Yn.current=!0,z({type:"ADD_LAYER_EFFECT",payload:{layerIndex:_,effect:L}}))},[]),or=C.useCallback((_,w,L)=>{Yn.current=!0,z({type:"SET_CLIP_DAC",payload:{layerIndex:_,colIndex:w,dac:L}})},[]),Cl=C.useCallback((_,w)=>{z({type:"SET_LAYER_DAC",payload:{layerIndex:_,dac:w}})},[]),Ml=_=>{window.electronAPI&&window.electronAPI.showLayerFullContextMenu&&window.electronAPI.showLayerFullContextMenu(_)},ur=_=>{window.electronAPI&&window.electronAPI.showColumnContextMenu&&window.electronAPI.showColumnContextMenu(_)},hs=_=>{ge.forEach((w,L)=>{const k=xe[L][_];k&&(k.type==="ilda"||k.type==="generator")?Ga(L,_):oa(L)})},Nl=C.useCallback(_=>{z({type:"SET_SELECTED_DAC",payload:_})},[]),Rl=C.useCallback(_=>{z({type:"SET_DACS",payload:_})},[]),ms=(_,w)=>{if(Ne!==null&&We!==null){let L=null,k={};if(Nt.current&&Nt.current[Ne]&&Nt.current[Ne][We]){const Te=Nt.current[Ne][We];Te&&Te.currentParams&&(Te.currentParams[_]=w,Yn.current=!0,L=Te,k=Te.currentParams)}if(L||(L=xe[Ne][We],L&&L.currentParams&&(k={...L.currentParams,[_]:w})),!L||!L.generatorDefinition)return;z({type:"UPDATE_GENERATOR_PARAM",payload:{layerIndex:Ne,colIndex:We,paramName:_,newValue:w}});const q=`${Ne}-${We}`,he={...L.generatorDefinition.defaultParams,...k};bt.current.set(q,JSON.stringify(he));const J=++ir.current;Yt(Ne,We,L.generatorDefinition,k,J)}},Gt=Ne!==null&&We!==null?xe[Ne][We]:null;C.useEffect(()=>{if(!window.electronAPI||!t)return;(async()=>{let w=null;ge.forEach((k,q)=>{const he=dt[q];if(he!==null){const J=xe[q][he];J&&J.type==="generator"&&J.generatorDefinition?.id==="ndi-source"&&(w=J)}}),!w&&Gt?.type==="generator"&&Gt?.generatorDefinition?.id==="ndi-source"&&(w=Gt);const L=w?.currentParams?.sourceName;L&&L!=="No Source"?L!==Xr.current&&(console.log(`[NDI] Switching to source: ${L}`),await window.electronAPI.ndiCreateReceiver(L),Xr.current=L):Xr.current&&(console.log("[NDI] Destroying receiver"),await window.electronAPI.ndiDestroyReceiver(),Xr.current=null)})()},[dt,xe,Gt,ge]),C.useEffect(()=>{const _=[...Nn,Gt].find(w=>w?.type==="generator"&&w?.generatorDefinition?.id==="ndi-source");if(_&&window.electronAPI?.ndiUpdateSettings){const{captureWidth:w,captureHeight:L}=_.currentParams||{};w&&L&&window.electronAPI.ndiUpdateSettings({width:w,height:L})}},[Nn,Gt]),C.useEffect(()=>{if(!window.electronAPI||!t)return;const _=window.electronAPI.onNdiFrame(w=>{Rn.current.forEach((L,k)=>{if(L===null)return;const q=yn.current[k][L];q&&q.type==="generator"&&q.generatorDefinition?.id==="ndi-source"&&t.postMessage({type:"generate",layerIndex:k,colIndex:L,generator:q.generatorDefinition,params:{...q.generatorDefinition.defaultParams,...q.currentParams},ndiFrame:w,isLive:!0})}),Gt?.type==="generator"&&Gt?.generatorDefinition?.id==="ndi-source"&&t.postMessage({type:"generate",layerIndex:Ne,colIndex:We,generator:Gt.generatorDefinition,params:{...Gt.generatorDefinition.defaultParams,...Gt.currentParams},ndiFrame:w,isLive:!0})});return()=>_()},[dt,xe,Gt,Ne,We,ge,t]);const Dl=Gt?Ne:null,Dn=(Dl!==null?sn[Dl]:1)*Oa,vs=C.useMemo(()=>{let _=sa;if(Ne!==null&&We===null){const L=dt[Ne];if(L!==null){const k=xe[Ne][L];k&&(k.type==="ilda"?_=k.workerId:k.type==="generator"&&(_=`generator-${Ne}-${L}`))}}const w=y.current[_]||null;if(E.current[_],w&&Dn<.999)if(w.isTypedArray||w.points instanceof Float32Array){const k=w.points,q=k.length/8,he=new Float32Array(k);for(let J=0;J<q;J++)he[J*8+3]*=Dn,he[J*8+4]*=Dn,he[J*8+5]*=Dn;return{...w,points:he,isTypedArray:!0}}else return{...w,points:w.points.map(k=>({...k,r:Math.round(k.r*Dn),g:Math.round(k.g*Dn),b:Math.round(k.b*Dn)}))};return w},[T,sa,Dn,Ne,We,dt,xe]);let Aa=sa;if(Ne!==null&&We===null){const _=dt[Ne];if(_!==null){const w=xe[Ne][_];w&&(w.type==="ilda"?Aa=w.workerId:w.type==="generator"&&(Aa=`generator-${Ne}-${_}`))}}const cr=E.current[Aa]||0,_l=C.useMemo(()=>{const _={},w=Nt.current||xe;return dt.forEach((L,k)=>{if(L!==null){const q=w[k][L];if(q){let he;if(q.type==="ilda"?he=q.workerId:q.type==="generator"&&(he=`generator-${k}-${L}`),he&&y.current[he]){const J=q.effects||[],Te=Kt[k]||[];_[he]={frame:y.current[he],effects:[...J,...Te],layerIndex:k,syncSettings:q.syncSettings||{},bpm:W.bpm,clipDuration:(q.totalFrames||30)/(q.fps||St||30),progress:E.current[he]||0}}}}}),_},[dt,xe,T,W.bpm,Kt]),ys=C.useMemo(()=>{const _=zn.some(w=>w);return sn.map((w,L)=>{if(et)return 0;if(_){if(!zn[L]||vn[L])return 0}else if(vn[L])return 0;return w})},[sn,vn,zn,et]),Mi=C.useCallback((_,w,L=127,k="noteon")=>{if(w===0&&!_.endsWith("_intensity")&&_!=="master_intensity"&&_!=="master_speed"&&!_.startsWith("clip_")&&_!=="bpm_value"&&_!=="bpm_fine_up"&&_!=="bpm_fine_down"&&!_.startsWith("quick_")&&!_.startsWith("dimmer_"))return;const q=w/L;switch(_){case"transport_play":w>0&&Fa();break;case"transport_pause":w>0&&Kr();break;case"transport_stop":w>0&&ja();break;case"comp_blackout":w>0&&z({type:"TOGGLE_GLOBAL_BLACKOUT"});break;case"comp_clear":w>0&&Ci();break;case"master_intensity":z({type:"SET_MASTER_INTENSITY",payload:q});break;case"master_speed":const he=Math.max(1,Math.round(q*120));Qr(he);break;case"laser_output":w>0&&z({type:"TOGGLE_WORLD_OUTPUT_ACTIVE"});break;case"bpm_value":if(k==="controlchange"){let J=0;w<=10?J=w:w>=118&&(J=w-128),J!==0&&z({type:"SET_BPM",payload:Math.max(1,Math.min(999,(W.bpm||120)+J))})}break;case"bpm_fine_up":w>0&&z({type:"SET_BPM",payload:Math.min(999,(W.bpm||120)+.1)});break;case"bpm_fine_down":w>0&&z({type:"SET_BPM",payload:Math.max(1,(W.bpm||120)-.1)});break;case"bpm_tap":break;default:if(_.startsWith("layer_")){const J=_.split("_"),Te=parseInt(J[1]),_e=J[2];_e==="blackout"&&w>0?z({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:Te}}):_e==="solo"&&w>0?z({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:Te}}):_e==="intensity"?z({type:"SET_LAYER_INTENSITY",payload:{layerIndex:Te,intensity:q}}):_e==="clear"&&w>0&&oa(Te)}else if(_.startsWith("clip_")){const J=_.split("_"),Te=parseInt(J[1]),_e=parseInt(J[2]);J[3]==="preview"?w>0&&Wr(Te,_e):Ga(Te,_e,w>0)}else if(_.startsWith("column_")){const J=_.split("_"),Te=parseInt(J[1]);w>0&&hs(Te)}else if(_.startsWith("quick_knob_")){const J=parseInt(_.split("_")[2]);z({type:"UPDATE_QUICK_CONTROL",payload:{type:"knob",index:J,value:q}})}else if(_.startsWith("quick_btn_")){const J=parseInt(_.split("_")[2]);w>0&&z({type:"TOGGLE_QUICK_BUTTON",payload:{index:J}})}else if(_.startsWith("dimmer_")){const J=_.replace("dimmer_","").replace(/_/g,"."),Te=on[J]||{};z({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:J,settings:{...Te,dimmer:q}}})}else{const J=_.split("_");if(J.length>=2&&Ne!==null&&We!==null){const Te=xe[Ne][We];if(Te&&Te.effects){const _e=J[0],Pe=J.slice(1).join("_"),gt=Te.effects.findIndex(vt=>vt.id===_e);if(gt!==-1){const Rt=Qt.find(Dt=>Dt.id===_e)?.paramControls.find(Dt=>Dt.id===Pe);if(Rt){let Dt=q;Rt.type==="range"||Rt.type==="number"?Dt=Rt.min+(Rt.max-Rt.min)*q:Rt.type==="checkbox"&&(Dt=q>.5),z({type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:Ne,colIndex:We,effectIndex:gt,paramName:Pe,newValue:Dt}})}}}}}}},[Fa,Kr,ja,Ci,oa,Qr,W.bpm,Wr,Ga,hs,xe,Ne,We,on]),fr=C.useCallback(_=>{if(_==="world"){const L=!(W.worldShowBeamEffect??!0);if(z({type:"SET_RENDER_SETTING",payload:{setting:"worldShowBeamEffect",value:L}}),window.electronAPI&&window.electronAPI.setRenderSettings){const k={...W.renderSettings,showBeamEffect:W.showBeamEffect,beamRenderMode:W.beamRenderMode,previewScanRate:W.previewScanRate,beamAlpha:W.beamAlpha,fadeAlpha:W.fadeAlpha,worldShowBeamEffect:L,worldBeamRenderMode:W.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(k)}}else{const w=!Hn;if(z({type:"SET_RENDER_SETTING",payload:{setting:"showBeamEffect",value:w}}),window.electronAPI&&window.electronAPI.setRenderSettings){const L={showBeamEffect:w,beamRenderMode:xa,previewScanRate:ka,beamAlpha:Mt,fadeAlpha:ln,worldShowBeamEffect:W.worldShowBeamEffect??!0,worldBeamRenderMode:W.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(L)}}},[Hn,xa,ka,Mt,ln,W.worldShowBeamEffect,W.worldBeamRenderMode]),Xn=C.useCallback(_=>{if(_==="world"){const w=W.worldBeamRenderMode??"both";let L="points";if(w==="both"?L="points":w==="points"?L="lines":w==="lines"&&(L="both"),z({type:"SET_RENDER_SETTING",payload:{setting:"worldBeamRenderMode",value:L}}),window.electronAPI&&window.electronAPI.setRenderSettings){const k={showBeamEffect:Hn,beamRenderMode:xa,previewScanRate:ka,beamAlpha:Mt,fadeAlpha:ln,worldShowBeamEffect:W.worldShowBeamEffect??!0,worldBeamRenderMode:L};window.electronAPI.setRenderSettings(k)}}else{let w="points";if(xa==="both"?w="points":xa==="points"?w="lines":xa==="lines"&&(w="both"),z({type:"SET_RENDER_SETTING",payload:{setting:"beamRenderMode",value:w}}),window.electronAPI&&window.electronAPI.setRenderSettings){const L={showBeamEffect:Hn,beamRenderMode:w,previewScanRate:ka,beamAlpha:Mt,fadeAlpha:ln,worldShowBeamEffect:W.worldShowBeamEffect??!0,worldBeamRenderMode:W.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(L)}}},[Hn,xa,ka,Mt,ln,W.worldShowBeamEffect,W.worldBeamRenderMode]),bs=C.useCallback(()=>{const _=!Mn;z({type:"SET_WORLD_OUTPUT_ACTIVE",payload:_}),window.electronAPI&&(_?W.dacs.forEach(w=>{window.electronAPI.startDacOutput(w.ip,w.type)}):W.dacs.forEach(w=>{window.electronAPI.stopDacOutput(w.ip,w.type)}))},[Mn,W.dacs]);return m.jsx(_v,{onMidiCommand:Mi,children:m.jsx(Ov,{onArtnetCommand:(_,w)=>Mi(_,w,255),children:m.jsxs(kv,{onCommand:Mi,enabled:de.keyboard,children:[m.jsx(US,{isPlaying:Jt,globalBlackout:et,layerBlackouts:vn,layerSolos:zn,isWorldOutputActive:Mn,clipContents:xe,activeClipIndexes:dt,theme:Yr,bpm:W.bpm,quickAssigns:W.quickAssigns}),m.jsx(Uy,{}),m.jsx("div",{className:"app",children:m.jsxs(Ny,{children:[m.jsx(py,{message:Wt.message,visible:Wt.visible}),"import AudioSettingsWindow from './components/AudioSettingsWindow'; // Add this // ... (in App render)",m.jsx(wy,{show:ae,onClose:()=>$(!1),dacs:ia,dacSettings:on,onUpdateDacSettings:qn}),m.jsx(My,{show:re||U,onClose:()=>{B(!1),le(!1)}}),m.jsx(Ay,{show:Z,title:ve.title,initialValue:ve.initialValue,onSave:ve.onSave,onClose:()=>se(!1)||ee(!1)}),m.jsxs("div",{className:"main-content",children:[m.jsxs("div",{className:"top-bar-left-area",children:[m.jsx(Uv,{masterIntensity:W.masterIntensity,onMasterIntensityChange:_=>z({type:"SET_MASTER_INTENSITY",payload:_}),onClearAllActive:Ci,isGlobalBlackout:et,onToggleGlobalBlackout:()=>z({type:"TOGGLE_GLOBAL_BLACKOUT"})}),m.jsx(kS,{isWorldOutputActive:Mn,onToggleWorldOutput:bs})]}),m.jsxs("div",{className:"layer-controls-container",children:[ge.map((_,w)=>{const L=Nn.find(q=>{const he=dt[w];if(he===null)return!1;const J=xe[w][he];return J?J.type==="ilda"?q.workerId===J.workerId:J.type==="generator"?q.workerId===`generator-${w}-${he}`:!1:!1})||null,k=L?y.current[L.workerId]:null;return m.jsx(Jv,{layerName:_,index:w,onDropEffect:q=>ps(w,q),onDropDac:(q,he)=>Cl(q,he),layerEffects:Kt[w],activeClipData:L,liveFrame:k,thumbnailRenderMode:fs,intensity:W.layerIntensities[w],onIntensityChange:q=>z({type:"SET_LAYER_INTENSITY",payload:{layerIndex:w,intensity:q}}),onDeactivateLayerClips:()=>oa(w),onShowLayerFullContextMenu:()=>Ml(w),isBlackout:vn[w],isSolo:zn[w],onToggleBlackout:()=>z({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:w}}),onToggleSolo:()=>z({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:w}}),onLayerSelect:q=>z({type:"SET_SELECTED_CLIP",payload:{layerIndex:q,colIndex:null}})},w)}),"          "]}),m.jsx("div",{className:"clip-deck-container",children:m.jsxs("div",{className:"clip-deck",children:[m.jsx("div",{className:"column-headers-container",children:be.map((_,w)=>m.jsx(Iv,{name:_,index:w,onTrigger:()=>hs(w),onShowColumnHeaderContextMenu:()=>ur(w)},w))}),ge.map((_,w)=>m.jsx("div",{className:"layer-row",children:be.map((L,k)=>{const q=xe?.[w]?.[k];let he=null;q&&q.type==="ilda"?he=q.workerId:q&&q.type==="generator"&&(he=`generator-${w}-${k}`);const J=he?y.current[he]:null,Te=q?.stillFrame||(q?.type==="generator"?q.frames?.[0]:null);return m.jsx(ty,{layerIndex:w,colIndex:k,clipName:He?.[w]?.[k]||`Clip ${w+1}-${k+1}`,clipContent:q,thumbnailFrameIndex:Lt[w][k],thumbnailRenderMode:fs,liveFrame:J,stillFrame:Te,onActivateClick:_e=>Ga(w,k,_e),isActive:dt[w]===k,onUnsupportedFile:jt,onDropEffect:_e=>wl(w,k,_e),onDropGenerator:Tl,onDropDac:(_e,Pe,gt)=>{or(_e,Pe,gt)},onLabelClick:()=>Wr(w,k),isSelected:Ne===w&&We===k,ildaParserWorker:r,onClipHover:En},k)})},w))]})}),m.jsxs("div",{className:"side-panel",children:[m.jsx(gy,{frame:vs,effects:lr,showBeamEffect:Hn,beamAlpha:Mt,fadeAlpha:ln,previewScanRate:ka,beamRenderMode:xa,intensity:Dn,syncSettings:Gt?.syncSettings,bpm:W.bpm,clipDuration:(Gt?.totalFrames||30)/(Gt?.fps||St||30),progress:cr,previewTime:sr.current,onToggleBeamEffect:()=>fr("clip"),onCycleDisplayMode:()=>Xn("clip")}),m.jsx(vy,{activeFrames:_l,showBeamEffect:Jo,beamAlpha:Mt,fadeAlpha:ln,previewScanRate:ka,beamRenderMode:vi,layerIntensities:ys,masterIntensity:Oa,dacSettings:$t?bn.current?bn.current[`${$t.ip}:${$t.channel}`]:on[`${$t.ip}:${$t.channel}`]:null,previewTime:sr.current,onToggleBeamEffect:()=>fr("world"),onCycleDisplayMode:()=>Xn("world")})]}),m.jsxs("div",{className:"middle-bar",children:[m.jsx("div",{className:"middle-bar-left-area",children:m.jsx(yy,{bpm:W.bpm,onBpmChange:_=>z({type:"SET_BPM",payload:_})})}),m.jsxs("div",{className:"middle-bar-mid-area",children:[m.jsx(by,{onPlay:Fa,onPause:Kr,onStop:ja,isPlaying:Jt,isStopped:W.isStopped}),m.jsx(OS,{playbackFps:St,onSpeedChange:Qr})]}),"          			",m.jsx("div",{className:"middle-bar-right-area",children:m.jsx("p",{children:" Right Section of Middle-Bar"})})]}),"          ",m.jsxs("div",{className:"bottom-panel",children:[m.jsxs("div",{className:"bottom-panel-tabs-container",children:[m.jsxs("div",{className:"bottom-panel-tabs",children:[m.jsx("button",{className:`tab-button ${V==="files"?"active":""}`,onClick:()=>oe("files"),children:"Files"}),m.jsx("button",{className:`tab-button ${V==="generators"?"active":""}`,onClick:()=>oe("generators"),children:"Generators"}),m.jsx("button",{className:`tab-button ${V==="effects"?"active":""}`,onClick:()=>oe("effects"),children:"Effects"})]}),m.jsxs("div",{className:"bottom-panel-tab-content",children:[V==="files"&&m.jsx(ny,{onDropIld:(_,w,L)=>r.postMessage({type:"parse-ilda",file:L,layerIndex:_,colIndex:w})}),V==="generators"&&m.jsx(ay,{}),V==="effects"&&m.jsx(ry,{})]})]}),m.jsx(iy,{dacs:ia,onDacSelected:Nl,onDacsDiscovered:Rl,dacSettings:on,onUpdateDacSettings:qn}),m.jsx(dy,{selectedLayerIndex:Ne,autopilotMode:Ne!==null?W.layerAutopilots[Ne]:"off",onAutopilotChange:_=>z({type:"SET_LAYER_AUTOPILOT",payload:{layerIndex:Ne,mode:_}}),layerEffects:Ne!==null?Kt[Ne]:[],assignedDacs:Ne!==null&&W.layerAssignedDacs?W.layerAssignedDacs[Ne]:[],onToggleDacMirror:(_,w,L)=>z({type:"TOGGLE_LAYER_DAC_MIRROR",payload:{layerIndex:_,dacIndex:w,axis:L}}),onRemoveDac:(_,w)=>z({type:"REMOVE_LAYER_DAC",payload:{layerIndex:_,dacIndex:w}}),onAddEffect:_=>Ne!==null&&z({type:"ADD_LAYER_EFFECT",payload:{layerIndex:Ne,effect:_}}),onRemoveEffect:_=>Ne!==null&&z({type:"REMOVE_LAYER_EFFECT",payload:{layerIndex:Ne,effectIndex:_}}),onParamChange:(_,w,L)=>Ne!==null&&z({type:"UPDATE_LAYER_EFFECT_PARAMETER",payload:{layerIndex:Ne,effectIndex:_,paramName:w,newValue:L}})}),m.jsx(fy,{selectedLayerIndex:Ne,selectedColIndex:We,clip:Gt,audioInfo:x(Ne),onAssignAudio:async()=>{const _=await window.electronAPI.showAudioFileDialog();if(_){const w=_.split(/[\\/]/).pop();z({type:"SET_CLIP_AUDIO",payload:{layerIndex:Ne,colIndex:We,audioFile:{path:_,name:w}}})}},onRemoveAudio:()=>z({type:"REMOVE_CLIP_AUDIO",payload:{layerIndex:Ne,colIndex:We}}),onUpdateAudioVolume:(_,w,L)=>z({type:"SET_CLIP_AUDIO_VOLUME",payload:{layerIndex:_,colIndex:w,volume:L}}),onUpdatePlaybackSettings:(_,w,L)=>z({type:"UPDATE_CLIP_PLAYBACK_SETTINGS",payload:{layerIndex:_,colIndex:w,settings:L}}),onSetParamSync:(_,w)=>z({type:"SET_CLIP_PARAM_SYNC",payload:{layerIndex:Ne,colIndex:We,paramId:_,syncMode:w}}),onToggleDacMirror:(_,w,L,k)=>z({type:"TOGGLE_CLIP_DAC_MIRROR",payload:{layerIndex:_,colIndex:w,dacIndex:L,axis:k}}),onRemoveDac:_=>z({type:"REMOVE_CLIP_DAC",payload:{layerIndex:Ne,colIndex:We,dacIndex:_}}),onRemoveEffect:(_,w,L)=>z({type:"REMOVE_CLIP_EFFECT",payload:{layerIndex:_,colIndex:w,effectIndex:L}}),onReorderEffects:(_,w,L,k)=>z({type:"REORDER_CLIP_EFFECTS",payload:{layerIndex:_,colIndex:w,oldIndex:L,newIndex:k}}),onAddEffect:_=>z({type:"ADD_CLIP_EFFECT",payload:{layerIndex:Ne,colIndex:We,effect:_}}),onParameterChange:eu,onGeneratorParameterChange:ms,progressRef:E}),m.jsx(Ey,{enabledShortcuts:de,onOpenOutputSettings:()=>$(!0),onOpenShortcutsSettings:()=>se(!0),quickAssigns:W.quickAssigns,onUpdateKnob:(_,w)=>{const L=W.quickAssigns.knobs[_];L&&L.link&&(L.link.targetType==="effect"||L.link.targetType==="generator"||L.link.targetType==="layerEffect")&&(Yn.current=!0),z({type:"UPDATE_QUICK_CONTROL",payload:{type:"knob",index:_,value:w}})},onToggleButton:_=>{const w=W.quickAssigns.buttons[_],L=w.link;L&&(L.targetType==="transport"?L.paramName==="play"?Fa():L.paramName==="pause"?Kr():L.paramName==="stop"&&ja():L.targetType==="global"?L.paramName==="blackout"?z({type:"TOGGLE_GLOBAL_BLACKOUT"}):L.paramName==="laser_output"?z({type:"TOGGLE_WORLD_OUTPUT_ACTIVE"}):L.paramName==="clear"&&Ci():Yn.current=!0),z({type:"UPDATE_QUICK_CONTROL",payload:{type:"button",index:_,value:!w.value}})},onAssign:(_,w,L)=>z({type:"ASSIGN_QUICK_CONTROL",payload:{type:_,index:w,link:L}})})]})]})]})})]})})})}xv.createRoot(document.getElementById("root")).render(m.jsx(hy,{children:m.jsx(Dy,{children:m.jsxs(_y,{children:[" ",m.jsx(IS,{})]})})}));
