(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=r(o);fetch(o.href,u)}})();function Qf(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var bf={exports:{}},Dl={};var y0;function oy(){if(y0)return Dl;y0=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function r(i,o,u){var f=null;if(u!==void 0&&(f=""+u),o.key!==void 0&&(f=""+o.key),"key"in o){u={};for(var h in o)h!=="key"&&(u[h]=o[h])}else u=o;return o=u.ref,{$$typeof:a,type:i,key:f,ref:o!==void 0?o:null,props:u}}return Dl.Fragment=n,Dl.jsx=r,Dl.jsxs=r,Dl}var b0;function cy(){return b0||(b0=1,bf.exports=oy()),bf.exports}var g=cy(),xf={exports:{}},nt={};var x0;function uy(){if(x0)return nt;x0=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),S=Symbol.iterator;function b(U){return U===null||typeof U!="object"?null:(U=S&&U[S]||U["@@iterator"],typeof U=="function"?U:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,A={};function D(U,Z,ue){this.props=U,this.context=Z,this.refs=A,this.updater=ue||x}D.prototype.isReactComponent={},D.prototype.setState=function(U,Z){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,Z,"setState")},D.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function F(){}F.prototype=D.prototype;function R(U,Z,ue){this.props=U,this.context=Z,this.refs=A,this.updater=ue||x}var N=R.prototype=new F;N.constructor=R,E(N,D.prototype),N.isPureReactComponent=!0;var _=Array.isArray,M={H:null,A:null,T:null,S:null,V:null},j=Object.prototype.hasOwnProperty;function B(U,Z,ue,be,oe,Se){return ue=Se.ref,{$$typeof:a,type:U,key:Z,ref:ue!==void 0?ue:null,props:Se}}function H(U,Z){return B(U.type,Z,void 0,void 0,void 0,U.props)}function K(U){return typeof U=="object"&&U!==null&&U.$$typeof===a}function J(U){var Z={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ue){return Z[ue]})}var G=/\/+/g;function V(U,Z){return typeof U=="object"&&U!==null&&U.key!=null?J(""+U.key):Z.toString(36)}function X(){}function Y(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(X,X):(U.status="pending",U.then(function(Z){U.status==="pending"&&(U.status="fulfilled",U.value=Z)},function(Z){U.status==="pending"&&(U.status="rejected",U.reason=Z)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function Q(U,Z,ue,be,oe){var Se=typeof U;(Se==="undefined"||Se==="boolean")&&(U=null);var Ee=!1;if(U===null)Ee=!0;else switch(Se){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(U.$$typeof){case a:case n:Ee=!0;break;case y:return Ee=U._init,Q(Ee(U._payload),Z,ue,be,oe)}}if(Ee)return oe=oe(U),Ee=be===""?"."+V(U,0):be,_(oe)?(ue="",Ee!=null&&(ue=Ee.replace(G,"$&/")+"/"),Q(oe,Z,ue,"",function(ct){return ct})):oe!=null&&(K(oe)&&(oe=H(oe,ue+(oe.key==null||U&&U.key===oe.key?"":(""+oe.key).replace(G,"$&/")+"/")+Ee)),Z.push(oe)),1;Ee=0;var Xe=be===""?".":be+":";if(_(U))for(var Ge=0;Ge<U.length;Ge++)be=U[Ge],Se=Xe+V(be,Ge),Ee+=Q(be,Z,ue,Se,oe);else if(Ge=b(U),typeof Ge=="function")for(U=Ge.call(U),Ge=0;!(be=U.next()).done;)be=be.value,Se=Xe+V(be,Ge++),Ee+=Q(be,Z,ue,Se,oe);else if(Se==="object"){if(typeof U.then=="function")return Q(Y(U),Z,ue,be,oe);throw Z=String(U),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function L(U,Z,ue){if(U==null)return U;var be=[],oe=0;return Q(U,be,"","",function(Se){return Z.call(ue,Se,oe++)}),be}function z(U){if(U._status===-1){var Z=U._result;Z=Z(),Z.then(function(ue){(U._status===0||U._status===-1)&&(U._status=1,U._result=ue)},function(ue){(U._status===0||U._status===-1)&&(U._status=2,U._result=ue)}),U._status===-1&&(U._status=0,U._result=Z)}if(U._status===1)return U._result.default;throw U._result}var ne=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function fe(){}return nt.Children={map:L,forEach:function(U,Z,ue){L(U,function(){Z.apply(this,arguments)},ue)},count:function(U){var Z=0;return L(U,function(){Z++}),Z},toArray:function(U){return L(U,function(Z){return Z})||[]},only:function(U){if(!K(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},nt.Component=D,nt.Fragment=r,nt.Profiler=o,nt.PureComponent=R,nt.StrictMode=i,nt.Suspense=p,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,nt.__COMPILER_RUNTIME={__proto__:null,c:function(U){return M.H.useMemoCache(U)}},nt.cache=function(U){return function(){return U.apply(null,arguments)}},nt.cloneElement=function(U,Z,ue){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var be=E({},U.props),oe=U.key,Se=void 0;if(Z!=null)for(Ee in Z.ref!==void 0&&(Se=void 0),Z.key!==void 0&&(oe=""+Z.key),Z)!j.call(Z,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&Z.ref===void 0||(be[Ee]=Z[Ee]);var Ee=arguments.length-2;if(Ee===1)be.children=ue;else if(1<Ee){for(var Xe=Array(Ee),Ge=0;Ge<Ee;Ge++)Xe[Ge]=arguments[Ge+2];be.children=Xe}return B(U.type,oe,void 0,void 0,Se,be)},nt.createContext=function(U){return U={$$typeof:f,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:u,_context:U},U},nt.createElement=function(U,Z,ue){var be,oe={},Se=null;if(Z!=null)for(be in Z.key!==void 0&&(Se=""+Z.key),Z)j.call(Z,be)&&be!=="key"&&be!=="__self"&&be!=="__source"&&(oe[be]=Z[be]);var Ee=arguments.length-2;if(Ee===1)oe.children=ue;else if(1<Ee){for(var Xe=Array(Ee),Ge=0;Ge<Ee;Ge++)Xe[Ge]=arguments[Ge+2];oe.children=Xe}if(U&&U.defaultProps)for(be in Ee=U.defaultProps,Ee)oe[be]===void 0&&(oe[be]=Ee[be]);return B(U,Se,void 0,void 0,null,oe)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(U){return{$$typeof:h,render:U}},nt.isValidElement=K,nt.lazy=function(U){return{$$typeof:y,_payload:{_status:-1,_result:U},_init:z}},nt.memo=function(U,Z){return{$$typeof:v,type:U,compare:Z===void 0?null:Z}},nt.startTransition=function(U){var Z=M.T,ue={};M.T=ue;try{var be=U(),oe=M.S;oe!==null&&oe(ue,be),typeof be=="object"&&be!==null&&typeof be.then=="function"&&be.then(fe,ne)}catch(Se){ne(Se)}finally{M.T=Z}},nt.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},nt.use=function(U){return M.H.use(U)},nt.useActionState=function(U,Z,ue){return M.H.useActionState(U,Z,ue)},nt.useCallback=function(U,Z){return M.H.useCallback(U,Z)},nt.useContext=function(U){return M.H.useContext(U)},nt.useDebugValue=function(){},nt.useDeferredValue=function(U,Z){return M.H.useDeferredValue(U,Z)},nt.useEffect=function(U,Z,ue){var be=M.H;if(typeof ue=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return be.useEffect(U,Z)},nt.useId=function(){return M.H.useId()},nt.useImperativeHandle=function(U,Z,ue){return M.H.useImperativeHandle(U,Z,ue)},nt.useInsertionEffect=function(U,Z){return M.H.useInsertionEffect(U,Z)},nt.useLayoutEffect=function(U,Z){return M.H.useLayoutEffect(U,Z)},nt.useMemo=function(U,Z){return M.H.useMemo(U,Z)},nt.useOptimistic=function(U,Z){return M.H.useOptimistic(U,Z)},nt.useReducer=function(U,Z,ue){return M.H.useReducer(U,Z,ue)},nt.useRef=function(U){return M.H.useRef(U)},nt.useState=function(U){return M.H.useState(U)},nt.useSyncExternalStore=function(U,Z,ue){return M.H.useSyncExternalStore(U,Z,ue)},nt.useTransition=function(){return M.H.useTransition()},nt.version="19.1.1",nt}var S0;function Zf(){return S0||(S0=1,xf.exports=uy()),xf.exports}var T=Zf();const Gn=Qf(T);var Sf={exports:{}},_l={},Ef={exports:{}},wf={};var E0;function fy(){return E0||(E0=1,(function(a){function n(L,z){var ne=L.length;L.push(z);e:for(;0<ne;){var fe=ne-1>>>1,U=L[fe];if(0<o(U,z))L[fe]=z,L[ne]=U,ne=fe;else break e}}function r(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var z=L[0],ne=L.pop();if(ne!==z){L[0]=ne;e:for(var fe=0,U=L.length,Z=U>>>1;fe<Z;){var ue=2*(fe+1)-1,be=L[ue],oe=ue+1,Se=L[oe];if(0>o(be,ne))oe<U&&0>o(Se,be)?(L[fe]=Se,L[oe]=ne,fe=oe):(L[fe]=be,L[ue]=ne,fe=ue);else if(oe<U&&0>o(Se,ne))L[fe]=Se,L[oe]=ne,fe=oe;else break e}}return z}function o(L,z){var ne=L.sortIndex-z.sortIndex;return ne!==0?ne:L.id-z.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var f=Date,h=f.now();a.unstable_now=function(){return f.now()-h}}var p=[],v=[],y=1,S=null,b=3,x=!1,E=!1,A=!1,D=!1,F=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function _(L){for(var z=r(v);z!==null;){if(z.callback===null)i(v);else if(z.startTime<=L)i(v),z.sortIndex=z.expirationTime,n(p,z);else break;z=r(v)}}function M(L){if(A=!1,_(L),!E)if(r(p)!==null)E=!0,j||(j=!0,V());else{var z=r(v);z!==null&&Q(M,z.startTime-L)}}var j=!1,B=-1,H=5,K=-1;function J(){return D?!0:!(a.unstable_now()-K<H)}function G(){if(D=!1,j){var L=a.unstable_now();K=L;var z=!0;try{e:{E=!1,A&&(A=!1,R(B),B=-1),x=!0;var ne=b;try{t:{for(_(L),S=r(p);S!==null&&!(S.expirationTime>L&&J());){var fe=S.callback;if(typeof fe=="function"){S.callback=null,b=S.priorityLevel;var U=fe(S.expirationTime<=L);if(L=a.unstable_now(),typeof U=="function"){S.callback=U,_(L),z=!0;break t}S===r(p)&&i(p),_(L)}else i(p);S=r(p)}if(S!==null)z=!0;else{var Z=r(v);Z!==null&&Q(M,Z.startTime-L),z=!1}}break e}finally{S=null,b=ne,x=!1}z=void 0}}finally{z?V():j=!1}}}var V;if(typeof N=="function")V=function(){N(G)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,Y=X.port2;X.port1.onmessage=G,V=function(){Y.postMessage(null)}}else V=function(){F(G,0)};function Q(L,z){B=F(function(){L(a.unstable_now())},z)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(L){L.callback=null},a.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<L?Math.floor(1e3/L):5},a.unstable_getCurrentPriorityLevel=function(){return b},a.unstable_next=function(L){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var ne=b;b=z;try{return L()}finally{b=ne}},a.unstable_requestPaint=function(){D=!0},a.unstable_runWithPriority=function(L,z){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var ne=b;b=L;try{return z()}finally{b=ne}},a.unstable_scheduleCallback=function(L,z,ne){var fe=a.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?fe+ne:fe):ne=fe,L){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=ne+U,L={id:y++,callback:z,priorityLevel:L,startTime:ne,expirationTime:U,sortIndex:-1},ne>fe?(L.sortIndex=ne,n(v,L),r(p)===null&&L===r(v)&&(A?(R(B),B=-1):A=!0,Q(M,ne-fe))):(L.sortIndex=U,n(p,L),E||x||(E=!0,j||(j=!0,V()))),L},a.unstable_shouldYield=J,a.unstable_wrapCallback=function(L){var z=b;return function(){var ne=b;b=z;try{return L.apply(this,arguments)}finally{b=ne}}}})(wf)),wf}var w0;function dy(){return w0||(w0=1,Ef.exports=fy()),Ef.exports}var Af={exports:{}},Tn={};var A0;function py(){if(A0)return Tn;A0=1;var a=Zf();function n(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)v+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(n(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(p,v,y){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:S==null?null:""+S,children:p,containerInfo:v,implementation:y}}var f=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return Tn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Tn.createPortal=function(p,v){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(n(299));return u(p,v,null,y)},Tn.flushSync=function(p){var v=f.T,y=i.p;try{if(f.T=null,i.p=2,p)return p()}finally{f.T=v,i.p=y,i.d.f()}},Tn.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,i.d.C(p,v))},Tn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},Tn.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var y=v.as,S=h(y,v.crossOrigin),b=typeof v.integrity=="string"?v.integrity:void 0,x=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;y==="style"?i.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:S,integrity:b,fetchPriority:x}):y==="script"&&i.d.X(p,{crossOrigin:S,integrity:b,fetchPriority:x,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},Tn.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var y=h(v.as,v.crossOrigin);i.d.M(p,{crossOrigin:y,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&i.d.M(p)},Tn.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var y=v.as,S=h(y,v.crossOrigin);i.d.L(p,y,{crossOrigin:S,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},Tn.preloadModule=function(p,v){if(typeof p=="string")if(v){var y=h(v.as,v.crossOrigin);i.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:y,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else i.d.m(p)},Tn.requestFormReset=function(p){i.d.r(p)},Tn.unstable_batchedUpdates=function(p,v){return p(v)},Tn.useFormState=function(p,v,y){return f.H.useFormState(p,v,y)},Tn.useFormStatus=function(){return f.H.useHostTransitionStatus()},Tn.version="19.1.1",Tn}var T0;function Mm(){if(T0)return Af.exports;T0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),Af.exports=py(),Af.exports}var C0;function hy(){if(C0)return _l;C0=1;var a=dy(),n=Zf(),r=Mm();function i(e){var s="https://react.dev/errors/"+e;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var s=e,l=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,(s.flags&4098)!==0&&(l=s.return),e=s.return;while(e)}return s.tag===3?l:null}function f(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function h(e){if(u(e)!==e)throw Error(i(188))}function p(e){var s=e.alternate;if(!s){if(s=u(e),s===null)throw Error(i(188));return s!==e?null:e}for(var l=e,c=s;;){var d=l.return;if(d===null)break;var m=d.alternate;if(m===null){if(c=d.return,c!==null){l=c;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===l)return h(d),e;if(m===c)return h(d),s;m=m.sibling}throw Error(i(188))}if(l.return!==c.return)l=d,c=m;else{for(var w=!1,C=d.child;C;){if(C===l){w=!0,l=d,c=m;break}if(C===c){w=!0,c=d,l=m;break}C=C.sibling}if(!w){for(C=m.child;C;){if(C===l){w=!0,l=m,c=d;break}if(C===c){w=!0,c=m,l=d;break}C=C.sibling}if(!w)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?e:s}function v(e){var s=e.tag;if(s===5||s===26||s===27||s===6)return e;for(e=e.child;e!==null;){if(s=v(e),s!==null)return s;e=e.sibling}return null}var y=Object.assign,S=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),R=Symbol.for("react.consumer"),N=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function V(e){return e===null||typeof e!="object"?null:(e=G&&e[G]||e["@@iterator"],typeof e=="function"?e:null)}var X=Symbol.for("react.client.reference");function Y(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===X?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case E:return"Fragment";case D:return"Profiler";case A:return"StrictMode";case M:return"Suspense";case j:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case x:return"Portal";case N:return(e.displayName||"Context")+".Provider";case R:return(e._context.displayName||"Context")+".Consumer";case _:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case B:return s=e.displayName||null,s!==null?s:Y(e.type)||"Memo";case H:s=e._payload,e=e._init;try{return Y(e(s))}catch{}}return null}var Q=Array.isArray,L=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},fe=[],U=-1;function Z(e){return{current:e}}function ue(e){0>U||(e.current=fe[U],fe[U]=null,U--)}function be(e,s){U++,fe[U]=e.current,e.current=s}var oe=Z(null),Se=Z(null),Ee=Z(null),Xe=Z(null);function Ge(e,s){switch(be(Ee,s),be(Se,e),be(oe,null),s.nodeType){case 9:case 11:e=(e=s.documentElement)&&(e=e.namespaceURI)?Vh(e):0;break;default:if(e=s.tagName,s=s.namespaceURI)s=Vh(s),e=Xh(s,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}ue(oe),be(oe,e)}function ct(){ue(oe),ue(Se),ue(Ee)}function xn(e){e.memoizedState!==null&&be(Xe,e);var s=oe.current,l=Xh(s,e.type);s!==l&&(be(Se,e),be(oe,l))}function St(e){Se.current===e&&(ue(oe),ue(Se)),Xe.current===e&&(ue(Xe),Tl._currentValue=ne)}var on=Object.prototype.hasOwnProperty,jt=a.unstable_scheduleCallback,Mn=a.unstable_cancelCallback,Ne=a.unstable_shouldYield,ye=a.unstable_requestPaint,te=a.unstable_now,ft=a.unstable_getCurrentPriorityLevel,Dt=a.unstable_ImmediatePriority,Nt=a.unstable_UserBlockingPriority,ke=a.unstable_NormalPriority,qe=a.unstable_LowPriority,Ln=a.unstable_IdlePriority,Ut=a.log,Ia=a.unstable_setDisableYieldValue,va=null,cn=null;function ia(e){if(typeof Ut=="function"&&Ia(e),cn&&typeof cn.setStrictMode=="function")try{cn.setStrictMode(va,e)}catch{}}var Kt=Math.clz32?Math.clz32:Nr,Mr=Math.log,Gs=Math.LN2;function Nr(e){return e>>>=0,e===0?32:31-(Mr(e)/Gs|0)|0}var ze=256,rt=4194304;function Ba(e){var s=e&42;if(s!==0)return s;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Fa(e,s,l){var c=e.pendingLanes;if(c===0)return 0;var d=0,m=e.suspendedLanes,w=e.pingedLanes;e=e.warmLanes;var C=c&134217727;return C!==0?(c=C&~m,c!==0?d=Ba(c):(w&=C,w!==0?d=Ba(w):l||(l=C&~e,l!==0&&(d=Ba(l))))):(C=c&~m,C!==0?d=Ba(C):w!==0?d=Ba(w):l||(l=c&~e,l!==0&&(d=Ba(l)))),d===0?0:s!==0&&s!==d&&(s&m)===0&&(m=d&-d,l=s&-s,m>=l||m===32&&(l&4194048)!==0)?s:d}function Nn(e,s){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&s)===0}function dd(e,s){switch(e){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nr(){var e=ze;return ze<<=1,(ze&4194048)===0&&(ze=256),e}function zs(){var e=rt;return rt<<=1,(rt&62914560)===0&&(rt=4194304),e}function ya(e){for(var s=[],l=0;31>l;l++)s.push(e);return s}function zn(e,s){e.pendingLanes|=s,s!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ar(e,s,l,c,d,m){var w=e.pendingLanes;e.pendingLanes=l,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=l,e.entangledLanes&=l,e.errorRecoveryDisabledLanes&=l,e.shellSuspendCounter=0;var C=e.entanglements,P=e.expirationTimes,re=e.hiddenUpdates;for(l=w&~l;0<l;){var pe=31-Kt(l),ve=1<<pe;C[pe]=0,P[pe]=-1;var se=re[pe];if(se!==null)for(re[pe]=null,pe=0;pe<se.length;pe++){var ie=se[pe];ie!==null&&(ie.lane&=-536870913)}l&=~ve}c!==0&&Hn(e,c,0),m!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=m&~(w&~s))}function Hn(e,s,l){e.pendingLanes|=s,e.suspendedLanes&=~s;var c=31-Kt(s);e.entangledLanes|=s,e.entanglements[c]=e.entanglements[c]|1073741824|l&4194090}function ba(e,s){var l=e.entangledLanes|=s;for(e=e.entanglements;l;){var c=31-Kt(l),d=1<<c;d&s|e[c]&s&&(e[c]|=s),l&=~d}}function Yn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Hs(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Fi(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:d0(e.type))}function ja(e,s){var l=z.p;try{return z.p=e,s()}finally{z.p=l}}var _t=Math.random().toString(36).slice(2),Pt="__reactFiber$"+_t,It="__reactProps$"+_t,fs="__reactContainer$"+_t,$l="__reactEvents$"+_t,Wl="__reactListeners$"+_t,Ys="__reactHandles$"+_t,Rn="__reactResources$"+_t,qn="__reactMarker$"+_t;function zt(e){delete e[Pt],delete e[It],delete e[$l],delete e[Wl],delete e[Ys]}function it(e){var s=e[Pt];if(s)return s;for(var l=e.parentNode;l;){if(s=l[fs]||l[Pt]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(e=Wh(e);e!==null;){if(l=e[Pt])return l;e=Wh(e)}return s}e=l,l=e.parentNode}return null}function Dn(e){if(e=e[Pt]||e[fs]){var s=e.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return e}return null}function _n(e){var s=e.tag;if(s===5||s===26||s===27||s===6)return e.stateNode;throw Error(i(33))}function Pa(e){var s=e[Rn];return s||(s=e[Rn]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ht(e){e[qn]=!0}var qs=new Set,xa={};function la(e,s){Ga(e,s),Ga(e+"Capture",s)}function Ga(e,s){for(xa[e]=s,e=0;e<s.length;e++)qs.add(s[e])}var ds=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vs={},rr={};function ji(e){return on.call(rr,e)?!0:on.call(Vs,e)?!1:ds.test(e)?rr[e]=!0:(Vs[e]=!0,!1)}function Rr(e,s,l){if(ji(s))if(l===null)e.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":e.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(s);return}}e.setAttribute(s,""+l)}}function sr(e,s,l){if(l===null)e.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttribute(s,""+l)}}function Vn(e,s,l,c){if(c===null)e.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(l);return}e.setAttributeNS(s,l,""+c)}}var ps,Pi;function za(e){if(ps===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);ps=s&&s[1]||"",Pi=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ps+e+Pi}var ir=!1;function Dr(e,s){if(!e||ir)return"";ir=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ie){var se=ie}Reflect.construct(e,[],ve)}else{try{ve.call()}catch(ie){se=ie}e.call(ve.prototype)}}else{try{throw Error()}catch(ie){se=ie}(ve=e())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ie){if(ie&&se&&typeof ie.stack=="string")return[ie.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),w=m[0],C=m[1];if(w&&C){var P=w.split(`
`),re=C.split(`
`);for(d=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;d<re.length&&!re[d].includes("DetermineComponentFrameRoot");)d++;if(c===P.length||d===re.length)for(c=P.length-1,d=re.length-1;1<=c&&0<=d&&P[c]!==re[d];)d--;for(;1<=c&&0<=d;c--,d--)if(P[c]!==re[d]){if(c!==1||d!==1)do if(c--,d--,0>d||P[c]!==re[d]){var pe=`
`+P[c].replace(" at new "," at ");return e.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",e.displayName)),pe}while(1<=c&&0<=d);break}}}finally{ir=!1,Error.prepareStackTrace=l}return(l=e?e.displayName||e.name:"")?za(l):""}function Kl(e){switch(e.tag){case 26:case 27:case 5:return za(e.type);case 16:return za("Lazy");case 13:return za("Suspense");case 19:return za("SuspenseList");case 0:case 15:return Dr(e.type,!1);case 11:return Dr(e.type.render,!1);case 1:return Dr(e.type,!0);case 31:return za("Activity");default:return""}}function Xs(e){try{var s="";do s+=Kl(e),e=e.return;while(e);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Jt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gi(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function lr(e){var s=Gi(e)?"checked":"value",l=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),c=""+e[s];if(!e.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var d=l.get,m=l.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return d.call(this)},set:function(w){c=""+w,m.call(this,w)}}),Object.defineProperty(e,s,{enumerable:l.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function _r(e){e._valueTracker||(e._valueTracker=lr(e))}function Jl(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var l=s.getValue(),c="";return e&&(c=Gi(e)?e.checked?"true":"false":e.value),e=c,e!==l?(s.setValue(e),!0):!1}function hs(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ms=/[\n"\\]/g;function Sn(e){return e.replace(ms,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function gs(e,s,l,c,d,m,w,C){e.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.type=w:e.removeAttribute("type"),s!=null?w==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+Jt(s)):e.value!==""+Jt(s)&&(e.value=""+Jt(s)):w!=="submit"&&w!=="reset"||e.removeAttribute("value"),s!=null?kr(e,w,Jt(s)):l!=null?kr(e,w,Jt(l)):c!=null&&e.removeAttribute("value"),d==null&&m!=null&&(e.defaultChecked=!!m),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?e.name=""+Jt(C):e.removeAttribute("name")}function vs(e,s,l,c,d,m,w,C){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.type=m),s!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||s!=null))return;l=l!=null?""+Jt(l):"",s=s!=null?""+Jt(s):l,C||s===e.value||(e.value=s),e.defaultValue=s}c=c??d,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=C?e.checked:!!c,e.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.name=w)}function kr(e,s,l){s==="number"&&hs(e.ownerDocument)===e||e.defaultValue===""+l||(e.defaultValue=""+l)}function Un(e,s,l,c){if(e=e.options,s){s={};for(var d=0;d<l.length;d++)s["$"+l[d]]=!0;for(l=0;l<e.length;l++)d=s.hasOwnProperty("$"+e[l].value),e[l].selected!==d&&(e[l].selected=d),d&&c&&(e[l].defaultSelected=!0)}else{for(l=""+Jt(l),s=null,d=0;d<e.length;d++){if(e[d].value===l){e[d].selected=!0,c&&(e[d].defaultSelected=!0);return}s!==null||e[d].disabled||(s=e[d])}s!==null&&(s.selected=!0)}}function Ha(e,s,l){if(s!=null&&(s=""+Jt(s),s!==e.value&&(e.value=s),l==null)){e.defaultValue!==s&&(e.defaultValue=s);return}e.defaultValue=l!=null?""+Jt(l):""}function ys(e,s,l,c){if(s==null){if(c!=null){if(l!=null)throw Error(i(92));if(Q(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),s=l}l=Jt(s),e.defaultValue=l,c=e.textContent,c===l&&c!==""&&c!==null&&(e.value=c)}function Xn(e,s){if(s){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=s;return}}e.textContent=s}var or=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function eo(e,s,l){var c=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="":c?e.setProperty(s,l):typeof l!="number"||l===0||or.has(s)?s==="float"?e.cssFloat=l:e[s]=(""+l).trim():e[s]=l+"px"}function zi(e,s,l){if(s!=null&&typeof s!="object")throw Error(i(62));if(e=e.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var d in s)c=s[d],s.hasOwnProperty(d)&&l[d]!==c&&eo(e,d,c)}else for(var m in s)s.hasOwnProperty(m)&&eo(e,m,s[m])}function Qs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var en=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),to=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sa(e){return to.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Zs=null;function Hi(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Or=null,Qn=null;function Ea(e){var s=Dn(e);if(s&&(e=s.stateNode)){var l=e[It]||null;e:switch(e=s.stateNode,s.type){case"input":if(gs(e,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Sn(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var c=l[s];if(c!==e&&c.form===e.form){var d=c[It]||null;if(!d)throw Error(i(90));gs(c,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(s=0;s<l.length;s++)c=l[s],c.form===e.form&&Jl(c)}break e;case"textarea":Ha(e,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&Un(e,!!l.multiple,s,!1)}}}var cr=!1;function Lr(e,s,l){if(cr)return e(s,l);cr=!0;try{var c=e(s);return c}finally{if(cr=!1,(Or!==null||Qn!==null)&&(jo(),Or&&(s=Or,e=Qn,Qn=Or=null,Ea(s),e)))for(s=0;s<e.length;s++)Ea(e[s])}}function wa(e,s){var l=e.stateNode;if(l===null)return null;var c=l[It]||null;if(c===null)return null;l=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(i(231,s,typeof l));return l}var kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bs=!1;if(kn)try{var Aa={};Object.defineProperty(Aa,"passive",{get:function(){bs=!0}}),window.addEventListener("test",Aa,Aa),window.removeEventListener("test",Aa,Aa)}catch{bs=!1}var Ya=null,ur=null,$s=null;function no(){if($s)return $s;var e,s=ur,l=s.length,c,d="value"in Ya?Ya.value:Ya.textContent,m=d.length;for(e=0;e<l&&s[e]===d[e];e++);var w=l-e;for(c=1;c<=w&&s[l-c]===d[m-c];c++);return $s=d.slice(e,1<c?1-c:void 0)}function Ws(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function Ks(){return!0}function ao(){return!1}function En(e){function s(l,c,d,m,w){this._reactName=l,this._targetInst=d,this.type=c,this.nativeEvent=m,this.target=w,this.currentTarget=null;for(var C in e)e.hasOwnProperty(C)&&(l=e[C],this[C]=l?l(m):m[C]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Ks:ao,this.isPropagationStopped=ao,this}return y(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ks)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ks)},persist:function(){},isPersistent:Ks}),s}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Js=En(Ta),xs=y({},Ta,{view:0,detail:0}),Cc=En(xs),mn,ei,Ur,Ir=y({},xs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:he,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ur&&(Ur&&e.type==="mousemove"?(mn=e.screenX-Ur.screenX,ei=e.screenY-Ur.screenY):ei=mn=0,Ur=e),mn)},movementY:function(e){return"movementY"in e?e.movementY:ei}}),ro=En(Ir),Mc=y({},Ir,{dataTransfer:0}),Nc=En(Mc),Rc=y({},xs,{relatedTarget:0}),Yi=En(Rc),O=y({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),k=En(O),q=y({},Ta,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I=En(q),W=y({},Ta,{data:0}),de=En(W),ce={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},we={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Me={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ye(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=Me[e])?!!s[e]:!1}function he(){return Ye}var Pe=y({},xs,{key:function(e){if(e.key){var s=ce[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=Ws(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?we[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:he,charCode:function(e){return e.type==="keypress"?Ws(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ws(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ae=En(Pe),Re=y({},Ir,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oe=En(Re),Te=y({},xs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:he}),je=En(Te),We=y({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),Le=En(We),Fe=y({},Ir,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),et=En(Fe),mt=y({},Ta,{newState:0,oldState:0}),pt=En(mt),kt=[9,13,27,32],Et=kn&&"CompositionEvent"in window,tt=null;kn&&"documentMode"in document&&(tt=document.documentMode);var ti=kn&&"TextEvent"in window&&!tt,wn=kn&&(!Et||tt&&8<tt&&11>=tt),Qt=" ",wt=!1;function gt(e,s){switch(e){case"keyup":return kt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tn(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yt=!1;function ut(e,s){switch(e){case"compositionend":return tn(s);case"keypress":return s.which!==32?null:(wt=!0,Qt);case"textInput":return e=s.data,e===Qt&&wt?null:e;default:return null}}function Yt(e,s){if(yt)return e==="compositionend"||!Et&&gt(e,s)?(e=no(),$s=ur=Ya=null,yt=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return wn&&s.locale!=="ko"?null:s.data;default:return null}}var gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qa(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!gn[e.type]:s==="textarea"}function Va(e,s,l,c){Or?Qn?Qn.push(c):Qn=[c]:Or=c,s=qo(s,"onChange"),0<s.length&&(l=new Js("onChange","change",null,l,c),e.push({event:l,listeners:s}))}var Bt=null,Je=null;function oa(e){Gh(e,0)}function un(e){var s=_n(e);if(Jl(s))return e}function In(e,s){if(e==="change")return s}var ni=!1;if(kn){var Ca;if(kn){var Zn="oninput"in document;if(!Zn){var Br=document.createElement("div");Br.setAttribute("oninput","return;"),Zn=typeof Br.oninput=="function"}Ca=Zn}else Ca=!1;ni=Ca&&(!document.documentMode||9<document.documentMode)}function so(){Bt&&(Bt.detachEvent("onpropertychange",ca),Je=Bt=null)}function ca(e){if(e.propertyName==="value"&&un(Je)){var s=[];Va(s,Je,e,Hi(e)),Lr(oa,s)}}function Bn(e,s,l){e==="focusin"?(so(),Bt=s,Je=l,Bt.attachEvent("onpropertychange",ca)):e==="focusout"&&so()}function jg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return un(Je)}function Pg(e,s){if(e==="click")return un(s)}function Gg(e,s){if(e==="input"||e==="change")return un(s)}function zg(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var $n=typeof Object.is=="function"?Object.is:zg;function qi(e,s){if($n(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var l=Object.keys(e),c=Object.keys(s);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var d=l[c];if(!on.call(s,d)||!$n(e[d],s[d]))return!1}return!0}function pd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hd(e,s){var l=pd(e);e=0;for(var c;l;){if(l.nodeType===3){if(c=e+l.textContent.length,e<=s&&c>=s)return{node:l,offset:s-e};e=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=pd(l)}}function md(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?md(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function gd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var s=hs(e.document);s instanceof e.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)e=s.contentWindow;else break;s=hs(e.document)}return s}function Dc(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}var Hg=kn&&"documentMode"in document&&11>=document.documentMode,ai=null,_c=null,Vi=null,kc=!1;function vd(e,s,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;kc||ai==null||ai!==hs(c)||(c=ai,"selectionStart"in c&&Dc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Vi&&qi(Vi,c)||(Vi=c,c=qo(_c,"onSelect"),0<c.length&&(s=new Js("onSelect","select",null,s,l),e.push({event:s,listeners:c}),s.target=ai)))}function Ss(e,s){var l={};return l[e.toLowerCase()]=s.toLowerCase(),l["Webkit"+e]="webkit"+s,l["Moz"+e]="moz"+s,l}var ri={animationend:Ss("Animation","AnimationEnd"),animationiteration:Ss("Animation","AnimationIteration"),animationstart:Ss("Animation","AnimationStart"),transitionrun:Ss("Transition","TransitionRun"),transitionstart:Ss("Transition","TransitionStart"),transitioncancel:Ss("Transition","TransitionCancel"),transitionend:Ss("Transition","TransitionEnd")},Oc={},yd={};kn&&(yd=document.createElement("div").style,"AnimationEvent"in window||(delete ri.animationend.animation,delete ri.animationiteration.animation,delete ri.animationstart.animation),"TransitionEvent"in window||delete ri.transitionend.transition);function Es(e){if(Oc[e])return Oc[e];if(!ri[e])return e;var s=ri[e],l;for(l in s)if(s.hasOwnProperty(l)&&l in yd)return Oc[e]=s[l];return e}var bd=Es("animationend"),xd=Es("animationiteration"),Sd=Es("animationstart"),Yg=Es("transitionrun"),qg=Es("transitionstart"),Vg=Es("transitioncancel"),Ed=Es("transitionend"),wd=new Map,Lc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lc.push("scrollEnd");function Ma(e,s){wd.set(e,s),la(s,[e])}var Ad=new WeakMap;function ua(e,s){if(typeof e=="object"&&e!==null){var l=Ad.get(e);return l!==void 0?l:(s={value:e,source:s,stack:Xs(s)},Ad.set(e,s),s)}return{value:e,source:s,stack:Xs(s)}}var fa=[],si=0,Uc=0;function io(){for(var e=si,s=Uc=si=0;s<e;){var l=fa[s];fa[s++]=null;var c=fa[s];fa[s++]=null;var d=fa[s];fa[s++]=null;var m=fa[s];if(fa[s++]=null,c!==null&&d!==null){var w=c.pending;w===null?d.next=d:(d.next=w.next,w.next=d),c.pending=d}m!==0&&Td(l,d,m)}}function lo(e,s,l,c){fa[si++]=e,fa[si++]=s,fa[si++]=l,fa[si++]=c,Uc|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function Ic(e,s,l,c){return lo(e,s,l,c),oo(e)}function ii(e,s){return lo(e,null,null,s),oo(e)}function Td(e,s,l){e.lanes|=l;var c=e.alternate;c!==null&&(c.lanes|=l);for(var d=!1,m=e.return;m!==null;)m.childLanes|=l,c=m.alternate,c!==null&&(c.childLanes|=l),m.tag===22&&(e=m.stateNode,e===null||e._visibility&1||(d=!0)),e=m,m=m.return;return e.tag===3?(m=e.stateNode,d&&s!==null&&(d=31-Kt(l),e=m.hiddenUpdates,c=e[d],c===null?e[d]=[s]:c.push(s),s.lane=l|536870912),m):null}function oo(e){if(50<vl)throw vl=0,zu=null,Error(i(185));for(var s=e.return;s!==null;)e=s,s=e.return;return e.tag===3?e.stateNode:null}var li={};function Xg(e,s,l,c){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(e,s,l,c){return new Xg(e,s,l,c)}function Bc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function fr(e,s){var l=e.alternate;return l===null?(l=Wn(e.tag,s,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=s,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&65011712,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,s=e.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l.refCleanup=e.refCleanup,l}function Cd(e,s){e.flags&=65011714;var l=e.alternate;return l===null?(e.childLanes=0,e.lanes=s,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=l.childLanes,e.lanes=l.lanes,e.child=l.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=l.memoizedProps,e.memoizedState=l.memoizedState,e.updateQueue=l.updateQueue,e.type=l.type,s=l.dependencies,e.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),e}function co(e,s,l,c,d,m){var w=0;if(c=e,typeof e=="function")Bc(e)&&(w=1);else if(typeof e=="string")w=Zv(e,l,oe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case K:return e=Wn(31,l,s,d),e.elementType=K,e.lanes=m,e;case E:return ws(l.children,d,m,s);case A:w=8,d|=24;break;case D:return e=Wn(12,l,s,d|2),e.elementType=D,e.lanes=m,e;case M:return e=Wn(13,l,s,d),e.elementType=M,e.lanes=m,e;case j:return e=Wn(19,l,s,d),e.elementType=j,e.lanes=m,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case F:case N:w=10;break e;case R:w=9;break e;case _:w=11;break e;case B:w=14;break e;case H:w=16,c=null;break e}w=29,l=Error(i(130,e===null?"null":typeof e,"")),c=null}return s=Wn(w,l,s,d),s.elementType=e,s.type=c,s.lanes=m,s}function ws(e,s,l,c){return e=Wn(7,e,c,s),e.lanes=l,e}function Fc(e,s,l){return e=Wn(6,e,null,s),e.lanes=l,e}function jc(e,s,l){return s=Wn(4,e.children!==null?e.children:[],e.key,s),s.lanes=l,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}var oi=[],ci=0,uo=null,fo=0,da=[],pa=0,As=null,dr=1,pr="";function Ts(e,s){oi[ci++]=fo,oi[ci++]=uo,uo=e,fo=s}function Md(e,s,l){da[pa++]=dr,da[pa++]=pr,da[pa++]=As,As=e;var c=dr;e=pr;var d=32-Kt(c)-1;c&=~(1<<d),l+=1;var m=32-Kt(s)+d;if(30<m){var w=d-d%5;m=(c&(1<<w)-1).toString(32),c>>=w,d-=w,dr=1<<32-Kt(s)+d|l<<d|c,pr=m+e}else dr=1<<m|l<<d|c,pr=e}function Pc(e){e.return!==null&&(Ts(e,1),Md(e,1,0))}function Gc(e){for(;e===uo;)uo=oi[--ci],oi[ci]=null,fo=oi[--ci],oi[ci]=null;for(;e===As;)As=da[--pa],da[pa]=null,pr=da[--pa],da[pa]=null,dr=da[--pa],da[pa]=null}var On=null,qt=null,vt=!1,Cs=null,Xa=!1,zc=Error(i(519));function Ms(e){var s=Error(i(418,""));throw Zi(ua(s,e)),zc}function Nd(e){var s=e.stateNode,l=e.type,c=e.memoizedProps;switch(s[Pt]=e,s[It]=c,l){case"dialog":ot("cancel",s),ot("close",s);break;case"iframe":case"object":case"embed":ot("load",s);break;case"video":case"audio":for(l=0;l<bl.length;l++)ot(bl[l],s);break;case"source":ot("error",s);break;case"img":case"image":case"link":ot("error",s),ot("load",s);break;case"details":ot("toggle",s);break;case"input":ot("invalid",s),vs(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),_r(s);break;case"select":ot("invalid",s);break;case"textarea":ot("invalid",s),ys(s,c.value,c.defaultValue,c.children),_r(s)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||c.suppressHydrationWarning===!0||qh(s.textContent,l)?(c.popover!=null&&(ot("beforetoggle",s),ot("toggle",s)),c.onScroll!=null&&ot("scroll",s),c.onScrollEnd!=null&&ot("scrollend",s),c.onClick!=null&&(s.onclick=Vo),s=!0):s=!1,s||Ms(e)}function Rd(e){for(On=e.return;On;)switch(On.tag){case 5:case 13:Xa=!1;return;case 27:case 3:Xa=!0;return;default:On=On.return}}function Xi(e){if(e!==On)return!1;if(!vt)return Rd(e),vt=!0,!1;var s=e.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=e.type,l=!(l!=="form"&&l!=="button")||rf(e.type,e.memoizedProps)),l=!l),l&&qt&&Ms(e),Rd(e),s===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8)if(l=e.data,l==="/$"){if(s===0){qt=Ra(e.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;e=e.nextSibling}qt=null}}else s===27?(s=qt,Jr(e.type)?(e=cf,cf=null,qt=e):qt=s):qt=On?Ra(e.stateNode.nextSibling):null;return!0}function Qi(){qt=On=null,vt=!1}function Dd(){var e=Cs;return e!==null&&(Pn===null?Pn=e:Pn.push.apply(Pn,e),Cs=null),e}function Zi(e){Cs===null?Cs=[e]:Cs.push(e)}var Hc=Z(null),Ns=null,hr=null;function Fr(e,s,l){be(Hc,s._currentValue),s._currentValue=l}function mr(e){e._currentValue=Hc.current,ue(Hc)}function Yc(e,s,l){for(;e!==null;){var c=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),e===l)break;e=e.return}}function qc(e,s,l,c){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var m=d.dependencies;if(m!==null){var w=d.child;m=m.firstContext;e:for(;m!==null;){var C=m;m=d;for(var P=0;P<s.length;P++)if(C.context===s[P]){m.lanes|=l,C=m.alternate,C!==null&&(C.lanes|=l),Yc(m.return,l,e),c||(w=null);break e}m=C.next}}else if(d.tag===18){if(w=d.return,w===null)throw Error(i(341));w.lanes|=l,m=w.alternate,m!==null&&(m.lanes|=l),Yc(w,l,e),w=null}else w=d.child;if(w!==null)w.return=d;else for(w=d;w!==null;){if(w===e){w=null;break}if(d=w.sibling,d!==null){d.return=w.return,w=d;break}w=w.return}d=w}}function $i(e,s,l,c){e=null;for(var d=s,m=!1;d!==null;){if(!m){if((d.flags&524288)!==0)m=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var w=d.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var C=d.type;$n(d.pendingProps.value,w.value)||(e!==null?e.push(C):e=[C])}}else if(d===Xe.current){if(w=d.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Tl):e=[Tl])}d=d.return}e!==null&&qc(s,e,l,c),s.flags|=262144}function po(e){for(e=e.firstContext;e!==null;){if(!$n(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Rs(e){Ns=e,hr=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function An(e){return _d(Ns,e)}function ho(e,s){return Ns===null&&Rs(e),_d(e,s)}function _d(e,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},hr===null){if(e===null)throw Error(i(308));hr=s,e.dependencies={lanes:0,firstContext:s},e.flags|=524288}else hr=hr.next=s;return l}var Qg=typeof AbortController<"u"?AbortController:function(){var e=[],s=this.signal={aborted:!1,addEventListener:function(l,c){e.push(c)}};this.abort=function(){s.aborted=!0,e.forEach(function(l){return l()})}},Zg=a.unstable_scheduleCallback,$g=a.unstable_NormalPriority,sn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vc(){return{controller:new Qg,data:new Map,refCount:0}}function Wi(e){e.refCount--,e.refCount===0&&Zg($g,function(){e.controller.abort()})}var Ki=null,Xc=0,ui=0,fi=null;function Wg(e,s){if(Ki===null){var l=Ki=[];Xc=0,ui=Zu(),fi={status:"pending",value:void 0,then:function(c){l.push(c)}}}return Xc++,s.then(kd,kd),s}function kd(){if(--Xc===0&&Ki!==null){fi!==null&&(fi.status="fulfilled");var e=Ki;Ki=null,ui=0,fi=null;for(var s=0;s<e.length;s++)(0,e[s])()}}function Kg(e,s){var l=[],c={status:"pending",value:null,reason:null,then:function(d){l.push(d)}};return e.then(function(){c.status="fulfilled",c.value=s;for(var d=0;d<l.length;d++)(0,l[d])(s)},function(d){for(c.status="rejected",c.reason=d,d=0;d<l.length;d++)(0,l[d])(void 0)}),c}var Od=L.S;L.S=function(e,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&Wg(e,s),Od!==null&&Od(e,s)};var Ds=Z(null);function Qc(){var e=Ds.current;return e!==null?e:Ot.pooledCache}function mo(e,s){s===null?be(Ds,Ds.current):be(Ds,s.pool)}function Ld(){var e=Qc();return e===null?null:{parent:sn._currentValue,pool:e}}var Ji=Error(i(460)),Ud=Error(i(474)),go=Error(i(542)),Zc={then:function(){}};function Id(e){return e=e.status,e==="fulfilled"||e==="rejected"}function vo(){}function Bd(e,s,l){switch(l=e[l],l===void 0?e.push(s):l!==s&&(s.then(vo,vo),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw e=s.reason,jd(e),e;default:if(typeof s.status=="string")s.then(vo,vo);else{if(e=Ot,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=s,e.status="pending",e.then(function(c){if(s.status==="pending"){var d=s;d.status="fulfilled",d.value=c}},function(c){if(s.status==="pending"){var d=s;d.status="rejected",d.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw e=s.reason,jd(e),e}throw el=s,Ji}}var el=null;function Fd(){if(el===null)throw Error(i(459));var e=el;return el=null,e}function jd(e){if(e===Ji||e===go)throw Error(i(483))}var jr=!1;function $c(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wc(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Pr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Gr(e,s,l){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(bt&2)!==0){var d=c.pending;return d===null?s.next=s:(s.next=d.next,d.next=s),c.pending=s,s=oo(e),Td(e,null,l),s}return lo(e,c,s,l),oo(e)}function tl(e,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var c=s.lanes;c&=e.pendingLanes,l|=c,s.lanes=l,ba(e,l)}}function Kc(e,s){var l=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var d=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?d=m=w:m=m.next=w,l=l.next}while(l!==null);m===null?d=m=s:m=m.next=s}else d=m=s;l={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=s:e.next=s,l.lastBaseUpdate=s}var Jc=!1;function nl(){if(Jc){var e=fi;if(e!==null)throw e}}function al(e,s,l,c){Jc=!1;var d=e.updateQueue;jr=!1;var m=d.firstBaseUpdate,w=d.lastBaseUpdate,C=d.shared.pending;if(C!==null){d.shared.pending=null;var P=C,re=P.next;P.next=null,w===null?m=re:w.next=re,w=P;var pe=e.alternate;pe!==null&&(pe=pe.updateQueue,C=pe.lastBaseUpdate,C!==w&&(C===null?pe.firstBaseUpdate=re:C.next=re,pe.lastBaseUpdate=P))}if(m!==null){var ve=d.baseState;w=0,pe=re=P=null,C=m;do{var se=C.lane&-536870913,ie=se!==C.lane;if(ie?(dt&se)===se:(c&se)===se){se!==0&&se===ui&&(Jc=!0),pe!==null&&(pe=pe.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var $e=e,Ve=C;se=s;var Ct=l;switch(Ve.tag){case 1:if($e=Ve.payload,typeof $e=="function"){ve=$e.call(Ct,ve,se);break e}ve=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=Ve.payload,se=typeof $e=="function"?$e.call(Ct,ve,se):$e,se==null)break e;ve=y({},ve,se);break e;case 2:jr=!0}}se=C.callback,se!==null&&(e.flags|=64,ie&&(e.flags|=8192),ie=d.callbacks,ie===null?d.callbacks=[se]:ie.push(se))}else ie={lane:se,tag:C.tag,payload:C.payload,callback:C.callback,next:null},pe===null?(re=pe=ie,P=ve):pe=pe.next=ie,w|=se;if(C=C.next,C===null){if(C=d.shared.pending,C===null)break;ie=C,C=ie.next,ie.next=null,d.lastBaseUpdate=ie,d.shared.pending=null}}while(!0);pe===null&&(P=ve),d.baseState=P,d.firstBaseUpdate=re,d.lastBaseUpdate=pe,m===null&&(d.shared.lanes=0),Zr|=w,e.lanes=w,e.memoizedState=ve}}function Pd(e,s){if(typeof e!="function")throw Error(i(191,e));e.call(s)}function Gd(e,s){var l=e.callbacks;if(l!==null)for(e.callbacks=null,e=0;e<l.length;e++)Pd(l[e],s)}var di=Z(null),yo=Z(0);function zd(e,s){e=Er,be(yo,e),be(di,s),Er=e|s.baseLanes}function eu(){be(yo,Er),be(di,di.current)}function tu(){Er=yo.current,ue(di),ue(yo)}var zr=0,at=null,At=null,nn=null,bo=!1,pi=!1,_s=!1,xo=0,rl=0,hi=null,Jg=0;function Zt(){throw Error(i(321))}function nu(e,s){if(s===null)return!1;for(var l=0;l<s.length&&l<e.length;l++)if(!$n(e[l],s[l]))return!1;return!0}function au(e,s,l,c,d,m){return zr=m,at=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=e===null||e.memoizedState===null?Tp:Cp,_s=!1,m=l(c,d),_s=!1,pi&&(m=Yd(s,l,c,d)),Hd(e),m}function Hd(e){L.H=Co;var s=At!==null&&At.next!==null;if(zr=0,nn=At=at=null,bo=!1,rl=0,hi=null,s)throw Error(i(300));e===null||fn||(e=e.dependencies,e!==null&&po(e)&&(fn=!0))}function Yd(e,s,l,c){at=e;var d=0;do{if(pi&&(hi=null),rl=0,pi=!1,25<=d)throw Error(i(301));if(d+=1,nn=At=null,e.updateQueue!=null){var m=e.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}L.H=iv,m=s(l,c)}while(pi);return m}function ev(){var e=L.H,s=e.useState()[0];return s=typeof s.then=="function"?sl(s):s,e=e.useState()[0],(At!==null?At.memoizedState:null)!==e&&(at.flags|=1024),s}function ru(){var e=xo!==0;return xo=0,e}function su(e,s,l){s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~l}function iu(e){if(bo){for(e=e.memoizedState;e!==null;){var s=e.queue;s!==null&&(s.pending=null),e=e.next}bo=!1}zr=0,nn=At=at=null,pi=!1,rl=xo=0,hi=null}function Fn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?at.memoizedState=nn=e:nn=nn.next=e,nn}function an(){if(At===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=At.next;var s=nn===null?at.memoizedState:nn.next;if(s!==null)nn=s,At=e;else{if(e===null)throw at.alternate===null?Error(i(467)):Error(i(310));At=e,e={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},nn===null?at.memoizedState=nn=e:nn=nn.next=e}return nn}function lu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sl(e){var s=rl;return rl+=1,hi===null&&(hi=[]),e=Bd(hi,e,s),s=at,(nn===null?s.memoizedState:nn.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?Tp:Cp),e}function So(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return sl(e);if(e.$$typeof===N)return An(e)}throw Error(i(438,String(e)))}function ou(e){var s=null,l=at.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var c=at.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(d){return d.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=lu(),at.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(e),c=0;c<e;c++)l[c]=J;return s.index++,l}function gr(e,s){return typeof s=="function"?s(e):s}function Eo(e){var s=an();return cu(s,At,e)}function cu(e,s,l){var c=e.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var d=e.baseQueue,m=c.pending;if(m!==null){if(d!==null){var w=d.next;d.next=m.next,m.next=w}s.baseQueue=d=m,c.pending=null}if(m=e.baseState,d===null)e.memoizedState=m;else{s=d.next;var C=w=null,P=null,re=s,pe=!1;do{var ve=re.lane&-536870913;if(ve!==re.lane?(dt&ve)===ve:(zr&ve)===ve){var se=re.revertLane;if(se===0)P!==null&&(P=P.next={lane:0,revertLane:0,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),ve===ui&&(pe=!0);else if((zr&se)===se){re=re.next,se===ui&&(pe=!0);continue}else ve={lane:0,revertLane:re.revertLane,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},P===null?(C=P=ve,w=m):P=P.next=ve,at.lanes|=se,Zr|=se;ve=re.action,_s&&l(m,ve),m=re.hasEagerState?re.eagerState:l(m,ve)}else se={lane:ve,revertLane:re.revertLane,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},P===null?(C=P=se,w=m):P=P.next=se,at.lanes|=ve,Zr|=ve;re=re.next}while(re!==null&&re!==s);if(P===null?w=m:P.next=C,!$n(m,e.memoizedState)&&(fn=!0,pe&&(l=fi,l!==null)))throw l;e.memoizedState=m,e.baseState=w,e.baseQueue=P,c.lastRenderedState=m}return d===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function uu(e){var s=an(),l=s.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=e;var c=l.dispatch,d=l.pending,m=s.memoizedState;if(d!==null){l.pending=null;var w=d=d.next;do m=e(m,w.action),w=w.next;while(w!==d);$n(m,s.memoizedState)||(fn=!0),s.memoizedState=m,s.baseQueue===null&&(s.baseState=m),l.lastRenderedState=m}return[m,c]}function qd(e,s,l){var c=at,d=an(),m=vt;if(m){if(l===void 0)throw Error(i(407));l=l()}else l=s();var w=!$n((At||d).memoizedState,l);w&&(d.memoizedState=l,fn=!0),d=d.queue;var C=Qd.bind(null,c,d,e);if(il(2048,8,C,[e]),d.getSnapshot!==s||w||nn!==null&&nn.memoizedState.tag&1){if(c.flags|=2048,mi(9,wo(),Xd.bind(null,c,d,l,s),null),Ot===null)throw Error(i(349));m||(zr&124)!==0||Vd(c,s,l)}return l}function Vd(e,s,l){e.flags|=16384,e={getSnapshot:s,value:l},s=at.updateQueue,s===null?(s=lu(),at.updateQueue=s,s.stores=[e]):(l=s.stores,l===null?s.stores=[e]:l.push(e))}function Xd(e,s,l,c){s.value=l,s.getSnapshot=c,Zd(s)&&$d(e)}function Qd(e,s,l){return l(function(){Zd(s)&&$d(e)})}function Zd(e){var s=e.getSnapshot;e=e.value;try{var l=s();return!$n(e,l)}catch{return!0}}function $d(e){var s=ii(e,2);s!==null&&na(s,e,2)}function fu(e){var s=Fn();if(typeof e=="function"){var l=e;if(e=l(),_s){ia(!0);try{l()}finally{ia(!1)}}}return s.memoizedState=s.baseState=e,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:e},s}function Wd(e,s,l,c){return e.baseState=l,cu(e,At,typeof c=="function"?c:gr)}function tv(e,s,l,c,d){if(To(e))throw Error(i(485));if(e=s.action,e!==null){var m={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){m.listeners.push(w)}};L.T!==null?l(!0):m.isTransition=!1,c(m),l=s.pending,l===null?(m.next=s.pending=m,Kd(s,m)):(m.next=l.next,s.pending=l.next=m)}}function Kd(e,s){var l=s.action,c=s.payload,d=e.state;if(s.isTransition){var m=L.T,w={};L.T=w;try{var C=l(d,c),P=L.S;P!==null&&P(w,C),Jd(e,s,C)}catch(re){du(e,s,re)}finally{L.T=m}}else try{m=l(d,c),Jd(e,s,m)}catch(re){du(e,s,re)}}function Jd(e,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){ep(e,s,c)},function(c){return du(e,s,c)}):ep(e,s,l)}function ep(e,s,l){s.status="fulfilled",s.value=l,tp(s),e.state=l,s=e.pending,s!==null&&(l=s.next,l===s?e.pending=null:(l=l.next,s.next=l,Kd(e,l)))}function du(e,s,l){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=l,tp(s),s=s.next;while(s!==c)}e.action=null}function tp(e){e=e.listeners;for(var s=0;s<e.length;s++)(0,e[s])()}function np(e,s){return s}function ap(e,s){if(vt){var l=Ot.formState;if(l!==null){e:{var c=at;if(vt){if(qt){t:{for(var d=qt,m=Xa;d.nodeType!==8;){if(!m){d=null;break t}if(d=Ra(d.nextSibling),d===null){d=null;break t}}m=d.data,d=m==="F!"||m==="F"?d:null}if(d){qt=Ra(d.nextSibling),c=d.data==="F!";break e}}Ms(c)}c=!1}c&&(s=l[0])}}return l=Fn(),l.memoizedState=l.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:np,lastRenderedState:s},l.queue=c,l=Ep.bind(null,at,c),c.dispatch=l,c=fu(!1),m=vu.bind(null,at,!1,c.queue),c=Fn(),d={state:s,dispatch:null,action:e,pending:null},c.queue=d,l=tv.bind(null,at,d,m,l),d.dispatch=l,c.memoizedState=e,[s,l,!1]}function rp(e){var s=an();return sp(s,At,e)}function sp(e,s,l){if(s=cu(e,s,np)[0],e=Eo(gr)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=sl(s)}catch(w){throw w===Ji?go:w}else c=s;s=an();var d=s.queue,m=d.dispatch;return l!==s.memoizedState&&(at.flags|=2048,mi(9,wo(),nv.bind(null,d,l),null)),[c,m,e]}function nv(e,s){e.action=s}function ip(e){var s=an(),l=At;if(l!==null)return sp(s,l,e);an(),s=s.memoizedState,l=an();var c=l.queue.dispatch;return l.memoizedState=e,[s,c,!1]}function mi(e,s,l,c){return e={tag:e,create:l,deps:c,inst:s,next:null},s=at.updateQueue,s===null&&(s=lu(),at.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=e.next=e:(c=l.next,l.next=e,e.next=c,s.lastEffect=e),e}function wo(){return{destroy:void 0,resource:void 0}}function lp(){return an().memoizedState}function Ao(e,s,l,c){var d=Fn();c=c===void 0?null:c,at.flags|=e,d.memoizedState=mi(1|s,wo(),l,c)}function il(e,s,l,c){var d=an();c=c===void 0?null:c;var m=d.memoizedState.inst;At!==null&&c!==null&&nu(c,At.memoizedState.deps)?d.memoizedState=mi(s,m,l,c):(at.flags|=e,d.memoizedState=mi(1|s,m,l,c))}function op(e,s){Ao(8390656,8,e,s)}function cp(e,s){il(2048,8,e,s)}function up(e,s){return il(4,2,e,s)}function fp(e,s){return il(4,4,e,s)}function dp(e,s){if(typeof s=="function"){e=e();var l=s(e);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function pp(e,s,l){l=l!=null?l.concat([e]):null,il(4,4,dp.bind(null,s,e),l)}function pu(){}function hp(e,s){var l=an();s=s===void 0?null:s;var c=l.memoizedState;return s!==null&&nu(s,c[1])?c[0]:(l.memoizedState=[e,s],e)}function mp(e,s){var l=an();s=s===void 0?null:s;var c=l.memoizedState;if(s!==null&&nu(s,c[1]))return c[0];if(c=e(),_s){ia(!0);try{e()}finally{ia(!1)}}return l.memoizedState=[c,s],c}function hu(e,s,l){return l===void 0||(zr&1073741824)!==0?e.memoizedState=s:(e.memoizedState=l,e=yh(),at.lanes|=e,Zr|=e,l)}function gp(e,s,l,c){return $n(l,s)?l:di.current!==null?(e=hu(e,l,c),$n(e,s)||(fn=!0),e):(zr&42)===0?(fn=!0,e.memoizedState=l):(e=yh(),at.lanes|=e,Zr|=e,s)}function vp(e,s,l,c,d){var m=z.p;z.p=m!==0&&8>m?m:8;var w=L.T,C={};L.T=C,vu(e,!1,s,l);try{var P=d(),re=L.S;if(re!==null&&re(C,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var pe=Kg(P,c);ll(e,s,pe,ta(e))}else ll(e,s,c,ta(e))}catch(ve){ll(e,s,{then:function(){},status:"rejected",reason:ve},ta())}finally{z.p=m,L.T=w}}function av(){}function mu(e,s,l,c){if(e.tag!==5)throw Error(i(476));var d=yp(e).queue;vp(e,d,s,ne,l===null?av:function(){return bp(e),l(c)})}function yp(e){var s=e.memoizedState;if(s!==null)return s;s={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:ne},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:l},next:null},e.memoizedState=s,e=e.alternate,e!==null&&(e.memoizedState=s),s}function bp(e){var s=yp(e).next.queue;ll(e,s,{},ta())}function gu(){return An(Tl)}function xp(){return an().memoizedState}function Sp(){return an().memoizedState}function rv(e){for(var s=e.return;s!==null;){switch(s.tag){case 24:case 3:var l=ta();e=Pr(l);var c=Gr(s,e,l);c!==null&&(na(c,s,l),tl(c,s,l)),s={cache:Vc()},e.payload=s;return}s=s.return}}function sv(e,s,l){var c=ta();l={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},To(e)?wp(s,l):(l=Ic(e,s,l,c),l!==null&&(na(l,e,c),Ap(l,s,c)))}function Ep(e,s,l){var c=ta();ll(e,s,l,c)}function ll(e,s,l,c){var d={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(To(e))wp(s,d);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=s.lastRenderedReducer,m!==null))try{var w=s.lastRenderedState,C=m(w,l);if(d.hasEagerState=!0,d.eagerState=C,$n(C,w))return lo(e,s,d,0),Ot===null&&io(),!1}catch{}if(l=Ic(e,s,d,c),l!==null)return na(l,e,c),Ap(l,s,c),!0}return!1}function vu(e,s,l,c){if(c={lane:2,revertLane:Zu(),action:c,hasEagerState:!1,eagerState:null,next:null},To(e)){if(s)throw Error(i(479))}else s=Ic(e,l,c,2),s!==null&&na(s,e,2)}function To(e){var s=e.alternate;return e===at||s!==null&&s===at}function wp(e,s){pi=bo=!0;var l=e.pending;l===null?s.next=s:(s.next=l.next,l.next=s),e.pending=s}function Ap(e,s,l){if((l&4194048)!==0){var c=s.lanes;c&=e.pendingLanes,l|=c,s.lanes=l,ba(e,l)}}var Co={readContext:An,use:So,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt},Tp={readContext:An,use:So,useCallback:function(e,s){return Fn().memoizedState=[e,s===void 0?null:s],e},useContext:An,useEffect:op,useImperativeHandle:function(e,s,l){l=l!=null?l.concat([e]):null,Ao(4194308,4,dp.bind(null,s,e),l)},useLayoutEffect:function(e,s){return Ao(4194308,4,e,s)},useInsertionEffect:function(e,s){Ao(4,2,e,s)},useMemo:function(e,s){var l=Fn();s=s===void 0?null:s;var c=e();if(_s){ia(!0);try{e()}finally{ia(!1)}}return l.memoizedState=[c,s],c},useReducer:function(e,s,l){var c=Fn();if(l!==void 0){var d=l(s);if(_s){ia(!0);try{l(s)}finally{ia(!1)}}}else d=s;return c.memoizedState=c.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},c.queue=e,e=e.dispatch=sv.bind(null,at,e),[c.memoizedState,e]},useRef:function(e){var s=Fn();return e={current:e},s.memoizedState=e},useState:function(e){e=fu(e);var s=e.queue,l=Ep.bind(null,at,s);return s.dispatch=l,[e.memoizedState,l]},useDebugValue:pu,useDeferredValue:function(e,s){var l=Fn();return hu(l,e,s)},useTransition:function(){var e=fu(!1);return e=vp.bind(null,at,e.queue,!0,!1),Fn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,s,l){var c=at,d=Fn();if(vt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=s(),Ot===null)throw Error(i(349));(dt&124)!==0||Vd(c,s,l)}d.memoizedState=l;var m={value:l,getSnapshot:s};return d.queue=m,op(Qd.bind(null,c,m,e),[e]),c.flags|=2048,mi(9,wo(),Xd.bind(null,c,m,l,s),null),l},useId:function(){var e=Fn(),s=Ot.identifierPrefix;if(vt){var l=pr,c=dr;l=(c&~(1<<32-Kt(c)-1)).toString(32)+l,s=""+s+"R"+l,l=xo++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=Jg++,s=""+s+"r"+l.toString(32)+"";return e.memoizedState=s},useHostTransitionStatus:gu,useFormState:ap,useActionState:ap,useOptimistic:function(e){var s=Fn();s.memoizedState=s.baseState=e;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=vu.bind(null,at,!0,l),l.dispatch=s,[e,s]},useMemoCache:ou,useCacheRefresh:function(){return Fn().memoizedState=rv.bind(null,at)}},Cp={readContext:An,use:So,useCallback:hp,useContext:An,useEffect:cp,useImperativeHandle:pp,useInsertionEffect:up,useLayoutEffect:fp,useMemo:mp,useReducer:Eo,useRef:lp,useState:function(){return Eo(gr)},useDebugValue:pu,useDeferredValue:function(e,s){var l=an();return gp(l,At.memoizedState,e,s)},useTransition:function(){var e=Eo(gr)[0],s=an().memoizedState;return[typeof e=="boolean"?e:sl(e),s]},useSyncExternalStore:qd,useId:xp,useHostTransitionStatus:gu,useFormState:rp,useActionState:rp,useOptimistic:function(e,s){var l=an();return Wd(l,At,e,s)},useMemoCache:ou,useCacheRefresh:Sp},iv={readContext:An,use:So,useCallback:hp,useContext:An,useEffect:cp,useImperativeHandle:pp,useInsertionEffect:up,useLayoutEffect:fp,useMemo:mp,useReducer:uu,useRef:lp,useState:function(){return uu(gr)},useDebugValue:pu,useDeferredValue:function(e,s){var l=an();return At===null?hu(l,e,s):gp(l,At.memoizedState,e,s)},useTransition:function(){var e=uu(gr)[0],s=an().memoizedState;return[typeof e=="boolean"?e:sl(e),s]},useSyncExternalStore:qd,useId:xp,useHostTransitionStatus:gu,useFormState:ip,useActionState:ip,useOptimistic:function(e,s){var l=an();return At!==null?Wd(l,At,e,s):(l.baseState=e,[e,l.queue.dispatch])},useMemoCache:ou,useCacheRefresh:Sp},gi=null,ol=0;function Mo(e){var s=ol;return ol+=1,gi===null&&(gi=[]),Bd(gi,e,s)}function cl(e,s){s=s.props.ref,e.ref=s!==void 0?s:null}function No(e,s){throw s.$$typeof===S?Error(i(525)):(e=Object.prototype.toString.call(s),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)))}function Mp(e){var s=e._init;return s(e._payload)}function Np(e){function s(ee,$){if(e){var ae=ee.deletions;ae===null?(ee.deletions=[$],ee.flags|=16):ae.push($)}}function l(ee,$){if(!e)return null;for(;$!==null;)s(ee,$),$=$.sibling;return null}function c(ee){for(var $=new Map;ee!==null;)ee.key!==null?$.set(ee.key,ee):$.set(ee.index,ee),ee=ee.sibling;return $}function d(ee,$){return ee=fr(ee,$),ee.index=0,ee.sibling=null,ee}function m(ee,$,ae){return ee.index=ae,e?(ae=ee.alternate,ae!==null?(ae=ae.index,ae<$?(ee.flags|=67108866,$):ae):(ee.flags|=67108866,$)):(ee.flags|=1048576,$)}function w(ee){return e&&ee.alternate===null&&(ee.flags|=67108866),ee}function C(ee,$,ae,me){return $===null||$.tag!==6?($=Fc(ae,ee.mode,me),$.return=ee,$):($=d($,ae),$.return=ee,$)}function P(ee,$,ae,me){var Ue=ae.type;return Ue===E?pe(ee,$,ae.props.children,me,ae.key):$!==null&&($.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===H&&Mp(Ue)===$.type)?($=d($,ae.props),cl($,ae),$.return=ee,$):($=co(ae.type,ae.key,ae.props,null,ee.mode,me),cl($,ae),$.return=ee,$)}function re(ee,$,ae,me){return $===null||$.tag!==4||$.stateNode.containerInfo!==ae.containerInfo||$.stateNode.implementation!==ae.implementation?($=jc(ae,ee.mode,me),$.return=ee,$):($=d($,ae.children||[]),$.return=ee,$)}function pe(ee,$,ae,me,Ue){return $===null||$.tag!==7?($=ws(ae,ee.mode,me,Ue),$.return=ee,$):($=d($,ae),$.return=ee,$)}function ve(ee,$,ae){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Fc(""+$,ee.mode,ae),$.return=ee,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return ae=co($.type,$.key,$.props,null,ee.mode,ae),cl(ae,$),ae.return=ee,ae;case x:return $=jc($,ee.mode,ae),$.return=ee,$;case H:var me=$._init;return $=me($._payload),ve(ee,$,ae)}if(Q($)||V($))return $=ws($,ee.mode,ae,null),$.return=ee,$;if(typeof $.then=="function")return ve(ee,Mo($),ae);if($.$$typeof===N)return ve(ee,ho(ee,$),ae);No(ee,$)}return null}function se(ee,$,ae,me){var Ue=$!==null?$.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Ue!==null?null:C(ee,$,""+ae,me);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case b:return ae.key===Ue?P(ee,$,ae,me):null;case x:return ae.key===Ue?re(ee,$,ae,me):null;case H:return Ue=ae._init,ae=Ue(ae._payload),se(ee,$,ae,me)}if(Q(ae)||V(ae))return Ue!==null?null:pe(ee,$,ae,me,null);if(typeof ae.then=="function")return se(ee,$,Mo(ae),me);if(ae.$$typeof===N)return se(ee,$,ho(ee,ae),me);No(ee,ae)}return null}function ie(ee,$,ae,me,Ue){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return ee=ee.get(ae)||null,C($,ee,""+me,Ue);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case b:return ee=ee.get(me.key===null?ae:me.key)||null,P($,ee,me,Ue);case x:return ee=ee.get(me.key===null?ae:me.key)||null,re($,ee,me,Ue);case H:var st=me._init;return me=st(me._payload),ie(ee,$,ae,me,Ue)}if(Q(me)||V(me))return ee=ee.get(ae)||null,pe($,ee,me,Ue,null);if(typeof me.then=="function")return ie(ee,$,ae,Mo(me),Ue);if(me.$$typeof===N)return ie(ee,$,ae,ho($,me),Ue);No($,me)}return null}function $e(ee,$,ae,me){for(var Ue=null,st=null,He=$,Qe=$=0,pn=null;He!==null&&Qe<ae.length;Qe++){He.index>Qe?(pn=He,He=null):pn=He.sibling;var ht=se(ee,He,ae[Qe],me);if(ht===null){He===null&&(He=pn);break}e&&He&&ht.alternate===null&&s(ee,He),$=m(ht,$,Qe),st===null?Ue=ht:st.sibling=ht,st=ht,He=pn}if(Qe===ae.length)return l(ee,He),vt&&Ts(ee,Qe),Ue;if(He===null){for(;Qe<ae.length;Qe++)He=ve(ee,ae[Qe],me),He!==null&&($=m(He,$,Qe),st===null?Ue=He:st.sibling=He,st=He);return vt&&Ts(ee,Qe),Ue}for(He=c(He);Qe<ae.length;Qe++)pn=ie(He,ee,Qe,ae[Qe],me),pn!==null&&(e&&pn.alternate!==null&&He.delete(pn.key===null?Qe:pn.key),$=m(pn,$,Qe),st===null?Ue=pn:st.sibling=pn,st=pn);return e&&He.forEach(function(rs){return s(ee,rs)}),vt&&Ts(ee,Qe),Ue}function Ve(ee,$,ae,me){if(ae==null)throw Error(i(151));for(var Ue=null,st=null,He=$,Qe=$=0,pn=null,ht=ae.next();He!==null&&!ht.done;Qe++,ht=ae.next()){He.index>Qe?(pn=He,He=null):pn=He.sibling;var rs=se(ee,He,ht.value,me);if(rs===null){He===null&&(He=pn);break}e&&He&&rs.alternate===null&&s(ee,He),$=m(rs,$,Qe),st===null?Ue=rs:st.sibling=rs,st=rs,He=pn}if(ht.done)return l(ee,He),vt&&Ts(ee,Qe),Ue;if(He===null){for(;!ht.done;Qe++,ht=ae.next())ht=ve(ee,ht.value,me),ht!==null&&($=m(ht,$,Qe),st===null?Ue=ht:st.sibling=ht,st=ht);return vt&&Ts(ee,Qe),Ue}for(He=c(He);!ht.done;Qe++,ht=ae.next())ht=ie(He,ee,Qe,ht.value,me),ht!==null&&(e&&ht.alternate!==null&&He.delete(ht.key===null?Qe:ht.key),$=m(ht,$,Qe),st===null?Ue=ht:st.sibling=ht,st=ht);return e&&He.forEach(function(ly){return s(ee,ly)}),vt&&Ts(ee,Qe),Ue}function Ct(ee,$,ae,me){if(typeof ae=="object"&&ae!==null&&ae.type===E&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case b:e:{for(var Ue=ae.key;$!==null;){if($.key===Ue){if(Ue=ae.type,Ue===E){if($.tag===7){l(ee,$.sibling),me=d($,ae.props.children),me.return=ee,ee=me;break e}}else if($.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===H&&Mp(Ue)===$.type){l(ee,$.sibling),me=d($,ae.props),cl(me,ae),me.return=ee,ee=me;break e}l(ee,$);break}else s(ee,$);$=$.sibling}ae.type===E?(me=ws(ae.props.children,ee.mode,me,ae.key),me.return=ee,ee=me):(me=co(ae.type,ae.key,ae.props,null,ee.mode,me),cl(me,ae),me.return=ee,ee=me)}return w(ee);case x:e:{for(Ue=ae.key;$!==null;){if($.key===Ue)if($.tag===4&&$.stateNode.containerInfo===ae.containerInfo&&$.stateNode.implementation===ae.implementation){l(ee,$.sibling),me=d($,ae.children||[]),me.return=ee,ee=me;break e}else{l(ee,$);break}else s(ee,$);$=$.sibling}me=jc(ae,ee.mode,me),me.return=ee,ee=me}return w(ee);case H:return Ue=ae._init,ae=Ue(ae._payload),Ct(ee,$,ae,me)}if(Q(ae))return $e(ee,$,ae,me);if(V(ae)){if(Ue=V(ae),typeof Ue!="function")throw Error(i(150));return ae=Ue.call(ae),Ve(ee,$,ae,me)}if(typeof ae.then=="function")return Ct(ee,$,Mo(ae),me);if(ae.$$typeof===N)return Ct(ee,$,ho(ee,ae),me);No(ee,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,$!==null&&$.tag===6?(l(ee,$.sibling),me=d($,ae),me.return=ee,ee=me):(l(ee,$),me=Fc(ae,ee.mode,me),me.return=ee,ee=me),w(ee)):l(ee,$)}return function(ee,$,ae,me){try{ol=0;var Ue=Ct(ee,$,ae,me);return gi=null,Ue}catch(He){if(He===Ji||He===go)throw He;var st=Wn(29,He,null,ee.mode);return st.lanes=me,st.return=ee,st}}}var vi=Np(!0),Rp=Np(!1),ha=Z(null),Qa=null;function Hr(e){var s=e.alternate;be(ln,ln.current&1),be(ha,e),Qa===null&&(s===null||di.current!==null||s.memoizedState!==null)&&(Qa=e)}function Dp(e){if(e.tag===22){if(be(ln,ln.current),be(ha,e),Qa===null){var s=e.alternate;s!==null&&s.memoizedState!==null&&(Qa=e)}}else Yr()}function Yr(){be(ln,ln.current),be(ha,ha.current)}function vr(e){ue(ha),Qa===e&&(Qa=null),ue(ln)}var ln=Z(0);function Ro(e){for(var s=e;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||of(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function yu(e,s,l,c){s=e.memoizedState,l=l(c,s),l=l==null?s:y({},s,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var bu={enqueueSetState:function(e,s,l){e=e._reactInternals;var c=ta(),d=Pr(c);d.payload=s,l!=null&&(d.callback=l),s=Gr(e,d,c),s!==null&&(na(s,e,c),tl(s,e,c))},enqueueReplaceState:function(e,s,l){e=e._reactInternals;var c=ta(),d=Pr(c);d.tag=1,d.payload=s,l!=null&&(d.callback=l),s=Gr(e,d,c),s!==null&&(na(s,e,c),tl(s,e,c))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var l=ta(),c=Pr(l);c.tag=2,s!=null&&(c.callback=s),s=Gr(e,c,l),s!==null&&(na(s,e,l),tl(s,e,l))}};function _p(e,s,l,c,d,m,w){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,m,w):s.prototype&&s.prototype.isPureReactComponent?!qi(l,c)||!qi(d,m):!0}function kp(e,s,l,c){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,c),s.state!==e&&bu.enqueueReplaceState(s,s.state,null)}function ks(e,s){var l=s;if("ref"in s){l={};for(var c in s)c!=="ref"&&(l[c]=s[c])}if(e=e.defaultProps){l===s&&(l=y({},l));for(var d in e)l[d]===void 0&&(l[d]=e[d])}return l}var Do=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Op(e){Do(e)}function Lp(e){console.error(e)}function Up(e){Do(e)}function _o(e,s){try{var l=e.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function Ip(e,s,l){try{var c=e.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function xu(e,s,l){return l=Pr(l),l.tag=3,l.payload={element:null},l.callback=function(){_o(e,s)},l}function Bp(e){return e=Pr(e),e.tag=3,e}function Fp(e,s,l,c){var d=l.type.getDerivedStateFromError;if(typeof d=="function"){var m=c.value;e.payload=function(){return d(m)},e.callback=function(){Ip(s,l,c)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(e.callback=function(){Ip(s,l,c),typeof d!="function"&&($r===null?$r=new Set([this]):$r.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})})}function lv(e,s,l,c,d){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=l.alternate,s!==null&&$i(s,l,d,!0),l=ha.current,l!==null){switch(l.tag){case 13:return Qa===null?Yu():l.alternate===null&&Vt===0&&(Vt=3),l.flags&=-257,l.flags|=65536,l.lanes=d,c===Zc?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([c]):s.add(c),Vu(e,c,d)),!1;case 22:return l.flags|=65536,c===Zc?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([c]):l.add(c)),Vu(e,c,d)),!1}throw Error(i(435,l.tag))}return Vu(e,c,d),Yu(),!1}if(vt)return s=ha.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=d,c!==zc&&(e=Error(i(422),{cause:c}),Zi(ua(e,l)))):(c!==zc&&(s=Error(i(423),{cause:c}),Zi(ua(s,l))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,c=ua(c,l),d=xu(e.stateNode,c,d),Kc(e,d),Vt!==4&&(Vt=2)),!1;var m=Error(i(520),{cause:c});if(m=ua(m,l),gl===null?gl=[m]:gl.push(m),Vt!==4&&(Vt=2),s===null)return!0;c=ua(c,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,e=d&-d,l.lanes|=e,e=xu(l.stateNode,c,e),Kc(l,e),!1;case 1:if(s=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&($r===null||!$r.has(m))))return l.flags|=65536,d&=-d,l.lanes|=d,d=Bp(d),Fp(d,e,l,c),Kc(l,d),!1}l=l.return}while(l!==null);return!1}var jp=Error(i(461)),fn=!1;function vn(e,s,l,c){s.child=e===null?Rp(s,null,l,c):vi(s,e.child,l,c)}function Pp(e,s,l,c,d){l=l.render;var m=s.ref;if("ref"in c){var w={};for(var C in c)C!=="ref"&&(w[C]=c[C])}else w=c;return Rs(s),c=au(e,s,l,w,m,d),C=ru(),e!==null&&!fn?(su(e,s,d),yr(e,s,d)):(vt&&C&&Pc(s),s.flags|=1,vn(e,s,c,d),s.child)}function Gp(e,s,l,c,d){if(e===null){var m=l.type;return typeof m=="function"&&!Bc(m)&&m.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=m,zp(e,s,m,c,d)):(e=co(l.type,null,c,s,s.mode,d),e.ref=s.ref,e.return=s,s.child=e)}if(m=e.child,!Nu(e,d)){var w=m.memoizedProps;if(l=l.compare,l=l!==null?l:qi,l(w,c)&&e.ref===s.ref)return yr(e,s,d)}return s.flags|=1,e=fr(m,c),e.ref=s.ref,e.return=s,s.child=e}function zp(e,s,l,c,d){if(e!==null){var m=e.memoizedProps;if(qi(m,c)&&e.ref===s.ref)if(fn=!1,s.pendingProps=c=m,Nu(e,d))(e.flags&131072)!==0&&(fn=!0);else return s.lanes=e.lanes,yr(e,s,d)}return Su(e,s,l,c,d)}function Hp(e,s,l){var c=s.pendingProps,d=c.children,m=e!==null?e.memoizedState:null;if(c.mode==="hidden"){if((s.flags&128)!==0){if(c=m!==null?m.baseLanes|l:l,e!==null){for(d=s.child=e.child,m=0;d!==null;)m=m|d.lanes|d.childLanes,d=d.sibling;s.childLanes=m&~c}else s.childLanes=0,s.child=null;return Yp(e,s,c,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},e!==null&&mo(s,m!==null?m.cachePool:null),m!==null?zd(s,m):eu(),Dp(s);else return s.lanes=s.childLanes=536870912,Yp(e,s,m!==null?m.baseLanes|l:l,l)}else m!==null?(mo(s,m.cachePool),zd(s,m),Yr(),s.memoizedState=null):(e!==null&&mo(s,null),eu(),Yr());return vn(e,s,d,l),s.child}function Yp(e,s,l,c){var d=Qc();return d=d===null?null:{parent:sn._currentValue,pool:d},s.memoizedState={baseLanes:l,cachePool:d},e!==null&&mo(s,null),eu(),Dp(s),e!==null&&$i(e,s,c,!0),null}function ko(e,s){var l=s.ref;if(l===null)e!==null&&e.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(e===null||e.ref!==l)&&(s.flags|=4194816)}}function Su(e,s,l,c,d){return Rs(s),l=au(e,s,l,c,void 0,d),c=ru(),e!==null&&!fn?(su(e,s,d),yr(e,s,d)):(vt&&c&&Pc(s),s.flags|=1,vn(e,s,l,d),s.child)}function qp(e,s,l,c,d,m){return Rs(s),s.updateQueue=null,l=Yd(s,c,l,d),Hd(e),c=ru(),e!==null&&!fn?(su(e,s,m),yr(e,s,m)):(vt&&c&&Pc(s),s.flags|=1,vn(e,s,l,m),s.child)}function Vp(e,s,l,c,d){if(Rs(s),s.stateNode===null){var m=li,w=l.contextType;typeof w=="object"&&w!==null&&(m=An(w)),m=new l(c,m),s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=bu,s.stateNode=m,m._reactInternals=s,m=s.stateNode,m.props=c,m.state=s.memoizedState,m.refs={},$c(s),w=l.contextType,m.context=typeof w=="object"&&w!==null?An(w):li,m.state=s.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(yu(s,l,w,c),m.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(w=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),w!==m.state&&bu.enqueueReplaceState(m,m.state,null),al(s,c,m,d),nl(),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(e===null){m=s.stateNode;var C=s.memoizedProps,P=ks(l,C);m.props=P;var re=m.context,pe=l.contextType;w=li,typeof pe=="object"&&pe!==null&&(w=An(pe));var ve=l.getDerivedStateFromProps;pe=typeof ve=="function"||typeof m.getSnapshotBeforeUpdate=="function",C=s.pendingProps!==C,pe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(C||re!==w)&&kp(s,m,c,w),jr=!1;var se=s.memoizedState;m.state=se,al(s,c,m,d),nl(),re=s.memoizedState,C||se!==re||jr?(typeof ve=="function"&&(yu(s,l,ve,c),re=s.memoizedState),(P=jr||_p(s,l,P,c,se,re,w))?(pe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(s.flags|=4194308)):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=re),m.props=c,m.state=re,m.context=w,c=P):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{m=s.stateNode,Wc(e,s),w=s.memoizedProps,pe=ks(l,w),m.props=pe,ve=s.pendingProps,se=m.context,re=l.contextType,P=li,typeof re=="object"&&re!==null&&(P=An(re)),C=l.getDerivedStateFromProps,(re=typeof C=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w!==ve||se!==P)&&kp(s,m,c,P),jr=!1,se=s.memoizedState,m.state=se,al(s,c,m,d),nl();var ie=s.memoizedState;w!==ve||se!==ie||jr||e!==null&&e.dependencies!==null&&po(e.dependencies)?(typeof C=="function"&&(yu(s,l,C,c),ie=s.memoizedState),(pe=jr||_p(s,l,pe,c,se,ie,P)||e!==null&&e.dependencies!==null&&po(e.dependencies))?(re||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,ie,P),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,ie,P)),typeof m.componentDidUpdate=="function"&&(s.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof m.componentDidUpdate!="function"||w===e.memoizedProps&&se===e.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&se===e.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=ie),m.props=c,m.state=ie,m.context=P,c=pe):(typeof m.componentDidUpdate!="function"||w===e.memoizedProps&&se===e.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&se===e.memoizedState||(s.flags|=1024),c=!1)}return m=c,ko(e,s),c=(s.flags&128)!==0,m||c?(m=s.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:m.render(),s.flags|=1,e!==null&&c?(s.child=vi(s,e.child,null,d),s.child=vi(s,null,l,d)):vn(e,s,l,d),s.memoizedState=m.state,e=s.child):e=yr(e,s,d),e}function Xp(e,s,l,c){return Qi(),s.flags|=256,vn(e,s,l,c),s.child}var Eu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wu(e){return{baseLanes:e,cachePool:Ld()}}function Au(e,s,l){return e=e!==null?e.childLanes&~l:0,s&&(e|=ma),e}function Qp(e,s,l){var c=s.pendingProps,d=!1,m=(s.flags&128)!==0,w;if((w=m)||(w=e!==null&&e.memoizedState===null?!1:(ln.current&2)!==0),w&&(d=!0,s.flags&=-129),w=(s.flags&32)!==0,s.flags&=-33,e===null){if(vt){if(d?Hr(s):Yr(),vt){var C=qt,P;if(P=C){e:{for(P=C,C=Xa;P.nodeType!==8;){if(!C){C=null;break e}if(P=Ra(P.nextSibling),P===null){C=null;break e}}C=P}C!==null?(s.memoizedState={dehydrated:C,treeContext:As!==null?{id:dr,overflow:pr}:null,retryLane:536870912,hydrationErrors:null},P=Wn(18,null,null,0),P.stateNode=C,P.return=s,s.child=P,On=s,qt=null,P=!0):P=!1}P||Ms(s)}if(C=s.memoizedState,C!==null&&(C=C.dehydrated,C!==null))return of(C)?s.lanes=32:s.lanes=536870912,null;vr(s)}return C=c.children,c=c.fallback,d?(Yr(),d=s.mode,C=Oo({mode:"hidden",children:C},d),c=ws(c,d,l,null),C.return=s,c.return=s,C.sibling=c,s.child=C,d=s.child,d.memoizedState=wu(l),d.childLanes=Au(e,w,l),s.memoizedState=Eu,c):(Hr(s),Tu(s,C))}if(P=e.memoizedState,P!==null&&(C=P.dehydrated,C!==null)){if(m)s.flags&256?(Hr(s),s.flags&=-257,s=Cu(e,s,l)):s.memoizedState!==null?(Yr(),s.child=e.child,s.flags|=128,s=null):(Yr(),d=c.fallback,C=s.mode,c=Oo({mode:"visible",children:c.children},C),d=ws(d,C,l,null),d.flags|=2,c.return=s,d.return=s,c.sibling=d,s.child=c,vi(s,e.child,null,l),c=s.child,c.memoizedState=wu(l),c.childLanes=Au(e,w,l),s.memoizedState=Eu,s=d);else if(Hr(s),of(C)){if(w=C.nextSibling&&C.nextSibling.dataset,w)var re=w.dgst;w=re,c=Error(i(419)),c.stack="",c.digest=w,Zi({value:c,source:null,stack:null}),s=Cu(e,s,l)}else if(fn||$i(e,s,l,!1),w=(l&e.childLanes)!==0,fn||w){if(w=Ot,w!==null&&(c=l&-l,c=(c&42)!==0?1:Yn(c),c=(c&(w.suspendedLanes|l))!==0?0:c,c!==0&&c!==P.retryLane))throw P.retryLane=c,ii(e,c),na(w,e,c),jp;C.data==="$?"||Yu(),s=Cu(e,s,l)}else C.data==="$?"?(s.flags|=192,s.child=e.child,s=null):(e=P.treeContext,qt=Ra(C.nextSibling),On=s,vt=!0,Cs=null,Xa=!1,e!==null&&(da[pa++]=dr,da[pa++]=pr,da[pa++]=As,dr=e.id,pr=e.overflow,As=s),s=Tu(s,c.children),s.flags|=4096);return s}return d?(Yr(),d=c.fallback,C=s.mode,P=e.child,re=P.sibling,c=fr(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,re!==null?d=fr(re,d):(d=ws(d,C,l,null),d.flags|=2),d.return=s,c.return=s,c.sibling=d,s.child=c,c=d,d=s.child,C=e.child.memoizedState,C===null?C=wu(l):(P=C.cachePool,P!==null?(re=sn._currentValue,P=P.parent!==re?{parent:re,pool:re}:P):P=Ld(),C={baseLanes:C.baseLanes|l,cachePool:P}),d.memoizedState=C,d.childLanes=Au(e,w,l),s.memoizedState=Eu,c):(Hr(s),l=e.child,e=l.sibling,l=fr(l,{mode:"visible",children:c.children}),l.return=s,l.sibling=null,e!==null&&(w=s.deletions,w===null?(s.deletions=[e],s.flags|=16):w.push(e)),s.child=l,s.memoizedState=null,l)}function Tu(e,s){return s=Oo({mode:"visible",children:s},e.mode),s.return=e,e.child=s}function Oo(e,s){return e=Wn(22,e,null,s),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Cu(e,s,l){return vi(s,e.child,null,l),e=Tu(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function Zp(e,s,l){e.lanes|=s;var c=e.alternate;c!==null&&(c.lanes|=s),Yc(e.return,s,l)}function Mu(e,s,l,c,d){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:d}:(m.isBackwards=s,m.rendering=null,m.renderingStartTime=0,m.last=c,m.tail=l,m.tailMode=d)}function $p(e,s,l){var c=s.pendingProps,d=c.revealOrder,m=c.tail;if(vn(e,s,c.children,l),c=ln.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zp(e,l,s);else if(e.tag===19)Zp(e,l,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}switch(be(ln,c),d){case"forwards":for(l=s.child,d=null;l!==null;)e=l.alternate,e!==null&&Ro(e)===null&&(d=l),l=l.sibling;l=d,l===null?(d=s.child,s.child=null):(d=l.sibling,l.sibling=null),Mu(s,!1,d,l,m);break;case"backwards":for(l=null,d=s.child,s.child=null;d!==null;){if(e=d.alternate,e!==null&&Ro(e)===null){s.child=d;break}e=d.sibling,d.sibling=l,l=d,d=e}Mu(s,!0,l,null,m);break;case"together":Mu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function yr(e,s,l){if(e!==null&&(s.dependencies=e.dependencies),Zr|=s.lanes,(l&s.childLanes)===0)if(e!==null){if($i(e,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(e!==null&&s.child!==e.child)throw Error(i(153));if(s.child!==null){for(e=s.child,l=fr(e,e.pendingProps),s.child=l,l.return=s;e.sibling!==null;)e=e.sibling,l=l.sibling=fr(e,e.pendingProps),l.return=s;l.sibling=null}return s.child}function Nu(e,s){return(e.lanes&s)!==0?!0:(e=e.dependencies,!!(e!==null&&po(e)))}function ov(e,s,l){switch(s.tag){case 3:Ge(s,s.stateNode.containerInfo),Fr(s,sn,e.memoizedState.cache),Qi();break;case 27:case 5:xn(s);break;case 4:Ge(s,s.stateNode.containerInfo);break;case 10:Fr(s,s.type,s.memoizedProps.value);break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(Hr(s),s.flags|=128,null):(l&s.child.childLanes)!==0?Qp(e,s,l):(Hr(s),e=yr(e,s,l),e!==null?e.sibling:null);Hr(s);break;case 19:var d=(e.flags&128)!==0;if(c=(l&s.childLanes)!==0,c||($i(e,s,l,!1),c=(l&s.childLanes)!==0),d){if(c)return $p(e,s,l);s.flags|=128}if(d=s.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),be(ln,ln.current),c)break;return null;case 22:case 23:return s.lanes=0,Hp(e,s,l);case 24:Fr(s,sn,e.memoizedState.cache)}return yr(e,s,l)}function Wp(e,s,l){if(e!==null)if(e.memoizedProps!==s.pendingProps)fn=!0;else{if(!Nu(e,l)&&(s.flags&128)===0)return fn=!1,ov(e,s,l);fn=(e.flags&131072)!==0}else fn=!1,vt&&(s.flags&1048576)!==0&&Md(s,fo,s.index);switch(s.lanes=0,s.tag){case 16:e:{e=s.pendingProps;var c=s.elementType,d=c._init;if(c=d(c._payload),s.type=c,typeof c=="function")Bc(c)?(e=ks(c,e),s.tag=1,s=Vp(null,s,c,e,l)):(s.tag=0,s=Su(null,s,c,e,l));else{if(c!=null){if(d=c.$$typeof,d===_){s.tag=11,s=Pp(null,s,c,e,l);break e}else if(d===B){s.tag=14,s=Gp(null,s,c,e,l);break e}}throw s=Y(c)||c,Error(i(306,s,""))}}return s;case 0:return Su(e,s,s.type,s.pendingProps,l);case 1:return c=s.type,d=ks(c,s.pendingProps),Vp(e,s,c,d,l);case 3:e:{if(Ge(s,s.stateNode.containerInfo),e===null)throw Error(i(387));c=s.pendingProps;var m=s.memoizedState;d=m.element,Wc(e,s),al(s,c,null,l);var w=s.memoizedState;if(c=w.cache,Fr(s,sn,c),c!==m.cache&&qc(s,[sn],l,!0),nl(),c=w.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:w.cache},s.updateQueue.baseState=m,s.memoizedState=m,s.flags&256){s=Xp(e,s,c,l);break e}else if(c!==d){d=ua(Error(i(424)),s),Zi(d),s=Xp(e,s,c,l);break e}else for(e=s.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,qt=Ra(e.firstChild),On=s,vt=!0,Cs=null,Xa=!0,l=Rp(s,null,c,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Qi(),c===d){s=yr(e,s,l);break e}vn(e,s,c,l)}s=s.child}return s;case 26:return ko(e,s),e===null?(l=t0(s.type,null,s.pendingProps,null))?s.memoizedState=l:vt||(l=s.type,e=s.pendingProps,c=Xo(Ee.current).createElement(l),c[Pt]=s,c[It]=e,bn(c,l,e),Ht(c),s.stateNode=c):s.memoizedState=t0(s.type,e.memoizedProps,s.pendingProps,e.memoizedState),null;case 27:return xn(s),e===null&&vt&&(c=s.stateNode=Kh(s.type,s.pendingProps,Ee.current),On=s,Xa=!0,d=qt,Jr(s.type)?(cf=d,qt=Ra(c.firstChild)):qt=d),vn(e,s,s.pendingProps.children,l),ko(e,s),e===null&&(s.flags|=4194304),s.child;case 5:return e===null&&vt&&((d=c=qt)&&(c=Iv(c,s.type,s.pendingProps,Xa),c!==null?(s.stateNode=c,On=s,qt=Ra(c.firstChild),Xa=!1,d=!0):d=!1),d||Ms(s)),xn(s),d=s.type,m=s.pendingProps,w=e!==null?e.memoizedProps:null,c=m.children,rf(d,m)?c=null:w!==null&&rf(d,w)&&(s.flags|=32),s.memoizedState!==null&&(d=au(e,s,ev,null,null,l),Tl._currentValue=d),ko(e,s),vn(e,s,c,l),s.child;case 6:return e===null&&vt&&((e=l=qt)&&(l=Bv(l,s.pendingProps,Xa),l!==null?(s.stateNode=l,On=s,qt=null,e=!0):e=!1),e||Ms(s)),null;case 13:return Qp(e,s,l);case 4:return Ge(s,s.stateNode.containerInfo),c=s.pendingProps,e===null?s.child=vi(s,null,c,l):vn(e,s,c,l),s.child;case 11:return Pp(e,s,s.type,s.pendingProps,l);case 7:return vn(e,s,s.pendingProps,l),s.child;case 8:return vn(e,s,s.pendingProps.children,l),s.child;case 12:return vn(e,s,s.pendingProps.children,l),s.child;case 10:return c=s.pendingProps,Fr(s,s.type,c.value),vn(e,s,c.children,l),s.child;case 9:return d=s.type._context,c=s.pendingProps.children,Rs(s),d=An(d),c=c(d),s.flags|=1,vn(e,s,c,l),s.child;case 14:return Gp(e,s,s.type,s.pendingProps,l);case 15:return zp(e,s,s.type,s.pendingProps,l);case 19:return $p(e,s,l);case 31:return c=s.pendingProps,l=s.mode,c={mode:c.mode,children:c.children},e===null?(l=Oo(c,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=fr(e.child,c),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return Hp(e,s,l);case 24:return Rs(s),c=An(sn),e===null?(d=Qc(),d===null&&(d=Ot,m=Vc(),d.pooledCache=m,m.refCount++,m!==null&&(d.pooledCacheLanes|=l),d=m),s.memoizedState={parent:c,cache:d},$c(s),Fr(s,sn,d)):((e.lanes&l)!==0&&(Wc(e,s),al(s,null,null,l),nl()),d=e.memoizedState,m=s.memoizedState,d.parent!==c?(d={parent:c,cache:c},s.memoizedState=d,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=d),Fr(s,sn,c)):(c=m.cache,Fr(s,sn,c),c!==d.cache&&qc(s,[sn],l,!0))),vn(e,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function br(e){e.flags|=4}function Kp(e,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!i0(s)){if(s=ha.current,s!==null&&((dt&4194048)===dt?Qa!==null:(dt&62914560)!==dt&&(dt&536870912)===0||s!==Qa))throw el=Zc,Ud;e.flags|=8192}}function Lo(e,s){s!==null&&(e.flags|=4),e.flags&16384&&(s=e.tag!==22?zs():536870912,e.lanes|=s,Si|=s)}function ul(e,s){if(!vt)switch(e.tailMode){case"hidden":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function Gt(e){var s=e.alternate!==null&&e.alternate.child===e.child,l=0,c=0;if(s)for(var d=e.child;d!==null;)l|=d.lanes|d.childLanes,c|=d.subtreeFlags&65011712,c|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)l|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=c,e.childLanes=l,s}function cv(e,s,l){var c=s.pendingProps;switch(Gc(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(s),null;case 1:return Gt(s),null;case 3:return l=s.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),mr(sn),ct(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(Xi(s)?br(s):e===null||e.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Dd())),Gt(s),null;case 26:return l=s.memoizedState,e===null?(br(s),l!==null?(Gt(s),Kp(s,l)):(Gt(s),s.flags&=-16777217)):l?l!==e.memoizedState?(br(s),Gt(s),Kp(s,l)):(Gt(s),s.flags&=-16777217):(e.memoizedProps!==c&&br(s),Gt(s),s.flags&=-16777217),null;case 27:St(s),l=Ee.current;var d=s.type;if(e!==null&&s.stateNode!=null)e.memoizedProps!==c&&br(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return Gt(s),null}e=oe.current,Xi(s)?Nd(s):(e=Kh(d,c,l),s.stateNode=e,br(s))}return Gt(s),null;case 5:if(St(s),l=s.type,e!==null&&s.stateNode!=null)e.memoizedProps!==c&&br(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return Gt(s),null}if(e=oe.current,Xi(s))Nd(s);else{switch(d=Xo(Ee.current),e){case 1:e=d.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:e=d.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":e=d.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":e=d.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof c.is=="string"?d.createElement("select",{is:c.is}):d.createElement("select"),c.multiple?e.multiple=!0:c.size&&(e.size=c.size);break;default:e=typeof c.is=="string"?d.createElement(l,{is:c.is}):d.createElement(l)}}e[Pt]=s,e[It]=c;e:for(d=s.child;d!==null;){if(d.tag===5||d.tag===6)e.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===s)break e;for(;d.sibling===null;){if(d.return===null||d.return===s)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}s.stateNode=e;e:switch(bn(e,l,c),l){case"button":case"input":case"select":case"textarea":e=!!c.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&br(s)}}return Gt(s),s.flags&=-16777217,null;case 6:if(e&&s.stateNode!=null)e.memoizedProps!==c&&br(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(i(166));if(e=Ee.current,Xi(s)){if(e=s.stateNode,l=s.memoizedProps,c=null,d=On,d!==null)switch(d.tag){case 27:case 5:c=d.memoizedProps}e[Pt]=s,e=!!(e.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||qh(e.nodeValue,l)),e||Ms(s)}else e=Xo(e).createTextNode(c),e[Pt]=s,s.stateNode=e}return Gt(s),null;case 13:if(c=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Xi(s),c!==null&&c.dehydrated!==null){if(e===null){if(!d)throw Error(i(318));if(d=s.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));d[Pt]=s}else Qi(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Gt(s),d=!1}else d=Dd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return s.flags&256?(vr(s),s):(vr(s),null)}if(vr(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=c!==null,e=e!==null&&e.memoizedState!==null,l){c=s.child,d=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(d=c.alternate.memoizedState.cachePool.pool);var m=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==d&&(c.flags|=2048)}return l!==e&&l&&(s.child.flags|=8192),Lo(s,s.updateQueue),Gt(s),null;case 4:return ct(),e===null&&Ju(s.stateNode.containerInfo),Gt(s),null;case 10:return mr(s.type),Gt(s),null;case 19:if(ue(ln),d=s.memoizedState,d===null)return Gt(s),null;if(c=(s.flags&128)!==0,m=d.rendering,m===null)if(c)ul(d,!1);else{if(Vt!==0||e!==null&&(e.flags&128)!==0)for(e=s.child;e!==null;){if(m=Ro(e),m!==null){for(s.flags|=128,ul(d,!1),e=m.updateQueue,s.updateQueue=e,Lo(s,e),s.subtreeFlags=0,e=l,l=s.child;l!==null;)Cd(l,e),l=l.sibling;return be(ln,ln.current&1|2),s.child}e=e.sibling}d.tail!==null&&te()>Bo&&(s.flags|=128,c=!0,ul(d,!1),s.lanes=4194304)}else{if(!c)if(e=Ro(m),e!==null){if(s.flags|=128,c=!0,e=e.updateQueue,s.updateQueue=e,Lo(s,e),ul(d,!0),d.tail===null&&d.tailMode==="hidden"&&!m.alternate&&!vt)return Gt(s),null}else 2*te()-d.renderingStartTime>Bo&&l!==536870912&&(s.flags|=128,c=!0,ul(d,!1),s.lanes=4194304);d.isBackwards?(m.sibling=s.child,s.child=m):(e=d.last,e!==null?e.sibling=m:s.child=m,d.last=m)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=te(),s.sibling=null,e=ln.current,be(ln,c?e&1|2:e&1),s):(Gt(s),null);case 22:case 23:return vr(s),tu(),c=s.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(l&536870912)!==0&&(s.flags&128)===0&&(Gt(s),s.subtreeFlags&6&&(s.flags|=8192)):Gt(s),l=s.updateQueue,l!==null&&Lo(s,l.retryQueue),l=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==l&&(s.flags|=2048),e!==null&&ue(Ds),null;case 24:return l=null,e!==null&&(l=e.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),mr(sn),Gt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function uv(e,s){switch(Gc(s),s.tag){case 1:return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return mr(sn),ct(),e=s.flags,(e&65536)!==0&&(e&128)===0?(s.flags=e&-65537|128,s):null;case 26:case 27:case 5:return St(s),null;case 13:if(vr(s),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Qi()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return ue(ln),null;case 4:return ct(),null;case 10:return mr(s.type),null;case 22:case 23:return vr(s),tu(),e!==null&&ue(Ds),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 24:return mr(sn),null;case 25:return null;default:return null}}function Jp(e,s){switch(Gc(s),s.tag){case 3:mr(sn),ct();break;case 26:case 27:case 5:St(s);break;case 4:ct();break;case 13:vr(s);break;case 19:ue(ln);break;case 10:mr(s.type);break;case 22:case 23:vr(s),tu(),e!==null&&ue(Ds);break;case 24:mr(sn)}}function fl(e,s){try{var l=s.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var d=c.next;l=d;do{if((l.tag&e)===e){c=void 0;var m=l.create,w=l.inst;c=m(),w.destroy=c}l=l.next}while(l!==d)}}catch(C){Rt(s,s.return,C)}}function qr(e,s,l){try{var c=s.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var m=d.next;c=m;do{if((c.tag&e)===e){var w=c.inst,C=w.destroy;if(C!==void 0){w.destroy=void 0,d=s;var P=l,re=C;try{re()}catch(pe){Rt(d,P,pe)}}}c=c.next}while(c!==m)}}catch(pe){Rt(s,s.return,pe)}}function eh(e){var s=e.updateQueue;if(s!==null){var l=e.stateNode;try{Gd(s,l)}catch(c){Rt(e,e.return,c)}}}function th(e,s,l){l.props=ks(e.type,e.memoizedProps),l.state=e.memoizedState;try{l.componentWillUnmount()}catch(c){Rt(e,s,c)}}function dl(e,s){try{var l=e.ref;if(l!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof l=="function"?e.refCleanup=l(c):l.current=c}}catch(d){Rt(e,s,d)}}function Za(e,s){var l=e.ref,c=e.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(d){Rt(e,s,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(d){Rt(e,s,d)}else l.current=null}function nh(e){var s=e.type,l=e.memoizedProps,c=e.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(d){Rt(e,e.return,d)}}function Ru(e,s,l){try{var c=e.stateNode;_v(c,e.type,l,s),c[It]=s}catch(d){Rt(e,e.return,d)}}function ah(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Jr(e.type)||e.tag===4}function Du(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ah(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Jr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _u(e,s,l){var c=e.tag;if(c===5||c===6)e=e.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(e,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(e),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Vo));else if(c!==4&&(c===27&&Jr(e.type)&&(l=e.stateNode,s=null),e=e.child,e!==null))for(_u(e,s,l),e=e.sibling;e!==null;)_u(e,s,l),e=e.sibling}function Uo(e,s,l){var c=e.tag;if(c===5||c===6)e=e.stateNode,s?l.insertBefore(e,s):l.appendChild(e);else if(c!==4&&(c===27&&Jr(e.type)&&(l=e.stateNode),e=e.child,e!==null))for(Uo(e,s,l),e=e.sibling;e!==null;)Uo(e,s,l),e=e.sibling}function rh(e){var s=e.stateNode,l=e.memoizedProps;try{for(var c=e.type,d=s.attributes;d.length;)s.removeAttributeNode(d[0]);bn(s,c,l),s[Pt]=e,s[It]=l}catch(m){Rt(e,e.return,m)}}var xr=!1,$t=!1,ku=!1,sh=typeof WeakSet=="function"?WeakSet:Set,dn=null;function fv(e,s){if(e=e.containerInfo,nf=Jo,e=gd(e),Dc(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var d=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var w=0,C=-1,P=-1,re=0,pe=0,ve=e,se=null;t:for(;;){for(var ie;ve!==l||d!==0&&ve.nodeType!==3||(C=w+d),ve!==m||c!==0&&ve.nodeType!==3||(P=w+c),ve.nodeType===3&&(w+=ve.nodeValue.length),(ie=ve.firstChild)!==null;)se=ve,ve=ie;for(;;){if(ve===e)break t;if(se===l&&++re===d&&(C=w),se===m&&++pe===c&&(P=w),(ie=ve.nextSibling)!==null)break;ve=se,se=ve.parentNode}ve=ie}l=C===-1||P===-1?null:{start:C,end:P}}else l=null}l=l||{start:0,end:0}}else l=null;for(af={focusedElem:e,selectionRange:l},Jo=!1,dn=s;dn!==null;)if(s=dn,e=s.child,(s.subtreeFlags&1024)!==0&&e!==null)e.return=s,dn=e;else for(;dn!==null;){switch(s=dn,m=s.alternate,e=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&m!==null){e=void 0,l=s,d=m.memoizedProps,m=m.memoizedState,c=l.stateNode;try{var $e=ks(l.type,d,l.elementType===l.type);e=c.getSnapshotBeforeUpdate($e,m),c.__reactInternalSnapshotBeforeUpdate=e}catch(Ve){Rt(l,l.return,Ve)}}break;case 3:if((e&1024)!==0){if(e=s.stateNode.containerInfo,l=e.nodeType,l===9)lf(e);else if(l===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":lf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=s.sibling,e!==null){e.return=s.return,dn=e;break}dn=s.return}}function ih(e,s,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:Vr(e,l),c&4&&fl(5,l);break;case 1:if(Vr(e,l),c&4)if(e=l.stateNode,s===null)try{e.componentDidMount()}catch(w){Rt(l,l.return,w)}else{var d=ks(l.type,s.memoizedProps);s=s.memoizedState;try{e.componentDidUpdate(d,s,e.__reactInternalSnapshotBeforeUpdate)}catch(w){Rt(l,l.return,w)}}c&64&&eh(l),c&512&&dl(l,l.return);break;case 3:if(Vr(e,l),c&64&&(e=l.updateQueue,e!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{Gd(e,s)}catch(w){Rt(l,l.return,w)}}break;case 27:s===null&&c&4&&rh(l);case 26:case 5:Vr(e,l),s===null&&c&4&&nh(l),c&512&&dl(l,l.return);break;case 12:Vr(e,l);break;case 13:Vr(e,l),c&4&&ch(e,l),c&64&&(e=l.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(l=xv.bind(null,l),Fv(e,l))));break;case 22:if(c=l.memoizedState!==null||xr,!c){s=s!==null&&s.memoizedState!==null||$t,d=xr;var m=$t;xr=c,($t=s)&&!m?Xr(e,l,(l.subtreeFlags&8772)!==0):Vr(e,l),xr=d,$t=m}break;case 30:break;default:Vr(e,l)}}function lh(e){var s=e.alternate;s!==null&&(e.alternate=null,lh(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&zt(s)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ft=null,jn=!1;function Sr(e,s,l){for(l=l.child;l!==null;)oh(e,s,l),l=l.sibling}function oh(e,s,l){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(va,l)}catch{}switch(l.tag){case 26:$t||Za(l,s),Sr(e,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:$t||Za(l,s);var c=Ft,d=jn;Jr(l.type)&&(Ft=l.stateNode,jn=!1),Sr(e,s,l),Sl(l.stateNode),Ft=c,jn=d;break;case 5:$t||Za(l,s);case 6:if(c=Ft,d=jn,Ft=null,Sr(e,s,l),Ft=c,jn=d,Ft!==null)if(jn)try{(Ft.nodeType===9?Ft.body:Ft.nodeName==="HTML"?Ft.ownerDocument.body:Ft).removeChild(l.stateNode)}catch(m){Rt(l,s,m)}else try{Ft.removeChild(l.stateNode)}catch(m){Rt(l,s,m)}break;case 18:Ft!==null&&(jn?(e=Ft,$h(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,l.stateNode),Rl(e)):$h(Ft,l.stateNode));break;case 4:c=Ft,d=jn,Ft=l.stateNode.containerInfo,jn=!0,Sr(e,s,l),Ft=c,jn=d;break;case 0:case 11:case 14:case 15:$t||qr(2,l,s),$t||qr(4,l,s),Sr(e,s,l);break;case 1:$t||(Za(l,s),c=l.stateNode,typeof c.componentWillUnmount=="function"&&th(l,s,c)),Sr(e,s,l);break;case 21:Sr(e,s,l);break;case 22:$t=(c=$t)||l.memoizedState!==null,Sr(e,s,l),$t=c;break;default:Sr(e,s,l)}}function ch(e,s){if(s.memoizedState===null&&(e=s.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Rl(e)}catch(l){Rt(s,s.return,l)}}function dv(e){switch(e.tag){case 13:case 19:var s=e.stateNode;return s===null&&(s=e.stateNode=new sh),s;case 22:return e=e.stateNode,s=e._retryCache,s===null&&(s=e._retryCache=new sh),s;default:throw Error(i(435,e.tag))}}function Ou(e,s){var l=dv(e);s.forEach(function(c){var d=Sv.bind(null,e,c);l.has(c)||(l.add(c),c.then(d,d))})}function Kn(e,s){var l=s.deletions;if(l!==null)for(var c=0;c<l.length;c++){var d=l[c],m=e,w=s,C=w;e:for(;C!==null;){switch(C.tag){case 27:if(Jr(C.type)){Ft=C.stateNode,jn=!1;break e}break;case 5:Ft=C.stateNode,jn=!1;break e;case 3:case 4:Ft=C.stateNode.containerInfo,jn=!0;break e}C=C.return}if(Ft===null)throw Error(i(160));oh(m,w,d),Ft=null,jn=!1,m=d.alternate,m!==null&&(m.return=null),d.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)uh(s,e),s=s.sibling}var Na=null;function uh(e,s){var l=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Kn(s,e),Jn(e),c&4&&(qr(3,e,e.return),fl(3,e),qr(5,e,e.return));break;case 1:Kn(s,e),Jn(e),c&512&&($t||l===null||Za(l,l.return)),c&64&&xr&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(l=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var d=Na;if(Kn(s,e),Jn(e),c&512&&($t||l===null||Za(l,l.return)),c&4){var m=l!==null?l.memoizedState:null;if(c=e.memoizedState,l===null)if(c===null)if(e.stateNode===null){e:{c=e.type,l=e.memoizedProps,d=d.ownerDocument||d;t:switch(c){case"title":m=d.getElementsByTagName("title")[0],(!m||m[qn]||m[Pt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=d.createElement(c),d.head.insertBefore(m,d.querySelector("head > title"))),bn(m,c,l),m[Pt]=e,Ht(m),c=m;break e;case"link":var w=r0("link","href",d).get(c+(l.href||""));if(w){for(var C=0;C<w.length;C++)if(m=w[C],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(C,1);break t}}m=d.createElement(c),bn(m,c,l),d.head.appendChild(m);break;case"meta":if(w=r0("meta","content",d).get(c+(l.content||""))){for(C=0;C<w.length;C++)if(m=w[C],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(C,1);break t}}m=d.createElement(c),bn(m,c,l),d.head.appendChild(m);break;default:throw Error(i(468,c))}m[Pt]=e,Ht(m),c=m}e.stateNode=c}else s0(d,e.type,e.stateNode);else e.stateNode=a0(d,c,e.memoizedProps);else m!==c?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,c===null?s0(d,e.type,e.stateNode):a0(d,c,e.memoizedProps)):c===null&&e.stateNode!==null&&Ru(e,e.memoizedProps,l.memoizedProps)}break;case 27:Kn(s,e),Jn(e),c&512&&($t||l===null||Za(l,l.return)),l!==null&&c&4&&Ru(e,e.memoizedProps,l.memoizedProps);break;case 5:if(Kn(s,e),Jn(e),c&512&&($t||l===null||Za(l,l.return)),e.flags&32){d=e.stateNode;try{Xn(d,"")}catch(ie){Rt(e,e.return,ie)}}c&4&&e.stateNode!=null&&(d=e.memoizedProps,Ru(e,d,l!==null?l.memoizedProps:d)),c&1024&&(ku=!0);break;case 6:if(Kn(s,e),Jn(e),c&4){if(e.stateNode===null)throw Error(i(162));c=e.memoizedProps,l=e.stateNode;try{l.nodeValue=c}catch(ie){Rt(e,e.return,ie)}}break;case 3:if($o=null,d=Na,Na=Qo(s.containerInfo),Kn(s,e),Na=d,Jn(e),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Rl(s.containerInfo)}catch(ie){Rt(e,e.return,ie)}ku&&(ku=!1,fh(e));break;case 4:c=Na,Na=Qo(e.stateNode.containerInfo),Kn(s,e),Jn(e),Na=c;break;case 12:Kn(s,e),Jn(e);break;case 13:Kn(s,e),Jn(e),e.child.flags&8192&&e.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(ju=te()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Ou(e,c)));break;case 22:d=e.memoizedState!==null;var P=l!==null&&l.memoizedState!==null,re=xr,pe=$t;if(xr=re||d,$t=pe||P,Kn(s,e),$t=pe,xr=re,Jn(e),c&8192)e:for(s=e.stateNode,s._visibility=d?s._visibility&-2:s._visibility|1,d&&(l===null||P||xr||$t||Os(e)),l=null,s=e;;){if(s.tag===5||s.tag===26){if(l===null){P=l=s;try{if(m=P.stateNode,d)w=m.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{C=P.stateNode;var ve=P.memoizedProps.style,se=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;C.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(ie){Rt(P,P.return,ie)}}}else if(s.tag===6){if(l===null){P=s;try{P.stateNode.nodeValue=d?"":P.memoizedProps}catch(ie){Rt(P,P.return,ie)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===e)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=e.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Ou(e,l))));break;case 19:Kn(s,e),Jn(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Ou(e,c)));break;case 30:break;case 21:break;default:Kn(s,e),Jn(e)}}function Jn(e){var s=e.flags;if(s&2){try{for(var l,c=e.return;c!==null;){if(ah(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var d=l.stateNode,m=Du(e);Uo(e,m,d);break;case 5:var w=l.stateNode;l.flags&32&&(Xn(w,""),l.flags&=-33);var C=Du(e);Uo(e,C,w);break;case 3:case 4:var P=l.stateNode.containerInfo,re=Du(e);_u(e,re,P);break;default:throw Error(i(161))}}catch(pe){Rt(e,e.return,pe)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function fh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var s=e;fh(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),e=e.sibling}}function Vr(e,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ih(e,s.alternate,s),s=s.sibling}function Os(e){for(e=e.child;e!==null;){var s=e;switch(s.tag){case 0:case 11:case 14:case 15:qr(4,s,s.return),Os(s);break;case 1:Za(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&th(s,s.return,l),Os(s);break;case 27:Sl(s.stateNode);case 26:case 5:Za(s,s.return),Os(s);break;case 22:s.memoizedState===null&&Os(s);break;case 30:Os(s);break;default:Os(s)}e=e.sibling}}function Xr(e,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,d=e,m=s,w=m.flags;switch(m.tag){case 0:case 11:case 15:Xr(d,m,l),fl(4,m);break;case 1:if(Xr(d,m,l),c=m,d=c.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(re){Rt(c,c.return,re)}if(c=m,d=c.updateQueue,d!==null){var C=c.stateNode;try{var P=d.shared.hiddenCallbacks;if(P!==null)for(d.shared.hiddenCallbacks=null,d=0;d<P.length;d++)Pd(P[d],C)}catch(re){Rt(c,c.return,re)}}l&&w&64&&eh(m),dl(m,m.return);break;case 27:rh(m);case 26:case 5:Xr(d,m,l),l&&c===null&&w&4&&nh(m),dl(m,m.return);break;case 12:Xr(d,m,l);break;case 13:Xr(d,m,l),l&&w&4&&ch(d,m);break;case 22:m.memoizedState===null&&Xr(d,m,l),dl(m,m.return);break;case 30:break;default:Xr(d,m,l)}s=s.sibling}}function Lu(e,s){var l=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),e=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(e=s.memoizedState.cachePool.pool),e!==l&&(e!=null&&e.refCount++,l!=null&&Wi(l))}function Uu(e,s){e=null,s.alternate!==null&&(e=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==e&&(s.refCount++,e!=null&&Wi(e))}function $a(e,s,l,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)dh(e,s,l,c),s=s.sibling}function dh(e,s,l,c){var d=s.flags;switch(s.tag){case 0:case 11:case 15:$a(e,s,l,c),d&2048&&fl(9,s);break;case 1:$a(e,s,l,c);break;case 3:$a(e,s,l,c),d&2048&&(e=null,s.alternate!==null&&(e=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==e&&(s.refCount++,e!=null&&Wi(e)));break;case 12:if(d&2048){$a(e,s,l,c),e=s.stateNode;try{var m=s.memoizedProps,w=m.id,C=m.onPostCommit;typeof C=="function"&&C(w,s.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(P){Rt(s,s.return,P)}}else $a(e,s,l,c);break;case 13:$a(e,s,l,c);break;case 23:break;case 22:m=s.stateNode,w=s.alternate,s.memoizedState!==null?m._visibility&2?$a(e,s,l,c):pl(e,s):m._visibility&2?$a(e,s,l,c):(m._visibility|=2,yi(e,s,l,c,(s.subtreeFlags&10256)!==0)),d&2048&&Lu(w,s);break;case 24:$a(e,s,l,c),d&2048&&Uu(s.alternate,s);break;default:$a(e,s,l,c)}}function yi(e,s,l,c,d){for(d=d&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var m=e,w=s,C=l,P=c,re=w.flags;switch(w.tag){case 0:case 11:case 15:yi(m,w,C,P,d),fl(8,w);break;case 23:break;case 22:var pe=w.stateNode;w.memoizedState!==null?pe._visibility&2?yi(m,w,C,P,d):pl(m,w):(pe._visibility|=2,yi(m,w,C,P,d)),d&&re&2048&&Lu(w.alternate,w);break;case 24:yi(m,w,C,P,d),d&&re&2048&&Uu(w.alternate,w);break;default:yi(m,w,C,P,d)}s=s.sibling}}function pl(e,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=e,c=s,d=c.flags;switch(c.tag){case 22:pl(l,c),d&2048&&Lu(c.alternate,c);break;case 24:pl(l,c),d&2048&&Uu(c.alternate,c);break;default:pl(l,c)}s=s.sibling}}var hl=8192;function bi(e){if(e.subtreeFlags&hl)for(e=e.child;e!==null;)ph(e),e=e.sibling}function ph(e){switch(e.tag){case 26:bi(e),e.flags&hl&&e.memoizedState!==null&&Wv(Na,e.memoizedState,e.memoizedProps);break;case 5:bi(e);break;case 3:case 4:var s=Na;Na=Qo(e.stateNode.containerInfo),bi(e),Na=s;break;case 22:e.memoizedState===null&&(s=e.alternate,s!==null&&s.memoizedState!==null?(s=hl,hl=16777216,bi(e),hl=s):bi(e));break;default:bi(e)}}function hh(e){var s=e.alternate;if(s!==null&&(e=s.child,e!==null)){s.child=null;do s=e.sibling,e.sibling=null,e=s;while(e!==null)}}function ml(e){var s=e.deletions;if((e.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var c=s[l];dn=c,gh(c,e)}hh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)mh(e),e=e.sibling}function mh(e){switch(e.tag){case 0:case 11:case 15:ml(e),e.flags&2048&&qr(9,e,e.return);break;case 3:ml(e);break;case 12:ml(e);break;case 22:var s=e.stateNode;e.memoizedState!==null&&s._visibility&2&&(e.return===null||e.return.tag!==13)?(s._visibility&=-3,Io(e)):ml(e);break;default:ml(e)}}function Io(e){var s=e.deletions;if((e.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var c=s[l];dn=c,gh(c,e)}hh(e)}for(e=e.child;e!==null;){switch(s=e,s.tag){case 0:case 11:case 15:qr(8,s,s.return),Io(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Io(s));break;default:Io(s)}e=e.sibling}}function gh(e,s){for(;dn!==null;){var l=dn;switch(l.tag){case 0:case 11:case 15:qr(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Wi(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,dn=c;else e:for(l=e;dn!==null;){c=dn;var d=c.sibling,m=c.return;if(lh(c),c===l){dn=null;break e}if(d!==null){d.return=m,dn=d;break e}dn=m}}}var pv={getCacheForType:function(e){var s=An(sn),l=s.data.get(e);return l===void 0&&(l=e(),s.data.set(e,l)),l}},hv=typeof WeakMap=="function"?WeakMap:Map,bt=0,Ot=null,lt=null,dt=0,xt=0,ea=null,Qr=!1,xi=!1,Iu=!1,Er=0,Vt=0,Zr=0,Ls=0,Bu=0,ma=0,Si=0,gl=null,Pn=null,Fu=!1,ju=0,Bo=1/0,Fo=null,$r=null,yn=0,Wr=null,Ei=null,wi=0,Pu=0,Gu=null,vh=null,vl=0,zu=null;function ta(){if((bt&2)!==0&&dt!==0)return dt&-dt;if(L.T!==null){var e=ui;return e!==0?e:Zu()}return Fi()}function yh(){ma===0&&(ma=(dt&536870912)===0||vt?nr():536870912);var e=ha.current;return e!==null&&(e.flags|=32),ma}function na(e,s,l){(e===Ot&&(xt===2||xt===9)||e.cancelPendingCommit!==null)&&(Ai(e,0),Kr(e,dt,ma,!1)),zn(e,l),((bt&2)===0||e!==Ot)&&(e===Ot&&((bt&2)===0&&(Ls|=l),Vt===4&&Kr(e,dt,ma,!1)),Wa(e))}function bh(e,s,l){if((bt&6)!==0)throw Error(i(327));var c=!l&&(s&124)===0&&(s&e.expiredLanes)===0||Nn(e,s),d=c?vv(e,s):qu(e,s,!0),m=c;do{if(d===0){xi&&!c&&Kr(e,s,0,!1);break}else{if(l=e.current.alternate,m&&!mv(l)){d=qu(e,s,!1),m=!1;continue}if(d===2){if(m=s,e.errorRecoveryDisabledLanes&m)var w=0;else w=e.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){s=w;e:{var C=e;d=gl;var P=C.current.memoizedState.isDehydrated;if(P&&(Ai(C,w).flags|=256),w=qu(C,w,!1),w!==2){if(Iu&&!P){C.errorRecoveryDisabledLanes|=m,Ls|=m,d=4;break e}m=Pn,Pn=d,m!==null&&(Pn===null?Pn=m:Pn.push.apply(Pn,m))}d=w}if(m=!1,d!==2)continue}}if(d===1){Ai(e,0),Kr(e,s,0,!0);break}e:{switch(c=e,m=d,m){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Kr(c,s,ma,!Qr);break e;case 2:Pn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(d=ju+300-te(),10<d)){if(Kr(c,s,ma,!Qr),Fa(c,0,!0)!==0)break e;c.timeoutHandle=Qh(xh.bind(null,c,l,Pn,Fo,Fu,s,ma,Ls,Si,Qr,m,2,-0,0),d);break e}xh(c,l,Pn,Fo,Fu,s,ma,Ls,Si,Qr,m,0,-0,0)}}break}while(!0);Wa(e)}function xh(e,s,l,c,d,m,w,C,P,re,pe,ve,se,ie){if(e.timeoutHandle=-1,ve=s.subtreeFlags,(ve&8192||(ve&16785408)===16785408)&&(Al={stylesheets:null,count:0,unsuspend:$v},ph(s),ve=Kv(),ve!==null)){e.cancelPendingCommit=ve(Mh.bind(null,e,s,m,l,c,d,w,C,P,pe,1,se,ie)),Kr(e,m,w,!re);return}Mh(e,s,m,l,c,d,w,C,P)}function mv(e){for(var s=e;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var d=l[c],m=d.getSnapshot;d=d.value;try{if(!$n(m(),d))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Kr(e,s,l,c){s&=~Bu,s&=~Ls,e.suspendedLanes|=s,e.pingedLanes&=~s,c&&(e.warmLanes|=s),c=e.expirationTimes;for(var d=s;0<d;){var m=31-Kt(d),w=1<<m;c[m]=-1,d&=~w}l!==0&&Hn(e,l,s)}function jo(){return(bt&6)===0?(yl(0),!1):!0}function Hu(){if(lt!==null){if(xt===0)var e=lt.return;else e=lt,hr=Ns=null,iu(e),gi=null,ol=0,e=lt;for(;e!==null;)Jp(e.alternate,e),e=e.return;lt=null}}function Ai(e,s){var l=e.timeoutHandle;l!==-1&&(e.timeoutHandle=-1,Ov(l)),l=e.cancelPendingCommit,l!==null&&(e.cancelPendingCommit=null,l()),Hu(),Ot=e,lt=l=fr(e.current,null),dt=s,xt=0,ea=null,Qr=!1,xi=Nn(e,s),Iu=!1,Si=ma=Bu=Ls=Zr=Vt=0,Pn=gl=null,Fu=!1,(s&8)!==0&&(s|=s&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=s;0<c;){var d=31-Kt(c),m=1<<d;s|=e[d],c&=~m}return Er=s,io(),l}function Sh(e,s){at=null,L.H=Co,s===Ji||s===go?(s=Fd(),xt=3):s===Ud?(s=Fd(),xt=4):xt=s===jp?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,ea=s,lt===null&&(Vt=1,_o(e,ua(s,e.current)))}function Eh(){var e=L.H;return L.H=Co,e===null?Co:e}function wh(){var e=L.A;return L.A=pv,e}function Yu(){Vt=4,Qr||(dt&4194048)!==dt&&ha.current!==null||(xi=!0),(Zr&134217727)===0&&(Ls&134217727)===0||Ot===null||Kr(Ot,dt,ma,!1)}function qu(e,s,l){var c=bt;bt|=2;var d=Eh(),m=wh();(Ot!==e||dt!==s)&&(Fo=null,Ai(e,s)),s=!1;var w=Vt;e:do try{if(xt!==0&&lt!==null){var C=lt,P=ea;switch(xt){case 8:Hu(),w=6;break e;case 3:case 2:case 9:case 6:ha.current===null&&(s=!0);var re=xt;if(xt=0,ea=null,Ti(e,C,P,re),l&&xi){w=0;break e}break;default:re=xt,xt=0,ea=null,Ti(e,C,P,re)}}gv(),w=Vt;break}catch(pe){Sh(e,pe)}while(!0);return s&&e.shellSuspendCounter++,hr=Ns=null,bt=c,L.H=d,L.A=m,lt===null&&(Ot=null,dt=0,io()),w}function gv(){for(;lt!==null;)Ah(lt)}function vv(e,s){var l=bt;bt|=2;var c=Eh(),d=wh();Ot!==e||dt!==s?(Fo=null,Bo=te()+500,Ai(e,s)):xi=Nn(e,s);e:do try{if(xt!==0&&lt!==null){s=lt;var m=ea;t:switch(xt){case 1:xt=0,ea=null,Ti(e,s,m,1);break;case 2:case 9:if(Id(m)){xt=0,ea=null,Th(s);break}s=function(){xt!==2&&xt!==9||Ot!==e||(xt=7),Wa(e)},m.then(s,s);break e;case 3:xt=7;break e;case 4:xt=5;break e;case 7:Id(m)?(xt=0,ea=null,Th(s)):(xt=0,ea=null,Ti(e,s,m,7));break;case 5:var w=null;switch(lt.tag){case 26:w=lt.memoizedState;case 5:case 27:var C=lt;if(!w||i0(w)){xt=0,ea=null;var P=C.sibling;if(P!==null)lt=P;else{var re=C.return;re!==null?(lt=re,Po(re)):lt=null}break t}}xt=0,ea=null,Ti(e,s,m,5);break;case 6:xt=0,ea=null,Ti(e,s,m,6);break;case 8:Hu(),Vt=6;break e;default:throw Error(i(462))}}yv();break}catch(pe){Sh(e,pe)}while(!0);return hr=Ns=null,L.H=c,L.A=d,bt=l,lt!==null?0:(Ot=null,dt=0,io(),Vt)}function yv(){for(;lt!==null&&!Ne();)Ah(lt)}function Ah(e){var s=Wp(e.alternate,e,Er);e.memoizedProps=e.pendingProps,s===null?Po(e):lt=s}function Th(e){var s=e,l=s.alternate;switch(s.tag){case 15:case 0:s=qp(l,s,s.pendingProps,s.type,void 0,dt);break;case 11:s=qp(l,s,s.pendingProps,s.type.render,s.ref,dt);break;case 5:iu(s);default:Jp(l,s),s=lt=Cd(s,Er),s=Wp(l,s,Er)}e.memoizedProps=e.pendingProps,s===null?Po(e):lt=s}function Ti(e,s,l,c){hr=Ns=null,iu(s),gi=null,ol=0;var d=s.return;try{if(lv(e,d,s,l,dt)){Vt=1,_o(e,ua(l,e.current)),lt=null;return}}catch(m){if(d!==null)throw lt=d,m;Vt=1,_o(e,ua(l,e.current)),lt=null;return}s.flags&32768?(vt||c===1?e=!0:xi||(dt&536870912)!==0?e=!1:(Qr=e=!0,(c===2||c===9||c===3||c===6)&&(c=ha.current,c!==null&&c.tag===13&&(c.flags|=16384))),Ch(s,e)):Po(s)}function Po(e){var s=e;do{if((s.flags&32768)!==0){Ch(s,Qr);return}e=s.return;var l=cv(s.alternate,s,Er);if(l!==null){lt=l;return}if(s=s.sibling,s!==null){lt=s;return}lt=s=e}while(s!==null);Vt===0&&(Vt=5)}function Ch(e,s){do{var l=uv(e.alternate,e);if(l!==null){l.flags&=32767,lt=l;return}if(l=e.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(e=e.sibling,e!==null)){lt=e;return}lt=e=l}while(e!==null);Vt=6,lt=null}function Mh(e,s,l,c,d,m,w,C,P){e.cancelPendingCommit=null;do Go();while(yn!==0);if((bt&6)!==0)throw Error(i(327));if(s!==null){if(s===e.current)throw Error(i(177));if(m=s.lanes|s.childLanes,m|=Uc,ar(e,l,m,w,C,P),e===Ot&&(lt=Ot=null,dt=0),Ei=s,Wr=e,wi=l,Pu=m,Gu=d,vh=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ev(ke,function(){return kh(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=L.T,L.T=null,d=z.p,z.p=2,w=bt,bt|=4;try{fv(e,s,l)}finally{bt=w,z.p=d,L.T=c}}yn=1,Nh(),Rh(),Dh()}}function Nh(){if(yn===1){yn=0;var e=Wr,s=Ei,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=L.T,L.T=null;var c=z.p;z.p=2;var d=bt;bt|=4;try{uh(s,e);var m=af,w=gd(e.containerInfo),C=m.focusedElem,P=m.selectionRange;if(w!==C&&C&&C.ownerDocument&&md(C.ownerDocument.documentElement,C)){if(P!==null&&Dc(C)){var re=P.start,pe=P.end;if(pe===void 0&&(pe=re),"selectionStart"in C)C.selectionStart=re,C.selectionEnd=Math.min(pe,C.value.length);else{var ve=C.ownerDocument||document,se=ve&&ve.defaultView||window;if(se.getSelection){var ie=se.getSelection(),$e=C.textContent.length,Ve=Math.min(P.start,$e),Ct=P.end===void 0?Ve:Math.min(P.end,$e);!ie.extend&&Ve>Ct&&(w=Ct,Ct=Ve,Ve=w);var ee=hd(C,Ve),$=hd(C,Ct);if(ee&&$&&(ie.rangeCount!==1||ie.anchorNode!==ee.node||ie.anchorOffset!==ee.offset||ie.focusNode!==$.node||ie.focusOffset!==$.offset)){var ae=ve.createRange();ae.setStart(ee.node,ee.offset),ie.removeAllRanges(),Ve>Ct?(ie.addRange(ae),ie.extend($.node,$.offset)):(ae.setEnd($.node,$.offset),ie.addRange(ae))}}}}for(ve=[],ie=C;ie=ie.parentNode;)ie.nodeType===1&&ve.push({element:ie,left:ie.scrollLeft,top:ie.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<ve.length;C++){var me=ve[C];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Jo=!!nf,af=nf=null}finally{bt=d,z.p=c,L.T=l}}e.current=s,yn=2}}function Rh(){if(yn===2){yn=0;var e=Wr,s=Ei,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=L.T,L.T=null;var c=z.p;z.p=2;var d=bt;bt|=4;try{ih(e,s.alternate,s)}finally{bt=d,z.p=c,L.T=l}}yn=3}}function Dh(){if(yn===4||yn===3){yn=0,ye();var e=Wr,s=Ei,l=wi,c=vh;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?yn=5:(yn=0,Ei=Wr=null,_h(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&($r=null),Hs(l),s=s.stateNode,cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(va,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=L.T,d=z.p,z.p=2,L.T=null;try{for(var m=e.onRecoverableError,w=0;w<c.length;w++){var C=c[w];m(C.value,{componentStack:C.stack})}}finally{L.T=s,z.p=d}}(wi&3)!==0&&Go(),Wa(e),d=e.pendingLanes,(l&4194090)!==0&&(d&42)!==0?e===zu?vl++:(vl=0,zu=e):vl=0,yl(0)}}function _h(e,s){(e.pooledCacheLanes&=s)===0&&(s=e.pooledCache,s!=null&&(e.pooledCache=null,Wi(s)))}function Go(e){return Nh(),Rh(),Dh(),kh()}function kh(){if(yn!==5)return!1;var e=Wr,s=Pu;Pu=0;var l=Hs(wi),c=L.T,d=z.p;try{z.p=32>l?32:l,L.T=null,l=Gu,Gu=null;var m=Wr,w=wi;if(yn=0,Ei=Wr=null,wi=0,(bt&6)!==0)throw Error(i(331));var C=bt;if(bt|=4,mh(m.current),dh(m,m.current,w,l),bt=C,yl(0,!1),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(va,m)}catch{}return!0}finally{z.p=d,L.T=c,_h(e,s)}}function Oh(e,s,l){s=ua(l,s),s=xu(e.stateNode,s,2),e=Gr(e,s,2),e!==null&&(zn(e,2),Wa(e))}function Rt(e,s,l){if(e.tag===3)Oh(e,e,l);else for(;s!==null;){if(s.tag===3){Oh(s,e,l);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&($r===null||!$r.has(c))){e=ua(l,e),l=Bp(2),c=Gr(s,l,2),c!==null&&(Fp(l,c,s,e),zn(c,2),Wa(c));break}}s=s.return}}function Vu(e,s,l){var c=e.pingCache;if(c===null){c=e.pingCache=new hv;var d=new Set;c.set(s,d)}else d=c.get(s),d===void 0&&(d=new Set,c.set(s,d));d.has(l)||(Iu=!0,d.add(l),e=bv.bind(null,e,s,l),s.then(e,e))}function bv(e,s,l){var c=e.pingCache;c!==null&&c.delete(s),e.pingedLanes|=e.suspendedLanes&l,e.warmLanes&=~l,Ot===e&&(dt&l)===l&&(Vt===4||Vt===3&&(dt&62914560)===dt&&300>te()-ju?(bt&2)===0&&Ai(e,0):Bu|=l,Si===dt&&(Si=0)),Wa(e)}function Lh(e,s){s===0&&(s=zs()),e=ii(e,s),e!==null&&(zn(e,s),Wa(e))}function xv(e){var s=e.memoizedState,l=0;s!==null&&(l=s.retryLane),Lh(e,l)}function Sv(e,s){var l=0;switch(e.tag){case 13:var c=e.stateNode,d=e.memoizedState;d!==null&&(l=d.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(s),Lh(e,l)}function Ev(e,s){return jt(e,s)}var zo=null,Ci=null,Xu=!1,Ho=!1,Qu=!1,Us=0;function Wa(e){e!==Ci&&e.next===null&&(Ci===null?zo=Ci=e:Ci=Ci.next=e),Ho=!0,Xu||(Xu=!0,Av())}function yl(e,s){if(!Qu&&Ho){Qu=!0;do for(var l=!1,c=zo;c!==null;){if(e!==0){var d=c.pendingLanes;if(d===0)var m=0;else{var w=c.suspendedLanes,C=c.pingedLanes;m=(1<<31-Kt(42|e)+1)-1,m&=d&~(w&~C),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,Fh(c,m))}else m=dt,m=Fa(c,c===Ot?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Nn(c,m)||(l=!0,Fh(c,m));c=c.next}while(l);Qu=!1}}function wv(){Uh()}function Uh(){Ho=Xu=!1;var e=0;Us!==0&&(kv()&&(e=Us),Us=0);for(var s=te(),l=null,c=zo;c!==null;){var d=c.next,m=Ih(c,s);m===0?(c.next=null,l===null?zo=d:l.next=d,d===null&&(Ci=l)):(l=c,(e!==0||(m&3)!==0)&&(Ho=!0)),c=d}yl(e)}function Ih(e,s){for(var l=e.suspendedLanes,c=e.pingedLanes,d=e.expirationTimes,m=e.pendingLanes&-62914561;0<m;){var w=31-Kt(m),C=1<<w,P=d[w];P===-1?((C&l)===0||(C&c)!==0)&&(d[w]=dd(C,s)):P<=s&&(e.expiredLanes|=C),m&=~C}if(s=Ot,l=dt,l=Fa(e,e===s?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,l===0||e===s&&(xt===2||xt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&Mn(c),e.callbackNode=null,e.callbackPriority=0;if((l&3)===0||Nn(e,l)){if(s=l&-l,s===e.callbackPriority)return s;switch(c!==null&&Mn(c),Hs(l)){case 2:case 8:l=Nt;break;case 32:l=ke;break;case 268435456:l=Ln;break;default:l=ke}return c=Bh.bind(null,e),l=jt(l,c),e.callbackPriority=s,e.callbackNode=l,s}return c!==null&&c!==null&&Mn(c),e.callbackPriority=2,e.callbackNode=null,2}function Bh(e,s){if(yn!==0&&yn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var l=e.callbackNode;if(Go()&&e.callbackNode!==l)return null;var c=dt;return c=Fa(e,e===Ot?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(bh(e,c,s),Ih(e,te()),e.callbackNode!=null&&e.callbackNode===l?Bh.bind(null,e):null)}function Fh(e,s){if(Go())return null;bh(e,s,!0)}function Av(){Lv(function(){(bt&6)!==0?jt(Dt,wv):Uh()})}function Zu(){return Us===0&&(Us=nr()),Us}function jh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Sa(""+e)}function Ph(e,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,e.id&&l.setAttribute("form",e.id),s.parentNode.insertBefore(l,s),e=new FormData(e),l.parentNode.removeChild(l),e}function Tv(e,s,l,c,d){if(s==="submit"&&l&&l.stateNode===d){var m=jh((d[It]||null).action),w=c.submitter;w&&(s=(s=w[It]||null)?jh(s.formAction):w.getAttribute("formAction"),s!==null&&(m=s,w=null));var C=new Js("action","action",null,c,d);e.push({event:C,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Us!==0){var P=w?Ph(d,w):new FormData(d);mu(l,{pending:!0,data:P,method:d.method,action:m},null,P)}}else typeof m=="function"&&(C.preventDefault(),P=w?Ph(d,w):new FormData(d),mu(l,{pending:!0,data:P,method:d.method,action:m},m,P))},currentTarget:d}]})}}for(var $u=0;$u<Lc.length;$u++){var Wu=Lc[$u],Cv=Wu.toLowerCase(),Mv=Wu[0].toUpperCase()+Wu.slice(1);Ma(Cv,"on"+Mv)}Ma(bd,"onAnimationEnd"),Ma(xd,"onAnimationIteration"),Ma(Sd,"onAnimationStart"),Ma("dblclick","onDoubleClick"),Ma("focusin","onFocus"),Ma("focusout","onBlur"),Ma(Yg,"onTransitionRun"),Ma(qg,"onTransitionStart"),Ma(Vg,"onTransitionCancel"),Ma(Ed,"onTransitionEnd"),Ga("onMouseEnter",["mouseout","mouseover"]),Ga("onMouseLeave",["mouseout","mouseover"]),Ga("onPointerEnter",["pointerout","pointerover"]),Ga("onPointerLeave",["pointerout","pointerover"]),la("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),la("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),la("onBeforeInput",["compositionend","keypress","textInput","paste"]),la("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),la("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),la("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bl));function Gh(e,s){s=(s&4)!==0;for(var l=0;l<e.length;l++){var c=e[l],d=c.event;c=c.listeners;e:{var m=void 0;if(s)for(var w=c.length-1;0<=w;w--){var C=c[w],P=C.instance,re=C.currentTarget;if(C=C.listener,P!==m&&d.isPropagationStopped())break e;m=C,d.currentTarget=re;try{m(d)}catch(pe){Do(pe)}d.currentTarget=null,m=P}else for(w=0;w<c.length;w++){if(C=c[w],P=C.instance,re=C.currentTarget,C=C.listener,P!==m&&d.isPropagationStopped())break e;m=C,d.currentTarget=re;try{m(d)}catch(pe){Do(pe)}d.currentTarget=null,m=P}}}}function ot(e,s){var l=s[$l];l===void 0&&(l=s[$l]=new Set);var c=e+"__bubble";l.has(c)||(zh(s,e,2,!1),l.add(c))}function Ku(e,s,l){var c=0;s&&(c|=4),zh(l,e,c,s)}var Yo="_reactListening"+Math.random().toString(36).slice(2);function Ju(e){if(!e[Yo]){e[Yo]=!0,qs.forEach(function(l){l!=="selectionchange"&&(Nv.has(l)||Ku(l,!1,e),Ku(l,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[Yo]||(s[Yo]=!0,Ku("selectionchange",!1,s))}}function zh(e,s,l,c){switch(d0(s)){case 2:var d=ty;break;case 8:d=ny;break;default:d=hf}l=d.bind(null,s,l,e),d=void 0,!bs||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(d=!0),c?d!==void 0?e.addEventListener(s,l,{capture:!0,passive:d}):e.addEventListener(s,l,!0):d!==void 0?e.addEventListener(s,l,{passive:d}):e.addEventListener(s,l,!1)}function ef(e,s,l,c,d){var m=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var C=c.stateNode.containerInfo;if(C===d)break;if(w===4)for(w=c.return;w!==null;){var P=w.tag;if((P===3||P===4)&&w.stateNode.containerInfo===d)return;w=w.return}for(;C!==null;){if(w=it(C),w===null)return;if(P=w.tag,P===5||P===6||P===26||P===27){c=m=w;continue e}C=C.parentNode}}c=c.return}Lr(function(){var re=m,pe=Hi(l),ve=[];e:{var se=wd.get(e);if(se!==void 0){var ie=Js,$e=e;switch(e){case"keypress":if(Ws(l)===0)break e;case"keydown":case"keyup":ie=Ae;break;case"focusin":$e="focus",ie=Yi;break;case"focusout":$e="blur",ie=Yi;break;case"beforeblur":case"afterblur":ie=Yi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=ro;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=Nc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=je;break;case bd:case xd:case Sd:ie=k;break;case Ed:ie=Le;break;case"scroll":case"scrollend":ie=Cc;break;case"wheel":ie=et;break;case"copy":case"cut":case"paste":ie=I;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=Oe;break;case"toggle":case"beforetoggle":ie=pt}var Ve=(s&4)!==0,Ct=!Ve&&(e==="scroll"||e==="scrollend"),ee=Ve?se!==null?se+"Capture":null:se;Ve=[];for(var $=re,ae;$!==null;){var me=$;if(ae=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||ae===null||ee===null||(me=wa($,ee),me!=null&&Ve.push(xl($,me,ae))),Ct)break;$=$.return}0<Ve.length&&(se=new ie(se,$e,null,l,pe),ve.push({event:se,listeners:Ve}))}}if((s&7)===0){e:{if(se=e==="mouseover"||e==="pointerover",ie=e==="mouseout"||e==="pointerout",se&&l!==Zs&&($e=l.relatedTarget||l.fromElement)&&(it($e)||$e[fs]))break e;if((ie||se)&&(se=pe.window===pe?pe:(se=pe.ownerDocument)?se.defaultView||se.parentWindow:window,ie?($e=l.relatedTarget||l.toElement,ie=re,$e=$e?it($e):null,$e!==null&&(Ct=u($e),Ve=$e.tag,$e!==Ct||Ve!==5&&Ve!==27&&Ve!==6)&&($e=null)):(ie=null,$e=re),ie!==$e)){if(Ve=ro,me="onMouseLeave",ee="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(Ve=Oe,me="onPointerLeave",ee="onPointerEnter",$="pointer"),Ct=ie==null?se:_n(ie),ae=$e==null?se:_n($e),se=new Ve(me,$+"leave",ie,l,pe),se.target=Ct,se.relatedTarget=ae,me=null,it(pe)===re&&(Ve=new Ve(ee,$+"enter",$e,l,pe),Ve.target=ae,Ve.relatedTarget=Ct,me=Ve),Ct=me,ie&&$e)t:{for(Ve=ie,ee=$e,$=0,ae=Ve;ae;ae=Mi(ae))$++;for(ae=0,me=ee;me;me=Mi(me))ae++;for(;0<$-ae;)Ve=Mi(Ve),$--;for(;0<ae-$;)ee=Mi(ee),ae--;for(;$--;){if(Ve===ee||ee!==null&&Ve===ee.alternate)break t;Ve=Mi(Ve),ee=Mi(ee)}Ve=null}else Ve=null;ie!==null&&Hh(ve,se,ie,Ve,!1),$e!==null&&Ct!==null&&Hh(ve,Ct,$e,Ve,!0)}}e:{if(se=re?_n(re):window,ie=se.nodeName&&se.nodeName.toLowerCase(),ie==="select"||ie==="input"&&se.type==="file")var Ue=In;else if(qa(se))if(ni)Ue=Gg;else{Ue=jg;var st=Bn}else ie=se.nodeName,!ie||ie.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?re&&Qs(re.elementType)&&(Ue=In):Ue=Pg;if(Ue&&(Ue=Ue(e,re))){Va(ve,Ue,l,pe);break e}st&&st(e,se,re),e==="focusout"&&re&&se.type==="number"&&re.memoizedProps.value!=null&&kr(se,"number",se.value)}switch(st=re?_n(re):window,e){case"focusin":(qa(st)||st.contentEditable==="true")&&(ai=st,_c=re,Vi=null);break;case"focusout":Vi=_c=ai=null;break;case"mousedown":kc=!0;break;case"contextmenu":case"mouseup":case"dragend":kc=!1,vd(ve,l,pe);break;case"selectionchange":if(Hg)break;case"keydown":case"keyup":vd(ve,l,pe)}var He;if(Et)e:{switch(e){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else yt?gt(e,l)&&(Qe="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(Qe="onCompositionStart");Qe&&(wn&&l.locale!=="ko"&&(yt||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&yt&&(He=no()):(Ya=pe,ur="value"in Ya?Ya.value:Ya.textContent,yt=!0)),st=qo(re,Qe),0<st.length&&(Qe=new de(Qe,e,null,l,pe),ve.push({event:Qe,listeners:st}),He?Qe.data=He:(He=tn(l),He!==null&&(Qe.data=He)))),(He=ti?ut(e,l):Yt(e,l))&&(Qe=qo(re,"onBeforeInput"),0<Qe.length&&(st=new de("onBeforeInput","beforeinput",null,l,pe),ve.push({event:st,listeners:Qe}),st.data=He)),Tv(ve,e,re,l,pe)}Gh(ve,s)})}function xl(e,s,l){return{instance:e,listener:s,currentTarget:l}}function qo(e,s){for(var l=s+"Capture",c=[];e!==null;){var d=e,m=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||m===null||(d=wa(e,l),d!=null&&c.unshift(xl(e,d,m)),d=wa(e,s),d!=null&&c.push(xl(e,d,m))),e.tag===3)return c;e=e.return}return[]}function Mi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Hh(e,s,l,c,d){for(var m=s._reactName,w=[];l!==null&&l!==c;){var C=l,P=C.alternate,re=C.stateNode;if(C=C.tag,P!==null&&P===c)break;C!==5&&C!==26&&C!==27||re===null||(P=re,d?(re=wa(l,m),re!=null&&w.unshift(xl(l,re,P))):d||(re=wa(l,m),re!=null&&w.push(xl(l,re,P)))),l=l.return}w.length!==0&&e.push({event:s,listeners:w})}var Rv=/\r\n?/g,Dv=/\u0000|\uFFFD/g;function Yh(e){return(typeof e=="string"?e:""+e).replace(Rv,`
`).replace(Dv,"")}function qh(e,s){return s=Yh(s),Yh(e)===s}function Vo(){}function Tt(e,s,l,c,d,m){switch(l){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||Xn(e,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&Xn(e,""+c);break;case"className":sr(e,"class",c);break;case"tabIndex":sr(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":sr(e,l,c);break;case"style":zi(e,c,m);break;case"data":if(s!=="object"){sr(e,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||l!=="href")){e.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(l);break}c=Sa(""+c),e.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(s!=="input"&&Tt(e,s,"name",d.name,d,null),Tt(e,s,"formEncType",d.formEncType,d,null),Tt(e,s,"formMethod",d.formMethod,d,null),Tt(e,s,"formTarget",d.formTarget,d,null)):(Tt(e,s,"encType",d.encType,d,null),Tt(e,s,"method",d.method,d,null),Tt(e,s,"target",d.target,d,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(l);break}c=Sa(""+c),e.setAttribute(l,c);break;case"onClick":c!=null&&(e.onclick=Vo);break;case"onScroll":c!=null&&ot("scroll",e);break;case"onScrollEnd":c!=null&&ot("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=l}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}l=Sa(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(l,""+c):e.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(l,""):e.removeAttribute(l);break;case"capture":case"download":c===!0?e.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(l,c):e.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(l,c):e.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(l):e.setAttribute(l,c);break;case"popover":ot("beforetoggle",e),ot("toggle",e),Rr(e,"popover",c);break;case"xlinkActuate":Vn(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Vn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Vn(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Vn(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Vn(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Vn(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Vn(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Vn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Vn(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Rr(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=en.get(l)||l,Rr(e,l,c))}}function tf(e,s,l,c,d,m){switch(l){case"style":zi(e,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=l}}break;case"children":typeof c=="string"?Xn(e,c):(typeof c=="number"||typeof c=="bigint")&&Xn(e,""+c);break;case"onScroll":c!=null&&ot("scroll",e);break;case"onScrollEnd":c!=null&&ot("scrollend",e);break;case"onClick":c!=null&&(e.onclick=Vo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xa.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(d=l.endsWith("Capture"),s=l.slice(2,d?l.length-7:void 0),m=e[It]||null,m=m!=null?m[l]:null,typeof m=="function"&&e.removeEventListener(s,m,d),typeof c=="function")){typeof m!="function"&&m!==null&&(l in e?e[l]=null:e.hasAttribute(l)&&e.removeAttribute(l)),e.addEventListener(s,c,d);break e}l in e?e[l]=c:c===!0?e.setAttribute(l,""):Rr(e,l,c)}}}function bn(e,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ot("error",e),ot("load",e);var c=!1,d=!1,m;for(m in l)if(l.hasOwnProperty(m)){var w=l[m];if(w!=null)switch(m){case"src":c=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Tt(e,s,m,w,l,null)}}d&&Tt(e,s,"srcSet",l.srcSet,l,null),c&&Tt(e,s,"src",l.src,l,null);return;case"input":ot("invalid",e);var C=m=w=d=null,P=null,re=null;for(c in l)if(l.hasOwnProperty(c)){var pe=l[c];if(pe!=null)switch(c){case"name":d=pe;break;case"type":w=pe;break;case"checked":P=pe;break;case"defaultChecked":re=pe;break;case"value":m=pe;break;case"defaultValue":C=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,s));break;default:Tt(e,s,c,pe,l,null)}}vs(e,m,C,P,re,w,d,!1),_r(e);return;case"select":ot("invalid",e),c=w=m=null;for(d in l)if(l.hasOwnProperty(d)&&(C=l[d],C!=null))switch(d){case"value":m=C;break;case"defaultValue":w=C;break;case"multiple":c=C;default:Tt(e,s,d,C,l,null)}s=m,l=w,e.multiple=!!c,s!=null?Un(e,!!c,s,!1):l!=null&&Un(e,!!c,l,!0);return;case"textarea":ot("invalid",e),m=d=c=null;for(w in l)if(l.hasOwnProperty(w)&&(C=l[w],C!=null))switch(w){case"value":c=C;break;case"defaultValue":d=C;break;case"children":m=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(i(91));break;default:Tt(e,s,w,C,l,null)}ys(e,c,d,m),_r(e);return;case"option":for(P in l)l.hasOwnProperty(P)&&(c=l[P],c!=null)&&(P==="selected"?e.selected=c&&typeof c!="function"&&typeof c!="symbol":Tt(e,s,P,c,l,null));return;case"dialog":ot("beforetoggle",e),ot("toggle",e),ot("cancel",e),ot("close",e);break;case"iframe":case"object":ot("load",e);break;case"video":case"audio":for(c=0;c<bl.length;c++)ot(bl[c],e);break;case"image":ot("error",e),ot("load",e);break;case"details":ot("toggle",e);break;case"embed":case"source":case"link":ot("error",e),ot("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in l)if(l.hasOwnProperty(re)&&(c=l[re],c!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Tt(e,s,re,c,l,null)}return;default:if(Qs(s)){for(pe in l)l.hasOwnProperty(pe)&&(c=l[pe],c!==void 0&&tf(e,s,pe,c,l,void 0));return}}for(C in l)l.hasOwnProperty(C)&&(c=l[C],c!=null&&Tt(e,s,C,c,l,null))}function _v(e,s,l,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,m=null,w=null,C=null,P=null,re=null,pe=null;for(ie in l){var ve=l[ie];if(l.hasOwnProperty(ie)&&ve!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":P=ve;default:c.hasOwnProperty(ie)||Tt(e,s,ie,null,c,ve)}}for(var se in c){var ie=c[se];if(ve=l[se],c.hasOwnProperty(se)&&(ie!=null||ve!=null))switch(se){case"type":m=ie;break;case"name":d=ie;break;case"checked":re=ie;break;case"defaultChecked":pe=ie;break;case"value":w=ie;break;case"defaultValue":C=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,s));break;default:ie!==ve&&Tt(e,s,se,ie,c,ve)}}gs(e,w,C,P,re,pe,m,d);return;case"select":ie=w=C=se=null;for(m in l)if(P=l[m],l.hasOwnProperty(m)&&P!=null)switch(m){case"value":break;case"multiple":ie=P;default:c.hasOwnProperty(m)||Tt(e,s,m,null,c,P)}for(d in c)if(m=c[d],P=l[d],c.hasOwnProperty(d)&&(m!=null||P!=null))switch(d){case"value":se=m;break;case"defaultValue":C=m;break;case"multiple":w=m;default:m!==P&&Tt(e,s,d,m,c,P)}s=C,l=w,c=ie,se!=null?Un(e,!!l,se,!1):!!c!=!!l&&(s!=null?Un(e,!!l,s,!0):Un(e,!!l,l?[]:"",!1));return;case"textarea":ie=se=null;for(C in l)if(d=l[C],l.hasOwnProperty(C)&&d!=null&&!c.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Tt(e,s,C,null,c,d)}for(w in c)if(d=c[w],m=l[w],c.hasOwnProperty(w)&&(d!=null||m!=null))switch(w){case"value":se=d;break;case"defaultValue":ie=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(i(91));break;default:d!==m&&Tt(e,s,w,d,c,m)}Ha(e,se,ie);return;case"option":for(var $e in l)se=l[$e],l.hasOwnProperty($e)&&se!=null&&!c.hasOwnProperty($e)&&($e==="selected"?e.selected=!1:Tt(e,s,$e,null,c,se));for(P in c)se=c[P],ie=l[P],c.hasOwnProperty(P)&&se!==ie&&(se!=null||ie!=null)&&(P==="selected"?e.selected=se&&typeof se!="function"&&typeof se!="symbol":Tt(e,s,P,se,c,ie));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ve in l)se=l[Ve],l.hasOwnProperty(Ve)&&se!=null&&!c.hasOwnProperty(Ve)&&Tt(e,s,Ve,null,c,se);for(re in c)if(se=c[re],ie=l[re],c.hasOwnProperty(re)&&se!==ie&&(se!=null||ie!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,s));break;default:Tt(e,s,re,se,c,ie)}return;default:if(Qs(s)){for(var Ct in l)se=l[Ct],l.hasOwnProperty(Ct)&&se!==void 0&&!c.hasOwnProperty(Ct)&&tf(e,s,Ct,void 0,c,se);for(pe in c)se=c[pe],ie=l[pe],!c.hasOwnProperty(pe)||se===ie||se===void 0&&ie===void 0||tf(e,s,pe,se,c,ie);return}}for(var ee in l)se=l[ee],l.hasOwnProperty(ee)&&se!=null&&!c.hasOwnProperty(ee)&&Tt(e,s,ee,null,c,se);for(ve in c)se=c[ve],ie=l[ve],!c.hasOwnProperty(ve)||se===ie||se==null&&ie==null||Tt(e,s,ve,se,c,ie)}var nf=null,af=null;function Xo(e){return e.nodeType===9?e:e.ownerDocument}function Vh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xh(e,s){if(e===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&s==="foreignObject"?0:e}function rf(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var sf=null;function kv(){var e=window.event;return e&&e.type==="popstate"?e===sf?!1:(sf=e,!0):(sf=null,!1)}var Qh=typeof setTimeout=="function"?setTimeout:void 0,Ov=typeof clearTimeout=="function"?clearTimeout:void 0,Zh=typeof Promise=="function"?Promise:void 0,Lv=typeof queueMicrotask=="function"?queueMicrotask:typeof Zh<"u"?function(e){return Zh.resolve(null).then(e).catch(Uv)}:Qh;function Uv(e){setTimeout(function(){throw e})}function Jr(e){return e==="head"}function $h(e,s){var l=s,c=0,d=0;do{var m=l.nextSibling;if(e.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(0<c&&8>c){l=c;var w=e.ownerDocument;if(l&1&&Sl(w.documentElement),l&2&&Sl(w.body),l&4)for(l=w.head,Sl(l),w=l.firstChild;w;){var C=w.nextSibling,P=w.nodeName;w[qn]||P==="SCRIPT"||P==="STYLE"||P==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=C}}if(d===0){e.removeChild(m),Rl(s);return}d--}else l==="$"||l==="$?"||l==="$!"?d++:c=l.charCodeAt(0)-48;else c=0;l=m}while(l);Rl(s)}function lf(e){var s=e.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":lf(l),zt(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}e.removeChild(l)}}function Iv(e,s,l,c){for(;e.nodeType===1;){var d=l;if(e.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[qn])switch(s){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(m=e.getAttribute("rel"),m==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(m!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(m=e.getAttribute("src"),(m!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&m&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(s==="input"&&e.type==="hidden"){var m=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===m)return e}else return e;if(e=Ra(e.nextSibling),e===null)break}return null}function Bv(e,s,l){if(s==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!l||(e=Ra(e.nextSibling),e===null))return null;return e}function of(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Fv(e,s){var l=e.ownerDocument;if(e.data!=="$?"||l.readyState==="complete")s();else{var c=function(){s(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Ra(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return e}var cf=null;function Wh(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return e;s--}else l==="/$"&&s++}e=e.previousSibling}return null}function Kh(e,s,l){switch(s=Xo(l),e){case"html":if(e=s.documentElement,!e)throw Error(i(452));return e;case"head":if(e=s.head,!e)throw Error(i(453));return e;case"body":if(e=s.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Sl(e){for(var s=e.attributes;s.length;)e.removeAttributeNode(s[0]);zt(e)}var ga=new Map,Jh=new Set;function Qo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var wr=z.d;z.d={f:jv,r:Pv,D:Gv,C:zv,L:Hv,m:Yv,X:Vv,S:qv,M:Xv};function jv(){var e=wr.f(),s=jo();return e||s}function Pv(e){var s=Dn(e);s!==null&&s.tag===5&&s.type==="form"?bp(s):wr.r(e)}var Ni=typeof document>"u"?null:document;function e0(e,s,l){var c=Ni;if(c&&typeof s=="string"&&s){var d=Sn(s);d='link[rel="'+e+'"][href="'+d+'"]',typeof l=="string"&&(d+='[crossorigin="'+l+'"]'),Jh.has(d)||(Jh.add(d),e={rel:e,crossOrigin:l,href:s},c.querySelector(d)===null&&(s=c.createElement("link"),bn(s,"link",e),Ht(s),c.head.appendChild(s)))}}function Gv(e){wr.D(e),e0("dns-prefetch",e,null)}function zv(e,s){wr.C(e,s),e0("preconnect",e,s)}function Hv(e,s,l){wr.L(e,s,l);var c=Ni;if(c&&e&&s){var d='link[rel="preload"][as="'+Sn(s)+'"]';s==="image"&&l&&l.imageSrcSet?(d+='[imagesrcset="'+Sn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(d+='[imagesizes="'+Sn(l.imageSizes)+'"]')):d+='[href="'+Sn(e)+'"]';var m=d;switch(s){case"style":m=Ri(e);break;case"script":m=Di(e)}ga.has(m)||(e=y({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:e,as:s},l),ga.set(m,e),c.querySelector(d)!==null||s==="style"&&c.querySelector(El(m))||s==="script"&&c.querySelector(wl(m))||(s=c.createElement("link"),bn(s,"link",e),Ht(s),c.head.appendChild(s)))}}function Yv(e,s){wr.m(e,s);var l=Ni;if(l&&e){var c=s&&typeof s.as=="string"?s.as:"script",d='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(e)+'"]',m=d;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Di(e)}if(!ga.has(m)&&(e=y({rel:"modulepreload",href:e},s),ga.set(m,e),l.querySelector(d)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(wl(m)))return}c=l.createElement("link"),bn(c,"link",e),Ht(c),l.head.appendChild(c)}}}function qv(e,s,l){wr.S(e,s,l);var c=Ni;if(c&&e){var d=Pa(c).hoistableStyles,m=Ri(e);s=s||"default";var w=d.get(m);if(!w){var C={loading:0,preload:null};if(w=c.querySelector(El(m)))C.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":s},l),(l=ga.get(m))&&uf(e,l);var P=w=c.createElement("link");Ht(P),bn(P,"link",e),P._p=new Promise(function(re,pe){P.onload=re,P.onerror=pe}),P.addEventListener("load",function(){C.loading|=1}),P.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Zo(w,s,c)}w={type:"stylesheet",instance:w,count:1,state:C},d.set(m,w)}}}function Vv(e,s){wr.X(e,s);var l=Ni;if(l&&e){var c=Pa(l).hoistableScripts,d=Di(e),m=c.get(d);m||(m=l.querySelector(wl(d)),m||(e=y({src:e,async:!0},s),(s=ga.get(d))&&ff(e,s),m=l.createElement("script"),Ht(m),bn(m,"link",e),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(d,m))}}function Xv(e,s){wr.M(e,s);var l=Ni;if(l&&e){var c=Pa(l).hoistableScripts,d=Di(e),m=c.get(d);m||(m=l.querySelector(wl(d)),m||(e=y({src:e,async:!0,type:"module"},s),(s=ga.get(d))&&ff(e,s),m=l.createElement("script"),Ht(m),bn(m,"link",e),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(d,m))}}function t0(e,s,l,c){var d=(d=Ee.current)?Qo(d):null;if(!d)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=Ri(l.href),l=Pa(d).hoistableStyles,c=l.get(s),c||(c={type:"style",instance:null,count:0,state:null},l.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){e=Ri(l.href);var m=Pa(d).hoistableStyles,w=m.get(e);if(w||(d=d.ownerDocument||d,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(e,w),(m=d.querySelector(El(e)))&&!m._p&&(w.instance=m,w.state.loading=5),ga.has(e)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ga.set(e,l),m||Qv(d,e,l,w.state))),s&&c===null)throw Error(i(528,""));return w}if(s&&c!==null)throw Error(i(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Di(l),l=Pa(d).hoistableScripts,c=l.get(s),c||(c={type:"script",instance:null,count:0,state:null},l.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Ri(e){return'href="'+Sn(e)+'"'}function El(e){return'link[rel="stylesheet"]['+e+"]"}function n0(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function Qv(e,s,l,c){e.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=e.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),bn(s,"link",l),Ht(s),e.head.appendChild(s))}function Di(e){return'[src="'+Sn(e)+'"]'}function wl(e){return"script[async]"+e}function a0(e,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var c=e.querySelector('style[data-href~="'+Sn(l.href)+'"]');if(c)return s.instance=c,Ht(c),c;var d=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),Ht(c),bn(c,"style",d),Zo(c,l.precedence,e),s.instance=c;case"stylesheet":d=Ri(l.href);var m=e.querySelector(El(d));if(m)return s.state.loading|=4,s.instance=m,Ht(m),m;c=n0(l),(d=ga.get(d))&&uf(c,d),m=(e.ownerDocument||e).createElement("link"),Ht(m);var w=m;return w._p=new Promise(function(C,P){w.onload=C,w.onerror=P}),bn(m,"link",c),s.state.loading|=4,Zo(m,l.precedence,e),s.instance=m;case"script":return m=Di(l.src),(d=e.querySelector(wl(m)))?(s.instance=d,Ht(d),d):(c=l,(d=ga.get(m))&&(c=y({},l),ff(c,d)),e=e.ownerDocument||e,d=e.createElement("script"),Ht(d),bn(d,"link",c),e.head.appendChild(d),s.instance=d);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,Zo(c,l.precedence,e));return s.instance}function Zo(e,s,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=c.length?c[c.length-1]:null,m=d,w=0;w<c.length;w++){var C=c[w];if(C.dataset.precedence===s)m=C;else if(m!==d)break}m?m.parentNode.insertBefore(e,m.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(e,s.firstChild))}function uf(e,s){e.crossOrigin==null&&(e.crossOrigin=s.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=s.referrerPolicy),e.title==null&&(e.title=s.title)}function ff(e,s){e.crossOrigin==null&&(e.crossOrigin=s.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=s.referrerPolicy),e.integrity==null&&(e.integrity=s.integrity)}var $o=null;function r0(e,s,l){if($o===null){var c=new Map,d=$o=new Map;d.set(l,c)}else d=$o,c=d.get(l),c||(c=new Map,d.set(l,c));if(c.has(e))return c;for(c.set(e,null),l=l.getElementsByTagName(e),d=0;d<l.length;d++){var m=l[d];if(!(m[qn]||m[Pt]||e==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var w=m.getAttribute(s)||"";w=e+w;var C=c.get(w);C?C.push(m):c.set(w,[m])}}return c}function s0(e,s,l){e=e.ownerDocument||e,e.head.insertBefore(l,s==="title"?e.querySelector("head > title"):null)}function Zv(e,s,l){if(l===1||s.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(e=s.disabled,typeof s.precedence=="string"&&e==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function i0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var Al=null;function $v(){}function Wv(e,s,l){if(Al===null)throw Error(i(475));var c=Al;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var d=Ri(l.href),m=e.querySelector(El(d));if(m){e=m._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(c.count++,c=Wo.bind(c),e.then(c,c)),s.state.loading|=4,s.instance=m,Ht(m);return}m=e.ownerDocument||e,l=n0(l),(d=ga.get(d))&&uf(l,d),m=m.createElement("link"),Ht(m);var w=m;w._p=new Promise(function(C,P){w.onload=C,w.onerror=P}),bn(m,"link",l),s.instance=m}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(s,e),(e=s.state.preload)&&(s.state.loading&3)===0&&(c.count++,s=Wo.bind(c),e.addEventListener("load",s),e.addEventListener("error",s))}}function Kv(){if(Al===null)throw Error(i(475));var e=Al;return e.stylesheets&&e.count===0&&df(e,e.stylesheets),0<e.count?function(s){var l=setTimeout(function(){if(e.stylesheets&&df(e,e.stylesheets),e.unsuspend){var c=e.unsuspend;e.unsuspend=null,c()}},6e4);return e.unsuspend=s,function(){e.unsuspend=null,clearTimeout(l)}}:null}function Wo(){if(this.count--,this.count===0){if(this.stylesheets)df(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ko=null;function df(e,s){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ko=new Map,s.forEach(Jv,e),Ko=null,Wo.call(e))}function Jv(e,s){if(!(s.state.loading&4)){var l=Ko.get(e);if(l)var c=l.get(null);else{l=new Map,Ko.set(e,l);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<d.length;m++){var w=d[m];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),c=w)}c&&l.set(null,c)}d=s.instance,w=d.getAttribute("data-precedence"),m=l.get(w)||c,m===c&&l.set(null,d),l.set(w,d),this.count++,c=Wo.bind(this),d.addEventListener("load",c),d.addEventListener("error",c),m?m.parentNode.insertBefore(d,m.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),s.state.loading|=4}}var Tl={$$typeof:N,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function ey(e,s,l,c,d,m,w,C){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ya(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ya(0),this.hiddenUpdates=ya(null),this.identifierPrefix=c,this.onUncaughtError=d,this.onCaughtError=m,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function l0(e,s,l,c,d,m,w,C,P,re,pe,ve){return e=new ey(e,s,l,w,C,P,re,ve),s=1,m===!0&&(s|=24),m=Wn(3,null,null,s),e.current=m,m.stateNode=e,s=Vc(),s.refCount++,e.pooledCache=s,s.refCount++,m.memoizedState={element:c,isDehydrated:l,cache:s},$c(m),e}function o0(e){return e?(e=li,e):li}function c0(e,s,l,c,d,m){d=o0(d),c.context===null?c.context=d:c.pendingContext=d,c=Pr(s),c.payload={element:l},m=m===void 0?null:m,m!==null&&(c.callback=m),l=Gr(e,c,s),l!==null&&(na(l,e,s),tl(l,e,s))}function u0(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<s?l:s}}function pf(e,s){u0(e,s),(e=e.alternate)&&u0(e,s)}function f0(e){if(e.tag===13){var s=ii(e,67108864);s!==null&&na(s,e,67108864),pf(e,67108864)}}var Jo=!0;function ty(e,s,l,c){var d=L.T;L.T=null;var m=z.p;try{z.p=2,hf(e,s,l,c)}finally{z.p=m,L.T=d}}function ny(e,s,l,c){var d=L.T;L.T=null;var m=z.p;try{z.p=8,hf(e,s,l,c)}finally{z.p=m,L.T=d}}function hf(e,s,l,c){if(Jo){var d=mf(c);if(d===null)ef(e,s,c,ec,l),p0(e,c);else if(ry(d,e,s,l,c))c.stopPropagation();else if(p0(e,c),s&4&&-1<ay.indexOf(e)){for(;d!==null;){var m=Dn(d);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var w=Ba(m.pendingLanes);if(w!==0){var C=m;for(C.pendingLanes|=2,C.entangledLanes|=2;w;){var P=1<<31-Kt(w);C.entanglements[1]|=P,w&=~P}Wa(m),(bt&6)===0&&(Bo=te()+500,yl(0))}}break;case 13:C=ii(m,2),C!==null&&na(C,m,2),jo(),pf(m,2)}if(m=mf(c),m===null&&ef(e,s,c,ec,l),m===d)break;d=m}d!==null&&c.stopPropagation()}else ef(e,s,c,null,l)}}function mf(e){return e=Hi(e),gf(e)}var ec=null;function gf(e){if(ec=null,e=it(e),e!==null){var s=u(e);if(s===null)e=null;else{var l=s.tag;if(l===13){if(e=f(s),e!==null)return e;e=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null)}}return ec=e,null}function d0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ft()){case Dt:return 2;case Nt:return 8;case ke:case qe:return 32;case Ln:return 268435456;default:return 32}default:return 32}}var vf=!1,es=null,ts=null,ns=null,Cl=new Map,Ml=new Map,as=[],ay="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function p0(e,s){switch(e){case"focusin":case"focusout":es=null;break;case"dragenter":case"dragleave":ts=null;break;case"mouseover":case"mouseout":ns=null;break;case"pointerover":case"pointerout":Cl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ml.delete(s.pointerId)}}function Nl(e,s,l,c,d,m){return e===null||e.nativeEvent!==m?(e={blockedOn:s,domEventName:l,eventSystemFlags:c,nativeEvent:m,targetContainers:[d]},s!==null&&(s=Dn(s),s!==null&&f0(s)),e):(e.eventSystemFlags|=c,s=e.targetContainers,d!==null&&s.indexOf(d)===-1&&s.push(d),e)}function ry(e,s,l,c,d){switch(s){case"focusin":return es=Nl(es,e,s,l,c,d),!0;case"dragenter":return ts=Nl(ts,e,s,l,c,d),!0;case"mouseover":return ns=Nl(ns,e,s,l,c,d),!0;case"pointerover":var m=d.pointerId;return Cl.set(m,Nl(Cl.get(m)||null,e,s,l,c,d)),!0;case"gotpointercapture":return m=d.pointerId,Ml.set(m,Nl(Ml.get(m)||null,e,s,l,c,d)),!0}return!1}function h0(e){var s=it(e.target);if(s!==null){var l=u(s);if(l!==null){if(s=l.tag,s===13){if(s=f(l),s!==null){e.blockedOn=s,ja(e.priority,function(){if(l.tag===13){var c=ta();c=Yn(c);var d=ii(l,c);d!==null&&na(d,l,c),pf(l,c)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function tc(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var l=mf(e.nativeEvent);if(l===null){l=e.nativeEvent;var c=new l.constructor(l.type,l);Zs=c,l.target.dispatchEvent(c),Zs=null}else return s=Dn(l),s!==null&&f0(s),e.blockedOn=l,!1;s.shift()}return!0}function m0(e,s,l){tc(e)&&l.delete(s)}function sy(){vf=!1,es!==null&&tc(es)&&(es=null),ts!==null&&tc(ts)&&(ts=null),ns!==null&&tc(ns)&&(ns=null),Cl.forEach(m0),Ml.forEach(m0)}function nc(e,s){e.blockedOn===s&&(e.blockedOn=null,vf||(vf=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,sy)))}var ac=null;function g0(e){ac!==e&&(ac=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){ac===e&&(ac=null);for(var s=0;s<e.length;s+=3){var l=e[s],c=e[s+1],d=e[s+2];if(typeof c!="function"){if(gf(c||l)===null)continue;break}var m=Dn(l);m!==null&&(e.splice(s,3),s-=3,mu(m,{pending:!0,data:d,method:l.method,action:c},c,d))}}))}function Rl(e){function s(P){return nc(P,e)}es!==null&&nc(es,e),ts!==null&&nc(ts,e),ns!==null&&nc(ns,e),Cl.forEach(s),Ml.forEach(s);for(var l=0;l<as.length;l++){var c=as[l];c.blockedOn===e&&(c.blockedOn=null)}for(;0<as.length&&(l=as[0],l.blockedOn===null);)h0(l),l.blockedOn===null&&as.shift();if(l=(e.ownerDocument||e).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var d=l[c],m=l[c+1],w=d[It]||null;if(typeof m=="function")w||g0(l);else if(w){var C=null;if(m&&m.hasAttribute("formAction")){if(d=m,w=m[It]||null)C=w.formAction;else if(gf(d)!==null)continue}else C=w.action;typeof C=="function"?l[c+1]=C:(l.splice(c,3),c-=3),g0(l)}}}function yf(e){this._internalRoot=e}rc.prototype.render=yf.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(i(409));var l=s.current,c=ta();c0(l,c,e,s,null,null)},rc.prototype.unmount=yf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;c0(e.current,2,null,e,null,null),jo(),s[fs]=null}};function rc(e){this._internalRoot=e}rc.prototype.unstable_scheduleHydration=function(e){if(e){var s=Fi();e={blockedOn:null,target:e,priority:s};for(var l=0;l<as.length&&s!==0&&s<as[l].priority;l++);as.splice(l,0,e),l===0&&h0(e)}};var v0=n.version;if(v0!=="19.1.1")throw Error(i(527,v0,"19.1.1"));z.findDOMNode=function(e){var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=p(s),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var iy={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sc.isDisabled&&sc.supportsFiber)try{va=sc.inject(iy),cn=sc}catch{}}return _l.createRoot=function(e,s){if(!o(e))throw Error(i(299));var l=!1,c="",d=Op,m=Lp,w=Up,C=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(d=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(C=s.unstable_transitionCallbacks)),s=l0(e,1,!1,null,null,l,c,d,m,w,C,null),e[fs]=s.current,Ju(e),new yf(s)},_l.hydrateRoot=function(e,s,l){if(!o(e))throw Error(i(299));var c=!1,d="",m=Op,w=Lp,C=Up,P=null,re=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(d=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(P=l.unstable_transitionCallbacks),l.formState!==void 0&&(re=l.formState)),s=l0(e,1,!0,s,l??null,c,d,m,w,C,P,re),s.context=o0(null),l=s.current,c=ta(),c=Yn(c),d=Pr(c),d.callback=null,Gr(l,d,c),l=c,s.current.lanes=l,zn(s,l),Wa(s),e[fs]=s.current,Ju(e),new rc(s)},_l.version="19.1.1",_l}var M0;function my(){if(M0)return Sf.exports;M0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),Sf.exports=hy(),Sf.exports}var gy=my();const vy=Qf(gy),yy="modulepreload",by=function(a,n){return new URL(a,n).href},N0={},R0=function(n,r,i){let o=Promise.resolve();if(r&&r.length>0){let v=function(y){return Promise.all(y.map(S=>Promise.resolve(S).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");o=v(r.map(y=>{if(y=by(y,i),y in N0)return;N0[y]=!0;const S=y.endsWith(".css"),b=S?'[rel="stylesheet"]':"";if(i)for(let E=f.length-1;E>=0;E--){const A=f[E];if(A.href===y&&(!S||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${b}`))return;const x=document.createElement("link");if(x.rel=S?"stylesheet":yy,S||(x.as="script"),x.crossOrigin="",x.href=y,p&&x.setAttribute("nonce",p),document.head.appendChild(x),S)return new Promise((E,A)=>{x.addEventListener("load",E),x.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return o.then(f=>{for(const h of f||[])h.status==="rejected"&&u(h.reason);return n().catch(u)})};class Da{constructor(n=!1){this.eventMap={},this.eventsSuspended=n==!0}addListener(n,r,i={}){if(typeof n=="string"&&n.length<1||n instanceof String&&n.length<1||typeof n!="string"&&!(n instanceof String)&&n!==Da.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof r!="function")throw new TypeError("The callback must be a function.");const o=new D0(n,this,r,i);return this.eventMap[n]||(this.eventMap[n]=[]),i.prepend?this.eventMap[n].unshift(o):this.eventMap[n].push(o),o}addOneTimeListener(n,r,i={}){i.remaining=1,this.addListener(n,r,i)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(n,r){return n===void 0?this.eventMap[Da.ANY_EVENT]&&this.eventMap[Da.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,i])=>i.length>0):this.eventMap[n]&&this.eventMap[n].length>0?r instanceof D0?this.eventMap[n].filter(o=>o===r).length>0:typeof r=="function"?this.eventMap[n].filter(o=>o.callback===r).length>0:r==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(n){return this.eventMap[n]||[]}suspendEvent(n){this.getListeners(n).forEach(r=>{r.suspended=!0})}unsuspendEvent(n){this.getListeners(n).forEach(r=>{r.suspended=!1})}getListenerCount(n){return this.getListeners(n).length}emit(n,...r){if(typeof n!="string"&&!(n instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let i=[],o=this.eventMap[Da.ANY_EVENT]||[];return this.eventMap[n]&&(o=o.concat(this.eventMap[n])),o.forEach(u=>{if(u.suspended)return;let f=[...r];Array.isArray(u.arguments)&&(f=f.concat(u.arguments)),u.remaining>0&&(i.push(u.callback.apply(u.context,f)),u.count++),--u.remaining<1&&u.remove()}),i}removeListener(n,r,i={}){if(n===void 0){this.eventMap={};return}else if(!this.eventMap[n])return;let o=this.eventMap[n].filter(u=>r&&u.callback!==r||i.remaining&&i.remaining!==u.remaining||i.context&&i.context!==u.context);o.length?this.eventMap[n]=o:delete this.eventMap[n]}async waitFor(n,r={}){return r.duration=parseInt(r.duration),(isNaN(r.duration)||r.duration<=0)&&(r.duration=1/0),new Promise((i,o)=>{let u,f=this.addListener(n,()=>{clearTimeout(u),i()},{remaining:1});r.duration!==1/0&&(u=setTimeout(()=>{f.remove(),o("The duration expired before the event was emitted.")},r.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class D0{constructor(n,r,i,o={}){if(typeof n!="string"&&!(n instanceof String)&&n!==Da.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!r)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof i!="function")throw new TypeError("The 'callback' must be a function.");o.arguments!==void 0&&!Array.isArray(o.arguments)&&(o.arguments=[o.arguments]),o=Object.assign({context:r,remaining:1/0,arguments:void 0,duration:1/0},o),o.duration!==1/0&&setTimeout(()=>this.remove(),o.duration),this.arguments=o.arguments,this.callback=i,this.context=o.context,this.count=0,this.event=n,this.remaining=parseInt(o.remaining)>=1?parseInt(o.remaining):1/0,this.suspended=!1,this.target=r}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}class ge{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),ge.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),ge.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),ge.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),ge.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}class ki{constructor(n,r={}){this.duration=xe.defaults.note.duration,this.attack=xe.defaults.note.attack,this.release=xe.defaults.note.release,r.duration!=null&&(this.duration=r.duration),r.attack!=null&&(this.attack=r.attack),r.rawAttack!=null&&(this.attack=Ce.from7bitToFloat(r.rawAttack)),r.release!=null&&(this.release=r.release),r.rawRelease!=null&&(this.release=Ce.from7bitToFloat(r.rawRelease)),Number.isInteger(n)?this.identifier=Ce.toNoteIdentifier(n):this.identifier=n}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(n){const r=Ce.getNoteDetails(n);if(xe.validation&&!n)throw new Error("Invalid note identifier");this._name=r.name,this._accidental=r.accidental,this._octave=r.octave}get name(){return this._name}set name(n){if(xe.validation&&(n=n.toUpperCase(),!["C","D","E","F","G","A","B"].includes(n)))throw new Error("Invalid name value");this._name=n}get accidental(){return this._accidental}set accidental(n){if(xe.validation&&(n=n.toLowerCase(),!["#","##","b","bb"].includes(n)))throw new Error("Invalid accidental value");this._accidental=n}get octave(){return this._octave}set octave(n){if(xe.validation&&(n=parseInt(n),isNaN(n)))throw new Error("Invalid octave value");this._octave=n}get duration(){return this._duration}set duration(n){if(xe.validation&&(n=parseFloat(n),isNaN(n)||n===null||n<0))throw new RangeError("Invalid duration value.");this._duration=n}get attack(){return this._attack}set attack(n){if(xe.validation&&(n=parseFloat(n),isNaN(n)||!(n>=0&&n<=1)))throw new RangeError("Invalid attack value.");this._attack=n}get release(){return this._release}set release(n){if(xe.validation&&(n=parseFloat(n),isNaN(n)||!(n>=0&&n<=1)))throw new RangeError("Invalid release value.");this._release=n}get rawAttack(){return Ce.fromFloatTo7Bit(this._attack)}set rawAttack(n){this._attack=Ce.from7bitToFloat(n)}get rawRelease(){return Ce.fromFloatTo7Bit(this._release)}set rawRelease(n){this._release=Ce.from7bitToFloat(n)}get number(){return Ce.toNoteNumber(this.identifier)}getOffsetNumber(n=0,r=0){return xe.validation&&(n=parseInt(n)||0,r=parseInt(r)||0),Math.min(Math.max(this.number+n*12+r,0),127)}}class Ce{static toNoteNumber(n,r=0){if(r=r==null?0:parseInt(r),isNaN(r))throw new RangeError("Invalid 'octaveOffset' value");typeof n!="string"&&(n="");const i=this.getNoteDetails(n);if(!i)throw new TypeError("Invalid note identifier");const o={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let u=(i.octave+1+r)*12;if(u+=o[i.name],i.accidental&&(i.accidental.startsWith("b")?u-=i.accidental.length:u+=i.accidental.length),u<0||u>127)throw new RangeError("Invalid octaveOffset value");return u}static getNoteDetails(n){Number.isInteger(n)&&(n=this.toNoteIdentifier(n));const r=n.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!r)throw new TypeError("Invalid note identifier");const i=r[1].toUpperCase(),o=parseInt(r[3]);let u=r[2].toLowerCase();return u=u===""?void 0:u,{accidental:u,identifier:i+(u||"")+o,name:i,octave:o}}static sanitizeChannels(n){let r;if(xe.validation){if(n==="all")r=["all"];else if(n==="none")return[]}return Array.isArray(n)?r=n:r=[n],r.indexOf("all")>-1&&(r=ge.MIDI_CHANNEL_NUMBERS),r.map(function(i){return parseInt(i)}).filter(function(i){return i>=1&&i<=16})}static toTimestamp(n){let r=!1;const i=parseFloat(n);return isNaN(i)?!1:(typeof n=="string"&&n.substring(0,1)==="+"?i>=0&&(r=xe.time+i):i>=0&&(r=i),r)}static guessNoteNumber(n,r){r=parseInt(r)||0;let i=!1;if(Number.isInteger(n)&&n>=0&&n<=127)i=parseInt(n);else if(parseInt(n)>=0&&parseInt(n)<=127)i=parseInt(n);else if(typeof n=="string"||n instanceof String)try{i=this.toNoteNumber(n.trim(),r)}catch{return!1}return i}static toNoteIdentifier(n,r){if(n=parseInt(n),isNaN(n)||n<0||n>127)throw new RangeError("Invalid note number");if(r=r==null?0:parseInt(r),isNaN(r))throw new RangeError("Invalid octaveOffset value");const i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=Math.floor(n/12-1)+r;return i[n%12]+o.toString()}static buildNote(n,r={}){if(r.octaveOffset=parseInt(r.octaveOffset)||0,n instanceof ki)return n;let i=this.guessNoteNumber(n,r.octaveOffset);if(i===!1)throw new TypeError(`The input could not be parsed as a note (${n})`);return r.octaveOffset=void 0,new ki(i,r)}static buildNoteArray(n,r={}){let i=[];return Array.isArray(n)||(n=[n]),n.forEach(o=>{i.push(this.buildNote(o,r))}),i}static from7bitToFloat(n){return n===1/0&&(n=127),n=parseInt(n)||0,Math.min(Math.max(n/127,0),1)}static fromFloatTo7Bit(n){return n===1/0&&(n=1),n=parseFloat(n)||0,Math.min(Math.max(Math.round(n*127),0),127)}static fromMsbLsbToFloat(n,r=0){xe.validation&&(n=Math.min(Math.max(parseInt(n)||0,0),127),r=Math.min(Math.max(parseInt(r)||0,0),127));const i=((n<<7)+r)/16383;return Math.min(Math.max(i,0),1)}static fromFloatToMsbLsb(n){xe.validation&&(n=Math.min(Math.max(parseFloat(n)||0,0),1));const r=Math.round(n*16383);return{msb:r>>7,lsb:r&127}}static offsetNumber(n,r=0,i=0){if(xe.validation){if(n=parseInt(n),isNaN(n))throw new Error("Invalid note number");r=parseInt(r)||0,i=parseInt(i)||0}return Math.min(Math.max(n+r*12+i,0),127)}static getPropertyByValue(n,r){return Object.keys(n).find(i=>n[i]===r)}static getCcNameByNumber(n){if(!(xe.validation&&(n=parseInt(n),!(n>=0&&n<=127))))return ge.CONTROL_CHANGE_MESSAGES[n].name}static getCcNumberByName(n){let r=ge.CONTROL_CHANGE_MESSAGES.find(i=>i.name===n);return r?r.number:ge.MIDI_CONTROL_CHANGE_MESSAGES[n]}static getChannelModeByNumber(n){if(!(n>=120&&n<=127))return!1;for(let r in ge.CHANNEL_MODE_MESSAGES)if(ge.CHANNEL_MODE_MESSAGES.hasOwnProperty(r)&&n===ge.CHANNEL_MODE_MESSAGES[r])return r;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}class xy extends Da{constructor(n,r){super(),this._output=n,this._number=r,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(n,r={time:0}){return this.output.send(n,r),this}sendKeyAftertouch(n,r,i={}){if(xe.validation){if(i.useRawValue&&(i.rawValue=i.useRawValue),isNaN(parseFloat(r)))throw new RangeError("Invalid key aftertouch value.");if(i.rawValue){if(!(r>=0&&r<=127&&Number.isInteger(r)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(r>=0&&r<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}i.rawValue||(r=Ce.fromFloatTo7Bit(r));const o=xe.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(n)||(n=[n]),Ce.buildNoteArray(n).forEach(u=>{this.send([(ge.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),u.getOffsetNumber(o),r],{time:Ce.toTimestamp(i.time)})}),this}sendControlChange(n,r,i={}){if(typeof n=="string"&&(n=Ce.getCcNumberByName(n)),Array.isArray(r)||(r=[r]),xe.validation){if(n===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(n)||!(n>=0&&n<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(r=r.map(o=>{const u=Math.min(Math.max(parseInt(o),0),127);if(isNaN(u))throw new TypeError("Values must be integers between 0 and 127");return u}),r.length===2&&n>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return r.forEach((o,u)=>{this.send([(ge.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),n+u*32,r[u]],{time:Ce.toTimestamp(i.time)})}),this}_selectNonRegisteredParameter(n,r={}){return this.sendControlChange(99,n[0],r),this.sendControlChange(98,n[1],r),this}_deselectRegisteredParameter(n={}){return this.sendControlChange(101,127,n),this.sendControlChange(100,127,n),this}_deselectNonRegisteredParameter(n={}){return this.sendControlChange(101,127,n),this.sendControlChange(100,127,n),this}_selectRegisteredParameter(n,r={}){return this.sendControlChange(101,n[0],r),this.sendControlChange(100,n[1],r),this}_setCurrentParameter(n,r={}){return n=[].concat(n),this.sendControlChange(6,n[0],r),n.length<2?this:(this.sendControlChange(38,n[1],r),this)}sendRpnDecrement(n,r={}){if(Array.isArray(n)||(n=ge.REGISTERED_PARAMETERS[n]),xe.validation){if(n===void 0)throw new TypeError("The specified registered parameter is invalid.");let i=!1;if(Object.getOwnPropertyNames(ge.REGISTERED_PARAMETERS).forEach(o=>{ge.REGISTERED_PARAMETERS[o][0]===n[0]&&ge.REGISTERED_PARAMETERS[o][1]===n[1]&&(i=!0)}),!i)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(n,r),this.sendControlChange(97,0,r),this._deselectRegisteredParameter(r),this}sendRpnIncrement(n,r={}){if(Array.isArray(n)||(n=ge.REGISTERED_PARAMETERS[n]),xe.validation){if(n===void 0)throw new TypeError("The specified registered parameter is invalid.");let i=!1;if(Object.getOwnPropertyNames(ge.REGISTERED_PARAMETERS).forEach(o=>{ge.REGISTERED_PARAMETERS[o][0]===n[0]&&ge.REGISTERED_PARAMETERS[o][1]===n[1]&&(i=!0)}),!i)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(n,r),this.sendControlChange(96,0,r),this._deselectRegisteredParameter(r),this}playNote(n,r={}){this.sendNoteOn(n,r);const i=Array.isArray(n)?n:[n];for(let o of i)if(parseInt(o.duration)>0){const u={time:(Ce.toTimestamp(r.time)||xe.time)+parseInt(o.duration),release:o.release,rawRelease:o.rawRelease};this.sendNoteOff(o,u)}else if(parseInt(r.duration)>0){const u={time:(Ce.toTimestamp(r.time)||xe.time)+parseInt(r.duration),release:r.release,rawRelease:r.rawRelease};this.sendNoteOff(o,u)}return this}sendNoteOff(n,r={}){if(xe.validation){if(r.rawRelease!=null&&!(r.rawRelease>=0&&r.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(r.release!=null&&!(r.release>=0&&r.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");r.rawVelocity&&(r.rawRelease=r.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),r.velocity&&(r.release=r.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let i=64;r.rawRelease!=null?i=r.rawRelease:isNaN(r.release)||(i=Math.round(r.release*127));const o=xe.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Ce.buildNoteArray(n,{rawRelease:parseInt(i)}).forEach(u=>{this.send([(ge.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),u.getOffsetNumber(o),u.rawRelease],{time:Ce.toTimestamp(r.time)})}),this}stopNote(n,r={}){return this.sendNoteOff(n,r)}sendNoteOn(n,r={}){if(xe.validation){if(r.rawAttack!=null&&!(r.rawAttack>=0&&r.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(r.attack!=null&&!(r.attack>=0&&r.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");r.rawVelocity&&(r.rawAttack=r.velocity,r.rawRelease=r.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),r.velocity&&(r.attack=r.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let i=64;r.rawAttack!=null?i=r.rawAttack:isNaN(r.attack)||(i=Math.round(r.attack*127));const o=xe.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Ce.buildNoteArray(n,{rawAttack:i}).forEach(u=>{this.send([(ge.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),u.getOffsetNumber(o),u.rawAttack],{time:Ce.toTimestamp(r.time)})}),this}sendChannelMode(n,r=0,i={}){if(typeof n=="string"&&(n=ge.CHANNEL_MODE_MESSAGES[n]),xe.validation){if(n===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(n)||!(n>=120&&n<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(r))||r<0||r>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(ge.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),n,r],{time:Ce.toTimestamp(i.time)}),this}sendOmniMode(n,r={}){return n===void 0||n?this.sendChannelMode("omnimodeon",0,r):this.sendChannelMode("omnimodeoff",0,r),this}sendChannelAftertouch(n,r={}){if(xe.validation){if(isNaN(parseFloat(n)))throw new RangeError("Invalid channel aftertouch value.");if(r.rawValue){if(!(n>=0&&n<=127&&Number.isInteger(n)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(n>=0&&n<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return r.rawValue||(n=Ce.fromFloatTo7Bit(n)),this.send([(ge.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(n)],{time:Ce.toTimestamp(r.time)}),this}sendMasterTuning(n,r={}){if(n=parseFloat(n)||0,xe.validation&&!(n>-65&&n<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let i=Math.floor(n)+64,o=n-Math.floor(n);o=Math.round((o+1)/2*16383);let u=o>>7&127,f=o&127;return this.sendRpnValue("channelcoarsetuning",i,r),this.sendRpnValue("channelfinetuning",[u,f],r),this}sendModulationRange(n,r,i={}){if(xe.validation){if(!Number.isInteger(n)||!(n>=0&&n<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(r!=null&&(!Number.isInteger(r)||!(r>=0&&r<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return r>=0&&r<=127||(r=0),this.sendRpnValue("modulationrange",[n,r],i),this}sendNrpnValue(n,r,i={}){if(r=[].concat(r),xe.validation){if(!Array.isArray(n)||!Number.isInteger(n[0])||!Number.isInteger(n[1]))throw new TypeError("The specified NRPN is invalid.");if(!(n[0]>=0&&n[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(n[1]>=0&&n[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");r.forEach(o=>{if(!(o>=0&&o<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(n,i),this._setCurrentParameter(r,i),this._deselectNonRegisteredParameter(i),this}sendPitchBend(n,r={}){if(xe.validation)if(r.rawValue&&Array.isArray(n)){if(!(n[0]>=0&&n[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(n[1]>=0&&n[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(r.rawValue&&!Array.isArray(n)){if(!(n>=0&&n<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(n)||n===null)throw new RangeError("Invalid pitch bend value.");if(!(n>=-1&&n<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let i=0,o=0;if(r.rawValue&&Array.isArray(n))i=n[0],o=n[1];else if(r.rawValue&&!Array.isArray(n))i=n;else{const u=Ce.fromFloatToMsbLsb((n+1)/2);i=u.msb,o=u.lsb}return this.send([(ge.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),o,i],{time:Ce.toTimestamp(r.time)}),this}sendPitchBendRange(n,r,i={}){if(xe.validation){if(!Number.isInteger(n)||!(n>=0&&n<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(r)||!(r>=0&&r<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[n,r],i),this}sendProgramChange(n,r={}){if(n=parseInt(n)||0,xe.validation&&!(n>=0&&n<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(ge.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),n],{time:Ce.toTimestamp(r.time)}),this}sendRpnValue(n,r,i={}){if(Array.isArray(n)||(n=ge.REGISTERED_PARAMETERS[n]),xe.validation){if(!Number.isInteger(n[0])||!Number.isInteger(n[1]))throw new TypeError("The specified NRPN is invalid.");if(!(n[0]>=0&&n[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(n[1]>=0&&n[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(r).forEach(o=>{if(!(o>=0&&o<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(n,i),this._setCurrentParameter(r,i),this._deselectRegisteredParameter(i),this}sendTuningBank(n,r={}){if(xe.validation&&(!Number.isInteger(n)||!(n>=0&&n<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",n,r),this}sendTuningProgram(n,r={}){if(xe.validation&&(!Number.isInteger(n)||!(n>=0&&n<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",n,r),this}sendLocalControl(n,r={}){return n?this.sendChannelMode("localcontrol",127,r):this.sendChannelMode("localcontrol",0,r)}sendAllNotesOff(n={}){return this.sendChannelMode("allnotesoff",0,n)}sendAllSoundOff(n={}){return this.sendChannelMode("allsoundoff",0,n)}sendResetAllControllers(n={}){return this.sendChannelMode("resetallcontrollers",0,n)}sendPolyphonicMode(n,r={}){return n==="mono"?this.sendChannelMode("monomodeon",0,r):this.sendChannelMode("polymodeon",0,r)}get octaveOffset(){return this._octaveOffset}set octaveOffset(n){if(this.validation&&(n=parseInt(n),isNaN(n)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=n}get output(){return this._output}get number(){return this._number}}class Uf extends Da{constructor(n){super(),this._midiOutput=n,this._octaveOffset=0,this.channels=[];for(let r=1;r<=16;r++)this.channels[r]=new xy(this,r);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(n=>n.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(n){let r={timestamp:xe.time};n.port.connection==="open"?(r.type="opened",r.target=this,r.port=r.target,this.emit("opened",r)):n.port.connection==="closed"&&n.port.state==="connected"?(r.type="closed",r.target=this,r.port=r.target,this.emit("closed",r)):n.port.connection==="closed"&&n.port.state==="disconnected"?(r.type="disconnected",r.port={connection:n.port.connection,id:n.port.id,manufacturer:n.port.manufacturer,name:n.port.name,state:n.port.state,type:n.port.type},this.emit("disconnected",r)):n.port.connection==="pending"&&n.port.state==="disconnected"||console.warn("This statechange event was not caught:",n.port.connection,n.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(n){return Promise.reject(n)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(n,r={time:0},i=0){if(n instanceof Nm&&(n=Ce.isNode?n.data:n.rawData),n instanceof Uint8Array&&Ce.isNode&&(n=Array.from(n)),xe.validation){if(!Array.isArray(n)&&!(n instanceof Uint8Array)&&(n=[n],Array.isArray(r)&&(n=n.concat(r)),r=isNaN(i)?{time:0}:{time:i}),!(parseInt(n[0])>=128&&parseInt(n[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");n.slice(1).forEach(o=>{if(o=parseInt(o),!(o>=0&&o<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),r||(r={time:0})}return this._midiOutput.send(n,Ce.toTimestamp(r.time)),this}sendSysex(n,r=[],i={}){if(n=[].concat(n),r instanceof Uint8Array){const o=new Uint8Array(1+n.length+r.length+1);o[0]=ge.SYSTEM_MESSAGES.sysex,o.set(Uint8Array.from(n),1),o.set(r,1+n.length),o[o.length-1]=ge.SYSTEM_MESSAGES.sysexend,this.send(o,{time:i.time})}else{const o=n.concat(r,ge.SYSTEM_MESSAGES.sysexend);this.send([ge.SYSTEM_MESSAGES.sysex].concat(o),{time:i.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():xe.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(n,r={}){if(xe.validation&&(n=parseInt(n),isNaN(n)||!(n>=0&&n<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([ge.SYSTEM_MESSAGES.timecode,n],{time:r.time}),this}sendSongPosition(n=0,r={}){n=Math.floor(n)||0;var i=n>>7&127,o=n&127;return this.send([ge.SYSTEM_MESSAGES.songposition,i,o],{time:r.time}),this}sendSongSelect(n=0,r={}){if(xe.validation&&(n=parseInt(n),isNaN(n)||!(n>=0&&n<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([ge.SYSTEM_MESSAGES.songselect,n],{time:r.time}),this}sendTuneRequest(n={}){return this.send([ge.SYSTEM_MESSAGES.tunerequest],{time:n.time}),this}sendClock(n={}){return this.send([ge.SYSTEM_MESSAGES.clock],{time:n.time}),this}sendStart(n={}){return this.send([ge.SYSTEM_MESSAGES.start],{time:n.time}),this}sendContinue(n={}){return this.send([ge.SYSTEM_MESSAGES.continue],{time:n.time}),this}sendStop(n={}){return this.send([ge.SYSTEM_MESSAGES.stop],{time:n.time}),this}sendActiveSensing(n={}){return this.send([ge.SYSTEM_MESSAGES.activesensing],{time:n.time}),this}sendReset(n={}){return this.send([ge.SYSTEM_MESSAGES.reset],{time:n.time}),this}sendTuningRequest(n={}){return xe.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(n)}sendKeyAftertouch(n,r,i={}){return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendKeyAftertouch(n,r,i)}),this}sendControlChange(n,r,i={},o={}){if(xe.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const u=i;i=o,i.channels=u,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(u=>{this.channels[u].sendControlChange(n,r,i)}),this}sendPitchBendRange(n=0,r=0,i={}){return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendPitchBendRange(n,r,i)}),this}setPitchBendRange(n=0,r=0,i="all",o={}){return xe.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),o.channels=i,o.channels==="all"&&(o.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(n,r,o)}sendRpnValue(n,r,i={}){return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendRpnValue(n,r,i)}),this}setRegisteredParameter(n,r=[],i="all",o={}){return xe.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),o.channels=i,o.channels==="all"&&(o.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(n,r,o)}sendChannelAftertouch(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendChannelAftertouch(n,r)}),this}sendPitchBend(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendPitchBend(n,r)}),this}sendProgramChange(n=0,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendProgramChange(n,r)}),this}sendModulationRange(n,r,i={}){return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendModulationRange(n,r,i)}),this}setModulationRange(n=0,r=0,i="all",o={}){return xe.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),o.channels=i,o.channels==="all"&&(o.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(n,r,o)}sendMasterTuning(n,r={}){return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendMasterTuning(n,r)}),this}setMasterTuning(n,r={},i={}){return xe.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),i.channels=r,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(n,i)}sendTuningProgram(n,r={}){return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendTuningProgram(n,r)}),this}setTuningProgram(n,r="all",i={}){return xe.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),i.channels=r,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(n,i)}sendTuningBank(n=0,r={}){return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendTuningBank(n,r)}),this}setTuningBank(n,r="all",i={}){return xe.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),i.channels=r,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(n,i)}sendChannelMode(n,r=0,i={},o={}){if(xe.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const u=i;i=o,i.channels=u,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(u=>{this.channels[u].sendChannelMode(n,r,i)}),this}sendAllSoundOff(n={}){return n.channels==null&&(n.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendAllSoundOff(n)}),this}sendAllNotesOff(n={}){return n.channels==null&&(n.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendAllNotesOff(n)}),this}sendResetAllControllers(n={},r={}){if(xe.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=ge.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendResetAllControllers(n)}),this}sendPolyphonicMode(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendPolyphonicMode(n,r)}),this}sendLocalControl(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendLocalControl(n,r)}),this}sendOmniMode(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendOmniMode(n,r)}),this}sendNrpnValue(n,r,i={}){return i.channels==null&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendNrpnValue(n,r,i)}),this}setNonRegisteredParameter(n,r=[],i="all",o={}){return xe.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),o.channels=i,o.channels==="all"&&(o.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(n,r,o)}sendRpnIncrement(n,r={}){return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnIncrement(n,r)}),this}incrementRegisteredParameter(n,r="all",i={}){return xe.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),i.channels=r,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(n,i)}sendRpnDecrement(n,r={}){return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnDecrement(n,r)}),this}decrementRegisteredParameter(n,r="all",i={}){return xe.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),i.channels=r,i.channels==="all"&&(i.channels=ge.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(n,i)}sendNoteOff(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendNoteOff(n,r)}),this}stopNote(n,r){return this.sendNoteOff(n,r)}playNote(n,r={},i={}){if(xe.validation&&(r.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),r.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].playNote(n,r)}),this}sendNoteOn(n,r={},i={}){if(xe.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=ge.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendNoteOn(n,r)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(n){if(this.validation&&(n=parseInt(n),isNaN(n)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=n}}class _0{constructor(n=[],r={}){this.destinations=[],this.types=[...Object.keys(ge.SYSTEM_MESSAGES),...Object.keys(ge.CHANNEL_MESSAGES)],this.channels=ge.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(n)||(n=[n]),r.types&&!Array.isArray(r.types)&&(r.types=[r.types]),r.channels&&!Array.isArray(r.channels)&&(r.channels=[r.channels]),xe.validation&&(n.forEach(i=>{if(!(i instanceof Uf))throw new TypeError("Destinations must be of type 'Output'.")}),r.types!==void 0&&r.types.forEach(i=>{if(!ge.SYSTEM_MESSAGES.hasOwnProperty(i)&&!ge.CHANNEL_MESSAGES.hasOwnProperty(i))throw new TypeError("Type must be a valid message type.")}),r.channels!==void 0&&r.channels.forEach(i=>{if(!ge.MIDI_CHANNEL_NUMBERS.includes(i))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=n,r.types&&(this.types=r.types),r.channels&&(this.channels=r.channels)}forward(n){this.suspended||this.types.includes(n.type)&&(n.channel&&!this.channels.includes(n.channel)||this.destinations.forEach(r=>{xe.validation&&!(r instanceof Uf)||r.send(n)}))}}class Sy extends Da{constructor(n,r){super(),this._input=n,this._number=r,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(n){const r=Object.assign({},n);r.port=this.input,r.target=this,r.type="midimessage",this.emit(r.type,r),this._parseEventForStandardMessages(r)}_parseEventForStandardMessages(n){const r=Object.assign({},n);r.type=r.message.type||"unknownmessage";const i=n.message.dataBytes[0],o=n.message.dataBytes[1];if(r.type==="noteoff"||r.type==="noteon"&&o===0)this.notesState[i]=!1,r.type="noteoff",r.note=new ki(Ce.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+xe.octaveOffset),{rawAttack:0,rawRelease:o}),r.value=Ce.from7bitToFloat(o),r.rawValue=o,r.velocity=r.note.release,r.rawVelocity=r.note.rawRelease;else if(r.type==="noteon")this.notesState[i]=!0,r.note=new ki(Ce.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+xe.octaveOffset),{rawAttack:o}),r.value=Ce.from7bitToFloat(o),r.rawValue=o,r.velocity=r.note.attack,r.rawVelocity=r.note.rawAttack;else if(r.type==="keyaftertouch")r.note=new ki(Ce.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+xe.octaveOffset)),r.value=Ce.from7bitToFloat(o),r.rawValue=o,r.identifier=r.note.identifier,r.key=r.note.number,r.rawKey=i;else if(r.type==="controlchange"){r.controller={number:i,name:ge.CONTROL_CHANGE_MESSAGES[i].name,description:ge.CONTROL_CHANGE_MESSAGES[i].description,position:ge.CONTROL_CHANGE_MESSAGES[i].position},r.subtype=r.controller.name||"controller"+i,r.value=Ce.from7bitToFloat(o),r.rawValue=o;const u=Object.assign({},r);u.type=`${r.type}-controller${i}`,delete u.subtype,this.emit(u.type,u);const f=Object.assign({},r);f.type=`${r.type}-`+ge.CONTROL_CHANGE_MESSAGES[i].name,delete f.subtype,f.type.indexOf("controller")!==0&&this.emit(f.type,f),r.message.dataBytes[0]>=120&&this._parseChannelModeMessage(r),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(r.message.dataBytes[0])&&this._parseEventForParameterNumber(r)}else r.type==="programchange"?(r.value=i,r.rawValue=r.value):r.type==="channelaftertouch"?(r.value=Ce.from7bitToFloat(i),r.rawValue=i):r.type==="pitchbend"?(r.value=((o<<7)+i-8192)/8192,r.rawValue=(o<<7)+i):r.type="unknownmessage";this.emit(r.type,r)}_parseChannelModeMessage(n){const r=Object.assign({},n);r.type=r.controller.name,r.type==="localcontrol"&&(r.value=r.message.data[2]===127,r.rawValue=r.message.data[2]),r.type==="omnimodeon"?(r.type="omnimode",r.value=!0,r.rawValue=r.message.data[2]):r.type==="omnimodeoff"&&(r.type="omnimode",r.value=!1,r.rawValue=r.message.data[2]),r.type==="monomodeon"?(r.type="monomode",r.value=!0,r.rawValue=r.message.data[2]):r.type==="polymodeon"&&(r.type="monomode",r.value=!1,r.rawValue=r.message.data[2]),this.emit(r.type,r)}_parseEventForParameterNumber(n){const r=n.message.dataBytes[0],i=n.message.dataBytes[1];r===99||r===101?(this._nrpnBuffer=[],this._rpnBuffer=[],r===99?this._nrpnBuffer=[n.message]:i!==127&&(this._rpnBuffer=[n.message])):r===98||r===100?r===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(n.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&i!==127?this._rpnBuffer.push(n.message):this._rpnBuffer=[]):(r===6||r===38||r===96||r===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],n):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],n):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(n){return n===6||n===38||n===96||n===97||n===98||n===99||n===100||n===101}_dispatchParameterNumberEvent(n,r,i,o){n=n==="nrpn"?"nrpn":"rpn";const u={target:o.target,timestamp:o.timestamp,message:o.message,parameterMsb:r,parameterLsb:i,value:Ce.from7bitToFloat(o.message.dataBytes[1]),rawValue:o.message.dataBytes[1]};n==="rpn"?u.parameter=Object.keys(ge.REGISTERED_PARAMETERS).find(p=>ge.REGISTERED_PARAMETERS[p][0]===r&&ge.REGISTERED_PARAMETERS[p][1]===i):u.parameter=(r<<7)+i;const f=ge.CONTROL_CHANGE_MESSAGES[o.message.dataBytes[0]].name;u.type=`${n}-${f}`,this.emit(u.type,u);const h=Object.assign({},u);h.type==="nrpn-dataincrement"?h.type="nrpn-databuttonincrement":h.type==="nrpn-datadecrement"?h.type="nrpn-databuttondecrement":h.type==="rpn-dataincrement"?h.type="rpn-databuttonincrement":h.type==="rpn-datadecrement"&&(h.type="rpn-databuttondecrement"),this.emit(h.type,h),u.type=n,u.subtype=f,this.emit(u.type,u)}getChannelModeByNumber(n){return xe.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),n=Math.floor(n)),Ce.getChannelModeByNumber(n)}getCcNameByNumber(n){if(xe.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),n=parseInt(n),!(n>=0&&n<=127)))throw new RangeError("Invalid control change number.");return Ce.getCcNameByNumber(n)}getNoteState(n){n instanceof ki&&(n=n.identifier);const r=Ce.guessNoteNumber(n,xe.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[r]}get octaveOffset(){return this._octaveOffset}set octaveOffset(n){if(this.validation&&(n=parseInt(n),isNaN(n)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=n}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(n){this.validation&&(n=!!n),this.parameterNumberEventsEnabled=n}}class Nm{constructor(n){this.rawData=n,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=Ce.getPropertyByValue(ge.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=Ce.getPropertyByValue(ge.SYSTEM_MESSAGES,this.command)),this.statusByte===ge.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}class Ey extends Da{constructor(n){super(),this._midiInput=n,this._octaveOffset=0,this.channels=[];for(let r=1;r<=16;r++)this.channels[r]=new Sy(this,r);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(n=>n.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(n){let r={timestamp:xe.time,target:this,port:this};n.port.connection==="open"?(r.type="opened",this.emit("opened",r)):n.port.connection==="closed"&&n.port.state==="connected"?(r.type="closed",this.emit("closed",r)):n.port.connection==="closed"&&n.port.state==="disconnected"?(r.type="disconnected",r.port={connection:n.port.connection,id:n.port.id,manufacturer:n.port.manufacturer,name:n.port.name,state:n.port.state,type:n.port.type},this.emit("disconnected",r)):n.port.connection==="pending"&&n.port.state==="disconnected"||console.warn("This statechange event was not caught: ",n.port.connection,n.port.state)}_onMidiMessage(n){const r=new Nm(n.data),i={port:this,target:this,message:r,timestamp:n.timeStamp,type:"midimessage",data:r.data,rawData:r.data,statusByte:r.data[0],dataBytes:r.dataBytes};this.emit("midimessage",i),r.isSystemMessage?this._parseEvent(i):r.isChannelMessage&&this.channels[r.channel]._processMidiMessageEvent(i),this._forwarders.forEach(o=>o.forward(r))}_parseEvent(n){const r=Object.assign({},n);r.type=r.message.type||"unknownmidimessage",r.type==="songselect"&&(r.song=n.data[1]+1,r.value=n.data[1],r.rawValue=r.value),this.emit(r.type,r)}async open(){try{await this._midiInput.open()}catch(n){return Promise.reject(n)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(n){return Promise.reject(n)}return Promise.resolve(this)}getChannelModeByNumber(){xe.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(n,r,i={}){if(xe.validation&&typeof i=="function"){let o=r!=null?[].concat(r):void 0;r=i,i={channels:o}}if(ge.CHANNEL_EVENTS.includes(n)){i.channels===void 0&&(i.channels=ge.MIDI_CHANNEL_NUMBERS);let o=[];return Ce.sanitizeChannels(i.channels).forEach(u=>{o.push(this.channels[u].addListener(n,r,i))}),o}else return super.addListener(n,r,i)}addOneTimeListener(n,r,i={}){return i.remaining=1,this.addListener(n,r,i)}on(n,r,i,o){return this.addListener(n,r,i,o)}hasListener(n,r,i={}){if(xe.validation&&typeof i=="function"){let o=[].concat(r);r=i,i={channels:o}}return ge.CHANNEL_EVENTS.includes(n)?(i.channels===void 0&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),Ce.sanitizeChannels(i.channels).every(o=>this.channels[o].hasListener(n,r))):super.hasListener(n,r)}removeListener(n,r,i={}){if(xe.validation&&typeof i=="function"){let o=[].concat(r);r=i,i={channels:o}}if(i.channels===void 0&&(i.channels=ge.MIDI_CHANNEL_NUMBERS),n==null)return Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o]&&this.channels[o].removeListener()}),super.removeListener();ge.CHANNEL_EVENTS.includes(n)?Ce.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].removeListener(n,r,i)}):super.removeListener(n,r,i)}addForwarder(n,r={}){let i;return n instanceof _0?i=n:i=new _0(n,r),this._forwarders.push(i),i}removeForwarder(n){this._forwarders=this._forwarders.filter(r=>r!==n)}hasForwarder(n){return this._forwarders.includes(n)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(n){if(this.validation&&(n=parseInt(n),isNaN(n)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=n}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return xe.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}class wy extends Da{constructor(){super(),this.defaults={note:{attack:Ce.from7bitToFloat(64),release:Ce.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(n={},r=!1){if(Ce.isNode)try{window.navigator}catch{let h=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,h)}if(this.validation=n.validation!==!1,this.validation&&(typeof n=="function"&&(n={callback:n,sysex:r}),r&&(n.sysex=!0)),this.enabled)return typeof n.callback=="function"&&n.callback(),Promise.resolve();const i={timestamp:this.time,target:this,type:"error",error:void 0},o={timestamp:this.time,target:this,type:"midiaccessgranted"},u={timestamp:this.time,target:this,type:"enabled"};try{typeof n.requestMIDIAccessFunction=="function"?this.interface=await n.requestMIDIAccessFunction({sysex:n.sysex,software:n.software}):this.interface=await navigator.requestMIDIAccess({sysex:n.sysex,software:n.software})}catch(f){return i.error=f,this.emit("error",i),typeof n.callback=="function"&&n.callback(f),Promise.reject(f)}this.emit("midiaccessgranted",o),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(f){return i.error=f,this.emit("error",i),typeof n.callback=="function"&&n.callback(f),Promise.reject(f)}return this.emit("enabled",u),typeof n.callback=="function"&&n.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let n={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",n),this.removeListener()})}getInputById(n,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!n)return}if(r.disconnected){for(let i=0;i<this._disconnectedInputs.length;i++)if(this._disconnectedInputs[i]._midiInput&&this._disconnectedInputs[i].id===n.toString())return this._disconnectedInputs[i]}else for(let i=0;i<this.inputs.length;i++)if(this.inputs[i]._midiInput&&this.inputs[i].id===n.toString())return this.inputs[i]}getInputByName(n,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!n)return;n=n.toString()}if(r.disconnected){for(let i=0;i<this._disconnectedInputs.length;i++)if(~this._disconnectedInputs[i].name.indexOf(n))return this._disconnectedInputs[i]}else for(let i=0;i<this.inputs.length;i++)if(~this.inputs[i].name.indexOf(n))return this.inputs[i]}getOutputByName(n,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!n)return;n=n.toString()}if(r.disconnected){for(let i=0;i<this._disconnectedOutputs.length;i++)if(~this._disconnectedOutputs[i].name.indexOf(n))return this._disconnectedOutputs[i]}else for(let i=0;i<this.outputs.length;i++)if(~this.outputs[i].name.indexOf(n))return this.outputs[i]}getOutputById(n,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!n)return}if(r.disconnected){for(let i=0;i<this._disconnectedOutputs.length;i++)if(this._disconnectedOutputs[i]._midiOutput&&this._disconnectedOutputs[i].id===n.toString())return this._disconnectedOutputs[i]}else for(let i=0;i<this.outputs.length;i++)if(this.outputs[i]._midiOutput&&this.outputs[i].id===n.toString())return this.outputs[i]}noteNameToNumber(n){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),Ce.toNoteNumber(n,this.octaveOffset)}getOctave(n){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),n=parseInt(n)),!isNaN(n)&&n>=0&&n<=127?Ce.getNoteDetails(Ce.offsetNumber(n,this.octaveOffset)).octave:!1}sanitizeChannels(n){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),Ce.sanitizeChannels(n)}toMIDIChannels(n){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),Ce.sanitizeChannels(n)}guessNoteNumber(n){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),Ce.guessNoteNumber(n,this.octaveOffset)}getValidNoteArray(n,r={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),Ce.buildNoteArray(n,r)}convertToTimestamp(n){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),Ce.toTimestamp(n)}async _destroyInputsAndOutputs(){let n=[];return this.inputs.forEach(r=>n.push(r.destroy())),this.outputs.forEach(r=>n.push(r.destroy())),Promise.all(n).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(n){this._updateInputsAndOutputs();let r={timestamp:n.timeStamp,type:n.port.state,target:this};if(n.port.state==="connected"&&n.port.connection==="open"){n.port.type==="output"?r.port=this.getOutputById(n.port.id):n.port.type==="input"&&(r.port=this.getInputById(n.port.id)),this.emit(n.port.state,r);const i=Object.assign({},r);i.type="portschanged",this.emit(i.type,i)}else if(n.port.state==="disconnected"&&n.port.connection==="pending"){n.port.type==="input"?r.port=this.getInputById(n.port.id,{disconnected:!0}):n.port.type==="output"&&(r.port=this.getOutputById(n.port.id,{disconnected:!0})),this.emit(n.port.state,r);const i=Object.assign({},r);i.type="portschanged",this.emit(i.type,i)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let r=this._inputs.length-1;r>=0;r--){const i=this._inputs[r];Array.from(this.interface.inputs.values()).find(u=>u===i._midiInput)||(this._disconnectedInputs.push(i),this._inputs.splice(r,1))}let n=[];return this.interface.inputs.forEach(r=>{if(!this._inputs.find(i=>i._midiInput===r)){let i=this._disconnectedInputs.find(o=>o._midiInput===r);i||(i=new Ey(r)),this._inputs.push(i),n.push(i.open())}}),Promise.all(n)}async _updateOutputs(){if(!this.interface)return;for(let r=this._outputs.length-1;r>=0;r--){const i=this._outputs[r];Array.from(this.interface.outputs.values()).find(u=>u===i._midiOutput)||(this._disconnectedOutputs.push(i),this._outputs.splice(r,1))}let n=[];return this.interface.outputs.forEach(r=>{if(!this._outputs.find(i=>i._midiOutput===r)){let i=this._disconnectedOutputs.find(o=>o._midiOutput===r);i||(i=new Uf(r)),this._outputs.push(i),n.push(i.open())}}),Promise.all(n)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),Ce.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),Ce.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(n){if(this.validation&&(n=parseInt(n),isNaN(n)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=n}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.14"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),ge.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),ge.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),ge.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),ge.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),ge.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const xe=new wy;xe.constructor=null;const Ay=async()=>{if(xe.enabled)return xe;try{return await xe.enable({sysex:!0}),console.log("WebMidi is enabled with SysEx support!"),xe}catch(a){throw console.error("WebMidi could not be enabled.",a),a}},k0=()=>xe.enabled?xe.inputs.map(a=>({id:a.id,name:a.name})):[],Ty=(a,n)=>{if(xe.enabled){const r=xe.getInputById(a);if(r){const i=f=>{n({type:"noteon",note:f.note.identifier,velocity:f.velocity,controller:null,channel:f.message.channel})},o=f=>{n({type:"noteoff",note:f.note.identifier,velocity:0,controller:null,channel:f.message.channel})},u=f=>{n({type:"controlchange",controller:f.controller.number,value:f.rawValue,note:null,channel:f.message.channel})};return r.addListener("noteon",i),r.addListener("noteoff",o),r.addListener("controlchange",u),()=>{r.removeListener("noteon",i),r.removeListener("noteoff",o),r.removeListener("controlchange",u)}}}return()=>{}},Cy=a=>{if(xe.enabled){const n=r=>{a(r)};return xe.addListener("connected",n),xe.addListener("disconnected",n),()=>{xe.removeListener("connected",n),xe.removeListener("disconnected",n)}}return()=>{}},My=(a,n)=>{if(xe.enabled){const r=xe.getInputById(a);if(r){const i=xe.outputs.find(o=>o.name===r.name);i?(i.sendSysex(71,n),console.log(`Sent SysEx to ${i.name}`)):console.warn("Could not find matching MIDI Output for SysEx")}}},pc=(a,n,r,i)=>{if(xe.enabled){const o=xe.getInputById(a);if(o){const u=xe.outputs.find(f=>f.name===o.name);u&&u.sendNoteOn(n,{attack:r/127,channels:i})}}},Rm=T.createContext(null),wc=()=>T.useContext(Rm),Ny=({children:a,onMidiCommand:n})=>{const[r,i]=T.useState(!1),[o,u]=T.useState([]),[f,h]=T.useState(""),[p,v]=T.useState(!1),[y,S]=T.useState(null),[b,x]=T.useState({}),[E,A]=T.useState(null),[D,F]=T.useState(!1),R=T.useRef(!1),N=T.useRef(n);T.useEffect(()=>{N.current=n},[n]),T.useEffect(()=>{(async()=>{try{if(await Ay(),i(!0),u(k0()),Cy(()=>{console.log("MIDI Device change detected, refreshing inputs..."),u(k0())}),window.electronAPI&&window.electronAPI.getMidiMappings){const L=await window.electronAPI.getMidiMappings();L&&(console.log("Loaded saved MIDI mappings:",L),x(L))}}catch(L){console.error("MIDI Init Failed:",L)}})()},[]),T.useEffect(()=>{(async()=>{if(!r||o.length===0)return;let L=f;if(!L&&window.electronAPI?.getSelectedMidiInput){const z=await window.electronAPI.getSelectedMidiInput();z&&o.some(ne=>ne.id===z)&&(L=z)}(!L||!o.some(z=>z.id===L))&&(L=o[0].id),L!==f&&(console.log(`MIDI: Auto-selecting input: ${L}`),h(L))})()},[r,o,f]);const _=async()=>{window.electronAPI&&window.electronAPI.saveMidiMappings&&(await window.electronAPI.saveMidiMappings(b),console.log("MIDI mappings saved to default."))},M=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(b,"midi")},j=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const Q=await window.electronAPI.importMappings("midi");Q.success&&Q.mappings&&(x(Q.mappings),console.log("MIDI mappings imported."))}},B=Q=>{const L=o.find(z=>z.id===Q);L&&L.name.toLowerCase().includes("apc40")&&(console.log("Detected APC40, sending initialization SysEx..."),My(Q,[127,41,96,0,4,65,1,1,1]))};T.useEffect(()=>{f&&window.electronAPI&&window.electronAPI.saveSelectedMidiInput&&window.electronAPI.saveSelectedMidiInput(f),f&&r&&B(f)},[f,r,o]);const H=T.useCallback((Q,L,z=null)=>{if(!f||!r)return;const ne=b[Q];if(ne&&ne.type==="note"){let fe=0;typeof L=="number"?fe=L:fe=L?127:0;const U=z!==null?z:ne.channel;pc(f,ne.address,fe,U)}},[f,r,b]);T.useEffect(()=>{let Q=()=>{};return f&&(console.log(`(Re)binding MIDI listener for: ${f}`),Q=Ty(f,L=>{K.current&&A(L),J(L)})),Q},[f,p,y,b,o]);const K=T.useRef(p);T.useEffect(()=>{K.current=p},[p]);const J=Q=>{if(Q.channel===1&&Q.note==="D7"){const z=Q.type==="noteon";F(z),R.current=z,console.log(`Shift ${z?"Down":"Up"}`);return}if(p&&y){if(Q.type==="noteoff")return;const z=Q.note||Q.controller,ne=R.current,fe={type:Q.type==="noteon"||Q.type==="noteoff"?"note":"cc",channel:Q.channel,address:z,requiresShift:ne,label:`${ne?"":""}CH${Q.channel}:${z}`};console.log(`Mapped ${y} to:`,fe),x(U=>({...U,[y]:fe})),S(null);return}Object.entries(b).forEach(([z,ne])=>{const fe=(Q.type==="noteon"||Q.type==="noteoff")&&ne.type==="note"&&Q.note===ne.address&&Q.channel===ne.channel,U=Q.type==="controlchange"&&ne.type==="cc"&&Q.controller===ne.address&&Q.channel===ne.channel,Z=ne.type==="cc"||!!ne.requiresShift===R.current;if((fe||U)&&Z&&N.current){let ue;Q.type==="controlchange"?ue=Q.value??0:Q.type==="noteoff"?ue=0:ue=Q.velocity??0,N.current(z,ue,127,Q.type)}})},Y={midiInitialized:r,midiInputs:o,selectedMidiInputId:f,setSelectedMidiInputId:h,isMapping:p,startMapping:()=>v(!0),stopMapping:()=>{v(!1),S(null)},learningId:y,setLearningId:S,mappings:b,setMappings:x,removeMapping:Q=>{x(L=>{const z={...L};return delete z[Q],z})},saveMappings:_,exportMappings:M,importMappings:j,initializeApc40:B,sendFeedback:H,lastMidiEvent:E,isShiftDown:D};return g.jsx(Rm.Provider,{value:Y,children:a})},Dm=T.createContext(null),$f=()=>T.useContext(Dm),Ry=({children:a,onArtnetCommand:n})=>{const[r,i]=T.useState(!1),[o,u]=T.useState(!1),[f,h]=T.useState(null),[p,v]=T.useState({}),[y,S]=T.useState(null),b=T.useRef(n);T.useEffect(()=>{b.current=n},[n]),T.useEffect(()=>{(async()=>{try{if(window.electronAPI&&window.electronAPI.initializeArtnet&&(await window.electronAPI.initializeArtnet()).success&&(i(!0),console.log("Art-Net initialized for mapping")),window.electronAPI&&window.electronAPI.getArtnetMappings){const j=await window.electronAPI.getArtnetMappings();j&&(console.log("Loaded saved Art-Net mappings:",j),v(j))}}catch(j){console.error("Art-Net Init Failed:",j)}})()},[]);const x=async()=>{window.electronAPI&&window.electronAPI.saveArtnetMappings&&(await window.electronAPI.saveArtnetMappings(p),console.log("Art-Net mappings saved."))},E=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(p,"artnet")},A=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const M=await window.electronAPI.importMappings("artnet");M.success&&M.mappings&&(v(M.mappings),console.log("Art-Net mappings imported."))}};T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onArtnetDataReceived)return window.electronAPI.onArtnetDataReceived(j=>{D.current&&S(j),F(j)})},[o,f,p]);const D=T.useRef(o);T.useEffect(()=>{D.current=o},[o]);const F=M=>{const{universe:j,channel:B,value:H}=M;if(o&&f){if(H===0)return;const K={universe:j,channel:B,label:`U${j}:CH${B+1}`};console.log(`Mapped ${f} to Art-Net:`,K),v(J=>({...J,[f]:K})),h(null);return}Object.entries(p).forEach(([K,J])=>{J.universe===j&&J.channel===B&&b.current&&b.current(K,H)})},_={artnetInitialized:r,isMapping:o,startMapping:()=>u(!0),stopMapping:()=>{u(!1),h(null)},learningId:f,setLearningId:h,mappings:p,setMappings:v,saveMappings:x,exportMappings:E,importMappings:A,lastDmxEvent:y};return g.jsx(Dm.Provider,{value:_,children:a})},_m=T.createContext(null),Wf=()=>T.useContext(_m),Dy=({children:a,onCommand:n,enabled:r=!1})=>{const[i,o]=T.useState(!1),[u,f]=T.useState(null),[h,p]=T.useState({}),v=T.useRef(n);T.useEffect(()=>{v.current=n},[n]),T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getKeyboardMappings){const A=await window.electronAPI.getKeyboardMappings();A&&p(A)}})()},[]);const y=async()=>{window.electronAPI&&window.electronAPI.saveKeyboardMappings&&await window.electronAPI.saveKeyboardMappings(h)},S=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(h,"keyboard")},b=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const E=await window.electronAPI.importMappings("keyboard");E.success&&E.mappings&&p(E.mappings)}};T.useEffect(()=>{const E=A=>{if(r&&!(A.target.tagName==="INPUT"||A.target.tagName==="TEXTAREA"||A.target.isContentEditable)){if(i&&u){A.preventDefault();const D={key:A.code,label:A.code.replace("Key","").replace("Digit","")};p(F=>({...F,[u]:D})),f(null);return}Object.entries(h).forEach(([D,F])=>{A.code===F.key&&(A.preventDefault(),v.current&&v.current(D,1,1,"keydown"))})}};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[r,i,u,h]);const x={isMapping:i,startMapping:()=>o(!0),stopMapping:()=>{o(!1),f(null)},learningId:u,setLearningId:f,mappings:h,setMappings:p,saveMappings:y,exportMappings:S,importMappings:b,removeMapping:E=>p(A=>{const D={...A};return delete D[E],D})};return g.jsx(_m.Provider,{value:x,children:a})},Lt=({id:a,children:n})=>{const{isMapping:r,setLearningId:i,removeMapping:o}=wc(),{isMapping:u,setLearningId:f,removeMapping:h}=$f()||{},{isMapping:p,setLearningId:v,removeMapping:y}=Wf()||{},S=r||u||p,b=A=>{S&&(A.preventDefault(),A.stopPropagation(),r&&i(a),u&&f(a),p&&v(a))},x=A=>{S&&(A.preventDefault(),A.stopPropagation(),r&&o(a),u&&h(a),p&&y(a))},E=Gn.Children.only(n);return Gn.cloneElement(E,{"data-mappable-id":a,onClickCapture:S?b:E.props.onClickCapture,onContextMenu:S?x:E.props.onContextMenu,className:`${E.props.className||""} ${S?"mappable-target":""}`.trim()})},_y=({masterIntensity:a,onMasterIntensityChange:n})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_intensity",targetType:"global",label:"MASTER",min:0,max:1,step:.01}))};return g.jsx("div",{className:"master-intensity-slider",draggable:!0,onDragStart:r,children:g.jsx(Lt,{id:"master_intensity",children:g.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:a,className:"slider_hor",id:"masterIntensityRange",onChange:i=>n(parseFloat(i.target.value))})})})},ky=({masterIntensity:a,onMasterIntensityChange:n,onClearAllActive:r,isGlobalBlackout:i,onToggleGlobalBlackout:o})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"global",label:h.toUpperCase()}))};return g.jsxs("div",{className:"composition-controls",children:[g.jsx("span",{className:"layer-control-button",children:"Comp"}),g.jsx(Lt,{id:"comp_clear",children:g.jsx("span",{className:"layer-control-button",onClick:r,style:{cursor:"pointer"},draggable:!0,onDragStart:f=>u(f,"clear"),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),g.jsx(Lt,{id:"comp_blackout",style:{width:"100%",display:"flex"},children:g.jsx("span",{className:"layer-control-button",onClick:o,style:{cursor:"pointer",backgroundColor:i?"red":""},draggable:!0,onDragStart:f=>u(f,"blackout"),children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),g.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),g.jsx(_y,{masterIntensity:a,onMasterIntensityChange:n})]})},Oy=({name:a,index:n,onTrigger:r,onShowColumnHeaderContextMenu:i})=>{const o=f=>{f.preventDefault(),i&&i(n)},u=f=>{f.button===0&&r&&r()};return g.jsx(Lt,{id:`column_${n}`,children:g.jsx("div",{className:"column-header trigger-button",onClick:u,onContextMenu:o,style:{cursor:"pointer"},children:a})})},Li=[{id:"rotate",name:"Rotate",type:"transform",description:"Rotates the shape around its center.",defaultParams:{angle:0,speed:0,direction:"CW"},paramControls:[{id:"angle",label:"Angle",type:"range",min:0,max:360,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["CW","CCW"]}]},{id:"scale",name:"Scale",type:"transform",description:"Scales the shape.",defaultParams:{scaleX:1,scaleY:1},paramControls:[{id:"scaleX",label:"Scale X",type:"range",min:.01,max:5,step:.01},{id:"scaleY",label:"Scale Y",type:"range",min:.01,max:5,step:.01}]},{id:"translate",name:"Translate",type:"transform",description:"Moves the shape.",defaultParams:{translateX:0,translateY:0},paramControls:[{id:"translateX",label:"Translate X",type:"range",min:-1,max:1,step:.01},{id:"translateY",label:"Translate Y",type:"range",min:-1,max:1,step:.01}]},{id:"color",name:"Color",type:"color",description:"Changes the color of the shape with solid, rainbow or custom palette modes.",defaultParams:{mode:"solid",color:"#ffffff",r:255,g:255,b:255,cycleSpeed:0,rainbowSpread:1,rainbowOffset:0,rainbowPalette:"rainbow",paletteColors:["#ff0000","#00ff00","#0000ff","#ffff00"],paletteSize:4,paletteSpread:1,hue:0,saturation:0,brightness:1,enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["solid","rainbow","palette"]},{id:"color",label:"Color",type:"color",showIf:{mode:"solid"}},{id:"hue",label:"Hue",type:"range",min:0,max:1,step:.001,showIf:{mode:"hsv_advanced"}},{id:"saturation",label:"Saturation",type:"range",min:0,max:1,step:.001,showIf:{mode:"hsv_advanced"}},{id:"brightness",label:"Brightness",type:"range",min:0,max:1,step:.001,showIf:{mode:"hsv_advanced"}},{id:"paletteSize",label:"Palette Size",type:"range",min:2,max:16,step:1,showIf:{mode:"palette"}},{id:"paletteSpread",label:"Spread",type:"range",min:.1,max:10,step:.1,showIf:{mode:"palette"}},{id:"cycleSpeed",label:"Cycle Speed",type:"range",min:0,max:10,step:.1,showIf:{mode:["rainbow","palette"]}},{id:"rainbowSpread",label:"Rainbow Spread",type:"range",min:.1,max:10,step:.1,showIf:{mode:"rainbow"}},{id:"rainbowOffset",label:"Offset",type:"range",min:0,max:360,step:1,showIf:{mode:["rainbow","palette"]}},{id:"rainbowPalette",label:"Preset",type:"select",options:["rainbow","fire","ice","cyber"],showIf:{mode:"rainbow"}}]},{id:"wave",name:"Wave",type:"animation",description:"Applies a wave distortion to the shape.",defaultParams:{amplitude:.1,frequency:10,speed:1,direction:"x"},paramControls:[{id:"amplitude",label:"Amplitude",type:"range",min:.01,max:1,step:.01},{id:"frequency",label:"Frequency",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["x","y"]}]},{id:"warp",name:"Warp",type:"animation",description:"Symmetrical chaotic wave distortion.",defaultParams:{amount:.1,chaos:.5,speed:1},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"chaos",label:"Chaos",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1}]},{id:"distortion",name:"Distortion",type:"transform",description:"Distorts the point data.",defaultParams:{amount:.1,scale:10,speed:.5},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"scale",label:"Scale",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:5,step:.1}]},{id:"move",name:"Move (Bounce)",type:"transform",description:"Moves points and bounces them off the borders.",defaultParams:{speedX:.1,speedY:.1},paramControls:[{id:"speedX",label:"Speed X",type:"range",min:0,max:2,step:.01},{id:"speedY",label:"Speed Y",type:"range",min:0,max:2,step:.01}]},{id:"delay",name:"Delay",type:"effect",description:"Frame or Channel based delay effect.",defaultParams:{mode:"frame",playstyle:"repeat",useCustomOrder:!1,delayDirection:"left_to_right",delayAmount:5,decay:.8,steps:10,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat"]},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"delayDirection",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}},{id:"steps",label:"Steps",type:"range",min:2,max:20,step:1,showIf:{mode:"frame"}},{id:"delayAmount",label:"Delay Time",type:"range",min:1,max:60,step:1},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01}]},{id:"chase",name:"Chase",type:"effect",description:"Frame or Channel based chase effect.",defaultParams:{mode:"frame",playstyle:"repeat",steps:4,decay:.8,speed:1,overlap:1,direction:"left_to_right",useCustomOrder:!1,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat","bounce"]},{id:"steps",label:"Steps",type:"range",min:2,max:16,step:1,showIf:{mode:"frame"}},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:5,step:.1},{id:"overlap",label:"Overlap",type:"range",min:1,max:4,step:1},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"direction",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}}]},{id:"blanking",name:"Blanking",type:"animation",description:"Controls the blanking of the laser output.",defaultParams:{blankingInterval:0,spacing:0},paramControls:[{id:"blankingInterval",label:"Blanking Interval",type:"range",min:0,max:10,step:1},{id:"spacing",label:"Spacing",type:"range",min:0,max:20,step:1}]},{id:"strobe",name:"Strobe",type:"animation",description:"Applies a strobe effect to the laser output.",defaultParams:{strobeSpeed:100,strobeAmount:.5},paramControls:[{id:"strobeSpeed",label:"Strobe Speed (ms)",type:"range",min:10,max:1e3,step:10},{id:"strobeAmount",label:"Strobe Amount (0-1)",type:"range",min:0,max:1,step:.01}]},{id:"mirror",name:"Mirror",type:"transform",description:"Mirrors the shape from the center.",defaultParams:{mode:"none"},paramControls:[{id:"mode",label:"Mirror Mode",type:"select",options:["none","x+","x-","y+","y-"]}]}],Ly=Li.reduce((a,n)=>(a[n.id]=n,a),{});function O0(a,n,r,i){const o=n.style||"loop",u=n.direction||"forward";if(u==="pause")return r;let f=a;o==="bounce"&&(f*=2);let h=0;if(o==="once")h=Math.min(f,1),u==="backward"&&(h=1-h);else if(o==="bounce"){let p=f%1;Math.floor(f)%2===1?h=1-p:h=p,u==="backward"&&(h=1-h)}else h=f%1,u==="backward"&&(h=1-h);return i&&Array.isArray(i)&&i.length===2?i[0]+(i[1]-i[0])*h:r}function gc(a,n,r,i,o,u){if(!r)return n;const f=typeof r=="string"?{syncMode:r}:r;if(!f.syncMode)return n;const{time:h,progress:p=0,bpm:v=120,clipDuration:y=0,fftLevels:S={low:0,mid:0,high:0},activationTime:b=0}=i;let x=f.range;(!x||!Array.isArray(x)||x.length!==2)&&o!==void 0&&u!==void 0&&(x=[o,u]);let E=0;const A=f.speedMultiplier||1;if((f.style||"loop")==="once"&&b>0){const F=(h-b)*.001;let R=1;if(f.syncMode==="timeline")R=Math.max(.01,f.duration||1);else if(f.syncMode==="bpm"){const N=Math.max(.1,f.beats||4),_=v/60;R=N/(_||2)}else if(f.syncMode==="fps")return E=F*A,O0(E,f,n,x);E=F/R*A}else if(f.syncMode==="fps")E=h*.001*A;else if(f.syncMode==="timeline"){const F=Math.max(.01,f.duration||1);y>0?E=p*y/F*A:E=0}else if(f.syncMode==="bpm"){const F=Math.max(.1,f.beats||4),R=v/60,N=F/(R||2);y>0?E=p*y/N*A:E=0}else if(f.syncMode==="fft"){const F=S[f.fftRange||"low"]||0;return x?x[0]+(x[1]-x[0])*F:n}return O0(E,f,n,x)}let If=new Float32Array(1024*8);function Uy(a){If.length<a*8&&(If=new Float32Array(a*8*2))}function Fl(a,n,r={}){const{progress:i=0,time:o=performance.now(),effectStates:u,syncSettings:f={},fftLevels:h}=r;if(!n||n.length===0)return a;const p=a.points,v=a.isTypedArray||p instanceof Float32Array,y=v?p.length/8:p.length;Uy(y);const S=If.subarray(0,y*8);if(v)S.set(p);else for(let E=0;E<y;E++){const A=p[E],D=E*8;S[D]=A.x,S[D+1]=A.y,S[D+2]=A.z||0,S[D+3]=A.r,S[D+4]=A.g,S[D+5]=A.b,S[D+6]=A.blanking?1:0,S[D+7]=A.lastPoint?1:0}let b=S;for(const E of n){const A=E.params;if(A.enabled===!1||!Ly[E.id])continue;const F=b.length/8;let R=A;const N=E.instanceId?`${E.instanceId}.`:`${E.id}.`;let _=!1;for(const M in A)if(f[N+M]){_=!0;break}if(_){R={...A};for(const M in R){const j=N+M;f[j]&&(R[M]=gc(M,R[M],f[j],r))}}switch(E.id){case"rotate":Iy(b,F,R,i,o);break;case"scale":By(b,F,R);break;case"translate":Fy(b,F,R);break;case"color":Py(b,F,R,o);break;case"wave":zy(b,F,R,o);break;case"blanking":Hy(b,F,R);break;case"strobe":Yy(b,F,R,o);break;case"mirror":b=qy(b,F,R);break;case"warp":Vy(b,F,R,o);break;case"distortion":Xy(b,F,R,o);break;case"move":Qy(b,F,R,o);break;case"delay":u&&E.instanceId&&(b=Zy(b,F,R,u,E.instanceId,r));break;case"chase":b=$y(b,F,R,o,r);break}}const x=new Float32Array(b);return b._channelDistributions&&(x._channelDistributions=b._channelDistributions),{...a,points:x,isTypedArray:!0}}function Iy(a,n,r,i,o){const{angle:u,speed:f,direction:h}=r,p=h==="CCW"?-1:1,v=o*.001*f*p,y=u*Math.PI/180+v,S=Math.sin(y),b=Math.cos(y);for(let x=0;x<n;x++){const E=x*8,A=a[E],D=a[E+1];a[E]=A*b-D*S,a[E+1]=A*S+D*b}}function By(a,n,r){const{scaleX:i,scaleY:o}=r;for(let u=0;u<n;u++){const f=u*8;a[f]*=i,a[f+1]*=o}}function Fy(a,n,r){const{translateX:i,translateY:o}=r;for(let u=0;u<n;u++){const f=u*8;a[f]+=i,a[f+1]+=o}}function L0(a){if(!a)return{r:255,g:255,b:255};const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:{r:255,g:255,b:255}}function jy(a,n,r){let i,o,u;const f=Math.floor(a*6),h=a*6-f,p=r*(1-n),v=r*(1-h*n),y=r*(1-(1-h)*n);switch(f%6){case 0:i=r,o=y,u=p;break;case 1:i=v,o=r,u=p;break;case 2:i=p,o=r,u=y;break;case 3:i=p,o=v,u=r;break;case 4:i=y,o=p,u=r;break;case 5:i=r,o=p,u=v;break}return[Math.round(i*255),Math.round(o*255),Math.round(u*255)]}function Py(a,n,r,i){const{mode:o,r:u,g:f,b:h,color:p,hue:v,saturation:y,brightness:S,cycleSpeed:b,rainbowSpread:x,rainbowOffset:E,rainbowPalette:A,paletteColors:D=[],paletteSize:F=4,paletteSpread:R=1}=r,N=i*.001*b;if(o==="palette"){const _=Math.min(D.length,F),M=D.slice(0,_).map(L0);M.length===0&&M.push({r:255,g:255,b:255});for(let j=0;j<n;j++){const B=j*8,K=(j/n*R+N*.5+E/360)%1*M.length,J=Math.floor(K)%M.length,G=(J+1)%M.length,V=K-Math.floor(K),X=M[J],Y=M[G];a[B+3]=Math.round(X.r+(Y.r-X.r)*V),a[B+4]=Math.round(X.g+(Y.g-X.g)*V),a[B+5]=Math.round(X.b+(Y.b-X.b)*V)}}else if(o==="rainbow"){const _=A||"rainbow";for(let M=0;M<n;M++){const j=M*8,B=(M/n*x+N*.5+E/360)%1;let H,K,J;_==="rainbow"?[H,K,J]=U0(B,1,.5):[H,K,J]=Gy(_,B),a[j+3]=H,a[j+4]=K,a[j+5]=J}}else{let _=u,M=f,j=h;if(v!==void 0&&y!==void 0&&S!==void 0)[_,M,j]=jy(v,y,S);else if(p){const B=L0(p);_=B.r,M=B.g,j=B.b}if(b>0){const B=N*50%360,[H,K,J]=U0(B/360,1,.5);for(let G=0;G<n;G++){const V=G*8;a[V+3]=H,a[V+4]=K,a[V+5]=J}}else for(let B=0;B<n;B++){const H=B*8;a[H+3]=_,a[H+4]=M,a[H+5]=j}}}function Gy(a,n){const r={fire:[{r:255,g:0,b:0},{r:255,g:128,b:0},{r:255,g:255,b:0},{r:255,g:0,b:0}],ice:[{r:0,g:0,b:255},{r:0,g:255,b:255},{r:255,g:255,b:255},{r:0,g:0,b:255}],cyber:[{r:255,g:0,b:255},{r:0,g:255,b:255},{r:0,g:0,b:255},{r:255,g:0,b:255}]},i=r[a]||r.fire,o=n*(i.length-1),u=Math.floor(o),f=o-u,h=i[u],p=i[u+1]||i[u];return[Math.round(h.r+(p.r-h.r)*f),Math.round(h.g+(p.g-h.g)*f),Math.round(h.b+(p.b-h.b)*f)]}function U0(a,n,r){let i,o,u;{const f=(v,y,S)=>(S<0&&(S+=1),S>1&&(S-=1),S<.16666666666666666?v+(y-v)*6*S:S<.5?y:S<.6666666666666666?v+(y-v)*(.6666666666666666-S)*6:v),h=r+n-r*n,p=2*r-h;i=f(p,h,a+1/3),o=f(p,h,a),u=f(p,h,a-1/3)}return[Math.round(i*255),Math.round(o*255),Math.round(u*255)]}function zy(a,n,r,i){const{amplitude:o,frequency:u,speed:f,direction:h}=r,p=i*.001*f;for(let v=0;v<n;v++){const y=v*8;h==="x"?a[y+1]+=o*Math.sin(a[y]*u+p):h==="y"&&(a[y]+=o*Math.sin(a[y+1]*u+p))}}function Hy(a,n,r){const{blankingInterval:i,spacing:o=0}=r;if(i<=0)return;const u=i+1+o;for(let f=0;f<n;f++)f%u>=i&&(a[f*8+6]=1)}function Yy(a,n,r,i){const{strobeSpeed:o,strobeAmount:u}=r;if(i%o/o<u)for(let h=0;h<n;h++)a[h*8+6]=1}function qy(a,n,r){const{mode:i}=r;if(i==="none"||n===0)return a;let o;const u=a._channelDistributions;if(u){o=new Float32Array((n*2+u.size)*8);const f=new Map;let h=0;for(const[p,v]of u){const y=v.length/8,S=v.start,b=h;o.set(a.subarray(S,S+v.length),h),h+=v.length;const x=S+v.length-8;o.set(a.subarray(x,x+8),h),o[h+6]=1,o[h+3]=0,o[h+4]=0,o[h+5]=0,h+=8;for(let E=0;E<y;E++){const A=S+E*8,D=h;o.set(a.subarray(A,A+8),D),i==="x-"||i==="x+"?o[D]=-o[D]:(i==="y-"||i==="y+")&&(o[D+1]=-o[D+1]),h+=8}f.set(p,{start:b,length:(y*2+1)*8})}o._channelDistributions=f}else{o=new Float32Array((n*2+1)*8),o.set(a.subarray(0,n*8),0);const f=n*8,h=(n-1)*8;o.set(a.subarray(h,h+8),f),o[f+6]=1,o[f+3]=0,o[f+4]=0,o[f+5]=0;for(let p=0;p<n;p++){const v=p*8,y=(n+1+p)*8;o.set(a.subarray(v,v+8),y),i==="x-"||i==="x+"?o[y]=-o[y]:(i==="y-"||i==="y+")&&(o[y+1]=-o[y+1])}}return o}function Vy(a,n,r,i){const{amount:o,chaos:u,speed:f}=r,h=i*.001*f;for(let p=0;p<n;p++){const v=p*8,y=a[v],S=a[v+1],b=Math.abs(S);a[v]+=Math.sin(b*10*(1+u)+h)*o*Math.cos(h*u),a[v+1]+=Math.cos(Math.abs(y)*10*(1+u)+h)*o*Math.sin(h*u)}}function Xy(a,n,r,i){const{amount:o,scale:u,speed:f}=r,h=i*.001*f;for(let p=0;p<n;p++){const v=p*8,y=Math.sin(a[v]*u+h)*Math.cos(a[v+1]*u-h),S=Math.cos(a[v]*u-h)*Math.sin(a[v+1]*u+h);a[v]+=y*o,a[v+1]+=S*o}}function Qy(a,n,r,i){const{speedX:o,speedY:u}=r,f=i*.001,h=f*o,p=f*u,v=4;for(let y=0;y<n;y++){const S=y*8;let b=a[S]+h,x=a[S+1]+p,E=(b+1)%v;E<0&&(E+=v),E>2&&(E=4-E),b=E-1;let A=(x+1)%v;A<0&&(A+=v),A>2&&(A=4-A),x=A-1,a[S]=b,a[S+1]=x}}function Zy(a,n,r,i,o,u){const{mode:f="frame",delayAmount:h,decay:p,delayDirection:v,useCustomOrder:y,customOrder:S,playstyle:b="repeat",steps:x=10}=r;i.has(o)||i.set(o,[]);const E=i.get(o);if(E.unshift(new Float32Array(a)),f==="frame"){const A=h*x+1;E.length>A&&(E.length=A);const D=new Float32Array(a.length);for(let F=0;F<n;F++){let R=0;const N=F/n;v==="left_to_right"?R=Math.floor(N*(x-1)):v==="right_to_left"?R=Math.floor((1-N)*(x-1)):v==="center_to_out"?R=Math.floor(Math.abs(N-.5)*2*(x-1)):v==="out_to_center"&&(R=Math.floor((1-Math.abs(N-.5)*2)*(x-1)));const _=R*h,M=_<E.length?E[_]:null,j=Math.pow(p,R),B=F*8;if(M&&M.length>0){let H;if(M.length===a.length)H=B;else{const K=M.length/8;let J=Math.floor(N*K);J>=K&&(J=K-1),H=J*8}if(D[B]=M[H],D[B+1]=M[H+1],D[B+2]=M[H+2],D[B+3]=M[H+3]*j,D[B+4]=M[H+4]*j,D[B+5]=M[H+5]*j,D[B+6]=M[H+6],D[B+7]=M[H+7],F<n-1){const K=(F+1)/n;let J=0;v==="left_to_right"?J=Math.floor(K*(x-1)):v==="right_to_left"?J=Math.floor((1-K)*(x-1)):v==="center_to_out"?J=Math.floor(Math.abs(K-.5)*2*(x-1)):v==="out_to_center"&&(J=Math.floor((1-Math.abs(K-.5)*2)*(x-1))),J!==R&&(D[B+6]=1)}}else D.set(a.subarray(B,B+8),B),D[B+3]=0,D[B+4]=0,D[B+5]=0,D[B+6]=1}return a._channelDistributions&&(D._channelDistributions=a._channelDistributions),D}else{const{assignedDacs:A}=u||{};let D=new Map,F=0;if(y||r.delayMode==="channel")(S&&S.length>0?S.map(V=>V.originalIndex):A?A.map((V,X)=>X):[0]).forEach((V,X)=>{D.set(V,X),F=Math.max(F,X)});else{const V=(A||[]).length||1;for(let X=0;X<V;X++){let Y=X;v==="right_to_left"?Y=V-1-X:v==="center_to_out"?Y=Math.floor(Math.abs(X-(V-1)/2)):v==="out_to_center"&&(Y=Math.min(X,V-1-X)),D.set(X,Y),F=Math.max(F,Y)}}const N=F+1,_=h*N+1;E.length>_&&(E.length=_);const M=[];for(let G=0;G<N;G++){const V=G*h;M.push({points:V<E.length?E[V]:null,factor:Math.pow(p,G),index:G})}const j=M.reduce((G,V)=>G+(V.points?V.points.length/8:a.length/8),0),B=new Float32Array(j*8);let H=0;const K=new Array(M.length);for(let G=0;G<M.length;G++){const V=M[G],X=V.points,Y=X?X.length/8:a.length/8;K[G]=H;for(let Q=0;Q<Y;Q++){const L=Q*8,z=H+Q*8;X?(B[z]=X[L],B[z+1]=X[L+1],B[z+2]=X[L+2],B[z+3]=X[L+3]*V.factor,B[z+4]=X[L+4]*V.factor,B[z+5]=X[L+5]*V.factor,B[z+6]=X[L+6],B[z+7]=X[L+7]):B[z+6]=1}H+=Y*8}const J=new Map;return D.forEach((G,V)=>{G<M.length&&J.set(V,{start:K[G],length:M[G].points?M[G].points.length:a.length})}),B._channelDistributions=J,B}}function $y(a,n,r,i,o={}){const{mode:u="frame",steps:f,decay:h,speed:p,overlap:v,direction:y,useCustomOrder:S,customOrder:b,playstyle:x="loop"}=r,{progress:E=0,clipDuration:A=1,syncSettings:D={}}=o,F=r.instanceId?`${r.instanceId}.`:"chase.",R=!!D[F+"speed"],N=E!==void 0&&A>0||R;if(u==="frame"){const _=f;let M=(N?E*_:i*.001)*p;if(x==="bounce"){const B=_,H=M%(B*2);M=H>B?B*2-H:H}else x==="once"?M=Math.min(M,_):M=M%_;const j=new Float32Array(a.length);for(let B=0;B<n;B++){const H=B/n;let K=0;y==="left_to_right"?K=Math.min(_-1,Math.floor(H*_)):y==="right_to_left"?K=Math.min(_-1,Math.floor((1-H)*_)):y==="center_to_out"?K=Math.min(_-1,Math.floor(Math.abs(H-.5)*2*_)):y==="out_to_center"&&(K=Math.min(_-1,Math.floor((1-Math.abs(H-.5)*2)*_)));let J=Math.abs(M-K);J>_/2&&(J=_-J);let G=J<v?1-J/v:0;h>0&&(G=Math.pow(G,1-h));const V=B*8;if(j.set(a.subarray(V,V+8),V),j[V+3]*=G,j[V+4]*=G,j[V+5]*=G,G<.05&&(j[V+6]=1),B<n-1){const X=(B+1)/n;let Y=0;y==="left_to_right"?Y=Math.min(_-1,Math.floor(X*_)):y==="right_to_left"?Y=Math.min(_-1,Math.floor((1-X)*_)):y==="center_to_out"?Y=Math.min(_-1,Math.floor(Math.abs(X-.5)*2*_)):y==="out_to_center"&&(Y=Math.min(_-1,Math.floor((1-Math.abs(X-.5)*2)*_))),Y!==K&&(j[V+6]=1)}}return a._channelDistributions&&(j._channelDistributions=a._channelDistributions),j}else{const{assignedDacs:_}=o||{};let M=new Map,j=0;if(S)(b&&b.length>0?b.map(Q=>Q.originalIndex):_?_.map((Q,L)=>L):[0]).forEach((Q,L)=>{M.set(Q,L),j++});else{j=(_?_.length:1)||1;for(let Y=0;Y<j;Y++){let Q=Y;y==="right_to_left"?Q=j-1-Y:y==="center_to_out"?Q=Math.floor(Math.abs(Y-(j-1)/2)):y==="out_to_center"&&(Q=Math.min(Y,j-1-Y)),M.set(Y,Q)}}const B=j;let H=(N?E*B:i*.001)*p;if(x==="bounce"){const Y=B,Q=H%(Y*2);H=Q>Y?Y*2-Q:Q}else x==="once"?H=Math.min(H,B):H=H%B;const K=n*j,J=new Float32Array(K*8),G=new Map;let V=0;const X=Array.from(M.keys());X.length===0&&X.push(0);for(const Y of X){const Q=M.get(Y)||0;let L=Math.abs(H-Q);L>B/2&&(L=B-L);let z=L<v?1-L/v:0;h>0&&(z=Math.pow(z,1-h));const ne=V;for(let fe=0;fe<n;fe++){const U=fe*8,Z=V+fe*8;J.set(a.subarray(U,U+8),Z),J[Z+3]*=z,J[Z+4]*=z,J[Z+5]*=z,z<.05&&(J[Z+6]=1)}G.set(Y,{start:ne,length:n*8}),V+=n*8}return J._channelDistributions=G,J}}function Bf(a,n,r=!1){if(!n||!a||!a.points)return a;const{safetyZones:i,outputArea:o,transformationEnabled:u,transformationMode:f,flipX:h,flipY:p}=n;let v=a.points;const y=a.isTypedArray||v instanceof Float32Array,S=y?v.length/8:v.length;let b=r?v:y?new Float32Array(v):v.map(x=>({...x}));for(let x=0;x<S;x++){let E,A,D,F,R,N;if(y?(E=b[x*8],A=b[x*8+1],D=b[x*8+3],F=b[x*8+4],R=b[x*8+5],N=b[x*8+6]):(E=b[x].x,A=b[x].y,D=b[x].r,F=b[x].g,R=b[x].b,N=b[x].blanking?1:0),u&&o){let _=(E+1)/2,M=(1-A)/2;f==="crop"?(_<o.x||_>o.x+o.w||M<o.y||M>o.y+o.h)&&(D=0,F=0,R=0,N=1):f==="scale"&&(_=o.x+_*o.w,M=o.y+M*o.h,E=_*2-1,A=1-M*2)}if(i&&i.length>0){let _=(E+1)/2,M=(1-A)/2;for(const j of i)if(_>=j.x&&_<=j.x+j.w&&M>=j.y&&M<=j.y+j.h){D=0,F=0,R=0,N=1;break}}h&&(E=-E),p&&(A=-A),E=Math.max(-1,Math.min(1,E)),A=Math.max(-1,Math.min(1,A)),y?(b[x*8]=E,b[x*8+1]=A,b[x*8+3]=D,b[x*8+4]=F,b[x*8+5]=R,b[x*8+6]=N):(b[x].x=E,b[x].y=A,b[x].r=D,b[x].g=F,b[x].b=R,b[x].blanking=N>.5)}return{...a,points:b,isTypedArray:y}}const ic=.08,I0=4,B0=.5;function Kf(a){if(!a)return new Float32Array(0);const n=a instanceof Float32Array||a.isTypedArray,r=n?a.length/8:a.length;if(r>4e3){if(a instanceof Float32Array)return a;const x=new Float32Array(r*8);for(let E=0;E<r;E++){const A=a[E];x[E*8]=A.x,x[E*8+1]=A.y,x[E*8+2]=A.z||0,x[E*8+3]=A.r,x[E*8+4]=A.g,x[E*8+5]=A.b,x[E*8+6]=A.blanking?1:0,x[E*8+7]=A.lastPoint?1:0}return x}const i=[],o=(x,E,A,D,F,R,N)=>{i.push(x,E,A,D,F,R,N?1:0,0)},u=x=>{if(n){const E=x*8;return{x:a[E],y:a[E+1],z:a[E+2],r:a[E+3],g:a[E+4],b:a[E+5],blanking:a[E+6]>.5}}else{const E=a[x];return{x:E.x||0,y:E.y||0,z:E.z||0,r:E.r||0,g:E.g||0,b:E.b||0,blanking:!!E.blanking}}};if(r===0)return new Float32Array(0);let f=u(0);for(let x=0;x<r;x++){const E=u(x),A=E.x-f.x,D=E.y-f.y,F=Math.sqrt(A*A+D*D),R=E.blanking||f.blanking||F>B0;if(R&&!f.blanking&&(o(f.x,f.y,f.z,0,0,0,!0),o(f.x,f.y,f.z,0,0,0,!0)),F>ic){const N=Math.floor(F/ic);for(let _=1;_<N;_++){const M=_/N,j=f.x+A*M,B=f.y+D*M,H=f.z+(E.z-f.z)*M,K=R?0:E.r,J=R?0:E.g,G=R?0:E.b,V=R||E.blanking;o(j,B,H,K,J,G,V)}}if(f.blanking!==E.blanking){const N=F<.01?1:I0;for(let _=0;_<N;_++)o(E.x,E.y,E.z,0,0,0,!0)}o(E.x,E.y,E.z,E.r,E.g,E.b,E.blanking),f=E}const h=u(0),p=h.x-f.x,v=h.y-f.y,y=Math.sqrt(p*p+v*v);if(h.blanking||f.blanking||y>B0){if(o(f.x,f.y,f.z,0,0,0,!0),o(f.x,f.y,f.z,0,0,0,!0),y>ic){const x=Math.floor(y/ic);for(let E=1;E<x;E++){const A=E/x;o(f.x+p*A,f.y+v*A,f.z+(h.z-f.z)*A,0,0,0,!0)}}for(let x=0;x<I0;x++)o(h.x,h.y,h.z,0,0,0,!0)}const b=new Float32Array(i);return a._channelDistributions&&(b._channelDistributions=a._channelDistributions),b}class Wy{constructor(n,r){if(this.canvas=n,this.type=r,this.gl=n.getContext("webgl")||n.getContext("experimental-webgl"),this.animationFrameId=null,this.frameIndexes=Array(10).fill(0),this.pointIndexes=Array(10).fill(0),this.showBeamEffect=!1,this.beamAlpha=.5,this.fadeAlpha=.13,this.beamRenderMode="both",this.positionBuffer=null,this.colorBuffer=null,this.alphaBuffer=null,this.alphaBufferData=new Float32Array(131072),this.lastPointDrawTime=0,!this.gl){console.error("WebGL not supported");return}this.setup()}setup(){const n=this.gl,r=`
      attribute vec2 aPosition;
      attribute vec3 aColor;
      attribute float aAlpha;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
        gl_PointSize = 2.0;
        vColor = aColor;
        vAlpha = aAlpha;
      }
    `,i=`
      precision mediump float;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_FragColor = vec4(vColor, vAlpha);
      }
    `,o=this.createShader(n.VERTEX_SHADER,r),u=this.createShader(n.FRAGMENT_SHADER,i),f=this.createProgram(o,u);this.program=f,this.positionAttributeLocation=n.getAttribLocation(f,"aPosition"),this.colorAttributeLocation=n.getAttribLocation(f,"aColor"),this.alphaAttributeLocation=n.getAttribLocation(f,"aAlpha"),this.quadPositionBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.quadPositionBuffer);const h=[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1];n.bufferData(n.ARRAY_BUFFER,new Float32Array(h),n.STATIC_DRAW),this.quadColorUniformLocation=n.getUniformLocation(f,"uColor"),this.quadAlphaUniformLocation=n.getUniformLocation(f,"uAlpha");const p=`
      attribute vec2 aPosition;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
      }
    `,v=`
      precision mediump float;
      uniform vec4 uColor;
      void main() {
        gl_FragColor = uColor;
      }
    `,y=this.createShader(n.VERTEX_SHADER,p),S=this.createShader(n.FRAGMENT_SHADER,v);this.fadeProgram=this.createProgram(y,S),this.fadePositionAttributeLocation=n.getAttribLocation(this.fadeProgram,"aPosition"),this.fadeColorUniformLocation=n.getUniformLocation(this.fadeProgram,"uColor"),n.useProgram(f);const b=131072;this.positionBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.positionBuffer),n.bufferData(n.ARRAY_BUFFER,b*2*Float32Array.BYTES_PER_ELEMENT,n.DYNAMIC_DRAW),this.colorBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer),n.bufferData(n.ARRAY_BUFFER,b*3*Float32Array.BYTES_PER_ELEMENT,n.DYNAMIC_DRAW),this.alphaBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.alphaBuffer),n.bufferData(n.ARRAY_BUFFER,b*1*Float32Array.BYTES_PER_ELEMENT,n.DYNAMIC_DRAW),n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.clearColor(0,0,0,1)}reset(){this.frameIndexes.fill(0),this.pointIndexes.fill(0),this.clearCanvas()}createShader(n,r){const i=this.gl,o=i.createShader(n);if(i.shaderSource(o,r),i.compileShader(o),i.getShaderParameter(o,i.COMPILE_STATUS))return o;console.error(i.getShaderInfoLog(o)),i.deleteShader(o)}createProgram(n,r){const i=this.gl,o=i.createProgram();if(i.attachShader(o,n),i.attachShader(o,r),i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS))return o;console.error(i.getProgramInfoLog(o)),i.deleteProgram(o)}render(n){n.showBeamEffect!==void 0&&this.setBeamEffect(n.showBeamEffect),n.beamAlpha!==void 0&&this.setBeamAlpha(n.beamAlpha),n.fadeAlpha!==void 0&&this.setFadeAlpha(n.fadeAlpha),n.beamRenderMode!==void 0&&(this.beamRenderMode=n.beamRenderMode),this.type==="world"?this.renderWorld(n.worldData,n.previewScanRate,n.layerIntensities,n.masterIntensity,n.dacSettings,n.previewTime,n.fftLevels,n.optimizationEnabled):this.renderSingle(n.ildaFrames,n.previewScanRate,n.intensity,n.effects,n.syncSettings,n.bpm,n.clipDuration,n.progress,n.previewTime,n.fftLevels,n.effectStates,n.optimizationEnabled)}renderSingle(n,r,i,o,u={},f=120,h=1,p=null,v=null,y={low:0,mid:0,high:0},S=null,b=!0){const x=this.gl;if(x.viewport(0,0,x.canvas.width,x.canvas.height),this.drawFadeQuad(),!n||n.length===0)return;const E=this.frameIndexes[0]%n.length,A=n[E],D=p!==null?p:E/n.length,F=v!==null?v:performance.now();this.draw(A,o,this.showBeamEffect,this.beamAlpha,r,this.beamRenderMode,i,0,D,F,u,f,h,y,S,b),this.frameIndexes[0]++,this.frameIndexes[0]>=n.length&&(this.frameIndexes[0]=0)}renderWorld(n,r,i,o,u,f=null,h={low:0,mid:0,high:0},p=!0){const v=this.gl;v.viewport(0,0,v.canvas.width,v.canvas.height),this.drawFadeQuad();const y=f!==null?f:performance.now();n.forEach(S=>{if(S&&S.frames&&S.frames.length>0){const b=S.frames[0];if(b){const x=S.layerIndex||0;if(S.syncSettings,S.bpm,x>=this.frameIndexes.length){const D=x+5;for(;this.frameIndexes.length<D;)this.frameIndexes.push(0),this.pointIndexes.push(0)}const A=(i[x]!==void 0?i[x]:1)*o;if(A>.001){const D=S.progress!==void 0?S.progress:this.frameIndexes[x]%S.frames.length/S.frames.length,{syncSettings:F={},bpm:R=120,clipDuration:N=1,effectStates:_=null}=S;let M=b;if(u){let j=b;if(u.dimmer!==void 0&&u.dimmer<1){const B=b.points,H=b.isTypedArray||B instanceof Float32Array,K=H?B.length/8:B.length,J=H?new Float32Array(B):B.map(G=>({...G}));for(let G=0;G<K;G++)H?(J[G*8+3]*=u.dimmer,J[G*8+4]*=u.dimmer,J[G*8+5]*=u.dimmer):(J[G].r*=u.dimmer,J[G].g*=u.dimmer,J[G].b*=u.dimmer);j={...b,points:J,isTypedArray:t}}M=Bf(j,u)}this.draw(M,S.effects,this.showBeamEffect,this.beamAlpha,r,this.beamRenderMode,A,x,D,y,F,R,N,h,_,p)}}}}),n.forEach(S=>{if(S&&S.frames){const b=S.layerIndex||0;this.frameIndexes[b]++,this.frameIndexes[b]>=S.frames.length&&(this.frameIndexes[b]=0)}})}drawFadeQuad(){const n=this.gl;this.fadeProgram&&(n.useProgram(this.fadeProgram),n.bindBuffer(n.ARRAY_BUFFER,this.quadPositionBuffer),n.enableVertexAttribArray(this.fadePositionAttributeLocation),n.vertexAttribPointer(this.fadePositionAttributeLocation,2,n.FLOAT,!1,0,0),n.uniform4f(this.fadeColorUniformLocation,0,0,0,this.fadeAlpha),n.drawArrays(n.TRIANGLES,0,6))}setBeamEffect(n){this.showBeamEffect=n}setBeamAlpha(n){this.beamAlpha=n}setFadeAlpha(n){this.fadeAlpha=n}draw(n,r,i,o,u,f,h=1,p=0,v=0,y=performance.now(),S={},b=120,x=1,E={low:0,mid:0,high:0},A=null,D=!0){if(this.gl,!n||!n.points)return;let F=n;if(D){const V=Kf(n.points);F={...n,points:V,isTypedArray:!0}}const R=Fl(F,r,{progress:v,time:y,syncSettings:S,bpm:b,clipDuration:x,fftLevels:E,effectStates:A}),N=R.points,_=R.isTypedArray,M=_?N.length/8:N.length;if(M===0)return;const j=Math.max(1,Math.floor(M/u));let B=this.pointIndexes[p]||0;B>=M&&(B=0);const H=V=>{const X=(B+V)%M;if(_){const Y=X*8;return{x:N[Y],y:N[Y+1],r:N[Y+3],g:N[Y+4],b:N[Y+5],blanking:N[Y+6]===1}}else{const Y=N[X];return{x:Y.x,y:Y.y,r:Y.r,g:Y.g,b:Y.b,blanking:Y.blanking}}},K=()=>{const V=f==="points"||f==="both",X=f==="lines"||f==="both";let Y=[],Q=[];for(let L=0;L<j;L++){const z=H(L);if(z.blanking){Y.length>0&&(X&&this._drawSegment(new Float32Array(Y),new Float32Array(Q),1,Y.length/2,!1),V&&this._drawSegment(new Float32Array(Y),new Float32Array(Q),1,Y.length/2,!0),Y=[],Q=[]);continue}Y.push(z.x,z.y),Q.push(z.r/255*h,z.g/255*h,z.b/255*h)}Y.length>0&&(X&&this._drawSegment(new Float32Array(Y),new Float32Array(Q),1,Y.length/2,!1),V&&this._drawSegment(new Float32Array(Y),new Float32Array(Q),1,Y.length/2,!0))},J=()=>{const V=[],X=[];for(let Y=0;Y<j;Y++){const Q=H(Y);if(!Q.blanking){V.push(0,0,Q.x,Q.y);const L=[Q.r/255*h,Q.g/255*h,Q.b/255*h];X.push(...L,...L)}}V.length>0&&this._drawLines(new Float32Array(V),new Float32Array(X),o,V.length/2)},G=()=>{const V=[],X=[];let Y=H(0);for(let Q=1;Q<j;Q++){const L=H(Q);if(!Y.blanking&&!L.blanking){V.push(0,0,Y.x,Y.y,L.x,L.y);const z=[Y.r/255*h,Y.g/255*h,Y.b/255*h],ne=[L.r/255*h,L.g/255*h,L.b/255*h],fe=[(z[0]+ne[0])/2,(z[1]+ne[1])/2,(z[2]+ne[2])/2],U=.3,Z=[z[0]*U,z[1]*U,z[2]*U],ue=[ne[0]*U,ne[1]*U,ne[2]*U];X.push(...fe,...Z,...ue)}Y=L}V.length>0&&this._drawTriangles(new Float32Array(V),new Float32Array(X),o,V.length/2)};K(),i&&(f==="points"?J():f==="lines"?G():f==="both"&&(G(),J())),this.pointIndexes[p]=(B+j)%M}_drawSegment(n,r,i,o,u=!1){const f=this.gl;f.useProgram(this.program),f.bindBuffer(f.ARRAY_BUFFER,this.positionBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,n),f.enableVertexAttribArray(this.positionAttributeLocation),f.vertexAttribPointer(this.positionAttributeLocation,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,r),f.enableVertexAttribArray(this.colorAttributeLocation),f.vertexAttribPointer(this.colorAttributeLocation,3,f.FLOAT,!1,0,0),this.alphaBufferData.length<o&&(this.alphaBufferData=new Float32Array(o*2)),this.alphaBufferData.fill(i,0,o);const h=this.alphaBufferData.subarray(0,o);f.bindBuffer(f.ARRAY_BUFFER,this.alphaBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,h),f.enableVertexAttribArray(this.alphaAttributeLocation),f.vertexAttribPointer(this.alphaAttributeLocation,1,f.FLOAT,!1,0,0),f.drawArrays(u?f.POINTS:f.LINE_STRIP,0,o)}_drawLines(n,r,i,o){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,n),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,r),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0),this.alphaBufferData.length<o&&(this.alphaBufferData=new Float32Array(o*2)),this.alphaBufferData.fill(i,0,o);const f=this.alphaBufferData.subarray(0,o);u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.LINES,0,o)}_drawTriangles(n,r,i,o){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,n),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,r),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0),this.alphaBufferData.length<o&&(this.alphaBufferData=new Float32Array(o*2)),this.alphaBufferData.fill(i,0,o);const f=this.alphaBufferData.subarray(0,o);u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.TRIANGLES,0,o)}clearCanvas(){const n=this.gl;n.viewport(0,0,n.canvas.width,n.canvas.height),n.clear(n.COLOR_BUFFER_BIT)}destroy(){if(cancelAnimationFrame(this.animationFrameId),this.gl){const n=this.gl.getExtension("WEBGL_losing_context");n&&n.loseContext()}}}const km=({frame:a,effects:n,width:r=100,height:i=100})=>{const o=T.useRef(null),u=T.useRef(null),[f,h]=T.useState(null);return T.useEffect(()=>(o.current&&!u.current&&(u.current=new Wy(o.current,"single")),()=>{u.current&&(u.current.destroy(),u.current=null)}),[]),T.useEffect(()=>{if(!a){h(null);return}let p=a;if(n&&n.length>0){const v=a.points,y=a.isTypedArray||v instanceof Float32Array;let S;y?S=new Float32Array(v):S=v.map(x=>({...x}));const b={...a,points:S,isTypedArray:y};p=Fl(b,n,{time:performance.now(),progress:0,effectStates:new Map})}h(p)},[a,n]),T.useEffect(()=>{u.current&&f?u.current.render({ildaFrames:[f],previewScanRate:1,intensity:1,effects:[],syncSettings:{}}):u.current&&u.current.clearCanvas()},[f]),g.jsx("div",{className:"clip-thumbnail",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"black"},children:g.jsx("canvas",{ref:o,width:r,height:i,style:{width:"100%",height:"100%",backgroundColor:"black"}})})},Ky=({frame:a,bitmap:n,width:r=50,height:i=50})=>{const o=T.useRef(null);return T.useEffect(()=>{const u=o.current;if(!u)return;const f=u.getContext("2d");if(n){f.clearRect(0,0,r,i),f.drawImage(n,0,0,r,i);return}if(!a||!a.points)return;f.fillStyle="#000000",f.fillRect(0,0,r,i);const h=a.points,p=a.isTypedArray||h instanceof Float32Array,v=p?h.length/8:h.length;f.lineWidth=1.5,f.lineCap="round";let y=null,S=null;for(let b=0;b<v;b++){let x,E,A,D,F,R;if(p)x=h[b*8],E=h[b*8+1],A=h[b*8+3],D=h[b*8+4],F=h[b*8+5],R=h[b*8+6]>.5;else{const M=h[b];x=M.x,E=M.y,A=M.r,D=M.g,F=M.b,R=M.blanking}const N=(x+1)*.5*r,_=(1-(E+1)*.5)*i;if(R){y=null,S=null;continue}else if(y!==null){f.beginPath(),f.moveTo(y,S),f.lineTo(N,_);const M=Math.floor(Math.max(0,Math.min(255,A))),j=Math.floor(Math.max(0,Math.min(255,D))),B=Math.floor(Math.max(0,Math.min(255,F)));f.strokeStyle=`rgb(${M},${j},${B})`,f.stroke()}y=N,S=_}},[a,r,i]),g.jsx("canvas",{ref:o,width:r,height:i,style:{width:"50px",height:"50px",backgroundColor:"black",display:"block",borderRadius:"5px"}})},Jf=Gn.memo(Ky),Jy=({layerName:a,index:n,onDropEffect:r,onDropDac:i,layerEffects:o,activeClipData:u,onDeactivateLayerClips:f,onShowLayerFullContextMenu:h,thumbnailRenderMode:p,intensity:v,onIntensityChange:y,liveFrame:S,isBlackout:b,isSolo:x,onToggleBlackout:E,onToggleSolo:A,onLayerSelect:D})=>{const[F,R]=T.useState(o||[]),[N,_]=T.useState(!1),[M,j]=T.useState(!1);T.useEffect(()=>{R(o||[])},[o]);const B=T.useMemo(()=>[...u?.effects||[],...o||[]],[u?.effects,o]),H=(Y,Q,L,z,ne)=>{Y.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:Q,paramName:L,targetType:z,layerIndex:n,label:ne}))},K=Y=>{Y.preventDefault(),console.log(`Right-clicked LayerControls at index: ${n}`),h&&h(n)},J=Y=>{Y.preventDefault(),Y.stopPropagation(),_(!0),Y.dataTransfer.dropEffect="copy"},G=Y=>{Y.preventDefault(),Y.stopPropagation(),_(!1)},V=Y=>{Y.preventDefault(),Y.stopPropagation(),_(!1);const Q=Y.dataTransfer.getData("application/json");if(Q)try{const z=JSON.parse(Q);if(z.type==="transform"||z.type==="animation"||z.type==="color"||z.type==="effect"){if(r){r(z.id||z.name);return}}else if(z.ip&&(typeof z.channel=="number"||z.allChannels)&&i){i(n,z);return}}catch(z){console.error("Error parsing drop data in LayerControls:",z)}const L=Y.dataTransfer.getData("text/plain");if(L.startsWith("effect_")){const z=L.replace("effect_","");r&&r(z)}},X=p==="active"||p==="hover"&&M;return g.jsxs("div",{className:`layer-controls ${N?"dragging":""}`,onContextMenu:K,onDragOver:J,onDragLeave:G,onDrop:V,children:[g.jsxs("div",{className:"grid-layer",children:[g.jsx(Lt,{id:`layer_${n}_clear`,children:g.jsx("span",{className:"layer-control-button full-height",onClick:()=>f(n),draggable:!0,onDragStart:Y=>H(Y,"toggle","clear","layer",`L${n+1} Clear`),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),g.jsxs("div",{className:"layer-control-group",children:[g.jsx(Lt,{id:`layer_${n}_blackout`,children:g.jsx("span",{className:"layer-control-button half-height",onClick:E,style:{backgroundColor:b?"red":""},draggable:!0,onDragStart:Y=>H(Y,"toggle","blackout","layer",`L${n+1} Blackout`),children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),g.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),g.jsx(Lt,{id:`layer_${n}_solo`,children:g.jsx("span",{className:"layer-control-button half-height",onClick:A,style:{backgroundColor:x?"var(--theme-color)":"",color:x?"black":""},draggable:!0,onDragStart:Y=>H(Y,"toggle","solo","layer",`L${n+1} Solo`),children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-1-square",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z"}),g.jsx("path",{d:"M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"})]})})})]}),g.jsxs("select",{className:"layer-blend-dropdown",children:[g.jsx("option",{children:"Normal"}),g.jsx("option",{children:"Add"}),g.jsx("option",{children:"Subtract"})]})]}),g.jsx("div",{className:"layer-control-row",children:g.jsx(Lt,{id:`layer_${n}_intensity`,children:g.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:v,className:"slider_ver",id:"layer-intensity-slider",onChange:Y=>y(parseFloat(Y.target.value))})})}),g.jsx("div",{className:"layer-preview-thumbnail",onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),style:{overflow:"hidden"},children:u?X?g.jsx(km,{frame:S||u.stillFrame,effects:B}):u.thumbnailPath?g.jsx("img",{src:`file://${u.thumbnailPath}?t=${u.thumbnailVersion||Date.now()}`,alt:"layer-thumbnail",style:{width:"100%",height:"100%",objectFit:"contain"}}):g.jsx(Jf,{frame:u.stillFrame}):F.length>0&&g.jsx("div",{className:"applied-effects",children:F.map((Y,Q)=>g.jsx("span",{className:"effect-tag",children:(Y.name||Y.id||"???").substring(0,3).toUpperCase()},Y.instanceId||Q))})}),g.jsx("span",{className:"layer-name-label",onClick:()=>D&&D(n),children:a})]})},e1=({clipName:a,layerIndex:n,colIndex:r,onDropGenerator:i,onDropEffect:o,clipContent:u,thumbnailFrameIndex:f,onUnsupportedFile:h,onActivateClick:p,onLabelClick:v,isSelected:y,isActive:S,ildaParserWorker:b,onDropDac:x,thumbnailRenderMode:E,liveFrame:A,stillFrame:D,onClipHover:F,onThumbnailError:R})=>{const[N,_]=T.useState(!1),[M,j]=T.useState(!1),B=a,H=E==="active"||E==="hover"&&N,K=ne=>{ne.preventDefault(),ne.stopPropagation(),j(!0),ne.dataTransfer.dropEffect="copy"},J=ne=>{ne.preventDefault(),ne.stopPropagation(),ne.currentTarget.contains(ne.relatedTarget)||j(!1)},G=()=>{_(!0),F&&F(n,r,!0)},V=()=>{_(!1),p(!1),F&&F(n,r,!1)},X=async ne=>{const fe=ne.name;if(!b){h("ILDA parser not available.");return}if(fe.toLowerCase().endsWith(".ild"))try{const U=await ne.arrayBuffer();console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFileDrop): ${U.byteLength}`),b.postMessage({type:"parse-ilda",arrayBuffer:U,fileName:fe,filePath:ne.path,layerIndex:n,colIndex:r},[U])}catch(U){console.error("[Clip.jsx] handleFileDrop - Error reading file:",U),h(`Error reading file: ${U.message}`)}else h("Please drop a valid .ild file")},Y=async(ne,fe)=>{if(!fe.toLowerCase().endsWith(".ild")){console.log("Unsupported file type:",fe),h("Please drop a valid .ild file");return}if(!b){h("ILDA parser not available.");return}try{if(window.electronAPI&&window.electronAPI.readFileAsBinary){const Z=(await window.electronAPI.readFileAsBinary(ne)).slice().buffer;console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFilePathDrop): ${Z.byteLength}`),b.postMessage({type:"parse-ilda",arrayBuffer:Z,fileName:fe,filePath:ne,layerIndex:n,colIndex:r},[Z])}else h("Binary file access not available")}catch(U){console.error("Error processing file path:",U),console.error("Error stack:",U.stack),h(`Error processing file: ${U.message}`)}},Q=ne=>{ne.preventDefault(),ne.stopPropagation(),j(!1);const fe=ne.dataTransfer.getData("application/json");if(fe)try{const Z=JSON.parse(fe);if(Z.filePath&&Z.fileName){Y(Z.filePath,Z.fileName);return}if(Z.type==="transform"||Z.type==="animation"||Z.type==="color"||Z.type==="effect"){if(o){o(Z),v();return}}else if(Z.ip&&(typeof Z.channel=="number"||Z.allChannels)){if(x){x(n,r,Z);return}}else if(Z.name&&i){i(n,r,Z);return}}catch(Z){console.error("Error parsing dropped data:",Z)}const U=ne.dataTransfer.files;if(U&&U.length>0){X(U[0]);return}console.log("No recognized data format found in drop"),h("No valid ILD file, effect, or generator dropped.")},L=ne=>{ne.preventDefault(),ne.stopPropagation()},z=ne=>{ne.preventDefault(),window.electronAPI&&window.electronAPI.showClipContextMenu&&window.electronAPI.showClipContextMenu(n,r,u?.triggerStyle||"normal")};return g.jsxs("div",{className:`clip ${M?"dragging":""} ${S?"active-clip":""} `,onDragEnter:L,onDragOver:K,onDragLeave:J,onDrop:Q,onContextMenu:z,children:[g.jsx(Lt,{id:`clip_${n}_${r}`,children:g.jsx("div",{className:"clip-thumbnail",onMouseDown:ne=>{ne.button===0&&p(!0)},onMouseUp:ne=>{ne.button===0&&p(!1)},onMouseEnter:G,onMouseLeave:V,style:{overflow:"hidden"},children:u&&u.parsing?g.jsx("div",{className:"clip-loading-spinner"}):g.jsxs(g.Fragment,{children:[H&&u?g.jsx(km,{frame:A||D,effects:u?.effects}):u?.thumbnailPath?g.jsx("img",{src:`file://${u.thumbnailPath}?t=${u.thumbnailVersion||Date.now()}`,alt:"thumbnail",onError:()=>R&&R(n,r),style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}):D&&g.jsx(Jf,{frame:D}),u?.triggerStyle&&u.triggerStyle!=="normal"&&g.jsxs("p",{className:"clip_icons",children:[u.triggerStyle==="toggle"&&g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-toggles",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M4.5 9a3.5 3.5 0 1 0 0 7h7a3.5 3.5 0 1 0 0-7zm7 6a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m-7-14a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5m2.45 0A3.5 3.5 0 0 1 8 3.5 3.5 3.5 0 0 1 6.95 6h4.55a2.5 2.5 0 0 0 0-5zM4.5 0h7a3.5 3.5 0 1 1 0 7h-7a3.5 3.5 0 1 1 0-7"})}),u.triggerStyle==="flash"&&g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-lightning-fill",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641z"})})]})]})})}),g.jsx(Lt,{id:`clip_${n}_${r}_preview`,children:g.jsx("span",{className:`clip-label ${y?"selected-clip":""}`,onClick:v,children:B})})]})},t1=Gn.memo(e1),Om=T.createContext(null),Lm=()=>T.useContext(Om),n1=({children:a})=>{const[n,r]=T.useState(null);return T.useEffect(()=>{if(!n){const i=new Worker(new URL(""+new URL("ilda-parser.worker-XXY4JEks.js",import.meta.url).href,import.meta.url));r(i)}return()=>{n&&n.terminate()}},[n]),g.jsx(Om.Provider,{value:n,children:a})},a1=({onDropIld:a,viewMode:n="list",onViewModeChange:r,path:i,onPathChange:o})=>{const[u,f]=T.useState([]),[h,p]=T.useState({}),[v,y]=T.useState(new Set),S=Lm(),b=T.useRef(new Set),x=T.useRef([]),E=T.useRef(!1),A=i,D=o,F=T.useCallback(()=>{if(E.current||x.current.length===0||!S)return;E.current=!0;const N=x.current.shift(),_=N.split(/[/\\]/).pop();S.postMessage({type:"load-and-parse-ilda",fileName:_,filePath:N,browserFile:!0,stopAtFirstFrame:!0})},[S]);T.useEffect(()=>{if(!S)return;const N=_=>{_.data.browserFile&&(_.data.type==="parse-ilda"?_.data.success?S.postMessage({type:"get-frame",workerId:_.data.workerId,frameIndex:0,browserFile:!0,filePath:_.data.filePath}):(console.warn(`[FileBrowser] Skipping invalid ILDA file: ${_.data.filePath}. Reason: ${_.data.error}`),y(M=>new Set(M).add(_.data.filePath)),E.current=!1,F()):_.data.type==="get-frame"&&(_.data.success&&p(M=>({...M,[_.data.filePath]:_.data.bitmap||_.data.frame})),E.current=!1,F()))};return S.addEventListener("message",N),()=>S.removeEventListener("message",N)},[S,F]),T.useEffect(()=>{if(n==="thumbnails"&&u.length>0&&S){let N=!1;u.forEach(_=>{!h[_]&&!b.current.has(_)&&(b.current.add(_),x.current.push(_),N=!0)}),N&&!E.current&&F()}},[n,u,S,h,F]),T.useEffect(()=>{(async()=>{if(i){const _=await window.electronAPI.readIldFiles(i);f(_),b.current.clear(),x.current=[],E.current=!1,p({});return}if(window.electronAPI&&window.electronAPI.getUserIldaPath){const _=await window.electronAPI.getUserIldaPath();if(_){D(_);const M=await window.electronAPI.readIldFiles(_);f(M),b.current.clear(),x.current=[],E.current=!1,p({})}}})()},[i]);const R=async()=>{if(window.electronAPI){const N=await window.electronAPI.openFileExplorer();if(N){D(N);const _=await window.electronAPI.readIldFiles(N);f(_),b.current.clear(),x.current=[],E.current=!1,p({})}}};return g.jsxs("div",{className:"file-browser",children:[g.jsx("button",{onClick:R,children:"Open Folder"}),g.jsxs("div",{className:"list_switcher",children:[g.jsx("button",{className:n==="list"?"active":"",onClick:()=>r&&r("list"),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",fill:"currentColor",className:"bi bi-list",viewBox:"0 0 16 16",children:g.jsx("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"})})}),g.jsx("button",{className:n==="thumbnails"?"active":"",onClick:()=>r&&r("thumbnails"),children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",fill:"currentColor",className:"bi bi-image",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}),g.jsx("path",{d:"M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"})]})})]}),A&&g.jsxs("p",{className:"fileBrowser",children:["Selected Directory: ",A.split(/[/\\]/).filter(Boolean).pop()]}),g.jsx("div",{className:"ild-file-grid",style:{display:n==="thumbnails"?null:"none"},children:u.filter(N=>!v.has(N)).length>0?u.filter(N=>!v.has(N)).map((N,_)=>{const M=N.split(/[/\\]/).pop(),j=h[N];return g.jsxs("div",{className:"ild-file-preview",draggable:!0,onDragStart:B=>B.dataTransfer.setData("application/json",JSON.stringify({filePath:N,fileName:M})),children:[g.jsx("div",{className:"file_thumbnail",children:j?g.jsx(Jf,{bitmap:j instanceof ImageBitmap?j:null,frame:j instanceof ImageBitmap?null:j}):g.jsx("div",{className:"clip-loading-spinner"})}),g.jsx("div",{className:"file_name",children:M})]},_)}):g.jsx("p",{children:"No valid ILD files found in selected directory."})}),g.jsx("div",{className:"ild-file-list",style:{display:n==="list"?null:"none"},children:u.filter(N=>!v.has(N)).length>0?u.filter(N=>!v.has(N)).map((N,_)=>{const M=N.split(/[/\\]/).pop();return g.jsx("div",{className:"ild-file-item",draggable:!0,onDragStart:j=>j.dataTransfer.setData("application/json",JSON.stringify({filePath:N,fileName:M})),children:M},_)}):g.jsx("p",{children:"No valid ILD files found in selected directory."})})]})},Ff=[{id:"circle",name:"Circle",description:"Generates a simple circle.",defaultParams:{radius:.5,numPoints:100,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"radius",label:"Radius",type:"range",min:.01,max:1,step:.01},{id:"numPoints",label:"Number of Points",type:"range",min:3,max:360,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"square",name:"Square",description:"Generates a simple square.",defaultParams:{width:1,height:1,pointDensity:25,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"width",label:"Width",type:"range",min:.01,max:2,step:.01},{id:"height",label:"Height",type:"range",min:.01,max:2,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:100,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"line",name:"Line",description:"Generates a straight line.",defaultParams:{x1:-.5,y1:0,x2:.5,y2:0,pointDensity:50,r:255,g:255,b:255},paramControls:[{id:"x1",label:"X1",type:"range",min:-1,max:1,step:.01},{id:"y1",label:"Y1",type:"range",min:-1,max:1,step:.01},{id:"x2",label:"X2",type:"range",min:-1,max:1,step:.01},{id:"y2",label:"Y2",type:"range",min:-1,max:1,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:2,max:200,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"text",name:"Text",description:"Generates text.",defaultParams:{text:"TrueLazer",x:0,y:.3,fontSize:72,numPoints:200,fontUrl:"src/fonts/Geometr415 Blk BT Black.ttf",r:255,g:255,b:255},paramControls:[{id:"text",label:"Text Content",type:"text"},{id:"fontUrl",label:"Fonts",type:"text"},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"fontSize",label:"Font Size",type:"range",min:10,max:200,step:1},{id:"numPoints",label:"Target Points",type:"range",min:10,max:1e3,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"star",name:"Star",description:"Generates a star shape.",defaultParams:{outerRadius:.5,innerRadius:.2,numSpikes:5,pointDensity:10,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"outerRadius",label:"Outer Radius",type:"range",min:.01,max:1,step:.01},{id:"innerRadius",label:"Inner Radius",type:"range",min:.01,max:1,step:.01},{id:"numSpikes",label:"Number of Spikes",type:"range",min:3,max:20,step:1},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:50,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"ndi-source",name:"NDI Source",description:"Placeholder for NDI Video Input.",defaultParams:{sourceName:"No Source",threshold:128,edgeDetection:!1,captureWidth:1280,captureHeight:720,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Source Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"captureWidth",label:"Capture Width",type:"range",min:64,max:1280,step:8},{id:"captureHeight",label:"Capture Height",type:"range",min:64,max:720,step:8},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"spout-receiver",name:"Spout Receiver",description:"Placeholder for Spout Video Input.",defaultParams:{sourceName:"Spout Input",threshold:128,edgeDetection:!1,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Sender Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]}],r1=()=>{const[a,n]=T.useState([]);T.useEffect(()=>{const o=async()=>{if(window.electronAPI&&window.electronAPI.ndiFindSources){const f=await window.electronAPI.ndiFindSources();n(f||[])}};o();const u=setInterval(o,5e3);return()=>clearInterval(u)},[]);const r=(o,u)=>{o.dataTransfer.setData("application/json",JSON.stringify(u))},i=(o,u)=>{const f=Ff.find(p=>p.id==="ndi-source"),h={...f,defaultParams:{...f.defaultParams,sourceName:u.name}};o.dataTransfer.setData("application/json",JSON.stringify(h))};return g.jsxs("div",{className:"generator-panel",children:[g.jsx("div",{className:"generator-list",children:Ff.filter(o=>o.id!=="ndi-source"&&o.id!=="spout-receiver").map(o=>g.jsx("div",{className:"generator-item",draggable:!0,onDragStart:u=>r(u,o),children:o.name},o.id))}),g.jsx("h3",{style:{marginTop:"10px"},children:"NDI Sources"}),g.jsx("div",{className:"generator-list",children:a.length>0?a.map((o,u)=>g.jsx("div",{className:"generator-item ndi-item",draggable:!0,onDragStart:f=>i(f,o),children:o.name},`${o.name}-${u}`)):g.jsx("div",{className:"empty-msg",children:"No NDI sources found"})})]})},s1=()=>{const a=(n,r)=>{n.dataTransfer.setData("application/json",JSON.stringify(r))};return g.jsx("div",{className:"effect-panel",children:Li.map(n=>g.jsx("div",{draggable:!0,onDragStart:r=>a(r,n),className:"effect-item",children:n.name},n.id))})},Bs=({value:a,onChange:n,label:r,onDrop:i,size:o=40,isAssigned:u,className:f,...h})=>{const p=T.useRef(null),v=x=>{i&&(x.preventDefault(),x.dataTransfer.dropEffect="link")},y=x=>{if(i){x.preventDefault();try{const E=x.dataTransfer.getData("application/x-truelazer-param");console.log("[RadialKnob] Dropped Data Raw:",E);const A=JSON.parse(E);console.log("[RadialKnob] Dropped Data Parsed:",A),A&&(A.type==="range"||A.type==="number")?i(A):console.warn("[RadialKnob] Invalid data type for knob:",A?.type)}catch(E){console.error("[RadialKnob] Drop Error:",E)}}},S=-135+a*270,b=x=>{if(!u||x.button!==0)return;x.preventDefault();const E=x.clientY,A=a,D=R=>{const _=(E-R.clientY)/200;let M=Math.max(0,Math.min(1,A+_));n(M)},F=()=>{window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",F)};window.addEventListener("mousemove",D),window.addEventListener("mouseup",F)};return T.useEffect(()=>{const x=p.current;if(!x)return;const E=A=>{if(!u)return;A.preventDefault(),A.stopPropagation();const D=A.deltaY*-.001;let F=Math.max(0,Math.min(1,a+D));n(F)};return x.addEventListener("wheel",E,{passive:!1}),()=>{x.removeEventListener("wheel",E)}},[a,n,u]),g.jsxs("div",{className:`quick-assign-knob ${u?"":"unassigned"} ${f||""}`.trim(),ref:p,style:{cursor:u?"ns-resize":"default",userSelect:"none",opacity:u?1:.5},onDragOver:v,onDrop:y,onMouseDown:b,...h,children:[g.jsx("div",{className:"knob-label",title:r,children:r}),g.jsx("div",{className:"knob-circle",children:g.jsx("div",{className:"knob-indicator",style:{transform:`rotate(${S}deg)`}})}),g.jsxs("div",{className:"knob-value",style:{fontSize:"9px",color:"#888",marginTop:"2px"},children:[Math.round(a*100),"%"]})]})},i1=({dacs:a=[],onDacSelected:n,onDacsDiscovered:r,dacSettings:i={},onUpdateDacSettings:o})=>{const[u,f]=T.useState(!1),[h,p]=T.useState(null),[v,y]=T.useState([]),[S,b]=T.useState(null),x=Gn.useRef(!1);T.useEffect(()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(R=>{y(R),R.length>0&&b(R[0])})},[]),T.useEffect(()=>{u&&!x.current&&(x.current=!0,console.log("Starting DAC scan on:",S?.address),window.electronAPI?window.electronAPI.discoverDacs(2e3,S?.address).then(async R=>{console.log("DACs discovered:",R);const N=await Promise.all(R.map(async _=>{try{const M=await window.electronAPI.getDacServices(_.ip,S?.address,_.type),j=_.type&&_.type.toLowerCase()==="etherdream"?M:M.filter(B=>B.serviceID!==0);return{..._,channels:j}}catch(M){return console.error(`Error fetching services for DAC ${_.ip}:`,M),{..._,channels:[]}}}));r&&r(N)}).catch(R=>{console.error("Error discovering DACs:",R)}).finally(()=>{f(!1),x.current=!1}):(console.warn("electronAPI is not available. Cannot discover DACs."),f(!1),x.current=!1))},[u,S,r]);const E=(R,N)=>{const _={...R,channel:N};p(_),n&&n(_)},A=(R,N,_)=>{R.stopPropagation();const M={...N,channel:_};R.dataTransfer.setData("application/json",JSON.stringify(M))},D=R=>{const N=R.target.value,_=v.find(M=>M.address===N);b(_)},F=(R,N)=>{R.stopPropagation();const _={...N,allChannels:!0};R.dataTransfer.setData("application/json",JSON.stringify(_))};return g.jsxs("div",{className:"dac-panel",children:[g.jsx("div",{className:"settings-card-header",children:g.jsx("h4",{children:"DACs"})}),g.jsxs("div",{className:"network-interface-selector",style:{display:"flex",gap:5,padding:"5px 10px"},children:[g.jsxs("div",{style:{flex:1,display:"flex"},children:[g.jsx("select",{onChange:D,value:S?.address||"",style:{width:"100%",height:"100%",background:"#2a2a2a",color:"#aaa",borderRadius:"5px",cursor:"pointer",marginBottom:2},children:v.map(R=>g.jsxs("option",{value:R.address,children:[R.name," (",R.address,")"]},R.address))}),g.jsx("button",{onClick:()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(R=>{y(R),R.length>0&&!S&&b(R[0])})},style:{fontSize:"9px",padding:"2px",background:"#333",border:"1px solid #555",color:"#ccc",cursor:"pointer",borderRadius:"5px"},children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[g.jsx("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),g.jsx("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"})]})})]}),g.jsx("label",{style:{display:"flex",alignItems:"center",fontSize:"10px"},children:g.jsx("input",{type:"checkbox",checked:u,onChange:R=>f(R.target.checked),disabled:u,style:{height:"100%"}})})]}),g.jsx("div",{className:"dac-list",children:a.map(R=>g.jsxs("div",{className:"dac-group",draggable:!0,onDragStart:N=>F(N,R),children:[g.jsxs("div",{className:"dac-ip",children:[R.hostName||R.ip," (",R.ip,")"]}),g.jsx("div",{className:"dac-channels",children:R.channels&&R.channels.length>0?R.channels.map(N=>g.jsxs("div",{className:`dac-channel-item ${h&&(h.unitID===R.unitID||h.ip===R.ip)&&h.channel===N.serviceID?"selected":""}`,onClick:()=>E(R,N.serviceID),draggable:!0,onDragStart:_=>A(_,R,N.serviceID),children:["Channel ",N.serviceID," (",N.name,")"]},`${R.unitID||R.ip}-${N.serviceID}`)):g.jsx("div",{className:"dac-channel-item no-channels",children:"No channels found"})})]},R.unitID||R.ip))}),a.length>0&&g.jsxs("div",{className:"dac-dimmers-section",children:[g.jsx("h4",{children:"Channel Dimmers"}),g.jsx("div",{className:"dac-dimmers-grid",children:a.flatMap(R=>(R.channels||[]).map(N=>({dac:R,ch:N}))).map(({dac:R,ch:N})=>{const _=`${R.ip}:${N.serviceID}`,M=i[_]||{},j=M.dimmer!==void 0?M.dimmer:1;return g.jsx(Lt,{id:`dimmer_${_.replace(/\./g,"_")}`,children:g.jsx(Bs,{label:`${R.hostName||R.ip} Ch${N.serviceID}`,value:j,onChange:B=>{o&&o(_,{...M,dimmer:B})}})},`dimmer_${_}`)})})]})]})},Um=({min:a,max:n,step:r,value:i,rangeValue:o,onChange:u,onRangeChange:f,showRange:h=!1,disabled:p=!1,animSettings:v,progressRef:y,workerId:S,clipDuration:b,bpm:x,getFftLevels:E})=>{const A=T.useRef(null),D=T.useRef(null),F=T.useRef(null),[R,N]=T.useState(null),_=a!==void 0?a:0,M=n!==void 0?n:1,j=o&&o[0]!==void 0?o[0]:_,B=o&&o[1]!==void 0?o[1]:M,H=i!==void 0?i:_,K=G=>{const V=M-_;return V===0?0:(G-_)/V*100};T.useEffect(()=>{let G;const V=()=>{if(R==="value"){G=requestAnimationFrame(V);return}let X=H;if(v&&v.syncMode&&y&&y.current){const L={progress:S&&y.current[S]!==void 0?y.current[S]:0,time:performance.now(),clipDuration:b||1,bpm:x||120,fftLevels:E?E():{low:0,mid:0,high:0}};X=gc(null,H,v,L,_,M)}const Y=K(X);D.current&&(D.current.style.left=`${Y}%`),F.current&&(F.current.style.width=`${Y}%`),G=requestAnimationFrame(V)};return G=requestAnimationFrame(V),()=>cancelAnimationFrame(G)},[v,y,S,H,R,_,M,x,E,b]);const J=(G,V)=>{if(p)return;G.preventDefault(),G.stopPropagation(),N(V);const X=Q=>{if(!A.current)return;const L=A.current.getBoundingClientRect(),z=Q.clientX-L.left;let ne=Math.max(0,Math.min(100,z/L.width*100)),fe=_+ne/100*(M-_);r&&(fe=Math.round(fe/r)*r,ne=(fe-_)/(M-_)*100),V==="value"?(fe=Math.max(j,Math.min(B,fe)),D.current&&(D.current.style.left=`${K(fe)}%`),F.current&&!h&&(F.current.style.width=`${K(fe)}%`),u&&u(fe)):V==="min"?(fe=Math.max(_,Math.min(B,fe)),f&&f([fe,B])):V==="max"&&(fe=Math.max(j,Math.min(M,fe)),f&&f([j,fe]))},Y=()=>{N(null),window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",Y)};window.addEventListener("mousemove",X),window.addEventListener("mouseup",Y)};return g.jsx("div",{className:"range-slider-container",style:{position:"relative",width:"100%",height:"20px",display:"flex",alignItems:"center"},children:g.jsxs("div",{className:"range-slider-track",ref:A,style:{width:"100%",height:"4px",background:"#444",borderRadius:"2px",position:"relative"},children:[h&&g.jsx("div",{className:"range-slider-fill",style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:`${K(j)}%`,width:`${K(B)-K(j)}%`}}),!h&&g.jsx("div",{className:"value-slider-fill",ref:F,style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:"0%",borderRadius:"2px"}}),h&&g.jsx("div",{className:"range-slider-handle min-handle",style:{left:`${K(j)}%`},onMouseDown:G=>J(G,"min"),title:`Min: ${j.toFixed(2)}`}),h&&g.jsx("div",{className:"range-slider-handle max-handle",style:{left:`${K(B)}%`},onMouseDown:G=>J(G,"max"),title:`Max: ${B.toFixed(2)}`}),g.jsx("div",{className:"range-slider-handle value-handle",ref:D,style:{position:"absolute",width:"6px",height:"16px",top:"-50%",transform:"translate(-50%, -25%)",cursor:"pointer",zIndex:20,boxShadow:"0 0 2px rgba(0,0,0,0.5)"},onMouseDown:G=>J(G,"value"),title:`Value: ${H.toFixed(2)}`})]})})},Cn=({title:a,children:n,icon:r,defaultCollapsed:i=!1,headerActions:o,onToggle:u,isCollapsed:f,dragHandle:h})=>{const[p,v]=T.useState(i),y=u!==void 0?f:p,S=()=>{u?u(!y):v(!y)};return g.jsxs("div",{className:`settings-card ${y?"collapsed":""}`,children:[g.jsxs("div",{className:"settings-card-header",onClick:S,style:{userSelect:"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",cursor:"pointer",flex:1,overflow:"hidden"},children:[h&&g.jsx("div",{onClick:b=>b.stopPropagation(),style:{display:"flex",alignItems:"center"},children:h}),g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",style:{transform:y?"rotate(0deg)":"rotate(90deg)",transition:"transform 0.2s",flexShrink:0},children:g.jsx("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"})}),r&&g.jsx("span",{className:`bi ${r}`,style:{flexShrink:0}}),g.jsx("h4",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",margin:0},children:a})]}),o&&g.jsx("div",{onClick:b=>b.stopPropagation(),style:{flexShrink:0,marginLeft:"5px"},children:o})]}),!y&&g.jsx("div",{className:"settings-card-content",children:n})]})},Im=({animSettings:a,onChange:n})=>{const{direction:r="forward",style:i="loop",syncMode:o=null,duration:u=1,beats:f=8,speedMultiplier:h=1}=a||{},p=(y,S)=>n({...a,[y]:S}),v=(y,S,b=!1)=>{let E=a?.[y]||(y==="beats"?8:1);b?E=S>1?E*2:E/2:E+=S,E<.01&&(E=.01),!b&&y!=="beats"&&(E=Math.round(E*100)/100),p(y,E)};return g.jsxs("div",{className:"anim-controls-container",children:[g.jsxs("div",{className:"anim-row controls-row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"5px"},children:[g.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[g.jsx("button",{className:`speed-control-button ${r==="backward"?"active":""}`,onClick:()=>p("direction","backward"),title:"Backward",style:{flex:1,padding:0,fontSize:"10px"},children:g.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",transform:"scale(-1 1)",children:g.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})}),g.jsx("button",{className:`speed-control-button ${r==="pause"?"active":""}`,onClick:()=>p("direction","pause"),title:"Pause",style:{flex:1,padding:0,fontSize:"10px"},children:g.jsx("svg",{width:"25",height:"20",viewBox:"0 0 16 16",className:"icon flat-color",children:g.jsx("path",{d:"M3 1h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m7 0h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m0 0"})})}),g.jsx("button",{className:`speed-control-button ${r==="forward"?"active":""}`,onClick:()=>p("direction","forward"),title:"Forward",style:{flex:1,padding:0,fontSize:"10px"},children:g.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",children:g.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})})]}),g.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[g.jsx("button",{className:`speed-control-button ${i==="once"?"active":""}`,onClick:()=>p("style","once"),title:"Once",style:{flex:1,padding:0,fontSize:"10px"},children:g.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[g.jsx("path",{d:"M43.8233 25.2305C43.7019 25.9889 43.5195 26.727 43.2814 27.4395 42.763 28.9914 41.9801 30.4222 40.9863 31.6785 38.4222 34.9201 34.454 37 30 37H16C9.39697 37 4 31.6785 4 25 4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M24 19V31",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M24 19 21 22 19.5 23.5",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),g.jsx("button",{className:`speed-control-button ${i==="bounce"?"active":""}`,onClick:()=>p("style","bounce"),title:"Bounce",style:{flex:1,padding:0,fontSize:"10px"},children:g.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[g.jsx("path",{d:"M42 19H5.99998",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M30 7 42 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M6.79897 29H42.799",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M6.79895 29 18.799 41",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),g.jsx("button",{className:`speed-control-button ${i==="loop"?"active":""}`,onClick:()=>p("style","loop"),title:"Loop",style:{flex:1,padding:0,fontSize:"10px"},children:g.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[g.jsx("path",{d:"M4 25C4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M44 23C44 29.6498 38.6038 35 32 35H4",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),g.jsx("path",{d:"M10 41 4 35 10 29",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),g.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[g.jsx("button",{className:`speed-control-button ${o==="fps"?"active":""}`,onClick:()=>p("syncMode",o==="fps"?null:"fps"),style:{flex:1,padding:0,fontSize:"10px"},children:"F"}),g.jsx("button",{className:`speed-control-button ${o==="timeline"?"active":""}`,onClick:()=>p("syncMode",o==="timeline"?null:"timeline"),style:{flex:1,padding:0,fontSize:"10px"},children:"T"}),g.jsx("button",{className:`speed-control-button ${o==="bpm"?"active":""}`,onClick:()=>p("syncMode",o==="bpm"?null:"bpm"),style:{flex:1,padding:0,fontSize:"10px"},children:"B"}),g.jsx("button",{className:`speed-control-button ${o==="fft"?"active":""}`,onClick:()=>p("syncMode",o==="fft"?null:"fft"),style:{flex:1,padding:0,fontSize:"10px"},children:"FFT"})]})]}),o==="fft"&&g.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:g.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[g.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Range"}),g.jsxs("select",{value:a?.fftRange||"low",onChange:y=>p("fftRange",y.target.value),style:{fontSize:"10px",background:"#333",border:"1px solid #555",color:"white"},children:[g.jsx("option",{value:"low",children:"Low"}),g.jsx("option",{value:"mid",children:"Mid"}),g.jsx("option",{value:"high",children:"High"})]})]})}),o==="timeline"&&g.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:g.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[g.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Duration (s)"}),g.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[g.jsx("button",{className:"tiny-btn",onClick:()=>v("duration",-1),children:"-1"}),g.jsx("input",{type:"number",value:typeof u=="number"?u.toFixed(2):u,onChange:y=>p("duration",parseFloat(y.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("duration",1),children:"+1"}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("duration",.5,!0),children:"/2"}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("duration",2,!0),children:"*2"})]})]})}),o==="bpm"&&g.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:g.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[g.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Beats"}),g.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[g.jsx("button",{className:"tiny-btn",onClick:()=>v("beats",-1),children:"-1"}),g.jsx("input",{type:"number",value:f,onChange:y=>p("beats",parseInt(y.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("beats",1),children:"+1"}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("beats",.5,!0),children:"/2"}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("beats",2,!0),children:"*2"})]})]})}),(o==="timeline"||o==="bpm"||o==="fps")&&g.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:g.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[g.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Speed"}),g.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[g.jsx("button",{className:"tiny-btn",onClick:()=>v("speedMultiplier",-.1),children:"-0.1"}),g.jsx("input",{type:"number",value:typeof h=="number"?h.toFixed(2):h,onChange:y=>p("speedMultiplier",parseFloat(y.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),g.jsx("button",{className:"tiny-btn",onClick:()=>v("speedMultiplier",.1),children:"+0.1"})]})]})})]})},kl=(a,n,r)=>{let i,o,u;const f=Math.floor(a*6),h=a*6-f,p=r*(1-n),v=r*(1-h*n),y=r*(1-(1-h)*n);switch(f%6){case 0:i=r,o=y,u=p;break;case 1:i=v,o=r,u=p;break;case 2:i=p,o=r,u=y;break;case 3:i=p,o=v,u=r;break;case 4:i=y,o=p,u=r;break;case 5:i=r,o=p,u=v;break}const S=b=>{const x=Math.round(b*255).toString(16);return x.length===1?"0"+x:x};return`#${S(i)}${S(o)}${S(u)}`},F0=a=>{let n=parseInt(a.slice(1,3),16)/255,r=parseInt(a.slice(3,5),16)/255,i=parseInt(a.slice(5,7),16)/255,o=Math.max(n,r,i),u=Math.min(n,r,i),f,h,p=o,v=o-u;if(h=o===0?0:v/o,o===u)f=0;else{switch(o){case n:f=(r-i)/v+(r<i?6:0);break;case r:f=(i-n)/v+2;break;case i:f=(n-r)/v+4;break}f/=6}return{h:f,s:h,v:p}},j0=({color:a="#ffffff",onChange:n})=>{const r=T.useRef(null),[i,o]=T.useState(()=>F0(a)),[u,f]=T.useState(!1);T.useEffect(()=>{const y=F0(a);kl(y.h,y.s,y.v)!==kl(i.h,i.s,i.v)&&o(y)},[a]);const h=T.useCallback(()=>{const y=r.current;if(!y)return;const S=y.getContext("2d"),b=y.width,x=y.height;S.fillStyle=kl(i.h,1,1),S.fillRect(0,0,b,x);const E=S.createLinearGradient(0,0,b,0);E.addColorStop(0,"rgba(255,255,255,1)"),E.addColorStop(1,"rgba(255,255,255,0)"),S.fillStyle=E,S.fillRect(0,0,b,x);const A=S.createLinearGradient(0,0,0,x);A.addColorStop(0,"rgba(0,0,0,0)"),A.addColorStop(1,"rgba(0,0,0,1)"),S.fillStyle=A,S.fillRect(0,0,b,x);const D=i.s*b,F=(1-i.v)*x;S.strokeStyle=i.v>.5?"#000":"#fff",S.lineWidth=2,S.beginPath(),S.arc(D,F,5,0,Math.PI*2),S.stroke()},[i]);T.useEffect(()=>{h()},[h]);const p=y=>{const b=r.current.getBoundingClientRect(),x=Math.max(0,Math.min(1,(y.clientX-b.left)/b.width)),E=Math.max(0,Math.min(1,(y.clientY-b.top)/b.height)),A={...i,s:x,v:1-E};o(A),n&&n(kl(A.h,A.s,A.v))},v=y=>{f(!0),p(y)};return T.useEffect(()=>{if(!u)return;const y=b=>p(b),S=()=>f(!1);return window.addEventListener("mousemove",y),window.addEventListener("mouseup",S),()=>{window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",S)}},[u,i]),g.jsxs("div",{className:"custom-color-picker",style:{padding:"5px",background:"#222",borderRadius:"4px"},children:[g.jsx("canvas",{ref:r,width:150,height:100,style:{width:"100%",height:"100px",cursor:"crosshair",borderRadius:"2px"},onMouseDown:v}),g.jsx("div",{className:"hue-slider-container",style:{marginTop:"8px"},children:g.jsx("input",{type:"range",min:"0",max:"1",step:"0.001",value:i.h,onChange:y=>{const S={...i,h:parseFloat(y.target.value)};o(S),n&&n(kl(S.h,S.s,S.v))},style:{width:"100%",height:"10px",appearance:"none",background:"linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%)",borderRadius:"5px"}})})]})},Bm=({control:a,value:n,onChange:r,animSettings:i,onAnimChange:o,effectId:u,context:f,progressRef:h,workerId:p,clipDuration:v,bpm:y,getFftLevels:S,uiState:b,onUpdateUiState:x,paramKey:E})=>{const[A,D]=T.useState(!1),F=!!b?.expandedParams?.[E],R=B=>{x&&x({expandedParams:{...b?.expandedParams||{},[E]:B}})},N=B=>{B.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:a.type,paramName:a.id,effectId:u,min:a.min,max:a.max,step:a.step,...f}))},_=i?.range||[a.min,a.max],M=B=>{o({...i,range:B})},j=B=>{o({range:_,...B})};return g.jsxs("div",{className:`param-editor ${F?"expanded":""}`,onMouseEnter:()=>D(!0),onMouseLeave:()=>D(!1),style:{marginBottom:"8px",display:"grid",gridTemplateColumns:"1fr",gap:"2px"},children:[g.jsx("div",{className:"param-row-label",style:{width:"100%"},children:g.jsx("label",{className:"param-label",draggable:!0,onDragStart:N,style:{fontSize:"11px",color:"#aaa"},children:a.label})}),g.jsxs("div",{className:"param-row-control",style:{display:"grid",gridTemplateColumns:"20px 1fr 60px",gap:"5px",alignItems:"center"},children:[g.jsx("button",{className:`anim-toggle-btn ${F?"active":""}`,style:{visibility:A||F||i?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>R(!F),title:"Animate",children:""}),g.jsx("div",{className:"control-input-wrapper",style:{display:"flex",alignItems:"center",height:"100%"},children:a.type==="range"?g.jsx(Lt,{id:`${u}_${a.id}`,style:{width:"100%"},children:g.jsx(Um,{min:a.min,max:a.max,step:a.step,value:n,rangeValue:_,onChange:r,onRangeChange:M,showRange:F,animSettings:i,progressRef:h,workerId:p,clipDuration:v,bpm:y,getFftLevels:S})}):a.type==="text"?g.jsx("input",{type:"text",value:n,onChange:B=>r(B.target.value),className:"param-text-input"}):a.type==="checkbox"?g.jsx(Lt,{id:`${u}_${a.id}`,children:g.jsx("input",{type:"checkbox",checked:n,onChange:B=>r(B.target.checked),className:"param-checkbox"})}):a.type==="select"?g.jsx("select",{value:n,onChange:B=>r(B.target.value),className:"param-select",children:a.options.map(B=>g.jsx("option",{value:B,children:B},B))}):null}),a.type==="range"&&g.jsx("input",{type:"number",value:typeof n=="number"?n.toFixed(2):n,onChange:B=>r(parseFloat(B.target.value)||0),className:"param-number-input",step:a.step,style:{fontSize:"10px"}})]}),F&&a.type==="range"&&g.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:g.jsx(Im,{animSettings:i,onChange:j})})]})},l1=({customOrder:a=[],assignedDacs:n=[],onChange:r})=>{const[i,o]=T.useState(null),u=a&&a.length>0?a:n.map((p,v)=>({ip:p.ip,channel:p.channel,label:`Ch ${p.channel} (${p.hostName||p.ip})`,originalIndex:v})),f=(p,v)=>{o(u[v])},h=(p,v)=>{p.preventDefault();const y=u[v];if(i===y)return;const S=u.filter(b=>b!==i);S.splice(v,0,i),r(S)};return g.jsxs("div",{className:"custom-order-editor",style:{marginBottom:"10px",padding:"5px",background:"#222",borderRadius:"4px"},children:[g.jsx("label",{style:{fontSize:"10px",color:"#888"},children:"Channel Order (Drag to Sort)"}),g.jsx("ul",{style:{listStyle:"none",padding:0,margin:"5px 0"},children:u.map((p,v)=>g.jsxs("li",{draggable:!0,onDragStart:y=>f(y,v),onDragOver:y=>h(y,v),style:{background:"#333",border:"1px solid #444",padding:"4px",marginBottom:"2px",fontSize:"10px",cursor:"grab",display:"flex",alignItems:"center"},children:[g.jsx("span",{style:{marginRight:"5px",color:"#666"},children:""}),p.label||`Ch ${p.channel} ${p.ip?`(${p.ip})`:""}`]},v))})]})},o1=({effect:a,onParamChange:n,syncSettings:r,onSetParamSync:i,context:o,progressRef:u,workerId:f,clipDuration:h,bpm:p,getFftLevels:v,uiState:y,onUpdateUiState:S})=>{const{mode:b,color:x,paletteColors:E=[],paletteSize:A=4}=a.params,[D,F]=T.useState(0),R=!!y?.showHsv?.[a.instanceId],N=J=>{S&&S({showHsv:{...y?.showHsv||{},[a.instanceId]:J}})},_=J=>{const G=[...E];for(;G.length<16;)G.push("#ffffff");G[D]=J,n("paletteColors",G)},M=Li.find(J=>J.id==="color"),j=J=>{if(!J)return{h:0,s:0,v:1};const G=parseInt(J.slice(1,3),16)/255,V=parseInt(J.slice(3,5),16)/255,X=parseInt(J.slice(5,7),16)/255,Y=Math.max(G,V,X),Q=Math.min(G,V,X);let L,z,ne=Y;const fe=Y-Q;if(z=Y===0?0:fe/Y,Y===Q)L=0;else{switch(Y){case G:L=(V-X)/fe+(V<X?6:0);break;case V:L=(X-G)/fe+2;break;case X:L=(G-V)/fe+4;break}L/=6}return{h:L,s:z,v:ne}},B=J=>{n("color",J);const G=j(J);n("hue",G.h),n("saturation",G.s),n("brightness",G.v)},H=[{name:"RGBY",colors:["#ff0000","#00ff00","#0000ff","#ffff00"]},{name:"CYBER",colors:["#ff00ff","#00ffff","#ffffff","#0000ff"]},{name:"FIRE",colors:["#ff8800","#ff0000","#ffff00","#880000"]},{name:"ICE",colors:["#0000ff","#0088ff","#00ffff","#ffffff"]}],K=J=>{const G=M.paramControls.find(X=>X.id===J);if(!G)return null;const V=`${a.instanceId||a.id}.${G.id}`;return g.jsx(Bm,{control:G,value:a.params[J],onChange:X=>n(J,X),animSettings:r[V],onAnimChange:X=>i(V,X),effectId:a.id,context:o,progressRef:u,workerId:f,clipDuration:h,bpm:p,getFftLevels:v,uiState:y,onUpdateUiState:S,paramKey:V},J)};return g.jsxs("div",{className:"color-effect-editor",children:[K("mode"),b==="solid"&&g.jsxs("div",{style:{marginTop:"10px"},children:[g.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[g.jsx("label",{style:{fontSize:"11px",color:"#aaa"},children:"Pick Color"}),g.jsx("button",{className:`anim-toggle-btn ${R?"active":""}`,style:{background:"none",border:"none",color:R?"var(--theme-color)":"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>N(!R),title:"Advanced HSV Controls",children:""})]}),!R&&g.jsx(j0,{color:x||"#ffffff",onChange:B}),R&&g.jsxs("div",{className:"hsv-sliders",style:{padding:"5px",background:"rgba(0,0,0,0.2)",borderRadius:"4px"},children:[K("hue"),K("saturation"),K("brightness"),g.jsx("div",{style:{marginTop:"5px",height:"10px",borderRadius:"2px",background:x||"#ffffff",border:"1px solid #444"}})]})]}),b==="palette"&&g.jsxs("div",{style:{marginTop:"10px"},children:[K("paletteSize"),K("paletteSpread"),K("cycleSpeed"),K("rainbowOffset"),g.jsx("label",{style:{fontSize:"11px",color:"#aaa",display:"block",margin:"10px 0 5px"},children:"Presets"}),g.jsx("div",{className:"preset-row",style:{display:"flex",gap:"4px",marginBottom:"10px"},children:H.map(J=>g.jsx("button",{onClick:()=>n("paletteColors",J.colors),style:{fontSize:"9px",padding:"2px 5px",background:"#333",color:"#ccc",border:"1px solid #444",borderRadius:"3px",cursor:"pointer"},children:J.name},J.name))}),g.jsx("label",{style:{fontSize:"11px",color:"#aaa",display:"block",margin:"10px 0 5px"},children:"Palette Colors"}),g.jsx("div",{className:"palette-grid",style:{display:"flex",flexWrap:"wrap",gap:"4px",marginBottom:"10px"},children:Array.from({length:A}).map((J,G)=>g.jsx("div",{onClick:()=>F(G),style:{width:"20px",height:"20px",background:E[G]||"#ffffff",border:D===G?"2px solid white":"1px solid #444",borderRadius:"3px",cursor:"pointer",boxSizing:"border-box"}},G))}),g.jsx(j0,{color:E[D]||"#ffffff",onChange:_})]}),b==="rainbow"&&g.jsxs("div",{style:{marginTop:"10px"},children:[K("cycleSpeed"),K("rainbowSpread"),K("rainbowOffset"),K("rainbowPalette")]})]})},Fm=({effect:a,assignedDacs:n=[],onParamChange:r,onRemove:i,syncSettings:o={},onSetParamSync:u,context:f={},progressRef:h,clipDuration:p,bpm:v,getFftLevels:y,uiState:S,onUpdateUiState:b,dragHandle:x})=>{if(!a)return null;const E=Li.find(H=>H.id===a.id);if(!E)return null;const A=a.id==="delay",D=a.id==="chase",F=a.id==="color",R=a.params.enabled!==!1,N=a.params.mode==="channel",_=S?.collapsedEffects||{},M=!!_[a.instanceId],j=H=>{b&&b({collapsedEffects:{..._,[a.instanceId]:H}})},B=H=>{H.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"enabled",label:`${a.name} ON`,...f}))};return g.jsx(Cn,{title:a.name,isCollapsed:M,onToggle:j,dragHandle:x,headerActions:g.jsxs("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(A||D)&&g.jsx("button",{className:"mode-toggle-btn",onClick:()=>r("mode",N?"frame":"channel"),style:{fontSize:"9px",padding:"2px 5px",background:N?"#444":"var(--theme-color)",border:"none",color:"white",borderRadius:"3px",cursor:"pointer"},children:N?"CHANNEL":"FRAME"}),g.jsx(Lt,{id:`${a.id}_blackout`,children:g.jsx("button",{className:`layer-control-button ${R?"":"active"}`,onClick:()=>r("enabled",!R),draggable:!0,onDragStart:B,style:{padding:"2px",background:R?"none":"red",border:"none",color:"white",cursor:"pointer",display:"flex"},title:"Toggle Effect",children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),g.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),g.jsx("button",{className:"remove-effect-btn",onClick:i,children:""})]}),children:F?g.jsx(o1,{effect:a,onParamChange:r,syncSettings:o,onSetParamSync:u,context:f,progressRef:h,workerId:f.workerId,clipDuration:p,bpm:v,getFftLevels:y,uiState:S,onUpdateUiState:b}):g.jsxs(g.Fragment,{children:[A&&g.jsx(g.Fragment,{children:a.params.useCustomOrder&&g.jsx(l1,{customOrder:a.params.customOrder,assignedDacs:n,onChange:H=>r("customOrder",H)})}),E.paramControls.map(H=>{if(A&&["customOrder"].includes(H.id)||H.showIf&&!Object.entries(H.showIf).every(([V,X])=>a.params[V]===X))return null;const K=`${a.instanceId||a.id}.${H.id}`,J=typeof o[K]=="object"?o[K]:{syncMode:o[K]};return g.jsx(Bm,{control:H,value:a.params[H.id],onChange:G=>r(H.id,G),animSettings:J,onAnimChange:G=>u(K,G),effectId:a.id,context:f,progressRef:h,workerId:f.workerId,clipDuration:p,bpm:v,getFftLevels:y,uiState:S,onUpdateUiState:b,paramKey:K},H.id)})]})})},c1=({control:a,value:n,onChange:r,syncSettings:i,onSetParamSync:o,layerIndex:u,colIndex:f,progressRef:h,workerId:p,generatorId:v,clipDuration:y,uiState:S,onUpdateUiState:b})=>{const[x,E]=T.useState(!1),A=`${v}.${a.id}`,D=!!S?.expandedParams?.[A],F=j=>{b&&b({expandedParams:{...S?.expandedParams||{},[A]:j}})},R=j=>{j.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:a.type,paramName:a.id,targetType:"generator",layerIndex:u,colIndex:f,min:a.min,max:a.max,step:a.step}))},N=typeof i[A]=="object"?i[A]:{syncMode:i[A]},_=N?.range||[a.min,a.max],M=j=>{o(A,{...N,range:j})};return g.jsxs("div",{className:`param-editor ${D?"expanded":""}`,onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),style:{marginBottom:"8px"},children:[g.jsx("div",{className:"param-label-row",style:{display:"flex",alignItems:"center"},children:g.jsx("label",{draggable:!0,onDragStart:R,className:"param-label",style:{fontSize:"11px",color:"#aaa",cursor:"grab"},children:a.label})}),g.jsxs("div",{className:"control-row",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[g.jsx("button",{className:`anim-toggle-btn ${D?"active":""}`,style:{visibility:x||D||N?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>F(!D),title:"Animate",children:""}),g.jsx("div",{className:"control-input-wrapper",children:a.type==="range"?g.jsx(Um,{min:a.min,max:a.max,step:a.step,value:n,rangeValue:_,onChange:j=>r(a.id,j),onRangeChange:M,showRange:D,animSettings:N,progressRef:h,workerId:p,clipDuration:y}):a.type==="number"?g.jsx("input",{type:"number",value:n,onChange:j=>r(a.id,parseFloat(j.target.value)||0),className:"param-number-input",step:a.step}):a.type==="text"?g.jsx("input",{type:"text",value:n,onChange:j=>r(a.id,j.target.value),className:"param-text-input"}):a.type==="checkbox"?g.jsx("input",{type:"checkbox",checked:n,onChange:j=>r(a.id,j.target.checked),className:"param-checkbox"}):null}),a.type==="range"&&g.jsx("input",{type:"number",value:typeof n=="number"?n.toFixed(2):n,onChange:j=>r(a.id,parseFloat(j.target.value)||0),className:"param-number-input",step:a.step,style:{width:"100%",fontSize:"10px"}})]}),D&&a.type==="range"&&g.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:g.jsx(Im,{animSettings:N,onChange:j=>o(A,j)})})]})},u1=({selectedGeneratorId:a,selectedGeneratorParams:n,onParameterChange:r,syncSettings:i={},onSetParamSync:o,layerIndex:u,colIndex:f,progressRef:h,workerId:p,clipDuration:v,uiState:y,onUpdateUiState:S})=>{const[b,x]=T.useState([]),[E,A]=T.useState([]),[D,F]=T.useState(!1);if(!a)return g.jsx("div",{className:"generator-settings-panel",children:"No generator selected."});const R=Ff.find(j=>j.id===a);if(!R)return g.jsxs("div",{className:"generator-settings-panel",children:["Generator definition not found for ID: ",a]});const N=y?.collapsedPanels||{},_=j=>{S&&S({collapsedPanels:{...N,generator:j}})};T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getProjectFonts)try{const B=await window.electronAPI.getProjectFonts();A(B)}catch(B){console.error("Failed to load project fonts:",B)}})()},[]);const M=async j=>{const B=j.target.value;if(B==="browse")if(window.electronAPI&&window.electronAPI.showFontFileDialog){const H=await window.electronAPI.showFontFileDialog();H&&r("fontUrl",H)}else console.error("Font file dialog API not available.");else if(B==="load-system"){F(!0);try{const K=(await window.electronAPI.getSystemFonts()).map(J=>({name:J.split(/[\\/]/).pop(),path:J})).sort((J,G)=>J.name.localeCompare(G.name));x(K)}catch(H){console.error("Failed to load system fonts:",H)}F(!1)}else r("fontUrl",B)};return g.jsx(Cn,{title:`${R.name} Settings`,isCollapsed:!!N.generator,onToggle:_,children:R.paramControls.map(j=>{if(j.id==="fontUrl"){const B=n[j.id]||"src/fonts/Geometr415 Blk BT Black.ttf";return g.jsxs("div",{className:"param-editor",children:[g.jsx("label",{className:"param-label",children:j.label}),g.jsxs("div",{className:"font-selector-container",children:[g.jsxs("select",{className:"param-select",onChange:M,value:B,children:[E.length>0?g.jsx("optgroup",{label:"Project Fonts",children:E.map(H=>g.jsx("option",{value:H.path,children:H.name},H.path))}):g.jsx("optgroup",{label:"Default Fonts",children:g.jsx("option",{value:"src/fonts/Geometr415 Blk BT Black.ttf",children:"Geometr415"})}),b.length>0?g.jsx("optgroup",{label:"System Fonts",children:b.map(H=>g.jsx("option",{value:H.path,children:H.name},H.path))}):g.jsx("option",{value:"load-system",children:D?"Loading...":"Load System Fonts..."}),g.jsx("optgroup",{label:"Actions",children:g.jsx("option",{value:"browse",children:"Browse File..."})})]}),g.jsx("span",{className:"font-path-tiny",title:B,children:B.split(/[\\/]/).pop()})]})]},j.id)}return g.jsx(c1,{control:j,value:n[j.id],onChange:r,syncSettings:i,onSetParamSync:o,layerIndex:u,colIndex:f,progressRef:h,workerId:p,generatorId:a,clipDuration:v,uiState:y,onUpdateUiState:S},j.id)})})},f1=({settings:a,onUpdate:n,uiState:r,onUpdateUiState:i})=>{const{mode:o="fps",duration:u=1,beats:f=8,speedMultiplier:h=1,fps:p=60}=a||{},v=r?.collapsedPanels||{},y=x=>{i&&i({collapsedPanels:{...v,playback:x}})},S=x=>{n({mode:x})},b=(x,E,A=!1)=>{let D=a[x]||(x==="beats"?8:x==="fps"?60:1);A?D=E>1?D*2:D/2:D+=E,D<.01&&(D=.01),n({[x]:D})};return g.jsxs(Cn,{title:"Clip Playback",isCollapsed:!!v.playback,onToggle:y,children:[g.jsxs("div",{className:"playback-mode-selector",children:[g.jsx("button",{className:o==="fps"?"active":"button_inactive",onClick:()=>S("fps"),children:"FPS"}),g.jsx("button",{className:o==="timeline"?"active":"button_inactive",onClick:()=>S("timeline"),children:"Timeline"}),g.jsx("button",{className:o==="bpm"?"active":"button_inactive",onClick:()=>S("bpm"),children:"BPM Sync"})]}),g.jsxs("div",{className:"playback-controls",children:[o==="fps"&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"control-group",children:[g.jsx("label",{children:"Speed (FPS)"}),g.jsxs("div",{className:"value-adjuster",children:[g.jsx("button",{onClick:()=>b("fps",-1),children:"-1"}),g.jsx("input",{type:"number",value:p,onChange:x=>n({fps:parseInt(x.target.value)||60})}),g.jsx("button",{onClick:()=>b("fps",1),children:"+1"}),g.jsx("button",{onClick:()=>b("fps",.5,!0),children:"/2"}),g.jsx("button",{onClick:()=>b("fps",2,!0),children:"*2"})]})]}),g.jsxs("div",{className:"control-group",children:[g.jsx("label",{children:"Duration (s) (for effects)"}),g.jsx("div",{className:"value-adjuster",children:g.jsx("input",{type:"number",value:u.toFixed(2),onChange:x=>n({duration:parseFloat(x.target.value)||1})})})]})]}),o==="timeline"&&g.jsxs("div",{className:"control-group",children:[g.jsx("label",{children:"Duration (s)"}),g.jsxs("div",{className:"value-adjuster",children:[g.jsx("button",{onClick:()=>b("duration",-1),children:"-1"}),g.jsx("input",{type:"number",value:u.toFixed(2),onChange:x=>n({duration:parseFloat(x.target.value)||1})}),g.jsx("button",{onClick:()=>b("duration",1),children:"+1"}),g.jsx("button",{onClick:()=>b("duration",.5,!0),children:"/2"}),g.jsx("button",{onClick:()=>b("duration",2,!0),children:"*2"})]})]}),o==="bpm"&&g.jsxs("div",{className:"control-group",children:[g.jsx("label",{children:"Beats"}),g.jsxs("div",{className:"value-adjuster",children:[g.jsx("button",{onClick:()=>b("beats",-1),children:"-1"}),g.jsx("input",{type:"number",value:f,onChange:x=>n({beats:parseInt(x.target.value)||1})}),g.jsx("button",{onClick:()=>b("beats",1),children:"+1"}),g.jsx("button",{onClick:()=>b("beats",.5,!0),children:"/2"}),g.jsx("button",{onClick:()=>b("beats",2,!0),children:"*2"})]})]}),(o==="timeline"||o==="bpm")&&g.jsxs("div",{className:"control-group",children:[g.jsx("label",{children:"Speed Multiplier"}),g.jsxs("div",{className:"value-adjuster",children:[g.jsx("button",{onClick:()=>b("speedMultiplier",-.1),children:"-0.1"}),g.jsx("input",{type:"number",value:h.toFixed(2),onChange:x=>n({speedMultiplier:parseFloat(x.target.value)||1})}),g.jsx("button",{onClick:()=>b("speedMultiplier",.1),children:"+0.1"})]})]})]})]})},jm=T.createContext(),Hl=()=>T.useContext(jm),d1=({children:a})=>{const[n,r]=T.useState(null),[i,o]=T.useState(null),[u,f]=T.useState(null),[h,p]=T.useState({source:"external",lowRange:[20,250],midRange:[250,4e3],highRange:[4e3,2e4],gain:1,holdTime:100,fallTime:500,calculationMode:"average",smoothingTimeConstant:.8}),[v,y]=T.useState({low:0,mid:0,high:0}),S=T.useRef(new Uint8Array(0)),b=T.useRef({low:0,mid:0,high:0}),x=T.useRef({low:0,mid:0,high:0,lastUpdateTime:Date.now(),peakTimes:{low:0,mid:0,high:0}}),[E,A]=T.useState([]),[D,F]=T.useState("default"),[R,N]=T.useState(1),_=T.useRef({}),M=T.useRef({}),j=T.useRef({}),B=T.useCallback(async()=>{try{const Se=(await navigator.mediaDevices.enumerateDevices()).filter(Ee=>Ee.kind==="audiooutput");if(A(Se),window.electronAPI&&window.electronAPI.setAudioDevices){const Ee=Se.map(Xe=>({deviceId:Xe.deviceId,label:Xe.label,groupId:Xe.groupId}));window.electronAPI.setAudioDevices(Ee)}}catch(oe){console.error("Error enumerating audio devices:",oe)}},[]);T.useEffect(()=>{B();let oe;return window.electronAPI&&window.electronAPI.onUpdateAudioDeviceId&&(oe=window.electronAPI.onUpdateAudioDeviceId(Se=>{F(Se)})),navigator.mediaDevices.addEventListener("devicechange",B),()=>{navigator.mediaDevices.removeEventListener("devicechange",B),oe&&oe()}},[B]);const H=T.useCallback(oe=>{if(!n||!i)return null;try{const Se=n.createMediaElementSource(oe);return Se.connect(i),Se.connect(n.destination),Se}catch(Se){return console.warn("MediaElementSource already connected?",Se),null}},[n,i]),K=T.useCallback(async(oe,Se,Ee=1,Xe=!0)=>{if(_.current[oe]&&(_.current[oe].pause(),_.current[oe].src=""),j.current[oe]=Ee,!Se)return;if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(Se))throw new Error(`Audio file not found: ${Se}`);const Ge=new Audio(`file:///${Se}`);if(Ge.volume=Ee*R,D&&Ge.setSinkId)try{await Ge.setSinkId(D)}catch(ct){console.error("Error setting audio sink ID:",ct)}if(_.current[oe]=Ge,n){n.state==="suspended"&&await n.resume();const ct=H(Ge);ct&&(M.current[oe]=ct)}if(Xe)try{await Ge.play()}catch(ct){throw console.error("Error playing audio:",ct),ct}return Ge},[D,H,R,n]),J=T.useCallback(oe=>{N(oe),Object.keys(_.current).forEach(Se=>{const Ee=_.current[Se],Xe=j.current[Se]??1;Ee&&(Ee.volume=oe*Xe)})},[]),G=T.useCallback((oe,Se)=>{j.current[oe]=Se;const Ee=_.current[oe];Ee&&(Ee.volume=Se*R)},[R]),V=T.useCallback(oe=>{if(_.current[oe]&&(_.current[oe].pause(),_.current[oe].src="",delete _.current[oe],M.current[oe])){try{M.current[oe].disconnect()}catch{}delete M.current[oe]}},[]),X=T.useCallback(oe=>{_.current[oe]&&_.current[oe].pause()},[]),Y=T.useCallback(async oe=>{if(_.current[oe]&&_.current[oe].paused)try{await _.current[oe].play()}catch(Se){console.error("Error resuming:",Se)}},[]),Q=T.useCallback(oe=>{const Se=Math.max(.0625,Math.min(oe,16));Object.values(_.current).forEach(Ee=>{try{Ee.playbackRate=Se}catch(Xe){console.warn("Failed to set playbackRate:",Xe)}})},[]),L=T.useCallback(oe=>{_.current[oe]&&(_.current[oe].currentTime=0)},[]),z=T.useCallback((oe,Se)=>{_.current[oe]&&(_.current[oe].currentTime=Se)},[]),ne=T.useCallback(()=>Object.keys(_.current).forEach(V),[V]),fe=T.useCallback(()=>Object.keys(_.current).forEach(X),[X]),U=T.useCallback(()=>Object.keys(_.current).forEach(Y),[Y]),Z=T.useCallback(()=>Object.keys(_.current).forEach(L),[L]),ue=T.useCallback(oe=>{const Se=_.current[oe];return Se?{currentTime:Se.currentTime,duration:Se.duration,paused:Se.paused}:null},[]),be=T.useCallback(async()=>{if(n)return;const oe=new(window.AudioContext||window.webkitAudioContext),Se=oe.createAnalyser();Se.fftSize=2048,Se.smoothingTimeConstant=h.smoothingTimeConstant,S.current=new Uint8Array(Se.frequencyBinCount),oe.state==="suspended"&&await oe.resume(),r(oe),o(Se)},[n,h.smoothingTimeConstant]);return T.useEffect(()=>{const oe=()=>{be(),window.removeEventListener("mousedown",oe),window.removeEventListener("keydown",oe)};return window.addEventListener("mousedown",oe),window.addEventListener("keydown",oe),()=>{window.removeEventListener("mousedown",oe),window.removeEventListener("keydown",oe)}},[be]),T.useEffect(()=>{i&&(i.smoothingTimeConstant=h.smoothingTimeConstant)},[i,h.smoothingTimeConstant]),T.useEffect(()=>{if(!n||!i||h.source!=="external"){u&&(u.disconnect(),f(null));return}let oe=null;return(async()=>{try{n.state==="suspended"&&await n.resume(),oe=await navigator.mediaDevices.getUserMedia({audio:!0});const Ee=n.createMediaStreamSource(oe);Ee.connect(i),f(Ee)}catch(Ee){console.error("Failed to get external audio stream:",Ee)}})(),()=>{oe&&oe.getTracks().forEach(Ee=>Ee.stop())}},[n,i,h.source]),T.useEffect(()=>{if(!i)return;let oe;const Se=()=>{i.getByteFrequencyData(S.current);const Ee=n.sampleRate,Xe=i.frequencyBinCount,Ge=Ee/i.fftSize,ct=te=>{const ft=Math.floor(te[0]/Ge),Dt=Math.floor(te[1]/Ge);if(h.calculationMode==="peak"){let Nt=0;for(let ke=ft;ke<=Dt&&ke<Xe;ke++)S.current[ke]>Nt&&(Nt=S.current[ke]);return Nt/255}else{let Nt=0,ke=0;for(let qe=ft;qe<=Dt&&qe<Xe;qe++)Nt+=S.current[qe],ke++;return ke>0?Nt/ke/255:0}},xn=ct(h.lowRange),St=ct(h.midRange),on=ct(h.highRange),jt=Date.now(),Mn=Math.max(0,jt-x.current.lastUpdateTime);x.current.lastUpdateTime=jt;const Ne=(te,ft)=>{let Dt=te*h.gain;const Nt=x.current[ft],ke=x.current.peakTimes[ft]||0;if(Dt>=Nt)return x.current.peakTimes[ft]=jt,Dt;{if(jt-ke<h.holdTime)return Nt;if(h.fallTime<=0)return 0;const Ln=Mn/h.fallTime,Ut=Nt-Ln;return Math.max(0,isNaN(Ut)?0:Ut)}},ye={low:Ne(xn,"low"),mid:Ne(St,"mid"),high:Ne(on,"high")};b.current=ye,x.current={...ye,lastUpdateTime:jt,peakTimes:x.current.peakTimes},oe=requestAnimationFrame(Se)};return Se(),()=>cancelAnimationFrame(oe)},[n,i,h]),g.jsx(jm.Provider,{value:{audioCtx:n,analyser:i,fftSettings:h,setFftSettings:p,fftLevels:b.current,fftLevelsRef:b,getFftLevels:()=>b.current,connectMediaElement:H,initAudio:be,devices:E,selectedDeviceId:D,setSelectedDeviceId:F,globalVolume:R,setVolume:J,setClipVolume:G,playAudio:K,stopAudio:V,pauseAudio:X,resumeAudio:Y,setPlaybackRate:Q,resetAudio:L,seekAudio:z,stopAllAudio:ne,pauseAllAudio:fe,resumeAllAudio:U,resetAllAudio:Z,getAudioInfo:ue},children:a})},p1=({audioFile:a,layerIndex:n,onSeek:r,onLoadError:i})=>{const o=T.useRef(null),u=T.useRef(null),{audioCtx:f,getAudioInfo:h}=Hl(),[p,v]=T.useState(null),[y,S]=T.useState("rgb(255, 94, 0)"),b=T.useRef(null),x=T.useRef(!1),E=T.useRef([]),A=T.useRef(null),D=T.useCallback(()=>{const M=document.createElement("div");M.style.display="none",M.style.color="var(--theme-color)",document.body.appendChild(M);const j=getComputedStyle(M).color;document.body.removeChild(M),j&&j!=="rgba(0, 0, 0, 0)"&&S(j)},[]);T.useEffect(()=>{D();const M=new MutationObserver(D);return M.observe(document.documentElement,{attributes:!0,attributeFilter:["style","class"]}),()=>M.disconnect()},[D]),T.useEffect(()=>{if(!a?.path||!f)return;let M=!0;const j=async()=>{try{if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(a.path))throw new Error(`File not found: ${a.path}`);const B=await fetch(`file:///${a.path}`);if(!B.ok)throw new Error(`HTTP error! status: ${B.status}`);const H=await B.arrayBuffer();if(!M)return;const K=await f.decodeAudioData(H);if(M){const J=K.getChannelData(0),G=[],V=Math.max(1,Math.floor(J.length/500));for(let X=0;X<J.length;X+=V){let Y=1,Q=-1;for(let L=0;L<V&&X+L<J.length;L++){const z=J[X+L];z<Y&&(Y=z),z>Q&&(Q=z)}G.push({min:Y,max:Q})}E.current=G,A.current=null,v(K)}}catch(B){if(!M)return;console.error("Failed to load/decode audio for waveform:",B),i&&i(B)}};return v(null),j(),()=>{M=!1}},[a,f,i]);const F=T.useCallback((M,j,B,H)=>{const K=E.current;if(!K||K.length===0)return;const J=B/2,G=2,X=G+1;if(!A.current||A.current.width!==j||A.current.height!==B){const Q=document.createElement("canvas");Q.width=j,Q.height=B;const L=Q.getContext("2d");let z=y;y.startsWith("rgb(")&&(z=y.replace("rgb","rgba").replace(")",", 0.2)")),L.fillStyle=z;const ne=Math.ceil(j/X);for(let fe=0;fe<ne;fe++){const U=Math.floor(fe/ne*K.length),Z=K[U],ue=(1+Z.min)*J,be=Math.max(1,(Z.max-Z.min)*J);L.fillRect(fe*X,ue,G,be)}A.current=Q}M.clearRect(0,0,j,B),M.drawImage(A.current,0,0);const Y=j*H;if(Y>0){M.save(),M.beginPath(),M.rect(0,0,Y,B),M.clip(),M.fillStyle=y;const Q=Math.ceil(j/X);for(let L=0;L<Q;L++){const z=L*X;if(z>Y)break;const ne=Math.floor(L/Q*K.length),fe=K[ne],U=(1+fe.min)*J,Z=Math.max(1,(fe.max-fe.min)*J);M.fillRect(z,U,G,Z)}M.restore()}M.fillStyle="#ffffff",M.fillRect(Y,0,1,B)},[y]);T.useEffect(()=>{const M=o.current;if(!M||!p)return;const j=M.getContext("2d"),B=()=>{const H=M.getBoundingClientRect();(M.width!==H.width||M.height!==H.height)&&(M.width=H.width,M.height=H.height,A.current=null);const K=M.width,J=M.height;let G=0;if(n!=null){const V=h(n);V&&V.duration>0&&(G=V.currentTime/V.duration)}F(j,K,J,Math.max(0,Math.min(1,G))),b.current=requestAnimationFrame(B)};return B(),()=>{b.current&&cancelAnimationFrame(b.current)}},[p,n,h,F]);const R=M=>{x.current=!0,_(M),window.addEventListener("mouseup",N),window.addEventListener("mousemove",_)},N=()=>{x.current=!1,window.removeEventListener("mouseup",N),window.removeEventListener("mousemove",_)},_=M=>{if(!o.current||!p)return;const j=o.current.getBoundingClientRect(),B=M.clientX-j.left,H=j.width,J=Math.max(0,Math.min(1,B/H))*p.duration;r&&r(J)};return g.jsx("div",{ref:u,className:"wave-player-container",style:{width:"100%",height:"35px",marginBottom:"10px",background:"transparent",borderRadius:"4px",overflow:"hidden"},onMouseDown:R,children:g.jsx("canvas",{ref:o,style:{width:"100%",height:"100%",display:"block",cursor:"pointer"}})})},h1=({selectedLayerIndex:a,selectedColIndex:n,clip:r,audioInfo:i,bpm:o,getFftLevels:u,onAssignAudio:f,onRemoveAudio:h,onUpdateAudioVolume:p,onUpdatePlaybackSettings:v,onSetParamSync:y,onToggleDacMirror:S,onRemoveDac:b,onRemoveEffect:x,onReorderEffects:E,onAddEffect:A,onParameterChange:D,onGeneratorParameterChange:F,onUpdateClipUiState:R,progressRef:N,onAudioError:_})=>{const[M,j]=T.useState({}),[B,H]=T.useState(null),{seekAudio:K}=Hl(),J=T.useRef(0),G=r?.uiState||{},V=G.collapsedPanels||{},X=(Ne,ye)=>{R&&R(a,n,{collapsedPanels:{...V,[Ne]:ye}})},Y=Gn.useCallback(Ne=>{_&&_(a,n)},[_,a,n]);if(T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(ye=>{j(te=>({...te,[ye.ip]:ye.status}))})},[]),a===null||n===null)return g.jsx("div",{className:"clip-settings-panel settings-panel-base",children:g.jsx("p",{className:"info-text",children:"Select a clip to view settings."})});const Q=Ne=>{Ne.preventDefault(),Ne.stopPropagation();try{const ye=Ne.dataTransfer.getData("application/json");if(!ye)return;const te=JSON.parse(ye);te&&te.type&&A&&A(te)}catch(ye){console.error("Failed to drop effect in ClipSettingsPanel:",ye)}},L=Ne=>{Ne.preventDefault(),Ne.dataTransfer.dropEffect="copy"},z=Ne=>{H(Ne)},ne=(Ne,ye)=>{if(Ne.preventDefault(),B===null||B===ye)return;const te=Date.now();te-J.current<200||(J.current=te,E&&(E(a,n,B,ye),H(ye)))},fe=Ne=>{H(null)},{effects:U=[],assignedDacs:Z=[],playbackSettings:ue={},syncSettings:be={},audioFile:oe=null,audioVolume:Se=1,type:Ee=null,generatorDefinition:Xe=null,currentParams:Ge={},workerId:ct=null}=r||{},xn=U.length>0,St=Ee==="generator"&&!!Xe,on=Z.length>0;let jt=1;if(ue.mode==="timeline")jt=ue.duration||1;else if(ue.mode==="bpm"){const Ne=o||120;jt=(ue.beats||8)*60/Ne}else{const Ne=ue.fps||r?.fps||30;jt=(r?.totalFrames||30)/Ne}const Mn=ct||(Ee==="ilda"?`ilda-${a}-${n}`:Ee==="generator"?`generator-${a}-${n}`:null);return i&&i.duration&&i.currentTime/i.duration*100,g.jsxs("div",{className:"clip-settings-panel settings-panel-base",onDrop:Q,onDragOver:L,children:[g.jsx(Cn,{title:"Audio",isCollapsed:!!V.audio,onToggle:Ne=>X("audio",Ne),children:oe?g.jsxs("div",{className:"assigned-audio-info",style:{position:"relative"},children:[g.jsx("button",{className:"remove-effect-btn",onClick:h,style:{position:"absolute",top:"-5px",right:"-5px",fontSize:"14px"},children:""}),g.jsx("div",{className:"audio-file-name",title:oe.path,style:{paddingRight:"15px",marginBottom:"8px",fontSize:"11px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:oe.name}),g.jsx(p1,{audioFile:oe,audioInfo:i,layerIndex:a,onSeek:Ne=>K(a,Ne),onLoadError:Y}),g.jsxs("div",{className:"audio-volume-control",style:{marginTop:"10px"},children:[g.jsxs("label",{style:{fontSize:"10px",display:"block",marginBottom:"2px"},children:["Volume: ",Math.round(Se*100),"%"]}),g.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:Se,onChange:Ne=>p(a,n,parseFloat(Ne.target.value)),className:"slider_hor",style:{width:"100%",height:"4px"}})]})]}):g.jsx("button",{className:"assign-audio-btn",onClick:f,children:"Assign Audio File"})}),g.jsx(f1,{settings:ue,onUpdate:Ne=>v(a,n,Ne),uiState:G,onUpdateUiState:Ne=>R(a,n,Ne)}),on&&g.jsx(Cn,{title:"Assigned DACs",isCollapsed:!!V.dacs,onToggle:Ne=>X("dacs",Ne),children:g.jsx("ul",{className:"assigned-dacs-list",children:Z.map((Ne,ye)=>{const te=M[Ne.ip];return g.jsxs("li",{className:"assigned-dac-item",children:[g.jsxs("div",{className:"dac-info-block",children:[g.jsxs("span",{className:"dac-name-tiny",children:[Ne.hostName||Ne.ip," - Ch ",Ne.channel]}),te&&g.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",te.playback_state===2?"PLAYING":te.playback_state===1?"PREPARED":"IDLE"," | Buf: ",te.buffer_fullness,te.buffer_capacity?`/${te.buffer_capacity}`:""," | PPS: ",te.point_rate]})]}),g.jsxs("div",{className:"dac-mirror-controls",children:[g.jsx("button",{className:`mirror-btn ${Ne.mirrorX?"active":""}`,onClick:()=>S(a,n,ye,"x"),title:"Mirror X Axis",children:"X"}),g.jsx("button",{className:`mirror-btn ${Ne.mirrorY?"active":""}`,onClick:()=>S(a,n,ye,"y"),title:"Mirror Y Axis",children:"Y"})]}),g.jsx("button",{className:"remove-dac-btn",onClick:()=>b(ye),children:""})]},`${Ne.unitID||Ne.ip}-${Ne.channel}-${ye}`)})})}),St&&g.jsx(u1,{selectedGeneratorId:Xe.id,selectedGeneratorParams:Ge,onParameterChange:F,syncSettings:be,onSetParamSync:y,layerIndex:a,colIndex:n,progressRef:N,workerId:Mn,clipDuration:jt,bpm:o,getFftLevels:u,uiState:G,onUpdateUiState:Ne=>R(a,n,Ne)}),g.jsx(Cn,{title:"Clip Effects",isCollapsed:!!V.effects,onToggle:Ne=>X("effects",Ne),children:g.jsx("div",{className:"clip-effects-list",style:{minHeight:"50px"},onDrop:fe,children:xn?U.map((Ne,ye)=>g.jsx("div",{onDragOver:te=>ne(te,ye),style:{marginBottom:"4px"},children:g.jsx(Fm,{effect:Ne,assignedDacs:Z,syncSettings:be,onSetParamSync:y,context:{layerIndex:a,colIndex:n,effectIndex:ye,targetType:"effect",workerId:Mn},onParamChange:(te,ft)=>D(a,n,ye,te,ft),onRemove:()=>x(a,n,ye),progressRef:N,clipDuration:jt,bpm:o,getFftLevels:u,uiState:G,onUpdateUiState:te=>R(a,n,te),dragHandle:g.jsx("div",{draggable:!0,onDragStart:()=>z(ye),style:{cursor:"grab",marginRight:"5px",display:"flex",alignItems:"center",color:"#666"},title:"Drag to reorder",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0M7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0M7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0"})})})})},Ne.instanceId||Ne.id+ye)):g.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},m1=({selectedLayerIndex:a,autopilotMode:n,onAutopilotChange:r,layerEffects:i,assignedDacs:o=[],onToggleDacMirror:u,onRemoveDac:f,onAddEffect:h,onRemoveEffect:p,onParamChange:v,uiState:y,onUpdateUiState:S})=>{const[b,x]=T.useState({}),E=y?.collapsedPanels||{},A=(R,N)=>{S&&S({collapsedPanels:{...E,[R]:N}})};if(T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(N=>{x(_=>({..._,[N.ip]:N.status}))})},[]),a===null)return g.jsx("div",{className:"settings-panel-base",children:g.jsx("p",{className:"info-text",children:"Select a layer to edit settings"})});const D=R=>{R.preventDefault(),R.stopPropagation();try{const N=JSON.parse(R.dataTransfer.getData("application/json"));N&&N.id&&h(N)}catch(N){console.error("Failed to drop effect:",N)}},F=R=>{R.preventDefault(),R.dataTransfer.dropEffect="copy"};return g.jsxs("div",{className:"settings-panel-base",onDrop:D,onDragOver:F,children:[o&&o.length>0&&g.jsx(Cn,{title:"Assigned DACs",isCollapsed:!!E.dacs,onToggle:R=>A("dacs",R),children:g.jsx("ul",{className:"assigned-dacs-list",children:o.map((R,N)=>{const _=b[R.ip];return g.jsxs("li",{className:"assigned-dac-item",children:[g.jsxs("div",{className:"dac-info-block",children:[g.jsxs("span",{className:"dac-name-tiny",children:[R.hostName||R.ip," - Ch ",R.channel]}),_&&g.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",_.playback_state===2?"PLAYING":_.playback_state===1?"PREPARED":"IDLE"," | Buf: ",_.buffer_fullness,_.buffer_capacity?`/${_.buffer_capacity}`:""," | PPS: ",_.point_rate]})]}),g.jsxs("div",{className:"dac-mirror-controls",children:[g.jsx("button",{className:`mirror-btn ${R.mirrorX?"active":""}`,onClick:()=>u(a,N,"x"),title:"Mirror X Axis",children:"X"}),g.jsx("button",{className:`mirror-btn ${R.mirrorY?"active":""}`,onClick:()=>u(a,N,"y"),title:"Mirror Y Axis",children:"Y"})]}),g.jsx("button",{className:"remove-dac-btn",onClick:()=>f(a,N),children:""})]},`${R.unitID||R.ip}-${R.channel}-${N}`)})})}),g.jsx(Cn,{title:`Layer ${a+1} Autopilot`,isCollapsed:!!E.autopilot,onToggle:R=>A("autopilot",R),children:g.jsxs("div",{className:"param-editor",children:[g.jsx("label",{children:"Mode"}),g.jsx("div",{className:"clip-playback-settings",children:g.jsxs("div",{className:"playback-mode-selector",children:[g.jsx("button",{className:n==="off"?"active":"",onClick:()=>r("off"),children:"OFF"}),g.jsx("button",{className:n==="forward"?"active":"",onClick:()=>r("forward"),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-forward-fill",viewBox:"0 0 16 16",children:g.jsx("path",{d:"m9.77 12.11 4.012-2.953a.647.647 0 0 0 0-1.114L9.771 5.09a.644.644 0 0 0-.971.557V6.65H2v3.9h6.8v1.003c0 .505.545.808.97.557"})})}),g.jsx("button",{className:n==="random"?"active":"",onClick:()=>r("random"),children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-shuffle",viewBox:"0 0 16 16",children:[g.jsx("path",{fillRule:"evenodd",d:"M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"}),g.jsx("path",{d:"M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"})]})})]})})]})}),g.jsx(Cn,{title:"Layer Effects",isCollapsed:!!E.effects,onToggle:R=>A("effects",R),children:g.jsx("div",{className:"layer-effects-list",style:{minHeight:"50px"},children:i&&i.length>0?i.map((R,N)=>g.jsx("div",{style:{marginBottom:"4px"},children:g.jsx(Fm,{effect:R,onRemove:()=>p(N),onParamChange:(_,M)=>v(N,_,M),syncSettings:{},onSetParamSync:()=>{},context:{layerIndex:a,colIndex:null,effectIndex:N,targetType:"layerEffect"},uiState:y,onUpdateUiState:S,dragHandle:g.jsx("div",{draggable:!0,onDragStart:_=>{_.dataTransfer.setData("application/json",JSON.stringify({type:"effect-reorder",index:N,layerIndex:a}))},style:{cursor:"grab",marginRight:"5px",display:"flex",alignItems:"center",color:"#666"},title:"Drag to reorder",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0M7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0M7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0"})})})})},R.instanceId||N)):g.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},g1=({message:a,visible:n})=>n?g.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#333",color:"white",padding:"10px 20px",borderRadius:"5px",zIndex:1e3,opacity:n?1:0,transition:"opacity 0.5s ease-in-out"},children:a}):null,Pm=T.createContext(null),Gm=()=>T.useContext(Pm),v1=({children:a,onWorkerMessage:n})=>{const r=T.useRef(null);return r.current===null&&(r.current=new Worker(new URL(""+new URL("rendering.worker-Bh77ljU7.js",import.meta.url).href,import.meta.url),{type:"module"})),T.useEffect(()=>{const i=r.current;return n&&(i.onmessage=n),()=>{i.terminate(),n&&(i.onmessage=null)}},[n]),g.jsx(Pm.Provider,{value:r.current,children:a})},y1=({frame:a,effects:n,showBeamEffect:r,beamAlpha:i,fadeAlpha:o,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:p={},bpm:v=120,clipDuration:y=1,progress:S=0,previewTime:b=0,fftLevels:x={low:0,mid:0,high:0},effectStates:E=null,optimizationEnabled:A=!0,onToggleBeamEffect:D,onCycleDisplayMode:F})=>{const R=T.useRef(null),N=Gm(),_=T.useRef(`ilda-player-${Math.random()}`);return T.useEffect(()=>{const M=R.current;if(!M||!N)return;const j=M.transferControlToOffscreen();return N.postMessage({action:"register",payload:{id:_.current,canvas:j,type:"single",data:{showBeamEffect:r,beamAlpha:i,fadeAlpha:o,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:p,bpm:v,clipDuration:y,progress:S,previewTime:b,fftLevels:x,effectStates:E,optimizationEnabled:A}}},[j]),()=>{N.postMessage({action:"deregister",payload:{id:_.current}})}},[]),T.useEffect(()=>{if(!N)return;const M=a?[a]:[];N.postMessage({action:"update",payload:{id:_.current,data:{ildaFrames:M,effects:n,showBeamEffect:r,beamAlpha:i,fadeAlpha:o,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:p,bpm:v,clipDuration:y,progress:S,previewTime:b,fftLevels:x,effectStates:E,optimizationEnabled:A}}})},[N,a,n,r,i,o,u,f,h,p,v,y,S,b,x,E,A]),g.jsxs("div",{className:"ilda-player",children:[g.jsx("h3",{children:"Selected Preview"}),g.jsxs("div",{className:"renderSettingToggle",children:[g.jsx("button",{onClick:D,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),g.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),g.jsx("button",{onClick:F,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),g.jsx("canvas",{ref:R,width:"300",height:"300",style:{backgroundColor:"black"}})]})},b1=Gn.memo(y1),x1=({activeFrames:a,showBeamEffect:n,beamAlpha:r,fadeAlpha:i,previewScanRate:o,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:p,previewTime:v=0,fftLevels:y={low:0,mid:0,high:0},optimizationEnabled:S=!0,onToggleBeamEffect:b,onCycleDisplayMode:x})=>{const E=T.useRef(null),A=Gm(),D=T.useRef(`world-preview-${Math.random()}`);return T.useEffect(()=>{const F=E.current;if(!F||!A)return;const R=F.transferControlToOffscreen();return A.postMessage({action:"register",payload:{id:D.current,canvas:R,type:"world",data:{showBeamEffect:n,beamAlpha:r,fadeAlpha:i,previewScanRate:o,beamRenderMode:u,previewTime:v,fftLevels:y,optimizationEnabled:S}}},[R]),()=>{A.postMessage({action:"deregister",payload:{id:D.current}})}},[]),T.useEffect(()=>{if(!A)return;const F=Object.entries(a).map(([R,{frame:N,effects:_,layerIndex:M,syncSettings:j,bpm:B,clipDuration:H,progress:K,effectStates:J}])=>({frames:[N],effects:_,workerId:R,layerIndex:M,syncSettings:j,bpm:B,clipDuration:H,progress:K,effectStates:J}));A.postMessage({action:"update",payload:{id:D.current,data:{worldData:F,showBeamEffect:n,beamAlpha:r,fadeAlpha:i,previewScanRate:o,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:p,previewTime:v,fftLevels:y,optimizationEnabled:S}}})},[A,a,n,r,i,o,u,f,h,p,v,y,S]),g.jsxs("div",{className:"world-preview",children:[g.jsx("h3",{children:"World Preview"}),g.jsxs("div",{className:"renderSettingToggle",children:[g.jsx("button",{onClick:b,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),g.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),g.jsx("button",{onClick:x,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),g.jsx("canvas",{ref:E,width:"300",height:"300",style:{backgroundColor:"black"}})]})},S1=({bpm:a,onBpmChange:n})=>{const[r,i]=T.useState([]),[o,u]=T.useState(a);T.useEffect(()=>{u(a)},[a]);const f=()=>{const p=Date.now(),v=[...r,p].slice(-4);if(i(v),v.length>=2){const y=[];for(let x=1;x<v.length;x++)y.push(v[x]-v[x-1]);const S=y.reduce((x,E)=>x+E)/y.length,b=Math.round(6e4/S);n(b)}},h=p=>{const v=parseFloat(p.target.value);u(p.target.value),!isNaN(v)&&v>0&&v<999&&n(v)};return g.jsx("div",{className:"bpm-controls",children:g.jsxs("div",{className:"bpm-display",children:[g.jsx(Lt,{id:"bpm_tap",children:g.jsx("button",{className:"bpm-tap-btn",onClick:f,children:"TAP"})}),g.jsxs("div",{className:"bpm-fine-controls",children:[g.jsx(Lt,{id:"bpm_fine_down",children:g.jsx("button",{className:"bpm-fine-btn",onClick:()=>n(Math.max(1,a-.1)),children:"-"})}),g.jsx(Lt,{id:"bpm_value",children:g.jsx("input",{type:"number",className:"bpm-input",value:o,onChange:h,min:"1",max:"999",step:"0.1"})}),g.jsx(Lt,{id:"bpm_fine_up",children:g.jsx("button",{className:"bpm-fine-btn",onClick:()=>n(Math.min(999,a+.1)),children:"+"})})]}),g.jsx("span",{className:"bpm-label",children:"BPM"})]})})},E1=({onPlay:a,onPause:n,onStop:r,isPlaying:i,isStopped:o})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"transport",label:h.toUpperCase()}))};return g.jsxs("div",{className:"transport-controls",children:[g.jsx(Lt,{id:"transport_play",children:g.jsx("button",{className:`speed-control-button ${i?"active":""}`,onClick:a,draggable:!0,onDragStart:f=>u(f,"play"),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-play-fill",viewBox:"0 0 16 16",children:g.jsx("path",{d:"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"})})})}),g.jsx(Lt,{id:"transport_pause",children:g.jsx("button",{className:`speed-control-button ${!i&&!o?"active":""}`,onClick:n,draggable:!0,onDragStart:f=>u(f,"pause"),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-pause-fill",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5m5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5"})})})}),g.jsx(Lt,{id:"transport_stop",children:g.jsx("button",{className:`speed-control-button ${o?"active":""}`,onClick:r,draggable:!0,onDragStart:f=>u(f,"stop"),children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-stop-fill",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"})})})})]})},w1=({value:a,onToggle:n,label:r,onDrop:i,isAssigned:o,onContextMenu:u,className:f,...h})=>{const p=y=>{y.preventDefault(),y.dataTransfer.dropEffect="link"},v=y=>{y.preventDefault();try{const S=y.dataTransfer.getData("application/x-truelazer-param");console.log("[QuickButton] Dropped Data Raw:",S);const b=JSON.parse(S);console.log("[QuickButton] Dropped Data Parsed:",b),b&&(b.type==="toggle"||b.type==="checkbox")?i(b):console.warn("[QuickButton] Invalid data type for button:",b?.type)}catch(S){console.error("[QuickButton] Drop Error:",S)}};return g.jsx("div",{className:`quick-assign-button ${a?"active":""} ${o?"":"unassigned"} ${f||""}`.trim(),style:{cursor:o?"pointer":"default",userSelect:"none",width:"90%",opacity:o?1:.5},onDragOver:p,onDrop:v,onContextMenu:u,...h,onClick:o?n:y=>y.preventDefault(),children:g.jsx("div",{className:"button-label",title:r||"Empty",children:r||"Assign"})})},A1=({assigns:a,onUpdateKnob:n,onToggleButton:r,onAssign:i})=>{const o=(u,f,h)=>{u.preventDefault(),window.electronAPI&&window.electronAPI.showQuickAssignContextMenu&&window.electronAPI.showQuickAssignContextMenu(f,h)};return g.jsxs("div",{className:"global-quick-assigns-panel",children:[g.jsx("div",{className:"quick-assigns-row knobs-row",children:Array.from({length:8}).map((u,f)=>{const h=!!a.knobs[f].link;return g.jsx(Lt,{id:`quick_knob_${f}`,children:g.jsx(Bs,{value:a.knobs[f]?.value||0,label:a.knobs[f]?.label,isAssigned:h,onChange:p=>h&&n(f,p),onContextMenu:p=>o(p,"knob",f),onDrop:p=>{console.log(`[GlobalQuickAssigns] Knob ${f} Drop Data:`,p),i("knob",f,p)}})},`knob-${f}`)})}),g.jsx("div",{className:"quick-assigns-row buttons-row",children:Array.from({length:8}).map((u,f)=>{const h=!!a.buttons[f].link;return g.jsx(Lt,{id:`quick_btn_${f}`,children:g.jsx(w1,{value:a.buttons[f]?.value||!1,label:a.buttons[f]?.label,isAssigned:h,onToggle:()=>r(f),onContextMenu:p=>o(p,"button",f),onDrop:p=>{console.log(`[GlobalQuickAssigns] Button ${f} Drop Data:`,p),i("button",f,p)}})},`btn-${f}`)})})]})},T1=({enabledShortcuts:a={},onOpenOutputSettings:n,quickAssigns:r,onUpdateKnob:i,onToggleButton:o,onAssign:u,renderSettings:f={},onSetRenderSetting:h})=>{const{midiInitialized:p,midiInputs:v,selectedMidiInputId:y,setSelectedMidiInputId:S,isMapping:b,startMapping:x,stopMapping:E,learningId:A,lastMidiEvent:D,setMappings:F,saveMappings:R,exportMappings:N,importMappings:_}=wc(),M=f.settingsPanelCollapsed||{},j=(ke,qe)=>{h&&h("settingsPanelCollapsed",{...M,[ke]:qe})},{artnetInitialized:B,isMapping:H,startMapping:K,stopMapping:J,setMappings:G,saveMappings:V,exportMappings:X,importMappings:Y,lastDmxEvent:Q}=$f()||{},{isMapping:L,startMapping:z,stopMapping:ne,setMappings:fe,saveMappings:U,exportMappings:Z,importMappings:ue}=Wf()||{},[be,oe]=T.useState([]),[Se,Ee]=T.useState(""),[Xe,Ge]=T.useState(!1),[ct,xn]=T.useState(57121),[St,on]=T.useState("127.0.0.1"),[jt,Mn]=T.useState(57120),[Ne,ye]=T.useState(null);T.useEffect(()=>{const ke=async()=>{if(a.artnet)try{const Ut=await window.electronAPI.getArtnetUniverses();oe(Ut),Ut.length>0&&Ee(Ut[0].id)}catch(Ut){console.error("Failed to fetch Art-Net universes:",Ut)}},qe=async()=>{if(a.osc)try{if((await window.electronAPI.initializeOsc({localPort:ct,remoteAddress:St,remotePort:jt})).success)return Ge(!0),window.electronAPI.onOscMessageReceived(({oscMessage:va})=>{ye(va)})}catch(Ut){console.error("Failed to initialize OSC:",Ut)}};let Ln=()=>{};return ke(),qe().then(Ut=>{typeof Ut=="function"&&(Ln=Ut)}),()=>{typeof Ln=="function"&&Ln()}},[a]);const te=ke=>S(ke.target.value),ft=()=>b?E():x(),Dt=()=>H?J():K(),Nt=()=>L?ne():z();return g.jsxs("div",{className:"settings-panel settings-panel-base",children:[g.jsx("div",{className:"settings-card-header",children:g.jsx("h4",{children:"Global Settings"})}),r&&g.jsx(Cn,{title:"Quick Assigns",isCollapsed:!!M.quickAssigns,onToggle:ke=>j("quickAssigns",ke),children:g.jsx(A1,{assigns:r,onUpdateKnob:i,onToggleButton:o,onAssign:u})}),g.jsxs(Cn,{title:"Channel/DAC Settings",isCollapsed:!!M.dacSettings,onToggle:ke=>j("dacSettings",ke),children:[g.jsx("p",{className:"info-text",children:"Output routing and safety zones configuration."}),g.jsx("button",{className:"small-btn",style:{width:"100%",marginTop:"5px"},onClick:n,children:"Open Output Settings"})]}),g.jsxs(Cn,{title:"Processing",isCollapsed:!!M.processing,onToggle:ke=>j("processing",ke),children:[g.jsxs("div",{className:"param-editor",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[g.jsx("label",{className:"param-label",style:{fontSize:"11px"},children:"Point Optimization"}),g.jsx("input",{type:"checkbox",checked:f.optimizationEnabled,onChange:ke=>h("optimizationEnabled",ke.target.checked)})]}),g.jsx("p",{className:"info-text",style:{fontSize:"9px",color:"#666",marginTop:"5px"},children:"Optimizes geometry (interpolation/dwell) before applying effects. Fixes lines in Delay effect but increases point count."})]}),(a.midi||a.artnet||a.osc||a.keyboard)&&g.jsxs("div",{className:"shortcuts-settings-panel",children:[a.keyboard&&g.jsx(Cn,{title:"Keyboard Shortcuts",isCollapsed:!!M.keyboard,onToggle:ke=>j("keyboard",ke),children:g.jsxs("div",{className:"keyboard-config",children:[g.jsxs("div",{className:"button-grid",children:[g.jsx("button",{className:`mapping-btn ${L?"active":""}`,onClick:Nt,style:{backgroundColor:L?"var(--theme-color)":"",gridColumn:"span 2"},children:L?"Stop Mapping":"Start Mapping"}),g.jsx("button",{className:"small-btn",onClick:U,children:"Save Default"}),g.jsx("button",{className:"small-btn",onClick:Z,children:"Export"}),g.jsx("button",{className:"small-btn",onClick:ue,children:"Import"}),g.jsx("button",{className:"small-btn clear",onClick:()=>fe({}),children:"Clear"})]}),g.jsx("p",{className:"info-text",style:{fontSize:"9px",color:"#666",marginTop:"5px"},children:'Assign keys to buttons/sliders by activating "Start Mapping" and clicking a control.'})]})}),a.midi&&g.jsx(Cn,{title:"MIDI Shortcuts",isCollapsed:!!M.midi,onToggle:ke=>j("midi",ke),children:p?g.jsxs("div",{className:"midi-config",children:[g.jsx("select",{className:"param-select",value:y,onChange:te,style:{marginBottom:"8px",width:"100%"},children:v.map(ke=>g.jsx("option",{value:ke.id,children:ke.name},ke.id))}),g.jsxs("div",{className:"button-grid",children:[g.jsx("button",{className:`mapping-btn ${b?"active":""}`,onClick:ft,style:{backgroundColor:b?"var(--theme-color)":"",gridColumn:"span 2"},children:b?"Stop Mapping":"Start Mapping"}),g.jsx("button",{className:"small-btn",onClick:R,children:"Save Default"}),g.jsx("button",{className:"small-btn",onClick:N,children:"Export"}),g.jsx("button",{className:"small-btn",onClick:_,children:"Import"}),g.jsx("button",{className:"small-btn clear",onClick:()=>F({}),children:"Clear"})]}),D&&g.jsxs("div",{className:"last-event-status",children:[D.type," ",D.note||D.controller," (CH",D.channel,")"]})]}):g.jsx("p",{className:"loading-text",children:"Initializing MIDI..."})}),a.artnet&&g.jsx(Cn,{title:"ArtNet Shortcuts",isCollapsed:!!M.artnet,onToggle:ke=>j("artnet",ke),children:B?g.jsxs("div",{className:"artnet-config",children:[g.jsx("select",{className:"param-select",value:Se,onChange:ke=>{Ee(ke.target.value);const qe=parseInt(ke.target.value.replace("universe-",""));window.electronAPI&&window.electronAPI.listenArtnetUniverse&&window.electronAPI.listenArtnetUniverse(qe)},style:{marginBottom:"8px",width:"100%"},children:be.map(ke=>g.jsx("option",{value:ke.id,children:ke.name},ke.id))}),g.jsxs("div",{className:"button-grid",children:[g.jsx("button",{className:`mapping-btn ${H?"active":""}`,onClick:Dt,style:{backgroundColor:H?"var(--theme-color)":"",gridColumn:"span 2"},children:H?"Stop Mapping":"Start Mapping"}),g.jsx("button",{className:"small-btn",onClick:V,children:"Save Default"}),g.jsx("button",{className:"small-btn",onClick:X,children:"Export"}),g.jsx("button",{className:"small-btn",onClick:Y,children:"Import"}),g.jsx("button",{className:"small-btn clear",onClick:()=>G({}),children:"Clear"})]}),Q&&g.jsxs("div",{className:"last-event-status",children:["UNIV ",Q.universe," CH ",Q.channel+1," (Val: ",Q.value,")"]})]}):g.jsx("p",{className:"loading-text",children:"Initializing Art-Net..."})}),a.osc&&g.jsx(Cn,{title:"OSC Shortcuts",isCollapsed:!!M.osc,onToggle:ke=>j("osc",ke),children:g.jsx("div",{className:"osc-config",children:g.jsxs("p",{className:"info-text",children:["Listening on port: ",ct]})})})]})]})},C1=({show:a,title:n,initialValue:r,onSave:i,onClose:o})=>{const[u,f]=T.useState(r||"");if(T.useEffect(()=>{a&&f(r||"")},[a,r]),!a)return null;const h=()=>{i(u),o()},p=v=>{v.key==="Enter"&&h(),v.key==="Escape"&&o()};return g.jsx("div",{className:"shortcuts-modal-overlay",style:{pointerEvents:"auto"},children:g.jsxs("div",{className:"shortcuts-modal-content",style:{maxWidth:"400px"},children:[g.jsx("h3",{children:n||"Rename"}),g.jsxs("div",{className:"settings-section",style:{border:"none"},children:[g.jsx("input",{type:"text",value:u,onChange:v=>f(v.target.value),onKeyDown:p,autoFocus:!0,style:{width:"100%",padding:"8px",backgroundColor:"#1a1a1a",color:"white",border:"1px solid var(--theme-color)",borderRadius:"4px",marginBottom:"15px"}}),g.jsxs("div",{className:"button-row",style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[g.jsx("button",{onClick:o,children:"Cancel"}),g.jsx("button",{onClick:h,style:{backgroundColor:"var(--theme-color)",color:"black"},children:"Save"})]})]})]})})},M1=({safetyZones:a,outputArea:n,testLineY:r,testLineEnabled:i,transformationEnabled:o,transformationMode:u,flipX:f,flipY:h,onUpdateSafetyZones:p,onUpdateOutputArea:v,selectedZoneIndex:y,onSelectZone:S,gridSize:b=20,snapToGrid:x=!1})=>{const E=T.useRef(null),[A,D]=T.useState(null),F=(G,V,X)=>{G.strokeStyle="#333",G.lineWidth=1,G.beginPath();for(let Y=0;Y<=b;Y++){const Q=Y/b,L=Q*V,z=Q*X;G.moveTo(L,0),G.lineTo(L,X),G.moveTo(0,z),G.lineTo(V,z)}G.stroke(),G.strokeStyle="#666",G.lineWidth=2,G.beginPath(),G.moveTo(V/2,0),G.lineTo(V/2,X),G.moveTo(0,X/2),G.lineTo(V,X/2),G.stroke(),G.fillStyle="#aaa",G.font="10px monospace",G.fillText("0,0",5,12),G.fillText("1,0",V-25,12),G.fillText("0,1",5,X-5),G.fillText("1,1",V-25,X-5)},R=(G,V,X,Y=!1,Q=!1)=>{const{x:L,y:z,w:ne,h:fe}=V;if(G.fillStyle=X,G.fillRect(L,z,ne,fe),G.strokeStyle=Y?"#fff":Q?"#0089ff":"#ff0000",G.lineWidth=Y?2:1,G.strokeRect(L,z,ne,fe),Y||Q){G.fillStyle="#fff";const Z=(oe,Se)=>G.fillRect(oe-6/2,Se-6/2,6,6);Z(L,z),Z(L+ne,z),Z(L,z+fe),Z(L+ne,z+fe);const ue=4;G.fillStyle="#ccc";const be=(oe,Se)=>G.fillRect(oe-ue/2,Se-ue/2,ue,ue);be(L+ne/2,z),be(L+ne/2,z+fe),be(L,z+fe/2),be(L+ne,z+fe/2)}},N=()=>{const G=E.current;if(!G)return;const V=G.getContext("2d"),{width:X,height:Y}=G;if(V.clearRect(0,0,X,Y),F(V,X,Y),o&&n&&R(V,{x:n.x*X,y:n.y*Y,w:n.w*X,h:n.h*Y},"rgba(0, 137, 255, 0.2)",!1,!0),a.forEach((Q,L)=>{R(V,{x:Q.x*X,y:Q.y*Y,w:Q.w*X,h:Q.h*Y},"rgba(255, 0, 0, 0.3)",L===y)}),i){let Q=r,L=0,z=1;if(o&&n){if(u==="scale")L=n.x,z=n.x+n.w,Q=n.y+Q*n.h;else if(u==="crop"){if(Q<n.y||Q>n.y+n.h)return;L=Math.max(0,n.x),z=Math.min(1,n.x+n.w)}}const ne=Q*Y,fe=L*X,U=z*X;let Z=[[fe,U]];a&&a.length>0&&a.forEach(ue=>{const be=ue.y*Y,oe=ue.h*Y,Se=ue.x*X,Ee=ue.w*X;if(ne>=be&&ne<=be+oe){const Xe=[];Z.forEach(Ge=>{const[ct,xn]=Ge,St=Se,on=Se+Ee;on<=ct||St>=xn?Xe.push(Ge):(St>ct&&Xe.push([ct,St]),on<xn&&Xe.push([on,xn]))}),Z=Xe}}),V.strokeStyle="#00ff00",V.lineWidth=2,V.beginPath(),Z.forEach(ue=>{V.moveTo(ue[0],ne),V.lineTo(ue[1],ne)}),V.stroke()}};T.useEffect(()=>{N()},[a,n,r,i,o,y,b,f,h]);const _=G=>{const V=E.current.getBoundingClientRect();return{x:(G.clientX-V.left)/V.width,y:(G.clientY-V.top)/V.height}},M=(G,V,X)=>{if(!X)return null;const Y=.03;return Math.abs(G-X.x)<Y&&Math.abs(V-X.y)<Y?"nw":Math.abs(G-(X.x+X.w))<Y&&Math.abs(V-X.y)<Y?"ne":Math.abs(G-X.x)<Y&&Math.abs(V-(X.y+X.h))<Y?"sw":Math.abs(G-(X.x+X.w))<Y&&Math.abs(V-(X.y+X.h))<Y?"se":Math.abs(V-X.y)<Y&&G>=X.x&&G<=X.x+X.w?"n":Math.abs(V-(X.y+X.h))<Y&&G>=X.x&&G<=X.x+X.w?"s":Math.abs(G-X.x)<Y&&V>=X.y&&V<=X.y+X.h?"w":Math.abs(G-(X.x+X.w))<Y&&V>=X.y&&V<=X.y+X.h?"e":null},j=(G,V,X)=>X?G>=X.x&&G<=X.x+X.w&&V>=X.y&&V<=X.y+X.h:!1,B=G=>{const{x:V,y:X}=_(G);if(y!==null&&a[y]){const Y=a[y],Q=M(V,X,Y);if(Q){D({type:"zone",index:y,handle:Q,startX:V,startY:X,originalRect:{...Y}});return}}for(let Y=a.length-1;Y>=0;Y--){const Q=a[Y];if(Q&&j(V,X,Q)){S(Y);const L=M(V,X,Q);D({type:"zone",index:Y,handle:L||"move",startX:V,startY:X,originalRect:{...Q}});return}}if(o&&n){const Y=M(V,X,n);if(Y){D({type:"output",handle:Y,startX:V,startY:X,originalRect:{...n}}),S(null);return}if(j(V,X,n)){D({type:"output",handle:"move",startX:V,startY:X,originalRect:{...n}}),S(null);return}}S(null)},H=G=>{if(!x)return G;const V=1/b;return Math.round(G/V)*V},K=G=>{if(!A)return;const{x:V,y:X}=_(G),Y=V-A.startX,Q=X-A.startY,L=(z,ne,fe,U)=>{let Z={...z};if(ne==="move")Z.x=H(z.x+fe),Z.y=H(z.y+U);else{if(ne.includes("w")){const ue=H(z.x+fe);Z.w=z.x+z.w-ue,Z.x=ue}if(ne.includes("e")){const ue=H(z.x+z.w+fe);Z.w=ue-Z.x}if(ne.includes("n")){const ue=H(z.y+U);Z.h=z.y+z.h-ue,Z.y=ue}if(ne.includes("s")){const ue=H(z.y+z.h+U);Z.h=ue-Z.y}}return Z.w<.01&&(Z.w=.01),Z.h<.01&&(Z.h=.01),Z};if(A.type==="zone"){const z=L(A.originalRect,A.handle,Y,Q);p(A.index,z)}else if(A.type==="output"){const z=L(A.originalRect,A.handle,Y,Q);v(z)}},J=()=>{D(null)};return g.jsx("div",{className:"output-canvas-container",style:{width:"100%",height:"100%"},children:g.jsx("canvas",{ref:E,width:600,height:600,style:{width:"100%",height:"100%",display:"block"},className:"output-canvas",onMouseDown:B,onMouseMove:K,onMouseUp:J,onMouseLeave:J})})},N1=({show:a,onClose:n,dacs:r=[],dacSettings:i={},onUpdateDacSettings:o})=>{const[u,f]=T.useState(null),[h,p]=T.useState(null),[v,y]=T.useState(20),[S,b]=T.useState(!1),x=T.useMemo(()=>{const N=[];return r.forEach(_=>{_.channels&&_.channels.length>0?_.channels.forEach(M=>{N.push({id:`${_.ip}:${M.serviceID}`,displayName:`${_.hostName||_.unitID||"DAC"} : ${M.name||`CH ${M.serviceID}`}`,ip:_.ip,channel:M.serviceID,dacName:_.hostName||_.unitID})}):N.push({id:`${_.ip}:0`,displayName:_.hostName||_.unitID||`DAC ${_.ip}`,ip:_.ip,channel:0,dacName:_.hostName||_.unitID})}),N},[r]);if(T.useEffect(()=>{x.length>0&&!u&&f(x[0].id)},[x,u]),!a)return null;const E=i[u]||{safetyZones:[],outputArea:{x:.1,y:.1,w:.8,h:.8},transformationEnabled:!1,transformationMode:"crop",testLineEnabled:!1,testLineY:.5,flipX:!1,flipY:!1},A=N=>{u&&o(u,{...E,...N})},D=()=>{const N={x:.4,y:.4,w:.2,h:.2};A({safetyZones:[...E.safetyZones,N]}),p(E.safetyZones.length)},F=()=>{A({safetyZones:[]}),p(null)},R=(N,_)=>{const M=[...E.safetyZones];M[N]=_,A({safetyZones:M})};return g.jsx("div",{className:"output-settings-modal-overlay",children:g.jsxs("div",{className:"output-settings-modal-content",children:[g.jsxs("div",{className:"output-settings-header",children:[g.jsx("h2",{children:"Output Settings"}),g.jsx("button",{className:"close-btn",onClick:n,children:"Close"})]}),g.jsxs("div",{className:"output-settings-body",children:[g.jsx("div",{className:"output-settings-col",children:g.jsxs("div",{className:"settings-group",children:[g.jsx("h4",{children:"Available Outputs"}),g.jsxs("ul",{className:"dac-list",children:[x.length===0?g.jsx("li",{style:{color:"#666",fontStyle:"italic"},children:"No Outputs detected"}):null,x.map((N,_)=>g.jsxs("li",{className:`dac-list-item ${u===N.id?"selected":""}`,onClick:()=>f(N.id),children:[g.jsx("span",{style:{fontWeight:"bold",fontSize:"0.9em"},children:N.displayName}),g.jsx("span",{style:{fontSize:"0.7em",color:"#888"},children:N.ip})]},N.id))]})]})}),g.jsxs("div",{className:"output-settings-col canvas-col",children:[g.jsxs("div",{className:"canvas-toolbar",children:[g.jsx("button",{className:"tool-btn",onClick:D,title:"Add Safety Zone",children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-plus-square",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),g.jsx("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})]})}),g.jsx("button",{className:`tool-btn ${E.transformationEnabled?"active":""}`,onClick:()=>A({transformationEnabled:!E.transformationEnabled}),title:"Toggle Output Transformation",children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-border-outer",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M7.5 1.906v.938h1v-.938zm0 1.875v.938h1V3.78h-1zm0 1.875v.938h1v-.938zM1.906 8.5h.938v-1h-.938zm1.875 0h.938v-1H3.78v1zm1.875 0h.938v-1h-.938zm2.813 0v-.031H8.5V7.53h-.031V7.5H7.53v.031H7.5v.938h.031V8.5zm.937 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zM7.5 9.406v.938h1v-.938zm0 1.875v.938h1v-.938zm0 1.875v.938h1v-.938z"}),g.jsx("path",{d:"M0 0v16h16V0zm1 1h14v14H1z"})]})}),g.jsx("button",{className:`tool-btn ${E.testLineEnabled?"active":""}`,onClick:()=>A({testLineEnabled:!E.testLineEnabled}),title:"Toggle Test Line",children:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye",viewBox:"0 0 16 16",children:[g.jsx("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),g.jsx("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})]})}),g.jsx("span",{style:{width:1,background:"#555",margin:"0 5px"}}),g.jsx("button",{className:`tool-btn ${S?"active":""}`,onClick:()=>b(!S),title:"Snap to Grid",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-magnet-fill",viewBox:"0 0 16 16",children:g.jsx("path",{d:"M15 12h-4v3h4zM5 12H1v3h4zM0 8a8 8 0 1 1 16 0v8h-6V8a2 2 0 1 0-4 0v8H0z"})})}),g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginLeft:5},children:[g.jsx("span",{style:{fontSize:10,color:"#aaa"},children:"Grid:"}),g.jsx("input",{type:"number",min:"5",max:"100",value:v,onChange:N=>y(parseInt(N.target.value)),className:"param-number-input",style:{width:40}})]})]}),g.jsx(M1,{safetyZones:E.safetyZones,outputArea:E.outputArea,testLineY:E.testLineY,testLineEnabled:E.testLineEnabled,transformationEnabled:E.transformationEnabled,transformationMode:E.transformationMode,flipX:E.flipX,flipY:E.flipY,onUpdateSafetyZones:R,onUpdateOutputArea:N=>A({outputArea:N}),selectedZoneIndex:h,onSelectZone:p,gridSize:v,snapToGrid:S})]}),g.jsx("div",{className:"output-settings-col",children:u?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"settings-group",children:[g.jsx("h4",{children:"Output Transformation"}),g.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[g.jsx("label",{style:{flex:1},children:"Enable Editing"}),g.jsx("input",{type:"checkbox",checked:E.transformationEnabled,onChange:N=>A({transformationEnabled:N.target.checked})})]}),g.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[g.jsx("label",{style:{flex:1},children:"Flip X"}),g.jsx("input",{type:"checkbox",checked:E.flipX||!1,onChange:N=>A({flipX:N.target.checked})})]}),g.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[g.jsx("label",{style:{flex:1},children:"Flip Y"}),g.jsx("input",{type:"checkbox",checked:E.flipY||!1,onChange:N=>A({flipY:N.target.checked})})]}),E.transformationEnabled&&g.jsxs("div",{className:"control-row",children:[g.jsx("label",{style:{flex:1},children:"Mode"}),g.jsxs("select",{className:"param-select",value:E.transformationMode,onChange:N=>A({transformationMode:N.target.value}),children:[g.jsx("option",{value:"crop",children:"Crop"}),g.jsx("option",{value:"scale",children:"Scale"})]})]})]}),g.jsxs("div",{className:"settings-group",children:[g.jsx("h4",{children:"Safety Zones"}),g.jsxs("div",{className:"control-row",style:{justifyContent:"space-between",marginBottom:5},children:[g.jsx("button",{className:"small-btn",onClick:D,children:"Add New"}),g.jsx("button",{className:"small-btn clear",onClick:F,children:"Clear All"})]}),g.jsx("div",{className:"zone-list",children:E.safetyZones.map((N,_)=>g.jsxs("div",{className:`zone-item ${h===_?"selected":""}`,onClick:()=>p(_),children:[g.jsxs("span",{children:["Zone ",_+1]}),g.jsx("button",{className:"delete-zone-btn",onClick:M=>{M.stopPropagation(),h===_&&p(null);const j=E.safetyZones.filter((B,H)=>H!==_);A({safetyZones:j})},children:""})]},_))}),h!==null&&g.jsxs("div",{style:{marginTop:10,borderTop:"1px solid #333",paddingTop:5},children:[g.jsx("label",{children:"Selected Zone Properties"}),g.jsx("div",{style:{fontSize:"0.8em",color:"#aaa"},children:"Select and drag zone on canvas to resize."})]})]}),g.jsxs("div",{className:"settings-group",children:[g.jsx("h4",{children:"Test Output"}),g.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[g.jsx("label",{style:{flex:1},children:"Enable Test Line"}),g.jsx("input",{type:"checkbox",checked:E.testLineEnabled,onChange:N=>A({testLineEnabled:N.target.checked})})]}),E.testLineEnabled&&g.jsxs("div",{className:"control-row",children:[g.jsx("label",{children:"Y Position"}),g.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:E.testLineY,onChange:N=>A({testLineY:parseFloat(N.target.value)}),className:"param-slider"})]})]})]}):g.jsx("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"Select an Output to configure settings"})})]})]})})},zm=()=>{const a=Hl();return a||{}},R1=({show:a,onClose:n,initialTab:r="output"})=>{const i=Hl(),{fftSettings:o,setFftSettings:u}=i||{},{devices:f,selectedDeviceId:h,setSelectedDeviceId:p,globalVolume:v,setVolume:y}=zm(),[S,b]=T.useState(r);if(Gn.useEffect(()=>{a&&b(r)},[a,r]),!a)return null;if(!o)return g.jsxs("div",{className:"modal-overlay",children:[g.jsxs("div",{className:"modal-content",style:{padding:"20px",color:"red",border:"1px solid red",background:"#222"},children:[g.jsx("h3",{children:"Error"}),g.jsx("p",{children:"Audio Context is not available."}),g.jsx("p",{children:"Please restart the application or report this bug."}),g.jsx("button",{onClick:n,style:{marginTop:"10px",padding:"5px 10px"},children:"Close"})]}),g.jsx("style",{children:`
                    .modal-overlay {
                        position: fixed;
                        top: 0; left: 0; right: 0; bottom: 0;
                        background: rgba(0, 0, 0, 0.7);
                        display: flex; justify-content: center; align-items: center;
                        z-index: 10000;
                    }
                `})]});const x=(E,A,D)=>{const F={...o},R=`${E}Range`;F[R][A]=parseFloat(D),u(F)};return g.jsxs("div",{className:"modal-overlay",children:[g.jsxs("div",{className:"modal-content audio-settings-window",style:{minWidth:"400px"},children:[g.jsxs("div",{className:"modal-header",children:[g.jsx("h3",{children:"Audio Settings"}),g.jsx("button",{className:"close-btn",onClick:n,children:""})]}),g.jsxs("div",{className:"tab-header",style:{display:"flex",gap:"10px",marginBottom:"15px",borderBottom:"1px solid #444"},children:[g.jsx("button",{className:`tab-btn ${S==="output"?"active":""}`,onClick:()=>b("output"),style:{padding:"8px 15px",background:"none",border:"none",color:S==="output"?"var(--theme-color)":"#888",borderBottom:S==="output"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"Audio Output"}),g.jsx("button",{className:`tab-btn ${S==="fft"?"active":""}`,onClick:()=>b("fft"),style:{padding:"8px 15px",background:"none",border:"none",color:S==="fft"?"var(--theme-color)":"#888",borderBottom:S==="fft"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"FFT Settings"})]}),g.jsxs("div",{className:"modal-body",children:[S==="output"&&g.jsxs("div",{className:"audio-output-settings",children:[g.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[g.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Device"}),g.jsx("select",{className:"param-select",value:h,onChange:E=>p(E.target.value),style:{width:"100%",padding:"5px"},children:f.map(E=>g.jsx("option",{value:E.deviceId,children:E.label||`Device ${E.deviceId.slice(0,5)}`},E.deviceId))})]}),g.jsxs("div",{className:"settings-row",style:{textAlign:"center"},children:[g.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Volume"}),g.jsx("div",{style:{display:"flex",justifyContent:"center"},children:g.jsx(Bs,{value:v,onChange:y,label:"MASTER",isAssigned:!0,size:60})})]})]}),S==="fft"&&g.jsxs("div",{className:"fft-settings",children:[g.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[g.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Source"}),g.jsxs("select",{className:"param-select",value:o.source,onChange:E=>u({...o,source:E.target.value}),style:{width:"100%",padding:"5px"},children:[g.jsx("option",{value:"external",children:"External (Microphone/Loopback)"}),g.jsx("option",{value:"clip",children:"Clip FFT (Audio from active clips)"})]})]}),g.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[g.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Calculation Mode"}),g.jsxs("select",{className:"param-select",value:o.calculationMode||"average",onChange:E=>u({...o,calculationMode:E.target.value}),style:{width:"100%",padding:"5px"},children:[g.jsx("option",{value:"average",children:"Average (Smooth)"}),g.jsx("option",{value:"peak",children:"Peak (Transient/Punchy)"})]})]}),g.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[g.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Ranges (Hz)"}),g.jsxs("div",{className:"range-controls",style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"10px",alignItems:"center"},children:[g.jsx("span",{children:"Low:"}),g.jsxs("div",{style:{display:"flex",gap:"5px"},children:[g.jsx("input",{type:"number",value:o.lowRange[0],onChange:E=>x("low",0,E.target.value),style:{width:"60px"}}),g.jsx("span",{children:"-"}),g.jsx("input",{type:"number",value:o.lowRange[1],onChange:E=>x("low",1,E.target.value),style:{width:"60px"}})]}),g.jsx("span",{children:"Mid:"}),g.jsxs("div",{style:{display:"flex",gap:"5px"},children:[g.jsx("input",{type:"number",value:o.midRange[0],onChange:E=>x("mid",0,E.target.value),style:{width:"60px"}}),g.jsx("span",{children:"-"}),g.jsx("input",{type:"number",value:o.midRange[1],onChange:E=>x("mid",1,E.target.value),style:{width:"60px"}})]}),g.jsx("span",{children:"High:"}),g.jsxs("div",{style:{display:"flex",gap:"5px"},children:[g.jsx("input",{type:"number",value:o.highRange[0],onChange:E=>x("high",0,E.target.value),style:{width:"60px"}}),g.jsx("span",{children:"-"}),g.jsx("input",{type:"number",value:o.highRange[1],onChange:E=>x("high",1,E.target.value),style:{width:"60px"}})]})]})]}),g.jsxs("div",{className:"settings-row",style:{display:"flex",justifyContent:"space-around",textAlign:"center"},children:[g.jsxs("div",{children:[g.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"GAIN"}),g.jsx(Bs,{value:o.gain/5,onChange:E=>u({...o,gain:E*5}),isAssigned:!0,size:40})]}),g.jsxs("div",{children:[g.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"SMOOTH"}),g.jsx(Bs,{value:o.smoothingTimeConstant||.8,onChange:E=>u({...o,smoothingTimeConstant:E}),isAssigned:!0,size:40})]}),g.jsxs("div",{children:[g.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"HOLD"}),g.jsx(Bs,{value:o.holdTime/1e3,onChange:E=>u({...o,holdTime:E*1e3}),isAssigned:!0,size:40})]}),g.jsxs("div",{children:[g.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"FALL"}),g.jsx(Bs,{value:o.fallTime/2e3,onChange:E=>u({...o,fallTime:E*2e3}),isAssigned:!0,size:40})]})]})]})]})]}),g.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .param-select, input {
                    background: #111;
                    border: 1px solid #444;
                    color: white;
                    border-radius: 4px;
                }
            `})]})},D1=({missingFiles:a,onRelocate:n,onClose:r})=>!a||a.length===0?null:g.jsxs("div",{className:"modal-overlay",children:[g.jsxs("div",{className:"modal-content",style:{width:"500px",maxHeight:"80vh",display:"flex",flexDirection:"column"},children:[g.jsxs("div",{className:"modal-header",children:[g.jsx("h3",{children:"Missing Files"}),g.jsx("button",{className:"close-btn",onClick:r,children:""})]}),g.jsxs("div",{className:"modal-body",style:{overflowY:"auto",flex:1},children:[g.jsx("p",{style:{marginBottom:"15px",color:"#ccc",fontSize:"0.9em"},children:"The following files could not be found. Please locate one of them to update the path for all matching files in the same directory."}),g.jsx("ul",{style:{listStyle:"none",padding:0},children:a.map((i,o)=>g.jsxs("li",{style:{background:"#333",padding:"10px",marginBottom:"5px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs("div",{style:{overflow:"hidden"},children:[g.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9em"},children:i.fileName}),g.jsx("div",{style:{fontSize:"0.8em",color:"#888",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"350px"},children:i.filePath})]}),g.jsx("button",{className:"small-btn",onClick:()=>n(i),style:{marginLeft:"10px",whiteSpace:"nowrap"},children:"Locate"})]},o))})]})]}),g.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex; justify-content: center; align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .small-btn {
                    background: var(--theme-color);
                    color: black;
                    border: none;
                    padding: 5px 10px;
                    border-radius: 3px;
                    cursor: pointer;
                    font-weight: bold;
                }
                .small-btn:hover {
                    opacity: 0.9;
                }
            `})]});class _1 extends Gn.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){return this.state.hasError?g.jsx("h1",{children:"Something went wrong."}):this.props.children}}const Hm=T.createContext(null),k1=()=>T.useContext(Hm),O1=({children:a})=>{const[n,r]=T.useState(null);return T.useEffect(()=>{if(!n){const i=new Worker(new URL(""+new URL("ilda-parser.worker-XXY4JEks.js",import.meta.url).href,import.meta.url));r(i)}return()=>{n&&n.terminate()}},[n]),g.jsx(Hm.Provider,{value:n,children:a})},Ym=T.createContext(null),L1=({children:a})=>{const n=T.useMemo(()=>{try{const r=new Worker(new URL(""+new URL("generators.worker-KLOryRgN.js",import.meta.url).href,import.meta.url),{type:"module"});return r.onerror=i=>{console.error("Generator Worker instantiation or internal error:",i)},r}catch(r){return console.error("Failed to create Generator Worker:",r),null}},[]);return T.useEffect(()=>{if(n)return()=>{n.terminate()}},[n]),g.jsx(Ym.Provider,{value:n,children:a})},U1=()=>{const a=T.useContext(Ym);if(a===void 0)throw new Error("useGeneratorWorker must be used within a GeneratorWorkerProvider");return a};var I1=Mm();const B1=Qf(I1),F1=()=>{const{isMapping:a,mappings:n,learningId:r}=wc(),{isMapping:i,mappings:o,learningId:u}=$f()||{},{isMapping:f,mappings:h,learningId:p}=Wf()||{},v=a||i||f,[y,S]=T.useState([]),b=T.useCallback(()=>{if(!v)return;const x=document.querySelectorAll("[data-mappable-id]"),E=Array.from(x).map(A=>{const D=A.getBoundingClientRect();return{id:A.getAttribute("data-mappable-id"),rect:{top:D.top,left:D.left,width:D.width,height:D.height}}});S(E)},[v]);return T.useEffect(()=>{if(v){b(),window.addEventListener("resize",b);const x=setTimeout(b,100);return()=>{window.removeEventListener("resize",b),clearTimeout(x)}}else S([])},[v,b]),v?B1.createPortal(g.jsx("div",{className:"midi-mapping-global-overlay-container",children:y.map(x=>{const E=n[x.id],A=o?o[x.id]:null,D=h?h[x.id]:null,F=a&&r===x.id||i&&u===x.id||f&&p===x.id;let R=null;return a?R=E?E.label:null:i?R=A?A.label:null:f&&(R=D?D.label:null),g.jsx("div",{className:`midi-mapping-label-box ${F?"learning":""} ${R?"mapped":""} ${i?"artnet-mapping":""} ${f?"keyboard-mapping":""}`,style:{position:"fixed",top:x.rect.top,left:x.rect.left,width:x.rect.width,height:x.rect.height,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:g.jsx("div",{className:"mapping-label",children:R||"+"})},x.id)})}),document.body):null};String.prototype.codePointAt||(function(){var a=(function(){try{var r={},i=Object.defineProperty,o=i(r,r,r)&&i}catch{}return o})(),n=function(r){if(this==null)throw TypeError();var i=String(this),o=i.length,u=r?Number(r):0;if(u!=u&&(u=0),!(u<0||u>=o)){var f=i.charCodeAt(u),h;return f>=55296&&f<=56319&&o>u+1&&(h=i.charCodeAt(u+1),h>=56320&&h<=57343)?(f-55296)*1024+h-56320+65536:f}};a?a(String.prototype,"codePointAt",{value:n,configurable:!0,writable:!0}):String.prototype.codePointAt=n})();var ed=0,qm=-3;function jl(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function j1(a,n){this.source=a,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=n,this.destLen=0,this.ltree=new jl,this.dtree=new jl}var Vm=new jl,Xm=new jl,td=new Uint8Array(30),nd=new Uint16Array(30),Qm=new Uint8Array(30),Zm=new Uint16Array(30),P1=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),P0=new jl,Ka=new Uint8Array(320);function $m(a,n,r,i){var o,u;for(o=0;o<r;++o)a[o]=0;for(o=0;o<30-r;++o)a[o+r]=o/r|0;for(u=i,o=0;o<30;++o)n[o]=u,u+=1<<a[o]}function G1(a,n){var r;for(r=0;r<7;++r)a.table[r]=0;for(a.table[7]=24,a.table[8]=152,a.table[9]=112,r=0;r<24;++r)a.trans[r]=256+r;for(r=0;r<144;++r)a.trans[24+r]=r;for(r=0;r<8;++r)a.trans[168+r]=280+r;for(r=0;r<112;++r)a.trans[176+r]=144+r;for(r=0;r<5;++r)n.table[r]=0;for(n.table[5]=32,r=0;r<32;++r)n.trans[r]=r}var G0=new Uint16Array(16);function Tf(a,n,r,i){var o,u;for(o=0;o<16;++o)a.table[o]=0;for(o=0;o<i;++o)a.table[n[r+o]]++;for(a.table[0]=0,u=0,o=0;o<16;++o)G0[o]=u,u+=a.table[o];for(o=0;o<i;++o)n[r+o]&&(a.trans[G0[n[r+o]]++]=o)}function z1(a){a.bitcount--||(a.tag=a.source[a.sourceIndex++],a.bitcount=7);var n=a.tag&1;return a.tag>>>=1,n}function Ja(a,n,r){if(!n)return r;for(;a.bitcount<24;)a.tag|=a.source[a.sourceIndex++]<<a.bitcount,a.bitcount+=8;var i=a.tag&65535>>>16-n;return a.tag>>>=n,a.bitcount-=n,i+r}function jf(a,n){for(;a.bitcount<24;)a.tag|=a.source[a.sourceIndex++]<<a.bitcount,a.bitcount+=8;var r=0,i=0,o=0,u=a.tag;do i=2*i+(u&1),u>>>=1,++o,r+=n.table[o],i-=n.table[o];while(i>=0);return a.tag=u,a.bitcount-=o,n.trans[r+i]}function H1(a,n,r){var i,o,u,f,h,p;for(i=Ja(a,5,257),o=Ja(a,5,1),u=Ja(a,4,4),f=0;f<19;++f)Ka[f]=0;for(f=0;f<u;++f){var v=Ja(a,3,0);Ka[P1[f]]=v}for(Tf(P0,Ka,0,19),h=0;h<i+o;){var y=jf(a,P0);switch(y){case 16:var S=Ka[h-1];for(p=Ja(a,2,3);p;--p)Ka[h++]=S;break;case 17:for(p=Ja(a,3,3);p;--p)Ka[h++]=0;break;case 18:for(p=Ja(a,7,11);p;--p)Ka[h++]=0;break;default:Ka[h++]=y;break}}Tf(n,Ka,0,i),Tf(r,Ka,i,o)}function z0(a,n,r){for(;;){var i=jf(a,n);if(i===256)return ed;if(i<256)a.dest[a.destLen++]=i;else{var o,u,f,h;for(i-=257,o=Ja(a,td[i],nd[i]),u=jf(a,r),f=a.destLen-Ja(a,Qm[u],Zm[u]),h=f;h<f+o;++h)a.dest[a.destLen++]=a.dest[h]}}}function Y1(a){for(var n,r,i;a.bitcount>8;)a.sourceIndex--,a.bitcount-=8;if(n=a.source[a.sourceIndex+1],n=256*n+a.source[a.sourceIndex],r=a.source[a.sourceIndex+3],r=256*r+a.source[a.sourceIndex+2],n!==(~r&65535))return qm;for(a.sourceIndex+=4,i=n;i;--i)a.dest[a.destLen++]=a.source[a.sourceIndex++];return a.bitcount=0,ed}function q1(a,n){var r=new j1(a,n),i,o,u;do{switch(i=z1(r),o=Ja(r,2,0),o){case 0:u=Y1(r);break;case 1:u=z0(r,Vm,Xm);break;case 2:H1(r,r.ltree,r.dtree),u=z0(r,r.ltree,r.dtree);break;default:u=qm}if(u!==ed)throw new Error("Data error")}while(!i);return r.destLen<r.dest.length?typeof r.dest.slice=="function"?r.dest.slice(0,r.destLen):r.dest.subarray(0,r.destLen):r.dest}G1(Vm,Xm);$m(td,nd,4,3);$m(Qm,Zm,2,1);td[28]=0;nd[28]=258;var V1=q1;function _i(a,n,r,i,o){return Math.pow(1-o,3)*a+3*Math.pow(1-o,2)*o*n+3*(1-o)*Math.pow(o,2)*r+Math.pow(o,3)*i}function Cr(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}Cr.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};Cr.prototype.addPoint=function(a,n){typeof a=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),typeof n=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=n,this.y2=n),n<this.y1&&(this.y1=n),n>this.y2&&(this.y2=n))};Cr.prototype.addX=function(a){this.addPoint(a,null)};Cr.prototype.addY=function(a){this.addPoint(null,a)};Cr.prototype.addBezier=function(a,n,r,i,o,u,f,h){var p=[a,n],v=[r,i],y=[o,u],S=[f,h];this.addPoint(a,n),this.addPoint(f,h);for(var b=0;b<=1;b++){var x=6*p[b]-12*v[b]+6*y[b],E=-3*p[b]+9*v[b]-9*y[b]+3*S[b],A=3*v[b]-3*p[b];if(E===0){if(x===0)continue;var D=-A/x;0<D&&D<1&&(b===0&&this.addX(_i(p[b],v[b],y[b],S[b],D)),b===1&&this.addY(_i(p[b],v[b],y[b],S[b],D)));continue}var F=Math.pow(x,2)-4*A*E;if(!(F<0)){var R=(-x+Math.sqrt(F))/(2*E);0<R&&R<1&&(b===0&&this.addX(_i(p[b],v[b],y[b],S[b],R)),b===1&&this.addY(_i(p[b],v[b],y[b],S[b],R)));var N=(-x-Math.sqrt(F))/(2*E);0<N&&N<1&&(b===0&&this.addX(_i(p[b],v[b],y[b],S[b],N)),b===1&&this.addY(_i(p[b],v[b],y[b],S[b],N)))}}};Cr.prototype.addQuad=function(a,n,r,i,o,u){var f=a+.6666666666666666*(r-a),h=n+2/3*(i-n),p=f+1/3*(o-a),v=h+1/3*(u-n);this.addBezier(a,n,f,h,p,v,o,u)};function rn(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}rn.prototype.moveTo=function(a,n){this.commands.push({type:"M",x:a,y:n})};rn.prototype.lineTo=function(a,n){this.commands.push({type:"L",x:a,y:n})};rn.prototype.curveTo=rn.prototype.bezierCurveTo=function(a,n,r,i,o,u){this.commands.push({type:"C",x1:a,y1:n,x2:r,y2:i,x:o,y:u})};rn.prototype.quadTo=rn.prototype.quadraticCurveTo=function(a,n,r,i){this.commands.push({type:"Q",x1:a,y1:n,x:r,y:i})};rn.prototype.close=rn.prototype.closePath=function(){this.commands.push({type:"Z"})};rn.prototype.extend=function(a){if(a.commands)a=a.commands;else if(a instanceof Cr){var n=a;this.moveTo(n.x1,n.y1),this.lineTo(n.x2,n.y1),this.lineTo(n.x2,n.y2),this.lineTo(n.x1,n.y2),this.close();return}Array.prototype.push.apply(this.commands,a)};rn.prototype.getBoundingBox=function(){for(var a=new Cr,n=0,r=0,i=0,o=0,u=0;u<this.commands.length;u++){var f=this.commands[u];switch(f.type){case"M":a.addPoint(f.x,f.y),n=i=f.x,r=o=f.y;break;case"L":a.addPoint(f.x,f.y),i=f.x,o=f.y;break;case"Q":a.addQuad(i,o,f.x1,f.y1,f.x,f.y),i=f.x,o=f.y;break;case"C":a.addBezier(i,o,f.x1,f.y1,f.x2,f.y2,f.x,f.y),i=f.x,o=f.y;break;case"Z":i=n,o=r;break;default:throw new Error("Unexpected path command "+f.type)}}return a.isEmpty()&&a.addPoint(0,0),a};rn.prototype.draw=function(a){a.beginPath();for(var n=0;n<this.commands.length;n+=1){var r=this.commands[n];r.type==="M"?a.moveTo(r.x,r.y):r.type==="L"?a.lineTo(r.x,r.y):r.type==="C"?a.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):r.type==="Q"?a.quadraticCurveTo(r.x1,r.y1,r.x,r.y):r.type==="Z"&&a.closePath()}this.fill&&(a.fillStyle=this.fill,a.fill()),this.stroke&&(a.strokeStyle=this.stroke,a.lineWidth=this.strokeWidth,a.stroke())};rn.prototype.toPathData=function(a){a=a!==void 0?a:2;function n(f){return Math.round(f)===f?""+Math.round(f):f.toFixed(a)}function r(){for(var f=arguments,h="",p=0;p<arguments.length;p+=1){var v=f[p];v>=0&&p>0&&(h+=" "),h+=n(v)}return h}for(var i="",o=0;o<this.commands.length;o+=1){var u=this.commands[o];u.type==="M"?i+="M"+r(u.x,u.y):u.type==="L"?i+="L"+r(u.x,u.y):u.type==="C"?i+="C"+r(u.x1,u.y1,u.x2,u.y2,u.x,u.y):u.type==="Q"?i+="Q"+r(u.x1,u.y1,u.x,u.y):u.type==="Z"&&(i+="Z")}return i};rn.prototype.toSVG=function(a){var n='<path d="';return n+=this.toPathData(a),n+='"',this.fill&&this.fill!=="black"&&(this.fill===null?n+=' fill="none"':n+=' fill="'+this.fill+'"'),this.stroke&&(n+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),n+="/>",n};rn.prototype.toDOMElement=function(a){var n=this.toPathData(a),r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",n),r};function Wm(a){throw new Error(a)}function H0(a,n){a||Wm(n)}var Ze={fail:Wm,argument:H0,assert:H0},Y0=32768,q0=2147483648,Ui={},De={},Ke={};function La(a){return function(){return a}}De.BYTE=function(a){return Ze.argument(a>=0&&a<=255,"Byte value should be between 0 and 255."),[a]};Ke.BYTE=La(1);De.CHAR=function(a){return[a.charCodeAt(0)]};Ke.CHAR=La(1);De.CHARARRAY=function(a){typeof a>"u"&&(a="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var n=[],r=0;r<a.length;r+=1)n[r]=a.charCodeAt(r);return n};Ke.CHARARRAY=function(a){return typeof a>"u"?0:a.length};De.USHORT=function(a){return[a>>8&255,a&255]};Ke.USHORT=La(2);De.SHORT=function(a){return a>=Y0&&(a=-(2*Y0-a)),[a>>8&255,a&255]};Ke.SHORT=La(2);De.UINT24=function(a){return[a>>16&255,a>>8&255,a&255]};Ke.UINT24=La(3);De.ULONG=function(a){return[a>>24&255,a>>16&255,a>>8&255,a&255]};Ke.ULONG=La(4);De.LONG=function(a){return a>=q0&&(a=-(2*q0-a)),[a>>24&255,a>>16&255,a>>8&255,a&255]};Ke.LONG=La(4);De.FIXED=De.ULONG;Ke.FIXED=Ke.ULONG;De.FWORD=De.SHORT;Ke.FWORD=Ke.SHORT;De.UFWORD=De.USHORT;Ke.UFWORD=Ke.USHORT;De.LONGDATETIME=function(a){return[0,0,0,0,a>>24&255,a>>16&255,a>>8&255,a&255]};Ke.LONGDATETIME=La(8);De.TAG=function(a){return Ze.argument(a.length===4,"Tag should be exactly 4 ASCII characters."),[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]};Ke.TAG=La(4);De.Card8=De.BYTE;Ke.Card8=Ke.BYTE;De.Card16=De.USHORT;Ke.Card16=Ke.USHORT;De.OffSize=De.BYTE;Ke.OffSize=Ke.BYTE;De.SID=De.USHORT;Ke.SID=Ke.USHORT;De.NUMBER=function(a){return a>=-107&&a<=107?[a+139]:a>=108&&a<=1131?(a=a-108,[(a>>8)+247,a&255]):a>=-1131&&a<=-108?(a=-a-108,[(a>>8)+251,a&255]):a>=-32768&&a<=32767?De.NUMBER16(a):De.NUMBER32(a)};Ke.NUMBER=function(a){return De.NUMBER(a).length};De.NUMBER16=function(a){return[28,a>>8&255,a&255]};Ke.NUMBER16=La(3);De.NUMBER32=function(a){return[29,a>>24&255,a>>16&255,a>>8&255,a&255]};Ke.NUMBER32=La(5);De.REAL=function(a){var n=a.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(n);if(r){var i=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));n=(Math.round(a*i)/i).toString()}for(var o="",u=0,f=n.length;u<f;u+=1){var h=n[u];h==="e"?o+=n[++u]==="-"?"c":"b":h==="."?o+="a":h==="-"?o+="e":o+=h}o+=o.length&1?"f":"ff";for(var p=[30],v=0,y=o.length;v<y;v+=2)p.push(parseInt(o.substr(v,2),16));return p};Ke.REAL=function(a){return De.REAL(a).length};De.NAME=De.CHARARRAY;Ke.NAME=Ke.CHARARRAY;De.STRING=De.CHARARRAY;Ke.STRING=Ke.CHARARRAY;Ui.UTF8=function(a,n,r){for(var i=[],o=r,u=0;u<o;u++,n+=1)i[u]=a.getUint8(n);return String.fromCharCode.apply(null,i)};Ui.UTF16=function(a,n,r){for(var i=[],o=r/2,u=0;u<o;u++,n+=2)i[u]=a.getUint16(n);return String.fromCharCode.apply(null,i)};De.UTF16=function(a){for(var n=[],r=0;r<a.length;r+=1){var i=a.charCodeAt(r);n[n.length]=i>>8&255,n[n.length]=i&255}return n};Ke.UTF16=function(a){return a.length*2};var Pf={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};Ui.MACSTRING=function(a,n,r,i){var o=Pf[i];if(o!==void 0){for(var u="",f=0;f<r;f++){var h=a.getUint8(n+f);h<=127?u+=String.fromCharCode(h):u+=o[h&127]}return u}};var lc=typeof WeakMap=="function"&&new WeakMap,oc,X1=function(a){if(!oc){oc={};for(var n in Pf)oc[n]=new String(n)}var r=oc[a];if(r!==void 0){if(lc){var i=lc.get(r);if(i!==void 0)return i}var o=Pf[a];if(o!==void 0){for(var u={},f=0;f<o.length;f++)u[o.charCodeAt(f)]=f+128;return lc&&lc.set(r,u),u}}};De.MACSTRING=function(a,n){var r=X1(n);if(r!==void 0){for(var i=[],o=0;o<a.length;o++){var u=a.charCodeAt(o);if(u>=128&&(u=r[u],u===void 0))return;i[o]=u}return i}};Ke.MACSTRING=function(a,n){var r=De.MACSTRING(a,n);return r!==void 0?r.length:0};function Gf(a){return a>=-128&&a<=127}function Q1(a,n,r){for(var i=0,o=a.length;n<o&&i<64&&a[n]===0;)++n,++i;return r.push(128|i-1),n}function Z1(a,n,r){for(var i=0,o=a.length,u=n;u<o&&i<64;){var f=a[u];if(!Gf(f)||f===0&&u+1<o&&a[u+1]===0)break;++u,++i}r.push(i-1);for(var h=n;h<u;++h)r.push(a[h]+256&255);return u}function $1(a,n,r){for(var i=0,o=a.length,u=n;u<o&&i<64;){var f=a[u];if(f===0||Gf(f)&&u+1<o&&Gf(a[u+1]))break;++u,++i}r.push(64|i-1);for(var h=n;h<u;++h){var p=a[h];r.push(p+65536>>8&255,p+256&255)}return u}De.VARDELTAS=function(a){for(var n=0,r=[];n<a.length;){var i=a[n];i===0?n=Q1(a,n,r):i>=-128&&i<=127?n=Z1(a,n,r):n=$1(a,n,r)}return r};De.INDEX=function(a){for(var n=1,r=[n],i=[],o=0;o<a.length;o+=1){var u=De.OBJECT(a[o]);Array.prototype.push.apply(i,u),n+=u.length,r.push(n)}if(i.length===0)return[0,0];for(var f=[],h=1+Math.floor(Math.log(n)/Math.log(2))/8|0,p=[void 0,De.BYTE,De.USHORT,De.UINT24,De.ULONG][h],v=0;v<r.length;v+=1){var y=p(r[v]);Array.prototype.push.apply(f,y)}return Array.prototype.concat(De.Card16(a.length),De.OffSize(h),f,i)};Ke.INDEX=function(a){return De.INDEX(a).length};De.DICT=function(a){for(var n=[],r=Object.keys(a),i=r.length,o=0;o<i;o+=1){var u=parseInt(r[o],0),f=a[u];n=n.concat(De.OPERAND(f.value,f.type)),n=n.concat(De.OPERATOR(u))}return n};Ke.DICT=function(a){return De.DICT(a).length};De.OPERATOR=function(a){return a<1200?[a]:[12,a-1200]};De.OPERAND=function(a,n){var r=[];if(Array.isArray(n))for(var i=0;i<n.length;i+=1)Ze.argument(a.length===n.length,"Not enough arguments given for type"+n),r=r.concat(De.OPERAND(a[i],n[i]));else if(n==="SID")r=r.concat(De.NUMBER(a));else if(n==="offset")r=r.concat(De.NUMBER32(a));else if(n==="number")r=r.concat(De.NUMBER(a));else if(n==="real")r=r.concat(De.REAL(a));else throw new Error("Unknown operand type "+n);return r};De.OP=De.BYTE;Ke.OP=Ke.BYTE;var cc=typeof WeakMap=="function"&&new WeakMap;De.CHARSTRING=function(a){if(cc){var n=cc.get(a);if(n!==void 0)return n}for(var r=[],i=a.length,o=0;o<i;o+=1){var u=a[o];r=r.concat(De[u.type](u.value))}return cc&&cc.set(a,r),r};Ke.CHARSTRING=function(a){return De.CHARSTRING(a).length};De.OBJECT=function(a){var n=De[a.type];return Ze.argument(n!==void 0,"No encoding function for type "+a.type),n(a.value)};Ke.OBJECT=function(a){var n=Ke[a.type];return Ze.argument(n!==void 0,"No sizeOf function for type "+a.type),n(a.value)};De.TABLE=function(a){for(var n=[],r=a.fields.length,i=[],o=[],u=0;u<r;u+=1){var f=a.fields[u],h=De[f.type];Ze.argument(h!==void 0,"No encoding function for field type "+f.type+" ("+f.name+")");var p=a[f.name];p===void 0&&(p=f.value);var v=h(p);f.type==="TABLE"?(o.push(n.length),n=n.concat([0,0]),i.push(v)):n=n.concat(v)}for(var y=0;y<i.length;y+=1){var S=o[y],b=n.length;Ze.argument(b<65536,"Table "+a.tableName+" too big."),n[S]=b>>8,n[S+1]=b&255,n=n.concat(i[y])}return n};Ke.TABLE=function(a){for(var n=0,r=a.fields.length,i=0;i<r;i+=1){var o=a.fields[i],u=Ke[o.type];Ze.argument(u!==void 0,"No sizeOf function for field type "+o.type+" ("+o.name+")");var f=a[o.name];f===void 0&&(f=o.value),n+=u(f),o.type==="TABLE"&&(n+=2)}return n};De.RECORD=De.TABLE;Ke.RECORD=Ke.TABLE;De.LITERAL=function(a){return a};Ke.LITERAL=function(a){return a.length};function hn(a,n,r){if(n.length&&(n[0].name!=="coverageFormat"||n[0].value===1))for(var i=0;i<n.length;i+=1){var o=n[i];this[o.name]=o.value}if(this.tableName=a,this.fields=n,r)for(var u=Object.keys(r),f=0;f<u.length;f+=1){var h=u[f],p=r[h];this[h]!==void 0&&(this[h]=p)}}hn.prototype.encode=function(){return De.TABLE(this)};hn.prototype.sizeOf=function(){return Ke.TABLE(this)};function Pl(a,n,r){r===void 0&&(r=n.length);var i=new Array(n.length+1);i[0]={name:a+"Count",type:"USHORT",value:r};for(var o=0;o<n.length;o++)i[o+1]={name:a+o,type:"USHORT",value:n[o]};return i}function zf(a,n,r){var i=n.length,o=new Array(i+1);o[0]={name:a+"Count",type:"USHORT",value:i};for(var u=0;u<i;u++)o[u+1]={name:a+u,type:"TABLE",value:r(n[u],u)};return o}function Gl(a,n,r){var i=n.length,o=[];o[0]={name:a+"Count",type:"USHORT",value:i};for(var u=0;u<i;u++)o=o.concat(r(n[u],u));return o}function vc(a){a.format===1?hn.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Pl("glyph",a.glyphs))):a.format===2?hn.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(Gl("rangeRecord",a.ranges,function(n){return[{name:"startGlyphID",type:"USHORT",value:n.start},{name:"endGlyphID",type:"USHORT",value:n.end},{name:"startCoverageIndex",type:"USHORT",value:n.index}]}))):Ze.assert(!1,"Coverage format must be 1 or 2.")}vc.prototype=Object.create(hn.prototype);vc.prototype.constructor=vc;function yc(a){hn.call(this,"scriptListTable",Gl("scriptRecord",a,function(n,r){var i=n.script,o=i.defaultLangSys;return Ze.assert(!!o,"Unable to write GSUB: script "+n.tag+" has no default language system."),[{name:"scriptTag"+r,type:"TAG",value:n.tag},{name:"script"+r,type:"TABLE",value:new hn("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new hn("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:o.reqFeatureIndex}].concat(Pl("featureIndex",o.featureIndexes)))}].concat(Gl("langSys",i.langSysRecords,function(u,f){var h=u.langSys;return[{name:"langSysTag"+f,type:"TAG",value:u.tag},{name:"langSys"+f,type:"TABLE",value:new hn("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:h.reqFeatureIndex}].concat(Pl("featureIndex",h.featureIndexes)))}]})))}]}))}yc.prototype=Object.create(hn.prototype);yc.prototype.constructor=yc;function bc(a){hn.call(this,"featureListTable",Gl("featureRecord",a,function(n,r){var i=n.feature;return[{name:"featureTag"+r,type:"TAG",value:n.tag},{name:"feature"+r,type:"TABLE",value:new hn("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(Pl("lookupListIndex",i.lookupListIndexes)))}]}))}bc.prototype=Object.create(hn.prototype);bc.prototype.constructor=bc;function xc(a,n){hn.call(this,"lookupListTable",zf("lookup",a,function(r){var i=n[r.lookupType];return Ze.assert(!!i,"Unable to write GSUB lookup type "+r.lookupType+" tables."),new hn("lookupTable",[{name:"lookupType",type:"USHORT",value:r.lookupType},{name:"lookupFlag",type:"USHORT",value:r.lookupFlag}].concat(zf("subtable",r.subtables,i)))}))}xc.prototype=Object.create(hn.prototype);xc.prototype.constructor=xc;var _e={Table:hn,Record:hn,Coverage:vc,ScriptList:yc,FeatureList:bc,LookupList:xc,ushortList:Pl,tableList:zf,recordList:Gl};function V0(a,n){return a.getUint8(n)}function Sc(a,n){return a.getUint16(n,!1)}function W1(a,n){return a.getInt16(n,!1)}function ad(a,n){return a.getUint32(n,!1)}function Km(a,n){var r=a.getInt16(n,!1),i=a.getUint16(n+2,!1);return r+i/65535}function K1(a,n){for(var r="",i=n;i<n+4;i+=1)r+=String.fromCharCode(a.getInt8(i));return r}function J1(a,n,r){for(var i=0,o=0;o<r;o+=1)i<<=8,i+=a.getUint8(n+o);return i}function eb(a,n,r){for(var i=[],o=n;o<r;o+=1)i.push(a.getUint8(o));return i}function tb(a){for(var n="",r=0;r<a.length;r+=1)n+=String.fromCharCode(a[r]);return n}var nb={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function le(a,n){this.data=a,this.offset=n,this.relativeOffset=0}le.prototype.parseByte=function(){var a=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,a};le.prototype.parseChar=function(){var a=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,a};le.prototype.parseCard8=le.prototype.parseByte;le.prototype.parseUShort=function(){var a=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,a};le.prototype.parseCard16=le.prototype.parseUShort;le.prototype.parseSID=le.prototype.parseUShort;le.prototype.parseOffset16=le.prototype.parseUShort;le.prototype.parseShort=function(){var a=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,a};le.prototype.parseF2Dot14=function(){var a=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,a};le.prototype.parseULong=function(){var a=ad(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,a};le.prototype.parseOffset32=le.prototype.parseULong;le.prototype.parseFixed=function(){var a=Km(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,a};le.prototype.parseString=function(a){var n=this.data,r=this.offset+this.relativeOffset,i="";this.relativeOffset+=a;for(var o=0;o<a;o++)i+=String.fromCharCode(n.getUint8(r+o));return i};le.prototype.parseTag=function(){return this.parseString(4)};le.prototype.parseLongDateTime=function(){var a=ad(this.data,this.offset+this.relativeOffset+4);return a-=2082844800,this.relativeOffset+=8,a};le.prototype.parseVersion=function(a){var n=Sc(this.data,this.offset+this.relativeOffset),r=Sc(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,a===void 0&&(a=4096),n+r/a/10};le.prototype.skip=function(a,n){n===void 0&&(n=1),this.relativeOffset+=nb[a]*n};le.prototype.parseULongList=function(a){a===void 0&&(a=this.parseULong());for(var n=new Array(a),r=this.data,i=this.offset+this.relativeOffset,o=0;o<a;o++)n[o]=r.getUint32(i),i+=4;return this.relativeOffset+=a*4,n};le.prototype.parseOffset16List=le.prototype.parseUShortList=function(a){a===void 0&&(a=this.parseUShort());for(var n=new Array(a),r=this.data,i=this.offset+this.relativeOffset,o=0;o<a;o++)n[o]=r.getUint16(i),i+=2;return this.relativeOffset+=a*2,n};le.prototype.parseShortList=function(a){for(var n=new Array(a),r=this.data,i=this.offset+this.relativeOffset,o=0;o<a;o++)n[o]=r.getInt16(i),i+=2;return this.relativeOffset+=a*2,n};le.prototype.parseByteList=function(a){for(var n=new Array(a),r=this.data,i=this.offset+this.relativeOffset,o=0;o<a;o++)n[o]=r.getUint8(i++);return this.relativeOffset+=a,n};le.prototype.parseList=function(a,n){n||(n=a,a=this.parseUShort());for(var r=new Array(a),i=0;i<a;i++)r[i]=n.call(this);return r};le.prototype.parseList32=function(a,n){n||(n=a,a=this.parseULong());for(var r=new Array(a),i=0;i<a;i++)r[i]=n.call(this);return r};le.prototype.parseRecordList=function(a,n){n||(n=a,a=this.parseUShort());for(var r=new Array(a),i=Object.keys(n),o=0;o<a;o++){for(var u={},f=0;f<i.length;f++){var h=i[f],p=n[h];u[h]=p.call(this)}r[o]=u}return r};le.prototype.parseRecordList32=function(a,n){n||(n=a,a=this.parseULong());for(var r=new Array(a),i=Object.keys(n),o=0;o<a;o++){for(var u={},f=0;f<i.length;f++){var h=i[f],p=n[h];u[h]=p.call(this)}r[o]=u}return r};le.prototype.parseStruct=function(a){if(typeof a=="function")return a.call(this);for(var n=Object.keys(a),r={},i=0;i<n.length;i++){var o=n[i],u=a[o];r[o]=u.call(this)}return r};le.prototype.parseValueRecord=function(a){if(a===void 0&&(a=this.parseUShort()),a!==0){var n={};return a&1&&(n.xPlacement=this.parseShort()),a&2&&(n.yPlacement=this.parseShort()),a&4&&(n.xAdvance=this.parseShort()),a&8&&(n.yAdvance=this.parseShort()),a&16&&(n.xPlaDevice=void 0,this.parseShort()),a&32&&(n.yPlaDevice=void 0,this.parseShort()),a&64&&(n.xAdvDevice=void 0,this.parseShort()),a&128&&(n.yAdvDevice=void 0,this.parseShort()),n}};le.prototype.parseValueRecordList=function(){for(var a=this.parseUShort(),n=this.parseUShort(),r=new Array(n),i=0;i<n;i++)r[i]=this.parseValueRecord(a);return r};le.prototype.parsePointer=function(a){var n=this.parseOffset16();if(n>0)return new le(this.data,this.offset+n).parseStruct(a)};le.prototype.parsePointer32=function(a){var n=this.parseOffset32();if(n>0)return new le(this.data,this.offset+n).parseStruct(a)};le.prototype.parseListOfLists=function(a){for(var n=this.parseOffset16List(),r=n.length,i=this.relativeOffset,o=new Array(r),u=0;u<r;u++){var f=n[u];if(f===0){o[u]=void 0;continue}if(this.relativeOffset=f,a){for(var h=this.parseOffset16List(),p=new Array(h.length),v=0;v<h.length;v++)this.relativeOffset=f+h[v],p[v]=a.call(this);o[u]=p}else o[u]=this.parseUShortList()}return this.relativeOffset=i,o};le.prototype.parseCoverage=function(){var a=this.offset+this.relativeOffset,n=this.parseUShort(),r=this.parseUShort();if(n===1)return{format:1,glyphs:this.parseUShortList(r)};if(n===2){for(var i=new Array(r),o=0;o<r;o++)i[o]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}throw new Error("0x"+a.toString(16)+": Coverage format must be 1 or 2.")};le.prototype.parseClassDef=function(){var a=this.offset+this.relativeOffset,n=this.parseUShort();if(n===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(n===2)return{format:2,ranges:this.parseRecordList({start:le.uShort,end:le.uShort,classId:le.uShort})};throw new Error("0x"+a.toString(16)+": ClassDef format must be 1 or 2.")};le.list=function(a,n){return function(){return this.parseList(a,n)}};le.list32=function(a,n){return function(){return this.parseList32(a,n)}};le.recordList=function(a,n){return function(){return this.parseRecordList(a,n)}};le.recordList32=function(a,n){return function(){return this.parseRecordList32(a,n)}};le.pointer=function(a){return function(){return this.parsePointer(a)}};le.pointer32=function(a){return function(){return this.parsePointer32(a)}};le.tag=le.prototype.parseTag;le.byte=le.prototype.parseByte;le.uShort=le.offset16=le.prototype.parseUShort;le.uShortList=le.prototype.parseUShortList;le.uLong=le.offset32=le.prototype.parseULong;le.uLongList=le.prototype.parseULongList;le.struct=le.prototype.parseStruct;le.coverage=le.prototype.parseCoverage;le.classDef=le.prototype.parseClassDef;var X0={reserved:le.uShort,reqFeatureIndex:le.uShort,featureIndexes:le.uShortList};le.prototype.parseScriptList=function(){return this.parsePointer(le.recordList({tag:le.tag,script:le.pointer({defaultLangSys:le.pointer(X0),langSysRecords:le.recordList({tag:le.tag,langSys:le.pointer(X0)})})}))||[]};le.prototype.parseFeatureList=function(){return this.parsePointer(le.recordList({tag:le.tag,feature:le.pointer({featureParams:le.offset16,lookupListIndexes:le.uShortList})}))||[]};le.prototype.parseLookupList=function(a){return this.parsePointer(le.list(le.pointer(function(){var n=this.parseUShort();Ze.argument(1<=n&&n<=9,"GPOS/GSUB lookup type "+n+" unknown.");var r=this.parseUShort(),i=r&16;return{lookupType:n,lookupFlag:r,subtables:this.parseList(le.pointer(a[n])),markFilteringSet:i?this.parseUShort():void 0}})))||[]};le.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var a=this.parseUShort(),n=this.parseUShort();Ze.argument(a===1&&n<1,"GPOS/GSUB feature variations table unknown.");var r=this.parseRecordList32({conditionSetOffset:le.offset32,featureTableSubstitutionOffset:le.offset32});return r})||[]};var Be={getByte:V0,getCard8:V0,getUShort:Sc,getCard16:Sc,getShort:W1,getULong:ad,getFixed:Km,getTag:K1,getOffset:J1,getBytes:eb,bytesToString:tb,Parser:le};function ab(a,n){n.parseUShort(),a.length=n.parseULong(),a.language=n.parseULong();var r;a.groupCount=r=n.parseULong(),a.glyphIndexMap={};for(var i=0;i<r;i+=1)for(var o=n.parseULong(),u=n.parseULong(),f=n.parseULong(),h=o;h<=u;h+=1)a.glyphIndexMap[h]=f,f++}function rb(a,n,r,i,o){a.length=n.parseUShort(),a.language=n.parseUShort();var u;a.segCount=u=n.parseUShort()>>1,n.skip("uShort",3),a.glyphIndexMap={};for(var f=new Be.Parser(r,i+o+14),h=new Be.Parser(r,i+o+16+u*2),p=new Be.Parser(r,i+o+16+u*4),v=new Be.Parser(r,i+o+16+u*6),y=i+o+16+u*8,S=0;S<u-1;S+=1)for(var b=void 0,x=f.parseUShort(),E=h.parseUShort(),A=p.parseShort(),D=v.parseUShort(),F=E;F<=x;F+=1)D!==0?(y=v.offset+v.relativeOffset-2,y+=D,y+=(F-E)*2,b=Be.getUShort(r,y),b!==0&&(b=b+A&65535)):b=F+A&65535,a.glyphIndexMap[F]=b}function sb(a,n){var r={};r.version=Be.getUShort(a,n),Ze.argument(r.version===0,"cmap table version should be 0."),r.numTables=Be.getUShort(a,n+2);for(var i=-1,o=r.numTables-1;o>=0;o-=1){var u=Be.getUShort(a,n+4+o*8),f=Be.getUShort(a,n+4+o*8+2);if(u===3&&(f===0||f===1||f===10)||u===0&&(f===0||f===1||f===2||f===3||f===4)){i=Be.getULong(a,n+4+o*8+4);break}}if(i===-1)throw new Error("No valid cmap sub-tables found.");var h=new Be.Parser(a,n+i);if(r.format=h.parseUShort(),r.format===12)ab(r,h);else if(r.format===4)rb(r,h,a,n,i);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");return r}function ib(a,n,r){a.segments.push({end:n,start:n,delta:-(n-r),offset:0,glyphIndex:r})}function lb(a){a.segments.push({end:65535,start:65535,delta:1,offset:0})}function ob(a){var n=!0,r;for(r=a.length-1;r>0;r-=1){var i=a.get(r);if(i.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}}var o=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(o=o.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),o=o.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var u=new _e.Table("cmap",o);for(u.segments=[],r=0;r<a.length;r+=1){for(var f=a.get(r),h=0;h<f.unicodes.length;h+=1)ib(u,f.unicodes[h],r);u.segments=u.segments.sort(function(R,N){return R.start-N.start})}lb(u);var p=u.segments.length,v=0,y=[],S=[],b=[],x=[],E=[],A=[];for(r=0;r<p;r+=1){var D=u.segments[r];D.end<=65535&&D.start<=65535?(y=y.concat({name:"end_"+r,type:"USHORT",value:D.end}),S=S.concat({name:"start_"+r,type:"USHORT",value:D.start}),b=b.concat({name:"idDelta_"+r,type:"SHORT",value:D.delta}),x=x.concat({name:"idRangeOffset_"+r,type:"USHORT",value:D.offset}),D.glyphId!==void 0&&(E=E.concat({name:"glyph_"+r,type:"USHORT",value:D.glyphId}))):v+=1,!n&&D.glyphIndex!==void 0&&(A=A.concat({name:"cmap12Start_"+r,type:"ULONG",value:D.start}),A=A.concat({name:"cmap12End_"+r,type:"ULONG",value:D.end}),A=A.concat({name:"cmap12Glyph_"+r,type:"ULONG",value:D.glyphIndex}))}if(u.segCountX2=(p-v)*2,u.searchRange=Math.pow(2,Math.floor(Math.log(p-v)/Math.log(2)))*2,u.entrySelector=Math.log(u.searchRange/2)/Math.log(2),u.rangeShift=u.segCountX2-u.searchRange,u.fields=u.fields.concat(y),u.fields.push({name:"reservedPad",type:"USHORT",value:0}),u.fields=u.fields.concat(S),u.fields=u.fields.concat(b),u.fields=u.fields.concat(x),u.fields=u.fields.concat(E),u.cmap4Length=14+y.length*2+2+S.length*2+b.length*2+x.length*2+E.length*2,!n){var F=16+A.length*4;u.cmap12Offset=20+u.cmap4Length,u.fields=u.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:F},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:A.length/3}]),u.fields=u.fields.concat(A)}return u}var Jm={parse:sb,make:ob},hc=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],cb=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],ub=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Fs=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function eg(a){this.font=a}eg.prototype.charToGlyphIndex=function(a){var n=a.codePointAt(0),r=this.font.glyphs;if(r){for(var i=0;i<r.length;i+=1)for(var o=r.get(i),u=0;u<o.unicodes.length;u+=1)if(o.unicodes[u]===n)return i}return null};function tg(a){this.cmap=a}tg.prototype.charToGlyphIndex=function(a){return this.cmap.glyphIndexMap[a.codePointAt(0)]||0};function Ec(a,n){this.encoding=a,this.charset=n}Ec.prototype.charToGlyphIndex=function(a){var n=a.codePointAt(0),r=this.encoding[n];return this.charset.indexOf(r)};function rd(a){switch(a.version){case 1:this.names=Fs.slice();break;case 2:this.names=new Array(a.numberOfGlyphs);for(var n=0;n<a.numberOfGlyphs;n++)a.glyphNameIndex[n]<Fs.length?this.names[n]=Fs[a.glyphNameIndex[n]]:this.names[n]=a.names[a.glyphNameIndex[n]-Fs.length];break;case 2.5:this.names=new Array(a.numberOfGlyphs);for(var r=0;r<a.numberOfGlyphs;r++)this.names[r]=Fs[r+a.glyphNameIndex[r]];break;case 3:this.names=[];break;default:this.names=[];break}}rd.prototype.nameToGlyphIndex=function(a){return this.names.indexOf(a)};rd.prototype.glyphIndexToName=function(a){return this.names[a]};function fb(a){for(var n,r=a.tables.cmap.glyphIndexMap,i=Object.keys(r),o=0;o<i.length;o+=1){var u=i[o],f=r[u];n=a.glyphs.get(f),n.addUnicode(parseInt(u))}for(var h=0;h<a.glyphs.length;h+=1)n=a.glyphs.get(h),a.cffEncoding?a.isCIDFont?n.name="gid"+h:n.name=a.cffEncoding.charset[h]:a.glyphNames.names&&(n.name=a.glyphNames.glyphIndexToName(h))}function db(a){a._IndexToUnicodeMap={};for(var n=a.tables.cmap.glyphIndexMap,r=Object.keys(n),i=0;i<r.length;i+=1){var o=r[i],u=n[o];a._IndexToUnicodeMap[u]===void 0?a._IndexToUnicodeMap[u]={unicodes:[parseInt(o)]}:a._IndexToUnicodeMap[u].unicodes.push(parseInt(o))}}function pb(a,n){n.lowMemory?db(a):fb(a)}function hb(a,n,r,i,o){a.beginPath(),a.moveTo(n,r),a.lineTo(i,o),a.stroke()}var Is={line:hb};function mb(a,n){var r=n||new rn;return{configurable:!0,get:function(){return typeof r=="function"&&(r=r()),r},set:function(i){r=i}}}function aa(a){this.bindConstructorValues(a)}aa.prototype.bindConstructorValues=function(a){this.index=a.index||0,this.name=a.name||null,this.unicode=a.unicode||void 0,this.unicodes=a.unicodes||a.unicode!==void 0?[a.unicode]:[],"xMin"in a&&(this.xMin=a.xMin),"yMin"in a&&(this.yMin=a.yMin),"xMax"in a&&(this.xMax=a.xMax),"yMax"in a&&(this.yMax=a.yMax),"advanceWidth"in a&&(this.advanceWidth=a.advanceWidth),Object.defineProperty(this,"path",mb(this,a.path))};aa.prototype.addUnicode=function(a){this.unicodes.length===0&&(this.unicode=a),this.unicodes.push(a)};aa.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};aa.prototype.getPath=function(a,n,r,i,o){a=a!==void 0?a:0,n=n!==void 0?n:0,r=r!==void 0?r:72;var u,f;i||(i={});var h=i.xScale,p=i.yScale;if(i.hinting&&o&&o.hinting&&(f=this.path&&o.hinting.exec(this,r)),f)u=o.hinting.getCommands(f),a=Math.round(a),n=Math.round(n),h=p=1;else{u=this.path.commands;var v=1/(this.path.unitsPerEm||1e3)*r;h===void 0&&(h=v),p===void 0&&(p=v)}for(var y=new rn,S=0;S<u.length;S+=1){var b=u[S];b.type==="M"?y.moveTo(a+b.x*h,n+-b.y*p):b.type==="L"?y.lineTo(a+b.x*h,n+-b.y*p):b.type==="Q"?y.quadraticCurveTo(a+b.x1*h,n+-b.y1*p,a+b.x*h,n+-b.y*p):b.type==="C"?y.curveTo(a+b.x1*h,n+-b.y1*p,a+b.x2*h,n+-b.y2*p,a+b.x*h,n+-b.y*p):b.type==="Z"&&y.closePath()}return y};aa.prototype.getContours=function(){if(this.points===void 0)return[];for(var a=[],n=[],r=0;r<this.points.length;r+=1){var i=this.points[r];n.push(i),i.lastPointOfContour&&(a.push(n),n=[])}return Ze.argument(n.length===0,"There are still points left in the current contour."),a};aa.prototype.getMetrics=function(){for(var a=this.path.commands,n=[],r=[],i=0;i<a.length;i+=1){var o=a[i];o.type!=="Z"&&(n.push(o.x),r.push(o.y)),(o.type==="Q"||o.type==="C")&&(n.push(o.x1),r.push(o.y1)),o.type==="C"&&(n.push(o.x2),r.push(o.y2))}var u={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,n),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(u.xMin)||(u.xMin=0),isFinite(u.xMax)||(u.xMax=this.advanceWidth),isFinite(u.yMin)||(u.yMin=0),isFinite(u.yMax)||(u.yMax=0),u.rightSideBearing=this.advanceWidth-u.leftSideBearing-(u.xMax-u.xMin),u};aa.prototype.draw=function(a,n,r,i,o){this.getPath(n,r,i,o).draw(a)};aa.prototype.drawPoints=function(a,n,r,i){function o(S,b,x,E){a.beginPath();for(var A=0;A<S.length;A+=1)a.moveTo(b+S[A].x*E,x+S[A].y*E),a.arc(b+S[A].x*E,x+S[A].y*E,2,0,Math.PI*2,!1);a.closePath(),a.fill()}n=n!==void 0?n:0,r=r!==void 0?r:0,i=i!==void 0?i:24;for(var u=1/this.path.unitsPerEm*i,f=[],h=[],p=this.path,v=0;v<p.commands.length;v+=1){var y=p.commands[v];y.x!==void 0&&f.push({x:y.x,y:-y.y}),y.x1!==void 0&&h.push({x:y.x1,y:-y.y1}),y.x2!==void 0&&h.push({x:y.x2,y:-y.y2})}a.fillStyle="blue",o(f,n,r,u),a.fillStyle="red",o(h,n,r,u)};aa.prototype.drawMetrics=function(a,n,r,i){var o;n=n!==void 0?n:0,r=r!==void 0?r:0,i=i!==void 0?i:24,o=1/this.path.unitsPerEm*i,a.lineWidth=1,a.strokeStyle="black",Is.line(a,n,-1e4,n,1e4),Is.line(a,-1e4,r,1e4,r);var u=this.xMin||0,f=this.yMin||0,h=this.xMax||0,p=this.yMax||0,v=this.advanceWidth||0;a.strokeStyle="blue",Is.line(a,n+u*o,-1e4,n+u*o,1e4),Is.line(a,n+h*o,-1e4,n+h*o,1e4),Is.line(a,-1e4,r+-f*o,1e4,r+-f*o),Is.line(a,-1e4,r+-p*o,1e4,r+-p*o),a.strokeStyle="green",Is.line(a,n+v*o,-1e4,n+v*o,1e4)};function uc(a,n,r){Object.defineProperty(a,n,{get:function(){return a.path,a[r]},set:function(i){a[r]=i},enumerable:!0,configurable:!0})}function sd(a,n){if(this.font=a,this.glyphs={},Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];i.path.unitsPerEm=a.unitsPerEm,this.glyphs[r]=i}this.length=n&&n.length||0}sd.prototype.get=function(a){if(this.glyphs[a]===void 0){this.font._push(a),typeof this.glyphs[a]=="function"&&(this.glyphs[a]=this.glyphs[a]());var n=this.glyphs[a],r=this.font._IndexToUnicodeMap[a];if(r)for(var i=0;i<r.unicodes.length;i++)n.addUnicode(r.unicodes[i]);this.font.cffEncoding?this.font.isCIDFont?n.name="gid"+a:n.name=this.font.cffEncoding.charset[a]:this.font.glyphNames.names&&(n.name=this.font.glyphNames.glyphIndexToName(a)),this.glyphs[a].advanceWidth=this.font._hmtxTableData[a].advanceWidth,this.glyphs[a].leftSideBearing=this.font._hmtxTableData[a].leftSideBearing}else typeof this.glyphs[a]=="function"&&(this.glyphs[a]=this.glyphs[a]());return this.glyphs[a]};sd.prototype.push=function(a,n){this.glyphs[a]=n,this.length++};function gb(a,n){return new aa({index:n,font:a})}function vb(a,n,r,i,o,u){return function(){var f=new aa({index:n,font:a});return f.path=function(){r(f,i,o);var h=u(a.glyphs,f);return h.unitsPerEm=a.unitsPerEm,h},uc(f,"xMin","_xMin"),uc(f,"xMax","_xMax"),uc(f,"yMin","_yMin"),uc(f,"yMax","_yMax"),f}}function yb(a,n,r,i){return function(){var o=new aa({index:n,font:a});return o.path=function(){var u=r(a,o,i);return u.unitsPerEm=a.unitsPerEm,u},o}}var tr={GlyphSet:sd,glyphLoader:gb,ttfGlyphLoader:vb,cffGlyphLoader:yb};function ng(a,n){if(a===n)return!0;if(Array.isArray(a)&&Array.isArray(n)){if(a.length!==n.length)return!1;for(var r=0;r<a.length;r+=1)if(!ng(a[r],n[r]))return!1;return!0}else return!1}function Hf(a){var n;return a.length<1240?n=107:a.length<33900?n=1131:n=32768,n}function ls(a,n,r){var i=[],o=[],u=Be.getCard16(a,n),f,h;if(u!==0){var p=Be.getByte(a,n+2);f=n+(u+1)*p+2;for(var v=n+3,y=0;y<u+1;y+=1)i.push(Be.getOffset(a,v,p)),v+=p;h=f+i[u]}else h=n+2;for(var S=0;S<i.length-1;S+=1){var b=Be.getBytes(a,f+i[S],f+i[S+1]);r&&(b=r(b)),o.push(b)}return{objects:o,startOffset:n,endOffset:h}}function bb(a,n){var r=[],i=Be.getCard16(a,n),o,u;if(i!==0){var f=Be.getByte(a,n+2);o=n+(i+1)*f+2;for(var h=n+3,p=0;p<i+1;p+=1)r.push(Be.getOffset(a,h,f)),h+=f;u=o+r[i]}else u=n+2;return{offsets:r,startOffset:n,endOffset:u}}function xb(a,n,r,i,o){var u=Be.getCard16(r,i),f=0;if(u!==0){var h=Be.getByte(r,i+2);f=i+(u+1)*h+2}var p=Be.getBytes(r,f+n[a],f+n[a+1]);return p}function Sb(a){for(var n="",r=15,i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var o=a.parseByte(),u=o>>4,f=o&15;if(u===r||(n+=i[u],f===r))break;n+=i[f]}return parseFloat(n)}function Eb(a,n){var r,i,o,u;if(n===28)return r=a.parseByte(),i=a.parseByte(),r<<8|i;if(n===29)return r=a.parseByte(),i=a.parseByte(),o=a.parseByte(),u=a.parseByte(),r<<24|i<<16|o<<8|u;if(n===30)return Sb(a);if(n>=32&&n<=246)return n-139;if(n>=247&&n<=250)return r=a.parseByte(),(n-247)*256+r+108;if(n>=251&&n<=254)return r=a.parseByte(),-(n-251)*256-r-108;throw new Error("Invalid b0 "+n)}function wb(a){for(var n={},r=0;r<a.length;r+=1){var i=a[r][0],o=a[r][1],u=void 0;if(o.length===1?u=o[0]:u=o,n.hasOwnProperty(i)&&!isNaN(n[i]))throw new Error("Object "+n+" already has key "+i);n[i]=u}return n}function ag(a,n,r){n=n!==void 0?n:0;var i=new Be.Parser(a,n),o=[],u=[];for(r=r!==void 0?r:a.length;i.relativeOffset<r;){var f=i.parseByte();f<=21?(f===12&&(f=1200+i.parseByte()),o.push([f,u]),u=[]):u.push(Eb(i,f))}return wb(o)}function Ul(a,n){return n<=390?n=hc[n]:n=a[n-391],n}function rg(a,n,r){for(var i={},o,u=0;u<n.length;u+=1){var f=n[u];if(Array.isArray(f.type)){var h=[];h.length=f.type.length;for(var p=0;p<f.type.length;p++)o=a[f.op]!==void 0?a[f.op][p]:void 0,o===void 0&&(o=f.value!==void 0&&f.value[p]!==void 0?f.value[p]:null),f.type[p]==="SID"&&(o=Ul(r,o)),h[p]=o;i[f.name]=h}else o=a[f.op],o===void 0&&(o=f.value!==void 0?f.value:null),f.type==="SID"&&(o=Ul(r,o)),i[f.name]=o}return i}function Ab(a,n){var r={};return r.formatMajor=Be.getCard8(a,n),r.formatMinor=Be.getCard8(a,n+1),r.size=Be.getCard8(a,n+2),r.offsetSize=Be.getCard8(a,n+3),r.startOffset=n,r.endOffset=n+4,r}var sg=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],ig=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Tb(a,n){var r=ag(a,0,a.byteLength);return rg(r,sg,n)}function lg(a,n,r,i){var o=ag(a,n,r);return rg(o,ig,i)}function Q0(a,n,r,i){for(var o=[],u=0;u<r.length;u+=1){var f=new DataView(new Uint8Array(r[u]).buffer),h=Tb(f,i);h._subrs=[],h._subrsBias=0,h._defaultWidthX=0,h._nominalWidthX=0;var p=h.private[0],v=h.private[1];if(p!==0&&v!==0){var y=lg(a,v+n,p,i);if(h._defaultWidthX=y.defaultWidthX,h._nominalWidthX=y.nominalWidthX,y.subrs!==0){var S=v+y.subrs,b=ls(a,S+n);h._subrs=b.objects,h._subrsBias=Hf(h._subrs)}h._privateDict=y}o.push(h)}return o}function Cb(a,n,r,i){var o,u,f=new Be.Parser(a,n);r-=1;var h=[".notdef"],p=f.parseCard8();if(p===0)for(var v=0;v<r;v+=1)o=f.parseSID(),h.push(Ul(i,o));else if(p===1)for(;h.length<=r;){o=f.parseSID(),u=f.parseCard8();for(var y=0;y<=u;y+=1)h.push(Ul(i,o)),o+=1}else if(p===2)for(;h.length<=r;){o=f.parseSID(),u=f.parseCard16();for(var S=0;S<=u;S+=1)h.push(Ul(i,o)),o+=1}else throw new Error("Unknown charset format "+p);return h}function Mb(a,n,r){var i,o={},u=new Be.Parser(a,n),f=u.parseCard8();if(f===0)for(var h=u.parseCard8(),p=0;p<h;p+=1)i=u.parseCard8(),o[i]=p;else if(f===1){var v=u.parseCard8();i=1;for(var y=0;y<v;y+=1)for(var S=u.parseCard8(),b=u.parseCard8(),x=S;x<=S+b;x+=1)o[x]=i,i+=1}else throw new Error("Unknown encoding format "+f);return new Ec(o,r)}function Z0(a,n,r){var i,o,u,f,h=new rn,p=[],v=0,y=!1,S=!1,b=0,x=0,E,A,D,F;if(a.isCIDFont){var R=a.tables.cff.topDict._fdSelect[n.index],N=a.tables.cff.topDict._fdArray[R];E=N._subrs,A=N._subrsBias,D=N._defaultWidthX,F=N._nominalWidthX}else E=a.tables.cff.topDict._subrs,A=a.tables.cff.topDict._subrsBias,D=a.tables.cff.topDict._defaultWidthX,F=a.tables.cff.topDict._nominalWidthX;var _=D;function M(H,K){S&&h.closePath(),h.moveTo(H,K),S=!0}function j(){var H;H=p.length%2!==0,H&&!y&&(_=p.shift()+F),v+=p.length>>1,p.length=0,y=!0}function B(H){for(var K,J,G,V,X,Y,Q,L,z,ne,fe,U,Z=0;Z<H.length;){var ue=H[Z];switch(Z+=1,ue){case 1:j();break;case 3:j();break;case 4:p.length>1&&!y&&(_=p.shift()+F,y=!0),x+=p.pop(),M(b,x);break;case 5:for(;p.length>0;)b+=p.shift(),x+=p.shift(),h.lineTo(b,x);break;case 6:for(;p.length>0&&(b+=p.shift(),h.lineTo(b,x),p.length!==0);)x+=p.shift(),h.lineTo(b,x);break;case 7:for(;p.length>0&&(x+=p.shift(),h.lineTo(b,x),p.length!==0);)b+=p.shift(),h.lineTo(b,x);break;case 8:for(;p.length>0;)i=b+p.shift(),o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),b=u+p.shift(),x=f+p.shift(),h.curveTo(i,o,u,f,b,x);break;case 10:X=p.pop()+A,Y=E[X],Y&&B(Y);break;case 11:return;case 12:switch(ue=H[Z],Z+=1,ue){case 35:i=b+p.shift(),o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),Q=u+p.shift(),L=f+p.shift(),z=Q+p.shift(),ne=L+p.shift(),fe=z+p.shift(),U=ne+p.shift(),b=fe+p.shift(),x=U+p.shift(),p.shift(),h.curveTo(i,o,u,f,Q,L),h.curveTo(z,ne,fe,U,b,x);break;case 34:i=b+p.shift(),o=x,u=i+p.shift(),f=o+p.shift(),Q=u+p.shift(),L=f,z=Q+p.shift(),ne=f,fe=z+p.shift(),U=x,b=fe+p.shift(),h.curveTo(i,o,u,f,Q,L),h.curveTo(z,ne,fe,U,b,x);break;case 36:i=b+p.shift(),o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),Q=u+p.shift(),L=f,z=Q+p.shift(),ne=f,fe=z+p.shift(),U=ne+p.shift(),b=fe+p.shift(),h.curveTo(i,o,u,f,Q,L),h.curveTo(z,ne,fe,U,b,x);break;case 37:i=b+p.shift(),o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),Q=u+p.shift(),L=f+p.shift(),z=Q+p.shift(),ne=L+p.shift(),fe=z+p.shift(),U=ne+p.shift(),Math.abs(fe-b)>Math.abs(U-x)?b=fe+p.shift():x=U+p.shift(),h.curveTo(i,o,u,f,Q,L),h.curveTo(z,ne,fe,U,b,x);break;default:console.log("Glyph "+n.index+": unknown operator 1200"+ue),p.length=0}break;case 14:p.length>0&&!y&&(_=p.shift()+F,y=!0),S&&(h.closePath(),S=!1);break;case 18:j();break;case 19:case 20:j(),Z+=v+7>>3;break;case 21:p.length>2&&!y&&(_=p.shift()+F,y=!0),x+=p.pop(),b+=p.pop(),M(b,x);break;case 22:p.length>1&&!y&&(_=p.shift()+F,y=!0),b+=p.pop(),M(b,x);break;case 23:j();break;case 24:for(;p.length>2;)i=b+p.shift(),o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),b=u+p.shift(),x=f+p.shift(),h.curveTo(i,o,u,f,b,x);b+=p.shift(),x+=p.shift(),h.lineTo(b,x);break;case 25:for(;p.length>6;)b+=p.shift(),x+=p.shift(),h.lineTo(b,x);i=b+p.shift(),o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),b=u+p.shift(),x=f+p.shift(),h.curveTo(i,o,u,f,b,x);break;case 26:for(p.length%2&&(b+=p.shift());p.length>0;)i=b,o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),b=u,x=f+p.shift(),h.curveTo(i,o,u,f,b,x);break;case 27:for(p.length%2&&(x+=p.shift());p.length>0;)i=b+p.shift(),o=x,u=i+p.shift(),f=o+p.shift(),b=u+p.shift(),x=f,h.curveTo(i,o,u,f,b,x);break;case 28:K=H[Z],J=H[Z+1],p.push((K<<24|J<<16)>>16),Z+=2;break;case 29:X=p.pop()+a.gsubrsBias,Y=a.gsubrs[X],Y&&B(Y);break;case 30:for(;p.length>0&&(i=b,o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),b=u+p.shift(),x=f+(p.length===1?p.shift():0),h.curveTo(i,o,u,f,b,x),p.length!==0);)i=b+p.shift(),o=x,u=i+p.shift(),f=o+p.shift(),x=f+p.shift(),b=u+(p.length===1?p.shift():0),h.curveTo(i,o,u,f,b,x);break;case 31:for(;p.length>0&&(i=b+p.shift(),o=x,u=i+p.shift(),f=o+p.shift(),x=f+p.shift(),b=u+(p.length===1?p.shift():0),h.curveTo(i,o,u,f,b,x),p.length!==0);)i=b,o=x+p.shift(),u=i+p.shift(),f=o+p.shift(),b=u+p.shift(),x=f+(p.length===1?p.shift():0),h.curveTo(i,o,u,f,b,x);break;default:ue<32?console.log("Glyph "+n.index+": unknown operator "+ue):ue<247?p.push(ue-139):ue<251?(K=H[Z],Z+=1,p.push((ue-247)*256+K+108)):ue<255?(K=H[Z],Z+=1,p.push(-(ue-251)*256-K-108)):(K=H[Z],J=H[Z+1],G=H[Z+2],V=H[Z+3],Z+=4,p.push((K<<24|J<<16|G<<8|V)/65536))}}}return B(r),n.advanceWidth=_,h}function Nb(a,n,r,i){var o=[],u,f=new Be.Parser(a,n),h=f.parseCard8();if(h===0)for(var p=0;p<r;p++){if(u=f.parseCard8(),u>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+i+")");o.push(u)}else if(h===3){var v=f.parseCard16(),y=f.parseCard16();if(y!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+y);for(var S,b=0;b<v;b++){if(u=f.parseCard8(),S=f.parseCard16(),u>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+i+")");if(S>r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+S);for(;y<S;y++)o.push(u);y=S}if(S!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+S)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+h);return o}function Rb(a,n,r,i){r.tables.cff={};var o=Ab(a,n),u=ls(a,o.endOffset,Be.bytesToString),f=ls(a,u.endOffset),h=ls(a,f.endOffset,Be.bytesToString),p=ls(a,h.endOffset);r.gsubrs=p.objects,r.gsubrsBias=Hf(r.gsubrs);var v=Q0(a,n,f.objects,h.objects);if(v.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+v.length);var y=v[0];if(r.tables.cff.topDict=y,y._privateDict&&(r.defaultWidthX=y._privateDict.defaultWidthX,r.nominalWidthX=y._privateDict.nominalWidthX),y.ros[0]!==void 0&&y.ros[1]!==void 0&&(r.isCIDFont=!0),r.isCIDFont){var S=y.fdArray,b=y.fdSelect;if(S===0||b===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");S+=n;var x=ls(a,S),E=Q0(a,n,x.objects,h.objects);y._fdArray=E,b+=n,y._fdSelect=Nb(a,b,r.numGlyphs,E.length)}var A=n+y.private[1],D=lg(a,A,y.private[0],h.objects);if(r.defaultWidthX=D.defaultWidthX,r.nominalWidthX=D.nominalWidthX,D.subrs!==0){var F=A+D.subrs,R=ls(a,F);r.subrs=R.objects,r.subrsBias=Hf(r.subrs)}else r.subrs=[],r.subrsBias=0;var N;i.lowMemory?(N=bb(a,n+y.charStrings),r.nGlyphs=N.offsets.length):(N=ls(a,n+y.charStrings),r.nGlyphs=N.objects.length);var _=Cb(a,n+y.charset,r.nGlyphs,h.objects);if(y.encoding===0?r.cffEncoding=new Ec(cb,_):y.encoding===1?r.cffEncoding=new Ec(ub,_):r.cffEncoding=Mb(a,n+y.encoding,_),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new tr.GlyphSet(r),i.lowMemory)r._push=function(B){var H=xb(B,N.offsets,a,n+y.charStrings);r.glyphs.push(B,tr.cffGlyphLoader(r,B,Z0,H))};else for(var M=0;M<r.nGlyphs;M+=1){var j=N.objects[M];r.glyphs.push(M,tr.cffGlyphLoader(r,M,Z0,j))}}function og(a,n){var r,i=hc.indexOf(a);return i>=0&&(r=i),i=n.indexOf(a),i>=0?r=i+hc.length:(r=hc.length+n.length,n.push(a)),r}function Db(){return new _e.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function _b(a){var n=new _e.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);n.names=[];for(var r=0;r<a.length;r+=1)n.names.push({name:"name_"+r,type:"NAME",value:a[r]});return n}function cg(a,n,r){for(var i={},o=0;o<a.length;o+=1){var u=a[o],f=n[u.name];f!==void 0&&!ng(f,u.value)&&(u.type==="SID"&&(f=og(f,r)),i[u.op]={name:u.name,type:u.type,value:f})}return i}function $0(a,n){var r=new _e.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=cg(sg,a,n),r}function W0(a){var n=new _e.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return n.topDicts=[{name:"topDict_0",type:"TABLE",value:a}],n}function kb(a){var n=new _e.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);n.strings=[];for(var r=0;r<a.length;r+=1)n.strings.push({name:"string_"+r,type:"STRING",value:a[r]});return n}function Ob(){return new _e.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function Lb(a,n){for(var r=new _e.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<a.length;i+=1){var o=a[i],u=og(o,n);r.fields.push({name:"glyph_"+i,type:"SID",value:u})}return r}function Ub(a){var n=[],r=a.path;n.push({name:"width",type:"NUMBER",value:a.advanceWidth});for(var i=0,o=0,u=0;u<r.commands.length;u+=1){var f=void 0,h=void 0,p=r.commands[u];if(p.type==="Q"){var v=.3333333333333333,y=2/3;p={type:"C",x:p.x,y:p.y,x1:Math.round(v*i+y*p.x1),y1:Math.round(v*o+y*p.y1),x2:Math.round(v*p.x+y*p.x1),y2:Math.round(v*p.y+y*p.y1)}}if(p.type==="M")f=Math.round(p.x-i),h=Math.round(p.y-o),n.push({name:"dx",type:"NUMBER",value:f}),n.push({name:"dy",type:"NUMBER",value:h}),n.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(p.x),o=Math.round(p.y);else if(p.type==="L")f=Math.round(p.x-i),h=Math.round(p.y-o),n.push({name:"dx",type:"NUMBER",value:f}),n.push({name:"dy",type:"NUMBER",value:h}),n.push({name:"rlineto",type:"OP",value:5}),i=Math.round(p.x),o=Math.round(p.y);else if(p.type==="C"){var S=Math.round(p.x1-i),b=Math.round(p.y1-o),x=Math.round(p.x2-p.x1),E=Math.round(p.y2-p.y1);f=Math.round(p.x-p.x2),h=Math.round(p.y-p.y2),n.push({name:"dx1",type:"NUMBER",value:S}),n.push({name:"dy1",type:"NUMBER",value:b}),n.push({name:"dx2",type:"NUMBER",value:x}),n.push({name:"dy2",type:"NUMBER",value:E}),n.push({name:"dx",type:"NUMBER",value:f}),n.push({name:"dy",type:"NUMBER",value:h}),n.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(p.x),o=Math.round(p.y)}}return n.push({name:"endchar",type:"OP",value:14}),n}function Ib(a){for(var n=new _e.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<a.length;r+=1){var i=a.get(r),o=Ub(i);n.charStrings.push({name:i.name,type:"CHARSTRING",value:o})}return n}function Bb(a,n){var r=new _e.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=cg(ig,a,n),r}function Fb(a,n){for(var r=new _e.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/n.unitsPerEm,o={version:n.version,fullName:n.fullName,familyName:n.familyName,weight:n.weightName,fontBBox:n.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},u={},f=[],h,p=1;p<a.length;p+=1)h=a.get(p),f.push(h.name);var v=[];r.header=Db(),r.nameIndex=_b([n.postScriptName]);var y=$0(o,v);r.topDictIndex=W0(y),r.globalSubrIndex=Ob(),r.charsets=Lb(f,v),r.charStringsIndex=Ib(a),r.privateDict=Bb(u,v),r.stringIndex=kb(v);var S=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return o.charset=S,o.encoding=0,o.charStrings=o.charset+r.charsets.sizeOf(),o.private[1]=o.charStrings+r.charStringsIndex.sizeOf(),y=$0(o,v),r.topDictIndex=W0(y),r}var ug={parse:Rb,make:Fb};function jb(a,n){var r={},i=new Be.Parser(a,n);return r.version=i.parseVersion(),r.fontRevision=Math.round(i.parseFixed()*1e3)/1e3,r.checkSumAdjustment=i.parseULong(),r.magicNumber=i.parseULong(),Ze.argument(r.magicNumber===1594834165,"Font header has wrong magic number."),r.flags=i.parseUShort(),r.unitsPerEm=i.parseUShort(),r.created=i.parseLongDateTime(),r.modified=i.parseLongDateTime(),r.xMin=i.parseShort(),r.yMin=i.parseShort(),r.xMax=i.parseShort(),r.yMax=i.parseShort(),r.macStyle=i.parseUShort(),r.lowestRecPPEM=i.parseUShort(),r.fontDirectionHint=i.parseShort(),r.indexToLocFormat=i.parseShort(),r.glyphDataFormat=i.parseShort(),r}function Pb(a){var n=Math.round(new Date().getTime()/1e3)+2082844800,r=n;return a.createdTimestamp&&(r=a.createdTimestamp+2082844800),new _e.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:n},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],a)}var fg={parse:jb,make:Pb};function Gb(a,n){var r={},i=new Be.Parser(a,n);return r.version=i.parseVersion(),r.ascender=i.parseShort(),r.descender=i.parseShort(),r.lineGap=i.parseShort(),r.advanceWidthMax=i.parseUShort(),r.minLeftSideBearing=i.parseShort(),r.minRightSideBearing=i.parseShort(),r.xMaxExtent=i.parseShort(),r.caretSlopeRise=i.parseShort(),r.caretSlopeRun=i.parseShort(),r.caretOffset=i.parseShort(),i.relativeOffset+=8,r.metricDataFormat=i.parseShort(),r.numberOfHMetrics=i.parseUShort(),r}function zb(a){return new _e.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],a)}var dg={parse:Gb,make:zb};function Hb(a,n,r,i,o){for(var u,f,h=new Be.Parser(a,n),p=0;p<i;p+=1){p<r&&(u=h.parseUShort(),f=h.parseShort());var v=o.get(p);v.advanceWidth=u,v.leftSideBearing=f}}function Yb(a,n,r,i,o){a._hmtxTableData={};for(var u,f,h=new Be.Parser(n,r),p=0;p<o;p+=1)p<i&&(u=h.parseUShort(),f=h.parseShort()),a._hmtxTableData[p]={advanceWidth:u,leftSideBearing:f}}function qb(a,n,r,i,o,u,f){f.lowMemory?Yb(a,n,r,i,o):Hb(n,r,i,o,u)}function Vb(a){for(var n=new _e.Table("hmtx",[]),r=0;r<a.length;r+=1){var i=a.get(r),o=i.advanceWidth||0,u=i.leftSideBearing||0;n.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:o}),n.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:u})}return n}var pg={parse:qb,make:Vb};function Xb(a){for(var n=new _e.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:a.length}]),r="",i=12+a.length*4,o=0;o<a.length;++o){var u=r.indexOf(a[o]);u<0&&(u=r.length,r+=a[o]),n.fields.push({name:"offset "+o,type:"USHORT",value:i+u}),n.fields.push({name:"length "+o,type:"USHORT",value:a[o].length})}return n.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),n}function Qb(a,n){var r=new Be.Parser(a,n),i=r.parseULong();Ze.argument(i===1,"Unsupported ltag table version."),r.skip("uLong",1);for(var o=r.parseULong(),u=[],f=0;f<o;f++){for(var h="",p=n+r.parseUShort(),v=r.parseUShort(),y=p;y<p+v;++y)h+=String.fromCharCode(a.getInt8(y));u.push(h)}return u}var hg={make:Xb,parse:Qb};function Zb(a,n){var r={},i=new Be.Parser(a,n);return r.version=i.parseVersion(),r.numGlyphs=i.parseUShort(),r.version===1&&(r.maxPoints=i.parseUShort(),r.maxContours=i.parseUShort(),r.maxCompositePoints=i.parseUShort(),r.maxCompositeContours=i.parseUShort(),r.maxZones=i.parseUShort(),r.maxTwilightPoints=i.parseUShort(),r.maxStorage=i.parseUShort(),r.maxFunctionDefs=i.parseUShort(),r.maxInstructionDefs=i.parseUShort(),r.maxStackElements=i.parseUShort(),r.maxSizeOfInstructions=i.parseUShort(),r.maxComponentElements=i.parseUShort(),r.maxComponentDepth=i.parseUShort()),r}function $b(a){return new _e.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:a}])}var mg={parse:Zb,make:$b},gg=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],vg={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Wb={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},yg={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Kb(a,n,r){switch(a){case 0:if(n===65535)return"und";if(r)return r[n];break;case 1:return vg[n];case 3:return yg[n]}}var Yf="utf-16",Jb={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},ex={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function bg(a,n,r){switch(a){case 0:return Yf;case 1:return ex[r]||Jb[n];case 3:if(n===1||n===10)return Yf;break}}function tx(a,n,r){for(var i={},o=new Be.Parser(a,n),u=o.parseUShort(),f=o.parseUShort(),h=o.offset+o.parseUShort(),p=0;p<f;p++){var v=o.parseUShort(),y=o.parseUShort(),S=o.parseUShort(),b=o.parseUShort(),x=gg[b]||b,E=o.parseUShort(),A=o.parseUShort(),D=Kb(v,S,r),F=bg(v,y,S);if(F!==void 0&&D!==void 0){var R=void 0;if(F===Yf?R=Ui.UTF16(a,h+A,E):R=Ui.MACSTRING(a,h+A,E,F),R){var N=i[x];N===void 0&&(N=i[x]={}),N[D]=R}}}return u===1&&o.parseUShort(),i}function Cf(a){var n={};for(var r in a)n[a[r]]=parseInt(r);return n}function K0(a,n,r,i,o,u){return new _e.Record("NameRecord",[{name:"platformID",type:"USHORT",value:a},{name:"encodingID",type:"USHORT",value:n},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:o},{name:"offset",type:"USHORT",value:u}])}function nx(a,n){var r=a.length,i=n.length-r+1;e:for(var o=0;o<i;o++)for(;o<i;o++){for(var u=0;u<r;u++)if(n[o+u]!==a[u])continue e;return o}return-1}function J0(a,n){var r=nx(a,n);if(r<0){r=n.length;for(var i=0,o=a.length;i<o;++i)n.push(a[i])}return r}function ax(a,n){var r,i=[],o={},u=Cf(gg);for(var f in a){var h=u[f];if(h===void 0&&(h=f),r=parseInt(h),isNaN(r))throw new Error('Name table entry "'+f+'" does not exist, see nameTableNames for complete list.');o[r]=a[f],i.push(r)}for(var p=Cf(vg),v=Cf(yg),y=[],S=[],b=0;b<i.length;b++){r=i[b];var x=o[r];for(var E in x){var A=x[E],D=1,F=p[E],R=Wb[F],N=bg(D,R,F),_=De.MACSTRING(A,N);_===void 0&&(D=0,F=n.indexOf(E),F<0&&(F=n.length,n.push(E)),R=4,_=De.UTF16(A));var M=J0(_,S);y.push(K0(D,R,F,r,_.length,M));var j=v[E];if(j!==void 0){var B=De.UTF16(A),H=J0(B,S);y.push(K0(3,1,j,r,B.length,H))}}}y.sort(function(G,V){return G.platformID-V.platformID||G.encodingID-V.encodingID||G.languageID-V.languageID||G.nameID-V.nameID});for(var K=new _e.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:y.length},{name:"stringOffset",type:"USHORT",value:6+y.length*12}]),J=0;J<y.length;J++)K.fields.push({name:"record_"+J,type:"RECORD",value:y[J]});return K.fields.push({name:"strings",type:"LITERAL",value:S}),K}var xg={parse:tx,make:ax},qf=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function rx(a){for(var n=0;n<qf.length;n+=1){var r=qf[n];if(a>=r.begin&&a<r.end)return n}return-1}function sx(a,n){var r={},i=new Be.Parser(a,n);r.version=i.parseUShort(),r.xAvgCharWidth=i.parseShort(),r.usWeightClass=i.parseUShort(),r.usWidthClass=i.parseUShort(),r.fsType=i.parseUShort(),r.ySubscriptXSize=i.parseShort(),r.ySubscriptYSize=i.parseShort(),r.ySubscriptXOffset=i.parseShort(),r.ySubscriptYOffset=i.parseShort(),r.ySuperscriptXSize=i.parseShort(),r.ySuperscriptYSize=i.parseShort(),r.ySuperscriptXOffset=i.parseShort(),r.ySuperscriptYOffset=i.parseShort(),r.yStrikeoutSize=i.parseShort(),r.yStrikeoutPosition=i.parseShort(),r.sFamilyClass=i.parseShort(),r.panose=[];for(var o=0;o<10;o++)r.panose[o]=i.parseByte();return r.ulUnicodeRange1=i.parseULong(),r.ulUnicodeRange2=i.parseULong(),r.ulUnicodeRange3=i.parseULong(),r.ulUnicodeRange4=i.parseULong(),r.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),r.fsSelection=i.parseUShort(),r.usFirstCharIndex=i.parseUShort(),r.usLastCharIndex=i.parseUShort(),r.sTypoAscender=i.parseShort(),r.sTypoDescender=i.parseShort(),r.sTypoLineGap=i.parseShort(),r.usWinAscent=i.parseUShort(),r.usWinDescent=i.parseUShort(),r.version>=1&&(r.ulCodePageRange1=i.parseULong(),r.ulCodePageRange2=i.parseULong()),r.version>=2&&(r.sxHeight=i.parseShort(),r.sCapHeight=i.parseShort(),r.usDefaultChar=i.parseUShort(),r.usBreakChar=i.parseUShort(),r.usMaxContent=i.parseUShort()),r}function ix(a){return new _e.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],a)}var Vf={parse:sx,make:ix,unicodeRanges:qf,getUnicodeRange:rx};function lx(a,n){var r={},i=new Be.Parser(a,n);switch(r.version=i.parseVersion(),r.italicAngle=i.parseFixed(),r.underlinePosition=i.parseShort(),r.underlineThickness=i.parseShort(),r.isFixedPitch=i.parseULong(),r.minMemType42=i.parseULong(),r.maxMemType42=i.parseULong(),r.minMemType1=i.parseULong(),r.maxMemType1=i.parseULong(),r.version){case 1:r.names=Fs.slice();break;case 2:r.numberOfGlyphs=i.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var o=0;o<r.numberOfGlyphs;o++)r.glyphNameIndex[o]=i.parseUShort();r.names=[];for(var u=0;u<r.numberOfGlyphs;u++)if(r.glyphNameIndex[u]>=Fs.length){var f=i.parseChar();r.names.push(i.parseString(f))}break;case 2.5:r.numberOfGlyphs=i.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var h=0;h<r.numberOfGlyphs;h++)r.offset[h]=i.parseChar();break}return r}function ox(){return new _e.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var Sg={parse:lx,make:ox},_a=new Array(9);_a[1]=function(){var n=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(le.coverage),deltaGlyphId:this.parseUShort()};if(r===2)return{substFormat:2,coverage:this.parsePointer(le.coverage),substitute:this.parseOffset16List()};Ze.assert(!1,"0x"+n.toString(16)+": lookup type 1 format must be 1 or 2.")};_a[2]=function(){var n=this.parseUShort();return Ze.argument(n===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer(le.coverage),sequences:this.parseListOfLists()}};_a[3]=function(){var n=this.parseUShort();return Ze.argument(n===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer(le.coverage),alternateSets:this.parseListOfLists()}};_a[4]=function(){var n=this.parseUShort();return Ze.argument(n===1,"GSUB ligature table identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer(le.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var Oi={sequenceIndex:le.uShort,lookupListIndex:le.uShort};_a[5]=function(){var n=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:r,coverage:this.parsePointer(le.coverage),ruleSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{input:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,Oi)}})};if(r===2)return{substFormat:r,coverage:this.parsePointer(le.coverage),classDef:this.parsePointer(le.classDef),classSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{classes:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,Oi)}})};if(r===3){var i=this.parseUShort(),o=this.parseUShort();return{substFormat:r,coverages:this.parseList(i,le.pointer(le.coverage)),lookupRecords:this.parseRecordList(o,Oi)}}Ze.assert(!1,"0x"+n.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};_a[6]=function(){var n=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(le.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Oi)}})};if(r===2)return{substFormat:2,coverage:this.parsePointer(le.coverage),backtrackClassDef:this.parsePointer(le.classDef),inputClassDef:this.parsePointer(le.classDef),lookaheadClassDef:this.parsePointer(le.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Oi)}})};if(r===3)return{substFormat:3,backtrackCoverage:this.parseList(le.pointer(le.coverage)),inputCoverage:this.parseList(le.pointer(le.coverage)),lookaheadCoverage:this.parseList(le.pointer(le.coverage)),lookupRecords:this.parseRecordList(Oi)};Ze.assert(!1,"0x"+n.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};_a[7]=function(){var n=this.parseUShort();Ze.argument(n===1,"GSUB Extension Substitution subtable identifier-format must be 1");var r=this.parseUShort(),i=new le(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:r,extension:_a[r].call(i)}};_a[8]=function(){var n=this.parseUShort();return Ze.argument(n===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer(le.coverage),backtrackCoverage:this.parseList(le.pointer(le.coverage)),lookaheadCoverage:this.parseList(le.pointer(le.coverage)),substitutes:this.parseUShortList()}};function cx(a,n){n=n||0;var r=new le(a,n),i=r.parseVersion(1);return Ze.argument(i===1||i===1.1,"Unsupported GSUB table version."),i===1?{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(_a)}:{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(_a),variations:r.parseFeatureVariationsList()}}var Ii=new Array(9);Ii[1]=function(n){return n.substFormat===1?new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(n.coverage)},{name:"deltaGlyphID",type:"USHORT",value:n.deltaGlyphId}]):new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new _e.Coverage(n.coverage)}].concat(_e.ushortList("substitute",n.substitute)))};Ii[2]=function(n){return Ze.assert(n.substFormat===1,"Lookup type 2 substFormat must be 1."),new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(n.coverage)}].concat(_e.tableList("seqSet",n.sequences,function(r){return new _e.Table("sequenceSetTable",_e.ushortList("sequence",r))})))};Ii[3]=function(n){return Ze.assert(n.substFormat===1,"Lookup type 3 substFormat must be 1."),new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(n.coverage)}].concat(_e.tableList("altSet",n.alternateSets,function(r){return new _e.Table("alternateSetTable",_e.ushortList("alternate",r))})))};Ii[4]=function(n){return Ze.assert(n.substFormat===1,"Lookup type 4 substFormat must be 1."),new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(n.coverage)}].concat(_e.tableList("ligSet",n.ligatureSets,function(r){return new _e.Table("ligatureSetTable",_e.tableList("ligature",r,function(i){return new _e.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:i.ligGlyph}].concat(_e.ushortList("component",i.components,i.components.length+1)))}))})))};Ii[6]=function(n){if(n.substFormat===1){var r=new _e.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:n.substFormat},{name:"coverage",type:"TABLE",value:new _e.Coverage(n.coverage)}].concat(_e.tableList("chainRuleSet",n.chainRuleSets,function(u){return new _e.Table("chainRuleSetTable",_e.tableList("chainRule",u,function(f){var h=_e.ushortList("backtrackGlyph",f.backtrack,f.backtrack.length).concat(_e.ushortList("inputGlyph",f.input,f.input.length+1)).concat(_e.ushortList("lookaheadGlyph",f.lookahead,f.lookahead.length)).concat(_e.ushortList("substitution",[],f.lookupRecords.length));return f.lookupRecords.forEach(function(p,v){h=h.concat({name:"sequenceIndex"+v,type:"USHORT",value:p.sequenceIndex}).concat({name:"lookupListIndex"+v,type:"USHORT",value:p.lookupListIndex})}),new _e.Table("chainRuleTable",h)}))})));return r}else if(n.substFormat===2)Ze.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(n.substFormat===3){var i=[{name:"substFormat",type:"USHORT",value:n.substFormat}];i.push({name:"backtrackGlyphCount",type:"USHORT",value:n.backtrackCoverage.length}),n.backtrackCoverage.forEach(function(u,f){i.push({name:"backtrackCoverage"+f,type:"TABLE",value:new _e.Coverage(u)})}),i.push({name:"inputGlyphCount",type:"USHORT",value:n.inputCoverage.length}),n.inputCoverage.forEach(function(u,f){i.push({name:"inputCoverage"+f,type:"TABLE",value:new _e.Coverage(u)})}),i.push({name:"lookaheadGlyphCount",type:"USHORT",value:n.lookaheadCoverage.length}),n.lookaheadCoverage.forEach(function(u,f){i.push({name:"lookaheadCoverage"+f,type:"TABLE",value:new _e.Coverage(u)})}),i.push({name:"substitutionCount",type:"USHORT",value:n.lookupRecords.length}),n.lookupRecords.forEach(function(u,f){i=i.concat({name:"sequenceIndex"+f,type:"USHORT",value:u.sequenceIndex}).concat({name:"lookupListIndex"+f,type:"USHORT",value:u.lookupListIndex})});var o=new _e.Table("chainContextTable",i);return o}Ze.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function ux(a){return new _e.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new _e.ScriptList(a.scripts)},{name:"features",type:"TABLE",value:new _e.FeatureList(a.features)},{name:"lookups",type:"TABLE",value:new _e.LookupList(a.lookups,Ii)}])}var Eg={parse:cx,make:ux};function fx(a,n){var r=new Be.Parser(a,n),i=r.parseULong();Ze.argument(i===1,"Unsupported META table version."),r.parseULong(),r.parseULong();for(var o=r.parseULong(),u={},f=0;f<o;f++){var h=r.parseTag(),p=r.parseULong(),v=r.parseULong(),y=Ui.UTF8(a,n+p,v);u[h]=y}return u}function dx(a){var n=Object.keys(a).length,r="",i=16+n*12,o=new _e.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:n}]);for(var u in a){var f=r.length;r+=a[u],o.fields.push({name:"tag "+u,type:"TAG",value:u}),o.fields.push({name:"offset "+u,type:"ULONG",value:i+f}),o.fields.push({name:"length "+u,type:"ULONG",value:a[u].length})}return o.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),o}var wg={parse:fx,make:dx};function em(a){return Math.log(a)/Math.log(2)|0}function id(a){for(;a.length%4!==0;)a.push(0);for(var n=0,r=0;r<a.length;r+=4)n+=(a[r]<<24)+(a[r+1]<<16)+(a[r+2]<<8)+a[r+3];return n%=Math.pow(2,32),n}function tm(a,n,r,i){return new _e.Record("Table Record",[{name:"tag",type:"TAG",value:a!==void 0?a:""},{name:"checkSum",type:"ULONG",value:n!==void 0?n:0},{name:"offset",type:"ULONG",value:r!==void 0?r:0},{name:"length",type:"ULONG",value:i!==void 0?i:0}])}function Ag(a){var n=new _e.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);n.tables=a,n.numTables=a.length;var r=Math.pow(2,em(n.numTables));n.searchRange=16*r,n.entrySelector=em(r),n.rangeShift=n.numTables*16-n.searchRange;for(var i=[],o=[],u=n.sizeOf()+tm().sizeOf()*n.numTables;u%4!==0;)u+=1,o.push({name:"padding",type:"BYTE",value:0});for(var f=0;f<a.length;f+=1){var h=a[f];Ze.argument(h.tableName.length===4,"Table name"+h.tableName+" is invalid.");var p=h.sizeOf(),v=tm(h.tableName,id(h.encode()),u,p);for(i.push({name:v.tag+" Table Record",type:"RECORD",value:v}),o.push({name:h.tableName+" table",type:"RECORD",value:h}),u+=p,Ze.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!==0;)u+=1,o.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(y,S){return y.value.tag>S.value.tag?1:-1}),n.fields=n.fields.concat(i),n.fields=n.fields.concat(o),n}function nm(a,n,r){for(var i=0;i<n.length;i+=1){var o=a.charToGlyphIndex(n[i]);if(o>0){var u=a.glyphs.get(o);return u.getMetrics()}}return r}function px(a){for(var n=0,r=0;r<a.length;r+=1)n+=a[r];return n/a.length}function hx(a){for(var n=[],r=[],i=[],o=[],u=[],f=[],h=[],p,v=0,y=0,S=0,b=0,x=0,E=0;E<a.glyphs.length;E+=1){var A=a.glyphs.get(E),D=A.unicode|0;if(isNaN(A.advanceWidth))throw new Error("Glyph "+A.name+" ("+E+"): advanceWidth is not a number.");(p>D||p===void 0)&&D>0&&(p=D),v<D&&(v=D);var F=Vf.getUnicodeRange(D);if(F<32)y|=1<<F;else if(F<64)S|=1<<F-32;else if(F<96)b|=1<<F-64;else if(F<123)x|=1<<F-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(A.name!==".notdef"){var R=A.getMetrics();n.push(R.xMin),r.push(R.yMin),i.push(R.xMax),o.push(R.yMax),f.push(R.leftSideBearing),h.push(R.rightSideBearing),u.push(A.advanceWidth)}}var N={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,u),advanceWidthAvg:px(u),minLeftSideBearing:Math.min.apply(null,f),maxLeftSideBearing:Math.max.apply(null,f),minRightSideBearing:Math.min.apply(null,h)};N.ascender=a.ascender,N.descender=a.descender;var _=fg.make({flags:3,unitsPerEm:a.unitsPerEm,xMin:N.xMin,yMin:N.yMin,xMax:N.xMax,yMax:N.yMax,lowestRecPPEM:3,createdTimestamp:a.createdTimestamp}),M=dg.make({ascender:N.ascender,descender:N.descender,advanceWidthMax:N.advanceWidthMax,minLeftSideBearing:N.minLeftSideBearing,minRightSideBearing:N.minRightSideBearing,xMaxExtent:N.maxLeftSideBearing+(N.xMax-N.xMin),numberOfHMetrics:a.glyphs.length}),j=mg.make(a.glyphs.length),B=Vf.make(Object.assign({xAvgCharWidth:Math.round(N.advanceWidthAvg),usFirstCharIndex:p,usLastCharIndex:v,ulUnicodeRange1:y,ulUnicodeRange2:S,ulUnicodeRange3:b,ulUnicodeRange4:x,sTypoAscender:N.ascender,sTypoDescender:N.descender,sTypoLineGap:0,usWinAscent:N.yMax,usWinDescent:Math.abs(N.yMin),ulCodePageRange1:1,sxHeight:nm(a,"xyvw",{yMax:Math.round(N.ascender/2)}).yMax,sCapHeight:nm(a,"HIKLEFJMNTZBDPRAGOQSUVWXY",N).yMax,usDefaultChar:a.hasChar(" ")?32:0,usBreakChar:a.hasChar(" ")?32:0},a.tables.os2)),H=pg.make(a.glyphs),K=Jm.make(a.glyphs),J=a.getEnglishName("fontFamily"),G=a.getEnglishName("fontSubfamily"),V=J+" "+G,X=a.getEnglishName("postScriptName");X||(X=J.replace(/\s/g,"")+"-"+G);var Y={};for(var Q in a.names)Y[Q]=a.names[Q];Y.uniqueID||(Y.uniqueID={en:a.getEnglishName("manufacturer")+":"+V}),Y.postScriptName||(Y.postScriptName={en:X}),Y.preferredFamily||(Y.preferredFamily=a.names.fontFamily),Y.preferredSubfamily||(Y.preferredSubfamily=a.names.fontSubfamily);var L=[],z=xg.make(Y,L),ne=L.length>0?hg.make(L):void 0,fe=Sg.make(),U=ug.make(a.glyphs,{version:a.getEnglishName("version"),fullName:V,familyName:J,weightName:G,postScriptName:X,unitsPerEm:a.unitsPerEm,fontBBox:[0,N.yMin,N.ascender,N.advanceWidthMax]}),Z=a.metas&&Object.keys(a.metas).length>0?wg.make(a.metas):void 0,ue=[_,M,j,B,z,K,fe,U,H];ne&&ue.push(ne),a.tables.gsub&&ue.push(Eg.make(a.tables.gsub)),Z&&ue.push(Z);for(var be=Ag(ue),oe=be.encode(),Se=id(oe),Ee=be.fields,Xe=!1,Ge=0;Ge<Ee.length;Ge+=1)if(Ee[Ge].name==="head table"){Ee[Ge].value.checkSumAdjustment=2981146554-Se,Xe=!0;break}if(!Xe)throw new Error("Could not find head table with checkSum to adjust.");return be}var mx={make:Ag,fontToTable:hx,computeCheckSum:id};function Mf(a,n){for(var r=0,i=a.length-1;r<=i;){var o=r+i>>>1,u=a[o].tag;if(u===n)return o;u<n?r=o+1:i=o-1}return-r-1}function am(a,n){for(var r=0,i=a.length-1;r<=i;){var o=r+i>>>1,u=a[o];if(u===n)return o;u<n?r=o+1:i=o-1}return-r-1}function rm(a,n){for(var r,i=0,o=a.length-1;i<=o;){var u=i+o>>>1;r=a[u];var f=r.start;if(f===n)return r;f<n?i=u+1:o=u-1}if(i>0)return r=a[i-1],n>r.end?0:r}function Yl(a,n){this.font=a,this.tableName=n}Yl.prototype={searchTag:Mf,binSearch:am,getTable:function(a){var n=this.font.tables[this.tableName];return!n&&a&&(n=this.font.tables[this.tableName]=this.createDefaultTable()),n},getScriptNames:function(){var a=this.getTable();return a?a.scripts.map(function(n){return n.tag}):[]},getDefaultScriptName:function(){var a=this.getTable();if(a){for(var n=!1,r=0;r<a.scripts.length;r++){var i=a.scripts[r].tag;if(i==="DFLT")return i;i==="latn"&&(n=!0)}if(n)return"latn"}},getScriptTable:function(a,n){var r=this.getTable(n);if(r){a=a||"DFLT";var i=r.scripts,o=Mf(r.scripts,a);if(o>=0)return i[o].script;if(n){var u={tag:a,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-o,0,u),u.script}}},getLangSysTable:function(a,n,r){var i=this.getScriptTable(a,r);if(i){if(!n||n==="dflt"||n==="DFLT")return i.defaultLangSys;var o=Mf(i.langSysRecords,n);if(o>=0)return i.langSysRecords[o].langSys;if(r){var u={tag:n,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-o,0,u),u.langSys}}},getFeatureTable:function(a,n,r,i){var o=this.getLangSysTable(a,n,i);if(o){for(var u,f=o.featureIndexes,h=this.font.tables[this.tableName].features,p=0;p<f.length;p++)if(u=h[f[p]],u.tag===r)return u.feature;if(i){var v=h.length;return Ze.assert(v===0||r>=h[v-1].tag,"Features must be added in alphabetical order."),u={tag:r,feature:{params:0,lookupListIndexes:[]}},h.push(u),f.push(v),u.feature}}},getLookupTables:function(a,n,r,i,o){var u=this.getFeatureTable(a,n,r,o),f=[];if(u){for(var h,p=u.lookupListIndexes,v=this.font.tables[this.tableName].lookups,y=0;y<p.length;y++)h=v[p[y]],h.lookupType===i&&f.push(h);if(f.length===0&&o){h={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var S=v.length;return v.push(h),p.push(S),[h]}}return f},getGlyphClass:function(a,n){switch(a.format){case 1:return a.startGlyph<=n&&n<a.startGlyph+a.classes.length?a.classes[n-a.startGlyph]:0;case 2:var r=rm(a.ranges,n);return r?r.classId:0}},getCoverageIndex:function(a,n){switch(a.format){case 1:var r=am(a.glyphs,n);return r>=0?r:-1;case 2:var i=rm(a.ranges,n);return i?i.index+n-i.start:-1}},expandCoverage:function(a){if(a.format===1)return a.glyphs;for(var n=[],r=a.ranges,i=0;i<r.length;i++)for(var o=r[i],u=o.start,f=o.end,h=u;h<=f;h++)n.push(h);return n}};function ql(a){Yl.call(this,a,"gpos")}ql.prototype=Yl.prototype;ql.prototype.init=function(){var a=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(a)};ql.prototype.getKerningValue=function(a,n,r){for(var i=0;i<a.length;i++)for(var o=a[i].subtables,u=0;u<o.length;u++){var f=o[u],h=this.getCoverageIndex(f.coverage,n);if(!(h<0))switch(f.posFormat){case 1:for(var p=f.pairSets[h],v=0;v<p.length;v++){var y=p[v];if(y.secondGlyph===r)return y.value1&&y.value1.xAdvance||0}break;case 2:var S=this.getGlyphClass(f.classDef1,n),b=this.getGlyphClass(f.classDef2,r),x=f.classRecords[S][b];return x.value1&&x.value1.xAdvance||0}}return 0};ql.prototype.getKerningTables=function(a,n){if(this.font.tables.gpos)return this.getLookupTables(a,n,"kern",2)};function ra(a){Yl.call(this,a,"gsub")}function gx(a,n){var r=a.length;if(r!==n.length)return!1;for(var i=0;i<r;i++)if(a[i]!==n[i])return!1;return!0}function ld(a,n,r){for(var i=a.subtables,o=0;o<i.length;o++){var u=i[o];if(u.substFormat===n)return u}if(r)return i.push(r),r}ra.prototype=Yl.prototype;ra.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};ra.prototype.getSingle=function(a,n,r){for(var i=[],o=this.getLookupTables(n,r,a,1),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++){var p=f[h],v=this.expandCoverage(p.coverage),y=void 0;if(p.substFormat===1){var S=p.deltaGlyphId;for(y=0;y<v.length;y++){var b=v[y];i.push({sub:b,by:b+S})}}else{var x=p.substitute;for(y=0;y<v.length;y++)i.push({sub:v[y],by:x[y]})}}return i};ra.prototype.getMultiple=function(a,n,r){for(var i=[],o=this.getLookupTables(n,r,a,2),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++){var p=f[h],v=this.expandCoverage(p.coverage),y=void 0;for(y=0;y<v.length;y++){var S=v[y],b=p.sequences[y];i.push({sub:S,by:b})}}return i};ra.prototype.getAlternates=function(a,n,r){for(var i=[],o=this.getLookupTables(n,r,a,3),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++)for(var p=f[h],v=this.expandCoverage(p.coverage),y=p.alternateSets,S=0;S<v.length;S++)i.push({sub:v[S],by:y[S]});return i};ra.prototype.getLigatures=function(a,n,r){for(var i=[],o=this.getLookupTables(n,r,a,4),u=0;u<o.length;u++)for(var f=o[u].subtables,h=0;h<f.length;h++)for(var p=f[h],v=this.expandCoverage(p.coverage),y=p.ligatureSets,S=0;S<v.length;S++)for(var b=v[S],x=y[S],E=0;E<x.length;E++){var A=x[E];i.push({sub:[b].concat(A.components),by:A.ligGlyph})}return i};ra.prototype.addSingle=function(a,n,r,i){var o=this.getLookupTables(r,i,a,1,!0)[0],u=ld(o,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Ze.assert(u.coverage.format===1,"Single: unable to modify coverage table format "+u.coverage.format);var f=n.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.substitute.splice(h,0,0)),u.substitute[h]=n.by};ra.prototype.addMultiple=function(a,n,r,i){Ze.assert(n.by instanceof Array&&n.by.length>1,'Multiple: "by" must be an array of two or more ids');var o=this.getLookupTables(r,i,a,2,!0)[0],u=ld(o,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Ze.assert(u.coverage.format===1,"Multiple: unable to modify coverage table format "+u.coverage.format);var f=n.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.sequences.splice(h,0,0)),u.sequences[h]=n.by};ra.prototype.addAlternate=function(a,n,r,i){var o=this.getLookupTables(r,i,a,3,!0)[0],u=ld(o,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Ze.assert(u.coverage.format===1,"Alternate: unable to modify coverage table format "+u.coverage.format);var f=n.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.alternateSets.splice(h,0,0)),u.alternateSets[h]=n.by};ra.prototype.addLigature=function(a,n,r,i){var o=this.getLookupTables(r,i,a,4,!0)[0],u=o.subtables[0];u||(u={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},o.subtables[0]=u),Ze.assert(u.coverage.format===1,"Ligature: unable to modify coverage table format "+u.coverage.format);var f=n.sub[0],h=n.sub.slice(1),p={ligGlyph:n.by,components:h},v=this.binSearch(u.coverage.glyphs,f);if(v>=0){for(var y=u.ligatureSets[v],S=0;S<y.length;S++)if(gx(y[S].components,h))return;y.push(p)}else v=-1-v,u.coverage.glyphs.splice(v,0,f),u.ligatureSets.splice(v,0,[p])};ra.prototype.getFeature=function(a,n,r){if(/ss\d\d/.test(a))return this.getSingle(a,n,r);switch(a){case"aalt":case"salt":return this.getSingle(a,n,r).concat(this.getAlternates(a,n,r));case"dlig":case"liga":case"rlig":return this.getLigatures(a,n,r);case"ccmp":return this.getMultiple(a,n,r).concat(this.getLigatures(a,n,r));case"stch":return this.getMultiple(a,n,r)}};ra.prototype.add=function(a,n,r,i){if(/ss\d\d/.test(a))return this.addSingle(a,n,r,i);switch(a){case"aalt":case"salt":return typeof n.by=="number"?this.addSingle(a,n,r,i):this.addAlternate(a,n,r,i);case"dlig":case"liga":case"rlig":return this.addLigature(a,n,r,i);case"ccmp":return n.by instanceof Array?this.addMultiple(a,n,r,i):this.addLigature(a,n,r,i)}};function vx(){return typeof window<"u"}function Tg(a){for(var n=new ArrayBuffer(a.length),r=new Uint8Array(n),i=0;i<a.length;++i)r[i]=a[i];return n}function yx(a){for(var n=new Buffer(a.byteLength),r=new Uint8Array(a),i=0;i<n.length;++i)n[i]=r[i];return n}function Ol(a,n){if(!a)throw n}function sm(a,n,r,i,o){var u;return(n&i)>0?(u=a.parseByte(),(n&o)===0&&(u=-u),u=r+u):(n&o)>0?u=r:u=r+a.parseShort(),u}function Cg(a,n,r){var i=new Be.Parser(n,r);a.numberOfContours=i.parseShort(),a._xMin=i.parseShort(),a._yMin=i.parseShort(),a._xMax=i.parseShort(),a._yMax=i.parseShort();var o,u;if(a.numberOfContours>0){for(var f=a.endPointIndices=[],h=0;h<a.numberOfContours;h+=1)f.push(i.parseUShort());a.instructionLength=i.parseUShort(),a.instructions=[];for(var p=0;p<a.instructionLength;p+=1)a.instructions.push(i.parseByte());var v=f[f.length-1]+1;o=[];for(var y=0;y<v;y+=1)if(u=i.parseByte(),o.push(u),(u&8)>0)for(var S=i.parseByte(),b=0;b<S;b+=1)o.push(u),y+=1;if(Ze.argument(o.length===v,"Bad flags."),f.length>0){var x=[],E;if(v>0){for(var A=0;A<v;A+=1)u=o[A],E={},E.onCurve=!!(u&1),E.lastPointOfContour=f.indexOf(A)>=0,x.push(E);for(var D=0,F=0;F<v;F+=1)u=o[F],E=x[F],E.x=sm(i,u,D,2,16),D=E.x;for(var R=0,N=0;N<v;N+=1)u=o[N],E=x[N],E.y=sm(i,u,R,4,32),R=E.y}a.points=x}else a.points=[]}else if(a.numberOfContours===0)a.points=[];else{a.isComposite=!0,a.points=[],a.components=[];for(var _=!0;_;){o=i.parseUShort();var M={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(o&1)>0?(o&2)>0?(M.dx=i.parseShort(),M.dy=i.parseShort()):M.matchedPoints=[i.parseUShort(),i.parseUShort()]:(o&2)>0?(M.dx=i.parseChar(),M.dy=i.parseChar()):M.matchedPoints=[i.parseByte(),i.parseByte()],(o&8)>0?M.xScale=M.yScale=i.parseF2Dot14():(o&64)>0?(M.xScale=i.parseF2Dot14(),M.yScale=i.parseF2Dot14()):(o&128)>0&&(M.xScale=i.parseF2Dot14(),M.scale01=i.parseF2Dot14(),M.scale10=i.parseF2Dot14(),M.yScale=i.parseF2Dot14()),a.components.push(M),_=!!(o&32)}if(o&256){a.instructionLength=i.parseUShort(),a.instructions=[];for(var j=0;j<a.instructionLength;j+=1)a.instructions.push(i.parseByte())}}}function Nf(a,n){for(var r=[],i=0;i<a.length;i+=1){var o=a[i],u={x:n.xScale*o.x+n.scale01*o.y+n.dx,y:n.scale10*o.x+n.yScale*o.y+n.dy,onCurve:o.onCurve,lastPointOfContour:o.lastPointOfContour};r.push(u)}return r}function bx(a){for(var n=[],r=[],i=0;i<a.length;i+=1){var o=a[i];r.push(o),o.lastPointOfContour&&(n.push(r),r=[])}return Ze.argument(r.length===0,"There are still points left in the current contour."),n}function Mg(a){var n=new rn;if(!a)return n;for(var r=bx(a),i=0;i<r.length;++i){var o=r[i],u=null,f=o[o.length-1],h=o[0];if(f.onCurve)n.moveTo(f.x,f.y);else if(h.onCurve)n.moveTo(h.x,h.y);else{var p={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5};n.moveTo(p.x,p.y)}for(var v=0;v<o.length;++v)if(u=f,f=h,h=o[(v+1)%o.length],f.onCurve)n.lineTo(f.x,f.y);else{var y=h;u.onCurve||((f.x+u.x)*.5,(f.y+u.y)*.5),h.onCurve||(y={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5}),n.quadraticCurveTo(f.x,f.y,y.x,y.y)}n.closePath()}return n}function Ng(a,n){if(n.isComposite)for(var r=0;r<n.components.length;r+=1){var i=n.components[r],o=a.get(i.glyphIndex);if(o.getPath(),o.points){var u=void 0;if(i.matchedPoints===void 0)u=Nf(o.points,i);else{if(i.matchedPoints[0]>n.points.length-1||i.matchedPoints[1]>o.points.length-1)throw Error("Matched points out of range in "+n.name);var f=n.points[i.matchedPoints[0]],h=o.points[i.matchedPoints[1]],p={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};h=Nf([h],p)[0],p.dx=f.x-h.x,p.dy=f.y-h.y,u=Nf(o.points,p)}n.points=n.points.concat(u)}}return Mg(n.points)}function xx(a,n,r,i){for(var o=new tr.GlyphSet(i),u=0;u<r.length-1;u+=1){var f=r[u],h=r[u+1];f!==h?o.push(u,tr.ttfGlyphLoader(i,u,Cg,a,n+f,Ng)):o.push(u,tr.glyphLoader(i,u))}return o}function Sx(a,n,r,i){var o=new tr.GlyphSet(i);return i._push=function(u){var f=r[u],h=r[u+1];f!==h?o.push(u,tr.ttfGlyphLoader(i,u,Cg,a,n+f,Ng)):o.push(u,tr.glyphLoader(i,u))},o}function Ex(a,n,r,i,o){return o.lowMemory?Sx(a,n,r,i):xx(a,n,r,i)}var Rg={getPath:Mg,parse:Ex},Dg,Ps,_g,Xf;function kg(a){this.font=a,this.getCommands=function(n){return Rg.getPath(n).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function wx(a){return a}function Og(a){return Math.sign(a)*Math.round(Math.abs(a))}function Ax(a){return Math.sign(a)*Math.round(Math.abs(a*2))/2}function Tx(a){return Math.sign(a)*(Math.round(Math.abs(a)+.5)-.5)}function Cx(a){return Math.sign(a)*Math.ceil(Math.abs(a))}function Mx(a){return Math.sign(a)*Math.floor(Math.abs(a))}var Lg=function(a){var n=this.srPeriod,r=this.srPhase,i=this.srThreshold,o=1;return a<0&&(a=-a,o=-1),a+=i-r,a=Math.trunc(a/n)*n,a+=r,a<0?r*o:a*o},er={x:1,y:0,axis:"x",distance:function(a,n,r,i){return(r?a.xo:a.x)-(i?n.xo:n.x)},interpolate:function(a,n,r,i){var o,u,f,h,p,v,y;if(!i||i===this){if(o=a.xo-n.xo,u=a.xo-r.xo,p=n.x-n.xo,v=r.x-r.xo,f=Math.abs(o),h=Math.abs(u),y=f+h,y===0){a.x=a.xo+(p+v)/2;return}a.x=a.xo+(p*h+v*f)/y;return}if(o=i.distance(a,n,!0,!0),u=i.distance(a,r,!0,!0),p=i.distance(n,n,!1,!0),v=i.distance(r,r,!1,!0),f=Math.abs(o),h=Math.abs(u),y=f+h,y===0){er.setRelative(a,a,(p+v)/2,i,!0);return}er.setRelative(a,a,(p*h+v*f)/y,i,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(a,n,r,i,o){if(!i||i===this){a.x=(o?n.xo:n.x)+r;return}var u=o?n.xo:n.x,f=o?n.yo:n.y,h=u+r*i.x,p=f+r*i.y;a.x=h+(a.y-p)/i.normalSlope},slope:0,touch:function(a){a.xTouched=!0},touched:function(a){return a.xTouched},untouch:function(a){a.xTouched=!1}},Ar={x:0,y:1,axis:"y",distance:function(a,n,r,i){return(r?a.yo:a.y)-(i?n.yo:n.y)},interpolate:function(a,n,r,i){var o,u,f,h,p,v,y;if(!i||i===this){if(o=a.yo-n.yo,u=a.yo-r.yo,p=n.y-n.yo,v=r.y-r.yo,f=Math.abs(o),h=Math.abs(u),y=f+h,y===0){a.y=a.yo+(p+v)/2;return}a.y=a.yo+(p*h+v*f)/y;return}if(o=i.distance(a,n,!0,!0),u=i.distance(a,r,!0,!0),p=i.distance(n,n,!1,!0),v=i.distance(r,r,!1,!0),f=Math.abs(o),h=Math.abs(u),y=f+h,y===0){Ar.setRelative(a,a,(p+v)/2,i,!0);return}Ar.setRelative(a,a,(p*h+v*f)/y,i,!0)},normalSlope:0,setRelative:function(a,n,r,i,o){if(!i||i===this){a.y=(o?n.yo:n.y)+r;return}var u=o?n.xo:n.x,f=o?n.yo:n.y,h=u+r*i.x,p=f+r*i.y;a.y=p+i.normalSlope*(a.x-h)},slope:Number.POSITIVE_INFINITY,touch:function(a){a.yTouched=!0},touched:function(a){return a.yTouched},untouch:function(a){a.yTouched=!1}};Object.freeze(er);Object.freeze(Ar);function Vl(a,n){this.x=a,this.y=n,this.axis=void 0,this.slope=n/a,this.normalSlope=-a/n,Object.freeze(this)}Vl.prototype.distance=function(a,n,r,i){return this.x*er.distance(a,n,r,i)+this.y*Ar.distance(a,n,r,i)};Vl.prototype.interpolate=function(a,n,r,i){var o,u,f,h,p,v,y;if(f=i.distance(a,n,!0,!0),h=i.distance(a,r,!0,!0),o=i.distance(n,n,!1,!0),u=i.distance(r,r,!1,!0),p=Math.abs(f),v=Math.abs(h),y=p+v,y===0){this.setRelative(a,a,(o+u)/2,i,!0);return}this.setRelative(a,a,(o*v+u*p)/y,i,!0)};Vl.prototype.setRelative=function(a,n,r,i,o){i=i||this;var u=o?n.xo:n.x,f=o?n.yo:n.y,h=u+r*i.x,p=f+r*i.y,v=i.normalSlope,y=this.slope,S=a.x,b=a.y;a.x=(y*S-v*h+p-b)/(y-v),a.y=y*(a.x-S)+b};Vl.prototype.touch=function(a){a.xTouched=!0,a.yTouched=!0};function Xl(a,n){var r=Math.sqrt(a*a+n*n);return a/=r,n/=r,a===1&&n===0?er:a===0&&n===1?Ar:new Vl(a,n)}function Tr(a,n,r,i){this.x=this.xo=Math.round(a*64)/64,this.y=this.yo=Math.round(n*64)/64,this.lastPointOfContour=r,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Tr.prototype.nextTouched=function(a){for(var n=this.nextPointOnContour;!a.touched(n)&&n!==this;)n=n.nextPointOnContour;return n};Tr.prototype.prevTouched=function(a){for(var n=this.prevPointOnContour;!a.touched(n)&&n!==this;)n=n.prevPointOnContour;return n};var zl=Object.freeze(new Tr(0,0)),Nx={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function os(a,n){switch(this.env=a,this.stack=[],this.prog=n,a){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=er,this.round=Og}}kg.prototype.exec=function(a,n){if(typeof n!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var r=this.font,i=this._prepState;if(!i||i.ppem!==n){var o=this._fpgmState;if(!o){os.prototype=Nx,o=this._fpgmState=new os("fpgm",r.tables.fpgm),o.funcs=[],o.font=r,exports.DEBUG&&(console.log("---EXEC FPGM---"),o.step=-1);try{Ps(o)}catch(v){console.log("Hinting error in FPGM:"+v),this._errorState=3;return}}os.prototype=o,i=this._prepState=new os("prep",r.tables.prep),i.ppem=n;var u=r.tables.cvt;if(u)for(var f=i.cvt=new Array(u.length),h=n/r.unitsPerEm,p=0;p<u.length;p++)f[p]=u[p]*h;else i.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),i.step=-1);try{Ps(i)}catch(v){this._errorState<2&&console.log("Hinting error in PREP:"+v),this._errorState=2}}if(!(this._errorState>1))try{return _g(a,i)}catch(v){this._errorState<1&&(console.log("Hinting error:"+v),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};_g=function(a,n){var r=n.ppem/n.font.unitsPerEm,i=r,o=a.components,u,f,h;if(os.prototype=n,!o)h=new os("glyf",a.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),h.step=-1),Xf(a,h,r,i),f=h.gZone;else{var p=n.font;f=[],u=[];for(var v=0;v<o.length;v++){var y=o[v],S=p.glyphs.get(y.glyphIndex);h=new os("glyf",S.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+v+"---"),h.step=-1),Xf(S,h,r,i);for(var b=Math.round(y.dx*r),x=Math.round(y.dy*i),E=h.gZone,A=h.contours,D=0;D<E.length;D++){var F=E[D];F.xTouched=F.yTouched=!1,F.xo=F.x=F.x+b,F.yo=F.y=F.y+x}var R=f.length;f.push.apply(f,E);for(var N=0;N<A.length;N++)u.push(A[N]+R)}a.instructions&&!h.inhibitGridFit&&(h=new os("glyf",a.instructions),h.gZone=h.z0=h.z1=h.z2=f,h.contours=u,f.push(new Tr(0,0),new Tr(Math.round(a.advanceWidth*r),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),h.step=-1),Ps(h),f.length-=2)}return f};Xf=function(a,n,r,i){for(var o=a.points||[],u=o.length,f=n.gZone=n.z0=n.z1=n.z2=[],h=n.contours=[],p,v=0;v<u;v++)p=o[v],f[v]=new Tr(p.x*r,p.y*i,p.lastPointOfContour,p.onCurve);for(var y,S,b=0;b<u;b++)p=f[b],y||(y=p,h.push(b)),p.lastPointOfContour?(p.nextPointOnContour=y,y.prevPointOnContour=p,y=void 0):(S=f[b+1],p.nextPointOnContour=S,S.prevPointOnContour=p);if(!n.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",n.stack);for(var x=0;x<u;x++)console.log(x,f[x].x,f[x].y)}if(f.push(new Tr(0,0),new Tr(Math.round(a.advanceWidth*r),0)),Ps(n),f.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",n.stack);for(var E=0;E<u;E++)console.log(E,f[E].x,f[E].y)}}};Ps=function(a){var n=a.prog;if(n){var r=n.length,i;for(a.ip=0;a.ip<r;a.ip++){if(exports.DEBUG&&a.step++,i=Dg[n[a.ip]],!i)throw new Error("unknown instruction: 0x"+Number(n[a.ip]).toString(16));i(a)}}};function Ac(a){for(var n=a.tZone=new Array(a.gZone.length),r=0;r<n.length;r++)n[r]=new Tr(0,0)}function Ug(a,n){var r=a.prog,i=a.ip,o=1,u;do if(u=r[++i],u===88)o++;else if(u===89)o--;else if(u===64)i+=r[i+1]+1;else if(u===65)i+=2*r[i+1]+1;else if(u>=176&&u<=183)i+=u-176+1;else if(u>=184&&u<=191)i+=(u-184+1)*2;else if(n&&o===1&&u===27)break;while(o>0);a.ip=i}function im(a,n){exports.DEBUG&&console.log(n.step,"SVTCA["+a.axis+"]"),n.fv=n.pv=n.dpv=a}function lm(a,n){exports.DEBUG&&console.log(n.step,"SPVTCA["+a.axis+"]"),n.pv=n.dpv=a}function om(a,n){exports.DEBUG&&console.log(n.step,"SFVTCA["+a.axis+"]"),n.fv=a}function cm(a,n){var r=n.stack,i=r.pop(),o=r.pop(),u=n.z2[i],f=n.z1[o];exports.DEBUG&&console.log("SPVTL["+a+"]",i,o);var h,p;a?(h=u.y-f.y,p=f.x-u.x):(h=f.x-u.x,p=f.y-u.y),n.pv=n.dpv=Xl(h,p)}function um(a,n){var r=n.stack,i=r.pop(),o=r.pop(),u=n.z2[i],f=n.z1[o];exports.DEBUG&&console.log("SFVTL["+a+"]",i,o);var h,p;a?(h=u.y-f.y,p=f.x-u.x):(h=f.x-u.x,p=f.y-u.y),n.fv=Xl(h,p)}function Rx(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"SPVFS[]",r,i),a.pv=a.dpv=Xl(i,r)}function Dx(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"SPVFS[]",r,i),a.fv=Xl(i,r)}function _x(a){var n=a.stack,r=a.pv;exports.DEBUG&&console.log(a.step,"GPV[]"),n.push(r.x*16384),n.push(r.y*16384)}function kx(a){var n=a.stack,r=a.fv;exports.DEBUG&&console.log(a.step,"GFV[]"),n.push(r.x*16384),n.push(r.y*16384)}function Ox(a){a.fv=a.pv,exports.DEBUG&&console.log(a.step,"SFVTPV[]")}function Lx(a){var n=a.stack,r=n.pop(),i=n.pop(),o=n.pop(),u=n.pop(),f=n.pop(),h=a.z0,p=a.z1,v=h[r],y=h[i],S=p[o],b=p[u],x=a.z2[f];exports.DEBUG&&console.log("ISECT[], ",r,i,o,u,f);var E=v.x,A=v.y,D=y.x,F=y.y,R=S.x,N=S.y,_=b.x,M=b.y,j=(E-D)*(N-M)-(A-F)*(R-_),B=E*F-A*D,H=R*M-N*_;x.x=(B*(R-_)-H*(E-D))/j,x.y=(B*(N-M)-H*(A-F))/j}function Ux(a){a.rp0=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP0[]",a.rp0)}function Ix(a){a.rp1=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP1[]",a.rp1)}function Bx(a){a.rp2=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP2[]",a.rp2)}function Fx(a){var n=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP0[]",n),a.zp0=n,n){case 0:a.tZone||Ac(a),a.z0=a.tZone;break;case 1:a.z0=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function jx(a){var n=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP1[]",n),a.zp1=n,n){case 0:a.tZone||Ac(a),a.z1=a.tZone;break;case 1:a.z1=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Px(a){var n=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP2[]",n),a.zp2=n,n){case 0:a.tZone||Ac(a),a.z2=a.tZone;break;case 1:a.z2=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Gx(a){var n=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZPS[]",n),a.zp0=a.zp1=a.zp2=n,n){case 0:a.tZone||Ac(a),a.z0=a.z1=a.z2=a.tZone;break;case 1:a.z0=a.z1=a.z2=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function zx(a){a.loop=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SLOOP[]",a.loop)}function Hx(a){exports.DEBUG&&console.log(a.step,"RTG[]"),a.round=Og}function Yx(a){exports.DEBUG&&console.log(a.step,"RTHG[]"),a.round=Tx}function qx(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"SMD[]",n),a.minDis=n/64}function Vx(a){exports.DEBUG&&console.log(a.step,"ELSE[]"),Ug(a,!1)}function Xx(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"JMPR[]",n),a.ip+=n-1}function Qx(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCVTCI[]",n),a.cvCutIn=n/64}function Zx(a){var n=a.stack;exports.DEBUG&&console.log(a.step,"DUP[]"),n.push(n[n.length-1])}function Rf(a){exports.DEBUG&&console.log(a.step,"POP[]"),a.stack.pop()}function $x(a){exports.DEBUG&&console.log(a.step,"CLEAR[]"),a.stack.length=0}function Wx(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"SWAP[]"),n.push(r),n.push(i)}function Kx(a){var n=a.stack;exports.DEBUG&&console.log(a.step,"DEPTH[]"),n.push(n.length)}function Jx(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"LOOPCALL[]",r,i);var o=a.ip,u=a.prog;a.prog=a.funcs[r];for(var f=0;f<i;f++)Ps(a),exports.DEBUG&&console.log(++a.step,f+1<i?"next loopcall":"done loopcall",f);a.ip=o,a.prog=u}function eS(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"CALL[]",n);var r=a.ip,i=a.prog;a.prog=a.funcs[n],Ps(a),a.ip=r,a.prog=i,exports.DEBUG&&console.log(++a.step,"returning from",n)}function tS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"CINDEX[]",r),n.push(n[n.length-r])}function nS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"MINDEX[]",r),n.push(n.splice(n.length-r,1)[0])}function aS(a){if(a.env!=="fpgm")throw new Error("FDEF not allowed here");var n=a.stack,r=a.prog,i=a.ip,o=n.pop(),u=i;for(exports.DEBUG&&console.log(a.step,"FDEF[]",o);r[++i]!==45;);a.ip=i,a.funcs[o]=r.slice(u+1,i)}function fm(a,n){var r=n.stack.pop(),i=n.z0[r],o=n.fv,u=n.pv;exports.DEBUG&&console.log(n.step,"MDAP["+a+"]",r);var f=u.distance(i,zl);a&&(f=n.round(f)),o.setRelative(i,zl,f,u),o.touch(i),n.rp0=n.rp1=r}function dm(a,n){var r=n.z2,i=r.length-2,o,u,f;exports.DEBUG&&console.log(n.step,"IUP["+a.axis+"]");for(var h=0;h<i;h++)o=r[h],!a.touched(o)&&(u=o.prevTouched(a),u!==o&&(f=o.nextTouched(a),u===f&&a.setRelative(o,o,a.distance(u,u,!1,!0),a,!0),a.interpolate(o,u,f,a)))}function pm(a,n){for(var r=n.stack,i=a?n.rp1:n.rp2,o=(a?n.z0:n.z1)[i],u=n.fv,f=n.pv,h=n.loop,p=n.z2;h--;){var v=r.pop(),y=p[v],S=f.distance(o,o,!1,!0);u.setRelative(y,y,S,f),u.touch(y),exports.DEBUG&&console.log(n.step,(n.loop>1?"loop "+(n.loop-h)+": ":"")+"SHP["+(a?"rp1":"rp2")+"]",v)}n.loop=1}function hm(a,n){var r=n.stack,i=a?n.rp1:n.rp2,o=(a?n.z0:n.z1)[i],u=n.fv,f=n.pv,h=r.pop(),p=n.z2[n.contours[h]],v=p;exports.DEBUG&&console.log(n.step,"SHC["+a+"]",h);var y=f.distance(o,o,!1,!0);do v!==o&&u.setRelative(v,v,y,f),v=v.nextPointOnContour;while(v!==p)}function mm(a,n){var r=n.stack,i=a?n.rp1:n.rp2,o=(a?n.z0:n.z1)[i],u=n.fv,f=n.pv,h=r.pop();exports.DEBUG&&console.log(n.step,"SHZ["+a+"]",h);var p;switch(h){case 0:p=n.tZone;break;case 1:p=n.gZone;break;default:throw new Error("Invalid zone")}for(var v,y=f.distance(o,o,!1,!0),S=p.length-2,b=0;b<S;b++)v=p[b],u.setRelative(v,v,y,f)}function rS(a){for(var n=a.stack,r=a.loop,i=a.fv,o=n.pop()/64,u=a.z2;r--;){var f=n.pop(),h=u[f];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-r)+": ":"")+"SHPIX[]",f,o),i.setRelative(h,h,o),i.touch(h)}a.loop=1}function sS(a){for(var n=a.stack,r=a.rp1,i=a.rp2,o=a.loop,u=a.z0[r],f=a.z1[i],h=a.fv,p=a.dpv,v=a.z2;o--;){var y=n.pop(),S=v[y];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-o)+": ":"")+"IP[]",y,r,"<->",i),h.interpolate(S,u,f,p),h.touch(S)}a.loop=1}function gm(a,n){var r=n.stack,i=r.pop()/64,o=r.pop(),u=n.z1[o],f=n.z0[n.rp0],h=n.fv,p=n.pv;h.setRelative(u,f,i,p),h.touch(u),exports.DEBUG&&console.log(n.step,"MSIRP["+a+"]",i,o),n.rp1=n.rp0,n.rp2=o,a&&(n.rp0=o)}function iS(a){for(var n=a.stack,r=a.rp0,i=a.z0[r],o=a.loop,u=a.fv,f=a.pv,h=a.z1;o--;){var p=n.pop(),v=h[p];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-o)+": ":"")+"ALIGNRP[]",p),u.setRelative(v,i,0,f),u.touch(v)}a.loop=1}function lS(a){exports.DEBUG&&console.log(a.step,"RTDG[]"),a.round=Ax}function vm(a,n){var r=n.stack,i=r.pop(),o=r.pop(),u=n.z0[o],f=n.fv,h=n.pv,p=n.cvt[i];exports.DEBUG&&console.log(n.step,"MIAP["+a+"]",i,"(",p,")",o);var v=h.distance(u,zl);a&&(Math.abs(v-p)<n.cvCutIn&&(v=p),v=n.round(v)),f.setRelative(u,zl,v,h),n.zp0===0&&(u.xo=u.x,u.yo=u.y),f.touch(u),n.rp0=n.rp1=o}function oS(a){var n=a.prog,r=a.ip,i=a.stack,o=n[++r];exports.DEBUG&&console.log(a.step,"NPUSHB[]",o);for(var u=0;u<o;u++)i.push(n[++r]);a.ip=r}function cS(a){var n=a.ip,r=a.prog,i=a.stack,o=r[++n];exports.DEBUG&&console.log(a.step,"NPUSHW[]",o);for(var u=0;u<o;u++){var f=r[++n]<<8|r[++n];f&32768&&(f=-((f^65535)+1)),i.push(f)}a.ip=n}function uS(a){var n=a.stack,r=a.store;r||(r=a.store=[]);var i=n.pop(),o=n.pop();exports.DEBUG&&console.log(a.step,"WS",i,o),r[o]=i}function fS(a){var n=a.stack,r=a.store,i=n.pop();exports.DEBUG&&console.log(a.step,"RS",i);var o=r&&r[i]||0;n.push(o)}function dS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"WCVTP",r,i),a.cvt[i]=r/64}function pS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"RCVT",r),n.push(a.cvt[r]*64)}function ym(a,n){var r=n.stack,i=r.pop(),o=n.z2[i];exports.DEBUG&&console.log(n.step,"GC["+a+"]",i),r.push(n.dpv.distance(o,zl,a,!1)*64)}function bm(a,n){var r=n.stack,i=r.pop(),o=r.pop(),u=n.z1[i],f=n.z0[o],h=n.dpv.distance(f,u,a,a);exports.DEBUG&&console.log(n.step,"MD["+a+"]",i,o,"->",h),n.stack.push(Math.round(h*64))}function hS(a){exports.DEBUG&&console.log(a.step,"MPPEM[]"),a.stack.push(a.ppem)}function mS(a){exports.DEBUG&&console.log(a.step,"FLIPON[]"),a.autoFlip=!0}function gS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"LT[]",r,i),n.push(i<r?1:0)}function vS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"LTEQ[]",r,i),n.push(i<=r?1:0)}function yS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"GT[]",r,i),n.push(i>r?1:0)}function bS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"GTEQ[]",r,i),n.push(i>=r?1:0)}function xS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"EQ[]",r,i),n.push(r===i?1:0)}function SS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"NEQ[]",r,i),n.push(r!==i?1:0)}function ES(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"ODD[]",r),n.push(Math.trunc(r)%2?1:0)}function wS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"EVEN[]",r),n.push(Math.trunc(r)%2?0:1)}function AS(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"IF[]",n),n||(Ug(a,!0),exports.DEBUG&&console.log(a.step,"EIF[]"))}function TS(a){exports.DEBUG&&console.log(a.step,"EIF[]")}function CS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"AND[]",r,i),n.push(r&&i?1:0)}function MS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"OR[]",r,i),n.push(r||i?1:0)}function NS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"NOT[]",r),n.push(r?0:1)}function Df(a,n){var r=n.stack,i=r.pop(),o=n.fv,u=n.pv,f=n.ppem,h=n.deltaBase+(a-1)*16,p=n.deltaShift,v=n.z0;exports.DEBUG&&console.log(n.step,"DELTAP["+a+"]",i,r);for(var y=0;y<i;y++){var S=r.pop(),b=r.pop(),x=h+((b&240)>>4);if(x===f){var E=(b&15)-8;E>=0&&E++,exports.DEBUG&&console.log(n.step,"DELTAPFIX",S,"by",E*p);var A=v[S];o.setRelative(A,A,E*p,u)}}}function RS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"SDB[]",r),a.deltaBase=r}function DS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"SDS[]",r),a.deltaShift=Math.pow(.5,r)}function _S(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"ADD[]",r,i),n.push(i+r)}function kS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"SUB[]",r,i),n.push(i-r)}function OS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"DIV[]",r,i),n.push(i*64/r)}function LS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"MUL[]",r,i),n.push(i*r/64)}function US(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"ABS[]",r),n.push(Math.abs(r))}function IS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"NEG[]",r),n.push(-r)}function BS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"FLOOR[]",r),n.push(Math.floor(r/64)*64)}function FS(a){var n=a.stack,r=n.pop();exports.DEBUG&&console.log(a.step,"CEILING[]",r),n.push(Math.ceil(r/64)*64)}function fc(a,n){var r=n.stack,i=r.pop();exports.DEBUG&&console.log(n.step,"ROUND[]"),r.push(n.round(i/64)*64)}function jS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"WCVTF[]",r,i),a.cvt[i]=r*a.ppem/a.font.unitsPerEm}function _f(a,n){var r=n.stack,i=r.pop(),o=n.ppem,u=n.deltaBase+(a-1)*16,f=n.deltaShift;exports.DEBUG&&console.log(n.step,"DELTAC["+a+"]",i,r);for(var h=0;h<i;h++){var p=r.pop(),v=r.pop(),y=u+((v&240)>>4);if(y===o){var S=(v&15)-8;S>=0&&S++;var b=S*f;exports.DEBUG&&console.log(n.step,"DELTACFIX",p,"by",b),n.cvt[p]+=b}}}function PS(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"SROUND[]",n),a.round=Lg;var r;switch(n&192){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(a.srPeriod=r,n&48){case 0:a.srPhase=0;break;case 16:a.srPhase=.25*r;break;case 32:a.srPhase=.5*r;break;case 48:a.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}n&=15,n===0?a.srThreshold=0:a.srThreshold=(n/8-.5)*r}function GS(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"S45ROUND[]",n),a.round=Lg;var r;switch(n&192){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(a.srPeriod=r,n&48){case 0:a.srPhase=0;break;case 16:a.srPhase=.25*r;break;case 32:a.srPhase=.5*r;break;case 48:a.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}n&=15,n===0?a.srThreshold=0:a.srThreshold=(n/8-.5)*r}function zS(a){exports.DEBUG&&console.log(a.step,"ROFF[]"),a.round=wx}function HS(a){exports.DEBUG&&console.log(a.step,"RUTG[]"),a.round=Cx}function YS(a){exports.DEBUG&&console.log(a.step,"RDTG[]"),a.round=Mx}function qS(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCANCTRL[]",n)}function xm(a,n){var r=n.stack,i=r.pop(),o=r.pop(),u=n.z2[i],f=n.z1[o];exports.DEBUG&&console.log(n.step,"SDPVTL["+a+"]",i,o);var h,p;a?(h=u.y-f.y,p=f.x-u.x):(h=f.x-u.x,p=f.y-u.y),n.dpv=Xl(h,p)}function VS(a){var n=a.stack,r=n.pop(),i=0;exports.DEBUG&&console.log(a.step,"GETINFO[]",r),r&1&&(i=35),r&32&&(i|=4096),n.push(i)}function XS(a){var n=a.stack,r=n.pop(),i=n.pop(),o=n.pop();exports.DEBUG&&console.log(a.step,"ROLL[]"),n.push(i),n.push(r),n.push(o)}function QS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"MAX[]",r,i),n.push(Math.max(i,r))}function ZS(a){var n=a.stack,r=n.pop(),i=n.pop();exports.DEBUG&&console.log(a.step,"MIN[]",r,i),n.push(Math.min(i,r))}function $S(a){var n=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCANTYPE[]",n)}function WS(a){var n=a.stack.pop(),r=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"INSTCTRL[]",n,r),n){case 1:a.inhibitGridFit=!!r;return;case 2:a.ignoreCvt=!!r;return;default:throw new Error("invalid INSTCTRL[] selector")}}function ss(a,n){var r=n.stack,i=n.prog,o=n.ip;exports.DEBUG&&console.log(n.step,"PUSHB["+a+"]");for(var u=0;u<a;u++)r.push(i[++o]);n.ip=o}function is(a,n){var r=n.ip,i=n.prog,o=n.stack;exports.DEBUG&&console.log(n.ip,"PUSHW["+a+"]");for(var u=0;u<a;u++){var f=i[++r]<<8|i[++r];f&32768&&(f=-((f^65535)+1)),o.push(f)}n.ip=r}function Ie(a,n,r,i,o,u){var f=u.stack,h=a&&f.pop(),p=f.pop(),v=u.rp0,y=u.z0[v],S=u.z1[p],b=u.minDis,x=u.fv,E=u.dpv,A,D,F,R;D=A=E.distance(S,y,!0,!0),F=D>=0?1:-1,D=Math.abs(D),a&&(R=u.cvt[h],i&&Math.abs(D-R)<u.cvCutIn&&(D=R)),r&&D<b&&(D=b),i&&(D=u.round(D)),x.setRelative(S,y,F*D,E),x.touch(S),exports.DEBUG&&console.log(u.step,(a?"MIRP[":"MDRP[")+(n?"M":"m")+(r?">":"_")+(i?"R":"_")+(o===0?"Gr":o===1?"Bl":o===2?"Wh":"")+"]",a?h+"("+u.cvt[h]+","+R+")":"",p,"(d =",A,"->",F*D,")"),u.rp1=u.rp0,u.rp2=p,n&&(u.rp0=p)}Dg=[im.bind(void 0,Ar),im.bind(void 0,er),lm.bind(void 0,Ar),lm.bind(void 0,er),om.bind(void 0,Ar),om.bind(void 0,er),cm.bind(void 0,0),cm.bind(void 0,1),um.bind(void 0,0),um.bind(void 0,1),Rx,Dx,_x,kx,Ox,Lx,Ux,Ix,Bx,Fx,jx,Px,Gx,zx,Hx,Yx,qx,Vx,Xx,Qx,void 0,void 0,Zx,Rf,$x,Wx,Kx,tS,nS,void 0,void 0,void 0,Jx,eS,aS,void 0,fm.bind(void 0,0),fm.bind(void 0,1),dm.bind(void 0,Ar),dm.bind(void 0,er),pm.bind(void 0,0),pm.bind(void 0,1),hm.bind(void 0,0),hm.bind(void 0,1),mm.bind(void 0,0),mm.bind(void 0,1),rS,sS,gm.bind(void 0,0),gm.bind(void 0,1),iS,lS,vm.bind(void 0,0),vm.bind(void 0,1),oS,cS,uS,fS,dS,pS,ym.bind(void 0,0),ym.bind(void 0,1),void 0,bm.bind(void 0,0),bm.bind(void 0,1),hS,void 0,mS,void 0,void 0,gS,vS,yS,bS,xS,SS,ES,wS,AS,TS,CS,MS,NS,Df.bind(void 0,1),RS,DS,_S,kS,OS,LS,US,IS,BS,FS,fc.bind(void 0,0),fc.bind(void 0,1),fc.bind(void 0,2),fc.bind(void 0,3),void 0,void 0,void 0,void 0,jS,Df.bind(void 0,2),Df.bind(void 0,3),_f.bind(void 0,1),_f.bind(void 0,2),_f.bind(void 0,3),PS,GS,void 0,void 0,zS,void 0,HS,YS,Rf,Rf,void 0,void 0,void 0,void 0,void 0,qS,xm.bind(void 0,0),xm.bind(void 0,1),VS,void 0,XS,QS,ZS,$S,WS,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ss.bind(void 0,1),ss.bind(void 0,2),ss.bind(void 0,3),ss.bind(void 0,4),ss.bind(void 0,5),ss.bind(void 0,6),ss.bind(void 0,7),ss.bind(void 0,8),is.bind(void 0,1),is.bind(void 0,2),is.bind(void 0,3),is.bind(void 0,4),is.bind(void 0,5),is.bind(void 0,6),is.bind(void 0,7),is.bind(void 0,8),Ie.bind(void 0,0,0,0,0,0),Ie.bind(void 0,0,0,0,0,1),Ie.bind(void 0,0,0,0,0,2),Ie.bind(void 0,0,0,0,0,3),Ie.bind(void 0,0,0,0,1,0),Ie.bind(void 0,0,0,0,1,1),Ie.bind(void 0,0,0,0,1,2),Ie.bind(void 0,0,0,0,1,3),Ie.bind(void 0,0,0,1,0,0),Ie.bind(void 0,0,0,1,0,1),Ie.bind(void 0,0,0,1,0,2),Ie.bind(void 0,0,0,1,0,3),Ie.bind(void 0,0,0,1,1,0),Ie.bind(void 0,0,0,1,1,1),Ie.bind(void 0,0,0,1,1,2),Ie.bind(void 0,0,0,1,1,3),Ie.bind(void 0,0,1,0,0,0),Ie.bind(void 0,0,1,0,0,1),Ie.bind(void 0,0,1,0,0,2),Ie.bind(void 0,0,1,0,0,3),Ie.bind(void 0,0,1,0,1,0),Ie.bind(void 0,0,1,0,1,1),Ie.bind(void 0,0,1,0,1,2),Ie.bind(void 0,0,1,0,1,3),Ie.bind(void 0,0,1,1,0,0),Ie.bind(void 0,0,1,1,0,1),Ie.bind(void 0,0,1,1,0,2),Ie.bind(void 0,0,1,1,0,3),Ie.bind(void 0,0,1,1,1,0),Ie.bind(void 0,0,1,1,1,1),Ie.bind(void 0,0,1,1,1,2),Ie.bind(void 0,0,1,1,1,3),Ie.bind(void 0,1,0,0,0,0),Ie.bind(void 0,1,0,0,0,1),Ie.bind(void 0,1,0,0,0,2),Ie.bind(void 0,1,0,0,0,3),Ie.bind(void 0,1,0,0,1,0),Ie.bind(void 0,1,0,0,1,1),Ie.bind(void 0,1,0,0,1,2),Ie.bind(void 0,1,0,0,1,3),Ie.bind(void 0,1,0,1,0,0),Ie.bind(void 0,1,0,1,0,1),Ie.bind(void 0,1,0,1,0,2),Ie.bind(void 0,1,0,1,0,3),Ie.bind(void 0,1,0,1,1,0),Ie.bind(void 0,1,0,1,1,1),Ie.bind(void 0,1,0,1,1,2),Ie.bind(void 0,1,0,1,1,3),Ie.bind(void 0,1,1,0,0,0),Ie.bind(void 0,1,1,0,0,1),Ie.bind(void 0,1,1,0,0,2),Ie.bind(void 0,1,1,0,0,3),Ie.bind(void 0,1,1,0,1,0),Ie.bind(void 0,1,1,0,1,1),Ie.bind(void 0,1,1,0,1,2),Ie.bind(void 0,1,1,0,1,3),Ie.bind(void 0,1,1,1,0,0),Ie.bind(void 0,1,1,1,0,1),Ie.bind(void 0,1,1,1,0,2),Ie.bind(void 0,1,1,1,0,3),Ie.bind(void 0,1,1,1,1,0),Ie.bind(void 0,1,1,1,1,1),Ie.bind(void 0,1,1,1,1,2),Ie.bind(void 0,1,1,1,1,3)];function Bi(a){this.char=a,this.state={},this.activeState=null}function od(a,n,r){this.contextName=r,this.startIndex=a,this.endOffset=n}function KS(a,n,r){this.contextName=a,this.openRange=null,this.ranges=[],this.checkStart=n,this.checkEnd=r}function ka(a,n){this.context=a,this.index=n,this.length=a.length,this.current=a[n],this.backtrack=a.slice(0,n),this.lookahead=a.slice(n+1)}function Tc(a){this.eventId=a,this.subscribers=[]}function JS(a){var n=this,r=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];r.forEach(function(o){Object.defineProperty(n.events,o,{value:new Tc(o)})}),a&&r.forEach(function(o){var u=a[o];typeof u=="function"&&n.events[o].subscribe(u)});var i=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];i.forEach(function(o){n.events[o].subscribe(n.updateContextsRanges)})}function Xt(a){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],JS.call(this,a)}Bi.prototype.setState=function(a,n){return this.state[a]=n,this.activeState={key:a,value:this.state[a]},this.activeState};Bi.prototype.getState=function(a){return this.state[a]||null};Xt.prototype.inboundIndex=function(a){return a>=0&&a<this.tokens.length};Xt.prototype.composeRUD=function(a){var n=this,r=!0,i=a.map(function(u){return n[u[0]].apply(n,u.slice(1).concat(r))}),o=function(u){return typeof u=="object"&&u.hasOwnProperty("FAIL")};if(i.every(o))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:i.filter(o)};this.dispatch("composeRUD",[i.filter(function(u){return!o(u)})])};Xt.prototype.replaceRange=function(a,n,r,i){n=n!==null?n:this.tokens.length;var o=r.every(function(f){return f instanceof Bi});if(!isNaN(a)&&this.inboundIndex(a)&&o){var u=this.tokens.splice.apply(this.tokens,[a,n].concat(r));return i||this.dispatch("replaceToken",[a,n,r]),[u,r]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};Xt.prototype.replaceToken=function(a,n,r){if(!isNaN(a)&&this.inboundIndex(a)&&n instanceof Bi){var i=this.tokens.splice(a,1,n);return r||this.dispatch("replaceToken",[a,n]),[i[0],n]}else return{FAIL:"replaceToken: invalid token or index."}};Xt.prototype.removeRange=function(a,n,r){n=isNaN(n)?this.tokens.length:n;var i=this.tokens.splice(a,n);return r||this.dispatch("removeRange",[i,a,n]),i};Xt.prototype.removeToken=function(a,n){if(!isNaN(a)&&this.inboundIndex(a)){var r=this.tokens.splice(a,1);return n||this.dispatch("removeToken",[r,a]),r}else return{FAIL:"removeToken: invalid token index."}};Xt.prototype.insertToken=function(a,n,r){var i=a.every(function(o){return o instanceof Bi});return i?(this.tokens.splice.apply(this.tokens,[n,0].concat(a)),r||this.dispatch("insertToken",[a,n]),a):{FAIL:"insertToken: invalid token(s)."}};Xt.prototype.registerModifier=function(a,n,r){this.events.newToken.subscribe(function(i,o){var u=[i,o],f=n===null||n.apply(this,u)===!0,h=[i,o];if(f){var p=r.apply(this,h);i.setState(a,p)}}),this.registeredModifiers.push(a)};Tc.prototype.subscribe=function(a){return typeof a=="function"?this.subscribers.push(a)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};Tc.prototype.unsubscribe=function(a){this.subscribers.splice(a,1)};ka.prototype.setCurrentIndex=function(a){this.index=a,this.current=this.context[a],this.backtrack=this.context.slice(0,a),this.lookahead=this.context.slice(a+1)};ka.prototype.get=function(a){switch(!0){case a===0:return this.current;case(a<0&&Math.abs(a)<=this.backtrack.length):return this.backtrack.slice(a)[0];case(a>0&&a<=this.lookahead.length):return this.lookahead[a-1];default:return null}};Xt.prototype.rangeToText=function(a){if(a instanceof od)return this.getRangeTokens(a).map(function(n){return n.char}).join("")};Xt.prototype.getText=function(){return this.tokens.map(function(a){return a.char}).join("")};Xt.prototype.getContext=function(a){var n=this.registeredContexts[a];return n||null};Xt.prototype.on=function(a,n){var r=this.events[a];return r?r.subscribe(n):null};Xt.prototype.dispatch=function(a,n){var r=this,i=this.events[a];i instanceof Tc&&i.subscribers.forEach(function(o){o.apply(r,n||[])})};Xt.prototype.registerContextChecker=function(a,n,r){if(this.getContext(a))return{FAIL:"context name '"+a+"' is already registered."};if(typeof n!="function")return{FAIL:"missing context start check."};if(typeof r!="function")return{FAIL:"missing context end check."};var i=new KS(a,n,r);return this.registeredContexts[a]=i,this.contextCheckers.push(i),i};Xt.prototype.getRangeTokens=function(a){var n=a.startIndex+a.endOffset;return[].concat(this.tokens.slice(a.startIndex,n))};Xt.prototype.getContextRanges=function(a){var n=this.getContext(a);return n?n.ranges:{FAIL:"context checker '"+a+"' is not registered."}};Xt.prototype.resetContextsRanges=function(){var a=this.registeredContexts;for(var n in a)if(a.hasOwnProperty(n)){var r=a[n];r.ranges=[]}};Xt.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var a=this.tokens.map(function(i){return i.char}),n=0;n<a.length;n++){var r=new ka(a,n);this.runContextCheck(r)}this.dispatch("updateContextsRanges",[this.registeredContexts])};Xt.prototype.setEndOffset=function(a,n){var r=this.getContext(n).openRange.startIndex,i=new od(r,a,n),o=this.getContext(n).ranges;return i.rangeId=n+"."+o.length,o.push(i),this.getContext(n).openRange=null,i};Xt.prototype.runContextCheck=function(a){var n=this,r=a.index;this.contextCheckers.forEach(function(i){var o=i.contextName,u=n.getContext(o).openRange;if(!u&&i.checkStart(a)&&(u=new od(r,null,o),n.getContext(o).openRange=u,n.dispatch("contextStart",[o,r])),u&&i.checkEnd(a)){var f=r-u.startIndex+1,h=n.setEndOffset(f,o);n.dispatch("contextEnd",[o,h])}})};Xt.prototype.tokenize=function(a){this.tokens=[],this.resetContextsRanges();var n=Array.from(a);this.dispatch("start");for(var r=0;r<n.length;r++){var i=n[r],o=new ka(n,r);this.dispatch("next",[o]),this.runContextCheck(o);var u=new Bi(i);this.tokens.push(u),this.dispatch("newToken",[u,o])}return this.dispatch("end",[this.tokens]),this.tokens};function cs(a){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(a)}function Ig(a){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(a)}function us(a){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(a)}function mc(a){return/[A-z]/.test(a)}function e2(a){return/\s/.test(a)}function sa(a){this.font=a,this.features={}}function js(a){this.id=a.id,this.tag=a.tag,this.substitution=a.substitution}function Ql(a,n){if(!a)return-1;switch(n.format){case 1:return n.glyphs.indexOf(a);case 2:for(var r=n.ranges,i=0;i<r.length;i++){var o=r[i];if(a>=o.start&&a<=o.end){var u=a-o.start;return o.index+u}}break;default:return-1}return-1}function t2(a,n){var r=Ql(a,n.coverage);return r===-1?null:a+n.deltaGlyphId}function n2(a,n){var r=Ql(a,n.coverage);return r===-1?null:n.substitute[r]}function kf(a,n){for(var r=[],i=0;i<a.length;i++){var o=a[i],u=n.current;u=Array.isArray(u)?u[0]:u;var f=Ql(u,o);f!==-1&&r.push(f)}return r.length!==a.length?-1:r}function a2(a,n){var r=n.inputCoverage.length+n.lookaheadCoverage.length+n.backtrackCoverage.length;if(a.context.length<r)return[];var i=kf(n.inputCoverage,a);if(i===-1)return[];var o=n.inputCoverage.length-1;if(a.lookahead.length<n.lookaheadCoverage.length)return[];for(var u=a.lookahead.slice(o);u.length&&us(u[0].char);)u.shift();var f=new ka(u,0),h=kf(n.lookaheadCoverage,f),p=[].concat(a.backtrack);for(p.reverse();p.length&&us(p[0].char);)p.shift();if(p.length<n.backtrackCoverage.length)return[];var v=new ka(p,0),y=kf(n.backtrackCoverage,v),S=i.length===n.inputCoverage.length&&h.length===n.lookaheadCoverage.length&&y.length===n.backtrackCoverage.length,b=[];if(S)for(var x=0;x<n.lookupRecords.length;x++)for(var E=n.lookupRecords[x],A=E.lookupListIndex,D=this.getLookupByIndex(A),F=0;F<D.subtables.length;F++){var R=D.subtables[F],N=this.getLookupMethod(D,R),_=this.getSubstitutionType(D,R);if(_==="12")for(var M=0;M<i.length;M++){var j=a.get(M),B=N(j);B&&b.push(B)}}return b}function r2(a,n){var r=a.current,i=Ql(r,n.coverage);if(i===-1)return null;for(var o,u=n.ligatureSets[i],f=0;f<u.length;f++){o=u[f];for(var h=0;h<o.components.length;h++){var p=a.lookahead[h],v=o.components[h];if(p!==v)break;if(h===o.components.length-1)return o}}return null}function s2(a,n){var r=Ql(a,n.coverage);return r===-1?null:n.sequences[r]}sa.prototype.getDefaultScriptFeaturesIndexes=function(){for(var a=this.font.tables.gsub.scripts,n=0;n<a.length;n++){var r=a[n];if(r.tag==="DFLT")return r.script.defaultLangSys.featureIndexes}return[]};sa.prototype.getScriptFeaturesIndexes=function(a){var n=this.font.tables;if(!n.gsub)return[];if(!a)return this.getDefaultScriptFeaturesIndexes();for(var r=this.font.tables.gsub.scripts,i=0;i<r.length;i++){var o=r[i];if(o.tag===a&&o.script.defaultLangSys)return o.script.defaultLangSys.featureIndexes;var u=o.langSysRecords;if(u)for(var f=0;f<u.length;f++){var h=u[f];if(h.tag===a){var p=h.langSys;return p.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};sa.prototype.mapTagsToFeatures=function(a,n){for(var r={},i=0;i<a.length;i++){var o=a[i].tag,u=a[i].feature;r[o]=u}this.features[n].tags=r};sa.prototype.getScriptFeatures=function(a){var n=this.features[a];if(this.features.hasOwnProperty(a))return n;var r=this.getScriptFeaturesIndexes(a);if(!r)return null;var i=this.font.tables.gsub;return n=r.map(function(o){return i.features[o]}),this.features[a]=n,this.mapTagsToFeatures(n,a),n};sa.prototype.getSubstitutionType=function(a,n){var r=a.lookupType.toString(),i=n.substFormat.toString();return r+i};sa.prototype.getLookupMethod=function(a,n){var r=this,i=this.getSubstitutionType(a,n);switch(i){case"11":return function(o){return t2.apply(r,[o,n])};case"12":return function(o){return n2.apply(r,[o,n])};case"63":return function(o){return a2.apply(r,[o,n])};case"41":return function(o){return r2.apply(r,[o,n])};case"21":return function(o){return s2.apply(r,[o,n])};default:throw new Error("lookupType: "+a.lookupType+" - substFormat: "+n.substFormat+" is not yet supported")}};sa.prototype.lookupFeature=function(a){var n=a.contextParams,r=n.index,i=this.getFeature({tag:a.tag,script:a.script});if(!i)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+a.tag+"' for script '"+a.script+"'.");for(var o=this.getFeatureLookups(i),u=[].concat(n.context),f=0;f<o.length;f++)for(var h=o[f],p=this.getLookupSubtables(h),v=0;v<p.length;v++){var y=p[v],S=this.getSubstitutionType(h,y),b=this.getLookupMethod(h,y),x=void 0;switch(S){case"11":x=b(n.current),x&&u.splice(r,1,new js({id:11,tag:a.tag,substitution:x}));break;case"12":x=b(n.current),x&&u.splice(r,1,new js({id:12,tag:a.tag,substitution:x}));break;case"63":x=b(n),Array.isArray(x)&&x.length&&u.splice(r,1,new js({id:63,tag:a.tag,substitution:x}));break;case"41":x=b(n),x&&u.splice(r,1,new js({id:41,tag:a.tag,substitution:x}));break;case"21":x=b(n.current),x&&u.splice(r,1,new js({id:21,tag:a.tag,substitution:x}));break}n=new ka(u,r),!(Array.isArray(x)&&!x.length)&&(x=null)}return u.length?u:null};sa.prototype.supports=function(a){if(!a.script)return!1;this.getScriptFeatures(a.script);var n=this.features.hasOwnProperty(a.script);if(!a.tag)return n;var r=this.features[a.script].some(function(i){return i.tag===a.tag});return n&&r};sa.prototype.getLookupSubtables=function(a){return a.subtables||null};sa.prototype.getLookupByIndex=function(a){var n=this.font.tables.gsub.lookups;return n[a]||null};sa.prototype.getFeatureLookups=function(a){return a.lookupListIndexes.map(this.getLookupByIndex.bind(this))};sa.prototype.getFeature=function(n){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(n.script)||this.getScriptFeatures(n.script);var r=this.features[n.script];return r?r.tags[n.tag]?this.features[n.script].tags[n.tag]:null:{FAIL:"No feature for script "+n.script}};function i2(a){var n=a.current,r=a.get(-1);return r===null&&cs(n)||!cs(r)&&cs(n)}function l2(a){var n=a.get(1);return n===null||!cs(n)}var o2={startCheck:i2,endCheck:l2};function c2(a){var n=a.current,r=a.get(-1);return(cs(n)||us(n))&&!cs(r)}function u2(a){var n=a.get(1);switch(!0){case n===null:return!0;case(!cs(n)&&!us(n)):var r=e2(n);if(!r)return!0;if(r){var i=!1;if(i=a.lookahead.some(function(o){return cs(o)||us(o)}),!i)return!0}break;default:return!1}}var f2={startCheck:c2,endCheck:u2};function d2(a,n,r){n[r].setState(a.tag,a.substitution)}function p2(a,n,r){n[r].setState(a.tag,a.substitution)}function h2(a,n,r){a.substitution.forEach(function(i,o){var u=n[r+o];u.setState(a.tag,i)})}function m2(a,n,r){var i=n[r];i.setState(a.tag,a.substitution.ligGlyph);for(var o=a.substitution.components.length,u=0;u<o;u++)i=n[r+u+1],i.setState("deleted",!0)}var Sm={11:d2,12:p2,63:h2,41:m2};function cd(a,n,r){a instanceof js&&Sm[a.id]&&Sm[a.id](a,n,r)}function g2(a){for(var n=[].concat(a.backtrack),r=n.length-1;r>=0;r--){var i=n[r],o=Ig(i),u=us(i);if(!o&&!u)return!0;if(o)return!1}return!1}function v2(a){if(Ig(a.current))return!1;for(var n=0;n<a.lookahead.length;n++){var r=a.lookahead[n],i=us(r);if(!i)return!0}return!1}function y2(a){var n=this,r="arab",i=this.featuresTags[r],o=this.tokenizer.getRangeTokens(a);if(o.length!==1){var u=new ka(o.map(function(h){return h.getState("glyphIndex")}),0),f=new ka(o.map(function(h){return h.char}),0);o.forEach(function(h,p){if(!us(h.char)){u.setCurrentIndex(p),f.setCurrentIndex(p);var v=0;g2(f)&&(v|=1),v2(f)&&(v|=2);var y;switch(v){case 1:y="fina";break;case 2:y="init";break;case 3:y="medi";break}if(i.indexOf(y)!==-1){var S=n.query.lookupFeature({tag:y,script:r,contextParams:u});if(S instanceof Error)return console.info(S.message);S.forEach(function(b,x){b instanceof js&&(cd(b,o,x),u.context[x]=b.substitution)})}}})}}function Em(a,n){var r=a.map(function(i){return i.activeState.value});return new ka(r,0)}function b2(a){var n=this,r="arab",i=this.tokenizer.getRangeTokens(a),o=Em(i);o.context.forEach(function(u,f){o.setCurrentIndex(f);var h=n.query.lookupFeature({tag:"rlig",script:r,contextParams:o});h.length&&(h.forEach(function(p){return cd(p,i,f)}),o=Em(i))})}function x2(a){var n=a.current,r=a.get(-1);return r===null&&mc(n)||!mc(r)&&mc(n)}function S2(a){var n=a.get(1);return n===null||!mc(n)}var E2={startCheck:x2,endCheck:S2};function wm(a,n){var r=a.map(function(i){return i.activeState.value});return new ka(r,0)}function w2(a){var n=this,r="latn",i=this.tokenizer.getRangeTokens(a),o=wm(i);o.context.forEach(function(u,f){o.setCurrentIndex(f);var h=n.query.lookupFeature({tag:"liga",script:r,contextParams:o});h.length&&(h.forEach(function(p){return cd(p,i,f)}),o=wm(i))})}function Ua(a){this.baseDir=a||"ltr",this.tokenizer=new Xt,this.featuresTags={}}Ua.prototype.setText=function(a){this.text=a};Ua.prototype.contextChecks={latinWordCheck:E2,arabicWordCheck:o2,arabicSentenceCheck:f2};function Of(a){var n=this.contextChecks[a+"Check"];return this.tokenizer.registerContextChecker(a,n.startCheck,n.endCheck)}function A2(){return Of.call(this,"latinWord"),Of.call(this,"arabicWord"),Of.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function T2(){var a=this,n=this.tokenizer.getContextRanges("arabicSentence");n.forEach(function(r){var i=a.tokenizer.getRangeTokens(r);a.tokenizer.replaceRange(r.startIndex,r.endOffset,i.reverse())})}Ua.prototype.registerFeatures=function(a,n){var r=this,i=n.filter(function(o){return r.query.supports({script:a,tag:o})});this.featuresTags.hasOwnProperty(a)?this.featuresTags[a]=this.featuresTags[a].concat(i):this.featuresTags[a]=i};Ua.prototype.applyFeatures=function(a,n){if(!a)throw new Error("No valid font was provided to apply features");this.query||(this.query=new sa(a));for(var r=0;r<n.length;r++){var i=n[r];this.query.supports({script:i.script})&&this.registerFeatures(i.script,i.tags)}};Ua.prototype.registerModifier=function(a,n,r){this.tokenizer.registerModifier(a,n,r)};function ud(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function C2(){var a=this,n="arab";if(this.featuresTags.hasOwnProperty(n)){ud.call(this);var r=this.tokenizer.getContextRanges("arabicWord");r.forEach(function(i){y2.call(a,i)})}}function M2(){var a=this,n="arab";if(this.featuresTags.hasOwnProperty(n)){var r=this.featuresTags[n];if(r.indexOf("rlig")!==-1){ud.call(this);var i=this.tokenizer.getContextRanges("arabicWord");i.forEach(function(o){b2.call(a,o)})}}}function N2(){var a=this,n="latn";if(this.featuresTags.hasOwnProperty(n)){var r=this.featuresTags[n];if(r.indexOf("liga")!==-1){ud.call(this);var i=this.tokenizer.getContextRanges("latinWord");i.forEach(function(o){w2.call(a,o)})}}}Ua.prototype.checkContextReady=function(a){return!!this.tokenizer.getContext(a)};Ua.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(C2.call(this),M2.call(this)),this.checkContextReady("latinWord")&&N2.call(this),this.checkContextReady("arabicSentence")&&T2.call(this)};Ua.prototype.processText=function(a){(!this.text||this.text!==a)&&(this.setText(a),A2.call(this),this.applyFeaturesToContexts())};Ua.prototype.getBidiText=function(a){return this.processText(a),this.tokenizer.getText()};Ua.prototype.getTextGlyphs=function(a){this.processText(a);for(var n=[],r=0;r<this.tokenizer.tokens.length;r++){var i=this.tokenizer.tokens[r];if(!i.state.deleted){var o=i.activeState.value;n.push(Array.isArray(o)?o[0]:o)}}return n};function Mt(a){a=a||{},a.tables=a.tables||{},a.empty||(Ol(a.familyName,"When creating a new Font object, familyName is required."),Ol(a.styleName,"When creating a new Font object, styleName is required."),Ol(a.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Ol(a.ascender,"When creating a new Font object, ascender is required."),Ol(a.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:a.familyName||" "},fontSubfamily:{en:a.styleName||" "},fullName:{en:a.fullName||a.familyName+" "+a.styleName},postScriptName:{en:a.postScriptName||(a.familyName+a.styleName).replace(/\s/g,"")},designer:{en:a.designer||" "},designerURL:{en:a.designerURL||" "},manufacturer:{en:a.manufacturer||" "},manufacturerURL:{en:a.manufacturerURL||" "},license:{en:a.license||" "},licenseURL:{en:a.licenseURL||" "},version:{en:a.version||"Version 0.1"},description:{en:a.description||" "},copyright:{en:a.copyright||" "},trademark:{en:a.trademark||" "}},this.unitsPerEm=a.unitsPerEm||1e3,this.ascender=a.ascender,this.descender=a.descender,this.createdTimestamp=a.createdTimestamp,this.tables=Object.assign(a.tables,{os2:Object.assign({usWeightClass:a.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:a.widthClass||this.usWidthClasses.MEDIUM,fsSelection:a.fsSelection||this.fsSelectionValues.REGULAR},a.tables.os2)})),this.supported=!0,this.glyphs=new tr.GlyphSet(this,a.glyphs||[]),this.encoding=new eg(this),this.position=new ql(this),this.substitution=new ra(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new kg(this)}})}Mt.prototype.hasChar=function(a){return this.encoding.charToGlyphIndex(a)!==null};Mt.prototype.charToGlyphIndex=function(a){return this.encoding.charToGlyphIndex(a)};Mt.prototype.charToGlyph=function(a){var n=this.charToGlyphIndex(a),r=this.glyphs.get(n);return r||(r=this.glyphs.get(0)),r};Mt.prototype.updateFeatures=function(a){return this.defaultRenderOptions.features.map(function(n){return n.script==="latn"?{script:"latn",tags:n.tags.filter(function(r){return a[r]})}:n})};Mt.prototype.stringToGlyphs=function(a,n){var r=this,i=new Ua,o=function(S){return r.charToGlyphIndex(S.char)};i.registerModifier("glyphIndex",null,o);var u=n?this.updateFeatures(n.features):this.defaultRenderOptions.features;i.applyFeatures(this,u);for(var f=i.getTextGlyphs(a),h=f.length,p=new Array(h),v=this.glyphs.get(0),y=0;y<h;y+=1)p[y]=this.glyphs.get(f[y])||v;return p};Mt.prototype.nameToGlyphIndex=function(a){return this.glyphNames.nameToGlyphIndex(a)};Mt.prototype.nameToGlyph=function(a){var n=this.nameToGlyphIndex(a),r=this.glyphs.get(n);return r||(r=this.glyphs.get(0)),r};Mt.prototype.glyphIndexToName=function(a){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(a):""};Mt.prototype.getKerningValue=function(a,n){a=a.index||a,n=n.index||n;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,a,n):this.kerningPairs[a+","+n]||0};Mt.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};Mt.prototype.forEachGlyph=function(a,n,r,i,o,u){n=n!==void 0?n:0,r=r!==void 0?r:0,i=i!==void 0?i:72,o=Object.assign({},this.defaultRenderOptions,o);var f=1/this.unitsPerEm*i,h=this.stringToGlyphs(a,o),p;if(o.kerning){var v=o.script||this.position.getDefaultScriptName();p=this.position.getKerningTables(v,o.language)}for(var y=0;y<h.length;y+=1){var S=h[y];if(u.call(this,S,n,r,i,o),S.advanceWidth&&(n+=S.advanceWidth*f),o.kerning&&y<h.length-1){var b=p?this.position.getKerningValue(p,S.index,h[y+1].index):this.getKerningValue(S,h[y+1]);n+=b*f}o.letterSpacing?n+=o.letterSpacing*i:o.tracking&&(n+=o.tracking/1e3*i)}return n};Mt.prototype.getPath=function(a,n,r,i,o){var u=new rn;return this.forEachGlyph(a,n,r,i,o,function(f,h,p,v){var y=f.getPath(h,p,v,o,this);u.extend(y)}),u};Mt.prototype.getPaths=function(a,n,r,i,o){var u=[];return this.forEachGlyph(a,n,r,i,o,function(f,h,p,v){var y=f.getPath(h,p,v,o,this);u.push(y)}),u};Mt.prototype.getAdvanceWidth=function(a,n,r){return this.forEachGlyph(a,0,0,n,r,function(){})};Mt.prototype.draw=function(a,n,r,i,o,u){this.getPath(n,r,i,o,u).draw(a)};Mt.prototype.drawPoints=function(a,n,r,i,o,u){this.forEachGlyph(n,r,i,o,u,function(f,h,p,v){f.drawPoints(a,h,p,v)})};Mt.prototype.drawMetrics=function(a,n,r,i,o,u){this.forEachGlyph(n,r,i,o,u,function(f,h,p,v){f.drawMetrics(a,h,p,v)})};Mt.prototype.getEnglishName=function(a){var n=this.names[a];if(n)return n.en};Mt.prototype.validate=function(){var a=this;function n(i,o){}function r(i){var o=a.getEnglishName(i);o&&o.trim().length>0}r("fontFamily"),r("weightName"),r("manufacturer"),r("copyright"),r("version"),this.unitsPerEm>0};Mt.prototype.toTables=function(){return mx.fontToTable(this)};Mt.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};Mt.prototype.toArrayBuffer=function(){for(var a=this.toTables(),n=a.encode(),r=new ArrayBuffer(n.length),i=new Uint8Array(r),o=0;o<n.length;o++)i[o]=n[o];return r};Mt.prototype.download=function(a){var n=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");a=a||n.replace(/\s/g,"")+"-"+r+".otf";var i=this.toArrayBuffer();if(vx())if(window.URL=window.URL||window.webkitURL,window.URL){var o=new DataView(i),u=new Blob([o],{type:"font/opentype"}),f=document.createElement("a");f.href=window.URL.createObjectURL(u),f.download=a;var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!1),f.dispatchEvent(h)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var p=require("fs"),v=yx(i);p.writeFileSync(a,v)}};Mt.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};Mt.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Mt.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};function Bg(a,n){var r=JSON.stringify(a),i=256;for(var o in n){var u=parseInt(o);if(!(!u||u<256)){if(JSON.stringify(n[o])===r)return u;i<=u&&(i=u+1)}}return n[i]=a,i}function R2(a,n,r){var i=Bg(n.name,r);return[{name:"tag_"+a,type:"TAG",value:n.tag},{name:"minValue_"+a,type:"FIXED",value:n.minValue<<16},{name:"defaultValue_"+a,type:"FIXED",value:n.defaultValue<<16},{name:"maxValue_"+a,type:"FIXED",value:n.maxValue<<16},{name:"flags_"+a,type:"USHORT",value:0},{name:"nameID_"+a,type:"USHORT",value:i}]}function D2(a,n,r){var i={},o=new Be.Parser(a,n);return i.tag=o.parseTag(),i.minValue=o.parseFixed(),i.defaultValue=o.parseFixed(),i.maxValue=o.parseFixed(),o.skip("uShort",1),i.name=r[o.parseUShort()]||{},i}function _2(a,n,r,i){for(var o=Bg(n.name,i),u=[{name:"nameID_"+a,type:"USHORT",value:o},{name:"flags_"+a,type:"USHORT",value:0}],f=0;f<r.length;++f){var h=r[f].tag;u.push({name:"axis_"+a+" "+h,type:"FIXED",value:n.coordinates[h]<<16})}return u}function k2(a,n,r,i){var o={},u=new Be.Parser(a,n);o.name=i[u.parseUShort()]||{},u.skip("uShort",1),o.coordinates={};for(var f=0;f<r.length;++f)o.coordinates[r[f].tag]=u.parseFixed();return o}function O2(a,n){var r=new _e.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:a.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:a.instances.length},{name:"instanceSize",type:"USHORT",value:4+a.axes.length*4}]);r.offsetToData=r.sizeOf();for(var i=0;i<a.axes.length;i++)r.fields=r.fields.concat(R2(i,a.axes[i],n));for(var o=0;o<a.instances.length;o++)r.fields=r.fields.concat(_2(o,a.instances[o],a.axes,n));return r}function L2(a,n,r){var i=new Be.Parser(a,n),o=i.parseULong();Ze.argument(o===65536,"Unsupported fvar table version.");var u=i.parseOffset16();i.skip("uShort",1);for(var f=i.parseUShort(),h=i.parseUShort(),p=i.parseUShort(),v=i.parseUShort(),y=[],S=0;S<f;S++)y.push(D2(a,n+u+S*h,r));for(var b=[],x=n+u+f*h,E=0;E<p;E++)b.push(k2(a,x+E*v,y,r));return{axes:y,instances:b}}var U2={make:O2,parse:L2},I2=function(){return{coverage:this.parsePointer(le.coverage),attachPoints:this.parseList(le.pointer(le.uShortList))}},B2=function(){var a=this.parseUShort();if(Ze.argument(a===1||a===2||a===3,"Unsupported CaretValue table version."),a===1)return{coordinate:this.parseShort()};if(a===2)return{pointindex:this.parseShort()};if(a===3)return{coordinate:this.parseShort()}},F2=function(){return this.parseList(le.pointer(B2))},j2=function(){return{coverage:this.parsePointer(le.coverage),ligGlyphs:this.parseList(le.pointer(F2))}},P2=function(){return this.parseUShort(),this.parseList(le.pointer(le.coverage))};function G2(a,n){n=n||0;var r=new le(a,n),i=r.parseVersion(1);Ze.argument(i===1||i===1.2||i===1.3,"Unsupported GDEF table version.");var o={version:i,classDef:r.parsePointer(le.classDef),attachList:r.parsePointer(I2),ligCaretList:r.parsePointer(j2),markAttachClassDef:r.parsePointer(le.classDef)};return i>=1.2&&(o.markGlyphSets=r.parsePointer(P2)),o}var z2={parse:G2},Oa=new Array(10);Oa[1]=function(){var n=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{posFormat:1,coverage:this.parsePointer(le.coverage),value:this.parseValueRecord()};if(r===2)return{posFormat:2,coverage:this.parsePointer(le.coverage),values:this.parseValueRecordList()};Ze.assert(!1,"0x"+n.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};Oa[2]=function(){var n=this.offset+this.relativeOffset,r=this.parseUShort();Ze.assert(r===1||r===2,"0x"+n.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var i=this.parsePointer(le.coverage),o=this.parseUShort(),u=this.parseUShort();if(r===1)return{posFormat:r,coverage:i,valueFormat1:o,valueFormat2:u,pairSets:this.parseList(le.pointer(le.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(o),value2:this.parseValueRecord(u)}})))};if(r===2){var f=this.parsePointer(le.classDef),h=this.parsePointer(le.classDef),p=this.parseUShort(),v=this.parseUShort();return{posFormat:r,coverage:i,valueFormat1:o,valueFormat2:u,classDef1:f,classDef2:h,class1Count:p,class2Count:v,classRecords:this.parseList(p,le.list(v,function(){return{value1:this.parseValueRecord(o),value2:this.parseValueRecord(u)}}))}}};Oa[3]=function(){return{error:"GPOS Lookup 3 not supported"}};Oa[4]=function(){return{error:"GPOS Lookup 4 not supported"}};Oa[5]=function(){return{error:"GPOS Lookup 5 not supported"}};Oa[6]=function(){return{error:"GPOS Lookup 6 not supported"}};Oa[7]=function(){return{error:"GPOS Lookup 7 not supported"}};Oa[8]=function(){return{error:"GPOS Lookup 8 not supported"}};Oa[9]=function(){return{error:"GPOS Lookup 9 not supported"}};function H2(a,n){n=n||0;var r=new le(a,n),i=r.parseVersion(1);return Ze.argument(i===1||i===1.1,"Unsupported GPOS table version "+i),i===1?{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(Oa)}:{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(Oa),variations:r.parseFeatureVariationsList()}}var Y2=new Array(10);function q2(a){return new _e.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new _e.ScriptList(a.scripts)},{name:"features",type:"TABLE",value:new _e.FeatureList(a.features)},{name:"lookups",type:"TABLE",value:new _e.LookupList(a.lookups,Y2)}])}var V2={parse:H2,make:q2};function X2(a){var n={};a.skip("uShort");var r=a.parseUShort();Ze.argument(r===0,"Unsupported kern sub-table version."),a.skip("uShort",2);var i=a.parseUShort();a.skip("uShort",3);for(var o=0;o<i;o+=1){var u=a.parseUShort(),f=a.parseUShort(),h=a.parseShort();n[u+","+f]=h}return n}function Q2(a){var n={};a.skip("uShort");var r=a.parseULong();r>1&&console.warn("Only the first kern subtable is supported."),a.skip("uLong");var i=a.parseUShort(),o=i&255;if(a.skip("uShort"),o===0){var u=a.parseUShort();a.skip("uShort",3);for(var f=0;f<u;f+=1){var h=a.parseUShort(),p=a.parseUShort(),v=a.parseShort();n[h+","+p]=v}}return n}function Z2(a,n){var r=new Be.Parser(a,n),i=r.parseUShort();if(i===0)return X2(r);if(i===1)return Q2(r);throw new Error("Unsupported kern table version ("+i+").")}var $2={parse:Z2};function W2(a,n,r,i){for(var o=new Be.Parser(a,n),u=i?o.parseUShort:o.parseULong,f=[],h=0;h<r+1;h+=1){var p=u.call(o);i&&(p*=2),f.push(p)}return f}var K2={parse:W2};function J2(a,n){var r=require("fs");r.readFile(a,function(i,o){if(i)return n(i.message);n(null,Tg(o))})}function eE(a,n){var r=new XMLHttpRequest;r.open("get",a,!0),r.responseType="arraybuffer",r.onload=function(){return r.response?n(null,r.response):n("Font could not be loaded: "+r.statusText)},r.onerror=function(){n("Font could not be loaded")},r.send()}function Am(a,n){for(var r=[],i=12,o=0;o<n;o+=1){var u=Be.getTag(a,i),f=Be.getULong(a,i+4),h=Be.getULong(a,i+8),p=Be.getULong(a,i+12);r.push({tag:u,checksum:f,offset:h,length:p,compression:!1}),i+=16}return r}function tE(a,n){for(var r=[],i=44,o=0;o<n;o+=1){var u=Be.getTag(a,i),f=Be.getULong(a,i+4),h=Be.getULong(a,i+8),p=Be.getULong(a,i+12),v=void 0;h<p?v="WOFF":v=!1,r.push({tag:u,offset:f,compression:v,compressedLength:h,length:p}),i+=20}return r}function Wt(a,n){if(n.compression==="WOFF"){var r=new Uint8Array(a.buffer,n.offset+2,n.compressedLength-2),i=new Uint8Array(n.length);if(V1(r,i),i.byteLength!==n.length)throw new Error("Decompression error: "+n.tag+" decompressed length doesn't match recorded length");var o=new DataView(i.buffer,0);return{data:o,offset:0}}else return{data:a,offset:n.offset}}function fd(a,n){n=n??{};var r,i,o=new Mt({empty:!0}),u=new DataView(a,0),f,h=[],p=Be.getTag(u,0);if(p==="\0\0\0"||p==="true"||p==="typ1")o.outlinesFormat="truetype",f=Be.getUShort(u,4),h=Am(u,f);else if(p==="OTTO")o.outlinesFormat="cff",f=Be.getUShort(u,4),h=Am(u,f);else if(p==="wOFF"){var v=Be.getTag(u,4);if(v==="\0\0\0")o.outlinesFormat="truetype";else if(v==="OTTO")o.outlinesFormat="cff";else throw new Error("Unsupported OpenType flavor "+p);f=Be.getUShort(u,12),h=tE(u,f)}else throw new Error("Unsupported OpenType signature "+p);for(var y,S,b,x,E,A,D,F,R,N,_,M,j=0;j<f;j+=1){var B=h[j],H=void 0;switch(B.tag){case"cmap":H=Wt(u,B),o.tables.cmap=Jm.parse(H.data,H.offset),o.encoding=new tg(o.tables.cmap);break;case"cvt ":H=Wt(u,B),M=new Be.Parser(H.data,H.offset),o.tables.cvt=M.parseShortList(B.length/2);break;case"fvar":S=B;break;case"fpgm":H=Wt(u,B),M=new Be.Parser(H.data,H.offset),o.tables.fpgm=M.parseByteList(B.length);break;case"head":H=Wt(u,B),o.tables.head=fg.parse(H.data,H.offset),o.unitsPerEm=o.tables.head.unitsPerEm,r=o.tables.head.indexToLocFormat;break;case"hhea":H=Wt(u,B),o.tables.hhea=dg.parse(H.data,H.offset),o.ascender=o.tables.hhea.ascender,o.descender=o.tables.hhea.descender,o.numberOfHMetrics=o.tables.hhea.numberOfHMetrics;break;case"hmtx":D=B;break;case"ltag":H=Wt(u,B),i=hg.parse(H.data,H.offset);break;case"maxp":H=Wt(u,B),o.tables.maxp=mg.parse(H.data,H.offset),o.numGlyphs=o.tables.maxp.numGlyphs;break;case"name":N=B;break;case"OS/2":H=Wt(u,B),o.tables.os2=Vf.parse(H.data,H.offset);break;case"post":H=Wt(u,B),o.tables.post=Sg.parse(H.data,H.offset),o.glyphNames=new rd(o.tables.post);break;case"prep":H=Wt(u,B),M=new Be.Parser(H.data,H.offset),o.tables.prep=M.parseByteList(B.length);break;case"glyf":b=B;break;case"loca":R=B;break;case"CFF ":y=B;break;case"kern":F=B;break;case"GDEF":x=B;break;case"GPOS":E=B;break;case"GSUB":A=B;break;case"meta":_=B;break}}var K=Wt(u,N);if(o.tables.name=xg.parse(K.data,K.offset,i),o.names=o.tables.name,b&&R){var J=r===0,G=Wt(u,R),V=K2.parse(G.data,G.offset,o.numGlyphs,J),X=Wt(u,b);o.glyphs=Rg.parse(X.data,X.offset,V,o,n)}else if(y){var Y=Wt(u,y);ug.parse(Y.data,Y.offset,o,n)}else throw new Error("Font doesn't contain TrueType or CFF outlines.");var Q=Wt(u,D);if(pg.parse(o,Q.data,Q.offset,o.numberOfHMetrics,o.numGlyphs,o.glyphs,n),pb(o,n),F){var L=Wt(u,F);o.kerningPairs=$2.parse(L.data,L.offset)}else o.kerningPairs={};if(x){var z=Wt(u,x);o.tables.gdef=z2.parse(z.data,z.offset)}if(E){var ne=Wt(u,E);o.tables.gpos=V2.parse(ne.data,ne.offset),o.position.init()}if(A){var fe=Wt(u,A);o.tables.gsub=Eg.parse(fe.data,fe.offset)}if(S){var U=Wt(u,S);o.tables.fvar=U2.parse(U.data,U.offset,o.names)}if(_){var Z=Wt(u,_);o.tables.meta=wg.parse(Z.data,Z.offset),o.metas=o.tables.meta}return o}function nE(a,n,r){r=r??{};var i=typeof window>"u",o=i&&!r.isUrl?J2:eE;return new Promise(function(u,f){o(a,function(h,p){if(h){if(n)return n(h);f(h)}var v;try{v=fd(p,r)}catch(y){if(n)return n(y,null);f(y)}if(n)return n(null,v);u(v)})})}function aE(a,n){var r=require("fs"),i=r.readFileSync(a);return fd(Tg(i),n)}var rE=Object.freeze({__proto__:null,Font:Mt,Glyph:aa,Path:rn,BoundingBox:Cr,_parse:Be,parse:fd,load:nE,loadSync:aE});const Zl=(a,n)=>({...n,...a}),Ll=new Map;async function Tm(a,n){try{if(!n)throw new Error("A font buffer is required to generate text.");const r=`${n.byteLength}_${new Uint8Array(n.slice(0,100)).join("")}`;let i=Ll.get(r);if(!i&&(i=rE.parse(n),Ll.set(r,i),Ll.size>10)){const K=Ll.keys().next().value;Ll.delete(K)}const{text:o,x:u,y:f,r:h,g:p,b:v,fontSize:y,numPoints:S}=Zl(a,{text:"TrueLazer",x:0,y:.3,r:255,g:255,b:255,fontSize:72,numPoints:500}),b=i.getPath(o,0,0,y),x=b.commands,E=b.getBoundingBox(),A=(E.x1+E.x2)/2,D=(E.y1+E.y2)/2;let F=0,R=0,N=0;x.forEach(K=>{if(K.type==="M")R=K.x,N=K.y;else if(K.type==="L"||K.type==="Q"||K.type==="C"){const J=K.x-R,G=K.y-N;F+=Math.sqrt(J*J+G*G),R=K.x,N=K.y}});const _=S/(F||1),M=[];R=0,N=0;let j=0,B=0;const H=200;if(x.forEach(K=>{if(K.type==="M"){if(M.length>0){const V=M[M.length-1];M.push({...V,r:0,g:0,b:0,blanking:!0})}j=K.x,B=K.y;const J=(K.x-A)/H+u,G=-(K.y-D)/H+f;M.push({x:J,y:G,r:0,g:0,b:0,blanking:!0}),M.push({x:J,y:G,r:h,g:p,b:v,blanking:!1}),R=K.x,N=K.y}else if(K.type==="L"){const J=K.x-R,G=K.y-N,V=Math.sqrt(J*J+G*G),X=Math.max(1,Math.floor(V*_));for(let Y=1;Y<=X;Y++){const Q=Y/X;M.push({x:(R+J*Q-A)/H+u,y:-(N+G*Q-D)/H+f,r:h,g:p,b:v})}R=K.x,N=K.y}else if(K.type==="Q"){const J=K.x-R,G=K.y-N,V=Math.sqrt(J*J+G*G),X=Math.max(2,Math.floor(V*_));for(let Y=1;Y<=X;Y++){const Q=Y/X,L=Math.pow(1-Q,2)*R+2*(1-Q)*Q*K.x1+Math.pow(Q,2)*K.x,z=Math.pow(1-Q,2)*N+2*(1-Q)*Q*K.y1+Math.pow(Q,2)*K.y;M.push({x:(L-A)/H+u,y:-(z-D)/H+f,r:h,g:p,b:v})}R=K.x,N=K.y}else if(K.type==="C"){const J=K.x-R,G=K.y-N,V=Math.sqrt(J*J+G*G),X=Math.max(3,Math.floor(V*_));for(let Y=1;Y<=X;Y++){const Q=Y/X,L=Math.pow(1-Q,3)*R+3*Math.pow(1-Q,2)*Q*K.x1+3*(1-Q)*Math.pow(Q,2)*K.x2+Math.pow(Q,3)*K.x,z=Math.pow(1-Q,3)*N+3*Math.pow(1-Q,2)*Q*K.y1+3*(1-Q)*Math.pow(Q,2)*K.y2+Math.pow(Q,3)*K.y;M.push({x:(L-A)/H+u,y:-(z-D)/H+f,r:h,g:p,b:v})}R=K.x,N=K.y}else K.type==="Z"&&(M.push({x:(j-A)/H+u,y:-(B-D)/H+f,r:h,g:p,b:v}),R=j,N=B)}),M.length>0){const K=M[M.length-1];M.push({...K,r:0,g:0,b:0,blanking:!0})}return{points:M}}catch(r){throw console.error("Error in generateText:",r),r}}function sE(a){try{const{radius:n,numPoints:r,x:i,y:o,r:u,g:f,b:h}=Zl(a,{radius:.5,numPoints:500,x:0,y:0,r:255,g:255,b:255}),p=[];for(let v=0;v<=r;v++){const y=v/r*2*Math.PI;p.push({x:n*Math.cos(y)+i,y:n*Math.sin(y)+o,r:u,g:f,b:h})}return{points:p}}catch(n){throw console.error("Error in generateCircle:",n),n}}function iE(a){try{const{width:n,height:r,pointDensity:i,x:o,y:u,r:f,g:h,b:p}=Zl(a,{width:1,height:1,pointDensity:125,x:0,y:0,r:255,g:255,b:255}),v=[{x:-n/2+o,y:-r/2+u},{x:n/2+o,y:-r/2+u},{x:n/2+o,y:r/2+u},{x:-n/2+o,y:r/2+u},{x:-n/2+o,y:-r/2+u}],y=[];for(let S=0;S<v.length-1;S++){const b=v[S],x=v[S+1];for(let E=0;E<i;E++){const A=E/i;y.push({x:b.x+(x.x-b.x)*A,y:b.y+(x.y-b.y)*A,r:f,g:h,b:p})}}return y.push({...v[v.length-1],r:f,g:h,b:p}),{points:y}}catch(n){throw console.error("Error in generateSquare:",n),n}}function lE(a){try{const{x1:n,y1:r,x2:i,y2:o,pointDensity:u,r:f,g:h,b:p}=Zl(a,{x1:-.5,y1:0,x2:.5,y2:0,pointDensity:200,r:255,g:255,b:255}),v=[];for(let y=0;y<=u;y++){const S=y/u;v.push({x:n+(i-n)*S,y:r+(o-r)*S,r:f,g:h,b:p})}return{points:v}}catch(n){throw console.error("Error in generateLine:",n),n}}function oE(a){try{const{outerRadius:n,innerRadius:r,numSpikes:i,pointDensity:o,x:u,y:f,r:h,g:p,b:v}=Zl(a,{outerRadius:.5,innerRadius:.2,numSpikes:5,pointDensity:10,x:0,y:0,r:255,g:255,b:255}),y=[];for(let b=0;b<i*2;b++){const x=b%2===0?n:r,E=b/(i*2)*2*Math.PI-Math.PI/2;y.push({x:x*Math.cos(E)+u,y:x*Math.sin(E)+f})}y.push({...y[0]});const S=[];for(let b=0;b<y.length-1;b++){const x=y[b],E=y[b+1];for(let A=0;A<o;A++){const D=A/o;S.push({x:x.x+(E.x-x.x)*D,y:x.y+(E.y-x.y)*D,r:h,g:p,b:v})}}return S.push({...y[y.length-1],r:h,g:p,b:v}),{points:S}}catch(n){throw console.error("Error in generateStar:",n),n}}const Il=()=>Math.random().toString(36).substr(2,9),cE=Gn.memo(({playbackFps:a,onSpeedChange:n})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_speed",targetType:"global",label:"SPEED",min:1,max:120,step:1}))};return g.jsxs("div",{className:"master-speed-slider",children:[g.jsxs("label",{htmlFor:"masterSpeedRange",draggable:!0,onDragStart:r,children:[a," FPS"]}),g.jsx(Lt,{id:"master_speed",children:g.jsx("input",{type:"range",min:"1",max:"120",value:a,className:"slider_hor",id:"masterSpeedRange",onChange:i=>n(parseInt(i.target.value))})})]})}),uE=Gn.memo(({isWorldOutputActive:a,onToggleWorldOutput:n})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"laser_output",targetType:"global",label:"LASER"}))};return g.jsx("div",{className:"container",draggable:!0,onDragStart:r,children:g.jsx(Lt,{id:"laser_output",children:g.jsx("input",{type:"checkbox",checked:a,onChange:n})})})}),Bl=(a,n,r,i)=>!Array.isArray(a)||a.length!==n?Array(n).fill(null).map((o,u)=>Array(r).fill(null).map((f,h)=>i(u,h))):a.map((o,u)=>!Array.isArray(o)||o.length!==r?Array(r).fill(null).map((f,h)=>i(u,h)):o),Fg=a=>({columns:Array.from({length:8},(n,r)=>`Col ${r+1}`),layers:Array.from({length:5},(n,r)=>`Layer ${r+1}`),clipContents:Bl(a?.clipContents,5,8,()=>({parsing:!1})),clipNames:Bl(a?.clipNames,5,8,(n,r)=>`Clip ${n+1}-${r+1}`),thumbnailFrameIndexes:Array(5).fill(null).map(()=>Array(8).fill(0)),layerEffects:Array.from({length:5},()=>[]),layerAssignedDacs:a?.layerAssignedDacs??Array(5).fill([]),layerIntensities:Array(5).fill(1),layerAutopilots:Array(5).fill("off"),layerBlackouts:Array(5).fill(!1),layerSolos:Array(5).fill(!1),masterIntensity:1,globalBlackout:!1,selectedLayerIndex:null,selectedColIndex:null,notification:{message:"",visible:!1},dacs:[],selectedDac:a?.dacAssignment?.selectedDac??a?.selectedDac??null,fileBrowserViewMode:"list",fileBrowserPath:"",layerUiStates:Array(6).fill({}),ildaFrames:[],selectedIldaWorkerId:null,selectedIldaTotalFrames:0,bpm:a?.bpm??120,showBeamEffect:a?.renderSettings?.showBeamEffect??!0,beamAlpha:a?.renderSettings?.beamAlpha??.1,fadeAlpha:a?.renderSettings?.fadeAlpha??.13,playbackFps:a?.renderSettings?.playbackFps??60,previewScanRate:a?.renderSettings?.previewScanRate??1,beamRenderMode:a?.renderSettings?.beamRenderMode??"both",worldShowBeamEffect:a?.renderSettings?.worldShowBeamEffect??!0,worldBeamRenderMode:a?.renderSettings?.worldBeamRenderMode??"both",optimizationEnabled:a?.renderSettings?.optimizationEnabled??!0,activeClipIndexes:Array(5).fill(null),isPlaying:!1,isStopped:!0,isWorldOutputActive:!1,thumbnailRenderMode:a?.thumbnailRenderMode??"still",theme:a?.theme??"orange",projectLoadTimestamp:null,clipClipboard:null,dacOutputSettings:a?.dacOutputSettings??{},quickAssigns:{knobs:Array(8).fill(null).map(()=>({value:0,label:null,link:null})),buttons:Array(8).fill(null).map(()=>({value:!1,label:null,link:null}))}});function fE(a,n){switch(n.type){case"SET_DAC_OUTPUT_SETTINGS":return{...a,dacOutputSettings:{...a.dacOutputSettings,[n.payload.id]:n.payload.settings}};case"SET_COLUMNS":return{...a,columns:n.payload};case"SET_COLUMN_NAME":{const r=[...a.columns];return r[n.payload.index]=n.payload.name,{...a,columns:r}}case"DUPLICATE_COLUMN":{const r=n.payload.index,i=[...a.columns];i.splice(r+1,0,`${i[r]} (Copy)`);const o=a.clipContents.map(h=>{const p=[...h],v=p[r];let y=null;if(v&&(y=JSON.parse(JSON.stringify(v)),y.type==="ilda"&&(y.workerId=null),y.effects)){const S=y.syncSettings||{};y.effects=y.effects.map(b=>{const x=b.instanceId,E=Il();return Object.keys(S).forEach(A=>{x&&A.startsWith(`${x}.`)&&(S[`${E}.${A.split(".")[1]}`]=S[A],delete S[A])}),{...b,instanceId:E}}),y.syncSettings=S}return p.splice(r+1,0,y),p}),u=a.clipNames.map(h=>{const p=[...h];return p.splice(r+1,0,`${p[r]} (Copy)`),p}),f=a.thumbnailFrameIndexes.map(h=>{const p=[...h];return p.splice(r+1,0,p[r]),p});return{...a,columns:i,clipContents:o,clipNames:u,thumbnailFrameIndexes:f}}case"SET_LAYERS":return{...a,layers:n.payload};case"SET_LAYER_NAME":{const r=[...a.layers];return r[n.payload.index]=n.payload.name,{...a,layers:r}}case"SET_CLIP_CONTENT":{const{layerIndex:r,colIndex:i,content:o}=n.payload;if(r===void 0||i===void 0)return a;const u=[...a.clipContents];if(!u[r])return console.error(`Reducer Error: Layer array at index ${r} is undefined. Action:`,n),a;u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,...o},{...a,clipContents:u}}case"SET_CLIP_NAME":{const{layerIndex:r,colIndex:i,name:o}=n.payload;if(r===void 0||i===void 0)return a;const u=[...a.clipNames];return u[r]&&(u[r]=[...u[r]],u[r][i]=o),{...a,clipNames:u}}case"SET_THUMBNAIL_FRAME_INDEX":{const r=[...a.thumbnailFrameIndexes];return r[n.payload.layerIndex][n.payload.colIndex]=n.payload.index,{...a,thumbnailFrameIndexes:r}}case"ADD_LAYER_EFFECT":{const r=[...a.layerEffects],i={...n.payload.effect,instanceId:Il(),params:{...n.payload.effect.defaultParams}};return r[n.payload.layerIndex].push(i),{...a,layerEffects:r}}case"ADD_CLIP_EFFECT":{const r=[...a.clipContents];if(!r[n.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${n.payload.layerIndex} is undefined. Action:`,n),a;r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i=r[n.payload.layerIndex][n.payload.colIndex]||{},o={...n.payload.effect,instanceId:Il(),params:{...n.payload.effect.defaultParams}},u={...i,effects:[...i.effects||[],o]};return r[n.payload.layerIndex][n.payload.colIndex]=u,{...a,clipContents:r}}case"SET_SELECTED_CLIP":return{...a,selectedLayerIndex:n.payload.layerIndex,selectedColIndex:n.payload.colIndex};case"SET_NOTIFICATION":return{...a,notification:n.payload};case"SET_ILDA_FRAMES":return{...a,ildaFrames:n.payload};case"SET_SELECTED_ILDA_DATA":return{...a,selectedIldaWorkerId:n.payload.workerId,selectedIldaTotalFrames:n.payload.totalFrames,selectedGeneratorId:n.payload.generatorId,selectedGeneratorParams:n.payload.generatorParams};case"SET_ACTIVE_CLIP":{const r=[...a.activeClipIndexes];return r[n.payload.layerIndex]=n.payload.colIndex,{...a,activeClipIndexes:r}}case"CLEAR_CLIP":{const r=[...a.clipContents];r[n.payload.layerIndex]=[...r[n.payload.layerIndex]],r[n.payload.layerIndex][n.payload.colIndex]=null;const i=[...a.clipNames];i[n.payload.layerIndex][n.payload.colIndex]=`Clip ${n.payload.layerIndex+1}-${n.payload.colIndex+1}`;const o=[...a.thumbnailFrameIndexes];o[n.payload.layerIndex][n.payload.colIndex]=0;const u=[...a.activeClipIndexes];return u[n.payload.layerIndex]===n.payload.colIndex&&(u[n.payload.layerIndex]=null),a.selectedLayerIndex===n.payload.layerIndex&&a.selectedColIndex===n.payload.colIndex?{...a,clipContents:r,clipNames:i,thumbnailFrameIndexes:o,activeClipIndexes:u,selectedLayerIndex:null,selectedColIndex:null,selectedIldaWorkerId:null,selectedIldaTotalFrames:0,selectedGeneratorId:null,selectedGeneratorParams:{}}:{...a,clipContents:r,clipNames:i,thumbnailFrameIndexes:o,activeClipIndexes:u}}case"DEACTIVATE_LAYER_CLIPS":{const r=[...a.activeClipIndexes];return r[n.payload.layerIndex]=null,{...a,activeClipIndexes:r}}case"CLEAR_ALL_ACTIVE_CLIPS":return{...a,activeClipIndexes:Array(a.layers.length).fill(null)};case"SET_LAYER_INTENSITY":{const r=[...a.layerIntensities];return r[n.payload.layerIndex]=n.payload.intensity,{...a,layerIntensities:r}}case"SET_LAYER_AUTOPILOT":{const r=[...a.layerAutopilots];return r[n.payload.layerIndex]=n.payload.mode,{...a,layerAutopilots:r}}case"TOGGLE_LAYER_BLACKOUT":{const r=[...a.layerBlackouts];return r[n.payload.layerIndex]=!r[n.payload.layerIndex],{...a,layerBlackouts:r}}case"TOGGLE_LAYER_SOLO":{const r=[...a.layerSolos],i=r[n.payload.layerIndex];return r.fill(!1),i||(r[n.payload.layerIndex]=!0),{...a,layerSolos:r}}case"SET_MASTER_INTENSITY":return{...a,masterIntensity:n.payload};case"TOGGLE_GLOBAL_BLACKOUT":return{...a,globalBlackout:!a.globalBlackout};case"SET_RENDER_SETTING":return{...a,[n.payload.setting]:n.payload.value};case"SET_FILE_BROWSER_VIEW_MODE":return{...a,fileBrowserViewMode:n.payload};case"SET_FILE_BROWSER_PATH":return{...a,fileBrowserPath:n.payload};case"UPDATE_CLIP_UI_STATE":{const{layerIndex:r,colIndex:i,uiState:o}=n.payload,u=[...a.clipContents];u[r]=[...u[r]];const f={...u[r][i]};return f&&(f.uiState={...f.uiState||{},...o},u[r][i]=f),{...a,clipContents:u}}case"UPDATE_LAYER_UI_STATE":{const{layerIndex:r,uiState:i}=n.payload,o=[...a.layerUiStates];return o[r]={...o[r],...i},{...a,layerUiStates:o}}case"REMOVE_CLIP_EFFECT":{const r=[...a.clipContents];r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i={...r[n.payload.layerIndex][n.payload.colIndex]};if(i&&i.effects){const o=[...i.effects];o.splice(n.payload.effectIndex,1),i.effects=o,r[n.payload.layerIndex][n.payload.colIndex]=i}return{...a,clipContents:r}}case"REORDER_CLIP_EFFECTS":{const{layerIndex:r,colIndex:i,oldIndex:o,newIndex:u}=n.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h&&h.effects){const p=[...h.effects],[v]=p.splice(o,1);p.splice(u,0,v),h.effects=p,f[r][i]=h}return{...a,clipContents:f}}case"REMOVE_LAYER_EFFECT":{const r=[...a.layerEffects];return r[n.payload.layerIndex]&&(r[n.payload.layerIndex]=[...r[n.payload.layerIndex]],r[n.payload.layerIndex].splice(n.payload.effectIndex,1)),{...a,layerEffects:r}}case"UPDATE_LAYER_EFFECT_PARAMETER":{const r=[...a.layerEffects];if(r[n.payload.layerIndex]){r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i=n.payload.effectIndex;if(r[n.payload.layerIndex][i]){const o={...r[n.payload.layerIndex][i]};o.params={...o.params,[n.payload.paramName]:n.payload.newValue},r[n.payload.layerIndex][i]=o}}return{...a,layerEffects:r}}case"UPDATE_EFFECT_PARAMETER":{const r=[...a.clipContents];r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i={...r[n.payload.layerIndex][n.payload.colIndex]};if(i&&i.effects){const o=[...i.effects],u={...o[n.payload.effectIndex]};u.params={...u.params,[n.payload.paramName]:n.payload.newValue},o[n.payload.effectIndex]=u,i.effects=o,r[n.payload.layerIndex][n.payload.colIndex]=i}return{...a,clipContents:r}}case"UPDATE_CLIP_PLAYBACK_SETTINGS":{const r=[...a.clipContents];r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i={...r[n.payload.layerIndex][n.payload.colIndex]};return i&&(i.playbackSettings={...i.playbackSettings||{mode:"fps",duration:1,beats:8,speedMultiplier:1},...n.payload.settings},r[n.payload.layerIndex][n.payload.colIndex]=i),{...a,clipContents:r}}case"SET_CLIP_PARAM_SYNC":{const{layerIndex:r,colIndex:i,paramId:o,syncMode:u}=n.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h){const p=h.syncSettings||{},v=p[o]===u?null:u;h.syncSettings={...p,[o]:v},f[r][i]=h}return{...a,clipContents:f}}case"UPDATE_GENERATOR_PARAM":{const r=[...a.clipContents];r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i={...r[n.payload.layerIndex][n.payload.colIndex]};return i&&i.type==="generator"&&i.currentParams&&(i.currentParams={...i.currentParams,[n.payload.paramName]:n.payload.newValue},r[n.payload.layerIndex][n.payload.colIndex]=i,a.selectedLayerIndex===n.payload.layerIndex&&a.selectedColIndex===n.payload.colIndex)?{...a,clipContents:r,selectedGeneratorParams:i.currentParams}:{...a,clipContents:r}}case"SET_DACS":return{...a,dacs:n.payload};case"SET_BPM":return{...a,bpm:n.payload};case"SET_SELECTED_DAC":return{...a,selectedDac:n.payload};case"SET_IS_PLAYING":return{...a,isPlaying:n.payload};case"SET_IS_STOPPED":return{...a,isStopped:n.payload};case"SET_WORLD_OUTPUT_ACTIVE":return{...a,isWorldOutputActive:n.payload};case"SET_OPTIMIZATION_ENABLED":return{...a,optimizationEnabled:n.payload};case"TOGGLE_WORLD_OUTPUT_ACTIVE":return{...a,isWorldOutputActive:!a.isWorldOutputActive};case"SET_CLIPBOARD":return{...a,clipClipboard:n.payload};case"SET_CLIP_DAC":{const r=[...a.clipContents];if(!r[n.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${n.payload.layerIndex} is undefined. Action:`,n),a;r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const i=r[n.payload.layerIndex][n.payload.colIndex]||{};let o=i.assignedDacs||[];const u=[],f=p=>{const{channels:v,allChannels:y,...S}=p;return S};if(n.payload.dac.allChannels&&n.payload.dac.channels)n.payload.dac.channels.forEach(p=>{o.some(v=>v.ip===n.payload.dac.ip&&v.channel===p.serviceID)||u.push({...f(n.payload.dac),channel:p.serviceID,mirrorX:!1,mirrorY:!1})});else{const p=n.payload.dac.channel;p!==void 0&&!o.some(v=>v.ip===n.payload.dac.ip&&v.channel===p)&&u.push({...f(n.payload.dac),channel:p,mirrorX:!1,mirrorY:!1})}if(u.length===0)return a;const h={...i,assignedDacs:[...o,...u]};return r[n.payload.layerIndex][n.payload.colIndex]=h,{...a,clipContents:r}}case"SET_LAYER_DAC":{const{layerIndex:r,dac:i}=n.payload,o=[...a.layerAssignedDacs],u=o[r]||[];let f=[];const h=p=>{const{channels:v,allChannels:y,...S}=p;return S};if(i.allChannels&&i.channels)i.channels.forEach(p=>{u.some(v=>v.ip===i.ip&&v.channel===p.serviceID)||f.push({...h(i),channel:p.serviceID,mirrorX:!1,mirrorY:!1})});else{const p=i.channel;p!==void 0&&!u.some(v=>v.ip===i.ip&&v.channel===p)&&f.push({...h(i),channel:p,mirrorX:!1,mirrorY:!1})}return f.length===0?a:(o[r]=[...u,...f],{...a,layerAssignedDacs:o})}case"TOGGLE_CLIP_DAC_MIRROR":{const{layerIndex:r,colIndex:i,dacIndex:o,axis:u}=n.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h&&h.assignedDacs){const p=[...h.assignedDacs],v={...p[o]};return u==="x"&&(v.mirrorX=!v.mirrorX),u==="y"&&(v.mirrorY=!v.mirrorY),p[o]=v,h.assignedDacs=p,f[r][i]=h,{...a,clipContents:f}}return a}case"REMOVE_CLIP_DAC":{const r=[...a.clipContents];r[n.payload.layerIndex]=[...r[n.payload.layerIndex]];const{layerIndex:i,colIndex:o,dacIndex:u}=n.payload,f=r[i][o];if(f&&f.assignedDacs){const h=[...f.assignedDacs];return h.splice(u,1),r[n.payload.layerIndex][n.payload.colIndex]={...f,assignedDacs:h},{...a,clipContents:r}}return a}case"TOGGLE_LAYER_DAC_MIRROR":{const{layerIndex:r,dacIndex:i,axis:o}=n.payload,u=[...a.layerAssignedDacs],f=u[r]?[...u[r]]:[];if(f[i]){const h={...f[i]};return o==="x"&&(h.mirrorX=!h.mirrorX),o==="y"&&(h.mirrorY=!h.mirrorY),f[i]=h,u[r]=f,{...a,layerAssignedDacs:u}}return a}case"REMOVE_LAYER_DAC":{const{layerIndex:r,dacIndex:i}=n.payload,o=[...a.layerAssignedDacs];if(o[r]){const u=[...o[r]];return u.splice(i,1),o[r]=u,{...a,layerAssignedDacs:o}}return a}case"SET_CLIP_AUDIO":{const r=[...a.clipContents],{layerIndex:i,colIndex:o,audioFile:u}=n.payload;r[i]=[...r[i]];const f=r[i][o];return f?(r[i][o]={...f,audioFile:u,audioVolume:f.audioVolume!==void 0?f.audioVolume:1},{...a,clipContents:r}):a}case"SET_CLIP_AUDIO_VOLUME":{const r=[...a.clipContents],{layerIndex:i,colIndex:o,volume:u}=n.payload;r[i]=[...r[i]];const f=r[i][o];return f?(r[i][o]={...f,audioVolume:u},{...a,clipContents:r}):a}case"REMOVE_CLIP_AUDIO":{const r=[...a.clipContents],{layerIndex:i,colIndex:o}=n.payload;r[i]=[...r[i]];const u=r[i][o];return u?(r[i][o]={...u,audioFile:null},{...a,clipContents:r}):a}case"SET_CLIP_PARSING_STATUS":{const{layerIndex:r,colIndex:i,status:o}=n.payload,u=[...a.clipContents];if(u[r]){u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,parsing:o},{...a,clipContents:u}}return a}case"SET_BULK_PARSING_STATUS":{const r=[...a.clipContents];return new Set(n.payload.map(o=>o.layerIndex)).forEach(o=>{r[o]&&(r[o]=[...r[o]])}),n.payload.forEach(({layerIndex:o,colIndex:u,status:f})=>{if(r[o]){const h=r[o][u]||{};r[o][u]={...h,parsing:f}}}),{...a,clipContents:r}}case"SET_THUMBNAIL_RENDER_MODE":return{...a,thumbnailRenderMode:n.payload};case"SET_CLIP_TRIGGER_STYLE":{const{layerIndex:r,colIndex:i,style:o}=n.payload,u=[...a.clipContents];u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,triggerStyle:o},{...a,clipContents:u}}case"SET_THEME":return{...a,theme:n.payload};case"UPDATE_THUMBNAIL":{const{layerIndex:r,colIndex:i,frameIndex:o}=n.payload,u=[...a.thumbnailFrameIndexes];return u[r]=[...u[r]],u[r][i]=o,{...a,thumbnailFrameIndexes:u}}case"RESET_STATE":return Fg({});case"LOAD_PROJECT":{const r={...a,...n.payload};return r.clipContents=Bl(r.clipContents,5,8,()=>({parsing:!1})),r.clipNames=Bl(r.clipNames,5,8,(i,o)=>`Clip ${i+1}-${o+1}`),r.clipContents=r.clipContents.map(i=>i.map(o=>o&&o.type==="ilda"?{...o,workerId:null,parsing:!1}:o)),r.activeClipIndexes=Array(a.layers.length).fill(null),r.selectedLayerIndex=null,r.selectedColIndex=null,r.selectedIldaWorkerId=null,r.selectedIldaTotalFrames=0,r.selectedGeneratorId=null,r.selectedGeneratorParams={},r.projectLoadTimestamp=Date.now(),r}case"LOAD_SETTINGS":return{...a,showBeamEffect:n.payload.renderSettings?.showBeamEffect??a.showBeamEffect,beamAlpha:n.payload.renderSettings?.beamAlpha??a.beamAlpha,fadeAlpha:n.payload.renderSettings?.fadeAlpha??a.fadeAlpha,playbackFps:n.payload.renderSettings?.playbackFps??a.playbackFps,previewScanRate:n.payload.renderSettings?.previewScanRate??a.previewScanRate,beamRenderMode:n.payload.renderSettings?.beamRenderMode??a.beamRenderMode,theme:n.payload.theme??a.theme,thumbnailRenderMode:n.payload.thumbnailRenderMode??a.thumbnailRenderMode,selectedDac:n.payload.selectedDac??a.selectedDac,clipNames:n.payload.clipNames?Bl(n.payload.clipNames,5,8,(r,i)=>`Clip ${r+1}-${i+1}`):a.clipNames,dacOutputSettings:n.payload.dacOutputSettings??a.dacOutputSettings};case"ASSIGN_QUICK_CONTROL":{const{type:r,index:i,link:o}=n.payload,u={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},f=r==="knob"?"knobs":"buttons";return u[f][i]={...u[f][i],label:o.paramName||o.paramId,link:o,min:o.min,max:o.max,step:o.step},{...a,quickAssigns:u}}case"CLEAR_QUICK_CONTROL":{const{type:r,index:i}=n.payload,o={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},u=r==="knob"?"knobs":"buttons";return o[u][i]={value:r==="knob"?0:!1,label:null,link:null},{...a,quickAssigns:o}}case"UPDATE_QUICK_CONTROL":{const{type:r,index:i,value:o}=n.payload,u={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},f=r==="knob"?"knobs":"buttons",h=u[f][i];u[f][i]={...h,value:o};let p={...a,quickAssigns:u};if(h.link){const{layerIndex:v,colIndex:y,effectIndex:S,targetType:b}=h.link,x=h.link.paramName||h.link.paramId;let E=o;if(r==="knob"&&h.min!==void 0&&h.max!==void 0&&(E=h.min+o*(h.max-h.min),h.step&&(E=Math.round(E/h.step)*h.step),E=parseFloat(E.toFixed(5))),console.log(`Updating ${b} param ${x} to ${E} (Link: L${v} C${y} E${S})`),b==="layerEffect"){const A=[...p.layerEffects];if(A[v]&&(A[v]=[...A[v]],A[v][S])){const D={...A[v][S]};D.params={...D.params,[x]:E},A[v][S]=D,p={...p,layerEffects:A}}}else if(b==="global")x==="master_intensity"?p={...p,masterIntensity:E}:x==="master_speed"&&(p={...p,playbackFps:E});else{const A=[...p.clipContents];if(A[v]){A[v]=[...A[v]];const D=A[v][y];if(D)if(b==="effect"&&D.effects&&D.effects[S]){const F=[...D.effects],R={...F[S]};R.params={...R.params,[x]:E},F[S]=R,A[v][y]={...D,effects:F}}else b==="generator"&&(A[v][y]={...D,currentParams:{...D.currentParams,[x]:E}});p.clipContents=A}}}return p}case"TOGGLE_QUICK_BUTTON":{const{index:r}=n.payload,o=!a.quickAssigns.buttons[r].value,u={...a.quickAssigns,buttons:[...a.quickAssigns.buttons]};u.buttons[r]={...u.buttons[r],value:o};let f={...a,quickAssigns:u};const h=u.buttons[r];if(h.link){const{layerIndex:p,colIndex:v,effectIndex:y,targetType:S}=h.link,b=h.link.paramName||h.link.paramId;if(S==="global")b==="blackout"?f.globalBlackout=o:b==="laser_output"&&(f.isWorldOutputActive=o);else if(S==="layer"){if(b==="blackout"){const x=[...f.layerBlackouts];x[p]=o,f={...f,layerBlackouts:x}}else if(b==="solo"){const x=[...f.layerSolos];o?(x.fill(!1),x[p]=!0):x[p]=!1,f={...f,layerSolos:x}}else if(b==="clear"){if(o){const x=[...f.activeClipIndexes];x[p]=null,f={...f,activeClipIndexes:x},u.buttons[r].value=!1,f.quickAssigns=u}}else if(b==="autopilot"){const x=[...f.layerAutopilots];x[p]=o?"forward":"off",f={...f,layerAutopilots:x}}}else if(S==="layerEffect"){const x=[...f.layerEffects];if(x[p]&&(x[p]=[...x[p]],x[p][y])){const E={...x[p][y]};E.params={...E.params,[b]:o},x[p][y]=E,f={...f,layerEffects:x}}}else{const x=[...f.clipContents];if(x[p]){x[p]=[...x[p]];const E=x[p][v];if(E)if(S==="effect"&&E.effects&&E.effects[y]){const A=[...E.effects],D={...A[y]};D.params={...D.params,[b]:o},A[y]=D,x[p][v]={...E,effects:A}}else S==="generator"&&(x[p][v]={...E,currentParams:{...E.currentParams,[b]:o}});f.clipContents=x}}}return f}case"UPDATE_CLIP_FILE_PATH":{const{oldPath:r,newPath:i}=n.payload;console.log(`Reducer: Updating clip path from ${r} to ${i}`);const o=a.clipContents.map(u=>u.map(f=>{let h=f;return f&&f.filePath===r&&(h={...h,filePath:i,parsingFailed:!1}),f&&f.audioFile&&f.audioFile.path===r&&(h={...h,audioFile:{...f.audioFile,path:i}}),h}));return{...a,clipContents:o}}case"SET_CLIP_PARSING_FAILED":{const{layerIndex:r,colIndex:i,failed:o}=n.payload,u=[...a.clipContents];if(u[r]){u[r]=[...u[r]];const f=u[r][i];f&&(u[r][i]={...f,parsingFailed:o})}return{...a,clipContents:u}}default:return a}}const dc={orange:{full:60,dim:10},yellow:{full:74,dim:15},cyan:{full:36,dim:35},"light-blue":{full:41,dim:43},blue:{full:45,dim:47},magenta:{full:53,dim:55},red:{full:5,dim:7},green:{full:21,dim:23},white:{full:3,dim:1}},dE=({isPlaying:a,globalBlackout:n,layerBlackouts:r,layerSolos:i,isWorldOutputActive:o,clipContents:u,activeClipIndexes:f,theme:h,bpm:p,quickAssigns:v})=>{const{sendFeedback:y,mappings:S,selectedMidiInputId:b,midiInitialized:x}=wc();return T.useEffect(()=>{if(!b||!x||!a){x&&b&&pc(b,"F#6",0,1);return}let E=!1;const A=6e4/(p||120),D=setInterval(()=>{E=!E,pc(b,"F#6",E?127:0,1)},A/2);return()=>{clearInterval(D),pc(b,"F#6",0,1)}},[a,p,b,x]),T.useEffect(()=>{y("transport_play",a),y("transport_stop",!a)},[a,y]),T.useEffect(()=>{y("comp_blackout",n)},[n,y]),T.useEffect(()=>{y("laser_output",o)},[o,y]),T.useEffect(()=>{r.forEach((E,A)=>{y(`layer_${A}_blackout`,E)})},[r,y]),T.useEffect(()=>{i.forEach((E,A)=>{y(`layer_${A}_solo`,E)})},[i,y]),T.useEffect(()=>{if(!u||!f)return;const E=dc[h]||dc.orange;u.forEach((A,D)=>{A.forEach((F,R)=>{const N=`clip_${D}_${R}`;if(S[N]){const _=f[D]===R,M=F!==null&&(F.type==="ilda"||F.type==="generator"),j=F?.triggerStyle||"normal";let B=0,H=null;_?(B=E.full,j==="toggle"&&(H=10)):M&&(B=E.dim),y(N,B,H)}})})},[u,f,h,S,y]),T.useEffect(()=>{if(!v)return;const E=dc[h]||dc.orange;v.buttons.forEach((A,D)=>{y(`quick_btn_${D}`,A.value?E.full:0)})},[v,h,y]),null},Lf=async(a,n,r,i,o=!0)=>{if(!a||!a.points)return null;let u=a;if(o)try{const F=Kf(a.points);u={...a,points:F,isTypedArray:!0}}catch(F){console.warn("Failed to optimize points for thumbnail:",F)}let f=u;try{n&&n.length>0&&(f=Fl(u,n,{progress:0,time:0,effectStates:{},assignedDacs:[]}))}catch(F){console.warn("Failed to apply effects for thumbnail:",F)}const h=128,p=128,v=document.createElement("canvas");v.width=h,v.height=p;const y=v.getContext("2d");y.fillStyle="#000000",y.fillRect(0,0,h,p);const S=f.points,b=f.isTypedArray||S instanceof Float32Array,x=b?S.length/8:S.length;y.lineWidth=1.5,y.lineCap="round";let E=null,A=null,D=!0;for(let F=0;F<x;F++){let R,N,_,M,j,B;if(b){const J=F*8;R=S[J],N=S[J+1],_=S[J+3],M=S[J+4],j=S[J+5],B=S[J+6]>.5}else{const J=S[F];R=J.x,N=J.y,_=J.r,M=J.g,j=J.b,B=!!J.blanking}const H=(R+1)*.5*h,K=(1-(N+1)*.5)*p;if(!B&&!D&&E!==null){y.beginPath(),y.moveTo(E,A),y.lineTo(H,K);const J=Math.floor(Math.max(0,Math.min(255,_))),G=Math.floor(Math.max(0,Math.min(255,M))),V=Math.floor(Math.max(0,Math.min(255,j)));y.strokeStyle=`rgb(${J},${G},${V})`,y.stroke()}E=H,A=K,D=B}try{const R=await(await new Promise(N=>v.toBlob(N,"image/png"))).arrayBuffer();if(window.electronAPI&&window.electronAPI.saveThumbnail){const N=`thumb_L${r}_C${i}.png`;return await window.electronAPI.saveThumbnail(R,N)}}catch(F){console.error("Error generating/saving thumbnail:",F)}return null},Cm=Gn.memo(({type:a,previewFrameCountRef:n,totalPointsSentRef:r,activeChannelsCountRef:i,lastStatUpdateTimeRef:o})=>{const[u,f]=T.useState({cpu:"0.0",ram:"0",fps:0,pps:0,avgPps:0});return T.useEffect(()=>{const h=window.electronAPI?.onSystemStats(v=>{f(y=>({...y,...v}))});let p;return a==="performance"&&o&&n&&r&&i&&(p=setInterval(()=>{const v=performance.now(),y=(v-(o.current||0))/1e3;if(y>0){const S=Math.round((n.current||0)/y),b=Math.round((r.current||0)/y),x=(i.current||0)>0?Math.round(b/i.current):0;f(E=>({...E,fps:S,pps:b,avgPps:x})),n.current=0,r.current=0,o.current=v}},1e3)),()=>{h&&h(),p&&clearInterval(p)}},[a,n,r,i,o]),a==="system"?g.jsxs("div",{className:"systemStats",children:[g.jsxs("p",{className:"sysStats",children:["CPU: ",u.cpu,"%"]}),g.jsxs("p",{className:"sysStats",children:["RAM: ",u.ram,"MB"]})]}):g.jsxs("div",{className:"performanceStats",children:[g.jsxs("p",{className:"perfStats",children:["FPS: ",u.fps]}),g.jsxs("p",{className:"perfStats",children:["AnimPPS: ",u.avgPps," (Avg)"]})]})}),pE=Gn.memo(({playbackFps:a,previewScanRate:n,previewFrameCountRef:r,totalPointsSentRef:i,activeChannelsCountRef:o,lastStatUpdateTimeRef:u})=>g.jsxs("div",{className:"system-monitor-grid",children:[g.jsx(Cm,{type:"performance",previewFrameCountRef:r,totalPointsSentRef:i,activeChannelsCountRef:o,lastStatUpdateTimeRef:u}),g.jsx(Cm,{type:"system",previewFrameCountRef:r,totalPointsSentRef:i,activeChannelsCountRef:o,lastStatUpdateTimeRef:u})]})),hE=Gn.memo(({clipContents:a,activeClipIndexes:n,layerEffects:r,bpm:i,playbackFps:o,selectedLayerIndex:u,selectedColIndex:f,liveFramesRef:h,progressRef:p,selectedDac:v,liveDacOutputSettingsRef:y,dacOutputSettings:S,getAudioInfo:b,fftLevels:x,getFftLevels:E,effectStatesRef:A,clipActivationTimesRef:D,showBeamEffect:F,beamAlpha:R,fadeAlpha:N,previewScanRate:_,beamRenderMode:M,worldShowBeamEffect:j,worldBeamRenderMode:B,masterIntensity:H,layerIntensities:K,globalBlackout:J,layerSolos:G,layerBlackouts:V,handleToggleBeamEffect:X,handleCycleDisplayMode:Y,previewFrameCountRef:Q,totalPointsSentRef:L,activeChannelsCountRef:z,lastStatUpdateTimeRef:ne,liveClipContentsRef:fe,optimizationEnabled:U})=>{const[Z,ue]=T.useState(0),be=T.useRef(0),oe=T.useRef(performance.now()),Se=1e3/70;T.useEffect(()=>{let Ne;const ye=te=>{te-be.current>Se&&(Q.current++,oe.current=performance.now(),ue(ft=>ft+1),be.current=te),Ne=requestAnimationFrame(ye)};return Ne=requestAnimationFrame(ye),()=>cancelAnimationFrame(Ne)},[Se,Q]);const Ee=fe?.current||a,Xe=u!==null&&f!==null?Ee[u][f]:null,Ge=f!==null?Xe?.type==="ilda"?Xe?.workerId:`generator-${u}-${f}`:u!==null&&n[u]!==null?Ee[u][n[u]]?.type==="ilda"?Ee[u][n[u]]?.workerId:`generator-${u}-${n[u]}`:null,ct=Ge?h.current[Ge]:null,xn=Ge&&p.current[Ge]||0;let St=[],on=1;if(u!==null){const Ne=r[u]||[];if(f!==null)St=[...Xe?.effects||[],...Ne];else{const ft=n[u];ft!==null?St=[...Ee[u][ft]?.effects||[],...Ne]:St=Ne}const ye=G.some(ft=>ft);let te=K[u];J?te=0:ye?te=G[u]?V[u]?0:te:0:V[u]&&(te=0),on=te*H}const jt=T.useMemo(()=>{const Ne={};return n.forEach((ye,te)=>{if(ye!==null){const ft=Ee[te][ye];if(ft){let Dt=ft.type==="ilda"?ft.workerId:`generator-${te}-${ye}`;Dt&&h.current[Dt]&&(Ne[Dt]={frame:h.current[Dt],effects:[...ft.effects||[],...r[te]||[]],layerIndex:te,syncSettings:ft.syncSettings||{},bpm:i,clipDuration:(()=>{const Nt=ft.playbackSettings||{};return Nt.mode==="timeline"?Nt.duration||1:Nt.mode==="bpm"?(Nt.beats||8)*60/(i||120):(ft.totalFrames||30)/(ft.fps||o||30)})(),progress:p.current[Dt]||0,effectStates:A.current,clipActivationTime:D.current[te]||0})}}}),Ne},[n,Ee,Z,i,r,o,h,p,A,D]),Mn=T.useMemo(()=>{const Ne=G.some(ye=>ye);return K.map((ye,te)=>J?0:Ne?G[te]?V[te]?0:ye:0:V[te]?0:ye)},[K,V,G,J]);return g.jsxs("div",{className:"side-panel",children:[g.jsx(b1,{frame:ct,effects:St,showBeamEffect:F,beamAlpha:R,fadeAlpha:N,previewScanRate:_,beamRenderMode:M,intensity:on,syncSettings:Xe?.syncSettings,bpm:i,clipDuration:(()=>{const Ne=Xe?.playbackSettings||{};return Ne.mode==="timeline"?Ne.duration||1:Ne.mode==="bpm"?(Ne.beats||8)*60/(i||120):(Xe?.totalFrames||30)/(Xe?.fps||o||30)})(),progress:xn,previewTime:oe.current,fftLevels:E?E():x,effectStates:A.current,clipActivationTime:u!==null&&D.current[u]||0,optimizationEnabled:U,onToggleBeamEffect:()=>X("clip"),onCycleDisplayMode:()=>Y("clip")}),g.jsx(x1,{activeFrames:jt,showBeamEffect:j,beamAlpha:R,fadeAlpha:N,previewScanRate:_,beamRenderMode:B,layerIntensities:Mn,masterIntensity:H,dacSettings:v?y.current?y.current[`${v.ip}:${v.channel}`]:S[`${v.ip}:${v.channel}`]:null,previewTime:oe.current,fftLevels:E?E():x,optimizationEnabled:U,onToggleBeamEffect:()=>X("world"),onCycleDisplayMode:()=>Y("world")})]})});function mE(){const a=k1(),n=Lm(),r=U1(),i=T.useRef(null),{fftLevels:o,getFftLevels:u}=Hl()||{};T.useEffect(()=>{const O=new Worker(new URL(""+new URL("ui-generators.worker-KLOryRgN.js",import.meta.url).href,import.meta.url),{type:"module"});i.current=O;const k=q=>{if(!q.data.browserFile){if(q.data.layerIndex!==void 0&&q.data.colIndex!==void 0){const I=`${q.data.layerIndex}-${q.data.colIndex}`;if(Xn.current.set(I,!1),or.current.has(I)){const{message:W,transferables:de}=or.current.get(I);or.current.delete(I),console.log(`[App.jsx] UI Generator ${I} free, processing pending seq ${W.seq}`),Xn.current.set(I,!0),O.postMessage(W,de)}}if(q.data.success){const{layerIndex:I,colIndex:W,frames:de,generatorDefinition:ce,currentParams:we,isLive:Me,isAutoUpdate:Ye,seq:he}=q.data;if(I===void 0||W===void 0)return;if(he!==void 0){if(he<ys.current)return;ys.current=he}const Pe=`generator-${I}-${W}`;if(R.current[Pe]=de[0],!Me&&!Ye){const Ae=zt.current[I][W]||{},Re={...Ae,type:"generator",generatorDefinition:ce,frames:de,currentParams:we,playbackSettings:Ae.playbackSettings||{mode:"fps",duration:5,beats:8,speedMultiplier:1}};te({type:"SET_CLIP_CONTENT",payload:{layerIndex:I,colIndex:W,content:Re}});const Oe=lr.current[I][W],Te=`Clip ${I+1}-${W+1}`;Oe===Te&&te({type:"SET_CLIP_NAME",payload:{layerIndex:I,colIndex:W,name:ce.name}})}}else en(`UI Generator error: ${q.data.error}`)}};return O.addEventListener("message",k),()=>{O.removeEventListener("message",k),O.terminate()}},[]);const{devices:f,selectedDeviceId:h,setSelectedDeviceId:p,playAudio:v,stopAudio:y,pauseAllAudio:S,resumeAllAudio:b,setPlaybackRate:x,resetAllAudio:E,stopAllAudio:A,getAudioInfo:D,setClipVolume:F}=zm();T.useRef(new Set),T.useRef(0);const R=T.useRef({}),N=T.useRef(new Map),_=T.useRef({}),M=T.useRef({}),j=T.useRef({}),B=T.useRef({}),[H,K]=T.useState(null),[J,G]=T.useState(!1),[V,X]=T.useState(!1),[Y,Q]=T.useState({midi:!1,artnet:!1,osc:!1,keyboard:!1}),[L,z]=T.useState(!1),[ne,fe]=T.useState(!1),[U,Z]=T.useState(!1),[ue,be]=T.useState(!1),[oe,Se]=T.useState({title:"",initialValue:"",onSave:()=>{}}),[Ee,Xe]=T.useState("files"),[Ge,ct]=T.useState("clip"),[xn,St]=T.useState([]),on=T.useRef(0),jt=T.useRef(0),Mn=T.useRef(0),Ne=T.useRef(performance.now()),[ye,te]=T.useReducer(fE,Fg(J?H:{})),ft=T.useRef(new Map),Dt=T.useCallback((O,k,q=30)=>{ft.current.has(O)&&clearTimeout(ft.current.get(O));const I=setTimeout(()=>{te(k),ft.current.delete(O)},q);ft.current.set(O,I)},[]),{columns:Nt,layers:ke,clipContents:qe,clipNames:Ln,thumbnailFrameIndexes:Ut,layerEffects:Ia,layerAssignedDacs:va,layerIntensities:cn,layerAutopilots:ia,layerBlackouts:Kt,layerSolos:Mr,masterIntensity:Gs,globalBlackout:Nr,selectedLayerIndex:ze,selectedColIndex:rt,notification:Ba,dacs:Fa,selectedDac:Nn,ildaFrames:dd,selectedIldaWorkerId:nr,selectedIldaTotalFrames:zs,showBeamEffect:ya,beamAlpha:zn,fadeAlpha:ar,playbackFps:Hn,previewScanRate:ba,beamRenderMode:Yn,worldShowBeamEffect:Hs,worldBeamRenderMode:Fi,optimizationEnabled:ja,activeClipIndexes:_t,isPlaying:Pt,isWorldOutputActive:It,selectedGeneratorId:fs,selectedGeneratorParams:$l,thumbnailRenderMode:Wl,theme:Ys,dacOutputSettings:Rn}=ye,qn=T.useMemo(()=>ke.map((O,k)=>{const q=_t[k];if(q!==null){const I=qe[k][q];if(I){let W,de=null;if(I.type==="ilda"&&I.workerId&&I.totalFrames)return W=I.workerId,de=I.stillFrame,{type:"ilda",workerId:W,totalFrames:I.totalFrames,effects:I.effects||[],dac:I.dac||null,assignedDacs:I.assignedDacs||[],ildaFormat:I.ildaFormat||0,stillFrame:de,layerIndex:k,syncSettings:I.syncSettings||{},fps:I.fps||null};if(I.type==="generator"&&I.frames&&I.generatorDefinition)return W=`generator-${k}-${q}`,de=I.stillFrame||I.frames?.[0]||null,{type:"generator",workerId:W,totalFrames:I.frames.length,effects:I.effects||[],dac:I.dac||null,assignedDacs:I.assignedDacs||[],ildaFormat:0,stillFrame:de,layerIndex:k,syncSettings:I.syncSettings||{},fps:I.fps||null}}}return null}).filter(Boolean),[ke,_t,qe]),zt=T.useRef(qe),it=T.useRef(null),Dn=T.useRef(!1),_n=T.useRef(null),Pa=T.useRef(!1);T.useEffect(()=>{qe&&(it.current=structuredClone(qe))},[]),T.useEffect(()=>{Rn&&(_n.current=structuredClone(Rn))},[]);const Ht=T.useRef(cn),qs=T.useRef(ia),xa=T.useRef(Ia),la=T.useRef(Gs),Ga=T.useRef(Kt),ds=T.useRef(Mr),Vs=T.useRef(Nr),rr=T.useRef(Pt),ji=T.useRef(It),Rr=T.useRef(Nn),sr=T.useRef(ye.bpm),Vn=T.useRef(ze),ps=T.useRef(rt),Pi=T.useRef(D),za=T.useRef(ja);T.useEffect(()=>{rr.current=Pt},[Pt]),T.useEffect(()=>{ji.current=It},[It]),T.useEffect(()=>{Rr.current=Nn},[Nn]),T.useEffect(()=>{sr.current=ye.bpm},[ye.bpm]),T.useEffect(()=>{Vn.current=ze},[ze]),T.useEffect(()=>{ps.current=rt},[rt]),T.useEffect(()=>{Pi.current=D},[D]),T.useEffect(()=>{za.current=ja},[ja]);const ir=T.useRef(Hn);T.useEffect(()=>{ir.current=Hn},[Hn]);const Dr=T.useRef(Rn),Kl=T.useRef(Fa),Xs=T.useRef([]),Jt=T.useRef(_t),Gi=T.useRef(va),lr=T.useRef(Ln),_r=T.useRef(nr),Jl=T.useRef(zs),hs=T.useRef({}),ms=T.useRef(new Map),Sn=T.useRef(new Map),gs=T.useRef(new Map),vs=T.useRef(null),kr=T.useRef({}),Un=T.useRef(null),Ha=T.useRef(0),ys=T.useRef(0),Xn=T.useRef(new Map),or=T.useRef(new Map);T.useRef(performance.now()),T.useEffect(()=>{if(Dn.current){Dn.current=!1;return}qe&&(it.current=structuredClone(qe))},[qe]),T.useEffect(()=>{if(Pa.current){Pa.current=!1;return}Rn&&(_n.current=structuredClone(Rn))},[Rn]),T.useEffect(()=>{Ht.current=cn,qs.current=ia,xa.current=Ia,la.current=Gs,Ga.current=Kt,ds.current=Mr,Vs.current=Nr,ir.current=Hn,Kl.current=Fa,Xs.current=qn,zt.current=qe,Jt.current=_t,Gi.current=va,lr.current=Ln,_r.current=nr,Jl.current=zs},[cn,va,ia,Ia,Gs,Kt,Mr,Nr,Rn,Fa,qn,qe,_t,Ln,nr,zs]);const eo=T.useCallback(O=>{const k=1-O*2,q=[],I=100;for(let W=0;W<I;W++){const de=W/(I-1)*2-1;q.push({x:de,y:k,r:0,g:255,b:0,blanking:!1})}return{points:q,isTypedArray:!1}},[]),zi=T.useCallback((O,k)=>{_n.current&&(_n.current[O]=k,Pa.current=!0),te({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:O,settings:k}})},[]),Qs=T.useCallback(O=>{te({type:"SET_RENDER_SETTING",payload:{setting:"playbackFps",value:O}})},[]);T.useEffect(()=>{const O=Hn/60;x(O)},[Hn,x]);const en=O=>{te({type:"SET_NOTIFICATION",payload:{message:O,visible:!0}}),setTimeout(()=>{te({type:"SET_NOTIFICATION",payload:{message:"",visible:!1}})},3e3)};T.useEffect(()=>{const O={orange:"#ff5e00",yellow:"#ffd400",cyan:"#00fff3","light-blue":"#0089ff",blue:"#005aff",magenta:"#fb00ff",red:"#ff0000",green:"#00ff00",white:"#ffffff"},k=O[Ys]||O.orange;document.documentElement.style.setProperty("--theme-color",k);const q=parseInt(k.slice(1,3),16),I=parseInt(k.slice(3,5),16),W=parseInt(k.slice(5,7),16);document.documentElement.style.setProperty("--theme-color-transparent",`rgba(${q}, ${I}, ${W}, 0.3)`),window.electronAPI&&window.electronAPI.setTheme&&window.electronAPI.setTheme(Ys)},[Ys]),T.useEffect(()=>{window.electronAPI&&window.electronAPI.setSelectedDac&&window.electronAPI.setSelectedDac(Nn)},[Nn]),T.useMemo(()=>{const O=new Set;return nr&&O.add(nr),qn.forEach(k=>{k&&k.type==="ilda"&&k.workerId&&O.add(k.workerId)}),Array.from(O)},[nr,qn]),T.useEffect(()=>{if(!a)return;const O=async he=>{if(!he.data.browserFile){if(he.data.type==="get-frame"&&he.data.success)if(he.data.isStillFrame){const{workerId:Pe,frame:Ae,layerIndex:Re,colIndex:Oe}=he.data;if(Re===void 0||Oe===void 0)return;let Te=null;const We=(it.current?it.current:zt.current)?.[Re]?.[Oe],Le=We?.effects||[];let Fe=null;const et=We?.assignedDacs||[];if(et.length>0){const pt=et[0],kt=`${pt.ip}:${pt.channel}`;Fe=Dr.current[kt]}else if(Nn){const pt=`${Nn.ip}:${Nn.channel}`;Fe=Dr.current[pt]}let mt=Ae;Fe&&(mt=Bf(Ae,Fe)),Te=await Lf(mt,Le,Re,Oe,ja),te({type:"SET_CLIP_CONTENT",payload:{layerIndex:Re,colIndex:Oe,content:{stillFrame:Ae,parsing:!1,thumbnailPath:Te,thumbnailVersion:Date.now()}}})}else R.current[he.data.workerId]=he.data.frame;else if(he.data.type==="parse-ilda"&&he.data.success){const{workerId:Pe,totalFrames:Ae,ildaFormat:Re,fileName:Oe,filePath:Te,layerIndex:je,colIndex:We}=he.data;if(je===void 0||We===void 0)return;const Le={type:"ilda",workerId:Pe,totalFrames:Ae,ildaFormat:Re,fileName:Oe,filePath:Te,parsing:!0,playbackSettings:{mode:"fps",duration:Ae/60,beats:8,speedMultiplier:1}};te({type:"SET_CLIP_CONTENT",payload:{layerIndex:je,colIndex:We,content:Le}});const Fe=lr.current[je][We],et=`Clip ${je+1}-${We+1}`;Fe===et&&te({type:"SET_CLIP_NAME",payload:{layerIndex:je,colIndex:We,name:Oe}})}else if(he.data.type==="get-all-frames"&&he.data.success){console.log("Received get-all-frames response:",he.data);const{frames:Pe,workerId:Ae,layerIndex:Re,colIndex:Oe}=he.data;if(Re===void 0||Oe===void 0)return;R0(async()=>{const{framesToIlda:Te}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Te}},[],import.meta.url).then(({framesToIlda:Te})=>{const je=Te(Pe),Le=zt.current[Re][Oe].fileName||"export.ild";window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(je,Le).then(Fe=>{Fe.success?en(`Exported to ${Fe.filePath}`):Fe.error&&en(`Export failed: ${Fe.error}`)})}).catch(Te=>console.error("Failed to load ilda-writer in response:",Te))}else if(he.data.success===!1){en(`Worker error: ${he.data.error}`);const{layerIndex:Pe,colIndex:Ae}=he.data;Pe!==void 0&&Ae!==void 0&&te({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:Pe,colIndex:Ae,status:!1}})}}};a.addEventListener("message",O);let k,q,I=0;const W=60,de=1e3/W,ce=he=>{if(he.length===0)return null;if(he.length===1){const Oe=he[0],Te=Oe.points instanceof Float32Array||Oe.isTypedArray;return{...Oe,points:Te?new Float32Array(Oe.points):Oe.points.map(je=>({...je})),isTypedArray:Te}}let Pe=0;he.forEach((Oe,Te)=>{const We=Oe.points instanceof Float32Array||Oe.isTypedArray?Oe.points.length/8:Oe.points.length;Pe+=We,Te<he.length-1&&(Pe+=2)});const Ae=new Float32Array(Pe*8);let Re=0;return he.forEach((Oe,Te)=>{const je=Oe.points instanceof Float32Array||Oe.isTypedArray,We=je?Oe.points.length/8:Oe.points.length;for(let Le=0;Le<We;Le++){const Fe=(Re+Le)*8;if(je){const et=Le*8;Ae.set(Oe.points.subarray(et,et+8),Fe)}else{const et=Oe.points[Le];Ae[Fe]=et.x,Ae[Fe+1]=et.y,Ae[Fe+2]=et.z||0,Ae[Fe+3]=et.r,Ae[Fe+4]=et.g,Ae[Fe+5]=et.b,Ae[Fe+6]=et.blanking?1:0,Ae[Fe+7]=et.lastPoint?1:0}Ae[Fe+7]=0}if(Re+=We,Te<he.length-1){const Le=he[Te+1],Fe=Le.points instanceof Float32Array||Le.isTypedArray,et=Ae[(Re-1)*8],mt=Ae[(Re-1)*8+1];let pt,kt;Fe?(pt=Le.points[0],kt=Le.points[1]):(pt=Le.points[0].x,kt=Le.points[0].y);let Et=Re*8;Ae[Et]=et,Ae[Et+1]=mt,Ae[Et+6]=1,Ae[Et+3]=0,Ae[Et+4]=0,Ae[Et+5]=0;let tt=(Re+1)*8;Ae[tt]=pt,Ae[tt+1]=kt,Ae[tt+6]=1,Ae[tt+3]=0,Ae[tt+4]=0,Ae[tt+5]=0,Re+=2}}),Ae[(Pe-1)*8+7]=1,{points:Ae,isTypedArray:!0}},we=he=>{if(!ji.current){cancelAnimationFrame(q);return}if(he-I>de){if(window.electronAPI&&ji.current){const Pe=new Map;Xs.current.forEach(Re=>{if(Re&&R.current[Re.workerId]){const Oe=Gi.current[Re.layerIndex]||[],Te=Re.assignedDacs||[];let je=[...Oe,...Te];je.length===0&&Rr.current&&(je=[Rr.current]);const We=[],Le=new Set;if(je.forEach(Je=>{const oa=Je.channel!==void 0?Je.channel:Je.channels&&Je.channels.length>0?Je.channels[0].serviceID:0,un=`${Je.ip}:${oa}`;Le.has(un)||(Le.add(un),We.push({...Je,channel:oa}))}),We.length===0)return;const et=(it.current||zt.current)[Re.layerIndex][Jt.current[Re.layerIndex]],mt=et?et.effects||[]:Re.effects||[],pt=Re.layerIndex,kt=xa.current[pt]||[],Et=[...mt,...kt],tt=R.current[Re.workerId],ti=Ht.current[Re.layerIndex],wn=Vs.current,Qt=Ga.current[Re.layerIndex],wt=ds.current[Re.layerIndex],gt=ds.current.some(Je=>Je);let tn=ti;wn?tn=0:gt?wt?Qt&&(tn=0):tn=0:Qt&&(tn=0);const yt=tn*la.current;if(yt<=0)return;const ut=_.current[Re.workerId]||0;Re.syncSettings;const Yt={...tt,points:Me(tt.points)?tt.points:tt.points.map(Je=>({...Je,r:Math.round(Je.r*yt),g:Math.round(Je.g*yt),b:Math.round(Je.b*yt)}))};if(Me(Yt.points)){const Je=Yt.points,oa=Je.length/8,un=new Float32Array(Je);for(let In=0;In<oa;In++)un[In*8+3]*=yt,un[In*8+4]*=yt,un[In*8+5]*=yt;Yt.points=un}const gn=et?et.playbackSettings:Re.playbackSettings||{};let qa=1;if(gn.mode==="timeline")qa=gn.duration||1;else if(gn.mode==="bpm"){const Je=sr.current||120;qa=(gn.beats||8)*60/Je}else{const Je=gn.fps||Re.fps||ir.current||30;qa=(Re.totalFrames||30)/Je}const Va=gn.speedMultiplier||1;Va!==0&&(qa/=Va);const Bt=Fl(Yt,Et,{progress:ut,time:he,effectStates:N.current,assignedDacs:We,syncSettings:Re.syncSettings||{},bpm:sr.current,clipDuration:qa,fftLevels:u?u():o});if(za.current){const Je=Kf(Bt.points);Bt.points=Je,Bt.isTypedArray=!0}We.forEach((Je,oa)=>{const un=Je.ip,In=Je.channel||(Je.channels&&Je.channels.length>0?Je.channels[0].serviceID:0);if(In!==void 0){const ni=`${un}:${In}`;Pe.has(ni)||Pe.set(ni,{ip:un,channel:In,type:Je.type,frames:[]});let Ca=Bt;if(Bt.points&&Bt.points._channelDistributions){const Zn=Bt.points._channelDistributions.get(oa);if(Zn){const Br=Bt.points.subarray(Zn.start,Zn.start+Zn.length);Ca={...Bt,points:Br}}else Ca={...Bt,points:new Float32Array(0)}}if(Je.mirrorX||Je.mirrorY){const Zn=Ca.points,Br=Ca.isTypedArray,so=Br?Zn.length/8:Zn.length,ca=Br?new Float32Array(Zn):Zn.map(Bn=>({...Bn}));for(let Bn=0;Bn<so;Bn++)Br?(Je.mirrorX&&(ca[Bn*8]=-ca[Bn*8]),Je.mirrorY&&(ca[Bn*8+1]=-ca[Bn*8+1])):(Je.mirrorX&&(ca[Bn].x=-ca[Bn].x),Je.mirrorY&&(ca[Bn].y=-ca[Bn].y));Ca={...Ca,points:ca}}Pe.get(ni).frames.push(Ca)}})}}),Kl.current.forEach(Re=>{(Re.channels&&Re.channels.length>0?Re.channels.map(Te=>Te.serviceID):[0]).forEach(Te=>{const je=`${Re.ip}:${Te}`,We=_n.current?_n.current[je]:Dr.current[je];if(We){Pe.has(je)||Pe.set(je,{ip:Re.ip,channel:Te,type:Re.type,frames:[]});const Le=Pe.get(je);if(We.testLineEnabled){const Fe=eo(We.testLineY!==void 0?We.testLineY:.5);Le.frames=[Fe]}}})});let Ae=0;Pe.forEach(Re=>{let Oe=ce(Re.frames);const Te=`${Re.ip}:${Re.channel}`,je=_n.current?_n.current[Te]:Dr.current[Te];if(Oe&&je){if(je.dimmer!==void 0&&je.dimmer<1){const We=je.dimmer,Le=Oe.points,Fe=Oe.isTypedArray,et=Fe?Le.length/8:Le.length;for(let mt=0;mt<et;mt++)Fe?(Le[mt*8+3]*=We,Le[mt*8+4]*=We,Le[mt*8+5]*=We):(Le[mt].r*=We,Le[mt].g*=We,Le[mt].b*=We)}Oe=Bf(Oe,je,!1)}if(Oe){Ae++;const We=Me(Oe.points)?Oe.points.length/8:Oe.points.length;jt.current+=We,window.electronAPI.sendFrame(Re.ip,Re.channel,Oe.points,W,Re.type,{skipOptimization:za.current})}}),Mn.current=Ae}I=he}q=requestAnimationFrame(we)};function Me(he){return!!he&&(he instanceof Float32Array||he.buffer instanceof ArrayBuffer)}const Ye=he=>{const Pe=1e3/ir.current,Ae=sr.current||120,Re=(Te,je,We,Le)=>{j.current[Le]||(j.current[Le]=he);let Fe=he-j.current[Le];Fe>1e3&&(Fe=Pe),rr.current&&(kr.current[Le]===void 0&&(kr.current[Le]=0),kr.current[Le]+=Fe);const et=kr.current[Le]||0,mt=Jt.current[je]!==null?Pi.current(je):null;let pt=B.current[Le]||0,kt=0;const Et=Te.totalFrames||1,tt=Te.playbackSettings||{mode:"fps",duration:Et/60,beats:8,speedMultiplier:1};if(mt&&rr.current&&!mt.paused)kt=mt.duration>0?mt.currentTime/mt.duration:0,pt=Math.floor(kt*Et);else if(tt.mode==="timeline"){const wt=tt.duration*1e3/(tt.speedMultiplier||1);wt>0&&(kt=et/wt%1,pt=Math.floor(kt*Et))}else if(tt.mode==="bpm"){const wt=6e4/Ae,gt=tt.beats*wt/(tt.speedMultiplier||1);gt>0&&(kt=et/gt%1,pt=Math.floor(kt*Et))}else{const gt=1e3/((tt.fps||60)*(tt.speedMultiplier||1));if(Fe>=gt){const tn=Math.floor(Fe/gt);rr.current?(j.current[Le]=he-Fe%gt,pt=pt+tn):j.current[Le]=he,kt=Et>0?pt%Et/Et:0}else return}tt.mode!=="fps"&&(j.current[Le]=he),isNaN(pt)&&(pt=0),isNaN(kt)&&(kt=0);const wn=(hs.current[Le]||0)>.9&&kt<.1;if(hs.current[Le]=kt,_.current[Le]=kt,Et>0&&(pt=pt%Et,pt<0&&(pt+=Et)),wn&&rr.current){const wt=qs.current[je];if(wt&&wt!=="off"){const gt=zt.current[je],tn=Jt.current[je];let yt=-1;if(wt==="forward")for(let ut=1;ut<gt.length;ut++){const Yt=(tn+ut)%gt.length,gn=gt[Yt];if(gn&&(gn.type==="ilda"||gn.type==="generator")){yt=Yt;break}}else if(wt==="random"){const ut=gt.map((Yt,gn)=>Yt&&(Yt.type==="ilda"||Yt.type==="generator")?gn:-1).filter(Yt=>Yt!==-1);if(ut.length>0){const Yt=Math.floor(Math.random()*ut.length);yt=ut[Yt],yt===tn&&ut.length>1&&(yt=ut[(Yt+1)%ut.length])}}yt!==-1&&yt!==tn&&setTimeout(()=>{ur(je,yt)},0)}}let Qt=1;if(tt.mode==="timeline"?Qt=tt.duration||1:tt.mode==="bpm"?Qt=(tt.beats||8)*60/Ae:Te.type==="generator"&&(!Te.frames||Te.frames.length<=1)?Qt=tt.duration||1:Qt=Et/(tt.fps||60),Te.type==="generator"){const wt=Te.syncSettings||{},gt=Te.generatorDefinition?.id,tn=Te.generatorDefinition,yt=Object.keys(wt).filter(ut=>ut.startsWith(`${gt}.`));if(yt.length>0){const ut=Te.currentParams||{},Yt={...ut};let gn=!1;const qa={time:he,progress:kt,bpm:Ae,clipDuration:Qt,fftLevels:u?u():o,activationTime:M.current[je]||0};for(const Va of yt){const Bt=Va.split(".")[1],Je=tn?.paramControls?.find(In=>In.id===Bt),oa=ut[Bt]!==void 0?ut[Bt]:Te.generatorDefinition.defaultParams[Bt],un=gc(Bt,oa,wt[Va],qa,Je?.min,Je?.max);un!==Yt[Bt]&&(Yt[Bt]=un,gn=!0)}if(gn){const Va=++Ha.current;Qn(je,We,Te.generatorDefinition,Yt,Va,!0)}}}(B.current[Le]!==pt||!R.current[Le])&&(B.current[Le]=pt,Te.type==="ilda"?a.postMessage({type:"get-frame",workerId:Le,frameIndex:pt}):Te.type==="generator"&&(Te.frames&&Te.frames.length>1?Te.frames[pt%Te.frames.length]&&(R.current[Le]=Te.frames[pt%Te.frames.length]):!R.current[Le]&&Te.frames&&Te.frames.length>0&&(R.current[Le]=Te.frames[0])))};ke.forEach((Te,je)=>{const We=Jt.current[je];if(We===null)return;const Fe=(it.current||zt.current)[je][We];if(!Fe)return;let et=Fe.type==="ilda"?Fe.workerId:Fe.type==="generator"?`generator-${je}-${We}`:null;et&&Re(Fe,je,We,et)});const Oe=_r.current;if(Oe&&!Xs.current.some(Te=>Te.workerId===Oe)){const Te=Vn.current,je=ps.current;if(Te!==null&&je!==null){const Le=(it.current||zt.current)[Te][je];Le&&Re(Le,Te,je,Oe)}}if(Un.current){const{layerIndex:Te,colIndex:je}=Un.current,We=Jt.current[Te]===je;Vn.current===Te&&ps.current;const Le=_r.current;if(!We){const et=(it.current||zt.current)[Te]?.[je];if(et){let mt=et.type==="ilda"?et.workerId:et.type==="generator"?`generator-${Te}-${je}`:null;mt&&mt!==Le&&Re(et,Te,je,mt)}}}k=requestAnimationFrame(Ye)};return k=requestAnimationFrame(Ye),It?q=requestAnimationFrame(we):cancelAnimationFrame(q),()=>{a.removeEventListener("message",O),cancelAnimationFrame(k),cancelAnimationFrame(q)}},[a,It]),T.useEffect(()=>{let O,k,q;return window.electronAPI&&(O=window.electronAPI.onClipContextMenuCommand((I,W,de)=>{if(console.log(`Clip context menu command received: ${I} for ${W}-${de}`),I==="export-ilda"){const ce=zt.current[W][de];console.log("Exporting clip:",ce),ce&&(ce.type==="ilda"&&ce.workerId&&a?(en("Preparing ILDA export..."),console.log("Requesting frames from worker:",ce.workerId),a.postMessage({type:"get-all-frames",workerId:ce.workerId,layerIndex:W,colIndex:de})):ce.type==="generator"?(console.log("Exporting generator frames with parameter animation..."),(async()=>{const{framesToIlda:Me}=await R0(async()=>{const{framesToIlda:Fe}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Fe}},[],import.meta.url),Ye=Hn||60;let he=2;const Pe=ce.playbackSettings||{};Pe.mode==="timeline"?he=Pe.duration||2:Pe.mode==="bpm"?he=(Pe.beats||8)*60/(ye.bpm||120):ce.frames?.length>1&&(he=ce.frames.length/Ye);const Ae=Math.ceil(he*Ye),Re=[],Oe=new Map,Te=ce.generatorDefinition?.id;let je=null;if(["text","spout-receiver"].includes(Te)){const Fe=ce.currentParams?.fontUrl||"src/fonts/Geometr415 Blk BT Black.ttf";try{Fe.startsWith("http")?je=await window.electronAPI.fetchUrlAsArrayBuffer(Fe):je=await window.electronAPI.readFileForWorker(Fe)}catch(et){console.error("Failed to load font for export:",et)}}for(let Fe=0;Fe<Ae;Fe++){const et=Fe*(1e3/Ye),mt=Fe/Ae,pt=ce.syncSettings||{},kt=ce.generatorDefinition,Et=ce.currentParams||{},tt={...Et},ti={time:et,progress:mt,bpm:ye.bpm,clipDuration:he,fftLevels:{low:0,mid:0,high:0},activationTime:0};for(const Qt in pt)if(Qt.startsWith(`${Te}.`)){const wt=Qt.split(".")[1],gt=kt?.paramControls?.find(yt=>yt.id===wt),tn=Et[wt]!==void 0?Et[wt]:kt.defaultParams[wt];tt[wt]=gc(wt,tn,pt[Qt],ti,gt?.min,gt?.max)}let wn=null;try{if(Te==="circle")wn=sE(tt);else if(Te==="square")wn=iE(tt);else if(Te==="line")wn=lE(tt);else if(Te==="star")wn=oE(tt);else if(Te==="text")wn=await Tm(tt,je);else if(Te==="spout-receiver")wn=await Tm({...tt,text:tt.sourceName},je);else if(ce.frames){const Qt=Math.floor(mt*ce.frames.length)%ce.frames.length;wn=ce.frames[Qt]}}catch(Qt){console.error("Generation failed during export:",Qt)}if(wn){const Qt=(ce.effects||[]).filter(ut=>!((ut.id==="delay"||ut.id==="chase")&&ut.params?.mode==="channel")),wt=Fl(wn,Qt,{time:et,progress:mt,effectStates:Oe,syncSettings:ce.syncSettings||{},bpm:ye.bpm,clipDuration:he,assignedDacs:ce.assignedDacs||[]}),gt=wt.points,tn=gt.length/8,yt=[];for(let ut=0;ut<tn;ut++)yt.push({x:gt[ut*8],y:gt[ut*8+1],z:gt[ut*8+2],r:gt[ut*8+3],g:gt[ut*8+4],b:gt[ut*8+5],blanking:gt[ut*8+6]>.5,lastPoint:gt[ut*8+7]>.5});Re.push({...wt,points:yt,frameName:`Frame ${Fe}`,companyName:"TrueLazer"})}}const We=Me(Re),Le=`${ce.generatorDefinition?.name||"generator"}_export.ild`;if(window.electronAPI&&window.electronAPI.saveIldaFile){const Fe=await window.electronAPI.saveIldaFile(We,Le);Fe.success?en(`Exported to ${Fe.filePath}`):Fe.error&&en(`Export failed: ${Fe.error}`)}})().catch(Me=>console.error("Failed to export generator:",Me))):(console.warn("Clip type not supported for export or missing data:",ce.type,ce),ce.type==="ilda"&&!ce.workerId?en("Clip data not loaded. Please play the clip to load it."):ce.type==="generator"&&!ce.frames&&en("Generator not rendered yet.")))}else if(I==="update-thumbnail"){const ce=qe[W][de];if(ce){if(ce.type==="ilda"&&ce.workerId&&a){const we=B.current[ce.workerId]||0;a.postMessage({type:"get-frame",workerId:ce.workerId,frameIndex:we,isStillFrame:!0,layerIndex:W,colIndex:de})}else if(ce.type==="generator"&&ce.generatorDefinition){const we=B.current[`generator-${W}-${de}`]||0,Me=ce.frames?.[we%ce.frames.length];if(Me){const Ye=ce.effects||[];Lf(Me,Ye,W,de,ja).then(he=>{te({type:"SET_CLIP_CONTENT",payload:{layerIndex:W,colIndex:de,content:{stillFrame:Me,thumbnailPath:he,thumbnailVersion:Date.now()}}})})}}}}else if(I==="clear-clip")te({type:"CLEAR_CLIP",payload:{layerIndex:W,colIndex:de}});else if(I==="rename-clip"){const ce=lr.current[W][de];Se({title:"Rename Clip",initialValue:ce,onSave:we=>te({type:"SET_CLIP_NAME",payload:{layerIndex:W,colIndex:de,name:we}})}),z(!0)}else if(I==="copy-clip"){const ce={content:zt.current[W][de],name:lr.current[W][de]};te({type:"SET_CLIPBOARD",payload:ce}),en("Clip copied.")}else if(I==="cut-clip"){const ce={content:zt.current[W][de],name:lr.current[W][de]};te({type:"SET_CLIPBOARD",payload:ce}),te({type:"CLEAR_CLIP",payload:{layerIndex:W,colIndex:de}}),en("Clip cut.")}else if(I==="paste-clip")if(ye.clipClipboard){const{content:ce,name:we}=ye.clipClipboard;let Me=JSON.parse(JSON.stringify(ce));if(Me.type==="ilda"&&(Me.workerId=null),Me.effects&&Me.effects.length>0){const he={...Me.syncSettings||{}};Me.effects=Me.effects.map(Pe=>{const Ae=Pe.instanceId,Re=Il();return Object.keys(he).forEach(Oe=>{if(Ae&&Oe.startsWith(`${Ae}.`)){const Te=Oe.substring(Ae.length);he[`${Re}${Te}`]=he[Oe],delete he[Oe]}}),{...Pe,instanceId:Re}}),Me.syncSettings=he}te({type:"SET_CLIP_CONTENT",payload:{layerIndex:W,colIndex:de,content:Me}}),te({type:"SET_CLIP_NAME",payload:{layerIndex:W,colIndex:de,name:we}}),en("Clip pasted."),setTimeout(()=>{const Ye=Me;if(Ye.type==="generator"&&Ye.generatorDefinition){const he=`${W}-${de}`,Pe={...Ye.generatorDefinition.defaultParams,...Ye.currentParams};ms.current.set(he,JSON.stringify(Pe));const Ae=++Ha.current;Qn(W,de,Ye.generatorDefinition,Ye.currentParams,Ae)}},100)}else en("Clipboard is empty.");else I==="set-trigger-style-normal"?te({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:W,colIndex:de,style:"normal"}}):I==="set-trigger-style-toggle"?te({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:W,colIndex:de,style:"toggle"}}):I==="set-trigger-style-flash"&&te({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:W,colIndex:de,style:"flash"}})}),k=window.electronAPI.onLayerFullContextMenuCommand((I,W)=>{if(console.log(`Layer context menu command received: ${I} for ${W}`),I==="layer-rename"){const de=ke[W];Se({title:"Rename Layer",initialValue:de,onSave:ce=>te({type:"SET_LAYER_NAME",payload:{index:W,name:ce}})}),z(!0)}else I==="layer-clear-clips"&&te({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:W}})}),q=window.electronAPI.onContextMenuActionFromMain(I=>{if(console.log("General context menu action received:",I),I.type==="rename-column"){const W=Nt[I.index];Se({title:"Rename Column",initialValue:W,onSave:de=>te({type:"SET_COLUMN_NAME",payload:{index:I.index,name:de}})}),z(!0)}else if(I.type==="rename-layer"){const W=ke[I.index];Se({title:"Rename Layer",initialValue:W,onSave:de=>te({type:"SET_LAYER_NAME",payload:{index:I.index,name:de}})}),z(!0)}else if(I.type==="reset-quick-assign"){const W=I.controlType==="knob"?0:!1;te({type:"UPDATE_QUICK_CONTROL",payload:{type:I.controlType,index:I.index,value:W}})}else I.type==="clear-quick-assign"&&te({type:"CLEAR_QUICK_CONTROL",payload:{type:I.controlType,index:I.index}})})),()=>{O&&O(),k&&k(),q&&q()}},[qe,Ln,ke,Nt,a,r,ye.clipClipboard]);const to=T.useRef(Ut);T.useEffect(()=>{for(let O=0;O<ke.length;O++)for(let k=0;k<Nt.length;k++){const q=Ut[O][k],I=to.current[O][k],W=qe[O][k],de=W?.workerId,ce=Sn.current.get(`${O}-${k}`),we=q!==I;(we||de&&!ce)&&W&&W.type==="ilda"&&de&&(console.log(`[App.jsx] Fetching still frame for ${O}-${k} at index ${q}. Reason: ${we?"index change":"worker ready"}`),a.postMessage({type:"get-frame",workerId:de,frameIndex:q,isStillFrame:!0,layerIndex:O,colIndex:k})),de?Sn.current.set(`${O}-${k}`,de):Sn.current.delete(`${O}-${k}`)}to.current=Ut},[Ut,qe,ke.length,Nt.length,a]),T.useEffect(()=>{r&&qe.forEach((O,k)=>{O.forEach((q,I)=>{if(q&&q.type==="generator"&&q.generatorDefinition){if(q.generatorDefinition.id==="ndi-source")return;const W=`${k}-${I}`,de={...q.generatorDefinition.defaultParams,...q.currentParams||{}},ce=JSON.stringify(de);if(ms.current.get(W)!==ce){console.log(`[App.jsx] Generator ${W} params changed, regenerating...`);const we=++Ha.current;Qn(k,I,q.generatorDefinition,q.currentParams,we),ms.current.set(W,ce)}}})})},[qe,r]),T.useEffect(()=>{if(!ye.projectLoadTimestamp||!a||!r)return;console.log("Project loaded, regenerating content...");const O=[];qe.forEach((k,q)=>{k.forEach((I,W)=>{if(I){if(I.type==="ilda"&&I.filePath&&!I.workerId)console.log(`Reparsing ILDA file for clip ${q}-${W}: ${I.filePath}`),a.postMessage({type:"load-and-parse-ilda",fileName:I.fileName,filePath:I.filePath,layerIndex:q,colIndex:W});else if(I.type==="generator"&&I.generatorDefinition){console.log(`Regenerating generator clip ${q}-${W} on project load`);const de=++Ha.current;Qn(q,W,I.generatorDefinition,I.currentParams,de)}I.audioFile&&I.audioFile.path&&window.electronAPI&&window.electronAPI.checkFileExists&&O.push(window.electronAPI.checkFileExists(I.audioFile.path).then(de=>{de||St(ce=>{const we=`audio-${q}-${W}`;return ce.some(Me=>Me.requestId===we)?ce:[...ce,{filePath:I.audioFile.path,fileName:I.audioFile.name||I.audioFile.path.split(/[/\\]/).pop(),requestId:we,type:"audio"}]})}))}})})},[ye.projectLoadTimestamp,a,r]),T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onUpdateThumbnailRenderMode){const O=window.electronAPI.onUpdateThumbnailRenderMode(k=>{console.log("App.jsx: Received thumbnail mode update:",k),te({type:"SET_THUMBNAIL_RENDER_MODE",payload:k})});return()=>O()}},[]);const Sa=T.useRef(ye);T.useEffect(()=>{Sa.current=ye},[ye]),T.useEffect(()=>{let O,k,q,I,W;return window.electronAPI&&(O=window.electronAPI.on("new-project",()=>te({type:"RESET_STATE"})),k=window.electronAPI.on("open-project",()=>{}),q=window.electronAPI.on("save-project",()=>{console.log("Saving project with state:",Sa.current),window.electronAPI.send("save-project",Sa.current)}),I=window.electronAPI.on("save-project-as",()=>{console.log("Saving project AS with state:",Sa.current),window.electronAPI.send("save-project-as",Sa.current)}),W=window.electronAPI.on("load-project-data",de=>{te({type:"LOAD_PROJECT",payload:de})})),()=>{O&&O(),k&&k(),q&&q(),I&&I(),W&&W()}},[]),T.useEffect(()=>{let O,k;return(async()=>{if(window.electronAPI&&window.electronAPI.getAllSettings){const I=await window.electronAPI.getAllSettings();I&&(I.shortcutsState&&Q(I.shortcutsState),te({type:"LOAD_SETTINGS",payload:I}))}})(),window.electronAPI&&(O=window.electronAPI.onMenuAction(I=>{if(console.log("Menu action received:",I),I==="output-settings")fe(!0);else if(I==="settings-audio-output")Z(!0);else if(I==="settings-audio-fft")be(!0);else if(I.startsWith("set-theme-")){const W=I.split("set-theme-")[1];te({type:"SET_THEME",payload:W})}else if(I==="shortcuts-window"||I.startsWith("open-")&&I.endsWith("-settings"))X(!0);else if(I==="column-duplicate")rt!==null&&(te({type:"DUPLICATE_COLUMN",payload:{index:rt}}),en("Column duplicated."));else if(I==="column-clear-clips")rt!==null&&ke.forEach((W,de)=>{te({type:"CLEAR_CLIP",payload:{layerIndex:de,colIndex:rt}})});else if(I.startsWith("toggle-")){const W=I.split("-");if(W.length===3){const de=W[1],ce=W[2]==="true";Q(we=>({...we,[de]:ce}))}}}),k=window.electronAPI.onRenderSettingsCommand(I=>{console.log("Render settings command received:",I),te({type:"SET_RENDER_SETTING",payload:{setting:I.setting,value:I.value}})})),()=>{O&&O(),k&&k()}},[]),T.useEffect(()=>{if(!a)return;const O=async k=>{if(k.data.type==="request-file-content"){const{filePath:q,requestId:I,maxBytes:W}=k.data;try{if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(q))throw new Error(`File not found: ${q}`);const de=await window.electronAPI.readFileForWorker(q,W);a.postMessage({type:"file-content-response",requestId:I,arrayBuffer:de},[de])}catch(de){console.warn(`File missing or read error: ${q}`,de.message);const ce=q.split(/[/\\]/).pop();St(we=>we.some(Me=>Me.requestId===I)?we:[...we,{filePath:q,fileName:ce,requestId:I}])}}else if(k.data.type==="parsing-status"){const{layerIndex:q,colIndex:I,status:W}=k.data;q!==void 0&&I!==void 0&&(te({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:q,colIndex:I,status:W}}),W||te({type:"SET_CLIP_PARSING_FAILED",payload:{layerIndex:q,colIndex:I,failed:!0}}))}};return a.addEventListener("message",O),()=>{a.removeEventListener("message",O)}},[a]),T.useEffect(()=>{if(!n)return;const O=async k=>{if(k.data.type==="request-file-content"){const{filePath:q,requestId:I,maxBytes:W}=k.data;try{const de=await window.electronAPI.readFileForWorker(q,W);n.postMessage({type:"file-content-response",requestId:I,arrayBuffer:de},[de])}catch(de){console.error(`Thumbnail Worker: Error reading file: ${q}`,de),n.postMessage({type:"file-content-response",requestId:I,error:de.message})}}};return n.addEventListener("message",O),()=>{n.removeEventListener("message",O)}},[n]),T.useEffect(()=>{if(!a)return;const O=[];qe.forEach((k,q)=>{k.forEach((I,W)=>{I&&I.type==="ilda"&&I.filePath&&!I.workerId&&!I.parsing&&!I.parsingFailed&&O.push({layerIndex:q,colIndex:W,fileName:I.fileName,filePath:I.filePath})})}),O.length>0&&(console.log(`Triggering re-parse for ${O.length} clips.`),te({type:"SET_BULK_PARSING_STATUS",payload:O.map(k=>({layerIndex:k.layerIndex,colIndex:k.colIndex,status:!0}))}),O.forEach(k=>{a.postMessage({type:"load-and-parse-ilda",fileName:k.fileName,filePath:k.filePath,layerIndex:k.layerIndex,colIndex:k.colIndex})}))},[qe,a]);const Zs=it.current||qe;if(ze!==null){const O=Ia[ze]||[];if(rt!==null)[...Zs[ze][rt]?.effects||[],...O];else{const k=_t[ze];k!==null&&[...Zs[ze][k]?.effects||[],...O]}}const Hi=T.useCallback((O,k,q,I,W)=>{if(it.current&&it.current[O]&&it.current[O][k]){const de=it.current[O][k];de&&de.effects&&de.effects[q]&&(de.effects[q].params[I]=W,Dn.current=!0)}Dt(`effect-${O}-${k}-${q}-${I}`,{type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:O,colIndex:k,effectIndex:q,paramName:I,newValue:W}})},[Dt]);T.useEffect(()=>{if(!r)return;const O=k=>{if(!k.data.browserFile){if(k.data.layerIndex!==void 0&&k.data.colIndex!==void 0){const q=`${k.data.layerIndex}-${k.data.colIndex}`;if(Xn.current.set(q,!1),or.current.has(q)){const{message:I,transferables:W}=or.current.get(q);or.current.delete(q),Xn.current.set(q,!0),r.postMessage(I,W)}}if(k.data.success){const{layerIndex:q,colIndex:I,frames:W,generatorDefinition:de,currentParams:ce,isLive:we,isAutoUpdate:Me,seq:Ye}=k.data;if(q===void 0||I===void 0)return;if(Ye!==void 0){if(Ye<ys.current)return;ys.current=Ye}const he=`generator-${q}-${I}`;if(R.current[he]=W[0],!we&&!Me&&Ye===Ha.current){const Pe=zt.current[q][I]||{},Ae={...Pe,type:"generator",generatorDefinition:de,frames:W,stillFrame:W[0],currentParams:ce,playbackSettings:Pe.playbackSettings||{mode:"fps",duration:W.length/60,beats:8,speedMultiplier:1}};te({type:"SET_CLIP_CONTENT",payload:{layerIndex:q,colIndex:I,content:Ae}});const Re=lr.current[q][I],Oe=`Clip ${q+1}-${I+1}`;Re===Oe&&te({type:"SET_CLIP_NAME",payload:{layerIndex:q,colIndex:I,name:de.name}})}else window.electronAPI&&window.electronAPI.ndiSignalReady&&window.electronAPI.ndiSignalReady()}else en(`Error generating frames: ${k.data.error}`)}};return r.addEventListener("message",O),()=>{r.removeEventListener("message",O)}},[r]);const Or=T.useCallback((O,k,q)=>{if(r){const I=`${O}-${k}`,W={...q.defaultParams};ms.current.set(I,JSON.stringify(W));const de=++Ha.current;Qn(O,k,q,q.defaultParams,de)}},[r]),Qn=async(O,k,q,I,W,de=!1)=>{const ce={...q.defaultParams,...I},we=`${O}-${k}`;let Me=null;if(["text","ndi-source","spout-receiver"].includes(q.id)){const Pe="src/fonts/Geometr415 Blk BT Black.ttf";let Ae=ce.fontUrl||Pe;if(["https://raw.githubusercontent.com/google/fonts/main/ofl/roboto/Roboto-Regular.ttf","https://raw.githubusercontent.com/googlefonts/roboto-2/main/src/hinted/Roboto-Regular.ttf"].includes(Ae)&&(Ae=Pe),gs.current.has(Ae))Me=gs.current.get(Ae);else try{if(Ae.startsWith("http"))if(window.electronAPI&&window.electronAPI.fetchUrlAsArrayBuffer)Me=await window.electronAPI.fetchUrlAsArrayBuffer(Ae);else throw new Error("URL fetching API is not available.");else if(window.electronAPI&&window.electronAPI.readFileForWorker)Me=await window.electronAPI.readFileForWorker(Ae);else throw new Error("File reading API is not available.");Me&&gs.current.set(Ae,Me)}catch(Oe){console.error(`Failed to load font for text generator at ${O}-${k}:`,Oe),en(`Font error: ${Oe.message}`);return}}const Ye={type:"generate",layerIndex:O,colIndex:k,generator:q,params:ce,fontBuffer:Me,seq:W,isAutoUpdate:de},he=[];Xn.current.get(we)?(console.log(`[App.jsx] Generator ${we} busy, queuing seq ${W}`),or.current.set(we,{message:Ye,transferables:he})):(Xn.current.set(we,!0),i.current&&i.current.postMessage(Ye,he))},Ea=T.useCallback(O=>{y(O),te({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:O}})},[y]),cr=T.useCallback(()=>{A(),te({type:"CLEAR_ALL_ACTIVE_CLIPS"})},[A]),Lr=T.useCallback(()=>{b(),ke.forEach((O,k)=>{const q=_t[k];if(q!==null){const I=qe[k][q];I&&I.audioFile&&!D(k)&&v(k,I.audioFile.path,I.audioVolume??1,!0)}}),te({type:"SET_IS_PLAYING",payload:!0}),te({type:"SET_IS_STOPPED",payload:!1})},[b,ke,_t,qe,D,v]),wa=T.useCallback(()=>{S(),te({type:"SET_IS_PLAYING",payload:!1}),te({type:"SET_IS_STOPPED",payload:!1})},[S]),kn=T.useCallback(()=>{E(),S(),te({type:"SET_IS_PLAYING",payload:!1}),te({type:"SET_IS_STOPPED",payload:!0}),B.current={}},[E,S]),bs=T.useCallback(()=>{const O=!It;te({type:"SET_WORLD_OUTPUT_ACTIVE",payload:O}),window.electronAPI&&(O?ye.dacs.forEach(k=>{window.electronAPI.startDacOutput(k.ip,k.type)}):ye.dacs.forEach(k=>{window.electronAPI.stopDacOutput(k.ip,k.type)}))},[It,ye.dacs]),Aa=T.useCallback((O,k)=>{te({type:"SET_SELECTED_CLIP",payload:{layerIndex:O,colIndex:k}});const q=qe[O][k];if(q&&q.type==="ilda")te({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:q.workerId,totalFrames:q.totalFrames,generatorId:null,generatorParams:{}}});else if(q&&q.type==="generator"){const I=`generator-${O}-${k}`;te({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:I,generatorId:q.generatorDefinition.id,generatorParams:q.currentParams,totalFrames:q.frames.length}})}else te({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:null,totalFrames:0,generatorId:null,generatorParams:{}}})},[qe]),Ya=T.useCallback((O,k,q)=>{q?Un.current={layerIndex:O,colIndex:k}:Un.current&&Un.current.layerIndex===O&&Un.current.colIndex===k&&(Un.current=null)},[]),ur=T.useCallback((O,k,q=!0)=>{const I=qe[O][k];if(!I){q&&(Aa(O,k),Ea(O));return}const W=I.triggerStyle||"normal",de=_t[O];if(W==="normal"){if(!q)return}else if(W==="toggle"){if(!q)return;if(de===k){Ea(O);return}}else if(W==="flash"&&!q){de===k&&Ea(O);return}if(I&&I.type==="generator"&&I.frames&&I.frames.length>0){const ce=`generator-${O}-${k}`;R.current[ce]=I.frames[0],j.current[ce]=performance.now(),B.current[ce]=0}else I&&I.type==="ilda"&&I.workerId&&(j.current[I.workerId]=performance.now(),B.current[I.workerId]=0);if(I&&I.audioFile?v(O,I.audioFile.path,I.audioVolume??1,rr.current).catch(ce=>{console.warn(`Failed to play audio for clip ${O}-${k}:`,ce),St(we=>{const Me=`audio-${O}-${k}`;return we.some(Ye=>Ye.requestId===Me)?we:[...we,{filePath:I.audioFile.path,fileName:I.audioFile.name||I.audioFile.path.split(/[/\\]/).pop(),requestId:Me,type:"audio"}]})}):y(O),M.current[O]=performance.now(),te({type:"SET_ACTIVE_CLIP",payload:{layerIndex:O,colIndex:k}}),I){if(I.type==="ilda"&&I.workerId){const ce=B.current[I.workerId]||0;te({type:"UPDATE_THUMBNAIL",payload:{layerIndex:O,colIndex:k,frameIndex:ce}})}else if(I.type==="generator"&&I.frames){const ce=B.current[`generator-${O}-${k}`]||0,we=I.frames[ce%I.frames.length];we&&te({type:"SET_CLIP_CONTENT",payload:{layerIndex:O,colIndex:k,content:{stillFrame:we}}})}}},[qe,_t,Ea,v,Pt,y,Aa]),$s=T.useCallback((O,k,q)=>{if(it.current&&it.current[O]&&it.current[O][k]){const I=it.current[O][k];if(I){const W={...q,instanceId:Il(),params:{...q.defaultParams}};I.effects=[...I.effects||[],W],Dn.current=!0}}te({type:"ADD_CLIP_EFFECT",payload:{layerIndex:O,colIndex:k,effect:q}})},[]),no=T.useCallback((O,k)=>{const q=Li.find(I=>(I.id||I.name)===k);q&&te({type:"ADD_LAYER_EFFECT",payload:{layerIndex:O,effect:q}})},[]),Ws=T.useCallback((O,k,q)=>{Dn.current=!0,te({type:"SET_CLIP_DAC",payload:{layerIndex:O,colIndex:k,dac:q}})},[]),Ks=T.useCallback((O,k)=>{te({type:"SET_LAYER_DAC",payload:{layerIndex:O,dac:k}})},[]),ao=O=>{window.electronAPI&&window.electronAPI.showLayerFullContextMenu&&window.electronAPI.showLayerFullContextMenu(O)},En=O=>{window.electronAPI&&window.electronAPI.showColumnContextMenu&&window.electronAPI.showColumnContextMenu(O)},Ta=O=>{ke.forEach((k,q)=>{const I=qe[q][O];I&&(I.type==="ilda"||I.type==="generator")?ur(q,O):Ea(q)})},Js=T.useCallback(O=>{te({type:"SET_SELECTED_DAC",payload:O})},[]),xs=T.useCallback(O=>{te({type:"SET_DACS",payload:O})},[]),Cc=(O,k)=>{if(ze!==null&&rt!==null){let q=null,I={};if(it.current&&it.current[ze]&&it.current[ze][rt]){const we=it.current[ze][rt];we&&we.currentParams&&(we.currentParams[O]=k,Dn.current=!0,q=we,I=we.currentParams)}if(q||(q=qe[ze][rt],q&&q.currentParams&&(I={...q.currentParams,[O]:k})),!q||!q.generatorDefinition)return;Dt(`generator-${ze}-${rt}-${O}`,{type:"UPDATE_GENERATOR_PARAM",payload:{layerIndex:ze,colIndex:rt,paramName:O,newValue:k}});const W=`${ze}-${rt}`,de={...q.generatorDefinition.defaultParams,...I};ms.current.set(W,JSON.stringify(de));const ce=++Ha.current;Qn(ze,rt,q.generatorDefinition,I,ce,!1)}},mn=ze!==null&&rt!==null?qe[ze][rt]:null;T.useEffect(()=>{if(!window.electronAPI||!r)return;(async()=>{let k=null;ke.forEach((I,W)=>{const de=_t[W];if(de!==null){const ce=qe[W][de];ce&&ce.type==="generator"&&ce.generatorDefinition?.id==="ndi-source"&&(k=ce)}}),!k&&mn?.type==="generator"&&mn?.generatorDefinition?.id==="ndi-source"&&(k=mn);const q=k?.currentParams?.sourceName;q&&q!=="No Source"?q!==vs.current&&(console.log(`[NDI] Switching to source: ${q}`),await window.electronAPI.ndiCreateReceiver(q),vs.current=q):vs.current&&(console.log("[NDI] Destroying receiver"),await window.electronAPI.ndiDestroyReceiver(),vs.current=null)})()},[_t,qe,mn,ke]),T.useEffect(()=>{const O=[...qn,mn].find(k=>k?.type==="generator"&&k?.generatorDefinition?.id==="ndi-source");if(O&&window.electronAPI?.ndiUpdateSettings){const{captureWidth:k,captureHeight:q}=O.currentParams||{};k&&q&&window.electronAPI.ndiUpdateSettings({width:k,height:q})}},[qn,mn]),T.useEffect(()=>{if(!window.electronAPI||!r)return;const O=window.electronAPI.onNdiFrame(k=>{Jt.current.forEach((q,I)=>{if(q===null)return;const W=zt.current[I][q];W&&W.type==="generator"&&W.generatorDefinition?.id==="ndi-source"&&r.postMessage({type:"generate",layerIndex:I,colIndex:q,generator:W.generatorDefinition,params:{...W.generatorDefinition.defaultParams,...W.currentParams},ndiFrame:k,isLive:!0})}),mn?.type==="generator"&&mn?.generatorDefinition?.id==="ndi-source"&&r.postMessage({type:"generate",layerIndex:ze,colIndex:rt,generator:mn.generatorDefinition,params:{...mn.generatorDefinition.defaultParams,...mn.currentParams},ndiFrame:k,isLive:!0})});return()=>O()},[_t,qe,mn,ze,rt,ke,r]);const ei=T.useCallback((O,k,q)=>{const I=O==="knob"?"knobs":"buttons",W=ye.quickAssigns[I][k];if(W.link){const{layerIndex:de,colIndex:ce,effectIndex:we,targetType:Me}=W.link,Ye=W.link.paramName||W.link.paramId;let he=q;if(O==="knob"&&W.min!==void 0&&W.max!==void 0&&(he=W.min+q*(W.max-W.min),W.step&&(he=Math.round(he/W.step)*W.step),he=parseFloat(he.toFixed(5))),Me==="global")Ye==="master_intensity"?la.current=he:Ye==="master_speed"&&(ir.current=he);else if(Me==="layerEffect")xa.current[de]&&xa.current[de][we]&&(xa.current[de][we].params[Ye]=he);else if((Me==="effect"||Me==="generator")&&it.current&&it.current[de]&&it.current[de][ce]){const Pe=it.current[de][ce];Me==="effect"&&Pe.effects&&Pe.effects[we]?Pe.effects[we].params[Ye]=he:Me==="generator"&&Pe.currentParams&&(Pe.currentParams[Ye]=he),Dn.current=!0}}Dt(`quick-${O}-${k}`,{type:"UPDATE_QUICK_CONTROL",payload:{type:O,index:k,value:q}})},[ye.quickAssigns,Dt]),Ur=T.useCallback(O=>{const k=ye.quickAssigns.buttons[O],q=k.link,I=!k.value;if(q){const{layerIndex:W,colIndex:de,effectIndex:ce,targetType:we}=q,Me=q.paramName||q.paramId;if(we==="transport"){Me==="play"?Lr():Me==="pause"?wa():Me==="stop"&&kn();return}if(we==="global"){if(Me==="blackout")Vs.current=I;else if(Me==="laser_output"){bs();return}else if(Me==="clear"){cr();return}}else if(we==="layer")Me==="blackout"?Ga.current[W]=I:Me==="solo"?(ds.current.fill(!1),ds.current[W]=I):Me==="autopilot"&&(qs.current[W]=I?"forward":"off");else if(we==="layerEffect")xa.current[W]&&xa.current[W][ce]&&(xa.current[W][ce].params[Me]=I);else if((we==="effect"||we==="generator")&&it.current&&it.current[W]&&it.current[W][de]){const Ye=it.current[W][de];we==="effect"&&Ye.effects&&Ye.effects[ce]?Ye.effects[ce].params[Me]=I:we==="generator"&&Ye.currentParams&&(Ye.currentParams[Me]=I),Dn.current=!0}}te({type:"TOGGLE_QUICK_BUTTON",payload:{index:O}})},[ye.quickAssigns,Lr,wa,kn,bs,cr]),Ir=T.useCallback((O,k,q=127,I="noteon")=>{if(k===0&&!O.endsWith("_intensity")&&O!=="master_intensity"&&O!=="master_speed"&&!O.startsWith("clip_")&&O!=="bpm_value"&&O!=="bpm_fine_up"&&O!=="bpm_fine_down"&&!O.startsWith("quick_")&&!O.startsWith("dimmer_"))return;const W=k/q;switch(O){case"transport_play":k>0&&Lr();break;case"transport_pause":k>0&&wa();break;case"transport_stop":k>0&&kn();break;case"comp_blackout":k>0&&te({type:"TOGGLE_GLOBAL_BLACKOUT"});break;case"comp_clear":k>0&&cr();break;case"master_intensity":la.current=W,Dt("master_intensity",{type:"SET_MASTER_INTENSITY",payload:W});break;case"master_speed":const de=Math.max(1,Math.round(W*120));Dt("master_speed",{type:"SET_RENDER_SETTING",payload:{setting:"playbackFps",value:de}});break;case"laser_output":k>0&&te({type:"TOGGLE_WORLD_OUTPUT_ACTIVE"});break;case"bpm_value":if(I==="controlchange"){let ce=0;k<=10?ce=k:k>=118&&(ce=k-128),ce!==0&&te({type:"SET_BPM",payload:Math.max(1,Math.min(999,(ye.bpm||120)+ce))})}break;case"bpm_fine_up":k>0&&te({type:"SET_BPM",payload:Math.min(999,(ye.bpm||120)+.1)});break;case"bpm_fine_down":k>0&&te({type:"SET_BPM",payload:Math.max(1,(ye.bpm||120)-.1)});break;case"bpm_tap":break;default:if(O.startsWith("layer_")){const ce=O.split("_"),we=parseInt(ce[1]),Me=ce[2];Me==="blackout"&&k>0?te({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:we}}):Me==="solo"&&k>0?te({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:we}}):Me==="intensity"?(Ht.current[we]=W,Dt(`layer_${we}_intensity`,{type:"SET_LAYER_INTENSITY",payload:{layerIndex:we,intensity:W}})):Me==="clear"&&k>0&&Ea(we)}else if(O.startsWith("clip_")){const ce=O.split("_"),we=parseInt(ce[1]),Me=parseInt(ce[2]);ce[3]==="preview"?k>0&&Aa(we,Me):ur(we,Me,k>0)}else if(O.startsWith("column_")){const ce=O.split("_"),we=parseInt(ce[1]);k>0&&Ta(we)}else if(O.startsWith("quick_knob_")){const ce=parseInt(O.split("_")[2]);ei("knob",ce,W)}else if(O.startsWith("quick_btn_")){const ce=parseInt(O.split("_")[2]);k>0&&Ur(ce)}else if(O.startsWith("dimmer_")){const ce=O.replace("dimmer_","").replace(/_/g,"."),we=Rn[ce]||{};te({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:ce,settings:{...we,dimmer:W}}})}else{const ce=O.split("_");if(ce.length>=2&&ze!==null&&rt!==null){const we=qe[ze][rt];if(we&&we.effects){const Me=ce[0],Ye=ce.slice(1).join("_"),he=we.effects.findIndex(Pe=>Pe.id===Me);if(he!==-1){const Ae=Li.find(Re=>Re.id===Me)?.paramControls.find(Re=>Re.id===Ye);if(Ae){let Re=W;Ae.type==="range"||Ae.type==="number"?Re=Ae.min+(Ae.max-Ae.min)*W:Ae.type==="checkbox"&&(Re=W>.5),te({type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:ze,colIndex:rt,effectIndex:he,paramName:Ye,newValue:Re}})}}}}}}},[Lr,wa,kn,cr,Ea,Qs,ye.bpm,Aa,ur,Ta,qe,ze,rt,Rn]),ro=T.useCallback(O=>{if(O==="world"){const q=!(ye.worldShowBeamEffect??!0);if(te({type:"SET_RENDER_SETTING",payload:{setting:"worldShowBeamEffect",value:q}}),window.electronAPI&&window.electronAPI.setRenderSettings){const I={...ye.renderSettings,showBeamEffect:ye.showBeamEffect,beamRenderMode:ye.beamRenderMode,previewScanRate:ye.previewScanRate,beamAlpha:ye.beamAlpha,fadeAlpha:ye.fadeAlpha,worldShowBeamEffect:q,worldBeamRenderMode:ye.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(I)}}else{const k=!ya;if(te({type:"SET_RENDER_SETTING",payload:{setting:"showBeamEffect",value:k}}),window.electronAPI&&window.electronAPI.setRenderSettings){const q={showBeamEffect:k,beamRenderMode:Yn,previewScanRate:ba,beamAlpha:zn,fadeAlpha:ar,worldShowBeamEffect:ye.worldShowBeamEffect??!0,worldBeamRenderMode:ye.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(q)}}},[ya,Yn,ba,zn,ar,ye.worldShowBeamEffect,ye.worldBeamRenderMode]),Mc=T.useCallback(O=>{if(O==="world"){const k=ye.worldBeamRenderMode??"both";let q="points";if(k==="both"?q="points":k==="points"?q="lines":k==="lines"&&(q="both"),te({type:"SET_RENDER_SETTING",payload:{setting:"worldBeamRenderMode",value:q}}),window.electronAPI&&window.electronAPI.setRenderSettings){const I={showBeamEffect:ya,beamRenderMode:Yn,previewScanRate:ba,beamAlpha:zn,fadeAlpha:ar,worldShowBeamEffect:ye.worldShowBeamEffect??!0,worldBeamRenderMode:q};window.electronAPI.setRenderSettings(I)}}else{let k="points";if(Yn==="both"?k="points":Yn==="points"?k="lines":Yn==="lines"&&(k="both"),te({type:"SET_RENDER_SETTING",payload:{setting:"beamRenderMode",value:k}}),window.electronAPI&&window.electronAPI.setRenderSettings){const q={showBeamEffect:ya,beamRenderMode:k,previewScanRate:ba,beamAlpha:zn,fadeAlpha:ar,worldShowBeamEffect:ye.worldShowBeamEffect??!0,worldBeamRenderMode:ye.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(q)}}},[ya,Yn,ba,zn,ar,ye.worldShowBeamEffect,ye.worldBeamRenderMode]),Nc=async O=>{if(!(!window.electronAPI||!window.electronAPI.showOpenDialog))try{const k=await window.electronAPI.showOpenDialog({title:`Locate missing file: ${O.fileName}`,defaultPath:O.filePath,filters:[{name:"ILDA Files",extensions:["ild"]},{name:"All Files",extensions:["*"]}],properties:["openFile"]});if(k){const q=k,I=window.electronAPI.pathSeparator||(q.includes("/")?"/":"\\");if(te({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:O.filePath,newPath:q}}),O.type!=="audio"){const he=await window.electronAPI.readFileForWorker(q);a&&a.postMessage({type:"file-content-response",requestId:O.requestId,arrayBuffer:he},[he])}St(he=>he.filter(Pe=>Pe.requestId!==O.requestId));const W=he=>he.substring(0,he.lastIndexOf(I)),de=he=>he.substring(he.lastIndexOf(I)+1),ce=W(O.filePath),we=W(q);console.log(`[Relocate] Scanning for other files moving from [${ce}] to [${we}]`);const Me=Sa.current.clipContents.flat().filter(he=>he),Ye=new Set([O.filePath]);for(const he of Me){if(he.type==="ilda"&&he.filePath&&!Ye.has(he.filePath)&&W(he.filePath)===ce){const Pe=de(he.filePath),Ae=`${we}${I}${Pe}`;he.filePath!==Ae&&await window.electronAPI.checkFileExists(Ae)&&(console.log(`[Relocate] Auto-resolving ILDA: ${Pe}`),te({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:he.filePath,newPath:Ae}}),Ye.add(he.filePath),a&&St(Oe=>Oe.filter(Te=>Te.filePath!==he.filePath)))}if(he.audioFile&&he.audioFile.path&&!Ye.has(he.audioFile.path)&&W(he.audioFile.path)===ce){const Pe=de(he.audioFile.path),Ae=`${we}${I}${Pe}`;he.audioFile.path!==Ae&&await window.electronAPI.checkFileExists(Ae)&&(console.log(`[Relocate] Auto-resolving Audio: ${Pe}`),te({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:he.audioFile.path,newPath:Ae}}),Ye.add(he.audioFile.path),St(Oe=>Oe.filter(Te=>Te.filePath!==he.audioFile.path)))}}}}catch(k){console.error("Relocation failed:",k),en(`Relocation failed: ${k.message}`)}},Rc=T.useCallback((O,k)=>{console.log(`Thumbnail load error for ${O}-${k}, requesting regeneration...`);const q=zt.current[O][k];if(q)if(q.type==="ilda"&&q.workerId&&a){const I=Ut[O][k]||0;a.postMessage({type:"get-frame",workerId:q.workerId,frameIndex:I,isStillFrame:!0,layerIndex:O,colIndex:k})}else q.type==="generator"&&q.stillFrame&&Lf(q.stillFrame,q.effects,O,k,ja).then(I=>{I&&te({type:"SET_CLIP_CONTENT",payload:{layerIndex:O,colIndex:k,content:{thumbnailPath:I,thumbnailVersion:Date.now()}}})})},[zt,Ut,a,ja]),Yi=T.useCallback((O,k)=>{const q=zt.current[O][k];q&&q.audioFile&&St(I=>{const W=`audio-${O}-${k}`;return I.some(de=>de.requestId===W)?I:[...I,{filePath:q.audioFile.path,fileName:q.audioFile.name||q.audioFile.path.split(/[/\\]/).pop(),requestId:W,type:"audio"}]})},[zt]);return g.jsx(Ny,{onMidiCommand:Ir,children:g.jsx(Ry,{onArtnetCommand:(O,k)=>Ir(O,k,255),children:g.jsxs(Dy,{onCommand:Ir,enabled:Y.keyboard,children:[g.jsx(dE,{isPlaying:Pt,globalBlackout:Nr,layerBlackouts:Kt,layerSolos:Mr,isWorldOutputActive:It,clipContents:qe,activeClipIndexes:_t,theme:Ys,bpm:ye.bpm,quickAssigns:ye.quickAssigns}),g.jsx(F1,{}),g.jsx("div",{className:"app",children:g.jsxs(_1,{children:[g.jsx(g1,{message:Ba.message,visible:Ba.visible}),g.jsx(N1,{show:ne,onClose:()=>fe(!1),dacs:Fa,dacSettings:Rn,onUpdateDacSettings:zi}),g.jsx(R1,{show:U||ue,onClose:()=>{Z(!1),be(!1)},initialTab:ue?"fft":"output"}),g.jsx(C1,{show:L,title:oe.title,initialValue:oe.initialValue,onSave:oe.onSave,onClose:()=>X(!1)||z(!1)}),g.jsx(D1,{missingFiles:xn,onRelocate:Nc,onClose:()=>St([])}),g.jsxs("div",{className:"main-content",children:[g.jsxs("div",{className:"top-bar-left-area",children:[g.jsx(ky,{masterIntensity:ye.masterIntensity,onMasterIntensityChange:O=>te({type:"SET_MASTER_INTENSITY",payload:O}),onClearAllActive:cr,isGlobalBlackout:Nr,onToggleGlobalBlackout:()=>te({type:"TOGGLE_GLOBAL_BLACKOUT"})}),g.jsx(uE,{isWorldOutputActive:It,onToggleWorldOutput:bs})]}),g.jsxs("div",{className:"layer-controls-container",children:[ke.map((O,k)=>{const q=qn.find(W=>{const de=_t[k];if(de===null)return!1;const ce=qe[k][de];return ce?ce.type==="ilda"?W.workerId===ce.workerId:ce.type==="generator"?W.workerId===`generator-${k}-${de}`:!1:!1})||null,I=q?R.current[q.workerId]:null;return g.jsx(Jy,{layerName:O,index:k,onDropEffect:W=>no(k,W),onDropDac:(W,de)=>Ks(W,de),layerEffects:Ia[k],activeClipData:q,liveFrame:I,thumbnailRenderMode:Wl,intensity:ye.layerIntensities[k],onIntensityChange:W=>te({type:"SET_LAYER_INTENSITY",payload:{layerIndex:k,intensity:W}}),onDeactivateLayerClips:()=>Ea(k),onShowLayerFullContextMenu:()=>ao(k),isBlackout:Kt[k],isSolo:Mr[k],onToggleBlackout:()=>te({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:k}}),onToggleSolo:()=>te({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:k}}),onLayerSelect:W=>te({type:"SET_SELECTED_CLIP",payload:{layerIndex:W,colIndex:null}})},k)}),"          "]}),g.jsx("div",{className:"clip-deck-container",children:g.jsxs("div",{className:"clip-deck",children:[g.jsx("div",{className:"column-headers-container",children:Nt.map((O,k)=>g.jsx(Oy,{name:O,index:k,onTrigger:()=>Ta(k),onShowColumnHeaderContextMenu:()=>En(k)},k))}),ke.map((O,k)=>g.jsx("div",{className:"layer-row",children:Nt.map((q,I)=>{const W=qe?.[k]?.[I];let de=null;W&&W.type==="ilda"?de=W.workerId:W&&W.type==="generator"&&(de=`generator-${k}-${I}`);const ce=de?R.current[de]:null,we=W?.stillFrame||(W?.type==="generator"?W.frames?.[0]:null);return g.jsx(t1,{layerIndex:k,colIndex:I,clipName:Ln?.[k]?.[I]||`Clip ${k+1}-${I+1}`,clipContent:W,thumbnailFrameIndex:Ut[k][I],thumbnailRenderMode:Wl,liveFrame:ce,stillFrame:we,onActivateClick:Me=>ur(k,I,Me),isActive:_t[k]===I,onUnsupportedFile:en,onDropEffect:Me=>$s(k,I,Me),onDropGenerator:Or,onDropDac:(Me,Ye,he)=>{Ws(Me,Ye,he)},onLabelClick:()=>Aa(k,I),isSelected:ze===k&&rt===I,ildaParserWorker:a,onClipHover:Ya,onThumbnailError:Rc},I)})},k))]})}),g.jsx(hE,{clipContents:qe,activeClipIndexes:_t,layerEffects:Ia,bpm:ye.bpm,playbackFps:Hn,selectedLayerIndex:ze,selectedColIndex:rt,liveFramesRef:R,progressRef:_,selectedDac:Nn,liveDacOutputSettingsRef:_n,dacOutputSettings:Rn,getAudioInfo:D,fftLevels:o,getFftLevels:u,effectStatesRef:N,clipActivationTimesRef:M,showBeamEffect:ya,beamAlpha:zn,fadeAlpha:ar,previewScanRate:ba,beamRenderMode:Yn,worldShowBeamEffect:Hs,worldBeamRenderMode:Fi,masterIntensity:Gs,layerIntensities:cn,globalBlackout:Nr,layerSolos:Mr,layerBlackouts:Kt,handleToggleBeamEffect:ro,handleCycleDisplayMode:Mc,previewFrameCountRef:on,totalPointsSentRef:jt,activeChannelsCountRef:Mn,lastStatUpdateTimeRef:Ne,liveClipContentsRef:it,optimizationEnabled:ja}),g.jsxs("div",{className:"middle-bar",children:[g.jsx("div",{className:"middle-bar-left-area",children:g.jsx(S1,{bpm:ye.bpm,onBpmChange:O=>te({type:"SET_BPM",payload:O})})}),g.jsxs("div",{className:"middle-bar-mid-area",children:[g.jsx(E1,{onPlay:Lr,onPause:wa,onStop:kn,isPlaying:Pt,isStopped:ye.isStopped}),g.jsx(cE,{playbackFps:Hn,onSpeedChange:Qs})]}),g.jsx("div",{className:"middle-bar-right-area"})]}),g.jsxs("div",{className:"bottom-panel",children:[g.jsxs("div",{className:"bottom-panel-tabs-container-1",children:[g.jsxs("div",{className:"bottom-panel-tabs-1",children:[g.jsx("button",{className:`tab-button-1 ${Ee==="files"?"active":""}`,onClick:()=>Xe("files"),children:"Files"}),g.jsx("button",{className:`tab-button-1 ${Ee==="generators"?"active":""}`,onClick:()=>Xe("generators"),children:"Generators"}),g.jsx("button",{className:`tab-button-1 ${Ee==="effects"?"active":""}`,onClick:()=>Xe("effects"),children:"Effects"})]}),g.jsxs("div",{className:"bottom-panel-tab-content-1",children:[Ee==="files"&&g.jsx(a1,{viewMode:ye.fileBrowserViewMode,onViewModeChange:O=>te({type:"SET_FILE_BROWSER_VIEW_MODE",payload:O}),path:ye.fileBrowserPath,onPathChange:O=>te({type:"SET_FILE_BROWSER_PATH",payload:O}),onDropIld:(O,k,q)=>a.postMessage({type:"parse-ilda",file:q,layerIndex:O,colIndex:k})}),Ee==="generators"&&g.jsx(r1,{}),Ee==="effects"&&g.jsx(s1,{})]})]}),g.jsxs("div",{className:"bottom-panel-tabs-container-2",children:[g.jsxs("div",{className:"bottom-panel-tabs-2",children:[g.jsx("button",{className:`tab-button-2 ${Ge==="clip"?"active":""}`,onClick:()=>ct("clip"),children:"Clip-Settings"}),g.jsx("button",{className:`tab-button-2 ${Ge==="layer"?"active":""}`,onClick:()=>ct("layer"),children:"Layer-Settings"})]}),g.jsxs("div",{className:"bottom-panel-tab-content-2",children:[Ge==="clip"&&g.jsx(h1,{selectedLayerIndex:ze,selectedColIndex:rt,clip:mn,audioInfo:D(ze),bpm:ye.bpm,getFftLevels:u,onAssignAudio:async()=>{const O=await window.electronAPI.showAudioFileDialog();if(O){const k=O.split(/[\\/]/).pop();te({type:"SET_CLIP_AUDIO",payload:{layerIndex:ze,colIndex:rt,audioFile:{path:O,name:k}}})}},onRemoveAudio:()=>{y(ze),te({type:"REMOVE_CLIP_AUDIO",payload:{layerIndex:ze,colIndex:rt}})},onUpdateAudioVolume:(O,k,q)=>{te({type:"SET_CLIP_AUDIO_VOLUME",payload:{layerIndex:O,colIndex:k,volume:q}}),F(O,q)},onUpdatePlaybackSettings:(O,k,q)=>te({type:"UPDATE_CLIP_PLAYBACK_SETTINGS",payload:{layerIndex:O,colIndex:k,settings:q}}),onSetParamSync:(O,k)=>te({type:"SET_CLIP_PARAM_SYNC",payload:{layerIndex:ze,colIndex:rt,paramId:O,syncMode:k}}),onToggleDacMirror:(O,k,q,I)=>te({type:"TOGGLE_CLIP_DAC_MIRROR",payload:{layerIndex:O,colIndex:k,dacIndex:q,axis:I}}),onRemoveDac:O=>te({type:"REMOVE_CLIP_DAC",payload:{layerIndex:ze,colIndex:rt,dacIndex:O}}),onRemoveEffect:(O,k,q)=>te({type:"REMOVE_CLIP_EFFECT",payload:{layerIndex:O,colIndex:k,effectIndex:q}}),onReorderEffects:(O,k,q,I)=>te({type:"REORDER_CLIP_EFFECTS",payload:{layerIndex:O,colIndex:k,oldIndex:q,newIndex:I}}),onAddEffect:O=>te({type:"ADD_CLIP_EFFECT",payload:{layerIndex:ze,colIndex:rt,effect:O}}),onUpdateClipUiState:(O,k,q)=>te({type:"UPDATE_CLIP_UI_STATE",payload:{layerIndex:O,colIndex:k,uiState:q}}),onParameterChange:Hi,onGeneratorParameterChange:Cc,progressRef:_,onAudioError:Yi}),Ge==="layer"&&g.jsx(m1,{selectedLayerIndex:ze,autopilotMode:ze!==null?ye.layerAutopilots[ze]:"off",onAutopilotChange:O=>te({type:"SET_LAYER_AUTOPILOT",payload:{layerIndex:ze,mode:O}}),layerEffects:ze!==null?Ia[ze]:[],assignedDacs:ze!==null&&ye.layerAssignedDacs?ye.layerAssignedDacs[ze]:[],onToggleDacMirror:(O,k,q)=>te({type:"TOGGLE_LAYER_DAC_MIRROR",payload:{layerIndex:O,dacIndex:k,axis:q}}),onRemoveDac:(O,k)=>te({type:"REMOVE_LAYER_DAC",payload:{layerIndex:O,dacIndex:k}}),onAddEffect:O=>ze!==null&&te({type:"ADD_LAYER_EFFECT",payload:{layerIndex:ze,effect:O}}),onRemoveEffect:O=>ze!==null&&te({type:"REMOVE_LAYER_EFFECT",payload:{layerIndex:ze,effectIndex:O}}),onParamChange:(O,k,q)=>ze!==null&&te({type:"UPDATE_LAYER_EFFECT_PARAMETER",payload:{layerIndex:ze,effectIndex:O,paramName:k,newValue:q}}),uiState:ze!==null?ye.layerUiStates[ze]:{},onUpdateUiState:O=>te({type:"UPDATE_LAYER_UI_STATE",payload:{layerIndex:ze,uiState:O}})})]})]}),g.jsx(i1,{dacs:Fa,onDacSelected:Js,onDacsDiscovered:xs,dacSettings:Rn,onUpdateDacSettings:zi}),g.jsx(T1,{enabledShortcuts:Y,onOpenOutputSettings:()=>fe(!0),onOpenShortcutsSettings:()=>X(!0),quickAssigns:ye.quickAssigns,renderSettings:{showBeamEffect:ya,beamAlpha:zn,fadeAlpha:ar,previewScanRate:ba,beamRenderMode:Yn,worldShowBeamEffect:Hs,worldBeamRenderMode:Fi,settingsPanelCollapsed:ye.settingsPanelCollapsed,optimizationEnabled:ye.optimizationEnabled},onSetRenderSetting:(O,k)=>{te(O==="optimizationEnabled"?{type:"SET_OPTIMIZATION_ENABLED",payload:k}:{type:"SET_RENDER_SETTING",payload:{setting:O,value:k}})},onUpdateKnob:(O,k)=>{ei("knob",O,k)},onToggleButton:O=>{Ur(O)},onAssign:(O,k,q)=>te({type:"ASSIGN_QUICK_CONTROL",payload:{type:O,index:k,link:q}})})]}),g.jsx("div",{className:"SystemMonitor",children:g.jsx(pE,{playbackFps:Hn,previewScanRate:ba,previewFrameCountRef:on,totalPointsSentRef:jt,activeChannelsCountRef:Mn,lastStatUpdateTimeRef:Ne})})]})]})})]})})})}vy.createRoot(document.getElementById("root")).render(g.jsx(v1,{children:g.jsx(O1,{children:g.jsxs(L1,{children:[" ",g.jsx(n1,{children:g.jsx(d1,{children:g.jsx(mE,{})})})]})})}));
