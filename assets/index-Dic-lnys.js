(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=r(l);fetch(l.href,u)}})();function wf(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Kc={exports:{}},dl={};var Xh;function pv(){if(Xh)return dl;Xh=1;var a=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(i,l,u){var f=null;if(u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),"key"in l){u={};for(var h in l)h!=="key"&&(u[h]=l[h])}else u=l;return l=u.ref,{$$typeof:a,type:i,key:f,ref:l!==void 0?l:null,props:u}}return dl.Fragment=t,dl.jsx=r,dl.jsxs=r,dl}var Zh;function hv(){return Zh||(Zh=1,Kc.exports=pv()),Kc.exports}var m=hv(),Wc={exports:{}},tt={};var Qh;function mv(){if(Qh)return tt;Qh=1;var a=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function y(R){return R===null||typeof R!="object"?null:(R=x&&R[x]||R["@@iterator"],typeof R=="function"?R:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function D(R,G,ie){this.props=R,this.context=G,this.refs=w,this.updater=ie||E}D.prototype.isReactComponent={},D.prototype.setState=function(R,G){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,G,"setState")},D.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function U(){}U.prototype=D.prototype;function k(R,G,ie){this.props=R,this.context=G,this.refs=w,this.updater=ie||E}var C=k.prototype=new U;C.constructor=k,S(C,D.prototype),C.isPureReactComponent=!0;var M=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function fe(R,G,ie,ve,te,ge){return ie=ge.ref,{$$typeof:a,type:R,key:G,ref:ie!==void 0?ie:null,props:ge}}function de(R,G){return fe(R.type,G,void 0,void 0,void 0,R.props)}function ce(R){return typeof R=="object"&&R!==null&&R.$$typeof===a}function le(R){var G={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(ie){return G[ie]})}var Z=/\/+/g;function z(R,G){return typeof R=="object"&&R!==null&&R.key!=null?le(""+R.key):G.toString(36)}function Q(){}function $(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(Q,Q):(R.status="pending",R.then(function(G){R.status==="pending"&&(R.status="fulfilled",R.value=G)},function(G){R.status==="pending"&&(R.status="rejected",R.reason=G)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function W(R,G,ie,ve,te){var ge=typeof R;(ge==="undefined"||ge==="boolean")&&(R=null);var Ee=!1;if(R===null)Ee=!0;else switch(ge){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(R.$$typeof){case a:case t:Ee=!0;break;case v:return Ee=R._init,W(Ee(R._payload),G,ie,ve,te)}}if(Ee)return te=te(R),Ee=ve===""?"."+z(R,0):ve,M(te)?(ie="",Ee!=null&&(ie=Ee.replace(Z,"$&/")+"/"),W(te,G,ie,"",function(at){return at})):te!=null&&(ce(te)&&(te=de(te,ie+(te.key==null||R&&R.key===te.key?"":(""+te.key).replace(Z,"$&/")+"/")+Ee)),G.push(te)),1;Ee=0;var Ke=ve===""?".":ve+":";if(M(R))for(var ke=0;ke<R.length;ke++)ve=R[ke],ge=Ke+z(ve,ke),Ee+=W(ve,G,ie,ge,te);else if(ke=y(R),typeof ke=="function")for(R=ke.call(R),ke=0;!(ve=R.next()).done;)ve=ve.value,ge=Ke+z(ve,ke++),Ee+=W(ve,G,ie,ge,te);else if(ge==="object"){if(typeof R.then=="function")return W($(R),G,ie,ve,te);throw G=String(R),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function B(R,G,ie){if(R==null)return R;var ve=[],te=0;return W(R,ve,"","",function(ge){return G.call(ie,ge,te++)}),ve}function P(R){if(R._status===-1){var G=R._result;G=G(),G.then(function(ie){(R._status===0||R._status===-1)&&(R._status=1,R._result=ie)},function(ie){(R._status===0||R._status===-1)&&(R._status=2,R._result=ie)}),R._status===-1&&(R._status=0,R._result=G)}if(R._status===1)return R._result.default;throw R._result}var V=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)};function pe(){}return tt.Children={map:B,forEach:function(R,G,ie){B(R,function(){G.apply(this,arguments)},ie)},count:function(R){var G=0;return B(R,function(){G++}),G},toArray:function(R){return B(R,function(G){return G})||[]},only:function(R){if(!ce(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},tt.Component=D,tt.Fragment=r,tt.Profiler=l,tt.PureComponent=k,tt.StrictMode=i,tt.Suspense=d,tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,tt.__COMPILER_RUNTIME={__proto__:null,c:function(R){return F.H.useMemoCache(R)}},tt.cache=function(R){return function(){return R.apply(null,arguments)}},tt.cloneElement=function(R,G,ie){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var ve=S({},R.props),te=R.key,ge=void 0;if(G!=null)for(Ee in G.ref!==void 0&&(ge=void 0),G.key!==void 0&&(te=""+G.key),G)!H.call(G,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&G.ref===void 0||(ve[Ee]=G[Ee]);var Ee=arguments.length-2;if(Ee===1)ve.children=ie;else if(1<Ee){for(var Ke=Array(Ee),ke=0;ke<Ee;ke++)Ke[ke]=arguments[ke+2];ve.children=Ke}return fe(R.type,te,void 0,void 0,ge,ve)},tt.createContext=function(R){return R={$$typeof:f,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:u,_context:R},R},tt.createElement=function(R,G,ie){var ve,te={},ge=null;if(G!=null)for(ve in G.key!==void 0&&(ge=""+G.key),G)H.call(G,ve)&&ve!=="key"&&ve!=="__self"&&ve!=="__source"&&(te[ve]=G[ve]);var Ee=arguments.length-2;if(Ee===1)te.children=ie;else if(1<Ee){for(var Ke=Array(Ee),ke=0;ke<Ee;ke++)Ke[ke]=arguments[ke+2];te.children=Ke}if(R&&R.defaultProps)for(ve in Ee=R.defaultProps,Ee)te[ve]===void 0&&(te[ve]=Ee[ve]);return fe(R,ge,void 0,void 0,null,te)},tt.createRef=function(){return{current:null}},tt.forwardRef=function(R){return{$$typeof:h,render:R}},tt.isValidElement=ce,tt.lazy=function(R){return{$$typeof:v,_payload:{_status:-1,_result:R},_init:P}},tt.memo=function(R,G){return{$$typeof:g,type:R,compare:G===void 0?null:G}},tt.startTransition=function(R){var G=F.T,ie={};F.T=ie;try{var ve=R(),te=F.S;te!==null&&te(ie,ve),typeof ve=="object"&&ve!==null&&typeof ve.then=="function"&&ve.then(pe,V)}catch(ge){V(ge)}finally{F.T=G}},tt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},tt.use=function(R){return F.H.use(R)},tt.useActionState=function(R,G,ie){return F.H.useActionState(R,G,ie)},tt.useCallback=function(R,G){return F.H.useCallback(R,G)},tt.useContext=function(R){return F.H.useContext(R)},tt.useDebugValue=function(){},tt.useDeferredValue=function(R,G){return F.H.useDeferredValue(R,G)},tt.useEffect=function(R,G,ie){var ve=F.H;if(typeof ie=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ve.useEffect(R,G)},tt.useId=function(){return F.H.useId()},tt.useImperativeHandle=function(R,G,ie){return F.H.useImperativeHandle(R,G,ie)},tt.useInsertionEffect=function(R,G){return F.H.useInsertionEffect(R,G)},tt.useLayoutEffect=function(R,G){return F.H.useLayoutEffect(R,G)},tt.useMemo=function(R,G){return F.H.useMemo(R,G)},tt.useOptimistic=function(R,G){return F.H.useOptimistic(R,G)},tt.useReducer=function(R,G,ie){return F.H.useReducer(R,G,ie)},tt.useRef=function(R){return F.H.useRef(R)},tt.useState=function(R){return F.H.useState(R)},tt.useSyncExternalStore=function(R,G,ie){return F.H.useSyncExternalStore(R,G,ie)},tt.useTransition=function(){return F.H.useTransition()},tt.version="19.1.1",tt}var $h;function Tf(){return $h||($h=1,Wc.exports=mv()),Wc.exports}var T=Tf();const ea=wf(T);var Jc={exports:{}},pl={},ef={exports:{}},tf={};var Kh;function gv(){return Kh||(Kh=1,(function(a){function t(B,P){var V=B.length;B.push(P);e:for(;0<V;){var pe=V-1>>>1,R=B[pe];if(0<l(R,P))B[pe]=P,B[V]=R,V=pe;else break e}}function r(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var P=B[0],V=B.pop();if(V!==P){B[0]=V;e:for(var pe=0,R=B.length,G=R>>>1;pe<G;){var ie=2*(pe+1)-1,ve=B[ie],te=ie+1,ge=B[te];if(0>l(ve,V))te<R&&0>l(ge,ve)?(B[pe]=ge,B[te]=V,pe=te):(B[pe]=ve,B[ie]=V,pe=ie);else if(te<R&&0>l(ge,V))B[pe]=ge,B[te]=V,pe=te;else break e}}return P}function l(B,P){var V=B.sortIndex-P.sortIndex;return V!==0?V:B.id-P.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var f=Date,h=f.now();a.unstable_now=function(){return f.now()-h}}var d=[],g=[],v=1,x=null,y=3,E=!1,S=!1,w=!1,D=!1,U=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function M(B){for(var P=r(g);P!==null;){if(P.callback===null)i(g);else if(P.startTime<=B)i(g),P.sortIndex=P.expirationTime,t(d,P);else break;P=r(g)}}function F(B){if(w=!1,M(B),!S)if(r(d)!==null)S=!0,H||(H=!0,z());else{var P=r(g);P!==null&&W(F,P.startTime-B)}}var H=!1,fe=-1,de=5,ce=-1;function le(){return D?!0:!(a.unstable_now()-ce<de)}function Z(){if(D=!1,H){var B=a.unstable_now();ce=B;var P=!0;try{e:{S=!1,w&&(w=!1,k(fe),fe=-1),E=!0;var V=y;try{t:{for(M(B),x=r(d);x!==null&&!(x.expirationTime>B&&le());){var pe=x.callback;if(typeof pe=="function"){x.callback=null,y=x.priorityLevel;var R=pe(x.expirationTime<=B);if(B=a.unstable_now(),typeof R=="function"){x.callback=R,M(B),P=!0;break t}x===r(d)&&i(d),M(B)}else i(d);x=r(d)}if(x!==null)P=!0;else{var G=r(g);G!==null&&W(F,G.startTime-B),P=!1}}break e}finally{x=null,y=V,E=!1}P=void 0}}finally{P?z():H=!1}}}var z;if(typeof C=="function")z=function(){C(Z)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,$=Q.port2;Q.port1.onmessage=Z,z=function(){$.postMessage(null)}}else z=function(){U(Z,0)};function W(B,P){fe=U(function(){B(a.unstable_now())},P)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(B){B.callback=null},a.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<B?Math.floor(1e3/B):5},a.unstable_getCurrentPriorityLevel=function(){return y},a.unstable_next=function(B){switch(y){case 1:case 2:case 3:var P=3;break;default:P=y}var V=y;y=P;try{return B()}finally{y=V}},a.unstable_requestPaint=function(){D=!0},a.unstable_runWithPriority=function(B,P){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var V=y;y=B;try{return P()}finally{y=V}},a.unstable_scheduleCallback=function(B,P,V){var pe=a.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?pe+V:pe):V=pe,B){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=V+R,B={id:v++,callback:P,priorityLevel:B,startTime:V,expirationTime:R,sortIndex:-1},V>pe?(B.sortIndex=V,t(g,B),r(d)===null&&B===r(g)&&(w?(k(fe),fe=-1):w=!0,W(F,V-pe))):(B.sortIndex=R,t(d,B),S||E||(S=!0,H||(H=!0,z()))),B},a.unstable_shouldYield=le,a.unstable_wrapCallback=function(B){var P=y;return function(){var V=y;y=P;try{return B.apply(this,arguments)}finally{y=V}}}})(tf)),tf}var Wh;function vv(){return Wh||(Wh=1,ef.exports=gv()),ef.exports}var nf={exports:{}},dn={};var Jh;function yv(){if(Jh)return dn;Jh=1;var a=Tf();function t(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(d,g,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:x==null?null:""+x,children:d,containerInfo:g,implementation:v}}var f=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,g){if(d==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dn.createPortal=function(d,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(t(299));return u(d,g,null,v)},dn.flushSync=function(d){var g=f.T,v=i.p;try{if(f.T=null,i.p=2,d)return d()}finally{f.T=g,i.p=v,i.d.f()}},dn.preconnect=function(d,g){typeof d=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(d,g))},dn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},dn.preinit=function(d,g){if(typeof d=="string"&&g&&typeof g.as=="string"){var v=g.as,x=h(v,g.crossOrigin),y=typeof g.integrity=="string"?g.integrity:void 0,E=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;v==="style"?i.d.S(d,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:E}):v==="script"&&i.d.X(d,{crossOrigin:x,integrity:y,fetchPriority:E,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},dn.preinitModule=function(d,g){if(typeof d=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var v=h(g.as,g.crossOrigin);i.d.M(d,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(d)},dn.preload=function(d,g){if(typeof d=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var v=g.as,x=h(v,g.crossOrigin);i.d.L(d,v,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},dn.preloadModule=function(d,g){if(typeof d=="string")if(g){var v=h(g.as,g.crossOrigin);i.d.m(d,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(d)},dn.requestFormReset=function(d){i.d.r(d)},dn.unstable_batchedUpdates=function(d,g){return d(g)},dn.useFormState=function(d,g,v){return f.H.useFormState(d,g,v)},dn.useFormStatus=function(){return f.H.useHostTransitionStatus()},dn.version="19.1.1",dn}var e0;function X0(){if(e0)return nf.exports;e0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),nf.exports=yv(),nf.exports}var t0;function bv(){if(t0)return pl;t0=1;var a=vv(),t=Tf(),r=X0();function i(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function f(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(u(e)!==e)throw Error(i(188))}function d(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(i(188));return n!==e?null:e}for(var s=e,o=n;;){var c=s.return;if(c===null)break;var p=c.alternate;if(p===null){if(o=c.return,o!==null){s=o;continue}break}if(c.child===p.child){for(p=c.child;p;){if(p===s)return h(c),e;if(p===o)return h(c),n;p=p.sibling}throw Error(i(188))}if(s.return!==o.return)s=c,o=p;else{for(var b=!1,A=c.child;A;){if(A===s){b=!0,s=c,o=p;break}if(A===o){b=!0,o=c,s=p;break}A=A.sibling}if(!b){for(A=p.child;A;){if(A===s){b=!0,s=p,o=c;break}if(A===o){b=!0,o=p,s=c;break}A=A.sibling}if(!b)throw Error(i(189))}}if(s.alternate!==o)throw Error(i(190))}if(s.tag!==3)throw Error(i(188));return s.stateNode.current===s?e:n}function g(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=g(e),n!==null)return n;e=e.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),C=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),fe=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),ce=Symbol.for("react.activity"),le=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function z(e){return e===null||typeof e!="object"?null:(e=Z&&e[Z]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Symbol.for("react.client.reference");function $(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case D:return"Profiler";case w:return"StrictMode";case F:return"Suspense";case H:return"SuspenseList";case ce:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case E:return"Portal";case C:return(e.displayName||"Context")+".Provider";case k:return(e._context.displayName||"Context")+".Consumer";case M:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fe:return n=e.displayName||null,n!==null?n:$(e.type)||"Memo";case de:n=e._payload,e=e._init;try{return $(e(n))}catch{}}return null}var W=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},pe=[],R=-1;function G(e){return{current:e}}function ie(e){0>R||(e.current=pe[R],pe[R]=null,R--)}function ve(e,n){R++,pe[R]=e.current,e.current=n}var te=G(null),ge=G(null),Ee=G(null),Ke=G(null);function ke(e,n){switch(ve(Ee,n),ve(ge,e),ve(te,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Sh(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Sh(n),e=Eh(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}ie(te),ve(te,e)}function at(){ie(te),ie(ge),ie(Ee)}function $t(e){e.memoizedState!==null&&ve(Ke,e);var n=te.current,s=Eh(n,e.type);n!==s&&(ve(ge,e),ve(te,s))}function Be(e){ge.current===e&&(ie(te),ie(ge)),Ke.current===e&&(ie(Ke),ll._currentValue=V)}var Ue=Object.prototype.hasOwnProperty,ye=a.unstable_scheduleCallback,ne=a.unstable_cancelCallback,ft=a.unstable_shouldYield,ht=a.unstable_requestPaint,Te=a.unstable_now,Kt=a.unstable_getCurrentPriorityLevel,Gt=a.unstable_ImmediatePriority,ut=a.unstable_UserBlockingPriority,Bt=a.unstable_NormalPriority,gn=a.unstable_LowPriority,cr=a.unstable_IdlePriority,na=a.log,fr=a.unstable_setDisableYieldValue,Aa=null,zt=null;function Ie(e){if(typeof na=="function"&&fr(e),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(Aa,e)}catch{}}var Je=Math.clz32?Math.clz32:aa,Ml=Math.log,Kr=Math.LN2;function aa(e){return e>>>=0,e===0?32:31-(Ml(e)/Kr|0)|0}var ps=256,ra=4194304;function ia(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function sa(e,n,s){var o=e.pendingLanes;if(o===0)return 0;var c=0,p=e.suspendedLanes,b=e.pingedLanes;e=e.warmLanes;var A=o&134217727;return A!==0?(o=A&~p,o!==0?c=ia(o):(b&=A,b!==0?c=ia(b):s||(s=A&~e,s!==0&&(c=ia(s))))):(A=o&~p,A!==0?c=ia(A):b!==0?c=ia(b):s||(s=o&~e,s!==0&&(c=ia(s)))),c===0?0:n!==0&&n!==c&&(n&p)===0&&(p=c&-c,s=n&-n,p>=s||p===32&&(s&4194048)!==0)?n:c}function Fn(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function dr(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function la(){var e=ps;return ps<<=1,(ps&4194048)===0&&(ps=256),e}function Pa(){var e=ra;return ra<<=1,(ra&62914560)===0&&(ra=4194304),e}function jn(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function Wr(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function nu(e,n,s,o,c,p){var b=e.pendingLanes;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=s,e.entangledLanes&=s,e.errorRecoveryDisabledLanes&=s,e.shellSuspendCounter=0;var A=e.entanglements,L=e.expirationTimes,K=e.hiddenUpdates;for(s=b&~s;0<s;){var se=31-Je(s),he=1<<se;A[se]=0,L[se]=-1;var J=K[se];if(J!==null)for(K[se]=null,se=0;se<J.length;se++){var ee=J[se];ee!==null&&(ee.lane&=-536870913)}s&=~he}o!==0&&Ht(e,o,0),p!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=p&~(b&~n))}function Ht(e,n,s){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-Je(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|s&4194090}function Pn(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var o=31-Je(s),c=1<<o;c&n|e[o]&n&&(e[o]|=n),s&=~c}}function Gn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Nl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function au(){var e=P.p;return e!==0?e:(e=window.event,e===void 0?32:Gh(e.type))}function Rl(e,n){var s=P.p;try{return P.p=e,n()}finally{P.p=s}}var Tn=Math.random().toString(36).slice(2),mt="__reactFiber$"+Tn,Dt="__reactProps$"+Tn,Nt="__reactContainer$"+Tn,Tt="__reactEvents$"+Tn,wa="__reactListeners$"+Tn,oa="__reactHandles$"+Tn,Ci="__reactResources$"+Tn,pr="__reactMarker$"+Tn;function Mi(e){delete e[mt],delete e[Dt],delete e[Tt],delete e[wa],delete e[oa]}function zn(e){var n=e[mt];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Nt]||s[mt]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=Ch(e);e!==null;){if(s=e[mt])return s;e=Ch(e)}return n}e=s,s=e.parentNode}return null}function Ga(e){if(e=e[mt]||e[Nt]){var n=e.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return e}return null}function hr(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(i(33))}function Ta(e){var n=e[Ci];return n||(n=e[Ci]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Ft(e){e[pr]=!0}var Jr=new Set,hs={};function ua(e,n){vn(e,n),vn(e+"Capture",n)}function vn(e,n){for(hs[e]=n,e=0;e<n.length;e++)Jr.add(n[e])}var Dl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ca={},Ni={};function ru(e){return Ue.call(Ni,e)?!0:Ue.call(Ca,e)?!1:Dl.test(e)?Ni[e]=!0:(Ca[e]=!0,!1)}function ei(e,n,s){if(ru(n))if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+s)}}function Ma(e,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+s)}}function Cn(e,n,s,o){if(o===null)e.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttributeNS(n,s,""+o)}}var mr,ti;function yn(e){if(mr===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);mr=n&&n[1]||"",ti=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+mr+e+ti}var Na=!1;function gr(e,n){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(ee){var J=ee}Reflect.construct(e,[],he)}else{try{he.call()}catch(ee){J=ee}e.call(he.prototype)}}else{try{throw Error()}catch(ee){J=ee}(he=e())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(ee){if(ee&&J&&typeof ee.stack=="string")return[ee.stack,J.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=o.DetermineComponentFrameRoot(),b=p[0],A=p[1];if(b&&A){var L=b.split(`
`),K=A.split(`
`);for(c=o=0;o<L.length&&!L[o].includes("DetermineComponentFrameRoot");)o++;for(;c<K.length&&!K[c].includes("DetermineComponentFrameRoot");)c++;if(o===L.length||c===K.length)for(o=L.length-1,c=K.length-1;1<=o&&0<=c&&L[o]!==K[c];)c--;for(;1<=o&&0<=c;o--,c--)if(L[o]!==K[c]){if(o!==1||c!==1)do if(o--,c--,0>c||L[o]!==K[c]){var se=`
`+L[o].replace(" at new "," at ");return e.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",e.displayName)),se}while(1<=o&&0<=c);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(s=e?e.displayName||e.name:"")?yn(s):""}function vr(e){switch(e.tag){case 26:case 27:case 5:return yn(e.type);case 16:return yn("Lazy");case 13:return yn("Suspense");case 19:return yn("SuspenseList");case 0:case 15:return gr(e.type,!1);case 11:return gr(e.type.render,!1);case 1:return gr(e.type,!0);case 31:return yn("Activity");default:return""}}function Ra(e){try{var n="";do n+=vr(e),e=e.return;while(e);return n}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}function bn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ms(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function gs(e){var n=ms(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),o=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var c=s.get,p=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return c.call(this)},set:function(b){o=""+b,p.call(this,b)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function _t(e){e._valueTracker||(e._valueTracker=gs(e))}function vs(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),o="";return e&&(o=ms(e)?e.checked?"true":"false":e.value),e=o,e!==s?(n.setValue(e),!0):!1}function ca(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var _l=/[\n"\\]/g;function xn(e){return e.replace(_l,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function ys(e,n,s,o,c,p,b,A){e.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?e.type=b:e.removeAttribute("type"),n!=null?b==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+bn(n)):e.value!==""+bn(n)&&(e.value=""+bn(n)):b!=="submit"&&b!=="reset"||e.removeAttribute("value"),n!=null?Hn(e,b,bn(n)):s!=null?Hn(e,b,bn(s)):o!=null&&e.removeAttribute("value"),c==null&&p!=null&&(e.defaultChecked=!!p),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?e.name=""+bn(A):e.removeAttribute("name")}function yr(e,n,s,o,c,p,b,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||s!=null){if(!(p!=="submit"&&p!=="reset"||n!=null))return;s=s!=null?""+bn(s):"",n=n!=null?""+bn(n):s,A||n===e.value||(e.value=n),e.defaultValue=n}o=o??c,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=A?e.checked:!!o,e.defaultChecked=!!o,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(e.name=b)}function Hn(e,n,s){n==="number"&&ca(e.ownerDocument)===e||e.defaultValue===""+s||(e.defaultValue=""+s)}function fa(e,n,s,o){if(e=e.options,n){n={};for(var c=0;c<s.length;c++)n["$"+s[c]]=!0;for(s=0;s<e.length;s++)c=n.hasOwnProperty("$"+e[s].value),e[s].selected!==c&&(e[s].selected=c),c&&o&&(e[s].defaultSelected=!0)}else{for(s=""+bn(s),n=null,c=0;c<e.length;c++){if(e[c].value===s){e[c].selected=!0,o&&(e[c].defaultSelected=!0);return}n!==null||e[c].disabled||(n=e[c])}n!==null&&(n.selected=!0)}}function ni(e,n,s){if(n!=null&&(n=""+bn(n),n!==e.value&&(e.value=n),s==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=s!=null?""+bn(s):""}function ai(e,n,s,o){if(n==null){if(o!=null){if(s!=null)throw Error(i(92));if(W(o)){if(1<o.length)throw Error(i(93));o=o[0]}s=o}s==null&&(s=""),n=s}s=bn(n),e.defaultValue=s,o=e.textContent,o===s&&o!==""&&o!==null&&(e.value=o)}function da(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var ri=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ol(e,n,s){var o=n.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,s):typeof s!="number"||s===0||ri.has(n)?n==="float"?e.cssFloat=s:e[n]=(""+s).trim():e[n]=s+"px"}function br(e,n,s){if(n!=null&&typeof n!="object")throw Error(i(62));if(e=e.style,s!=null){for(var o in s)!s.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var c in n)o=n[c],n.hasOwnProperty(c)&&s[c]!==o&&Ol(e,c,o)}else for(var p in n)n.hasOwnProperty(p)&&Ol(e,p,n[p])}function bs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),su=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ri(e){return su.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var xs=null;function Ss(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Da=null,xr=null;function kl(e){var n=Ga(e);if(n&&(e=n.stateNode)){var s=e[Dt]||null;e:switch(e=n.stateNode,n.type){case"input":if(ys(e,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+xn(""+n)+'"][type="radio"]'),n=0;n<s.length;n++){var o=s[n];if(o!==e&&o.form===e.form){var c=o[Dt]||null;if(!c)throw Error(i(90));ys(o,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(n=0;n<s.length;n++)o=s[n],o.form===e.form&&vs(o)}break e;case"textarea":ni(e,s.value,s.defaultValue);break e;case"select":n=s.value,n!=null&&fa(e,!!s.multiple,n,!1)}}}var Es=!1;function cn(e,n,s){if(Es)return e(n,s);Es=!0;try{var o=e(n);return o}finally{if(Es=!1,(Da!==null||xr!==null)&&(go(),Da&&(n=Da,e=xr,xr=Da=null,kl(n),e)))for(n=0;n<e.length;n++)kl(e[n])}}function za(e,n){var s=e.stateNode;if(s===null)return null;var o=s[Dt]||null;if(o===null)return null;s=o[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(i(231,n,typeof s));return s}var pa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),As=!1;if(pa)try{var ii={};Object.defineProperty(ii,"passive",{get:function(){As=!0}}),window.addEventListener("test",ii,ii),window.removeEventListener("test",ii,ii)}catch{As=!1}var _a=null,ws=null,Di=null;function _(){if(Di)return Di;var e,n=ws,s=n.length,o,c="value"in _a?_a.value:_a.textContent,p=c.length;for(e=0;e<s&&n[e]===c[e];e++);var b=s-e;for(o=1;o<=b&&n[s-o]===c[p-o];o++);return Di=c.slice(e,1<o?1-o:void 0)}function N(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function I(){return!0}function O(){return!1}function q(e){function n(s,o,c,p,b){this._reactName=s,this._targetInst=c,this.type=o,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var A in e)e.hasOwnProperty(A)&&(s=e[A],this[A]=s?s(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?I:O,this.isPropagationStopped=O,this}return v(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=I)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=I)},persist:function(){},isPersistent:I}),n}var me={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ae=q(me),Ae=v({},me,{view:0,detail:0}),Fe=q(Ae),$e,xe,je,Me=v({},Ae,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wt,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==je&&(je&&e.type==="mousemove"?($e=e.screenX-je.screenX,xe=e.screenY-je.screenY):xe=$e=0,je=e),$e)},movementY:function(e){return"movementY"in e?e.movementY:xe}}),Ce=q(Me),Ve=v({},Me,{dataTransfer:0}),Ne=q(Ve),Ge=v({},Ae,{relatedTarget:0}),Re=q(Ge),He=v({},me,{animationName:0,elapsedTime:0,pseudoElement:0}),Xe=q(He),Ze=v({},me,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),et=q(Ze),yt=v({},me,{data:0}),dt=q(yt),Ot={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Yt[e])?!!n[e]:!1}function Wt(){return Sn}var Ha=v({},Ae,{key:function(e){if(e.key){var n=Ot[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=N(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wt,charCode:function(e){return e.type==="keypress"?N(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?N(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ha=q(Ha),Jt=v({},Me,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kt=q(Jt),Ya=v({},Ae,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wt}),_i=q(Ya),Sr=v({},me,{propertyName:0,elapsedTime:0,pseudoElement:0}),si=q(Sr),Ll=v({},Me,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qa=q(Ll),lt=v({},me,{newState:0,oldState:0}),Oa=q(lt),Yn=[9,13,27,32],Mn=pa&&"CompositionEvent"in window,Va=null;pa&&"documentMode"in document&&(Va=document.documentMode);var Xa=pa&&"TextEvent"in window&&!Va,qn=pa&&(!Mn||Va&&8<Va&&11>=Va),Er=" ",Ul=!1;function Vn(e,n){switch(e){case"keyup":return Yn.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pn(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Oi=!1;function jm(e,n){switch(e){case"compositionend":return pn(n);case"keypress":return n.which!==32?null:(Ul=!0,Er);case"textInput":return e=n.data,e===Er&&Ul?null:e;default:return null}}function Pm(e,n){if(Oi)return e==="compositionend"||!Mn&&Vn(e,n)?(e=_(),Di=ws=_a=null,Oi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return qn&&n.locale!=="ko"?null:n.data;default:return null}}var Gm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uf(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Gm[e.type]:n==="textarea"}function If(e,n,s,o){Da?xr?xr.push(o):xr=[o]:Da=o,n=Eo(n,"onChange"),0<n.length&&(s=new ae("onChange","change",null,s,o),e.push({event:s,listeners:n}))}var Ts=null,Cs=null;function zm(e){gh(e,0)}function Il(e){var n=hr(e);if(vs(n))return e}function Bf(e,n){if(e==="change")return n}var Ff=!1;if(pa){var lu;if(pa){var ou="oninput"in document;if(!ou){var jf=document.createElement("div");jf.setAttribute("oninput","return;"),ou=typeof jf.oninput=="function"}lu=ou}else lu=!1;Ff=lu&&(!document.documentMode||9<document.documentMode)}function Pf(){Ts&&(Ts.detachEvent("onpropertychange",Gf),Cs=Ts=null)}function Gf(e){if(e.propertyName==="value"&&Il(Cs)){var n=[];If(n,Cs,e,Ss(e)),cn(zm,n)}}function Hm(e,n,s){e==="focusin"?(Pf(),Ts=n,Cs=s,Ts.attachEvent("onpropertychange",Gf)):e==="focusout"&&Pf()}function Ym(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Il(Cs)}function qm(e,n){if(e==="click")return Il(n)}function Vm(e,n){if(e==="input"||e==="change")return Il(n)}function Xm(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Nn=typeof Object.is=="function"?Object.is:Xm;function Ms(e,n){if(Nn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),o=Object.keys(n);if(s.length!==o.length)return!1;for(o=0;o<s.length;o++){var c=s[o];if(!Ue.call(n,c)||!Nn(e[c],n[c]))return!1}return!0}function zf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hf(e,n){var s=zf(e);e=0;for(var o;s;){if(s.nodeType===3){if(o=e+s.textContent.length,e<=n&&o>=n)return{node:s,offset:n-e};e=o}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=zf(s)}}function Yf(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Yf(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function qf(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=ca(e.document);n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=ca(e.document)}return n}function uu(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var Zm=pa&&"documentMode"in document&&11>=document.documentMode,ki=null,cu=null,Ns=null,fu=!1;function Vf(e,n,s){var o=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;fu||ki==null||ki!==ca(o)||(o=ki,"selectionStart"in o&&uu(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Ns&&Ms(Ns,o)||(Ns=o,o=Eo(cu,"onSelect"),0<o.length&&(n=new ae("onSelect","select",null,n,s),e.push({event:n,listeners:o}),n.target=ki)))}function li(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var Li={animationend:li("Animation","AnimationEnd"),animationiteration:li("Animation","AnimationIteration"),animationstart:li("Animation","AnimationStart"),transitionrun:li("Transition","TransitionRun"),transitionstart:li("Transition","TransitionStart"),transitioncancel:li("Transition","TransitionCancel"),transitionend:li("Transition","TransitionEnd")},du={},Xf={};pa&&(Xf=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function oi(e){if(du[e])return du[e];if(!Li[e])return e;var n=Li[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in Xf)return du[e]=n[s];return e}var Zf=oi("animationend"),Qf=oi("animationiteration"),$f=oi("animationstart"),Qm=oi("transitionrun"),$m=oi("transitionstart"),Km=oi("transitioncancel"),Kf=oi("transitionend"),Wf=new Map,pu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pu.push("scrollEnd");function ma(e,n){Wf.set(e,n),ua(n,[e])}var Jf=new WeakMap;function Xn(e,n){if(typeof e=="object"&&e!==null){var s=Jf.get(e);return s!==void 0?s:(n={value:e,source:n,stack:Ra(n)},Jf.set(e,n),n)}return{value:e,source:n,stack:Ra(n)}}var Zn=[],Ui=0,hu=0;function Bl(){for(var e=Ui,n=hu=Ui=0;n<e;){var s=Zn[n];Zn[n++]=null;var o=Zn[n];Zn[n++]=null;var c=Zn[n];Zn[n++]=null;var p=Zn[n];if(Zn[n++]=null,o!==null&&c!==null){var b=o.pending;b===null?c.next=c:(c.next=b.next,b.next=c),o.pending=c}p!==0&&ed(s,c,p)}}function Fl(e,n,s,o){Zn[Ui++]=e,Zn[Ui++]=n,Zn[Ui++]=s,Zn[Ui++]=o,hu|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function mu(e,n,s,o){return Fl(e,n,s,o),jl(e)}function Ii(e,n){return Fl(e,null,null,n),jl(e)}function ed(e,n,s){e.lanes|=s;var o=e.alternate;o!==null&&(o.lanes|=s);for(var c=!1,p=e.return;p!==null;)p.childLanes|=s,o=p.alternate,o!==null&&(o.childLanes|=s),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(c=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,c&&n!==null&&(c=31-Je(s),e=p.hiddenUpdates,o=e[c],o===null?e[c]=[n]:o.push(n),n.lane=s|536870912),p):null}function jl(e){if(50<Js)throw Js=0,Sc=null,Error(i(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Bi={};function Wm(e,n,s,o){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(e,n,s,o){return new Wm(e,n,s,o)}function gu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Za(e,n){var s=e.alternate;return s===null?(s=Rn(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&65011712,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s.refCleanup=e.refCleanup,s}function td(e,n){e.flags&=65011714;var s=e.alternate;return s===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=s.childLanes,e.lanes=s.lanes,e.child=s.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=s.memoizedProps,e.memoizedState=s.memoizedState,e.updateQueue=s.updateQueue,e.type=s.type,n=s.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Pl(e,n,s,o,c,p){var b=0;if(o=e,typeof e=="function")gu(e)&&(b=1);else if(typeof e=="string")b=ev(e,s,te.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ce:return e=Rn(31,s,n,c),e.elementType=ce,e.lanes=p,e;case S:return ui(s.children,c,p,n);case w:b=8,c|=24;break;case D:return e=Rn(12,s,n,c|2),e.elementType=D,e.lanes=p,e;case F:return e=Rn(13,s,n,c),e.elementType=F,e.lanes=p,e;case H:return e=Rn(19,s,n,c),e.elementType=H,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case U:case C:b=10;break e;case k:b=9;break e;case M:b=11;break e;case fe:b=14;break e;case de:b=16,o=null;break e}b=29,s=Error(i(130,e===null?"null":typeof e,"")),o=null}return n=Rn(b,s,n,c),n.elementType=e,n.type=o,n.lanes=p,n}function ui(e,n,s,o){return e=Rn(7,e,o,n),e.lanes=s,e}function vu(e,n,s){return e=Rn(6,e,null,n),e.lanes=s,e}function yu(e,n,s){return n=Rn(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Fi=[],ji=0,Gl=null,zl=0,Qn=[],$n=0,ci=null,Qa=1,$a="";function fi(e,n){Fi[ji++]=zl,Fi[ji++]=Gl,Gl=e,zl=n}function nd(e,n,s){Qn[$n++]=Qa,Qn[$n++]=$a,Qn[$n++]=ci,ci=e;var o=Qa;e=$a;var c=32-Je(o)-1;o&=~(1<<c),s+=1;var p=32-Je(n)+c;if(30<p){var b=c-c%5;p=(o&(1<<b)-1).toString(32),o>>=b,c-=b,Qa=1<<32-Je(n)+c|s<<c|o,$a=p+e}else Qa=1<<p|s<<c|o,$a=e}function bu(e){e.return!==null&&(fi(e,1),nd(e,1,0))}function xu(e){for(;e===Gl;)Gl=Fi[--ji],Fi[ji]=null,zl=Fi[--ji],Fi[ji]=null;for(;e===ci;)ci=Qn[--$n],Qn[$n]=null,$a=Qn[--$n],Qn[$n]=null,Qa=Qn[--$n],Qn[$n]=null}var hn=null,Lt=null,pt=!1,di=null,ka=!1,Su=Error(i(519));function pi(e){var n=Error(i(418,""));throw _s(Xn(n,e)),Su}function ad(e){var n=e.stateNode,s=e.type,o=e.memoizedProps;switch(n[mt]=e,n[Dt]=o,s){case"dialog":st("cancel",n),st("close",n);break;case"iframe":case"object":case"embed":st("load",n);break;case"video":case"audio":for(s=0;s<tl.length;s++)st(tl[s],n);break;case"source":st("error",n);break;case"img":case"image":case"link":st("error",n),st("load",n);break;case"details":st("toggle",n);break;case"input":st("invalid",n),yr(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0),_t(n);break;case"select":st("invalid",n);break;case"textarea":st("invalid",n),ai(n,o.value,o.defaultValue,o.children),_t(n)}s=o.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||n.textContent===""+s||o.suppressHydrationWarning===!0||xh(n.textContent,s)?(o.popover!=null&&(st("beforetoggle",n),st("toggle",n)),o.onScroll!=null&&st("scroll",n),o.onScrollEnd!=null&&st("scrollend",n),o.onClick!=null&&(n.onclick=Ao),n=!0):n=!1,n||pi(e)}function rd(e){for(hn=e.return;hn;)switch(hn.tag){case 5:case 13:ka=!1;return;case 27:case 3:ka=!0;return;default:hn=hn.return}}function Rs(e){if(e!==hn)return!1;if(!pt)return rd(e),pt=!0,!1;var n=e.tag,s;if((s=n!==3&&n!==27)&&((s=n===5)&&(s=e.type,s=!(s!=="form"&&s!=="button")||Bc(e.type,e.memoizedProps)),s=!s),s&&Lt&&pi(e),rd(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8)if(s=e.data,s==="/$"){if(n===0){Lt=va(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++;e=e.nextSibling}Lt=null}}else n===27?(n=Lt,Fr(e.type)?(e=Gc,Gc=null,Lt=e):Lt=n):Lt=hn?va(e.stateNode.nextSibling):null;return!0}function Ds(){Lt=hn=null,pt=!1}function id(){var e=di;return e!==null&&(wn===null?wn=e:wn.push.apply(wn,e),di=null),e}function _s(e){di===null?di=[e]:di.push(e)}var Eu=G(null),hi=null,Ka=null;function Ar(e,n,s){ve(Eu,n._currentValue),n._currentValue=s}function Wa(e){e._currentValue=Eu.current,ie(Eu)}function Au(e,n,s){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===s)break;e=e.return}}function wu(e,n,s,o){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var p=c.dependencies;if(p!==null){var b=c.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=c;for(var L=0;L<n.length;L++)if(A.context===n[L]){p.lanes|=s,A=p.alternate,A!==null&&(A.lanes|=s),Au(p.return,s,e),o||(b=null);break e}p=A.next}}else if(c.tag===18){if(b=c.return,b===null)throw Error(i(341));b.lanes|=s,p=b.alternate,p!==null&&(p.lanes|=s),Au(b,s,e),b=null}else b=c.child;if(b!==null)b.return=c;else for(b=c;b!==null;){if(b===e){b=null;break}if(c=b.sibling,c!==null){c.return=b.return,b=c;break}b=b.return}c=b}}function Os(e,n,s,o){e=null;for(var c=n,p=!1;c!==null;){if(!p){if((c.flags&524288)!==0)p=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var b=c.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var A=c.type;Nn(c.pendingProps.value,b.value)||(e!==null?e.push(A):e=[A])}}else if(c===Ke.current){if(b=c.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(ll):e=[ll])}c=c.return}e!==null&&wu(n,e,s,o),n.flags|=262144}function Hl(e){for(e=e.firstContext;e!==null;){if(!Nn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function mi(e){hi=e,Ka=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function fn(e){return sd(hi,e)}function Yl(e,n){return hi===null&&mi(e),sd(e,n)}function sd(e,n){var s=n._currentValue;if(n={context:n,memoizedValue:s,next:null},Ka===null){if(e===null)throw Error(i(308));Ka=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Ka=Ka.next=n;return s}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(s,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(s){return s()})}},eg=a.unstable_scheduleCallback,tg=a.unstable_NormalPriority,Xt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tu(){return{controller:new Jm,data:new Map,refCount:0}}function ks(e){e.refCount--,e.refCount===0&&eg(tg,function(){e.controller.abort()})}var Ls=null,Cu=0,Pi=0,Gi=null;function ng(e,n){if(Ls===null){var s=Ls=[];Cu=0,Pi=Nc(),Gi={status:"pending",value:void 0,then:function(o){s.push(o)}}}return Cu++,n.then(ld,ld),n}function ld(){if(--Cu===0&&Ls!==null){Gi!==null&&(Gi.status="fulfilled");var e=Ls;Ls=null,Pi=0,Gi=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function ag(e,n){var s=[],o={status:"pending",value:null,reason:null,then:function(c){s.push(c)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var c=0;c<s.length;c++)(0,s[c])(n)},function(c){for(o.status="rejected",o.reason=c,c=0;c<s.length;c++)(0,s[c])(void 0)}),o}var od=B.S;B.S=function(e,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&ng(e,n),od!==null&&od(e,n)};var gi=G(null);function Mu(){var e=gi.current;return e!==null?e:At.pooledCache}function ql(e,n){n===null?ve(gi,gi.current):ve(gi,n.pool)}function ud(){var e=Mu();return e===null?null:{parent:Xt._currentValue,pool:e}}var Us=Error(i(460)),cd=Error(i(474)),Vl=Error(i(542)),Nu={then:function(){}};function fd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Xl(){}function dd(e,n,s){switch(s=e[s],s===void 0?e.push(n):s!==n&&(n.then(Xl,Xl),n=s),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,hd(e),e;default:if(typeof n.status=="string")n.then(Xl,Xl);else{if(e=At,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var c=n;c.status="fulfilled",c.value=o}},function(o){if(n.status==="pending"){var c=n;c.status="rejected",c.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,hd(e),e}throw Is=n,Us}}var Is=null;function pd(){if(Is===null)throw Error(i(459));var e=Is;return Is=null,e}function hd(e){if(e===Us||e===Vl)throw Error(i(483))}var wr=!1;function Ru(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Du(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Tr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Cr(e,n,s){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(gt&2)!==0){var c=o.pending;return c===null?n.next=n:(n.next=c.next,c.next=n),o.pending=n,n=jl(e),ed(e,null,s),n}return Fl(e,o,n,s),jl(e)}function Bs(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,s|=o,n.lanes=s,Pn(e,s)}}function _u(e,n){var s=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,s===o)){var c=null,p=null;if(s=s.firstBaseUpdate,s!==null){do{var b={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};p===null?c=p=b:p=p.next=b,s=s.next}while(s!==null);p===null?c=p=n:p=p.next=n}else c=p=n;s={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:p,shared:o.shared,callbacks:o.callbacks},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}var Ou=!1;function Fs(){if(Ou){var e=Gi;if(e!==null)throw e}}function js(e,n,s,o){Ou=!1;var c=e.updateQueue;wr=!1;var p=c.firstBaseUpdate,b=c.lastBaseUpdate,A=c.shared.pending;if(A!==null){c.shared.pending=null;var L=A,K=L.next;L.next=null,b===null?p=K:b.next=K,b=L;var se=e.alternate;se!==null&&(se=se.updateQueue,A=se.lastBaseUpdate,A!==b&&(A===null?se.firstBaseUpdate=K:A.next=K,se.lastBaseUpdate=L))}if(p!==null){var he=c.baseState;b=0,se=K=L=null,A=p;do{var J=A.lane&-536870913,ee=J!==A.lane;if(ee?(ot&J)===J:(o&J)===J){J!==0&&J===Pi&&(Ou=!0),se!==null&&(se=se.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Ye=e,Pe=A;J=n;var St=s;switch(Pe.tag){case 1:if(Ye=Pe.payload,typeof Ye=="function"){he=Ye.call(St,he,J);break e}he=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=Pe.payload,J=typeof Ye=="function"?Ye.call(St,he,J):Ye,J==null)break e;he=v({},he,J);break e;case 2:wr=!0}}J=A.callback,J!==null&&(e.flags|=64,ee&&(e.flags|=8192),ee=c.callbacks,ee===null?c.callbacks=[J]:ee.push(J))}else ee={lane:J,tag:A.tag,payload:A.payload,callback:A.callback,next:null},se===null?(K=se=ee,L=he):se=se.next=ee,b|=J;if(A=A.next,A===null){if(A=c.shared.pending,A===null)break;ee=A,A=ee.next,ee.next=null,c.lastBaseUpdate=ee,c.shared.pending=null}}while(!0);se===null&&(L=he),c.baseState=L,c.firstBaseUpdate=K,c.lastBaseUpdate=se,p===null&&(c.shared.lanes=0),Lr|=b,e.lanes=b,e.memoizedState=he}}function md(e,n){if(typeof e!="function")throw Error(i(191,e));e.call(n)}function gd(e,n){var s=e.callbacks;if(s!==null)for(e.callbacks=null,e=0;e<s.length;e++)md(s[e],n)}var zi=G(null),Zl=G(0);function vd(e,n){e=ir,ve(Zl,e),ve(zi,n),ir=e|n.baseLanes}function ku(){ve(Zl,ir),ve(zi,zi.current)}function Lu(){ir=Zl.current,ie(zi),ie(Zl)}var Mr=0,nt=null,bt=null,qt=null,Ql=!1,Hi=!1,vi=!1,$l=0,Ps=0,Yi=null,rg=0;function jt(){throw Error(i(321))}function Uu(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!Nn(e[s],n[s]))return!1;return!0}function Iu(e,n,s,o,c,p){return Mr=p,nt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,B.H=e===null||e.memoizedState===null?ep:tp,vi=!1,p=s(o,c),vi=!1,Hi&&(p=bd(n,s,o,c)),yd(e),p}function yd(e){B.H=no;var n=bt!==null&&bt.next!==null;if(Mr=0,qt=bt=nt=null,Ql=!1,Ps=0,Yi=null,n)throw Error(i(300));e===null||en||(e=e.dependencies,e!==null&&Hl(e)&&(en=!0))}function bd(e,n,s,o){nt=e;var c=0;do{if(Hi&&(Yi=null),Ps=0,Hi=!1,25<=c)throw Error(i(301));if(c+=1,qt=bt=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}B.H=fg,p=n(s,o)}while(Hi);return p}function ig(){var e=B.H,n=e.useState()[0];return n=typeof n.then=="function"?Gs(n):n,e=e.useState()[0],(bt!==null?bt.memoizedState:null)!==e&&(nt.flags|=1024),n}function Bu(){var e=$l!==0;return $l=0,e}function Fu(e,n,s){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~s}function ju(e){if(Ql){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Ql=!1}Mr=0,qt=bt=nt=null,Hi=!1,Ps=$l=0,Yi=null}function En(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?nt.memoizedState=qt=e:qt=qt.next=e,qt}function Vt(){if(bt===null){var e=nt.alternate;e=e!==null?e.memoizedState:null}else e=bt.next;var n=qt===null?nt.memoizedState:qt.next;if(n!==null)qt=n,bt=e;else{if(e===null)throw nt.alternate===null?Error(i(467)):Error(i(310));bt=e,e={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},qt===null?nt.memoizedState=qt=e:qt=qt.next=e}return qt}function Pu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gs(e){var n=Ps;return Ps+=1,Yi===null&&(Yi=[]),e=dd(Yi,e,n),n=nt,(qt===null?n.memoizedState:qt.next)===null&&(n=n.alternate,B.H=n===null||n.memoizedState===null?ep:tp),e}function Kl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Gs(e);if(e.$$typeof===C)return fn(e)}throw Error(i(438,String(e)))}function Gu(e){var n=null,s=nt.updateQueue;if(s!==null&&(n=s.memoCache),n==null){var o=nt.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(c){return c.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),s===null&&(s=Pu(),nt.updateQueue=s),s.memoCache=n,s=n.data[n.index],s===void 0)for(s=n.data[n.index]=Array(e),o=0;o<e;o++)s[o]=le;return n.index++,s}function Ja(e,n){return typeof n=="function"?n(e):n}function Wl(e){var n=Vt();return zu(n,bt,e)}function zu(e,n,s){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=e.baseQueue,p=o.pending;if(p!==null){if(c!==null){var b=c.next;c.next=p.next,p.next=b}n.baseQueue=c=p,o.pending=null}if(p=e.baseState,c===null)e.memoizedState=p;else{n=c.next;var A=b=null,L=null,K=n,se=!1;do{var he=K.lane&-536870913;if(he!==K.lane?(ot&he)===he:(Mr&he)===he){var J=K.revertLane;if(J===0)L!==null&&(L=L.next={lane:0,revertLane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),he===Pi&&(se=!0);else if((Mr&J)===J){K=K.next,J===Pi&&(se=!0);continue}else he={lane:0,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},L===null?(A=L=he,b=p):L=L.next=he,nt.lanes|=J,Lr|=J;he=K.action,vi&&s(p,he),p=K.hasEagerState?K.eagerState:s(p,he)}else J={lane:he,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},L===null?(A=L=J,b=p):L=L.next=J,nt.lanes|=he,Lr|=he;K=K.next}while(K!==null&&K!==n);if(L===null?b=p:L.next=A,!Nn(p,e.memoizedState)&&(en=!0,se&&(s=Gi,s!==null)))throw s;e.memoizedState=p,e.baseState=b,e.baseQueue=L,o.lastRenderedState=p}return c===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Hu(e){var n=Vt(),s=n.queue;if(s===null)throw Error(i(311));s.lastRenderedReducer=e;var o=s.dispatch,c=s.pending,p=n.memoizedState;if(c!==null){s.pending=null;var b=c=c.next;do p=e(p,b.action),b=b.next;while(b!==c);Nn(p,n.memoizedState)||(en=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),s.lastRenderedState=p}return[p,o]}function xd(e,n,s){var o=nt,c=Vt(),p=pt;if(p){if(s===void 0)throw Error(i(407));s=s()}else s=n();var b=!Nn((bt||c).memoizedState,s);b&&(c.memoizedState=s,en=!0),c=c.queue;var A=Ad.bind(null,o,c,e);if(zs(2048,8,A,[e]),c.getSnapshot!==n||b||qt!==null&&qt.memoizedState.tag&1){if(o.flags|=2048,qi(9,Jl(),Ed.bind(null,o,c,s,n),null),At===null)throw Error(i(349));p||(Mr&124)!==0||Sd(o,n,s)}return s}function Sd(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=nt.updateQueue,n===null?(n=Pu(),nt.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function Ed(e,n,s,o){n.value=s,n.getSnapshot=o,wd(n)&&Td(e)}function Ad(e,n,s){return s(function(){wd(n)&&Td(e)})}function wd(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!Nn(e,s)}catch{return!0}}function Td(e){var n=Ii(e,2);n!==null&&Ln(n,e,2)}function Yu(e){var n=En();if(typeof e=="function"){var s=e;if(e=s(),vi){Ie(!0);try{s()}finally{Ie(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:e},n}function Cd(e,n,s,o){return e.baseState=s,zu(e,bt,typeof o=="function"?o:Ja)}function sg(e,n,s,o,c){if(to(e))throw Error(i(485));if(e=n.action,e!==null){var p={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};B.T!==null?s(!0):p.isTransition=!1,o(p),s=n.pending,s===null?(p.next=n.pending=p,Md(n,p)):(p.next=s.next,n.pending=s.next=p)}}function Md(e,n){var s=n.action,o=n.payload,c=e.state;if(n.isTransition){var p=B.T,b={};B.T=b;try{var A=s(c,o),L=B.S;L!==null&&L(b,A),Nd(e,n,A)}catch(K){qu(e,n,K)}finally{B.T=p}}else try{p=s(c,o),Nd(e,n,p)}catch(K){qu(e,n,K)}}function Nd(e,n,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(o){Rd(e,n,o)},function(o){return qu(e,n,o)}):Rd(e,n,s)}function Rd(e,n,s){n.status="fulfilled",n.value=s,Dd(n),e.state=s,n=e.pending,n!==null&&(s=n.next,s===n?e.pending=null:(s=s.next,n.next=s,Md(e,s)))}function qu(e,n,s){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=s,Dd(n),n=n.next;while(n!==o)}e.action=null}function Dd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function _d(e,n){return n}function Od(e,n){if(pt){var s=At.formState;if(s!==null){e:{var o=nt;if(pt){if(Lt){t:{for(var c=Lt,p=ka;c.nodeType!==8;){if(!p){c=null;break t}if(c=va(c.nextSibling),c===null){c=null;break t}}p=c.data,c=p==="F!"||p==="F"?c:null}if(c){Lt=va(c.nextSibling),o=c.data==="F!";break e}}pi(o)}o=!1}o&&(n=s[0])}}return s=En(),s.memoizedState=s.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_d,lastRenderedState:n},s.queue=o,s=Kd.bind(null,nt,o),o.dispatch=s,o=Yu(!1),p=$u.bind(null,nt,!1,o.queue),o=En(),c={state:n,dispatch:null,action:e,pending:null},o.queue=c,s=sg.bind(null,nt,c,p,s),c.dispatch=s,o.memoizedState=e,[n,s,!1]}function kd(e){var n=Vt();return Ld(n,bt,e)}function Ld(e,n,s){if(n=zu(e,n,_d)[0],e=Wl(Ja)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Gs(n)}catch(b){throw b===Us?Vl:b}else o=n;n=Vt();var c=n.queue,p=c.dispatch;return s!==n.memoizedState&&(nt.flags|=2048,qi(9,Jl(),lg.bind(null,c,s),null)),[o,p,e]}function lg(e,n){e.action=n}function Ud(e){var n=Vt(),s=bt;if(s!==null)return Ld(n,s,e);Vt(),n=n.memoizedState,s=Vt();var o=s.queue.dispatch;return s.memoizedState=e,[n,o,!1]}function qi(e,n,s,o){return e={tag:e,create:s,deps:o,inst:n,next:null},n=nt.updateQueue,n===null&&(n=Pu(),nt.updateQueue=n),s=n.lastEffect,s===null?n.lastEffect=e.next=e:(o=s.next,s.next=e,e.next=o,n.lastEffect=e),e}function Jl(){return{destroy:void 0,resource:void 0}}function Id(){return Vt().memoizedState}function eo(e,n,s,o){var c=En();o=o===void 0?null:o,nt.flags|=e,c.memoizedState=qi(1|n,Jl(),s,o)}function zs(e,n,s,o){var c=Vt();o=o===void 0?null:o;var p=c.memoizedState.inst;bt!==null&&o!==null&&Uu(o,bt.memoizedState.deps)?c.memoizedState=qi(n,p,s,o):(nt.flags|=e,c.memoizedState=qi(1|n,p,s,o))}function Bd(e,n){eo(8390656,8,e,n)}function Fd(e,n){zs(2048,8,e,n)}function jd(e,n){return zs(4,2,e,n)}function Pd(e,n){return zs(4,4,e,n)}function Gd(e,n){if(typeof n=="function"){e=e();var s=n(e);return function(){typeof s=="function"?s():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function zd(e,n,s){s=s!=null?s.concat([e]):null,zs(4,4,Gd.bind(null,n,e),s)}function Vu(){}function Hd(e,n){var s=Vt();n=n===void 0?null:n;var o=s.memoizedState;return n!==null&&Uu(n,o[1])?o[0]:(s.memoizedState=[e,n],e)}function Yd(e,n){var s=Vt();n=n===void 0?null:n;var o=s.memoizedState;if(n!==null&&Uu(n,o[1]))return o[0];if(o=e(),vi){Ie(!0);try{e()}finally{Ie(!1)}}return s.memoizedState=[o,n],o}function Xu(e,n,s){return s===void 0||(Mr&1073741824)!==0?e.memoizedState=n:(e.memoizedState=s,e=Xp(),nt.lanes|=e,Lr|=e,s)}function qd(e,n,s,o){return Nn(s,n)?s:zi.current!==null?(e=Xu(e,s,o),Nn(e,n)||(en=!0),e):(Mr&42)===0?(en=!0,e.memoizedState=s):(e=Xp(),nt.lanes|=e,Lr|=e,n)}function Vd(e,n,s,o,c){var p=P.p;P.p=p!==0&&8>p?p:8;var b=B.T,A={};B.T=A,$u(e,!1,n,s);try{var L=c(),K=B.S;if(K!==null&&K(A,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var se=ag(L,o);Hs(e,n,se,kn(e))}else Hs(e,n,o,kn(e))}catch(he){Hs(e,n,{then:function(){},status:"rejected",reason:he},kn())}finally{P.p=p,B.T=b}}function og(){}function Zu(e,n,s,o){if(e.tag!==5)throw Error(i(476));var c=Xd(e).queue;Vd(e,c,n,V,s===null?og:function(){return Zd(e),s(o)})}function Xd(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:V},next:null};var s={};return n.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:s},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function Zd(e){var n=Xd(e).next.queue;Hs(e,n,{},kn())}function Qu(){return fn(ll)}function Qd(){return Vt().memoizedState}function $d(){return Vt().memoizedState}function ug(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var s=kn();e=Tr(s);var o=Cr(n,e,s);o!==null&&(Ln(o,n,s),Bs(o,n,s)),n={cache:Tu()},e.payload=n;return}n=n.return}}function cg(e,n,s){var o=kn();s={lane:o,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null},to(e)?Wd(n,s):(s=mu(e,n,s,o),s!==null&&(Ln(s,e,o),Jd(s,n,o)))}function Kd(e,n,s){var o=kn();Hs(e,n,s,o)}function Hs(e,n,s,o){var c={lane:o,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null};if(to(e))Wd(n,c);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var b=n.lastRenderedState,A=p(b,s);if(c.hasEagerState=!0,c.eagerState=A,Nn(A,b))return Fl(e,n,c,0),At===null&&Bl(),!1}catch{}if(s=mu(e,n,c,o),s!==null)return Ln(s,e,o),Jd(s,n,o),!0}return!1}function $u(e,n,s,o){if(o={lane:2,revertLane:Nc(),action:o,hasEagerState:!1,eagerState:null,next:null},to(e)){if(n)throw Error(i(479))}else n=mu(e,s,o,2),n!==null&&Ln(n,e,2)}function to(e){var n=e.alternate;return e===nt||n!==null&&n===nt}function Wd(e,n){Hi=Ql=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function Jd(e,n,s){if((s&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,s|=o,n.lanes=s,Pn(e,s)}}var no={readContext:fn,use:Kl,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useLayoutEffect:jt,useInsertionEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useSyncExternalStore:jt,useId:jt,useHostTransitionStatus:jt,useFormState:jt,useActionState:jt,useOptimistic:jt,useMemoCache:jt,useCacheRefresh:jt},ep={readContext:fn,use:Kl,useCallback:function(e,n){return En().memoizedState=[e,n===void 0?null:n],e},useContext:fn,useEffect:Bd,useImperativeHandle:function(e,n,s){s=s!=null?s.concat([e]):null,eo(4194308,4,Gd.bind(null,n,e),s)},useLayoutEffect:function(e,n){return eo(4194308,4,e,n)},useInsertionEffect:function(e,n){eo(4,2,e,n)},useMemo:function(e,n){var s=En();n=n===void 0?null:n;var o=e();if(vi){Ie(!0);try{e()}finally{Ie(!1)}}return s.memoizedState=[o,n],o},useReducer:function(e,n,s){var o=En();if(s!==void 0){var c=s(n);if(vi){Ie(!0);try{s(n)}finally{Ie(!1)}}}else c=n;return o.memoizedState=o.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},o.queue=e,e=e.dispatch=cg.bind(null,nt,e),[o.memoizedState,e]},useRef:function(e){var n=En();return e={current:e},n.memoizedState=e},useState:function(e){e=Yu(e);var n=e.queue,s=Kd.bind(null,nt,n);return n.dispatch=s,[e.memoizedState,s]},useDebugValue:Vu,useDeferredValue:function(e,n){var s=En();return Xu(s,e,n)},useTransition:function(){var e=Yu(!1);return e=Vd.bind(null,nt,e.queue,!0,!1),En().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,s){var o=nt,c=En();if(pt){if(s===void 0)throw Error(i(407));s=s()}else{if(s=n(),At===null)throw Error(i(349));(ot&124)!==0||Sd(o,n,s)}c.memoizedState=s;var p={value:s,getSnapshot:n};return c.queue=p,Bd(Ad.bind(null,o,p,e),[e]),o.flags|=2048,qi(9,Jl(),Ed.bind(null,o,p,s,n),null),s},useId:function(){var e=En(),n=At.identifierPrefix;if(pt){var s=$a,o=Qa;s=(o&~(1<<32-Je(o)-1)).toString(32)+s,n=""+n+"R"+s,s=$l++,0<s&&(n+="H"+s.toString(32)),n+=""}else s=rg++,n=""+n+"r"+s.toString(32)+"";return e.memoizedState=n},useHostTransitionStatus:Qu,useFormState:Od,useActionState:Od,useOptimistic:function(e){var n=En();n.memoizedState=n.baseState=e;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=s,n=$u.bind(null,nt,!0,s),s.dispatch=n,[e,n]},useMemoCache:Gu,useCacheRefresh:function(){return En().memoizedState=ug.bind(null,nt)}},tp={readContext:fn,use:Kl,useCallback:Hd,useContext:fn,useEffect:Fd,useImperativeHandle:zd,useInsertionEffect:jd,useLayoutEffect:Pd,useMemo:Yd,useReducer:Wl,useRef:Id,useState:function(){return Wl(Ja)},useDebugValue:Vu,useDeferredValue:function(e,n){var s=Vt();return qd(s,bt.memoizedState,e,n)},useTransition:function(){var e=Wl(Ja)[0],n=Vt().memoizedState;return[typeof e=="boolean"?e:Gs(e),n]},useSyncExternalStore:xd,useId:Qd,useHostTransitionStatus:Qu,useFormState:kd,useActionState:kd,useOptimistic:function(e,n){var s=Vt();return Cd(s,bt,e,n)},useMemoCache:Gu,useCacheRefresh:$d},fg={readContext:fn,use:Kl,useCallback:Hd,useContext:fn,useEffect:Fd,useImperativeHandle:zd,useInsertionEffect:jd,useLayoutEffect:Pd,useMemo:Yd,useReducer:Hu,useRef:Id,useState:function(){return Hu(Ja)},useDebugValue:Vu,useDeferredValue:function(e,n){var s=Vt();return bt===null?Xu(s,e,n):qd(s,bt.memoizedState,e,n)},useTransition:function(){var e=Hu(Ja)[0],n=Vt().memoizedState;return[typeof e=="boolean"?e:Gs(e),n]},useSyncExternalStore:xd,useId:Qd,useHostTransitionStatus:Qu,useFormState:Ud,useActionState:Ud,useOptimistic:function(e,n){var s=Vt();return bt!==null?Cd(s,bt,e,n):(s.baseState=e,[e,s.queue.dispatch])},useMemoCache:Gu,useCacheRefresh:$d},Vi=null,Ys=0;function ao(e){var n=Ys;return Ys+=1,Vi===null&&(Vi=[]),dd(Vi,e,n)}function qs(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function ro(e,n){throw n.$$typeof===x?Error(i(525)):(e=Object.prototype.toString.call(n),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function np(e){var n=e._init;return n(e._payload)}function ap(e){function n(Y,j){if(e){var X=Y.deletions;X===null?(Y.deletions=[j],Y.flags|=16):X.push(j)}}function s(Y,j){if(!e)return null;for(;j!==null;)n(Y,j),j=j.sibling;return null}function o(Y){for(var j=new Map;Y!==null;)Y.key!==null?j.set(Y.key,Y):j.set(Y.index,Y),Y=Y.sibling;return j}function c(Y,j){return Y=Za(Y,j),Y.index=0,Y.sibling=null,Y}function p(Y,j,X){return Y.index=X,e?(X=Y.alternate,X!==null?(X=X.index,X<j?(Y.flags|=67108866,j):X):(Y.flags|=67108866,j)):(Y.flags|=1048576,j)}function b(Y){return e&&Y.alternate===null&&(Y.flags|=67108866),Y}function A(Y,j,X,oe){return j===null||j.tag!==6?(j=vu(X,Y.mode,oe),j.return=Y,j):(j=c(j,X),j.return=Y,j)}function L(Y,j,X,oe){var De=X.type;return De===S?se(Y,j,X.props.children,oe,X.key):j!==null&&(j.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===de&&np(De)===j.type)?(j=c(j,X.props),qs(j,X),j.return=Y,j):(j=Pl(X.type,X.key,X.props,null,Y.mode,oe),qs(j,X),j.return=Y,j)}function K(Y,j,X,oe){return j===null||j.tag!==4||j.stateNode.containerInfo!==X.containerInfo||j.stateNode.implementation!==X.implementation?(j=yu(X,Y.mode,oe),j.return=Y,j):(j=c(j,X.children||[]),j.return=Y,j)}function se(Y,j,X,oe,De){return j===null||j.tag!==7?(j=ui(X,Y.mode,oe,De),j.return=Y,j):(j=c(j,X),j.return=Y,j)}function he(Y,j,X){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=vu(""+j,Y.mode,X),j.return=Y,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case y:return X=Pl(j.type,j.key,j.props,null,Y.mode,X),qs(X,j),X.return=Y,X;case E:return j=yu(j,Y.mode,X),j.return=Y,j;case de:var oe=j._init;return j=oe(j._payload),he(Y,j,X)}if(W(j)||z(j))return j=ui(j,Y.mode,X,null),j.return=Y,j;if(typeof j.then=="function")return he(Y,ao(j),X);if(j.$$typeof===C)return he(Y,Yl(Y,j),X);ro(Y,j)}return null}function J(Y,j,X,oe){var De=j!==null?j.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return De!==null?null:A(Y,j,""+X,oe);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case y:return X.key===De?L(Y,j,X,oe):null;case E:return X.key===De?K(Y,j,X,oe):null;case de:return De=X._init,X=De(X._payload),J(Y,j,X,oe)}if(W(X)||z(X))return De!==null?null:se(Y,j,X,oe,null);if(typeof X.then=="function")return J(Y,j,ao(X),oe);if(X.$$typeof===C)return J(Y,j,Yl(Y,X),oe);ro(Y,X)}return null}function ee(Y,j,X,oe,De){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Y=Y.get(X)||null,A(j,Y,""+oe,De);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return Y=Y.get(oe.key===null?X:oe.key)||null,L(j,Y,oe,De);case E:return Y=Y.get(oe.key===null?X:oe.key)||null,K(j,Y,oe,De);case de:var rt=oe._init;return oe=rt(oe._payload),ee(Y,j,X,oe,De)}if(W(oe)||z(oe))return Y=Y.get(X)||null,se(j,Y,oe,De,null);if(typeof oe.then=="function")return ee(Y,j,X,ao(oe),De);if(oe.$$typeof===C)return ee(Y,j,X,Yl(j,oe),De);ro(j,oe)}return null}function Ye(Y,j,X,oe){for(var De=null,rt=null,Le=j,ze=j=0,nn=null;Le!==null&&ze<X.length;ze++){Le.index>ze?(nn=Le,Le=null):nn=Le.sibling;var ct=J(Y,Le,X[ze],oe);if(ct===null){Le===null&&(Le=nn);break}e&&Le&&ct.alternate===null&&n(Y,Le),j=p(ct,j,ze),rt===null?De=ct:rt.sibling=ct,rt=ct,Le=nn}if(ze===X.length)return s(Y,Le),pt&&fi(Y,ze),De;if(Le===null){for(;ze<X.length;ze++)Le=he(Y,X[ze],oe),Le!==null&&(j=p(Le,j,ze),rt===null?De=Le:rt.sibling=Le,rt=Le);return pt&&fi(Y,ze),De}for(Le=o(Le);ze<X.length;ze++)nn=ee(Le,Y,ze,X[ze],oe),nn!==null&&(e&&nn.alternate!==null&&Le.delete(nn.key===null?ze:nn.key),j=p(nn,j,ze),rt===null?De=nn:rt.sibling=nn,rt=nn);return e&&Le.forEach(function(Hr){return n(Y,Hr)}),pt&&fi(Y,ze),De}function Pe(Y,j,X,oe){if(X==null)throw Error(i(151));for(var De=null,rt=null,Le=j,ze=j=0,nn=null,ct=X.next();Le!==null&&!ct.done;ze++,ct=X.next()){Le.index>ze?(nn=Le,Le=null):nn=Le.sibling;var Hr=J(Y,Le,ct.value,oe);if(Hr===null){Le===null&&(Le=nn);break}e&&Le&&Hr.alternate===null&&n(Y,Le),j=p(Hr,j,ze),rt===null?De=Hr:rt.sibling=Hr,rt=Hr,Le=nn}if(ct.done)return s(Y,Le),pt&&fi(Y,ze),De;if(Le===null){for(;!ct.done;ze++,ct=X.next())ct=he(Y,ct.value,oe),ct!==null&&(j=p(ct,j,ze),rt===null?De=ct:rt.sibling=ct,rt=ct);return pt&&fi(Y,ze),De}for(Le=o(Le);!ct.done;ze++,ct=X.next())ct=ee(Le,Y,ze,ct.value,oe),ct!==null&&(e&&ct.alternate!==null&&Le.delete(ct.key===null?ze:ct.key),j=p(ct,j,ze),rt===null?De=ct:rt.sibling=ct,rt=ct);return e&&Le.forEach(function(dv){return n(Y,dv)}),pt&&fi(Y,ze),De}function St(Y,j,X,oe){if(typeof X=="object"&&X!==null&&X.type===S&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case y:e:{for(var De=X.key;j!==null;){if(j.key===De){if(De=X.type,De===S){if(j.tag===7){s(Y,j.sibling),oe=c(j,X.props.children),oe.return=Y,Y=oe;break e}}else if(j.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===de&&np(De)===j.type){s(Y,j.sibling),oe=c(j,X.props),qs(oe,X),oe.return=Y,Y=oe;break e}s(Y,j);break}else n(Y,j);j=j.sibling}X.type===S?(oe=ui(X.props.children,Y.mode,oe,X.key),oe.return=Y,Y=oe):(oe=Pl(X.type,X.key,X.props,null,Y.mode,oe),qs(oe,X),oe.return=Y,Y=oe)}return b(Y);case E:e:{for(De=X.key;j!==null;){if(j.key===De)if(j.tag===4&&j.stateNode.containerInfo===X.containerInfo&&j.stateNode.implementation===X.implementation){s(Y,j.sibling),oe=c(j,X.children||[]),oe.return=Y,Y=oe;break e}else{s(Y,j);break}else n(Y,j);j=j.sibling}oe=yu(X,Y.mode,oe),oe.return=Y,Y=oe}return b(Y);case de:return De=X._init,X=De(X._payload),St(Y,j,X,oe)}if(W(X))return Ye(Y,j,X,oe);if(z(X)){if(De=z(X),typeof De!="function")throw Error(i(150));return X=De.call(X),Pe(Y,j,X,oe)}if(typeof X.then=="function")return St(Y,j,ao(X),oe);if(X.$$typeof===C)return St(Y,j,Yl(Y,X),oe);ro(Y,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,j!==null&&j.tag===6?(s(Y,j.sibling),oe=c(j,X),oe.return=Y,Y=oe):(s(Y,j),oe=vu(X,Y.mode,oe),oe.return=Y,Y=oe),b(Y)):s(Y,j)}return function(Y,j,X,oe){try{Ys=0;var De=St(Y,j,X,oe);return Vi=null,De}catch(Le){if(Le===Us||Le===Vl)throw Le;var rt=Rn(29,Le,null,Y.mode);return rt.lanes=oe,rt.return=Y,rt}}}var Xi=ap(!0),rp=ap(!1),Kn=G(null),La=null;function Nr(e){var n=e.alternate;ve(Zt,Zt.current&1),ve(Kn,e),La===null&&(n===null||zi.current!==null||n.memoizedState!==null)&&(La=e)}function ip(e){if(e.tag===22){if(ve(Zt,Zt.current),ve(Kn,e),La===null){var n=e.alternate;n!==null&&n.memoizedState!==null&&(La=e)}}else Rr()}function Rr(){ve(Zt,Zt.current),ve(Kn,Kn.current)}function er(e){ie(Kn),La===e&&(La=null),ie(Zt)}var Zt=G(0);function io(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||Pc(s)))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}function Ku(e,n,s,o){n=e.memoizedState,s=s(o,n),s=s==null?n:v({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Wu={enqueueSetState:function(e,n,s){e=e._reactInternals;var o=kn(),c=Tr(o);c.payload=n,s!=null&&(c.callback=s),n=Cr(e,c,o),n!==null&&(Ln(n,e,o),Bs(n,e,o))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var o=kn(),c=Tr(o);c.tag=1,c.payload=n,s!=null&&(c.callback=s),n=Cr(e,c,o),n!==null&&(Ln(n,e,o),Bs(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=kn(),o=Tr(s);o.tag=2,n!=null&&(o.callback=n),n=Cr(e,o,s),n!==null&&(Ln(n,e,s),Bs(n,e,s))}};function sp(e,n,s,o,c,p,b){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,p,b):n.prototype&&n.prototype.isPureReactComponent?!Ms(s,o)||!Ms(c,p):!0}function lp(e,n,s,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,o),n.state!==e&&Wu.enqueueReplaceState(n,n.state,null)}function yi(e,n){var s=n;if("ref"in n){s={};for(var o in n)o!=="ref"&&(s[o]=n[o])}if(e=e.defaultProps){s===n&&(s=v({},s));for(var c in e)s[c]===void 0&&(s[c]=e[c])}return s}var so=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function op(e){so(e)}function up(e){console.error(e)}function cp(e){so(e)}function lo(e,n){try{var s=e.onUncaughtError;s(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function fp(e,n,s){try{var o=e.onCaughtError;o(s.value,{componentStack:s.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function Ju(e,n,s){return s=Tr(s),s.tag=3,s.payload={element:null},s.callback=function(){lo(e,n)},s}function dp(e){return e=Tr(e),e.tag=3,e}function pp(e,n,s,o){var c=s.type.getDerivedStateFromError;if(typeof c=="function"){var p=o.value;e.payload=function(){return c(p)},e.callback=function(){fp(n,s,o)}}var b=s.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(e.callback=function(){fp(n,s,o),typeof c!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var A=o.stack;this.componentDidCatch(o.value,{componentStack:A!==null?A:""})})}function dg(e,n,s,o,c){if(s.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=s.alternate,n!==null&&Os(n,s,c,!0),s=Kn.current,s!==null){switch(s.tag){case 13:return La===null?Ac():s.alternate===null&&Ut===0&&(Ut=3),s.flags&=-257,s.flags|=65536,s.lanes=c,o===Nu?s.flags|=16384:(n=s.updateQueue,n===null?s.updateQueue=new Set([o]):n.add(o),Tc(e,o,c)),!1;case 22:return s.flags|=65536,o===Nu?s.flags|=16384:(n=s.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},s.updateQueue=n):(s=n.retryQueue,s===null?n.retryQueue=new Set([o]):s.add(o)),Tc(e,o,c)),!1}throw Error(i(435,s.tag))}return Tc(e,o,c),Ac(),!1}if(pt)return n=Kn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=c,o!==Su&&(e=Error(i(422),{cause:o}),_s(Xn(e,s)))):(o!==Su&&(n=Error(i(423),{cause:o}),_s(Xn(n,s))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,o=Xn(o,s),c=Ju(e.stateNode,o,c),_u(e,c),Ut!==4&&(Ut=2)),!1;var p=Error(i(520),{cause:o});if(p=Xn(p,s),Ws===null?Ws=[p]:Ws.push(p),Ut!==4&&(Ut=2),n===null)return!0;o=Xn(o,s),s=n;do{switch(s.tag){case 3:return s.flags|=65536,e=c&-c,s.lanes|=e,e=Ju(s.stateNode,o,e),_u(s,e),!1;case 1:if(n=s.type,p=s.stateNode,(s.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Ur===null||!Ur.has(p))))return s.flags|=65536,c&=-c,s.lanes|=c,c=dp(c),pp(c,e,s,o),_u(s,c),!1}s=s.return}while(s!==null);return!1}var hp=Error(i(461)),en=!1;function ln(e,n,s,o){n.child=e===null?rp(n,null,s,o):Xi(n,e.child,s,o)}function mp(e,n,s,o,c){s=s.render;var p=n.ref;if("ref"in o){var b={};for(var A in o)A!=="ref"&&(b[A]=o[A])}else b=o;return mi(n),o=Iu(e,n,s,b,p,c),A=Bu(),e!==null&&!en?(Fu(e,n,c),tr(e,n,c)):(pt&&A&&bu(n),n.flags|=1,ln(e,n,o,c),n.child)}function gp(e,n,s,o,c){if(e===null){var p=s.type;return typeof p=="function"&&!gu(p)&&p.defaultProps===void 0&&s.compare===null?(n.tag=15,n.type=p,vp(e,n,p,o,c)):(e=Pl(s.type,null,o,n,n.mode,c),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!lc(e,c)){var b=p.memoizedProps;if(s=s.compare,s=s!==null?s:Ms,s(b,o)&&e.ref===n.ref)return tr(e,n,c)}return n.flags|=1,e=Za(p,o),e.ref=n.ref,e.return=n,n.child=e}function vp(e,n,s,o,c){if(e!==null){var p=e.memoizedProps;if(Ms(p,o)&&e.ref===n.ref)if(en=!1,n.pendingProps=o=p,lc(e,c))(e.flags&131072)!==0&&(en=!0);else return n.lanes=e.lanes,tr(e,n,c)}return ec(e,n,s,o,c)}function yp(e,n,s){var o=n.pendingProps,c=o.children,p=e!==null?e.memoizedState:null;if(o.mode==="hidden"){if((n.flags&128)!==0){if(o=p!==null?p.baseLanes|s:s,e!==null){for(c=n.child=e.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;n.childLanes=p&~o}else n.childLanes=0,n.child=null;return bp(e,n,o,s)}if((s&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&ql(n,p!==null?p.cachePool:null),p!==null?vd(n,p):ku(),ip(n);else return n.lanes=n.childLanes=536870912,bp(e,n,p!==null?p.baseLanes|s:s,s)}else p!==null?(ql(n,p.cachePool),vd(n,p),Rr(),n.memoizedState=null):(e!==null&&ql(n,null),ku(),Rr());return ln(e,n,c,s),n.child}function bp(e,n,s,o){var c=Mu();return c=c===null?null:{parent:Xt._currentValue,pool:c},n.memoizedState={baseLanes:s,cachePool:c},e!==null&&ql(n,null),ku(),ip(n),e!==null&&Os(e,n,o,!0),null}function oo(e,n){var s=n.ref;if(s===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(i(284));(e===null||e.ref!==s)&&(n.flags|=4194816)}}function ec(e,n,s,o,c){return mi(n),s=Iu(e,n,s,o,void 0,c),o=Bu(),e!==null&&!en?(Fu(e,n,c),tr(e,n,c)):(pt&&o&&bu(n),n.flags|=1,ln(e,n,s,c),n.child)}function xp(e,n,s,o,c,p){return mi(n),n.updateQueue=null,s=bd(n,o,s,c),yd(e),o=Bu(),e!==null&&!en?(Fu(e,n,p),tr(e,n,p)):(pt&&o&&bu(n),n.flags|=1,ln(e,n,s,p),n.child)}function Sp(e,n,s,o,c){if(mi(n),n.stateNode===null){var p=Bi,b=s.contextType;typeof b=="object"&&b!==null&&(p=fn(b)),p=new s(o,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Wu,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=o,p.state=n.memoizedState,p.refs={},Ru(n),b=s.contextType,p.context=typeof b=="object"&&b!==null?fn(b):Bi,p.state=n.memoizedState,b=s.getDerivedStateFromProps,typeof b=="function"&&(Ku(n,s,b,o),p.state=n.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&Wu.enqueueReplaceState(p,p.state,null),js(n,o,p,c),Fs(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){p=n.stateNode;var A=n.memoizedProps,L=yi(s,A);p.props=L;var K=p.context,se=s.contextType;b=Bi,typeof se=="object"&&se!==null&&(b=fn(se));var he=s.getDerivedStateFromProps;se=typeof he=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=n.pendingProps!==A,se||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||K!==b)&&lp(n,p,o,b),wr=!1;var J=n.memoizedState;p.state=J,js(n,o,p,c),Fs(),K=n.memoizedState,A||J!==K||wr?(typeof he=="function"&&(Ku(n,s,he,o),K=n.memoizedState),(L=wr||sp(n,s,L,o,J,K,b))?(se||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=K),p.props=o,p.state=K,p.context=b,o=L):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{p=n.stateNode,Du(e,n),b=n.memoizedProps,se=yi(s,b),p.props=se,he=n.pendingProps,J=p.context,K=s.contextType,L=Bi,typeof K=="object"&&K!==null&&(L=fn(K)),A=s.getDerivedStateFromProps,(K=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==he||J!==L)&&lp(n,p,o,L),wr=!1,J=n.memoizedState,p.state=J,js(n,o,p,c),Fs();var ee=n.memoizedState;b!==he||J!==ee||wr||e!==null&&e.dependencies!==null&&Hl(e.dependencies)?(typeof A=="function"&&(Ku(n,s,A,o),ee=n.memoizedState),(se=wr||sp(n,s,se,o,J,ee,L)||e!==null&&e.dependencies!==null&&Hl(e.dependencies))?(K||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,ee,L),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,ee,L)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===e.memoizedProps&&J===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&J===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=ee),p.props=o,p.state=ee,p.context=L,o=se):(typeof p.componentDidUpdate!="function"||b===e.memoizedProps&&J===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&J===e.memoizedState||(n.flags|=1024),o=!1)}return p=o,oo(e,n),o=(n.flags&128)!==0,p||o?(p=n.stateNode,s=o&&typeof s.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&o?(n.child=Xi(n,e.child,null,c),n.child=Xi(n,null,s,c)):ln(e,n,s,c),n.memoizedState=p.state,e=n.child):e=tr(e,n,c),e}function Ep(e,n,s,o){return Ds(),n.flags|=256,ln(e,n,s,o),n.child}var tc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nc(e){return{baseLanes:e,cachePool:ud()}}function ac(e,n,s){return e=e!==null?e.childLanes&~s:0,n&&(e|=Wn),e}function Ap(e,n,s){var o=n.pendingProps,c=!1,p=(n.flags&128)!==0,b;if((b=p)||(b=e!==null&&e.memoizedState===null?!1:(Zt.current&2)!==0),b&&(c=!0,n.flags&=-129),b=(n.flags&32)!==0,n.flags&=-33,e===null){if(pt){if(c?Nr(n):Rr(),pt){var A=Lt,L;if(L=A){e:{for(L=A,A=ka;L.nodeType!==8;){if(!A){A=null;break e}if(L=va(L.nextSibling),L===null){A=null;break e}}A=L}A!==null?(n.memoizedState={dehydrated:A,treeContext:ci!==null?{id:Qa,overflow:$a}:null,retryLane:536870912,hydrationErrors:null},L=Rn(18,null,null,0),L.stateNode=A,L.return=n,n.child=L,hn=n,Lt=null,L=!0):L=!1}L||pi(n)}if(A=n.memoizedState,A!==null&&(A=A.dehydrated,A!==null))return Pc(A)?n.lanes=32:n.lanes=536870912,null;er(n)}return A=o.children,o=o.fallback,c?(Rr(),c=n.mode,A=uo({mode:"hidden",children:A},c),o=ui(o,c,s,null),A.return=n,o.return=n,A.sibling=o,n.child=A,c=n.child,c.memoizedState=nc(s),c.childLanes=ac(e,b,s),n.memoizedState=tc,o):(Nr(n),rc(n,A))}if(L=e.memoizedState,L!==null&&(A=L.dehydrated,A!==null)){if(p)n.flags&256?(Nr(n),n.flags&=-257,n=ic(e,n,s)):n.memoizedState!==null?(Rr(),n.child=e.child,n.flags|=128,n=null):(Rr(),c=o.fallback,A=n.mode,o=uo({mode:"visible",children:o.children},A),c=ui(c,A,s,null),c.flags|=2,o.return=n,c.return=n,o.sibling=c,n.child=o,Xi(n,e.child,null,s),o=n.child,o.memoizedState=nc(s),o.childLanes=ac(e,b,s),n.memoizedState=tc,n=c);else if(Nr(n),Pc(A)){if(b=A.nextSibling&&A.nextSibling.dataset,b)var K=b.dgst;b=K,o=Error(i(419)),o.stack="",o.digest=b,_s({value:o,source:null,stack:null}),n=ic(e,n,s)}else if(en||Os(e,n,s,!1),b=(s&e.childLanes)!==0,en||b){if(b=At,b!==null&&(o=s&-s,o=(o&42)!==0?1:Gn(o),o=(o&(b.suspendedLanes|s))!==0?0:o,o!==0&&o!==L.retryLane))throw L.retryLane=o,Ii(e,o),Ln(b,e,o),hp;A.data==="$?"||Ac(),n=ic(e,n,s)}else A.data==="$?"?(n.flags|=192,n.child=e.child,n=null):(e=L.treeContext,Lt=va(A.nextSibling),hn=n,pt=!0,di=null,ka=!1,e!==null&&(Qn[$n++]=Qa,Qn[$n++]=$a,Qn[$n++]=ci,Qa=e.id,$a=e.overflow,ci=n),n=rc(n,o.children),n.flags|=4096);return n}return c?(Rr(),c=o.fallback,A=n.mode,L=e.child,K=L.sibling,o=Za(L,{mode:"hidden",children:o.children}),o.subtreeFlags=L.subtreeFlags&65011712,K!==null?c=Za(K,c):(c=ui(c,A,s,null),c.flags|=2),c.return=n,o.return=n,o.sibling=c,n.child=o,o=c,c=n.child,A=e.child.memoizedState,A===null?A=nc(s):(L=A.cachePool,L!==null?(K=Xt._currentValue,L=L.parent!==K?{parent:K,pool:K}:L):L=ud(),A={baseLanes:A.baseLanes|s,cachePool:L}),c.memoizedState=A,c.childLanes=ac(e,b,s),n.memoizedState=tc,o):(Nr(n),s=e.child,e=s.sibling,s=Za(s,{mode:"visible",children:o.children}),s.return=n,s.sibling=null,e!==null&&(b=n.deletions,b===null?(n.deletions=[e],n.flags|=16):b.push(e)),n.child=s,n.memoizedState=null,s)}function rc(e,n){return n=uo({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function uo(e,n){return e=Rn(22,e,null,n),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function ic(e,n,s){return Xi(n,e.child,null,s),e=rc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function wp(e,n,s){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),Au(e.return,n,s)}function sc(e,n,s,o,c){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:s,tailMode:c}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=o,p.tail=s,p.tailMode=c)}function Tp(e,n,s){var o=n.pendingProps,c=o.revealOrder,p=o.tail;if(ln(e,n,o.children,s),o=Zt.current,(o&2)!==0)o=o&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wp(e,s,n);else if(e.tag===19)wp(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}switch(ve(Zt,o),c){case"forwards":for(s=n.child,c=null;s!==null;)e=s.alternate,e!==null&&io(e)===null&&(c=s),s=s.sibling;s=c,s===null?(c=n.child,n.child=null):(c=s.sibling,s.sibling=null),sc(n,!1,c,s,p);break;case"backwards":for(s=null,c=n.child,n.child=null;c!==null;){if(e=c.alternate,e!==null&&io(e)===null){n.child=c;break}e=c.sibling,c.sibling=s,s=c,c=e}sc(n,!0,s,null,p);break;case"together":sc(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function tr(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),Lr|=n.lanes,(s&n.childLanes)===0)if(e!==null){if(Os(e,n,s,!1),(s&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(i(153));if(n.child!==null){for(e=n.child,s=Za(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=Za(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function lc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Hl(e)))}function pg(e,n,s){switch(n.tag){case 3:ke(n,n.stateNode.containerInfo),Ar(n,Xt,e.memoizedState.cache),Ds();break;case 27:case 5:$t(n);break;case 4:ke(n,n.stateNode.containerInfo);break;case 10:Ar(n,n.type,n.memoizedProps.value);break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(Nr(n),n.flags|=128,null):(s&n.child.childLanes)!==0?Ap(e,n,s):(Nr(n),e=tr(e,n,s),e!==null?e.sibling:null);Nr(n);break;case 19:var c=(e.flags&128)!==0;if(o=(s&n.childLanes)!==0,o||(Os(e,n,s,!1),o=(s&n.childLanes)!==0),c){if(o)return Tp(e,n,s);n.flags|=128}if(c=n.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),ve(Zt,Zt.current),o)break;return null;case 22:case 23:return n.lanes=0,yp(e,n,s);case 24:Ar(n,Xt,e.memoizedState.cache)}return tr(e,n,s)}function Cp(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps)en=!0;else{if(!lc(e,s)&&(n.flags&128)===0)return en=!1,pg(e,n,s);en=(e.flags&131072)!==0}else en=!1,pt&&(n.flags&1048576)!==0&&nd(n,zl,n.index);switch(n.lanes=0,n.tag){case 16:e:{e=n.pendingProps;var o=n.elementType,c=o._init;if(o=c(o._payload),n.type=o,typeof o=="function")gu(o)?(e=yi(o,e),n.tag=1,n=Sp(null,n,o,e,s)):(n.tag=0,n=ec(null,n,o,e,s));else{if(o!=null){if(c=o.$$typeof,c===M){n.tag=11,n=mp(null,n,o,e,s);break e}else if(c===fe){n.tag=14,n=gp(null,n,o,e,s);break e}}throw n=$(o)||o,Error(i(306,n,""))}}return n;case 0:return ec(e,n,n.type,n.pendingProps,s);case 1:return o=n.type,c=yi(o,n.pendingProps),Sp(e,n,o,c,s);case 3:e:{if(ke(n,n.stateNode.containerInfo),e===null)throw Error(i(387));o=n.pendingProps;var p=n.memoizedState;c=p.element,Du(e,n),js(n,o,null,s);var b=n.memoizedState;if(o=b.cache,Ar(n,Xt,o),o!==p.cache&&wu(n,[Xt],s,!0),Fs(),o=b.element,p.isDehydrated)if(p={element:o,isDehydrated:!1,cache:b.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=Ep(e,n,o,s);break e}else if(o!==c){c=Xn(Error(i(424)),n),_s(c),n=Ep(e,n,o,s);break e}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Lt=va(e.firstChild),hn=n,pt=!0,di=null,ka=!0,s=rp(n,null,o,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ds(),o===c){n=tr(e,n,s);break e}ln(e,n,o,s)}n=n.child}return n;case 26:return oo(e,n),e===null?(s=Dh(n.type,null,n.pendingProps,null))?n.memoizedState=s:pt||(s=n.type,e=n.pendingProps,o=wo(Ee.current).createElement(s),o[mt]=n,o[Dt]=e,un(o,s,e),Ft(o),n.stateNode=o):n.memoizedState=Dh(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return $t(n),e===null&&pt&&(o=n.stateNode=Mh(n.type,n.pendingProps,Ee.current),hn=n,ka=!0,c=Lt,Fr(n.type)?(Gc=c,Lt=va(o.firstChild)):Lt=c),ln(e,n,n.pendingProps.children,s),oo(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&pt&&((c=o=Lt)&&(o=Gg(o,n.type,n.pendingProps,ka),o!==null?(n.stateNode=o,hn=n,Lt=va(o.firstChild),ka=!1,c=!0):c=!1),c||pi(n)),$t(n),c=n.type,p=n.pendingProps,b=e!==null?e.memoizedProps:null,o=p.children,Bc(c,p)?o=null:b!==null&&Bc(c,b)&&(n.flags|=32),n.memoizedState!==null&&(c=Iu(e,n,ig,null,null,s),ll._currentValue=c),oo(e,n),ln(e,n,o,s),n.child;case 6:return e===null&&pt&&((e=s=Lt)&&(s=zg(s,n.pendingProps,ka),s!==null?(n.stateNode=s,hn=n,Lt=null,e=!0):e=!1),e||pi(n)),null;case 13:return Ap(e,n,s);case 4:return ke(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=Xi(n,null,o,s):ln(e,n,o,s),n.child;case 11:return mp(e,n,n.type,n.pendingProps,s);case 7:return ln(e,n,n.pendingProps,s),n.child;case 8:return ln(e,n,n.pendingProps.children,s),n.child;case 12:return ln(e,n,n.pendingProps.children,s),n.child;case 10:return o=n.pendingProps,Ar(n,n.type,o.value),ln(e,n,o.children,s),n.child;case 9:return c=n.type._context,o=n.pendingProps.children,mi(n),c=fn(c),o=o(c),n.flags|=1,ln(e,n,o,s),n.child;case 14:return gp(e,n,n.type,n.pendingProps,s);case 15:return vp(e,n,n.type,n.pendingProps,s);case 19:return Tp(e,n,s);case 31:return o=n.pendingProps,s=n.mode,o={mode:o.mode,children:o.children},e===null?(s=uo(o,s),s.ref=n.ref,n.child=s,s.return=n,n=s):(s=Za(e.child,o),s.ref=n.ref,n.child=s,s.return=n,n=s),n;case 22:return yp(e,n,s);case 24:return mi(n),o=fn(Xt),e===null?(c=Mu(),c===null&&(c=At,p=Tu(),c.pooledCache=p,p.refCount++,p!==null&&(c.pooledCacheLanes|=s),c=p),n.memoizedState={parent:o,cache:c},Ru(n),Ar(n,Xt,c)):((e.lanes&s)!==0&&(Du(e,n),js(n,null,null,s),Fs()),c=e.memoizedState,p=n.memoizedState,c.parent!==o?(c={parent:o,cache:o},n.memoizedState=c,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=c),Ar(n,Xt,o)):(o=p.cache,Ar(n,Xt,o),o!==c.cache&&wu(n,[Xt],s,!0))),ln(e,n,n.pendingProps.children,s),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function nr(e){e.flags|=4}function Mp(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Uh(n)){if(n=Kn.current,n!==null&&((ot&4194048)===ot?La!==null:(ot&62914560)!==ot&&(ot&536870912)===0||n!==La))throw Is=Nu,cd;e.flags|=8192}}function co(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Pa():536870912,e.lanes|=n,Ki|=n)}function Vs(e,n){if(!pt)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Rt(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,o=0;if(n)for(var c=e.child;c!==null;)s|=c.lanes|c.childLanes,o|=c.subtreeFlags&65011712,o|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)s|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=o,e.childLanes=s,n}function hg(e,n,s){var o=n.pendingProps;switch(xu(n),n.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(n),null;case 1:return Rt(n),null;case 3:return s=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),Wa(Xt),at(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Rs(n)?nr(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,id())),Rt(n),null;case 26:return s=n.memoizedState,e===null?(nr(n),s!==null?(Rt(n),Mp(n,s)):(Rt(n),n.flags&=-16777217)):s?s!==e.memoizedState?(nr(n),Rt(n),Mp(n,s)):(Rt(n),n.flags&=-16777217):(e.memoizedProps!==o&&nr(n),Rt(n),n.flags&=-16777217),null;case 27:Be(n),s=Ee.current;var c=n.type;if(e!==null&&n.stateNode!=null)e.memoizedProps!==o&&nr(n);else{if(!o){if(n.stateNode===null)throw Error(i(166));return Rt(n),null}e=te.current,Rs(n)?ad(n):(e=Mh(c,o,s),n.stateNode=e,nr(n))}return Rt(n),null;case 5:if(Be(n),s=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&nr(n);else{if(!o){if(n.stateNode===null)throw Error(i(166));return Rt(n),null}if(e=te.current,Rs(n))ad(n);else{switch(c=wo(Ee.current),e){case 1:e=c.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:e=c.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":e=c.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":e=c.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof o.is=="string"?c.createElement("select",{is:o.is}):c.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e=typeof o.is=="string"?c.createElement(s,{is:o.is}):c.createElement(s)}}e[mt]=n,e[Dt]=o;e:for(c=n.child;c!==null;){if(c.tag===5||c.tag===6)e.appendChild(c.stateNode);else if(c.tag!==4&&c.tag!==27&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===n)break e;for(;c.sibling===null;){if(c.return===null||c.return===n)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}n.stateNode=e;e:switch(un(e,s,o),s){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&nr(n)}}return Rt(n),n.flags&=-16777217,null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&nr(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(i(166));if(e=Ee.current,Rs(n)){if(e=n.stateNode,s=n.memoizedProps,o=null,c=hn,c!==null)switch(c.tag){case 27:case 5:o=c.memoizedProps}e[mt]=n,e=!!(e.nodeValue===s||o!==null&&o.suppressHydrationWarning===!0||xh(e.nodeValue,s)),e||pi(n)}else e=wo(e).createTextNode(o),e[mt]=n,n.stateNode=e}return Rt(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Rs(n),o!==null&&o.dehydrated!==null){if(e===null){if(!c)throw Error(i(318));if(c=n.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));c[mt]=n}else Ds(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Rt(n),c=!1}else c=id(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return n.flags&256?(er(n),n):(er(n),null)}if(er(n),(n.flags&128)!==0)return n.lanes=s,n;if(s=o!==null,e=e!==null&&e.memoizedState!==null,s){o=n.child,c=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(c=o.alternate.memoizedState.cachePool.pool);var p=null;o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==c&&(o.flags|=2048)}return s!==e&&s&&(n.child.flags|=8192),co(n,n.updateQueue),Rt(n),null;case 4:return at(),e===null&&Oc(n.stateNode.containerInfo),Rt(n),null;case 10:return Wa(n.type),Rt(n),null;case 19:if(ie(Zt),c=n.memoizedState,c===null)return Rt(n),null;if(o=(n.flags&128)!==0,p=c.rendering,p===null)if(o)Vs(c,!1);else{if(Ut!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(p=io(e),p!==null){for(n.flags|=128,Vs(c,!1),e=p.updateQueue,n.updateQueue=e,co(n,e),n.subtreeFlags=0,e=s,s=n.child;s!==null;)td(s,e),s=s.sibling;return ve(Zt,Zt.current&1|2),n.child}e=e.sibling}c.tail!==null&&Te()>ho&&(n.flags|=128,o=!0,Vs(c,!1),n.lanes=4194304)}else{if(!o)if(e=io(p),e!==null){if(n.flags|=128,o=!0,e=e.updateQueue,n.updateQueue=e,co(n,e),Vs(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!pt)return Rt(n),null}else 2*Te()-c.renderingStartTime>ho&&s!==536870912&&(n.flags|=128,o=!0,Vs(c,!1),n.lanes=4194304);c.isBackwards?(p.sibling=n.child,n.child=p):(e=c.last,e!==null?e.sibling=p:n.child=p,c.last=p)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=Te(),n.sibling=null,e=Zt.current,ve(Zt,o?e&1|2:e&1),n):(Rt(n),null);case 22:case 23:return er(n),Lu(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(s&536870912)!==0&&(n.flags&128)===0&&(Rt(n),n.subtreeFlags&6&&(n.flags|=8192)):Rt(n),s=n.updateQueue,s!==null&&co(n,s.retryQueue),s=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==s&&(n.flags|=2048),e!==null&&ie(gi),null;case 24:return s=null,e!==null&&(s=e.memoizedState.cache),n.memoizedState.cache!==s&&(n.flags|=2048),Wa(Xt),Rt(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function mg(e,n){switch(xu(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Wa(Xt),at(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Be(n),null;case 13:if(er(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Ds()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return ie(Zt),null;case 4:return at(),null;case 10:return Wa(n.type),null;case 22:case 23:return er(n),Lu(),e!==null&&ie(gi),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Wa(Xt),null;case 25:return null;default:return null}}function Np(e,n){switch(xu(n),n.tag){case 3:Wa(Xt),at();break;case 26:case 27:case 5:Be(n);break;case 4:at();break;case 13:er(n);break;case 19:ie(Zt);break;case 10:Wa(n.type);break;case 22:case 23:er(n),Lu(),e!==null&&ie(gi);break;case 24:Wa(Xt)}}function Xs(e,n){try{var s=n.updateQueue,o=s!==null?s.lastEffect:null;if(o!==null){var c=o.next;s=c;do{if((s.tag&e)===e){o=void 0;var p=s.create,b=s.inst;o=p(),b.destroy=o}s=s.next}while(s!==c)}}catch(A){Et(n,n.return,A)}}function Dr(e,n,s){try{var o=n.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var p=c.next;o=p;do{if((o.tag&e)===e){var b=o.inst,A=b.destroy;if(A!==void 0){b.destroy=void 0,c=n;var L=s,K=A;try{K()}catch(se){Et(c,L,se)}}}o=o.next}while(o!==p)}}catch(se){Et(n,n.return,se)}}function Rp(e){var n=e.updateQueue;if(n!==null){var s=e.stateNode;try{gd(n,s)}catch(o){Et(e,e.return,o)}}}function Dp(e,n,s){s.props=yi(e.type,e.memoizedProps),s.state=e.memoizedState;try{s.componentWillUnmount()}catch(o){Et(e,n,o)}}function Zs(e,n){try{var s=e.ref;if(s!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof s=="function"?e.refCleanup=s(o):s.current=o}}catch(c){Et(e,n,c)}}function Ua(e,n){var s=e.ref,o=e.refCleanup;if(s!==null)if(typeof o=="function")try{o()}catch(c){Et(e,n,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(c){Et(e,n,c)}else s.current=null}function _p(e){var n=e.type,s=e.memoizedProps,o=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":s.autoFocus&&o.focus();break e;case"img":s.src?o.src=s.src:s.srcSet&&(o.srcset=s.srcSet)}}catch(c){Et(e,e.return,c)}}function oc(e,n,s){try{var o=e.stateNode;Ig(o,e.type,s,n),o[Dt]=n}catch(c){Et(e,e.return,c)}}function Op(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Fr(e.type)||e.tag===4}function uc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Op(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Fr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cc(e,n,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(e,n):(n=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,n.appendChild(e),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=Ao));else if(o!==4&&(o===27&&Fr(e.type)&&(s=e.stateNode,n=null),e=e.child,e!==null))for(cc(e,n,s),e=e.sibling;e!==null;)cc(e,n,s),e=e.sibling}function fo(e,n,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(o!==4&&(o===27&&Fr(e.type)&&(s=e.stateNode),e=e.child,e!==null))for(fo(e,n,s),e=e.sibling;e!==null;)fo(e,n,s),e=e.sibling}function kp(e){var n=e.stateNode,s=e.memoizedProps;try{for(var o=e.type,c=n.attributes;c.length;)n.removeAttributeNode(c[0]);un(n,o,s),n[mt]=e,n[Dt]=s}catch(p){Et(e,e.return,p)}}var ar=!1,Pt=!1,fc=!1,Lp=typeof WeakSet=="function"?WeakSet:Set,tn=null;function gg(e,n){if(e=e.containerInfo,Uc=Do,e=qf(e),uu(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var o=s.getSelection&&s.getSelection();if(o&&o.rangeCount!==0){s=o.anchorNode;var c=o.anchorOffset,p=o.focusNode;o=o.focusOffset;try{s.nodeType,p.nodeType}catch{s=null;break e}var b=0,A=-1,L=-1,K=0,se=0,he=e,J=null;t:for(;;){for(var ee;he!==s||c!==0&&he.nodeType!==3||(A=b+c),he!==p||o!==0&&he.nodeType!==3||(L=b+o),he.nodeType===3&&(b+=he.nodeValue.length),(ee=he.firstChild)!==null;)J=he,he=ee;for(;;){if(he===e)break t;if(J===s&&++K===c&&(A=b),J===p&&++se===o&&(L=b),(ee=he.nextSibling)!==null)break;he=J,J=he.parentNode}he=ee}s=A===-1||L===-1?null:{start:A,end:L}}else s=null}s=s||{start:0,end:0}}else s=null;for(Ic={focusedElem:e,selectionRange:s},Do=!1,tn=n;tn!==null;)if(n=tn,e=n.child,(n.subtreeFlags&1024)!==0&&e!==null)e.return=n,tn=e;else for(;tn!==null;){switch(n=tn,p=n.alternate,e=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,s=n,c=p.memoizedProps,p=p.memoizedState,o=s.stateNode;try{var Ye=yi(s.type,c,s.elementType===s.type);e=o.getSnapshotBeforeUpdate(Ye,p),o.__reactInternalSnapshotBeforeUpdate=e}catch(Pe){Et(s,s.return,Pe)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,s=e.nodeType,s===9)jc(e);else if(s===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":jc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=n.sibling,e!==null){e.return=n.return,tn=e;break}tn=n.return}}function Up(e,n,s){var o=s.flags;switch(s.tag){case 0:case 11:case 15:_r(e,s),o&4&&Xs(5,s);break;case 1:if(_r(e,s),o&4)if(e=s.stateNode,n===null)try{e.componentDidMount()}catch(b){Et(s,s.return,b)}else{var c=yi(s.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(c,n,e.__reactInternalSnapshotBeforeUpdate)}catch(b){Et(s,s.return,b)}}o&64&&Rp(s),o&512&&Zs(s,s.return);break;case 3:if(_r(e,s),o&64&&(e=s.updateQueue,e!==null)){if(n=null,s.child!==null)switch(s.child.tag){case 27:case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}try{gd(e,n)}catch(b){Et(s,s.return,b)}}break;case 27:n===null&&o&4&&kp(s);case 26:case 5:_r(e,s),n===null&&o&4&&_p(s),o&512&&Zs(s,s.return);break;case 12:_r(e,s);break;case 13:_r(e,s),o&4&&Fp(e,s),o&64&&(e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(s=Tg.bind(null,s),Hg(e,s))));break;case 22:if(o=s.memoizedState!==null||ar,!o){n=n!==null&&n.memoizedState!==null||Pt,c=ar;var p=Pt;ar=o,(Pt=n)&&!p?Or(e,s,(s.subtreeFlags&8772)!==0):_r(e,s),ar=c,Pt=p}break;case 30:break;default:_r(e,s)}}function Ip(e){var n=e.alternate;n!==null&&(e.alternate=null,Ip(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Mi(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Mt=null,An=!1;function rr(e,n,s){for(s=s.child;s!==null;)Bp(e,n,s),s=s.sibling}function Bp(e,n,s){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Aa,s)}catch{}switch(s.tag){case 26:Pt||Ua(s,n),rr(e,n,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:Pt||Ua(s,n);var o=Mt,c=An;Fr(s.type)&&(Mt=s.stateNode,An=!1),rr(e,n,s),al(s.stateNode),Mt=o,An=c;break;case 5:Pt||Ua(s,n);case 6:if(o=Mt,c=An,Mt=null,rr(e,n,s),Mt=o,An=c,Mt!==null)if(An)try{(Mt.nodeType===9?Mt.body:Mt.nodeName==="HTML"?Mt.ownerDocument.body:Mt).removeChild(s.stateNode)}catch(p){Et(s,n,p)}else try{Mt.removeChild(s.stateNode)}catch(p){Et(s,n,p)}break;case 18:Mt!==null&&(An?(e=Mt,Th(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,s.stateNode),fl(e)):Th(Mt,s.stateNode));break;case 4:o=Mt,c=An,Mt=s.stateNode.containerInfo,An=!0,rr(e,n,s),Mt=o,An=c;break;case 0:case 11:case 14:case 15:Pt||Dr(2,s,n),Pt||Dr(4,s,n),rr(e,n,s);break;case 1:Pt||(Ua(s,n),o=s.stateNode,typeof o.componentWillUnmount=="function"&&Dp(s,n,o)),rr(e,n,s);break;case 21:rr(e,n,s);break;case 22:Pt=(o=Pt)||s.memoizedState!==null,rr(e,n,s),Pt=o;break;default:rr(e,n,s)}}function Fp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{fl(e)}catch(s){Et(n,n.return,s)}}function vg(e){switch(e.tag){case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Lp),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Lp),n;default:throw Error(i(435,e.tag))}}function dc(e,n){var s=vg(e);n.forEach(function(o){var c=Cg.bind(null,e,o);s.has(o)||(s.add(o),o.then(c,c))})}function Dn(e,n){var s=n.deletions;if(s!==null)for(var o=0;o<s.length;o++){var c=s[o],p=e,b=n,A=b;e:for(;A!==null;){switch(A.tag){case 27:if(Fr(A.type)){Mt=A.stateNode,An=!1;break e}break;case 5:Mt=A.stateNode,An=!1;break e;case 3:case 4:Mt=A.stateNode.containerInfo,An=!0;break e}A=A.return}if(Mt===null)throw Error(i(160));Bp(p,b,c),Mt=null,An=!1,p=c.alternate,p!==null&&(p.return=null),c.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)jp(n,e),n=n.sibling}var ga=null;function jp(e,n){var s=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Dn(n,e),_n(e),o&4&&(Dr(3,e,e.return),Xs(3,e),Dr(5,e,e.return));break;case 1:Dn(n,e),_n(e),o&512&&(Pt||s===null||Ua(s,s.return)),o&64&&ar&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(s=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=s===null?o:s.concat(o))));break;case 26:var c=ga;if(Dn(n,e),_n(e),o&512&&(Pt||s===null||Ua(s,s.return)),o&4){var p=s!==null?s.memoizedState:null;if(o=e.memoizedState,s===null)if(o===null)if(e.stateNode===null){e:{o=e.type,s=e.memoizedProps,c=c.ownerDocument||c;t:switch(o){case"title":p=c.getElementsByTagName("title")[0],(!p||p[pr]||p[mt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=c.createElement(o),c.head.insertBefore(p,c.querySelector("head > title"))),un(p,o,s),p[mt]=e,Ft(p),o=p;break e;case"link":var b=kh("link","href",c).get(o+(s.href||""));if(b){for(var A=0;A<b.length;A++)if(p=b[A],p.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&p.getAttribute("rel")===(s.rel==null?null:s.rel)&&p.getAttribute("title")===(s.title==null?null:s.title)&&p.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){b.splice(A,1);break t}}p=c.createElement(o),un(p,o,s),c.head.appendChild(p);break;case"meta":if(b=kh("meta","content",c).get(o+(s.content||""))){for(A=0;A<b.length;A++)if(p=b[A],p.getAttribute("content")===(s.content==null?null:""+s.content)&&p.getAttribute("name")===(s.name==null?null:s.name)&&p.getAttribute("property")===(s.property==null?null:s.property)&&p.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&p.getAttribute("charset")===(s.charSet==null?null:s.charSet)){b.splice(A,1);break t}}p=c.createElement(o),un(p,o,s),c.head.appendChild(p);break;default:throw Error(i(468,o))}p[mt]=e,Ft(p),o=p}e.stateNode=o}else Lh(c,e.type,e.stateNode);else e.stateNode=Oh(c,o,e.memoizedProps);else p!==o?(p===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):p.count--,o===null?Lh(c,e.type,e.stateNode):Oh(c,o,e.memoizedProps)):o===null&&e.stateNode!==null&&oc(e,e.memoizedProps,s.memoizedProps)}break;case 27:Dn(n,e),_n(e),o&512&&(Pt||s===null||Ua(s,s.return)),s!==null&&o&4&&oc(e,e.memoizedProps,s.memoizedProps);break;case 5:if(Dn(n,e),_n(e),o&512&&(Pt||s===null||Ua(s,s.return)),e.flags&32){c=e.stateNode;try{da(c,"")}catch(ee){Et(e,e.return,ee)}}o&4&&e.stateNode!=null&&(c=e.memoizedProps,oc(e,c,s!==null?s.memoizedProps:c)),o&1024&&(fc=!0);break;case 6:if(Dn(n,e),_n(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,s=e.stateNode;try{s.nodeValue=o}catch(ee){Et(e,e.return,ee)}}break;case 3:if(Mo=null,c=ga,ga=To(n.containerInfo),Dn(n,e),ga=c,_n(e),o&4&&s!==null&&s.memoizedState.isDehydrated)try{fl(n.containerInfo)}catch(ee){Et(e,e.return,ee)}fc&&(fc=!1,Pp(e));break;case 4:o=ga,ga=To(e.stateNode.containerInfo),Dn(n,e),_n(e),ga=o;break;case 12:Dn(n,e),_n(e);break;case 13:Dn(n,e),_n(e),e.child.flags&8192&&e.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(yc=Te()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,dc(e,o)));break;case 22:c=e.memoizedState!==null;var L=s!==null&&s.memoizedState!==null,K=ar,se=Pt;if(ar=K||c,Pt=se||L,Dn(n,e),Pt=se,ar=K,_n(e),o&8192)e:for(n=e.stateNode,n._visibility=c?n._visibility&-2:n._visibility|1,c&&(s===null||L||ar||Pt||bi(e)),s=null,n=e;;){if(n.tag===5||n.tag===26){if(s===null){L=s=n;try{if(p=L.stateNode,c)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{A=L.stateNode;var he=L.memoizedProps.style,J=he!=null&&he.hasOwnProperty("display")?he.display:null;A.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(ee){Et(L,L.return,ee)}}}else if(n.tag===6){if(s===null){L=n;try{L.stateNode.nodeValue=c?"":L.memoizedProps}catch(ee){Et(L,L.return,ee)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;s===n&&(s=null),n=n.return}s===n&&(s=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(s=o.retryQueue,s!==null&&(o.retryQueue=null,dc(e,s))));break;case 19:Dn(n,e),_n(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,dc(e,o)));break;case 30:break;case 21:break;default:Dn(n,e),_n(e)}}function _n(e){var n=e.flags;if(n&2){try{for(var s,o=e.return;o!==null;){if(Op(o)){s=o;break}o=o.return}if(s==null)throw Error(i(160));switch(s.tag){case 27:var c=s.stateNode,p=uc(e);fo(e,p,c);break;case 5:var b=s.stateNode;s.flags&32&&(da(b,""),s.flags&=-33);var A=uc(e);fo(e,A,b);break;case 3:case 4:var L=s.stateNode.containerInfo,K=uc(e);cc(e,K,L);break;default:throw Error(i(161))}}catch(se){Et(e,e.return,se)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Pp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;Pp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function _r(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Up(e,n.alternate,n),n=n.sibling}function bi(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Dr(4,n,n.return),bi(n);break;case 1:Ua(n,n.return);var s=n.stateNode;typeof s.componentWillUnmount=="function"&&Dp(n,n.return,s),bi(n);break;case 27:al(n.stateNode);case 26:case 5:Ua(n,n.return),bi(n);break;case 22:n.memoizedState===null&&bi(n);break;case 30:bi(n);break;default:bi(n)}e=e.sibling}}function Or(e,n,s){for(s=s&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,c=e,p=n,b=p.flags;switch(p.tag){case 0:case 11:case 15:Or(c,p,s),Xs(4,p);break;case 1:if(Or(c,p,s),o=p,c=o.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(K){Et(o,o.return,K)}if(o=p,c=o.updateQueue,c!==null){var A=o.stateNode;try{var L=c.shared.hiddenCallbacks;if(L!==null)for(c.shared.hiddenCallbacks=null,c=0;c<L.length;c++)md(L[c],A)}catch(K){Et(o,o.return,K)}}s&&b&64&&Rp(p),Zs(p,p.return);break;case 27:kp(p);case 26:case 5:Or(c,p,s),s&&o===null&&b&4&&_p(p),Zs(p,p.return);break;case 12:Or(c,p,s);break;case 13:Or(c,p,s),s&&b&4&&Fp(c,p);break;case 22:p.memoizedState===null&&Or(c,p,s),Zs(p,p.return);break;case 30:break;default:Or(c,p,s)}n=n.sibling}}function pc(e,n){var s=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==s&&(e!=null&&e.refCount++,s!=null&&ks(s))}function hc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&ks(e))}function Ia(e,n,s,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Gp(e,n,s,o),n=n.sibling}function Gp(e,n,s,o){var c=n.flags;switch(n.tag){case 0:case 11:case 15:Ia(e,n,s,o),c&2048&&Xs(9,n);break;case 1:Ia(e,n,s,o);break;case 3:Ia(e,n,s,o),c&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&ks(e)));break;case 12:if(c&2048){Ia(e,n,s,o),e=n.stateNode;try{var p=n.memoizedProps,b=p.id,A=p.onPostCommit;typeof A=="function"&&A(b,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(L){Et(n,n.return,L)}}else Ia(e,n,s,o);break;case 13:Ia(e,n,s,o);break;case 23:break;case 22:p=n.stateNode,b=n.alternate,n.memoizedState!==null?p._visibility&2?Ia(e,n,s,o):Qs(e,n):p._visibility&2?Ia(e,n,s,o):(p._visibility|=2,Zi(e,n,s,o,(n.subtreeFlags&10256)!==0)),c&2048&&pc(b,n);break;case 24:Ia(e,n,s,o),c&2048&&hc(n.alternate,n);break;default:Ia(e,n,s,o)}}function Zi(e,n,s,o,c){for(c=c&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var p=e,b=n,A=s,L=o,K=b.flags;switch(b.tag){case 0:case 11:case 15:Zi(p,b,A,L,c),Xs(8,b);break;case 23:break;case 22:var se=b.stateNode;b.memoizedState!==null?se._visibility&2?Zi(p,b,A,L,c):Qs(p,b):(se._visibility|=2,Zi(p,b,A,L,c)),c&&K&2048&&pc(b.alternate,b);break;case 24:Zi(p,b,A,L,c),c&&K&2048&&hc(b.alternate,b);break;default:Zi(p,b,A,L,c)}n=n.sibling}}function Qs(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var s=e,o=n,c=o.flags;switch(o.tag){case 22:Qs(s,o),c&2048&&pc(o.alternate,o);break;case 24:Qs(s,o),c&2048&&hc(o.alternate,o);break;default:Qs(s,o)}n=n.sibling}}var $s=8192;function Qi(e){if(e.subtreeFlags&$s)for(e=e.child;e!==null;)zp(e),e=e.sibling}function zp(e){switch(e.tag){case 26:Qi(e),e.flags&$s&&e.memoizedState!==null&&nv(ga,e.memoizedState,e.memoizedProps);break;case 5:Qi(e);break;case 3:case 4:var n=ga;ga=To(e.stateNode.containerInfo),Qi(e),ga=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=$s,$s=16777216,Qi(e),$s=n):Qi(e));break;default:Qi(e)}}function Hp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Ks(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];tn=o,qp(o,e)}Hp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Yp(e),e=e.sibling}function Yp(e){switch(e.tag){case 0:case 11:case 15:Ks(e),e.flags&2048&&Dr(9,e,e.return);break;case 3:Ks(e);break;case 12:Ks(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,po(e)):Ks(e);break;default:Ks(e)}}function po(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];tn=o,qp(o,e)}Hp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Dr(8,n,n.return),po(n);break;case 22:s=n.stateNode,s._visibility&2&&(s._visibility&=-3,po(n));break;default:po(n)}e=e.sibling}}function qp(e,n){for(;tn!==null;){var s=tn;switch(s.tag){case 0:case 11:case 15:Dr(8,s,n);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var o=s.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:ks(s.memoizedState.cache)}if(o=s.child,o!==null)o.return=s,tn=o;else e:for(s=e;tn!==null;){o=tn;var c=o.sibling,p=o.return;if(Ip(o),o===s){tn=null;break e}if(c!==null){c.return=p,tn=c;break e}tn=p}}}var yg={getCacheForType:function(e){var n=fn(Xt),s=n.data.get(e);return s===void 0&&(s=e(),n.data.set(e,s)),s}},bg=typeof WeakMap=="function"?WeakMap:Map,gt=0,At=null,it=null,ot=0,vt=0,On=null,kr=!1,$i=!1,mc=!1,ir=0,Ut=0,Lr=0,xi=0,gc=0,Wn=0,Ki=0,Ws=null,wn=null,vc=!1,yc=0,ho=1/0,mo=null,Ur=null,on=0,Ir=null,Wi=null,Ji=0,bc=0,xc=null,Vp=null,Js=0,Sc=null;function kn(){if((gt&2)!==0&&ot!==0)return ot&-ot;if(B.T!==null){var e=Pi;return e!==0?e:Nc()}return au()}function Xp(){Wn===0&&(Wn=(ot&536870912)===0||pt?la():536870912);var e=Kn.current;return e!==null&&(e.flags|=32),Wn}function Ln(e,n,s){(e===At&&(vt===2||vt===9)||e.cancelPendingCommit!==null)&&(es(e,0),Br(e,ot,Wn,!1)),Wr(e,s),((gt&2)===0||e!==At)&&(e===At&&((gt&2)===0&&(xi|=s),Ut===4&&Br(e,ot,Wn,!1)),Ba(e))}function Zp(e,n,s){if((gt&6)!==0)throw Error(i(327));var o=!s&&(n&124)===0&&(n&e.expiredLanes)===0||Fn(e,n),c=o?Eg(e,n):wc(e,n,!0),p=o;do{if(c===0){$i&&!o&&Br(e,n,0,!1);break}else{if(s=e.current.alternate,p&&!xg(s)){c=wc(e,n,!1),p=!1;continue}if(c===2){if(p=n,e.errorRecoveryDisabledLanes&p)var b=0;else b=e.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){n=b;e:{var A=e;c=Ws;var L=A.current.memoizedState.isDehydrated;if(L&&(es(A,b).flags|=256),b=wc(A,b,!1),b!==2){if(mc&&!L){A.errorRecoveryDisabledLanes|=p,xi|=p,c=4;break e}p=wn,wn=c,p!==null&&(wn===null?wn=p:wn.push.apply(wn,p))}c=b}if(p=!1,c!==2)continue}}if(c===1){es(e,0),Br(e,n,0,!0);break}e:{switch(o=e,p=c,p){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:Br(o,n,Wn,!kr);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(c=yc+300-Te(),10<c)){if(Br(o,n,Wn,!kr),sa(o,0,!0)!==0)break e;o.timeoutHandle=Ah(Qp.bind(null,o,s,wn,mo,vc,n,Wn,xi,Ki,kr,p,2,-0,0),c);break e}Qp(o,s,wn,mo,vc,n,Wn,xi,Ki,kr,p,0,-0,0)}}break}while(!0);Ba(e)}function Qp(e,n,s,o,c,p,b,A,L,K,se,he,J,ee){if(e.timeoutHandle=-1,he=n.subtreeFlags,(he&8192||(he&16785408)===16785408)&&(sl={stylesheets:null,count:0,unsuspend:tv},zp(n),he=av(),he!==null)){e.cancelPendingCommit=he(nh.bind(null,e,n,p,s,o,c,b,A,L,se,1,J,ee)),Br(e,p,b,!K);return}nh(e,n,p,s,o,c,b,A,L)}function xg(e){for(var n=e;;){var s=n.tag;if((s===0||s===11||s===15)&&n.flags&16384&&(s=n.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var o=0;o<s.length;o++){var c=s[o],p=c.getSnapshot;c=c.value;try{if(!Nn(p(),c))return!1}catch{return!1}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Br(e,n,s,o){n&=~gc,n&=~xi,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var c=n;0<c;){var p=31-Je(c),b=1<<p;o[p]=-1,c&=~b}s!==0&&Ht(e,s,n)}function go(){return(gt&6)===0?(el(0),!1):!0}function Ec(){if(it!==null){if(vt===0)var e=it.return;else e=it,Ka=hi=null,ju(e),Vi=null,Ys=0,e=it;for(;e!==null;)Np(e.alternate,e),e=e.return;it=null}}function es(e,n){var s=e.timeoutHandle;s!==-1&&(e.timeoutHandle=-1,Fg(s)),s=e.cancelPendingCommit,s!==null&&(e.cancelPendingCommit=null,s()),Ec(),At=e,it=s=Za(e.current,null),ot=n,vt=0,On=null,kr=!1,$i=Fn(e,n),mc=!1,Ki=Wn=gc=xi=Lr=Ut=0,wn=Ws=null,vc=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var c=31-Je(o),p=1<<c;n|=e[c],o&=~p}return ir=n,Bl(),s}function $p(e,n){nt=null,B.H=no,n===Us||n===Vl?(n=pd(),vt=3):n===cd?(n=pd(),vt=4):vt=n===hp?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,On=n,it===null&&(Ut=1,lo(e,Xn(n,e.current)))}function Kp(){var e=B.H;return B.H=no,e===null?no:e}function Wp(){var e=B.A;return B.A=yg,e}function Ac(){Ut=4,kr||(ot&4194048)!==ot&&Kn.current!==null||($i=!0),(Lr&134217727)===0&&(xi&134217727)===0||At===null||Br(At,ot,Wn,!1)}function wc(e,n,s){var o=gt;gt|=2;var c=Kp(),p=Wp();(At!==e||ot!==n)&&(mo=null,es(e,n)),n=!1;var b=Ut;e:do try{if(vt!==0&&it!==null){var A=it,L=On;switch(vt){case 8:Ec(),b=6;break e;case 3:case 2:case 9:case 6:Kn.current===null&&(n=!0);var K=vt;if(vt=0,On=null,ts(e,A,L,K),s&&$i){b=0;break e}break;default:K=vt,vt=0,On=null,ts(e,A,L,K)}}Sg(),b=Ut;break}catch(se){$p(e,se)}while(!0);return n&&e.shellSuspendCounter++,Ka=hi=null,gt=o,B.H=c,B.A=p,it===null&&(At=null,ot=0,Bl()),b}function Sg(){for(;it!==null;)Jp(it)}function Eg(e,n){var s=gt;gt|=2;var o=Kp(),c=Wp();At!==e||ot!==n?(mo=null,ho=Te()+500,es(e,n)):$i=Fn(e,n);e:do try{if(vt!==0&&it!==null){n=it;var p=On;t:switch(vt){case 1:vt=0,On=null,ts(e,n,p,1);break;case 2:case 9:if(fd(p)){vt=0,On=null,eh(n);break}n=function(){vt!==2&&vt!==9||At!==e||(vt=7),Ba(e)},p.then(n,n);break e;case 3:vt=7;break e;case 4:vt=5;break e;case 7:fd(p)?(vt=0,On=null,eh(n)):(vt=0,On=null,ts(e,n,p,7));break;case 5:var b=null;switch(it.tag){case 26:b=it.memoizedState;case 5:case 27:var A=it;if(!b||Uh(b)){vt=0,On=null;var L=A.sibling;if(L!==null)it=L;else{var K=A.return;K!==null?(it=K,vo(K)):it=null}break t}}vt=0,On=null,ts(e,n,p,5);break;case 6:vt=0,On=null,ts(e,n,p,6);break;case 8:Ec(),Ut=6;break e;default:throw Error(i(462))}}Ag();break}catch(se){$p(e,se)}while(!0);return Ka=hi=null,B.H=o,B.A=c,gt=s,it!==null?0:(At=null,ot=0,Bl(),Ut)}function Ag(){for(;it!==null&&!ft();)Jp(it)}function Jp(e){var n=Cp(e.alternate,e,ir);e.memoizedProps=e.pendingProps,n===null?vo(e):it=n}function eh(e){var n=e,s=n.alternate;switch(n.tag){case 15:case 0:n=xp(s,n,n.pendingProps,n.type,void 0,ot);break;case 11:n=xp(s,n,n.pendingProps,n.type.render,n.ref,ot);break;case 5:ju(n);default:Np(s,n),n=it=td(n,ir),n=Cp(s,n,ir)}e.memoizedProps=e.pendingProps,n===null?vo(e):it=n}function ts(e,n,s,o){Ka=hi=null,ju(n),Vi=null,Ys=0;var c=n.return;try{if(dg(e,c,n,s,ot)){Ut=1,lo(e,Xn(s,e.current)),it=null;return}}catch(p){if(c!==null)throw it=c,p;Ut=1,lo(e,Xn(s,e.current)),it=null;return}n.flags&32768?(pt||o===1?e=!0:$i||(ot&536870912)!==0?e=!1:(kr=e=!0,(o===2||o===9||o===3||o===6)&&(o=Kn.current,o!==null&&o.tag===13&&(o.flags|=16384))),th(n,e)):vo(n)}function vo(e){var n=e;do{if((n.flags&32768)!==0){th(n,kr);return}e=n.return;var s=hg(n.alternate,n,ir);if(s!==null){it=s;return}if(n=n.sibling,n!==null){it=n;return}it=n=e}while(n!==null);Ut===0&&(Ut=5)}function th(e,n){do{var s=mg(e.alternate,e);if(s!==null){s.flags&=32767,it=s;return}if(s=e.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!n&&(e=e.sibling,e!==null)){it=e;return}it=e=s}while(e!==null);Ut=6,it=null}function nh(e,n,s,o,c,p,b,A,L){e.cancelPendingCommit=null;do yo();while(on!==0);if((gt&6)!==0)throw Error(i(327));if(n!==null){if(n===e.current)throw Error(i(177));if(p=n.lanes|n.childLanes,p|=hu,nu(e,s,p,b,A,L),e===At&&(it=At=null,ot=0),Wi=n,Ir=e,Ji=s,bc=p,xc=c,Vp=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Mg(Bt,function(){return lh(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=B.T,B.T=null,c=P.p,P.p=2,b=gt,gt|=4;try{gg(e,n,s)}finally{gt=b,P.p=c,B.T=o}}on=1,ah(),rh(),ih()}}function ah(){if(on===1){on=0;var e=Ir,n=Wi,s=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||s){s=B.T,B.T=null;var o=P.p;P.p=2;var c=gt;gt|=4;try{jp(n,e);var p=Ic,b=qf(e.containerInfo),A=p.focusedElem,L=p.selectionRange;if(b!==A&&A&&A.ownerDocument&&Yf(A.ownerDocument.documentElement,A)){if(L!==null&&uu(A)){var K=L.start,se=L.end;if(se===void 0&&(se=K),"selectionStart"in A)A.selectionStart=K,A.selectionEnd=Math.min(se,A.value.length);else{var he=A.ownerDocument||document,J=he&&he.defaultView||window;if(J.getSelection){var ee=J.getSelection(),Ye=A.textContent.length,Pe=Math.min(L.start,Ye),St=L.end===void 0?Pe:Math.min(L.end,Ye);!ee.extend&&Pe>St&&(b=St,St=Pe,Pe=b);var Y=Hf(A,Pe),j=Hf(A,St);if(Y&&j&&(ee.rangeCount!==1||ee.anchorNode!==Y.node||ee.anchorOffset!==Y.offset||ee.focusNode!==j.node||ee.focusOffset!==j.offset)){var X=he.createRange();X.setStart(Y.node,Y.offset),ee.removeAllRanges(),Pe>St?(ee.addRange(X),ee.extend(j.node,j.offset)):(X.setEnd(j.node,j.offset),ee.addRange(X))}}}}for(he=[],ee=A;ee=ee.parentNode;)ee.nodeType===1&&he.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<he.length;A++){var oe=he[A];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}Do=!!Uc,Ic=Uc=null}finally{gt=c,P.p=o,B.T=s}}e.current=n,on=2}}function rh(){if(on===2){on=0;var e=Ir,n=Wi,s=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||s){s=B.T,B.T=null;var o=P.p;P.p=2;var c=gt;gt|=4;try{Up(e,n.alternate,n)}finally{gt=c,P.p=o,B.T=s}}on=3}}function ih(){if(on===4||on===3){on=0,ht();var e=Ir,n=Wi,s=Ji,o=Vp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?on=5:(on=0,Wi=Ir=null,sh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Ur=null),Nl(s),n=n.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Aa,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=B.T,c=P.p,P.p=2,B.T=null;try{for(var p=e.onRecoverableError,b=0;b<o.length;b++){var A=o[b];p(A.value,{componentStack:A.stack})}}finally{B.T=n,P.p=c}}(Ji&3)!==0&&yo(),Ba(e),c=e.pendingLanes,(s&4194090)!==0&&(c&42)!==0?e===Sc?Js++:(Js=0,Sc=e):Js=0,el(0)}}function sh(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,ks(n)))}function yo(e){return ah(),rh(),ih(),lh()}function lh(){if(on!==5)return!1;var e=Ir,n=bc;bc=0;var s=Nl(Ji),o=B.T,c=P.p;try{P.p=32>s?32:s,B.T=null,s=xc,xc=null;var p=Ir,b=Ji;if(on=0,Wi=Ir=null,Ji=0,(gt&6)!==0)throw Error(i(331));var A=gt;if(gt|=4,Yp(p.current),Gp(p,p.current,b,s),gt=A,el(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Aa,p)}catch{}return!0}finally{P.p=c,B.T=o,sh(e,n)}}function oh(e,n,s){n=Xn(s,n),n=Ju(e.stateNode,n,2),e=Cr(e,n,2),e!==null&&(Wr(e,2),Ba(e))}function Et(e,n,s){if(e.tag===3)oh(e,e,s);else for(;n!==null;){if(n.tag===3){oh(n,e,s);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ur===null||!Ur.has(o))){e=Xn(s,e),s=dp(2),o=Cr(n,s,2),o!==null&&(pp(s,o,n,e),Wr(o,2),Ba(o));break}}n=n.return}}function Tc(e,n,s){var o=e.pingCache;if(o===null){o=e.pingCache=new bg;var c=new Set;o.set(n,c)}else c=o.get(n),c===void 0&&(c=new Set,o.set(n,c));c.has(s)||(mc=!0,c.add(s),e=wg.bind(null,e,n,s),n.then(e,e))}function wg(e,n,s){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&s,e.warmLanes&=~s,At===e&&(ot&s)===s&&(Ut===4||Ut===3&&(ot&62914560)===ot&&300>Te()-yc?(gt&2)===0&&es(e,0):gc|=s,Ki===ot&&(Ki=0)),Ba(e)}function uh(e,n){n===0&&(n=Pa()),e=Ii(e,n),e!==null&&(Wr(e,n),Ba(e))}function Tg(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),uh(e,s)}function Cg(e,n){var s=0;switch(e.tag){case 13:var o=e.stateNode,c=e.memoizedState;c!==null&&(s=c.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(n),uh(e,s)}function Mg(e,n){return ye(e,n)}var bo=null,ns=null,Cc=!1,xo=!1,Mc=!1,Si=0;function Ba(e){e!==ns&&e.next===null&&(ns===null?bo=ns=e:ns=ns.next=e),xo=!0,Cc||(Cc=!0,Rg())}function el(e,n){if(!Mc&&xo){Mc=!0;do for(var s=!1,o=bo;o!==null;){if(e!==0){var c=o.pendingLanes;if(c===0)var p=0;else{var b=o.suspendedLanes,A=o.pingedLanes;p=(1<<31-Je(42|e)+1)-1,p&=c&~(b&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(s=!0,ph(o,p))}else p=ot,p=sa(o,o===At?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(p&3)===0||Fn(o,p)||(s=!0,ph(o,p));o=o.next}while(s);Mc=!1}}function Ng(){ch()}function ch(){xo=Cc=!1;var e=0;Si!==0&&(Bg()&&(e=Si),Si=0);for(var n=Te(),s=null,o=bo;o!==null;){var c=o.next,p=fh(o,n);p===0?(o.next=null,s===null?bo=c:s.next=c,c===null&&(ns=s)):(s=o,(e!==0||(p&3)!==0)&&(xo=!0)),o=c}el(e)}function fh(e,n){for(var s=e.suspendedLanes,o=e.pingedLanes,c=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var b=31-Je(p),A=1<<b,L=c[b];L===-1?((A&s)===0||(A&o)!==0)&&(c[b]=dr(A,n)):L<=n&&(e.expiredLanes|=A),p&=~A}if(n=At,s=ot,s=sa(e,e===n?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,s===0||e===n&&(vt===2||vt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&ne(o),e.callbackNode=null,e.callbackPriority=0;if((s&3)===0||Fn(e,s)){if(n=s&-s,n===e.callbackPriority)return n;switch(o!==null&&ne(o),Nl(s)){case 2:case 8:s=ut;break;case 32:s=Bt;break;case 268435456:s=cr;break;default:s=Bt}return o=dh.bind(null,e),s=ye(s,o),e.callbackPriority=n,e.callbackNode=s,n}return o!==null&&o!==null&&ne(o),e.callbackPriority=2,e.callbackNode=null,2}function dh(e,n){if(on!==0&&on!==5)return e.callbackNode=null,e.callbackPriority=0,null;var s=e.callbackNode;if(yo()&&e.callbackNode!==s)return null;var o=ot;return o=sa(e,e===At?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(Zp(e,o,n),fh(e,Te()),e.callbackNode!=null&&e.callbackNode===s?dh.bind(null,e):null)}function ph(e,n){if(yo())return null;Zp(e,n,!0)}function Rg(){jg(function(){(gt&6)!==0?ye(Gt,Ng):ch()})}function Nc(){return Si===0&&(Si=la()),Si}function hh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ri(""+e)}function mh(e,n){var s=n.ownerDocument.createElement("input");return s.name=n.name,s.value=n.value,e.id&&s.setAttribute("form",e.id),n.parentNode.insertBefore(s,n),e=new FormData(e),s.parentNode.removeChild(s),e}function Dg(e,n,s,o,c){if(n==="submit"&&s&&s.stateNode===c){var p=hh((c[Dt]||null).action),b=o.submitter;b&&(n=(n=b[Dt]||null)?hh(n.formAction):b.getAttribute("formAction"),n!==null&&(p=n,b=null));var A=new ae("action","action",null,o,c);e.push({event:A,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Si!==0){var L=b?mh(c,b):new FormData(c);Zu(s,{pending:!0,data:L,method:c.method,action:p},null,L)}}else typeof p=="function"&&(A.preventDefault(),L=b?mh(c,b):new FormData(c),Zu(s,{pending:!0,data:L,method:c.method,action:p},p,L))},currentTarget:c}]})}}for(var Rc=0;Rc<pu.length;Rc++){var Dc=pu[Rc],_g=Dc.toLowerCase(),Og=Dc[0].toUpperCase()+Dc.slice(1);ma(_g,"on"+Og)}ma(Zf,"onAnimationEnd"),ma(Qf,"onAnimationIteration"),ma($f,"onAnimationStart"),ma("dblclick","onDoubleClick"),ma("focusin","onFocus"),ma("focusout","onBlur"),ma(Qm,"onTransitionRun"),ma($m,"onTransitionStart"),ma(Km,"onTransitionCancel"),ma(Kf,"onTransitionEnd"),vn("onMouseEnter",["mouseout","mouseover"]),vn("onMouseLeave",["mouseout","mouseover"]),vn("onPointerEnter",["pointerout","pointerover"]),vn("onPointerLeave",["pointerout","pointerover"]),ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ua("onBeforeInput",["compositionend","keypress","textInput","paste"]),ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tl));function gh(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var o=e[s],c=o.event;o=o.listeners;e:{var p=void 0;if(n)for(var b=o.length-1;0<=b;b--){var A=o[b],L=A.instance,K=A.currentTarget;if(A=A.listener,L!==p&&c.isPropagationStopped())break e;p=A,c.currentTarget=K;try{p(c)}catch(se){so(se)}c.currentTarget=null,p=L}else for(b=0;b<o.length;b++){if(A=o[b],L=A.instance,K=A.currentTarget,A=A.listener,L!==p&&c.isPropagationStopped())break e;p=A,c.currentTarget=K;try{p(c)}catch(se){so(se)}c.currentTarget=null,p=L}}}}function st(e,n){var s=n[Tt];s===void 0&&(s=n[Tt]=new Set);var o=e+"__bubble";s.has(o)||(vh(n,e,2,!1),s.add(o))}function _c(e,n,s){var o=0;n&&(o|=4),vh(s,e,o,n)}var So="_reactListening"+Math.random().toString(36).slice(2);function Oc(e){if(!e[So]){e[So]=!0,Jr.forEach(function(s){s!=="selectionchange"&&(kg.has(s)||_c(s,!1,e),_c(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[So]||(n[So]=!0,_c("selectionchange",!1,n))}}function vh(e,n,s,o){switch(Gh(n)){case 2:var c=sv;break;case 8:c=lv;break;default:c=Vc}s=c.bind(null,n,s,e),c=void 0,!As||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(c=!0),o?c!==void 0?e.addEventListener(n,s,{capture:!0,passive:c}):e.addEventListener(n,s,!0):c!==void 0?e.addEventListener(n,s,{passive:c}):e.addEventListener(n,s,!1)}function kc(e,n,s,o,c){var p=o;if((n&1)===0&&(n&2)===0&&o!==null)e:for(;;){if(o===null)return;var b=o.tag;if(b===3||b===4){var A=o.stateNode.containerInfo;if(A===c)break;if(b===4)for(b=o.return;b!==null;){var L=b.tag;if((L===3||L===4)&&b.stateNode.containerInfo===c)return;b=b.return}for(;A!==null;){if(b=zn(A),b===null)return;if(L=b.tag,L===5||L===6||L===26||L===27){o=p=b;continue e}A=A.parentNode}}o=o.return}cn(function(){var K=p,se=Ss(s),he=[];e:{var J=Wf.get(e);if(J!==void 0){var ee=ae,Ye=e;switch(e){case"keypress":if(N(s)===0)break e;case"keydown":case"keyup":ee=ha;break;case"focusin":Ye="focus",ee=Re;break;case"focusout":Ye="blur",ee=Re;break;case"beforeblur":case"afterblur":ee=Re;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Ce;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Ne;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=_i;break;case Zf:case Qf:case $f:ee=Xe;break;case Kf:ee=si;break;case"scroll":case"scrollend":ee=Fe;break;case"wheel":ee=qa;break;case"copy":case"cut":case"paste":ee=et;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=kt;break;case"toggle":case"beforetoggle":ee=Oa}var Pe=(n&4)!==0,St=!Pe&&(e==="scroll"||e==="scrollend"),Y=Pe?J!==null?J+"Capture":null:J;Pe=[];for(var j=K,X;j!==null;){var oe=j;if(X=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||X===null||Y===null||(oe=za(j,Y),oe!=null&&Pe.push(nl(j,oe,X))),St)break;j=j.return}0<Pe.length&&(J=new ee(J,Ye,null,s,se),he.push({event:J,listeners:Pe}))}}if((n&7)===0){e:{if(J=e==="mouseover"||e==="pointerover",ee=e==="mouseout"||e==="pointerout",J&&s!==xs&&(Ye=s.relatedTarget||s.fromElement)&&(zn(Ye)||Ye[Nt]))break e;if((ee||J)&&(J=se.window===se?se:(J=se.ownerDocument)?J.defaultView||J.parentWindow:window,ee?(Ye=s.relatedTarget||s.toElement,ee=K,Ye=Ye?zn(Ye):null,Ye!==null&&(St=u(Ye),Pe=Ye.tag,Ye!==St||Pe!==5&&Pe!==27&&Pe!==6)&&(Ye=null)):(ee=null,Ye=K),ee!==Ye)){if(Pe=Ce,oe="onMouseLeave",Y="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&(Pe=kt,oe="onPointerLeave",Y="onPointerEnter",j="pointer"),St=ee==null?J:hr(ee),X=Ye==null?J:hr(Ye),J=new Pe(oe,j+"leave",ee,s,se),J.target=St,J.relatedTarget=X,oe=null,zn(se)===K&&(Pe=new Pe(Y,j+"enter",Ye,s,se),Pe.target=X,Pe.relatedTarget=St,oe=Pe),St=oe,ee&&Ye)t:{for(Pe=ee,Y=Ye,j=0,X=Pe;X;X=as(X))j++;for(X=0,oe=Y;oe;oe=as(oe))X++;for(;0<j-X;)Pe=as(Pe),j--;for(;0<X-j;)Y=as(Y),X--;for(;j--;){if(Pe===Y||Y!==null&&Pe===Y.alternate)break t;Pe=as(Pe),Y=as(Y)}Pe=null}else Pe=null;ee!==null&&yh(he,J,ee,Pe,!1),Ye!==null&&St!==null&&yh(he,St,Ye,Pe,!0)}}e:{if(J=K?hr(K):window,ee=J.nodeName&&J.nodeName.toLowerCase(),ee==="select"||ee==="input"&&J.type==="file")var De=Bf;else if(Uf(J))if(Ff)De=Vm;else{De=Ym;var rt=Hm}else ee=J.nodeName,!ee||ee.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?K&&bs(K.elementType)&&(De=Bf):De=qm;if(De&&(De=De(e,K))){If(he,De,s,se);break e}rt&&rt(e,J,K),e==="focusout"&&K&&J.type==="number"&&K.memoizedProps.value!=null&&Hn(J,"number",J.value)}switch(rt=K?hr(K):window,e){case"focusin":(Uf(rt)||rt.contentEditable==="true")&&(ki=rt,cu=K,Ns=null);break;case"focusout":Ns=cu=ki=null;break;case"mousedown":fu=!0;break;case"contextmenu":case"mouseup":case"dragend":fu=!1,Vf(he,s,se);break;case"selectionchange":if(Zm)break;case"keydown":case"keyup":Vf(he,s,se)}var Le;if(Mn)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else Oi?Vn(e,s)&&(ze="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(ze="onCompositionStart");ze&&(qn&&s.locale!=="ko"&&(Oi||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&Oi&&(Le=_()):(_a=se,ws="value"in _a?_a.value:_a.textContent,Oi=!0)),rt=Eo(K,ze),0<rt.length&&(ze=new dt(ze,e,null,s,se),he.push({event:ze,listeners:rt}),Le?ze.data=Le:(Le=pn(s),Le!==null&&(ze.data=Le)))),(Le=Xa?jm(e,s):Pm(e,s))&&(ze=Eo(K,"onBeforeInput"),0<ze.length&&(rt=new dt("onBeforeInput","beforeinput",null,s,se),he.push({event:rt,listeners:ze}),rt.data=Le)),Dg(he,e,K,s,se)}gh(he,n)})}function nl(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Eo(e,n){for(var s=n+"Capture",o=[];e!==null;){var c=e,p=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||p===null||(c=za(e,s),c!=null&&o.unshift(nl(e,c,p)),c=za(e,n),c!=null&&o.push(nl(e,c,p))),e.tag===3)return o;e=e.return}return[]}function as(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function yh(e,n,s,o,c){for(var p=n._reactName,b=[];s!==null&&s!==o;){var A=s,L=A.alternate,K=A.stateNode;if(A=A.tag,L!==null&&L===o)break;A!==5&&A!==26&&A!==27||K===null||(L=K,c?(K=za(s,p),K!=null&&b.unshift(nl(s,K,L))):c||(K=za(s,p),K!=null&&b.push(nl(s,K,L)))),s=s.return}b.length!==0&&e.push({event:n,listeners:b})}var Lg=/\r\n?/g,Ug=/\u0000|\uFFFD/g;function bh(e){return(typeof e=="string"?e:""+e).replace(Lg,`
`).replace(Ug,"")}function xh(e,n){return n=bh(n),bh(e)===n}function Ao(){}function xt(e,n,s,o,c,p){switch(s){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||da(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&da(e,""+o);break;case"className":Ma(e,"class",o);break;case"tabIndex":Ma(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Ma(e,s,o);break;case"style":br(e,o,p);break;case"data":if(n!=="object"){Ma(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||s!=="href")){e.removeAttribute(s);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(s);break}o=Ri(""+o),e.setAttribute(s,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(s==="formAction"?(n!=="input"&&xt(e,n,"name",c.name,c,null),xt(e,n,"formEncType",c.formEncType,c,null),xt(e,n,"formMethod",c.formMethod,c,null),xt(e,n,"formTarget",c.formTarget,c,null)):(xt(e,n,"encType",c.encType,c,null),xt(e,n,"method",c.method,c,null),xt(e,n,"target",c.target,c,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(s);break}o=Ri(""+o),e.setAttribute(s,o);break;case"onClick":o!=null&&(e.onclick=Ao);break;case"onScroll":o!=null&&st("scroll",e);break;case"onScrollEnd":o!=null&&st("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(s=o.__html,s!=null){if(c.children!=null)throw Error(i(60));e.innerHTML=s}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}s=Ri(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(s,""+o):e.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(s,""):e.removeAttribute(s);break;case"capture":case"download":o===!0?e.setAttribute(s,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(s,o):e.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(s,o):e.removeAttribute(s);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(s):e.setAttribute(s,o);break;case"popover":st("beforetoggle",e),st("toggle",e),ei(e,"popover",o);break;case"xlinkActuate":Cn(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Cn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Cn(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Cn(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Cn(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Cn(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Cn(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Cn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Cn(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":ei(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=iu.get(s)||s,ei(e,s,o))}}function Lc(e,n,s,o,c,p){switch(s){case"style":br(e,o,p);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(s=o.__html,s!=null){if(c.children!=null)throw Error(i(60));e.innerHTML=s}}break;case"children":typeof o=="string"?da(e,o):(typeof o=="number"||typeof o=="bigint")&&da(e,""+o);break;case"onScroll":o!=null&&st("scroll",e);break;case"onScrollEnd":o!=null&&st("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Ao);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hs.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(c=s.endsWith("Capture"),n=s.slice(2,c?s.length-7:void 0),p=e[Dt]||null,p=p!=null?p[s]:null,typeof p=="function"&&e.removeEventListener(n,p,c),typeof o=="function")){typeof p!="function"&&p!==null&&(s in e?e[s]=null:e.hasAttribute(s)&&e.removeAttribute(s)),e.addEventListener(n,o,c);break e}s in e?e[s]=o:o===!0?e.setAttribute(s,""):ei(e,s,o)}}}function un(e,n,s){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":st("error",e),st("load",e);var o=!1,c=!1,p;for(p in s)if(s.hasOwnProperty(p)){var b=s[p];if(b!=null)switch(p){case"src":o=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:xt(e,n,p,b,s,null)}}c&&xt(e,n,"srcSet",s.srcSet,s,null),o&&xt(e,n,"src",s.src,s,null);return;case"input":st("invalid",e);var A=p=b=c=null,L=null,K=null;for(o in s)if(s.hasOwnProperty(o)){var se=s[o];if(se!=null)switch(o){case"name":c=se;break;case"type":b=se;break;case"checked":L=se;break;case"defaultChecked":K=se;break;case"value":p=se;break;case"defaultValue":A=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,n));break;default:xt(e,n,o,se,s,null)}}yr(e,p,A,L,K,b,c,!1),_t(e);return;case"select":st("invalid",e),o=b=p=null;for(c in s)if(s.hasOwnProperty(c)&&(A=s[c],A!=null))switch(c){case"value":p=A;break;case"defaultValue":b=A;break;case"multiple":o=A;default:xt(e,n,c,A,s,null)}n=p,s=b,e.multiple=!!o,n!=null?fa(e,!!o,n,!1):s!=null&&fa(e,!!o,s,!0);return;case"textarea":st("invalid",e),p=c=o=null;for(b in s)if(s.hasOwnProperty(b)&&(A=s[b],A!=null))switch(b){case"value":o=A;break;case"defaultValue":c=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:xt(e,n,b,A,s,null)}ai(e,o,c,p),_t(e);return;case"option":for(L in s)s.hasOwnProperty(L)&&(o=s[L],o!=null)&&(L==="selected"?e.selected=o&&typeof o!="function"&&typeof o!="symbol":xt(e,n,L,o,s,null));return;case"dialog":st("beforetoggle",e),st("toggle",e),st("cancel",e),st("close",e);break;case"iframe":case"object":st("load",e);break;case"video":case"audio":for(o=0;o<tl.length;o++)st(tl[o],e);break;case"image":st("error",e),st("load",e);break;case"details":st("toggle",e);break;case"embed":case"source":case"link":st("error",e),st("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in s)if(s.hasOwnProperty(K)&&(o=s[K],o!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:xt(e,n,K,o,s,null)}return;default:if(bs(n)){for(se in s)s.hasOwnProperty(se)&&(o=s[se],o!==void 0&&Lc(e,n,se,o,s,void 0));return}}for(A in s)s.hasOwnProperty(A)&&(o=s[A],o!=null&&xt(e,n,A,o,s,null))}function Ig(e,n,s,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,p=null,b=null,A=null,L=null,K=null,se=null;for(ee in s){var he=s[ee];if(s.hasOwnProperty(ee)&&he!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":L=he;default:o.hasOwnProperty(ee)||xt(e,n,ee,null,o,he)}}for(var J in o){var ee=o[J];if(he=s[J],o.hasOwnProperty(J)&&(ee!=null||he!=null))switch(J){case"type":p=ee;break;case"name":c=ee;break;case"checked":K=ee;break;case"defaultChecked":se=ee;break;case"value":b=ee;break;case"defaultValue":A=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,n));break;default:ee!==he&&xt(e,n,J,ee,o,he)}}ys(e,b,A,L,K,se,p,c);return;case"select":ee=b=A=J=null;for(p in s)if(L=s[p],s.hasOwnProperty(p)&&L!=null)switch(p){case"value":break;case"multiple":ee=L;default:o.hasOwnProperty(p)||xt(e,n,p,null,o,L)}for(c in o)if(p=o[c],L=s[c],o.hasOwnProperty(c)&&(p!=null||L!=null))switch(c){case"value":J=p;break;case"defaultValue":A=p;break;case"multiple":b=p;default:p!==L&&xt(e,n,c,p,o,L)}n=A,s=b,o=ee,J!=null?fa(e,!!s,J,!1):!!o!=!!s&&(n!=null?fa(e,!!s,n,!0):fa(e,!!s,s?[]:"",!1));return;case"textarea":ee=J=null;for(A in s)if(c=s[A],s.hasOwnProperty(A)&&c!=null&&!o.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:xt(e,n,A,null,o,c)}for(b in o)if(c=o[b],p=s[b],o.hasOwnProperty(b)&&(c!=null||p!=null))switch(b){case"value":J=c;break;case"defaultValue":ee=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(i(91));break;default:c!==p&&xt(e,n,b,c,o,p)}ni(e,J,ee);return;case"option":for(var Ye in s)J=s[Ye],s.hasOwnProperty(Ye)&&J!=null&&!o.hasOwnProperty(Ye)&&(Ye==="selected"?e.selected=!1:xt(e,n,Ye,null,o,J));for(L in o)J=o[L],ee=s[L],o.hasOwnProperty(L)&&J!==ee&&(J!=null||ee!=null)&&(L==="selected"?e.selected=J&&typeof J!="function"&&typeof J!="symbol":xt(e,n,L,J,o,ee));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in s)J=s[Pe],s.hasOwnProperty(Pe)&&J!=null&&!o.hasOwnProperty(Pe)&&xt(e,n,Pe,null,o,J);for(K in o)if(J=o[K],ee=s[K],o.hasOwnProperty(K)&&J!==ee&&(J!=null||ee!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,n));break;default:xt(e,n,K,J,o,ee)}return;default:if(bs(n)){for(var St in s)J=s[St],s.hasOwnProperty(St)&&J!==void 0&&!o.hasOwnProperty(St)&&Lc(e,n,St,void 0,o,J);for(se in o)J=o[se],ee=s[se],!o.hasOwnProperty(se)||J===ee||J===void 0&&ee===void 0||Lc(e,n,se,J,o,ee);return}}for(var Y in s)J=s[Y],s.hasOwnProperty(Y)&&J!=null&&!o.hasOwnProperty(Y)&&xt(e,n,Y,null,o,J);for(he in o)J=o[he],ee=s[he],!o.hasOwnProperty(he)||J===ee||J==null&&ee==null||xt(e,n,he,J,o,ee)}var Uc=null,Ic=null;function wo(e){return e.nodeType===9?e:e.ownerDocument}function Sh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Eh(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Bc(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Fc=null;function Bg(){var e=window.event;return e&&e.type==="popstate"?e===Fc?!1:(Fc=e,!0):(Fc=null,!1)}var Ah=typeof setTimeout=="function"?setTimeout:void 0,Fg=typeof clearTimeout=="function"?clearTimeout:void 0,wh=typeof Promise=="function"?Promise:void 0,jg=typeof queueMicrotask=="function"?queueMicrotask:typeof wh<"u"?function(e){return wh.resolve(null).then(e).catch(Pg)}:Ah;function Pg(e){setTimeout(function(){throw e})}function Fr(e){return e==="head"}function Th(e,n){var s=n,o=0,c=0;do{var p=s.nextSibling;if(e.removeChild(s),p&&p.nodeType===8)if(s=p.data,s==="/$"){if(0<o&&8>o){s=o;var b=e.ownerDocument;if(s&1&&al(b.documentElement),s&2&&al(b.body),s&4)for(s=b.head,al(s),b=s.firstChild;b;){var A=b.nextSibling,L=b.nodeName;b[pr]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&b.rel.toLowerCase()==="stylesheet"||s.removeChild(b),b=A}}if(c===0){e.removeChild(p),fl(n);return}c--}else s==="$"||s==="$?"||s==="$!"?c++:o=s.charCodeAt(0)-48;else o=0;s=p}while(s);fl(n)}function jc(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var s=n;switch(n=n.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":jc(s),Mi(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}e.removeChild(s)}}function Gg(e,n,s,o){for(;e.nodeType===1;){var c=s;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[pr])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=va(e.nextSibling),e===null)break}return null}function zg(e,n,s){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=va(e.nextSibling),e===null))return null;return e}function Pc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Hg(e,n){var s=e.ownerDocument;if(e.data!=="$?"||s.readyState==="complete")n();else{var o=function(){n(),s.removeEventListener("DOMContentLoaded",o)};s.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function va(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return e}var Gc=null;function Ch(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}function Mh(e,n,s){switch(n=wo(s),e){case"html":if(e=n.documentElement,!e)throw Error(i(452));return e;case"head":if(e=n.head,!e)throw Error(i(453));return e;case"body":if(e=n.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function al(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Mi(e)}var Jn=new Map,Nh=new Set;function To(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var sr=P.d;P.d={f:Yg,r:qg,D:Vg,C:Xg,L:Zg,m:Qg,X:Kg,S:$g,M:Wg};function Yg(){var e=sr.f(),n=go();return e||n}function qg(e){var n=Ga(e);n!==null&&n.tag===5&&n.type==="form"?Zd(n):sr.r(e)}var rs=typeof document>"u"?null:document;function Rh(e,n,s){var o=rs;if(o&&typeof n=="string"&&n){var c=xn(n);c='link[rel="'+e+'"][href="'+c+'"]',typeof s=="string"&&(c+='[crossorigin="'+s+'"]'),Nh.has(c)||(Nh.add(c),e={rel:e,crossOrigin:s,href:n},o.querySelector(c)===null&&(n=o.createElement("link"),un(n,"link",e),Ft(n),o.head.appendChild(n)))}}function Vg(e){sr.D(e),Rh("dns-prefetch",e,null)}function Xg(e,n){sr.C(e,n),Rh("preconnect",e,n)}function Zg(e,n,s){sr.L(e,n,s);var o=rs;if(o&&e&&n){var c='link[rel="preload"][as="'+xn(n)+'"]';n==="image"&&s&&s.imageSrcSet?(c+='[imagesrcset="'+xn(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(c+='[imagesizes="'+xn(s.imageSizes)+'"]')):c+='[href="'+xn(e)+'"]';var p=c;switch(n){case"style":p=is(e);break;case"script":p=ss(e)}Jn.has(p)||(e=v({rel:"preload",href:n==="image"&&s&&s.imageSrcSet?void 0:e,as:n},s),Jn.set(p,e),o.querySelector(c)!==null||n==="style"&&o.querySelector(rl(p))||n==="script"&&o.querySelector(il(p))||(n=o.createElement("link"),un(n,"link",e),Ft(n),o.head.appendChild(n)))}}function Qg(e,n){sr.m(e,n);var s=rs;if(s&&e){var o=n&&typeof n.as=="string"?n.as:"script",c='link[rel="modulepreload"][as="'+xn(o)+'"][href="'+xn(e)+'"]',p=c;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ss(e)}if(!Jn.has(p)&&(e=v({rel:"modulepreload",href:e},n),Jn.set(p,e),s.querySelector(c)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(il(p)))return}o=s.createElement("link"),un(o,"link",e),Ft(o),s.head.appendChild(o)}}}function $g(e,n,s){sr.S(e,n,s);var o=rs;if(o&&e){var c=Ta(o).hoistableStyles,p=is(e);n=n||"default";var b=c.get(p);if(!b){var A={loading:0,preload:null};if(b=o.querySelector(rl(p)))A.loading=5;else{e=v({rel:"stylesheet",href:e,"data-precedence":n},s),(s=Jn.get(p))&&zc(e,s);var L=b=o.createElement("link");Ft(L),un(L,"link",e),L._p=new Promise(function(K,se){L.onload=K,L.onerror=se}),L.addEventListener("load",function(){A.loading|=1}),L.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Co(b,n,o)}b={type:"stylesheet",instance:b,count:1,state:A},c.set(p,b)}}}function Kg(e,n){sr.X(e,n);var s=rs;if(s&&e){var o=Ta(s).hoistableScripts,c=ss(e),p=o.get(c);p||(p=s.querySelector(il(c)),p||(e=v({src:e,async:!0},n),(n=Jn.get(c))&&Hc(e,n),p=s.createElement("script"),Ft(p),un(p,"link",e),s.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(c,p))}}function Wg(e,n){sr.M(e,n);var s=rs;if(s&&e){var o=Ta(s).hoistableScripts,c=ss(e),p=o.get(c);p||(p=s.querySelector(il(c)),p||(e=v({src:e,async:!0,type:"module"},n),(n=Jn.get(c))&&Hc(e,n),p=s.createElement("script"),Ft(p),un(p,"link",e),s.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(c,p))}}function Dh(e,n,s,o){var c=(c=Ee.current)?To(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(n=is(s.href),s=Ta(c).hoistableStyles,o=s.get(n),o||(o={type:"style",instance:null,count:0,state:null},s.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){e=is(s.href);var p=Ta(c).hoistableStyles,b=p.get(e);if(b||(c=c.ownerDocument||c,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,b),(p=c.querySelector(rl(e)))&&!p._p&&(b.instance=p,b.state.loading=5),Jn.has(e)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Jn.set(e,s),p||Jg(c,e,s,b.state))),n&&o===null)throw Error(i(528,""));return b}if(n&&o!==null)throw Error(i(529,""));return null;case"script":return n=s.async,s=s.src,typeof s=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ss(s),s=Ta(c).hoistableScripts,o=s.get(n),o||(o={type:"script",instance:null,count:0,state:null},s.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function is(e){return'href="'+xn(e)+'"'}function rl(e){return'link[rel="stylesheet"]['+e+"]"}function _h(e){return v({},e,{"data-precedence":e.precedence,precedence:null})}function Jg(e,n,s,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),un(n,"link",s),Ft(n),e.head.appendChild(n))}function ss(e){return'[src="'+xn(e)+'"]'}function il(e){return"script[async]"+e}function Oh(e,n,s){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+xn(s.href)+'"]');if(o)return n.instance=o,Ft(o),o;var c=v({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),Ft(o),un(o,"style",c),Co(o,s.precedence,e),n.instance=o;case"stylesheet":c=is(s.href);var p=e.querySelector(rl(c));if(p)return n.state.loading|=4,n.instance=p,Ft(p),p;o=_h(s),(c=Jn.get(c))&&zc(o,c),p=(e.ownerDocument||e).createElement("link"),Ft(p);var b=p;return b._p=new Promise(function(A,L){b.onload=A,b.onerror=L}),un(p,"link",o),n.state.loading|=4,Co(p,s.precedence,e),n.instance=p;case"script":return p=ss(s.src),(c=e.querySelector(il(p)))?(n.instance=c,Ft(c),c):(o=s,(c=Jn.get(p))&&(o=v({},s),Hc(o,c)),e=e.ownerDocument||e,c=e.createElement("script"),Ft(c),un(c,"link",o),e.head.appendChild(c),n.instance=c);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,Co(o,s.precedence,e));return n.instance}function Co(e,n,s){for(var o=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=o.length?o[o.length-1]:null,p=c,b=0;b<o.length;b++){var A=o[b];if(A.dataset.precedence===n)p=A;else if(p!==c)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=s.nodeType===9?s.head:s,n.insertBefore(e,n.firstChild))}function zc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Hc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Mo=null;function kh(e,n,s){if(Mo===null){var o=new Map,c=Mo=new Map;c.set(s,o)}else c=Mo,o=c.get(s),o||(o=new Map,c.set(s,o));if(o.has(e))return o;for(o.set(e,null),s=s.getElementsByTagName(e),c=0;c<s.length;c++){var p=s[c];if(!(p[pr]||p[mt]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(n)||"";b=e+b;var A=o.get(b);A?A.push(p):o.set(b,[p])}}return o}function Lh(e,n,s){e=e.ownerDocument||e,e.head.insertBefore(s,n==="title"?e.querySelector("head > title"):null)}function ev(e,n,s){if(s===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Uh(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var sl=null;function tv(){}function nv(e,n,s){if(sl===null)throw Error(i(475));var o=sl;if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=is(s.href),p=e.querySelector(rl(c));if(p){e=p._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(o.count++,o=No.bind(o),e.then(o,o)),n.state.loading|=4,n.instance=p,Ft(p);return}p=e.ownerDocument||e,s=_h(s),(c=Jn.get(c))&&zc(s,c),p=p.createElement("link"),Ft(p);var b=p;b._p=new Promise(function(A,L){b.onload=A,b.onerror=L}),un(p,"link",s),n.instance=p}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(n,e),(e=n.state.preload)&&(n.state.loading&3)===0&&(o.count++,n=No.bind(o),e.addEventListener("load",n),e.addEventListener("error",n))}}function av(){if(sl===null)throw Error(i(475));var e=sl;return e.stylesheets&&e.count===0&&Yc(e,e.stylesheets),0<e.count?function(n){var s=setTimeout(function(){if(e.stylesheets&&Yc(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(s)}}:null}function No(){if(this.count--,this.count===0){if(this.stylesheets)Yc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ro=null;function Yc(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ro=new Map,n.forEach(rv,e),Ro=null,No.call(e))}function rv(e,n){if(!(n.state.loading&4)){var s=Ro.get(e);if(s)var o=s.get(null);else{s=new Map,Ro.set(e,s);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<c.length;p++){var b=c[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(s.set(b.dataset.precedence,b),o=b)}o&&s.set(null,o)}c=n.instance,b=c.getAttribute("data-precedence"),p=s.get(b)||o,p===o&&s.set(null,c),s.set(b,c),this.count++,o=No.bind(this),c.addEventListener("load",o),c.addEventListener("error",o),p?p.parentNode.insertBefore(c,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),n.state.loading|=4}}var ll={$$typeof:C,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function iv(e,n,s,o,c,p,b,A){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jn(0),this.hiddenUpdates=jn(null),this.identifierPrefix=o,this.onUncaughtError=c,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function Ih(e,n,s,o,c,p,b,A,L,K,se,he){return e=new iv(e,n,s,b,A,L,K,he),n=1,p===!0&&(n|=24),p=Rn(3,null,null,n),e.current=p,p.stateNode=e,n=Tu(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:o,isDehydrated:s,cache:n},Ru(p),e}function Bh(e){return e?(e=Bi,e):Bi}function Fh(e,n,s,o,c,p){c=Bh(c),o.context===null?o.context=c:o.pendingContext=c,o=Tr(n),o.payload={element:s},p=p===void 0?null:p,p!==null&&(o.callback=p),s=Cr(e,o,n),s!==null&&(Ln(s,e,n),Bs(s,e,n))}function jh(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function qc(e,n){jh(e,n),(e=e.alternate)&&jh(e,n)}function Ph(e){if(e.tag===13){var n=Ii(e,67108864);n!==null&&Ln(n,e,67108864),qc(e,67108864)}}var Do=!0;function sv(e,n,s,o){var c=B.T;B.T=null;var p=P.p;try{P.p=2,Vc(e,n,s,o)}finally{P.p=p,B.T=c}}function lv(e,n,s,o){var c=B.T;B.T=null;var p=P.p;try{P.p=8,Vc(e,n,s,o)}finally{P.p=p,B.T=c}}function Vc(e,n,s,o){if(Do){var c=Xc(o);if(c===null)kc(e,n,o,_o,s),zh(e,o);else if(uv(c,e,n,s,o))o.stopPropagation();else if(zh(e,o),n&4&&-1<ov.indexOf(e)){for(;c!==null;){var p=Ga(c);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=ia(p.pendingLanes);if(b!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;b;){var L=1<<31-Je(b);A.entanglements[1]|=L,b&=~L}Ba(p),(gt&6)===0&&(ho=Te()+500,el(0))}}break;case 13:A=Ii(p,2),A!==null&&Ln(A,p,2),go(),qc(p,2)}if(p=Xc(o),p===null&&kc(e,n,o,_o,s),p===c)break;c=p}c!==null&&o.stopPropagation()}else kc(e,n,o,null,s)}}function Xc(e){return e=Ss(e),Zc(e)}var _o=null;function Zc(e){if(_o=null,e=zn(e),e!==null){var n=u(e);if(n===null)e=null;else{var s=n.tag;if(s===13){if(e=f(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return _o=e,null}function Gh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Kt()){case Gt:return 2;case ut:return 8;case Bt:case gn:return 32;case cr:return 268435456;default:return 32}default:return 32}}var Qc=!1,jr=null,Pr=null,Gr=null,ol=new Map,ul=new Map,zr=[],ov="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zh(e,n){switch(e){case"focusin":case"focusout":jr=null;break;case"dragenter":case"dragleave":Pr=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":ol.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ul.delete(n.pointerId)}}function cl(e,n,s,o,c,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:s,eventSystemFlags:o,nativeEvent:p,targetContainers:[c]},n!==null&&(n=Ga(n),n!==null&&Ph(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,c!==null&&n.indexOf(c)===-1&&n.push(c),e)}function uv(e,n,s,o,c){switch(n){case"focusin":return jr=cl(jr,e,n,s,o,c),!0;case"dragenter":return Pr=cl(Pr,e,n,s,o,c),!0;case"mouseover":return Gr=cl(Gr,e,n,s,o,c),!0;case"pointerover":var p=c.pointerId;return ol.set(p,cl(ol.get(p)||null,e,n,s,o,c)),!0;case"gotpointercapture":return p=c.pointerId,ul.set(p,cl(ul.get(p)||null,e,n,s,o,c)),!0}return!1}function Hh(e){var n=zn(e.target);if(n!==null){var s=u(n);if(s!==null){if(n=s.tag,n===13){if(n=f(s),n!==null){e.blockedOn=n,Rl(e.priority,function(){if(s.tag===13){var o=kn();o=Gn(o);var c=Ii(s,o);c!==null&&Ln(c,s,o),qc(s,o)}});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Oo(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=Xc(e.nativeEvent);if(s===null){s=e.nativeEvent;var o=new s.constructor(s.type,s);xs=o,s.target.dispatchEvent(o),xs=null}else return n=Ga(s),n!==null&&Ph(n),e.blockedOn=s,!1;n.shift()}return!0}function Yh(e,n,s){Oo(e)&&s.delete(n)}function cv(){Qc=!1,jr!==null&&Oo(jr)&&(jr=null),Pr!==null&&Oo(Pr)&&(Pr=null),Gr!==null&&Oo(Gr)&&(Gr=null),ol.forEach(Yh),ul.forEach(Yh)}function ko(e,n){e.blockedOn===n&&(e.blockedOn=null,Qc||(Qc=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,cv)))}var Lo=null;function qh(e){Lo!==e&&(Lo=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Lo===e&&(Lo=null);for(var n=0;n<e.length;n+=3){var s=e[n],o=e[n+1],c=e[n+2];if(typeof o!="function"){if(Zc(o||s)===null)continue;break}var p=Ga(s);p!==null&&(e.splice(n,3),n-=3,Zu(p,{pending:!0,data:c,method:s.method,action:o},o,c))}}))}function fl(e){function n(L){return ko(L,e)}jr!==null&&ko(jr,e),Pr!==null&&ko(Pr,e),Gr!==null&&ko(Gr,e),ol.forEach(n),ul.forEach(n);for(var s=0;s<zr.length;s++){var o=zr[s];o.blockedOn===e&&(o.blockedOn=null)}for(;0<zr.length&&(s=zr[0],s.blockedOn===null);)Hh(s),s.blockedOn===null&&zr.shift();if(s=(e.ownerDocument||e).$$reactFormReplay,s!=null)for(o=0;o<s.length;o+=3){var c=s[o],p=s[o+1],b=c[Dt]||null;if(typeof p=="function")b||qh(s);else if(b){var A=null;if(p&&p.hasAttribute("formAction")){if(c=p,b=p[Dt]||null)A=b.formAction;else if(Zc(c)!==null)continue}else A=b.action;typeof A=="function"?s[o+1]=A:(s.splice(o,3),o-=3),qh(s)}}}function $c(e){this._internalRoot=e}Uo.prototype.render=$c.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(i(409));var s=n.current,o=kn();Fh(s,o,e,n,null,null)},Uo.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Fh(e.current,2,null,e,null,null),go(),n[Nt]=null}};function Uo(e){this._internalRoot=e}Uo.prototype.unstable_scheduleHydration=function(e){if(e){var n=au();e={blockedOn:null,target:e,priority:n};for(var s=0;s<zr.length&&n!==0&&n<zr[s].priority;s++);zr.splice(s,0,e),s===0&&Hh(e)}};var Vh=t.version;if(Vh!=="19.1.1")throw Error(i(527,Vh,"19.1.1"));P.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=d(n),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var fv={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Io=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Io.isDisabled&&Io.supportsFiber)try{Aa=Io.inject(fv),zt=Io}catch{}}return pl.createRoot=function(e,n){if(!l(e))throw Error(i(299));var s=!1,o="",c=op,p=up,b=cp,A=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(b=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(A=n.unstable_transitionCallbacks)),n=Ih(e,1,!1,null,null,s,o,c,p,b,A,null),e[Nt]=n.current,Oc(e),new $c(n)},pl.hydrateRoot=function(e,n,s){if(!l(e))throw Error(i(299));var o=!1,c="",p=op,b=up,A=cp,L=null,K=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(L=s.unstable_transitionCallbacks),s.formState!==void 0&&(K=s.formState)),n=Ih(e,1,!0,n,s??null,o,c,p,b,A,L,K),n.context=Bh(null),s=n.current,o=kn(),o=Gn(o),c=Tr(o),c.callback=null,Cr(s,c,o),s=o,n.current.lanes=s,Wr(n,s),Ba(n),e[Nt]=n.current,Oc(e),new Uo(n)},pl.version="19.1.1",pl}var n0;function xv(){if(n0)return Jc.exports;n0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),Jc.exports=bv(),Jc.exports}var Sv=xv();const Ev=wf(Sv),Av="modulepreload",wv=function(a,t){return new URL(a,t).href},a0={},r0=function(t,r,i){let l=Promise.resolve();if(r&&r.length>0){let g=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),d=h?.nonce||h?.getAttribute("nonce");l=g(r.map(v=>{if(v=wv(v,i),v in a0)return;a0[v]=!0;const x=v.endsWith(".css"),y=x?'[rel="stylesheet"]':"";if(i)for(let S=f.length-1;S>=0;S--){const w=f[S];if(w.href===v&&(!x||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${y}`))return;const E=document.createElement("link");if(E.rel=x?"stylesheet":Av,x||(E.as="script"),E.crossOrigin="",E.href=v,d&&E.setAttribute("nonce",d),document.head.appendChild(E),x)return new Promise((S,w)=>{E.addEventListener("load",S),E.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${v}`)))})}))}function u(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return l.then(f=>{for(const h of f||[])h.status==="rejected"&&u(h.reason);return t().catch(u)})};class ya{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,r,i={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==ya.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof r!="function")throw new TypeError("The callback must be a function.");const l=new i0(t,this,r,i);return this.eventMap[t]||(this.eventMap[t]=[]),i.prepend?this.eventMap[t].unshift(l):this.eventMap[t].push(l),l}addOneTimeListener(t,r,i={}){i.remaining=1,this.addListener(t,r,i)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,r){return t===void 0?this.eventMap[ya.ANY_EVENT]&&this.eventMap[ya.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,i])=>i.length>0):this.eventMap[t]&&this.eventMap[t].length>0?r instanceof i0?this.eventMap[t].filter(l=>l===r).length>0:typeof r=="function"?this.eventMap[t].filter(l=>l.callback===r).length>0:r==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(r=>{r.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(r=>{r.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...r){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let i=[],l=this.eventMap[ya.ANY_EVENT]||[];return this.eventMap[t]&&(l=l.concat(this.eventMap[t])),l.forEach(u=>{if(u.suspended)return;let f=[...r];Array.isArray(u.arguments)&&(f=f.concat(u.arguments)),u.remaining>0&&(i.push(u.callback.apply(u.context,f)),u.count++),--u.remaining<1&&u.remove()}),i}removeListener(t,r,i={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let l=this.eventMap[t].filter(u=>r&&u.callback!==r||i.remaining&&i.remaining!==u.remaining||i.context&&i.context!==u.context);l.length?this.eventMap[t]=l:delete this.eventMap[t]}async waitFor(t,r={}){return r.duration=parseInt(r.duration),(isNaN(r.duration)||r.duration<=0)&&(r.duration=1/0),new Promise((i,l)=>{let u,f=this.addListener(t,()=>{clearTimeout(u),i()},{remaining:1});r.duration!==1/0&&(u=setTimeout(()=>{f.remove(),l("The duration expired before the event was emitted.")},r.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class i0{constructor(t,r,i,l={}){if(typeof t!="string"&&!(t instanceof String)&&t!==ya.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!r)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof i!="function")throw new TypeError("The 'callback' must be a function.");l.arguments!==void 0&&!Array.isArray(l.arguments)&&(l.arguments=[l.arguments]),l=Object.assign({context:r,remaining:1/0,arguments:void 0,duration:1/0},l),l.duration!==1/0&&setTimeout(()=>this.remove(),l.duration),this.arguments=l.arguments,this.callback=i,this.context=l.context,this.count=0,this.event=t,this.remaining=parseInt(l.remaining)>=1?parseInt(l.remaining):1/0,this.suspended=!1,this.target=r}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}class ue{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),ue.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),ue.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),ue.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),ue.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}class os{constructor(t,r={}){this.duration=be.defaults.note.duration,this.attack=be.defaults.note.attack,this.release=be.defaults.note.release,r.duration!=null&&(this.duration=r.duration),r.attack!=null&&(this.attack=r.attack),r.rawAttack!=null&&(this.attack=Se.from7bitToFloat(r.rawAttack)),r.release!=null&&(this.release=r.release),r.rawRelease!=null&&(this.release=Se.from7bitToFloat(r.rawRelease)),Number.isInteger(t)?this.identifier=Se.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const r=Se.getNoteDetails(t);if(be.validation&&!t)throw new Error("Invalid note identifier");this._name=r.name,this._accidental=r.accidental,this._octave=r.octave}get name(){return this._name}set name(t){if(be.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(be.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(be.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(be.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(be.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(be.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return Se.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=Se.from7bitToFloat(t)}get rawRelease(){return Se.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=Se.from7bitToFloat(t)}get number(){return Se.toNoteNumber(this.identifier)}getOffsetNumber(t=0,r=0){return be.validation&&(t=parseInt(t)||0,r=parseInt(r)||0),Math.min(Math.max(this.number+t*12+r,0),127)}}class Se{static toNoteNumber(t,r=0){if(r=r==null?0:parseInt(r),isNaN(r))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const i=this.getNoteDetails(t);if(!i)throw new TypeError("Invalid note identifier");const l={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let u=(i.octave+1+r)*12;if(u+=l[i.name],i.accidental&&(i.accidental.startsWith("b")?u-=i.accidental.length:u+=i.accidental.length),u<0||u>127)throw new RangeError("Invalid octaveOffset value");return u}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const r=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!r)throw new TypeError("Invalid note identifier");const i=r[1].toUpperCase(),l=parseInt(r[3]);let u=r[2].toLowerCase();return u=u===""?void 0:u,{accidental:u,identifier:i+(u||"")+l,name:i,octave:l}}static sanitizeChannels(t){let r;if(be.validation){if(t==="all")r=["all"];else if(t==="none")return[]}return Array.isArray(t)?r=t:r=[t],r.indexOf("all")>-1&&(r=ue.MIDI_CHANNEL_NUMBERS),r.map(function(i){return parseInt(i)}).filter(function(i){return i>=1&&i<=16})}static toTimestamp(t){let r=!1;const i=parseFloat(t);return isNaN(i)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?i>=0&&(r=be.time+i):i>=0&&(r=i),r)}static guessNoteNumber(t,r){r=parseInt(r)||0;let i=!1;if(Number.isInteger(t)&&t>=0&&t<=127)i=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)i=parseInt(t);else if(typeof t=="string"||t instanceof String)try{i=this.toNoteNumber(t.trim(),r)}catch{return!1}return i}static toNoteIdentifier(t,r){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(r=r==null?0:parseInt(r),isNaN(r))throw new RangeError("Invalid octaveOffset value");const i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],l=Math.floor(t/12-1)+r;return i[t%12]+l.toString()}static buildNote(t,r={}){if(r.octaveOffset=parseInt(r.octaveOffset)||0,t instanceof os)return t;let i=this.guessNoteNumber(t,r.octaveOffset);if(i===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return r.octaveOffset=void 0,new os(i,r)}static buildNoteArray(t,r={}){let i=[];return Array.isArray(t)||(t=[t]),t.forEach(l=>{i.push(this.buildNote(l,r))}),i}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,r=0){be.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),r=Math.min(Math.max(parseInt(r)||0,0),127));const i=((t<<7)+r)/16383;return Math.min(Math.max(i,0),1)}static fromFloatToMsbLsb(t){be.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const r=Math.round(t*16383);return{msb:r>>7,lsb:r&127}}static offsetNumber(t,r=0,i=0){if(be.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");r=parseInt(r)||0,i=parseInt(i)||0}return Math.min(Math.max(t+r*12+i,0),127)}static getPropertyByValue(t,r){return Object.keys(t).find(i=>t[i]===r)}static getCcNameByNumber(t){if(!(be.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return ue.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let r=ue.CONTROL_CHANGE_MESSAGES.find(i=>i.name===t);return r?r.number:ue.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let r in ue.CHANNEL_MODE_MESSAGES)if(ue.CHANNEL_MODE_MESSAGES.hasOwnProperty(r)&&t===ue.CHANNEL_MODE_MESSAGES[r])return r;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}class Tv extends ya{constructor(t,r){super(),this._output=t,this._number=r,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,r={time:0}){return this.output.send(t,r),this}sendKeyAftertouch(t,r,i={}){if(be.validation){if(i.useRawValue&&(i.rawValue=i.useRawValue),isNaN(parseFloat(r)))throw new RangeError("Invalid key aftertouch value.");if(i.rawValue){if(!(r>=0&&r<=127&&Number.isInteger(r)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(r>=0&&r<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}i.rawValue||(r=Se.fromFloatTo7Bit(r));const l=be.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),Se.buildNoteArray(t).forEach(u=>{this.send([(ue.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),u.getOffsetNumber(l),r],{time:Se.toTimestamp(i.time)})}),this}sendControlChange(t,r,i={}){if(typeof t=="string"&&(t=Se.getCcNumberByName(t)),Array.isArray(r)||(r=[r]),be.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(r=r.map(l=>{const u=Math.min(Math.max(parseInt(l),0),127);if(isNaN(u))throw new TypeError("Values must be integers between 0 and 127");return u}),r.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return r.forEach((l,u)=>{this.send([(ue.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+u*32,r[u]],{time:Se.toTimestamp(i.time)})}),this}_selectNonRegisteredParameter(t,r={}){return this.sendControlChange(99,t[0],r),this.sendControlChange(98,t[1],r),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,r={}){return this.sendControlChange(101,t[0],r),this.sendControlChange(100,t[1],r),this}_setCurrentParameter(t,r={}){return t=[].concat(t),this.sendControlChange(6,t[0],r),t.length<2?this:(this.sendControlChange(38,t[1],r),this)}sendRpnDecrement(t,r={}){if(Array.isArray(t)||(t=ue.REGISTERED_PARAMETERS[t]),be.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let i=!1;if(Object.getOwnPropertyNames(ue.REGISTERED_PARAMETERS).forEach(l=>{ue.REGISTERED_PARAMETERS[l][0]===t[0]&&ue.REGISTERED_PARAMETERS[l][1]===t[1]&&(i=!0)}),!i)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,r),this.sendControlChange(97,0,r),this._deselectRegisteredParameter(r),this}sendRpnIncrement(t,r={}){if(Array.isArray(t)||(t=ue.REGISTERED_PARAMETERS[t]),be.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let i=!1;if(Object.getOwnPropertyNames(ue.REGISTERED_PARAMETERS).forEach(l=>{ue.REGISTERED_PARAMETERS[l][0]===t[0]&&ue.REGISTERED_PARAMETERS[l][1]===t[1]&&(i=!0)}),!i)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,r),this.sendControlChange(96,0,r),this._deselectRegisteredParameter(r),this}playNote(t,r={}){this.sendNoteOn(t,r);const i=Array.isArray(t)?t:[t];for(let l of i)if(parseInt(l.duration)>0){const u={time:(Se.toTimestamp(r.time)||be.time)+parseInt(l.duration),release:l.release,rawRelease:l.rawRelease};this.sendNoteOff(l,u)}else if(parseInt(r.duration)>0){const u={time:(Se.toTimestamp(r.time)||be.time)+parseInt(r.duration),release:r.release,rawRelease:r.rawRelease};this.sendNoteOff(l,u)}return this}sendNoteOff(t,r={}){if(be.validation){if(r.rawRelease!=null&&!(r.rawRelease>=0&&r.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(r.release!=null&&!(r.release>=0&&r.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");r.rawVelocity&&(r.rawRelease=r.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),r.velocity&&(r.release=r.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let i=64;r.rawRelease!=null?i=r.rawRelease:isNaN(r.release)||(i=Math.round(r.release*127));const l=be.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Se.buildNoteArray(t,{rawRelease:parseInt(i)}).forEach(u=>{this.send([(ue.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),u.getOffsetNumber(l),u.rawRelease],{time:Se.toTimestamp(r.time)})}),this}stopNote(t,r={}){return this.sendNoteOff(t,r)}sendNoteOn(t,r={}){if(be.validation){if(r.rawAttack!=null&&!(r.rawAttack>=0&&r.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(r.attack!=null&&!(r.attack>=0&&r.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");r.rawVelocity&&(r.rawAttack=r.velocity,r.rawRelease=r.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),r.velocity&&(r.attack=r.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let i=64;r.rawAttack!=null?i=r.rawAttack:isNaN(r.attack)||(i=Math.round(r.attack*127));const l=be.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Se.buildNoteArray(t,{rawAttack:i}).forEach(u=>{this.send([(ue.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),u.getOffsetNumber(l),u.rawAttack],{time:Se.toTimestamp(r.time)})}),this}sendChannelMode(t,r=0,i={}){if(typeof t=="string"&&(t=ue.CHANNEL_MODE_MESSAGES[t]),be.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(r))||r<0||r>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(ue.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,r],{time:Se.toTimestamp(i.time)}),this}sendOmniMode(t,r={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,r):this.sendChannelMode("omnimodeoff",0,r),this}sendChannelAftertouch(t,r={}){if(be.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(r.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return r.rawValue||(t=Se.fromFloatTo7Bit(t)),this.send([(ue.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:Se.toTimestamp(r.time)}),this}sendMasterTuning(t,r={}){if(t=parseFloat(t)||0,be.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let i=Math.floor(t)+64,l=t-Math.floor(t);l=Math.round((l+1)/2*16383);let u=l>>7&127,f=l&127;return this.sendRpnValue("channelcoarsetuning",i,r),this.sendRpnValue("channelfinetuning",[u,f],r),this}sendModulationRange(t,r,i={}){if(be.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(r!=null&&(!Number.isInteger(r)||!(r>=0&&r<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return r>=0&&r<=127||(r=0),this.sendRpnValue("modulationrange",[t,r],i),this}sendNrpnValue(t,r,i={}){if(r=[].concat(r),be.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");r.forEach(l=>{if(!(l>=0&&l<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,i),this._setCurrentParameter(r,i),this._deselectNonRegisteredParameter(i),this}sendPitchBend(t,r={}){if(be.validation)if(r.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(r.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let i=0,l=0;if(r.rawValue&&Array.isArray(t))i=t[0],l=t[1];else if(r.rawValue&&!Array.isArray(t))i=t;else{const u=Se.fromFloatToMsbLsb((t+1)/2);i=u.msb,l=u.lsb}return this.send([(ue.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),l,i],{time:Se.toTimestamp(r.time)}),this}sendPitchBendRange(t,r,i={}){if(be.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(r)||!(r>=0&&r<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,r],i),this}sendProgramChange(t,r={}){if(t=parseInt(t)||0,be.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(ue.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:Se.toTimestamp(r.time)}),this}sendRpnValue(t,r,i={}){if(Array.isArray(t)||(t=ue.REGISTERED_PARAMETERS[t]),be.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(r).forEach(l=>{if(!(l>=0&&l<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,i),this._setCurrentParameter(r,i),this._deselectRegisteredParameter(i),this}sendTuningBank(t,r={}){if(be.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,r),this}sendTuningProgram(t,r={}){if(be.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,r),this}sendLocalControl(t,r={}){return t?this.sendChannelMode("localcontrol",127,r):this.sendChannelMode("localcontrol",0,r)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,r={}){return t==="mono"?this.sendChannelMode("monomodeon",0,r):this.sendChannelMode("polymodeon",0,r)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}class pf extends ya{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let r=1;r<=16;r++)this.channels[r]=new Tv(this,r);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let r={timestamp:be.time};t.port.connection==="open"?(r.type="opened",r.target=this,r.port=r.target,this.emit("opened",r)):t.port.connection==="closed"&&t.port.state==="connected"?(r.type="closed",r.target=this,r.port=r.target,this.emit("closed",r)):t.port.connection==="closed"&&t.port.state==="disconnected"?(r.type="disconnected",r.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",r)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,r={time:0},i=0){if(t instanceof Z0&&(t=Se.isNode?t.data:t.rawData),t instanceof Uint8Array&&Se.isNode&&(t=Array.from(t)),be.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(r)&&(t=t.concat(r)),r=isNaN(i)?{time:0}:{time:i}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(l=>{if(l=parseInt(l),!(l>=0&&l<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),r||(r={time:0})}return this._midiOutput.send(t,Se.toTimestamp(r.time)),this}sendSysex(t,r=[],i={}){if(t=[].concat(t),r instanceof Uint8Array){const l=new Uint8Array(1+t.length+r.length+1);l[0]=ue.SYSTEM_MESSAGES.sysex,l.set(Uint8Array.from(t),1),l.set(r,1+t.length),l[l.length-1]=ue.SYSTEM_MESSAGES.sysexend,this.send(l,{time:i.time})}else{const l=t.concat(r,ue.SYSTEM_MESSAGES.sysexend);this.send([ue.SYSTEM_MESSAGES.sysex].concat(l),{time:i.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():be.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,r={}){if(be.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([ue.SYSTEM_MESSAGES.timecode,t],{time:r.time}),this}sendSongPosition(t=0,r={}){t=Math.floor(t)||0;var i=t>>7&127,l=t&127;return this.send([ue.SYSTEM_MESSAGES.songposition,i,l],{time:r.time}),this}sendSongSelect(t=0,r={}){if(be.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([ue.SYSTEM_MESSAGES.songselect,t],{time:r.time}),this}sendTuneRequest(t={}){return this.send([ue.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([ue.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([ue.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([ue.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([ue.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([ue.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([ue.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return be.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendKeyAftertouch(t,r,i)}),this}sendControlChange(t,r,i={},l={}){if(be.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const u=i;i=l,i.channels=u,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(u=>{this.channels[u].sendControlChange(t,r,i)}),this}sendPitchBendRange(t=0,r=0,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendPitchBendRange(t,r,i)}),this}setPitchBendRange(t=0,r=0,i="all",l={}){return be.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,r,l)}sendRpnValue(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendRpnValue(t,r,i)}),this}setRegisteredParameter(t,r=[],i="all",l={}){return be.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,r,l)}sendChannelAftertouch(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendChannelAftertouch(t,r)}),this}sendPitchBend(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendPitchBend(t,r)}),this}sendProgramChange(t=0,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendProgramChange(t,r)}),this}sendModulationRange(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendModulationRange(t,r,i)}),this}setModulationRange(t=0,r=0,i="all",l={}){return be.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,r,l)}sendMasterTuning(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendMasterTuning(t,r)}),this}setMasterTuning(t,r={},i={}){return be.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,i)}sendTuningProgram(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendTuningProgram(t,r)}),this}setTuningProgram(t,r="all",i={}){return be.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,i)}sendTuningBank(t=0,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendTuningBank(t,r)}),this}setTuningBank(t,r="all",i={}){return be.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,i)}sendChannelMode(t,r=0,i={},l={}){if(be.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const u=i;i=l,i.channels=u,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(u=>{this.channels[u].sendChannelMode(t,r,i)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},r={}){if(be.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const i=t;t=r,t.channels=i,t.channels==="all"&&(t.channels=ue.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(t.channels).forEach(i=>{this.channels[i].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendPolyphonicMode(t,r)}),this}sendLocalControl(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendLocalControl(t,r)}),this}sendOmniMode(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendOmniMode(t,r)}),this}sendNrpnValue(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendNrpnValue(t,r,i)}),this}setNonRegisteredParameter(t,r=[],i="all",l={}){return be.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,r,l)}sendRpnIncrement(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnIncrement(t,r)}),this}incrementRegisteredParameter(t,r="all",i={}){return be.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,i)}sendRpnDecrement(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnDecrement(t,r)}),this}decrementRegisteredParameter(t,r="all",i={}){return be.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,i)}sendNoteOff(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendNoteOff(t,r)}),this}stopNote(t,r){return this.sendNoteOff(t,r)}playNote(t,r={},i={}){if(be.validation&&(r.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),r.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].playNote(t,r)}),this}sendNoteOn(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendNoteOn(t,r)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}class s0{constructor(t=[],r={}){this.destinations=[],this.types=[...Object.keys(ue.SYSTEM_MESSAGES),...Object.keys(ue.CHANNEL_MESSAGES)],this.channels=ue.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),r.types&&!Array.isArray(r.types)&&(r.types=[r.types]),r.channels&&!Array.isArray(r.channels)&&(r.channels=[r.channels]),be.validation&&(t.forEach(i=>{if(!(i instanceof pf))throw new TypeError("Destinations must be of type 'Output'.")}),r.types!==void 0&&r.types.forEach(i=>{if(!ue.SYSTEM_MESSAGES.hasOwnProperty(i)&&!ue.CHANNEL_MESSAGES.hasOwnProperty(i))throw new TypeError("Type must be a valid message type.")}),r.channels!==void 0&&r.channels.forEach(i=>{if(!ue.MIDI_CHANNEL_NUMBERS.includes(i))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,r.types&&(this.types=r.types),r.channels&&(this.channels=r.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(r=>{be.validation&&!(r instanceof pf)||r.send(t)}))}}class Cv extends ya{constructor(t,r){super(),this._input=t,this._number=r,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const r=Object.assign({},t);r.port=this.input,r.target=this,r.type="midimessage",this.emit(r.type,r),this._parseEventForStandardMessages(r)}_parseEventForStandardMessages(t){const r=Object.assign({},t);r.type=r.message.type||"unknownmessage";const i=t.message.dataBytes[0],l=t.message.dataBytes[1];if(r.type==="noteoff"||r.type==="noteon"&&l===0)this.notesState[i]=!1,r.type="noteoff",r.note=new os(Se.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+be.octaveOffset),{rawAttack:0,rawRelease:l}),r.value=Se.from7bitToFloat(l),r.rawValue=l,r.velocity=r.note.release,r.rawVelocity=r.note.rawRelease;else if(r.type==="noteon")this.notesState[i]=!0,r.note=new os(Se.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+be.octaveOffset),{rawAttack:l}),r.value=Se.from7bitToFloat(l),r.rawValue=l,r.velocity=r.note.attack,r.rawVelocity=r.note.rawAttack;else if(r.type==="keyaftertouch")r.note=new os(Se.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+be.octaveOffset)),r.value=Se.from7bitToFloat(l),r.rawValue=l,r.identifier=r.note.identifier,r.key=r.note.number,r.rawKey=i;else if(r.type==="controlchange"){r.controller={number:i,name:ue.CONTROL_CHANGE_MESSAGES[i].name,description:ue.CONTROL_CHANGE_MESSAGES[i].description,position:ue.CONTROL_CHANGE_MESSAGES[i].position},r.subtype=r.controller.name||"controller"+i,r.value=Se.from7bitToFloat(l),r.rawValue=l;const u=Object.assign({},r);u.type=`${r.type}-controller${i}`,delete u.subtype,this.emit(u.type,u);const f=Object.assign({},r);f.type=`${r.type}-`+ue.CONTROL_CHANGE_MESSAGES[i].name,delete f.subtype,f.type.indexOf("controller")!==0&&this.emit(f.type,f),r.message.dataBytes[0]>=120&&this._parseChannelModeMessage(r),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(r.message.dataBytes[0])&&this._parseEventForParameterNumber(r)}else r.type==="programchange"?(r.value=i,r.rawValue=r.value):r.type==="channelaftertouch"?(r.value=Se.from7bitToFloat(i),r.rawValue=i):r.type==="pitchbend"?(r.value=((l<<7)+i-8192)/8192,r.rawValue=(l<<7)+i):r.type="unknownmessage";this.emit(r.type,r)}_parseChannelModeMessage(t){const r=Object.assign({},t);r.type=r.controller.name,r.type==="localcontrol"&&(r.value=r.message.data[2]===127,r.rawValue=r.message.data[2]),r.type==="omnimodeon"?(r.type="omnimode",r.value=!0,r.rawValue=r.message.data[2]):r.type==="omnimodeoff"&&(r.type="omnimode",r.value=!1,r.rawValue=r.message.data[2]),r.type==="monomodeon"?(r.type="monomode",r.value=!0,r.rawValue=r.message.data[2]):r.type==="polymodeon"&&(r.type="monomode",r.value=!1,r.rawValue=r.message.data[2]),this.emit(r.type,r)}_parseEventForParameterNumber(t){const r=t.message.dataBytes[0],i=t.message.dataBytes[1];r===99||r===101?(this._nrpnBuffer=[],this._rpnBuffer=[],r===99?this._nrpnBuffer=[t.message]:i!==127&&(this._rpnBuffer=[t.message])):r===98||r===100?r===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&i!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(r===6||r===38||r===96||r===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,r,i,l){t=t==="nrpn"?"nrpn":"rpn";const u={target:l.target,timestamp:l.timestamp,message:l.message,parameterMsb:r,parameterLsb:i,value:Se.from7bitToFloat(l.message.dataBytes[1]),rawValue:l.message.dataBytes[1]};t==="rpn"?u.parameter=Object.keys(ue.REGISTERED_PARAMETERS).find(d=>ue.REGISTERED_PARAMETERS[d][0]===r&&ue.REGISTERED_PARAMETERS[d][1]===i):u.parameter=(r<<7)+i;const f=ue.CONTROL_CHANGE_MESSAGES[l.message.dataBytes[0]].name;u.type=`${t}-${f}`,this.emit(u.type,u);const h=Object.assign({},u);h.type==="nrpn-dataincrement"?h.type="nrpn-databuttonincrement":h.type==="nrpn-datadecrement"?h.type="nrpn-databuttondecrement":h.type==="rpn-dataincrement"?h.type="rpn-databuttonincrement":h.type==="rpn-datadecrement"&&(h.type="rpn-databuttondecrement"),this.emit(h.type,h),u.type=t,u.subtype=f,this.emit(u.type,u)}getChannelModeByNumber(t){return be.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),Se.getChannelModeByNumber(t)}getCcNameByNumber(t){if(be.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return Se.getCcNameByNumber(t)}getNoteState(t){t instanceof os&&(t=t.identifier);const r=Se.guessNoteNumber(t,be.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[r]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}class Z0{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=Se.getPropertyByValue(ue.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=Se.getPropertyByValue(ue.SYSTEM_MESSAGES,this.command)),this.statusByte===ue.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}class Mv extends ya{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let r=1;r<=16;r++)this.channels[r]=new Cv(this,r);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let r={timestamp:be.time,target:this,port:this};t.port.connection==="open"?(r.type="opened",this.emit("opened",r)):t.port.connection==="closed"&&t.port.state==="connected"?(r.type="closed",this.emit("closed",r)):t.port.connection==="closed"&&t.port.state==="disconnected"?(r.type="disconnected",r.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",r)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const r=new Z0(t.data),i={port:this,target:this,message:r,timestamp:t.timeStamp,type:"midimessage",data:r.data,rawData:r.data,statusByte:r.data[0],dataBytes:r.dataBytes};this.emit("midimessage",i),r.isSystemMessage?this._parseEvent(i):r.isChannelMessage&&this.channels[r.channel]._processMidiMessageEvent(i),this._forwarders.forEach(l=>l.forward(r))}_parseEvent(t){const r=Object.assign({},t);r.type=r.message.type||"unknownmidimessage",r.type==="songselect"&&(r.song=t.data[1]+1,r.value=t.data[1],r.rawValue=r.value),this.emit(r.type,r)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){be.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,r,i={}){if(be.validation&&typeof i=="function"){let l=r!=null?[].concat(r):void 0;r=i,i={channels:l}}if(ue.CHANNEL_EVENTS.includes(t)){i.channels===void 0&&(i.channels=ue.MIDI_CHANNEL_NUMBERS);let l=[];return Se.sanitizeChannels(i.channels).forEach(u=>{l.push(this.channels[u].addListener(t,r,i))}),l}else return super.addListener(t,r,i)}addOneTimeListener(t,r,i={}){return i.remaining=1,this.addListener(t,r,i)}on(t,r,i,l){return this.addListener(t,r,i,l)}hasListener(t,r,i={}){if(be.validation&&typeof i=="function"){let l=[].concat(r);r=i,i={channels:l}}return ue.CHANNEL_EVENTS.includes(t)?(i.channels===void 0&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).every(l=>this.channels[l].hasListener(t,r))):super.hasListener(t,r)}removeListener(t,r,i={}){if(be.validation&&typeof i=="function"){let l=[].concat(r);r=i,i={channels:l}}if(i.channels===void 0&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),t==null)return Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l]&&this.channels[l].removeListener()}),super.removeListener();ue.CHANNEL_EVENTS.includes(t)?Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].removeListener(t,r,i)}):super.removeListener(t,r,i)}addForwarder(t,r={}){let i;return t instanceof s0?i=t:i=new s0(t,r),this._forwarders.push(i),i}removeForwarder(t){this._forwarders=this._forwarders.filter(r=>r!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return be.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}class Nv extends ya{constructor(){super(),this.defaults={note:{attack:Se.from7bitToFloat(64),release:Se.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},r=!1){if(Se.isNode)try{window.navigator}catch{let h=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,h)}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:r}),r&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const i={timestamp:this.time,target:this,type:"error",error:void 0},l={timestamp:this.time,target:this,type:"midiaccessgranted"},u={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(f){return i.error=f,this.emit("error",i),typeof t.callback=="function"&&t.callback(f),Promise.reject(f)}this.emit("midiaccessgranted",l),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(f){return i.error=f,this.emit("error",i),typeof t.callback=="function"&&t.callback(f),Promise.reject(f)}return this.emit("enabled",u),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(r.disconnected){for(let i=0;i<this._disconnectedInputs.length;i++)if(this._disconnectedInputs[i]._midiInput&&this._disconnectedInputs[i].id===t.toString())return this._disconnectedInputs[i]}else for(let i=0;i<this.inputs.length;i++)if(this.inputs[i]._midiInput&&this.inputs[i].id===t.toString())return this.inputs[i]}getInputByName(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(r.disconnected){for(let i=0;i<this._disconnectedInputs.length;i++)if(~this._disconnectedInputs[i].name.indexOf(t))return this._disconnectedInputs[i]}else for(let i=0;i<this.inputs.length;i++)if(~this.inputs[i].name.indexOf(t))return this.inputs[i]}getOutputByName(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(r.disconnected){for(let i=0;i<this._disconnectedOutputs.length;i++)if(~this._disconnectedOutputs[i].name.indexOf(t))return this._disconnectedOutputs[i]}else for(let i=0;i<this.outputs.length;i++)if(~this.outputs[i].name.indexOf(t))return this.outputs[i]}getOutputById(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(r.disconnected){for(let i=0;i<this._disconnectedOutputs.length;i++)if(this._disconnectedOutputs[i]._midiOutput&&this._disconnectedOutputs[i].id===t.toString())return this._disconnectedOutputs[i]}else for(let i=0;i<this.outputs.length;i++)if(this.outputs[i]._midiOutput&&this.outputs[i].id===t.toString())return this.outputs[i]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),Se.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?Se.getNoteDetails(Se.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),Se.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),Se.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),Se.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,r={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),Se.buildNoteArray(t,r)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),Se.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(r=>t.push(r.destroy())),this.outputs.forEach(r=>t.push(r.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let r={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?r.port=this.getOutputById(t.port.id):t.port.type==="input"&&(r.port=this.getInputById(t.port.id)),this.emit(t.port.state,r);const i=Object.assign({},r);i.type="portschanged",this.emit(i.type,i)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?r.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(r.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,r);const i=Object.assign({},r);i.type="portschanged",this.emit(i.type,i)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let r=this._inputs.length-1;r>=0;r--){const i=this._inputs[r];Array.from(this.interface.inputs.values()).find(u=>u===i._midiInput)||(this._disconnectedInputs.push(i),this._inputs.splice(r,1))}let t=[];return this.interface.inputs.forEach(r=>{if(!this._inputs.find(i=>i._midiInput===r)){let i=this._disconnectedInputs.find(l=>l._midiInput===r);i||(i=new Mv(r)),this._inputs.push(i),t.push(i.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let r=this._outputs.length-1;r>=0;r--){const i=this._outputs[r];Array.from(this.interface.outputs.values()).find(u=>u===i._midiOutput)||(this._disconnectedOutputs.push(i),this._outputs.splice(r,1))}let t=[];return this.interface.outputs.forEach(r=>{if(!this._outputs.find(i=>i._midiOutput===r)){let i=this._disconnectedOutputs.find(l=>l._midiOutput===r);i||(i=new pf(r)),this._outputs.push(i),t.push(i.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),Se.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),Se.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.14"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),ue.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),ue.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),ue.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),ue.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),ue.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const be=new Nv;be.constructor=null;const Rv=async()=>{if(be.enabled)return be;try{return await be.enable({sysex:!0}),console.log("WebMidi is enabled with SysEx support!"),be}catch(a){throw console.error("WebMidi could not be enabled.",a),a}},l0=()=>be.enabled?be.inputs.map(a=>({id:a.id,name:a.name})):[],Dv=(a,t)=>{if(be.enabled){const r=be.getInputById(a);if(r){const i=f=>{t({type:"noteon",note:f.note.identifier,velocity:f.velocity,controller:null,channel:f.message.channel})},l=f=>{t({type:"noteoff",note:f.note.identifier,velocity:0,controller:null,channel:f.message.channel})},u=f=>{t({type:"controlchange",controller:f.controller.number,value:f.rawValue,note:null,channel:f.message.channel})};return r.addListener("noteon",i),r.addListener("noteoff",l),r.addListener("controlchange",u),()=>{r.removeListener("noteon",i),r.removeListener("noteoff",l),r.removeListener("controlchange",u)}}}return()=>{}},_v=a=>{if(be.enabled){const t=r=>{a(r)};return be.addListener("connected",t),be.addListener("disconnected",t),()=>{be.removeListener("connected",t),be.removeListener("disconnected",t)}}return()=>{}},Ov=(a,t)=>{if(be.enabled){const r=be.getInputById(a);if(r){const i=be.outputs.find(l=>l.name===r.name);i?(i.sendSysex(71,t),console.log(`Sent SysEx to ${i.name}`)):console.warn("Could not find matching MIDI Output for SysEx")}}},Ho=(a,t,r,i)=>{if(be.enabled){const l=be.getInputById(a);if(l){const u=be.outputs.find(f=>f.name===l.name);u&&u.sendNoteOn(t,{attack:r/127,channels:i})}}},Q0=T.createContext(null),Jo=()=>T.useContext(Q0),kv=({children:a,onMidiCommand:t})=>{const[r,i]=T.useState(!1),[l,u]=T.useState([]),[f,h]=T.useState(""),[d,g]=T.useState(!1),[v,x]=T.useState(null),[y,E]=T.useState({}),[S,w]=T.useState(null),[D,U]=T.useState(!1),k=T.useRef(!1),C=T.useRef(t);T.useEffect(()=>{C.current=t},[t]),T.useEffect(()=>{(async()=>{try{await Rv(),i(!0);const B=l0();if(u(B),_v(()=>{console.log("MIDI Device change detected, refreshing inputs..."),u(l0())}),window.electronAPI&&window.electronAPI.getSelectedMidiInput){const P=await window.electronAPI.getSelectedMidiInput();P&&B.some(V=>V.id===P)?h(P):B.length>0&&(f||h(B[0].id))}else B.length>0&&(f||h(B[0].id));if(window.electronAPI&&window.electronAPI.getMidiMappings){const P=await window.electronAPI.getMidiMappings();P&&(console.log("Loaded saved MIDI mappings:",P),E(P))}}catch(B){console.error("MIDI Init Failed:",B)}})()},[]);const M=async()=>{window.electronAPI&&window.electronAPI.saveMidiMappings&&(await window.electronAPI.saveMidiMappings(y),console.log("MIDI mappings saved to default."))},F=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(y,"midi")},H=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const W=await window.electronAPI.importMappings("midi");W.success&&W.mappings&&(E(W.mappings),console.log("MIDI mappings imported."))}},fe=W=>{const B=l.find(P=>P.id===W);B&&B.name.toLowerCase().includes("apc40")&&(console.log("Detected APC40, sending initialization SysEx..."),Ov(W,[127,41,96,0,4,65,1,1,1]))};T.useEffect(()=>{f&&window.electronAPI&&window.electronAPI.saveSelectedMidiInput&&window.electronAPI.saveSelectedMidiInput(f),f&&r&&fe(f)},[f,r,l]);const de=T.useCallback((W,B,P=null)=>{if(!f||!r)return;const V=y[W];if(V&&V.type==="note"){let pe=0;typeof B=="number"?pe=B:pe=B?127:0;const R=P!==null?P:V.channel;Ho(f,V.address,pe,R)}},[f,r,y]);T.useEffect(()=>{let W=()=>{};return f&&(W=Dv(f,B=>{ce.current&&w(B),le(B)})),W},[f,d,v,y]);const ce=T.useRef(d);T.useEffect(()=>{ce.current=d},[d]);const le=W=>{if(W.channel===1&&W.note==="D7"){const P=W.type==="noteon";U(P),k.current=P,console.log(`Shift ${P?"Down":"Up"}`);return}if(d&&v){if(W.type==="noteoff")return;const P=W.note||W.controller,V=k.current,pe={type:W.type==="noteon"||W.type==="noteoff"?"note":"cc",channel:W.channel,address:P,requiresShift:V,label:`${V?"":""}CH${W.channel}:${P}`};console.log(`Mapped ${v} to:`,pe),E(R=>({...R,[v]:pe})),x(null);return}Object.entries(y).forEach(([P,V])=>{const pe=(W.type==="noteon"||W.type==="noteoff")&&V.type==="note"&&W.note===V.address&&W.channel===V.channel,R=W.type==="controlchange"&&V.type==="cc"&&W.controller===V.address&&W.channel===V.channel,G=V.type==="cc"||!!V.requiresShift===k.current;if((pe||R)&&G&&C.current){let ie;W.type==="controlchange"?ie=W.value??0:W.type==="noteoff"?ie=0:ie=W.velocity??0,C.current(P,ie,127,W.type)}})},$={midiInitialized:r,midiInputs:l,selectedMidiInputId:f,setSelectedMidiInputId:h,isMapping:d,startMapping:()=>g(!0),stopMapping:()=>{g(!1),x(null)},learningId:v,setLearningId:x,mappings:y,setMappings:E,removeMapping:W=>{E(B=>{const P={...B};return delete P[W],P})},saveMappings:M,exportMappings:F,importMappings:H,initializeApc40:fe,sendFeedback:de,lastMidiEvent:S,isShiftDown:D};return m.jsx(Q0.Provider,{value:$,children:a})},$0=T.createContext(null),Cf=()=>T.useContext($0),Lv=({children:a,onArtnetCommand:t})=>{const[r,i]=T.useState(!1),[l,u]=T.useState(!1),[f,h]=T.useState(null),[d,g]=T.useState({}),[v,x]=T.useState(null),y=T.useRef(t);T.useEffect(()=>{y.current=t},[t]),T.useEffect(()=>{(async()=>{try{if(window.electronAPI&&window.electronAPI.initializeArtnet&&(await window.electronAPI.initializeArtnet()).success&&(i(!0),console.log("Art-Net initialized for mapping")),window.electronAPI&&window.electronAPI.getArtnetMappings){const H=await window.electronAPI.getArtnetMappings();H&&(console.log("Loaded saved Art-Net mappings:",H),g(H))}}catch(H){console.error("Art-Net Init Failed:",H)}})()},[]);const E=async()=>{window.electronAPI&&window.electronAPI.saveArtnetMappings&&(await window.electronAPI.saveArtnetMappings(d),console.log("Art-Net mappings saved."))},S=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(d,"artnet")},w=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const F=await window.electronAPI.importMappings("artnet");F.success&&F.mappings&&(g(F.mappings),console.log("Art-Net mappings imported."))}};T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onArtnetDataReceived)return window.electronAPI.onArtnetDataReceived(H=>{D.current&&x(H),U(H)})},[l,f,d]);const D=T.useRef(l);T.useEffect(()=>{D.current=l},[l]);const U=F=>{const{universe:H,channel:fe,value:de}=F;if(l&&f){if(de===0)return;const ce={universe:H,channel:fe,label:`U${H}:CH${fe+1}`};console.log(`Mapped ${f} to Art-Net:`,ce),g(le=>({...le,[f]:ce})),h(null);return}Object.entries(d).forEach(([ce,le])=>{le.universe===H&&le.channel===fe&&y.current&&y.current(ce,de)})},M={artnetInitialized:r,isMapping:l,startMapping:()=>u(!0),stopMapping:()=>{u(!1),h(null)},learningId:f,setLearningId:h,mappings:d,setMappings:g,saveMappings:E,exportMappings:S,importMappings:w,lastDmxEvent:v};return m.jsx($0.Provider,{value:M,children:a})},K0=T.createContext(null),Mf=()=>T.useContext(K0),Uv=({children:a,onCommand:t,enabled:r=!1})=>{const[i,l]=T.useState(!1),[u,f]=T.useState(null),[h,d]=T.useState({}),g=T.useRef(t);T.useEffect(()=>{g.current=t},[t]),T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getKeyboardMappings){const w=await window.electronAPI.getKeyboardMappings();w&&d(w)}})()},[]);const v=async()=>{window.electronAPI&&window.electronAPI.saveKeyboardMappings&&await window.electronAPI.saveKeyboardMappings(h)},x=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(h,"keyboard")},y=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const S=await window.electronAPI.importMappings("keyboard");S.success&&S.mappings&&d(S.mappings)}};T.useEffect(()=>{const S=w=>{if(r&&!(w.target.tagName==="INPUT"||w.target.tagName==="TEXTAREA"||w.target.isContentEditable)){if(i&&u){w.preventDefault();const D={key:w.code,label:w.code.replace("Key","").replace("Digit","")};d(U=>({...U,[u]:D})),f(null);return}Object.entries(h).forEach(([D,U])=>{w.code===U.key&&(w.preventDefault(),g.current&&g.current(D,1,1,"keydown"))})}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[r,i,u,h]);const E={isMapping:i,startMapping:()=>l(!0),stopMapping:()=>{l(!1),f(null)},learningId:u,setLearningId:f,mappings:h,setMappings:d,saveMappings:v,exportMappings:x,importMappings:y,removeMapping:S=>d(w=>{const D={...w};return delete D[S],D})};return m.jsx(K0.Provider,{value:E,children:a})},Ct=({id:a,children:t})=>{const{isMapping:r,setLearningId:i,removeMapping:l}=Jo(),{isMapping:u,setLearningId:f,removeMapping:h}=Cf()||{},{isMapping:d,setLearningId:g,removeMapping:v}=Mf()||{},x=r||u||d,y=w=>{x&&(w.preventDefault(),w.stopPropagation(),r&&i(a),u&&f(a),d&&g(a))},E=w=>{x&&(w.preventDefault(),w.stopPropagation(),r&&l(a),u&&h(a),d&&v(a))},S=ea.Children.only(t);return ea.cloneElement(S,{"data-mappable-id":a,onClickCapture:x?y:S.props.onClickCapture,onContextMenu:x?E:S.props.onContextMenu,className:`${S.props.className||""} ${x?"mappable-target":""}`.trim()})},Iv=({masterIntensity:a,onMasterIntensityChange:t})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_intensity",targetType:"global",label:"MASTER",min:0,max:1,step:.01}))};return m.jsx("div",{className:"master-intensity-slider",draggable:!0,onDragStart:r,children:m.jsx(Ct,{id:"master_intensity",children:m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:a,className:"slider_hor",id:"masterIntensityRange",onChange:i=>t(parseFloat(i.target.value))})})})},Bv=({masterIntensity:a,onMasterIntensityChange:t,onClearAllActive:r,isGlobalBlackout:i,onToggleGlobalBlackout:l})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"global",label:h.toUpperCase()}))};return m.jsxs("div",{className:"composition-controls",children:[m.jsx("span",{className:"layer-control-button",children:"Comp"}),m.jsx(Ct,{id:"comp_clear",children:m.jsx("span",{className:"layer-control-button",onClick:r,style:{cursor:"pointer"},draggable:!0,onDragStart:f=>u(f,"clear"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),m.jsx(Ct,{id:"comp_blackout",style:{width:"100%",display:"flex"},children:m.jsx("span",{className:"layer-control-button",onClick:l,style:{cursor:"pointer",backgroundColor:i?"red":""},draggable:!0,onDragStart:f=>u(f,"blackout"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx(Iv,{masterIntensity:a,onMasterIntensityChange:t})]})},Fv=({name:a,index:t,onTrigger:r,onShowColumnHeaderContextMenu:i})=>{const l=f=>{f.preventDefault(),i&&i(t)},u=f=>{f.button===0&&r&&r()};return m.jsx(Ct,{id:`column_${t}`,children:m.jsx("div",{className:"column-header trigger-button",onClick:u,onContextMenu:l,style:{cursor:"pointer"},children:a})})},rn=[{id:"rotate",name:"Rotate",type:"transform",description:"Rotates the shape around its center.",defaultParams:{angle:0,speed:0,direction:"CW"},paramControls:[{id:"angle",label:"Angle",type:"range",min:0,max:360,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["CW","CCW"]}]},{id:"scale",name:"Scale",type:"transform",description:"Scales the shape.",defaultParams:{scaleX:1,scaleY:1},paramControls:[{id:"scaleX",label:"Scale X",type:"range",min:.01,max:5,step:.01},{id:"scaleY",label:"Scale Y",type:"range",min:.01,max:5,step:.01}]},{id:"translate",name:"Translate",type:"transform",description:"Moves the shape.",defaultParams:{translateX:0,translateY:0},paramControls:[{id:"translateX",label:"Translate X",type:"range",min:-1,max:1,step:.01},{id:"translateY",label:"Translate Y",type:"range",min:-1,max:1,step:.01}]},{id:"color",name:"Color",type:"color",description:"Changes the color of the shape with solid or rainbow modes.",defaultParams:{mode:"solid",r:255,g:255,b:255,cycleSpeed:0,rainbowSpread:1,rainbowOffset:0,rainbowPalette:"rainbow"},paramControls:[{id:"mode",label:"Mode",type:"select",options:["solid","rainbow"]},{id:"r",label:"Red",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"g",label:"Green",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"cycleSpeed",label:"Cycle Speed",type:"range",min:0,max:10,step:.1},{id:"rainbowSpread",label:"Rainbow Spread",type:"range",min:.1,max:10,step:.1,showIf:{mode:"rainbow"}},{id:"rainbowOffset",label:"Rainbow Offset",type:"range",min:0,max:360,step:1,showIf:{mode:"rainbow"}},{id:"rainbowPalette",label:"Palette",type:"select",options:["rainbow","fire","ice","cyber"],showIf:{mode:"rainbow"}}]},{id:"wave",name:"Wave",type:"animation",description:"Applies a wave distortion to the shape.",defaultParams:{amplitude:.1,frequency:10,speed:1,direction:"x"},paramControls:[{id:"amplitude",label:"Amplitude",type:"range",min:.01,max:1,step:.01},{id:"frequency",label:"Frequency",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["x","y"]}]},{id:"warp",name:"Warp",type:"animation",description:"Symmetrical chaotic wave distortion.",defaultParams:{amount:.1,chaos:.5,speed:1},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"chaos",label:"Chaos",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1}]},{id:"distortion",name:"Distortion",type:"transform",description:"Distorts the point data.",defaultParams:{amount:.1,scale:10,speed:.5},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"scale",label:"Scale",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:5,step:.1}]},{id:"move",name:"Move (Bounce)",type:"transform",description:"Moves points and bounces them off the borders.",defaultParams:{speedX:.1,speedY:.1},paramControls:[{id:"speedX",label:"Speed X",type:"range",min:0,max:2,step:.01},{id:"speedY",label:"Speed Y",type:"range",min:0,max:2,step:.01}]},{id:"delay",name:"Delay",type:"effect",description:"Frame or Channel based delay effect.",defaultParams:{mode:"frame",playstyle:"repeat",useCustomOrder:!1,delayDirection:"left_to_right",delayAmount:5,decay:.8,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat"]},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"delayDirection",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}},{id:"delayAmount",label:"Delay Time",type:"range",min:1,max:60,step:1},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01}]},{id:"chase",name:"Chase",type:"effect",description:"Frame or Channel based chase effect.",defaultParams:{mode:"frame",playstyle:"repeat",steps:4,decay:.8,speed:1,overlap:1,direction:"left_to_right",useCustomOrder:!1,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat","bounce"]},{id:"steps",label:"Steps",type:"range",min:2,max:16,step:1,showIf:{mode:"frame"}},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:5,step:.1},{id:"overlap",label:"Overlap",type:"range",min:1,max:4,step:1},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"direction",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}}]},{id:"blanking",name:"Blanking",type:"animation",description:"Controls the blanking of the laser output.",defaultParams:{blankingInterval:0,spacing:0},paramControls:[{id:"blankingInterval",label:"Blanking Interval",type:"range",min:0,max:10,step:1},{id:"spacing",label:"Spacing",type:"range",min:0,max:20,step:1}]},{id:"strobe",name:"Strobe",type:"animation",description:"Applies a strobe effect to the laser output.",defaultParams:{strobeSpeed:100,strobeAmount:.5},paramControls:[{id:"strobeSpeed",label:"Strobe Speed (ms)",type:"range",min:10,max:1e3,step:10},{id:"strobeAmount",label:"Strobe Amount (0-1)",type:"range",min:0,max:1,step:.01}]},{id:"mirror",name:"Mirror",type:"transform",description:"Mirrors the shape from the center.",defaultParams:{mode:"none"},paramControls:[{id:"mode",label:"Mirror Mode",type:"select",options:["none","x+","x-","y+","y-"]}]}],Un=(a,t)=>({...t,...a});function W0(a,t,r,i){if(!r)return t;const l=typeof r=="string"?{syncMode:r}:r;if(!l.syncMode)return t;const{time:u,progress:f=0,bpm:h=120,clipDuration:d=0,fftLevels:g={low:0,mid:0,high:0},activationTime:v=0}=i;let x=0;const y=l.speedMultiplier||1,E=l.style||"loop";if(E==="once"&&v>0){const C=(u-v)*.001;let M=1;if(l.syncMode==="timeline")M=Math.max(.01,l.duration||1);else if(l.syncMode==="bpm"){const F=Math.max(.1,l.beats||4),H=h/60;M=F/(H||2)}else if(l.syncMode==="fps")return x=C*y,calculateAnimPhase(x,l,t);x=C/M*y}else if(l.syncMode==="fps")x=u*.001*y;else if(l.syncMode==="timeline"){const C=Math.max(.01,l.duration||1);d>0?x=f*d/C*y:x=0}else if(l.syncMode==="bpm"){const C=Math.max(.1,l.beats||4),M=h/60,F=C/(M||2);d>0?x=f*d/F*y:x=0}else if(l.syncMode==="fft"){const C=l.fftRange||"low",M=g[C]||0;return jv(M,t,l)}E==="bounce"&&(x*=2);const S=l.direction||"forward";if(S==="pause")return t;let w=0;if(E==="once")w=Math.min(x,1),S==="backward"&&(w=1-w);else if(E==="bounce"){let C=x%1;Math.floor(x)%2===1?w=1-C:w=C,S==="backward"&&(w=1-w)}else w=x%1,S==="backward"&&(w=1-w);const D=l.range;let U=0,k=1;if(D&&Array.isArray(D)&&D.length===2)U=D[0],k=D[1];else return t;return U+(k-U)*w}function jv(a,t,r){const i=r.range;return i&&Array.isArray(i)&&i.length===2?i[0]+(i[1]-i[0])*a:t}function vl(a,t,r={}){const{progress:i=0,time:l=performance.now(),effectStates:u,syncSettings:f={},fftLevels:h}=r;if(!t||t.length===0)return a;let d;if(Array.isArray(a.points)){d=new Float32Array(a.points.length*8);for(let x=0;x<a.points.length;x++){const y=a.points[x],E=x*8;d[E]=y.x,d[E+1]=y.y,d[E+2]=y.z||0,d[E+3]=y.r,d[E+4]=y.g,d[E+5]=y.b,d[E+6]=y.blanking?1:0,d[E+7]=y.lastPoint?1:0}}else d=new Float32Array(a.points);let g=d;const v=()=>g.length/8;for(const x of t){if(x.params.enabled===!1||!rn.find(S=>S.id===x.id))continue;const E={...x.params};for(const S of Object.keys(E)){const w=x.instanceId?`${x.instanceId}.${S}`:`${x.id}.${S}`;f[w]&&(E[S]=W0(S,E[S],f[w],r))}switch(x.id){case"rotate":Pv(g,v(),E,i,l);break;case"scale":Gv(g,v(),E);break;case"translate":zv(g,v(),E);break;case"color":Hv(g,v(),E,l);break;case"wave":qv(g,v(),E,l);break;case"blanking":Vv(g,v(),E);break;case"strobe":Xv(g,v(),E,l);break;case"mirror":g=Zv(g,v(),E);break;case"warp":Qv(g,v(),E,l);break;case"distortion":$v(g,v(),E,l);break;case"move":Kv(g,v(),E,l);break;case"delay":u&&x.instanceId&&(g=Wv(g,v(),E,u,x.instanceId,r));break;case"chase":g=Jv(g,v(),E,l,r);break}}return{...a,points:g,isTypedArray:!0}}function Pv(a,t,r,i,l){const{angle:u,speed:f,direction:h}=Un(r,rn.find(E=>E.id==="rotate").defaultParams),d=h==="CCW"?-1:1,g=l*.001*f*d,v=u*Math.PI/180+g,x=Math.sin(v),y=Math.cos(v);for(let E=0;E<t;E++){const S=E*8,w=a[S],D=a[S+1];a[S]=w*y-D*x,a[S+1]=w*x+D*y}}function Gv(a,t,r){const{scaleX:i,scaleY:l}=Un(r,rn.find(u=>u.id==="scale").defaultParams);for(let u=0;u<t;u++){const f=u*8;a[f]*=i,a[f+1]*=l}}function zv(a,t,r){const{translateX:i,translateY:l}=Un(r,rn.find(u=>u.id==="translate").defaultParams);for(let u=0;u<t;u++){const f=u*8;a[f]+=i,a[f+1]+=l}}function Hv(a,t,r,i){const{mode:l,r:u,g:f,b:h,cycleSpeed:d,rainbowSpread:g,rainbowOffset:v,rainbowPalette:x}=Un(r,rn.find(E=>E.id==="color").defaultParams),y=i*.001*d;if(l==="rainbow"){const E=x||"rainbow";for(let S=0;S<t;S++){const w=S*8,D=(S/t*g+y*.5+v/360)%1;let U,k,C;E==="rainbow"?[U,k,C]=o0(D,1,.5):[U,k,C]=Yv(E,D),a[w+3]=U,a[w+4]=k,a[w+5]=C}}else if(d>0){const E=y*50%360,[S,w,D]=o0(E/360,1,.5);for(let U=0;U<t;U++){const k=U*8;a[k+3]=S,a[k+4]=w,a[k+5]=D}}else for(let E=0;E<t;E++){const S=E*8;a[S+3]=u,a[S+4]=f,a[S+5]=h}}function Yv(a,t){const r={fire:[{r:255,g:0,b:0},{r:255,g:128,b:0},{r:255,g:255,b:0},{r:255,g:0,b:0}],ice:[{r:0,g:0,b:255},{r:0,g:255,b:255},{r:255,g:255,b:255},{r:0,g:0,b:255}],cyber:[{r:255,g:0,b:255},{r:0,g:255,b:255},{r:0,g:0,b:255},{r:255,g:0,b:255}]},i=r[a]||r.fire,l=t*(i.length-1),u=Math.floor(l),f=l-u,h=i[u],d=i[u+1]||i[u];return[Math.round(h.r+(d.r-h.r)*f),Math.round(h.g+(d.g-h.g)*f),Math.round(h.b+(d.b-h.b)*f)]}function o0(a,t,r){let i,l,u;{const f=(g,v,x)=>(x<0&&(x+=1),x>1&&(x-=1),x<.16666666666666666?g+(v-g)*6*x:x<.5?v:x<.6666666666666666?g+(v-g)*(.6666666666666666-x)*6:g),h=r+t-r*t,d=2*r-h;i=f(d,h,a+1/3),l=f(d,h,a),u=f(d,h,a-1/3)}return[Math.round(i*255),Math.round(l*255),Math.round(u*255)]}function qv(a,t,r,i){const{amplitude:l,frequency:u,speed:f,direction:h}=Un(r,rn.find(g=>g.id==="wave").defaultParams),d=i*.001*f;for(let g=0;g<t;g++){const v=g*8;h==="x"?a[v+1]+=l*Math.sin(a[v]*u+d):h==="y"&&(a[v]+=l*Math.sin(a[v+1]*u+d))}}function Vv(a,t,r){const{blankingInterval:i,spacing:l=0}=Un(r,rn.find(f=>f.id==="blanking").defaultParams);if(i<=0)return;const u=i+1+l;for(let f=0;f<t;f++)f%u>=i&&(a[f*8+6]=1)}function Xv(a,t,r,i){const{strobeSpeed:l,strobeAmount:u}=Un(r,rn.find(h=>h.id==="strobe").defaultParams);if(i%l/l<u)for(let h=0;h<t;h++)a[h*8+6]=1}function Zv(a,t,r){const{mode:i}=Un(r,rn.find(d=>d.id==="mirror").defaultParams);if(i==="none")return a;let l=[];for(let d=0;d<t;d++){const g=d*8,v=a[g],x=a[g+1];let y=!1;i==="x-"&&(v<=0||i==="x+"&&(v>=0||i==="y-"&&(x<=0||i==="y+"&&x>=0)))&&(y=!0),y&&l.push({x:a[g],y:a[g+1],z:a[g+2],r:a[g+3],g:a[g+4],b:a[g+5],blk:a[g+6],last:a[g+7]})}const u=l.length*2,f=new Float32Array(u*8);let h=0;for(const d of l)f[h++]=d.x,f[h++]=d.y,f[h++]=d.z,f[h++]=d.r,f[h++]=d.g,f[h++]=d.b,f[h++]=d.blk,f[h++]=d.last;for(const d of l)i==="x-"||i==="x+"?f[h++]=-d.x:f[h++]=d.x,i==="y-"||i==="y+"?f[h++]=-d.y:f[h++]=d.y,f[h++]=d.z,f[h++]=d.r,f[h++]=d.g,f[h++]=d.b,f[h++]=d.blk,f[h++]=d.last;return f}function Qv(a,t,r,i){const{amount:l,chaos:u,speed:f}=Un(r,rn.find(d=>d.id==="warp").defaultParams),h=i*.001*f;for(let d=0;d<t;d++){const g=d*8,v=a[g],x=a[g+1],y=Math.abs(x);a[g]+=Math.sin(y*10*(1+u)+h)*l*Math.cos(h*u),a[g+1]+=Math.cos(Math.abs(v)*10*(1+u)+h)*l*Math.sin(h*u)}}function $v(a,t,r,i){const{amount:l,scale:u,speed:f}=Un(r,rn.find(d=>d.id==="distortion").defaultParams),h=i*.001*f;for(let d=0;d<t;d++){const g=d*8,v=Math.sin(a[g]*u+h)*Math.cos(a[g+1]*u-h),x=Math.cos(a[g]*u-h)*Math.sin(a[g+1]*u+h);a[g]+=v*l,a[g+1]+=x*l}}function Kv(a,t,r,i){const{speedX:l,speedY:u}=Un(r,rn.find(v=>v.id==="move").defaultParams),f=i*.001,h=f*l,d=f*u,g=4;for(let v=0;v<t;v++){const x=v*8;let y=a[x]+h,E=a[x+1]+d,S=(y+1)%g;S<0&&(S+=g),S>2&&(S=4-S),y=S-1;let w=(E+1)%g;w<0&&(w+=g),w>2&&(w=4-w),E=w-1,a[x]=y,a[x+1]=E}}function Wv(a,t,r,i,l,u){const{mode:f="frame",delayAmount:h,decay:d,delayDirection:g,useCustomOrder:v,customOrder:x}=Un(r,rn.find(E=>E.id==="delay").defaultParams);i.has(l)||i.set(l,[]);const y=i.get(l);if(y.unshift(new Float32Array(a)),f==="frame"){const S=h*10+1;y.length>S&&(y.length=S);const w=new Float32Array(a.length);for(let D=0;D<t;D++){let U=0;const k=D/t;g==="left_to_right"?U=Math.floor(k*9):g==="right_to_left"?U=Math.floor((1-k)*9):g==="center_to_out"?U=Math.floor(Math.abs(k-.5)*2*9):g==="out_to_center"&&(U=Math.floor((1-Math.abs(k-.5)*2)*9));const C=U*h,M=C<y.length?y[C]:null,F=Math.pow(d,U),H=D*8;M&&M.length===a.length?(w[H]=M[H],w[H+1]=M[H+1],w[H+2]=M[H+2],w[H+3]=M[H+3]*F,w[H+4]=M[H+4]*F,w[H+5]=M[H+5]*F,w[H+6]=M[H+6],w[H+7]=M[H+7]):(w.set(a.subarray(H,H+8),H),w[H+3]=0,w[H+4]=0,w[H+5]=0,w[H+6]=1)}return w}else{const{assignedDacs:E}=u||{};let S=new Map,w=0;if(v||r.delayMode==="channel")(x&&x.length>0?x.map(le=>le.originalIndex):E?E.map((le,Z)=>Z):[0]).forEach((le,Z)=>{S.set(le,Z),w=Math.max(w,Z)});else{const le=(E||[]).length||1;for(let Z=0;Z<le;Z++){let z=Z;g==="right_to_left"?z=le-1-Z:g==="center_to_out"?z=Math.floor(Math.abs(Z-(le-1)/2)):g==="out_to_center"&&(z=Math.min(Z,le-1-Z)),S.set(Z,z),w=Math.max(w,z)}}const U=w+1,k=h*U+1;y.length>k&&(y.length=k);const C=[];for(let ce=0;ce<U;ce++){const le=ce*h;C.push({points:le<y.length?y[le]:null,factor:Math.pow(d,ce),index:ce})}const M=C.reduce((ce,le)=>ce+(le.points?le.points.length/8:a.length/8),0),F=new Float32Array(M*8);let H=0;const fe=new Array(C.length);for(let ce=0;ce<C.length;ce++){const le=C[ce],Z=le.points,z=Z?Z.length/8:a.length/8;fe[ce]=H;for(let Q=0;Q<z;Q++){const $=Q*8,W=H+Q*8;Z?(F[W]=Z[$],F[W+1]=Z[$+1],F[W+2]=Z[$+2],F[W+3]=Z[$+3]*le.factor,F[W+4]=Z[$+4]*le.factor,F[W+5]=Z[$+5]*le.factor,F[W+6]=Z[$+6],F[W+7]=Z[$+7]):F[W+6]=1}H+=z*8}const de=new Map;return S.forEach((ce,le)=>{ce<C.length&&de.set(le,{start:fe[ce],length:C[ce].points?C[ce].points.length:a.length})}),F._channelDistributions=de,F}}function Jv(a,t,r,i,l={}){const{mode:u="frame",steps:f,decay:h,speed:d,overlap:g,direction:v,useCustomOrder:x,customOrder:y,playStyle:E="loop"}=Un(r,rn.find(k=>k.id==="chase").defaultParams),{progress:S=0,clipDuration:w=1}=l,D=S*w,U=S!==void 0&&w>0?D:i*.001;if(u==="frame"){const k=f;let C=U*d;if(E==="bounce"){const F=k,H=C%(F*2);C=H>F?F*2-H:H}else E==="once"?C=Math.min(C,k):C=C%k;const M=new Float32Array(a.length);for(let F=0;F<t;F++){const H=F/t;let fe=0;v==="left_to_right"?fe=Math.floor(H*(k-1)):v==="right_to_left"?fe=Math.floor((1-H)*(k-1)):v==="center_to_out"?fe=Math.floor(Math.abs(H-.5)*2*(k-1)):v==="out_to_center"&&(fe=Math.floor((1-Math.abs(H-.5)*2)*(k-1)));let de=Math.abs(C-fe);de>k/2&&(de=k-de);let ce=de<g?1-de/g:0;h>0&&(ce=Math.pow(ce,1-h));const le=F*8;M.set(a.subarray(le,le+8),le),M[le+3]*=ce,M[le+4]*=ce,M[le+5]*=ce,ce<.05&&(M[le+6]=1)}return M}else{const{assignedDacs:k}=l||{};let C=new Map,M=0;if(x)(y&&y.length>0?y.map(Q=>Q.originalIndex):k?k.map((Q,$)=>$):[0]).forEach((Q,$)=>{C.set(Q,$),M++});else{M=(k?k.length:1)||1;for(let z=0;z<M;z++){let Q=z;v==="right_to_left"?Q=M-1-z:v==="center_to_out"?Q=Math.floor(Math.abs(z-(M-1)/2)):v==="out_to_center"&&(Q=Math.min(z,M-1-z)),C.set(z,Q)}}const F=M;let H=U*d;if(E==="bounce"){const z=F,Q=H%(z*2);H=Q>z?z*2-Q:Q}else E==="once"?H=Math.min(H,F):H=H%F;const fe=t*M,de=new Float32Array(fe*8),ce=new Map;let le=0;const Z=Array.from(C.keys());Z.length===0&&Z.push(0);for(const z of Z){const Q=C.get(z)||0;let $=Math.abs(H-Q);$>F/2&&($=F-$);let W=$<g?1-$/g:0;h>0&&(W=Math.pow(W,1-h));const B=le;for(let P=0;P<t;P++){const V=P*8,pe=le+P*8;de.set(a.subarray(V,V+8),pe),de[pe+3]*=W,de[pe+4]*=W,de[pe+5]*=W,W<.05&&(de[pe+6]=1)}ce.set(z,{start:B,length:t*8}),le+=t*8}return de._channelDistributions=ce,de}}function hf(a,t){if(!t||!a||!a.points)return a;const{safetyZones:r,outputArea:i,transformationEnabled:l,transformationMode:u,flipX:f,flipY:h}=t;let d=a.points;const g=a.isTypedArray||d instanceof Float32Array,v=g?d.length/8:d.length;let x=g?new Float32Array(d):d.map(y=>({...y}));for(let y=0;y<v;y++){let E,S,w,D,U,k;if(g?(E=x[y*8],S=x[y*8+1],w=x[y*8+3],D=x[y*8+4],U=x[y*8+5],k=x[y*8+6]):(E=x[y].x,S=x[y].y,w=x[y].r,D=x[y].g,U=x[y].b,k=x[y].blanking?1:0),f&&(E=-E),h&&(S=-S),l&&i){let C=(E+1)/2,M=(1-S)/2;u==="crop"?(C<i.x||C>i.x+i.w||M<i.y||M>i.y+i.h)&&(w=0,D=0,U=0,k=1):u==="scale"&&(C=i.x+C*i.w,M=i.y+M*i.h,E=C*2-1,S=1-M*2)}if(r&&r.length>0){let C=(E+1)/2,M=(1-S)/2;for(const F of r)if(C>=F.x&&C<=F.x+F.w&&M>=F.y&&M<=F.y+F.h){w=0,D=0,U=0,k=1;break}}g?(x[y*8]=E,x[y*8+1]=S,x[y*8+3]=w,x[y*8+4]=D,x[y*8+5]=U,x[y*8+6]=k):(x[y].x=E,x[y].y=S,x[y].r=w,x[y].g=D,x[y].b=U,x[y].blanking=k>.5)}return{...a,points:x,isTypedArray:g}}class ey{constructor(t,r){if(this.canvas=t,this.type=r,this.gl=t.getContext("webgl")||t.getContext("experimental-webgl"),this.animationFrameId=null,this.frameIndexes=Array(10).fill(0),this.pointIndexes=Array(10).fill(0),this.showBeamEffect=!1,this.beamAlpha=.5,this.fadeAlpha=.13,this.beamRenderMode="both",this.positionBuffer=null,this.colorBuffer=null,this.alphaBuffer=null,this.lastPointDrawTime=0,!this.gl){console.error("WebGL not supported");return}this.setup()}setup(){const t=this.gl,r=`
      attribute vec2 aPosition;
      attribute vec3 aColor;
      attribute float aAlpha;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
        gl_PointSize = 2.0;
        vColor = aColor;
        vAlpha = aAlpha;
      }
    `,i=`
      precision mediump float;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_FragColor = vec4(vColor, vAlpha);
      }
    `,l=this.createShader(t.VERTEX_SHADER,r),u=this.createShader(t.FRAGMENT_SHADER,i),f=this.createProgram(l,u);this.program=f,this.positionAttributeLocation=t.getAttribLocation(f,"aPosition"),this.colorAttributeLocation=t.getAttribLocation(f,"aColor"),this.alphaAttributeLocation=t.getAttribLocation(f,"aAlpha"),this.quadPositionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.quadPositionBuffer);const h=[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1];t.bufferData(t.ARRAY_BUFFER,new Float32Array(h),t.STATIC_DRAW),this.quadColorUniformLocation=t.getUniformLocation(f,"uColor"),this.quadAlphaUniformLocation=t.getUniformLocation(f,"uAlpha");const d=`
      attribute vec2 aPosition;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
      }
    `,g=`
      precision mediump float;
      uniform vec4 uColor;
      void main() {
        gl_FragColor = uColor;
      }
    `,v=this.createShader(t.VERTEX_SHADER,d),x=this.createShader(t.FRAGMENT_SHADER,g);this.fadeProgram=this.createProgram(v,x),this.fadePositionAttributeLocation=t.getAttribLocation(this.fadeProgram,"aPosition"),this.fadeColorUniformLocation=t.getUniformLocation(this.fadeProgram,"uColor"),t.useProgram(f);const y=131072;this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,y*2*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,y*3*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),this.alphaBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.alphaBuffer),t.bufferData(t.ARRAY_BUFFER,y*1*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(0,0,0,1)}reset(){this.frameIndexes.fill(0),this.pointIndexes.fill(0),this.clearCanvas()}createShader(t,r){const i=this.gl,l=i.createShader(t);if(i.shaderSource(l,r),i.compileShader(l),i.getShaderParameter(l,i.COMPILE_STATUS))return l;console.error(i.getShaderInfoLog(l)),i.deleteShader(l)}createProgram(t,r){const i=this.gl,l=i.createProgram();if(i.attachShader(l,t),i.attachShader(l,r),i.linkProgram(l),i.getProgramParameter(l,i.LINK_STATUS))return l;console.error(i.getProgramInfoLog(l)),i.deleteProgram(l)}render(t){t.showBeamEffect!==void 0&&this.setBeamEffect(t.showBeamEffect),t.beamAlpha!==void 0&&this.setBeamAlpha(t.beamAlpha),t.fadeAlpha!==void 0&&this.setFadeAlpha(t.fadeAlpha),t.beamRenderMode!==void 0&&(this.beamRenderMode=t.beamRenderMode),this.type==="world"?this.renderWorld(t.worldData,t.previewScanRate,t.layerIntensities,t.masterIntensity,t.dacSettings,t.previewTime,t.fftLevels):this.renderSingle(t.ildaFrames,t.previewScanRate,t.intensity,t.effects,t.syncSettings,t.bpm,t.clipDuration,t.progress,t.previewTime,t.fftLevels,t.effectStates)}renderSingle(t,r,i,l,u={},f=120,h=1,d=null,g=null,v={low:0,mid:0,high:0},x=null){const y=this.gl;if(y.viewport(0,0,y.canvas.width,y.canvas.height),this.drawFadeQuad(),!t||t.length===0)return;const E=this.frameIndexes[0]%t.length,S=t[E],w=d!==null?d:E/t.length,D=g!==null?g:performance.now();this.draw(S,l,this.showBeamEffect,this.beamAlpha,r,this.beamRenderMode,i,0,w,D,u,f,h,v,x),this.frameIndexes[0]++,this.frameIndexes[0]>=t.length&&(this.frameIndexes[0]=0)}renderWorld(t,r,i,l,u,f=null,h={low:0,mid:0,high:0}){const d=this.gl;d.viewport(0,0,d.canvas.width,d.canvas.height),this.drawFadeQuad();const g=f!==null?f:performance.now();t.forEach(v=>{if(v&&v.frames&&v.frames.length>0){const x=v.frames[0];if(x){const y=v.layerIndex||0;if(v.syncSettings,v.bpm,y>=this.frameIndexes.length){const w=y+5;for(;this.frameIndexes.length<w;)this.frameIndexes.push(0),this.pointIndexes.push(0)}const S=(i[y]!==void 0?i[y]:1)*l;if(S>.001){const w=v.progress!==void 0?v.progress:this.frameIndexes[y]%v.frames.length/v.frames.length,{syncSettings:D={},bpm:U=120,clipDuration:k=1,effectStates:C=null}=v;let M=x;if(u){let F=x;if(u.dimmer!==void 0&&u.dimmer<1){const H=x.points,fe=x.isTypedArray||H instanceof Float32Array,de=fe?H.length/8:H.length,ce=fe?new Float32Array(H):H.map(le=>({...le}));for(let le=0;le<de;le++)fe?(ce[le*8+3]*=u.dimmer,ce[le*8+4]*=u.dimmer,ce[le*8+5]*=u.dimmer):(ce[le].r*=u.dimmer,ce[le].g*=u.dimmer,ce[le].b*=u.dimmer);F={...x,points:ce,isTypedArray:fe}}M=hf(F,u)}this.draw(M,v.effects,this.showBeamEffect,this.beamAlpha,r,this.beamRenderMode,S,y,w,g,D,U,k,h,C)}}}}),t.forEach(v=>{if(v&&v.frames){const x=v.layerIndex||0;this.frameIndexes[x]++,this.frameIndexes[x]>=v.frames.length&&(this.frameIndexes[x]=0)}})}drawFadeQuad(){const t=this.gl;this.fadeProgram&&(t.useProgram(this.fadeProgram),t.bindBuffer(t.ARRAY_BUFFER,this.quadPositionBuffer),t.enableVertexAttribArray(this.fadePositionAttributeLocation),t.vertexAttribPointer(this.fadePositionAttributeLocation,2,t.FLOAT,!1,0,0),t.uniform4f(this.fadeColorUniformLocation,0,0,0,this.fadeAlpha),t.drawArrays(t.TRIANGLES,0,6))}setBeamEffect(t){this.showBeamEffect=t}setBeamAlpha(t){this.beamAlpha=t}setFadeAlpha(t){this.fadeAlpha=t}draw(t,r,i,l,u,f,h=1,d=0,g=0,v=performance.now(),x={},y=120,E=1,S={low:0,mid:0,high:0},w=null){if(this.gl,!t||!t.points)return;const D=vl(t,r,{progress:g,time:v,syncSettings:x,bpm:y,clipDuration:E,fftLevels:S,effectStates:w}),U=D.points,k=D.isTypedArray,C=k?U.length/8:U.length;if(C===0)return;const M=Math.max(1,Math.floor(C/u));let F=this.pointIndexes[d]||0;F>=C&&(F=0);const H=le=>{const Z=(F+le)%C;if(k){const z=Z*8;return{x:U[z],y:U[z+1],r:U[z+3],g:U[z+4],b:U[z+5],blanking:U[z+6]===1}}else{const z=U[Z];return{x:z.x,y:z.y,r:z.r,g:z.g,b:z.b,blanking:z.blanking}}},fe=()=>{const le=f==="points"||f==="both",Z=f==="lines"||f==="both";let z=[],Q=[];for(let $=0;$<M;$++){const W=H($);if(W.blanking){z.length>0&&(Z&&this._drawSegment(new Float32Array(z),new Float32Array(Q),1,z.length/2,!1),le&&this._drawSegment(new Float32Array(z),new Float32Array(Q),1,z.length/2,!0),z=[],Q=[]);continue}z.push(W.x,W.y),Q.push(W.r/255*h,W.g/255*h,W.b/255*h)}z.length>0&&(Z&&this._drawSegment(new Float32Array(z),new Float32Array(Q),1,z.length/2,!1),le&&this._drawSegment(new Float32Array(z),new Float32Array(Q),1,z.length/2,!0))},de=()=>{const le=[],Z=[];for(let z=0;z<M;z++){const Q=H(z);if(!Q.blanking){le.push(0,0,Q.x,Q.y);const $=[Q.r/255*h,Q.g/255*h,Q.b/255*h];Z.push(...$,...$)}}le.length>0&&this._drawLines(new Float32Array(le),new Float32Array(Z),l,le.length/2)},ce=()=>{const le=[],Z=[];let z=H(0);for(let Q=1;Q<M;Q++){const $=H(Q);if(!z.blanking&&!$.blanking){le.push(0,0,z.x,z.y,$.x,$.y);const W=[z.r/255*h,z.g/255*h,z.b/255*h],B=[$.r/255*h,$.g/255*h,$.b/255*h],P=[(W[0]+B[0])/2,(W[1]+B[1])/2,(W[2]+B[2])/2],V=.3,pe=[W[0]*V,W[1]*V,W[2]*V],R=[B[0]*V,B[1]*V,B[2]*V];Z.push(...P,...pe,...R)}z=$}le.length>0&&this._drawTriangles(new Float32Array(le),new Float32Array(Z),l,le.length/2)};fe(),i&&(f==="points"?de():f==="lines"?ce():f==="both"&&(ce(),de())),this.pointIndexes[d]=(F+M)%C}_drawSegment(t,r,i,l,u=!1){const f=this.gl;f.useProgram(this.program),f.bindBuffer(f.ARRAY_BUFFER,this.positionBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,t),f.enableVertexAttribArray(this.positionAttributeLocation),f.vertexAttribPointer(this.positionAttributeLocation,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,r),f.enableVertexAttribArray(this.colorAttributeLocation),f.vertexAttribPointer(this.colorAttributeLocation,3,f.FLOAT,!1,0,0);const h=new Float32Array(Array(l).fill(i));f.bindBuffer(f.ARRAY_BUFFER,this.alphaBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,h),f.enableVertexAttribArray(this.alphaAttributeLocation),f.vertexAttribPointer(this.alphaAttributeLocation,1,f.FLOAT,!1,0,0),f.drawArrays(u?f.POINTS:f.LINE_STRIP,0,l)}_drawLines(t,r,i,l){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,t),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,r),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0);const f=new Float32Array(Array(l).fill(i));u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.LINES,0,l)}_drawTriangles(t,r,i,l){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,t),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,r),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0);const f=new Float32Array(Array(l).fill(i));u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.TRIANGLES,0,l)}clearCanvas(){const t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}destroy(){if(cancelAnimationFrame(this.animationFrameId),this.gl){const t=this.gl.getExtension("WEBGL_losing_context");t&&t.loseContext()}}}const mf=({frame:a,effects:t,width:r=100,height:i=100})=>{const l=T.useRef(null),u=T.useRef(null),[f,h]=T.useState(null);return T.useEffect(()=>(l.current&&!u.current&&(u.current=new ey(l.current,"single")),()=>{u.current&&(u.current.destroy(),u.current=null)}),[]),T.useEffect(()=>{if(!a){h(null);return}let d=a;if(t&&t.length>0){const g=a.points,v=a.isTypedArray||g instanceof Float32Array;let x;v?x=new Float32Array(g):x=g.map(E=>({...E}));const y={...a,points:x,isTypedArray:v};d=vl(y,t,{time:performance.now(),progress:0,effectStates:new Map})}h(d)},[a,t]),T.useEffect(()=>{u.current&&f?u.current.render({ildaFrames:[f],previewScanRate:1,intensity:1,effects:[],syncSettings:{}}):u.current&&u.current.clearCanvas()},[f]),m.jsx("div",{className:"clip-thumbnail",style:{width:"100%",height:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"black"},children:m.jsx("canvas",{ref:l,width:r,height:i,style:{width:"100%",height:"100%",backgroundColor:"black"}})})},ty=({layerName:a,index:t,onDropEffect:r,onDropDac:i,layerEffects:l,activeClipData:u,onDeactivateLayerClips:f,onShowLayerFullContextMenu:h,thumbnailRenderMode:d,intensity:g,onIntensityChange:v,liveFrame:x,isBlackout:y,isSolo:E,onToggleBlackout:S,onToggleSolo:w,onLayerSelect:D})=>{const[U,k]=T.useState(l||[]),[C,M]=T.useState(!1),[F,H]=T.useState(!1);T.useEffect(()=>{k(l||[])},[l]);const fe=T.useMemo(()=>[...u?.effects||[],...l||[]],[u?.effects,l]),de=($,W,B,P,V)=>{$.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:W,paramName:B,targetType:P,layerIndex:t,label:V}))},ce=$=>{$.preventDefault(),console.log(`Right-clicked LayerControls at index: ${t}`),h&&h(t)},le=$=>{$.preventDefault(),$.stopPropagation(),M(!0),$.dataTransfer.dropEffect="copy"},Z=$=>{$.preventDefault(),$.stopPropagation(),M(!1)},z=$=>{$.preventDefault(),$.stopPropagation(),M(!1);const W=$.dataTransfer.getData("application/json");if(W)try{const P=JSON.parse(W);if(P.type==="transform"||P.type==="animation"||P.type==="color"||P.type==="effect"){if(r){r(P.id||P.name);return}}else if(P.ip&&(typeof P.channel=="number"||P.allChannels)&&i){i(t,P);return}}catch(P){console.error("Error parsing drop data in LayerControls:",P)}const B=$.dataTransfer.getData("text/plain");if(B.startsWith("effect_")){const P=B.replace("effect_","");r&&r(P)}};let Q=null;return u&&(d==="active"?Q=x:d==="hover"?Q=F?x:u.stillFrame:Q=u.stillFrame),m.jsxs("div",{className:`layer-controls ${C?"dragging":""}`,onContextMenu:ce,onDragOver:le,onDragLeave:Z,onDrop:z,children:[m.jsxs("div",{className:"grid-layer",children:[m.jsx(Ct,{id:`layer_${t}_clear`,children:m.jsx("span",{className:"layer-control-button full-height",onClick:()=>f(t),draggable:!0,onDragStart:$=>de($,"toggle","clear","layer",`L${t+1} Clear`),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),m.jsxs("div",{className:"layer-control-group",children:[m.jsx(Ct,{id:`layer_${t}_blackout`,children:m.jsx("span",{className:"layer-control-button half-height",onClick:S,style:{backgroundColor:y?"red":""},draggable:!0,onDragStart:$=>de($,"toggle","blackout","layer",`L${t+1} Blackout`),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx(Ct,{id:`layer_${t}_solo`,children:m.jsx("span",{className:"layer-control-button half-height",onClick:w,style:{backgroundColor:E?"var(--theme-color)":"",color:E?"black":""},draggable:!0,onDragStart:$=>de($,"toggle","solo","layer",`L${t+1} Solo`),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-1-square",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z"}),m.jsx("path",{d:"M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"})]})})})]}),m.jsxs("select",{className:"layer-blend-dropdown",children:[m.jsx("option",{children:"Normal"}),m.jsx("option",{children:"Add"}),m.jsx("option",{children:"Subtract"})]})]}),m.jsx("div",{className:"layer-control-row",children:m.jsx(Ct,{id:`layer_${t}_intensity`,children:m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:g,className:"slider_ver",id:"layer-intensity-slider",onChange:$=>v(parseFloat($.target.value))})})}),m.jsx("div",{className:"layer-preview-thumbnail",onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),children:u?m.jsx(mf,{frame:Q,effects:fe}):U.length>0&&m.jsx("div",{className:"applied-effects",children:U.map(($,W)=>m.jsx("span",{className:"effect-tag",children:($.name||$.id||"???").substring(0,3).toUpperCase()},$.instanceId||W))})}),m.jsx("span",{className:"layer-name-label",onClick:()=>D&&D(t),children:a})]})},ny=({clipName:a,layerIndex:t,colIndex:r,onDropGenerator:i,onDropEffect:l,clipContent:u,thumbnailFrameIndex:f,onUnsupportedFile:h,onActivateClick:d,onLabelClick:g,isSelected:v,isActive:x,ildaParserWorker:y,onDropDac:E,thumbnailRenderMode:S,liveFrame:w,stillFrame:D,onClipHover:U,onThumbnailError:k})=>{const[C,M]=T.useState(!1),[F,H]=T.useState(!1),fe=a,de=S==="active"||S==="hover"&&C,ce=V=>{V.preventDefault(),V.stopPropagation(),H(!0),V.dataTransfer.dropEffect="copy"},le=V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.contains(V.relatedTarget)||H(!1)},Z=()=>{M(!0),U&&U(t,r,!0)},z=()=>{M(!1),d(!1),U&&U(t,r,!1)},Q=async V=>{const pe=V.name;if(!y){h("ILDA parser not available.");return}if(pe.toLowerCase().endsWith(".ild"))try{const R=await V.arrayBuffer();console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFileDrop): ${R.byteLength}`),y.postMessage({type:"parse-ilda",arrayBuffer:R,fileName:pe,filePath:V.path,layerIndex:t,colIndex:r},[R])}catch(R){console.error("[Clip.jsx] handleFileDrop - Error reading file:",R),h(`Error reading file: ${R.message}`)}else h("Please drop a valid .ild file")},$=async(V,pe)=>{if(!pe.toLowerCase().endsWith(".ild")){console.log("Unsupported file type:",pe),h("Please drop a valid .ild file");return}if(!y){h("ILDA parser not available.");return}try{if(window.electronAPI&&window.electronAPI.readFileAsBinary){const G=(await window.electronAPI.readFileAsBinary(V)).slice().buffer;console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFilePathDrop): ${G.byteLength}`),y.postMessage({type:"parse-ilda",arrayBuffer:G,fileName:pe,filePath:V,layerIndex:t,colIndex:r},[G])}else h("Binary file access not available")}catch(R){console.error("Error processing file path:",R),console.error("Error stack:",R.stack),h(`Error processing file: ${R.message}`)}},W=V=>{V.preventDefault(),V.stopPropagation(),H(!1);const pe=V.dataTransfer.getData("application/json");if(pe)try{const G=JSON.parse(pe);if(G.filePath&&G.fileName){$(G.filePath,G.fileName);return}if(G.type==="transform"||G.type==="animation"||G.type==="color"||G.type==="effect"){if(l){l(G),g();return}}else if(G.ip&&(typeof G.channel=="number"||G.allChannels)){if(E){E(t,r,G);return}}else if(G.name&&i){i(t,r,G);return}}catch(G){console.error("Error parsing dropped data:",G)}const R=V.dataTransfer.files;if(R&&R.length>0){Q(R[0]);return}console.log("No recognized data format found in drop"),h("No valid ILD file, effect, or generator dropped.")},B=V=>{V.preventDefault(),V.stopPropagation()},P=V=>{V.preventDefault(),window.electronAPI&&window.electronAPI.showClipContextMenu&&window.electronAPI.showClipContextMenu(t,r,u?.triggerStyle||"normal")};return m.jsxs("div",{className:`clip ${F?"dragging":""} ${x?"active-clip":""} `,onDragEnter:B,onDragOver:ce,onDragLeave:le,onDrop:W,onContextMenu:P,children:[m.jsx(Ct,{id:`clip_${t}_${r}`,children:m.jsx("div",{className:"clip-thumbnail",onMouseDown:V=>{V.button===0&&d(!0)},onMouseUp:V=>{V.button===0&&d(!1)},onMouseEnter:Z,onMouseLeave:z,style:{overflow:"hidden"},children:u&&u.parsing?m.jsx("div",{className:"clip-loading-spinner"}):m.jsxs(m.Fragment,{children:[de&&u?m.jsx(mf,{frame:w||D,effects:u?.effects}):u?.thumbnailPath&&!x?m.jsx("img",{src:`file://${u.thumbnailPath}?t=${u.thumbnailVersion||Date.now()}`,alt:"thumbnail",onError:()=>k&&k(t,r),style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}):D&&m.jsx(mf,{frame:D,effects:u?.effects}),u?.triggerStyle&&u.triggerStyle!=="normal"&&m.jsxs("p",{className:"clip_icons",children:[u.triggerStyle==="toggle"&&m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-toggles",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M4.5 9a3.5 3.5 0 1 0 0 7h7a3.5 3.5 0 1 0 0-7zm7 6a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m-7-14a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5m2.45 0A3.5 3.5 0 0 1 8 3.5 3.5 3.5 0 0 1 6.95 6h4.55a2.5 2.5 0 0 0 0-5zM4.5 0h7a3.5 3.5 0 1 1 0 7h-7a3.5 3.5 0 1 1 0-7"})}),u.triggerStyle==="flash"&&m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-lightning-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641z"})})]})]})})}),m.jsx(Ct,{id:`clip_${t}_${r}_preview`,children:m.jsx("span",{className:`clip-label ${v?"selected-clip":""}`,onClick:g,children:fe})})]})},ay=ea.memo(ny),ry=()=>{const[a,t]=T.useState(""),[r,i]=T.useState([]),l=async()=>{if(window.electronAPI){const u=await window.electronAPI.openFileExplorer();if(u){t(u);const f=await window.electronAPI.readIldFiles(u);i(f)}}};return m.jsxs("div",{className:"file-browser",children:[m.jsx("h3",{children:"ILD File Browser"}),m.jsx("button",{onClick:l,children:"Open Folder"}),a&&m.jsxs("p",{className:"fileBrowser",children:["Selected Directory: ",a.split("\\").filter(Boolean).pop()]}),m.jsx("div",{className:"ild-file-list",children:r.length>0?r.map((u,f)=>{const h=u.split("\\").pop();return m.jsx("div",{className:"ild-file-item",draggable:!0,onDragStart:d=>d.dataTransfer.setData("application/json",JSON.stringify({filePath:u,fileName:h})),children:h},f)}):m.jsx("p",{children:"No ILD files found in selected directory."})})]})},gf=[{id:"circle",name:"Circle",description:"Generates a simple circle.",defaultParams:{radius:.5,numPoints:100,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"radius",label:"Radius",type:"range",min:.01,max:1,step:.01},{id:"numPoints",label:"Number of Points",type:"range",min:3,max:360,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"square",name:"Square",description:"Generates a simple square.",defaultParams:{width:1,height:1,pointDensity:25,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"width",label:"Width",type:"range",min:.01,max:2,step:.01},{id:"height",label:"Height",type:"range",min:.01,max:2,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:100,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"line",name:"Line",description:"Generates a straight line.",defaultParams:{x1:-.5,y1:0,x2:.5,y2:0,pointDensity:50,r:255,g:255,b:255},paramControls:[{id:"x1",label:"X1",type:"range",min:-1,max:1,step:.01},{id:"y1",label:"Y1",type:"range",min:-1,max:1,step:.01},{id:"x2",label:"X2",type:"range",min:-1,max:1,step:.01},{id:"y2",label:"Y2",type:"range",min:-1,max:1,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:2,max:200,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"text",name:"Text",description:"Generates text.",defaultParams:{text:"TrueLazer",x:0,y:.3,fontSize:72,numPoints:200,fontUrl:"src/fonts/Geometr415 Blk BT Black.ttf",r:255,g:255,b:255},paramControls:[{id:"text",label:"Text Content",type:"text"},{id:"fontUrl",label:"Fonts",type:"text"},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"fontSize",label:"Font Size",type:"range",min:10,max:200,step:1},{id:"numPoints",label:"Target Points",type:"range",min:10,max:1e3,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"star",name:"Star",description:"Generates a star shape.",defaultParams:{outerRadius:.5,innerRadius:.2,numSpikes:5,pointDensity:10,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"outerRadius",label:"Outer Radius",type:"range",min:.01,max:1,step:.01},{id:"innerRadius",label:"Inner Radius",type:"range",min:.01,max:1,step:.01},{id:"numSpikes",label:"Number of Spikes",type:"range",min:3,max:20,step:1},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:50,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"ndi-source",name:"NDI Source",description:"Placeholder for NDI Video Input.",defaultParams:{sourceName:"No Source",threshold:128,edgeDetection:!1,captureWidth:1280,captureHeight:720,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Source Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"captureWidth",label:"Capture Width",type:"range",min:64,max:1280,step:8},{id:"captureHeight",label:"Capture Height",type:"range",min:64,max:720,step:8},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"spout-receiver",name:"Spout Receiver",description:"Placeholder for Spout Video Input.",defaultParams:{sourceName:"Spout Input",threshold:128,edgeDetection:!1,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Sender Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]}],iy=()=>{const[a,t]=T.useState([]);T.useEffect(()=>{const l=async()=>{if(window.electronAPI&&window.electronAPI.ndiFindSources){const f=await window.electronAPI.ndiFindSources();t(f||[])}};l();const u=setInterval(l,5e3);return()=>clearInterval(u)},[]);const r=(l,u)=>{l.dataTransfer.setData("application/json",JSON.stringify(u))},i=(l,u)=>{const f=gf.find(d=>d.id==="ndi-source"),h={...f,defaultParams:{...f.defaultParams,sourceName:u.name}};l.dataTransfer.setData("application/json",JSON.stringify(h))};return m.jsxs("div",{className:"generator-panel",children:[m.jsx("h3",{children:"Generators"}),m.jsx("div",{className:"generator-list",children:gf.filter(l=>l.id!=="ndi-source"&&l.id!=="spout-receiver").map(l=>m.jsx("div",{className:"generator-item",draggable:!0,onDragStart:u=>r(u,l),children:l.name},l.id))}),m.jsx("h3",{style:{marginTop:"10px"},children:"NDI Sources"}),m.jsx("div",{className:"generator-list",children:a.length>0?a.map((l,u)=>m.jsx("div",{className:"generator-item ndi-item",draggable:!0,onDragStart:f=>i(f,l),children:l.name},`${l.name}-${u}`)):m.jsx("div",{className:"empty-msg",children:"No NDI sources found"})})]})},sy=()=>{const a=(t,r)=>{t.dataTransfer.setData("application/json",JSON.stringify(r))};return m.jsxs("div",{className:"effect-panel",children:[m.jsx("h3",{children:"Effects"}),rn.map(t=>m.jsx("div",{draggable:!0,onDragStart:r=>a(r,t),className:"effect-item",children:t.name},t.id))]})},Ai=({value:a,onChange:t,label:r,onDrop:i,size:l=40,isAssigned:u,...f})=>{const h=T.useRef(null),d=y=>{i&&(y.preventDefault(),y.dataTransfer.dropEffect="link")},g=y=>{if(i){y.preventDefault();try{const E=y.dataTransfer.getData("application/x-truelazer-param");console.log("[RadialKnob] Dropped Data Raw:",E);const S=JSON.parse(E);console.log("[RadialKnob] Dropped Data Parsed:",S),S&&(S.type==="range"||S.type==="number")?i(S):console.warn("[RadialKnob] Invalid data type for knob:",S?.type)}catch(E){console.error("[RadialKnob] Drop Error:",E)}}},v=-135+a*270,x=y=>{if(!u)return;y.preventDefault();const E=y.clientY,S=a,w=U=>{const C=(E-U.clientY)/200;let M=Math.max(0,Math.min(1,S+C));t(M)},D=()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",D)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",D)};return T.useEffect(()=>{const y=h.current;if(!y)return;const E=S=>{if(!u)return;S.preventDefault(),S.stopPropagation();const w=S.deltaY*-.001;let D=Math.max(0,Math.min(1,a+w));t(D)};return y.addEventListener("wheel",E,{passive:!1}),()=>{y.removeEventListener("wheel",E)}},[a,t,u]),m.jsxs("div",{className:`quick-assign-knob ${u?"":"unassigned"}`,ref:h,style:{width:l,cursor:u?"ns-resize":"default",userSelect:"none",opacity:u?1:.5},onDragOver:d,onDrop:g,onMouseDown:x,...f,children:[m.jsx("div",{className:"knob-circle",style:{width:l*.66,height:l*.66},children:m.jsx("div",{className:"knob-indicator",style:{transform:`rotate(${v}deg)`}})}),r&&m.jsx("div",{className:"knob-label",title:r,children:r}),m.jsxs("div",{className:"knob-value",style:{fontSize:"9px",color:"#888",marginTop:"2px"},children:[Math.round(a*100),"%"]})]})},ly=({dacs:a=[],onDacSelected:t,onDacsDiscovered:r,dacSettings:i={},onUpdateDacSettings:l})=>{const[u,f]=T.useState(!1),[h,d]=T.useState(null),[g,v]=T.useState([]),[x,y]=T.useState(null),E=ea.useRef(!1);T.useEffect(()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(k=>{v(k),k.length>0&&y(k[0])})},[]),T.useEffect(()=>{u&&!E.current&&(E.current=!0,console.log("Starting DAC scan on:",x?.address),window.electronAPI?window.electronAPI.discoverDacs(2e3,x?.address).then(async k=>{console.log("DACs discovered:",k);const C=await Promise.all(k.map(async M=>{try{const F=await window.electronAPI.getDacServices(M.ip,x?.address,M.type),H=M.type&&M.type.toLowerCase()==="etherdream"?F:F.filter(fe=>fe.serviceID!==0);return{...M,channels:H}}catch(F){return console.error(`Error fetching services for DAC ${M.ip}:`,F),{...M,channels:[]}}}));r&&r(C)}).catch(k=>{console.error("Error discovering DACs:",k)}).finally(()=>{f(!1),E.current=!1}):(console.warn("electronAPI is not available. Cannot discover DACs."),f(!1),E.current=!1))},[u,x,r]);const S=(k,C)=>{const M={...k,channel:C};d(M),t&&t(M)},w=(k,C,M)=>{k.stopPropagation();const F={...C,channel:M};k.dataTransfer.setData("application/json",JSON.stringify(F))},D=k=>{const C=k.target.value,M=g.find(F=>F.address===C);y(M)},U=(k,C)=>{k.stopPropagation();const M={...C,allChannels:!0};k.dataTransfer.setData("application/json",JSON.stringify(M))};return m.jsxs("div",{className:"dac-panel",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"DACs"})}),m.jsxs("div",{className:"network-interface-selector",style:{display:"flex",gap:5,padding:"5px 10px"},children:[m.jsxs("div",{style:{flex:1,display:"flex"},children:[m.jsx("select",{onChange:D,value:x?.address||"",style:{width:"100%",height:"100%",background:"#2a2a2a",color:"#aaa",borderRadius:"5px",marginBottom:2},children:g.map(k=>m.jsxs("option",{value:k.address,children:[k.name," (",k.address,")"]},k.address))}),m.jsx("button",{onClick:()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(k=>{v(k),k.length>0&&!x&&y(k[0])})},style:{fontSize:"9px",padding:"2px",background:"#333",border:"1px solid #555",color:"#ccc",cursor:"pointer",borderRadius:"5px"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[m.jsx("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),m.jsx("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"})]})})]}),m.jsx("label",{style:{display:"flex",alignItems:"center",fontSize:"10px"},children:m.jsx("input",{type:"checkbox",checked:u,onChange:k=>f(k.target.checked),disabled:u,style:{height:"100%"}})})]}),m.jsx("div",{className:"dac-list",children:a.map(k=>m.jsxs("div",{className:"dac-group",draggable:!0,onDragStart:C=>U(C,k),children:[m.jsxs("div",{className:"dac-ip",children:[k.hostName||k.ip," (",k.ip,")"]}),m.jsx("div",{className:"dac-channels",children:k.channels&&k.channels.length>0?k.channels.map(C=>m.jsxs("div",{className:`dac-channel-item ${h&&(h.unitID===k.unitID||h.ip===k.ip)&&h.channel===C.serviceID?"selected":""}`,onClick:()=>S(k,C.serviceID),draggable:!0,onDragStart:M=>w(M,k,C.serviceID),children:["Channel ",C.serviceID," (",C.name,")"]},`${k.unitID||k.ip}-${C.serviceID}`)):m.jsx("div",{className:"dac-channel-item no-channels",children:"No channels found"})})]},k.unitID||k.ip))}),a.length>0&&m.jsxs("div",{className:"dac-dimmers-section",children:[m.jsx("h4",{children:"Channel Dimmers"}),m.jsx("div",{className:"dac-dimmers-grid",children:a.flatMap(k=>(k.channels||[]).map(C=>({dac:k,ch:C}))).map(({dac:k,ch:C})=>{const M=`${k.ip}:${C.serviceID}`,F=i[M]||{},H=F.dimmer!==void 0?F.dimmer:1;return m.jsx(Ct,{id:`dimmer_${M.replace(/\./g,"_")}`,children:m.jsx(Ai,{label:`${k.hostName||k.ip} Ch${C.serviceID}`,value:H,onChange:fe=>{l&&l(M,{...F,dimmer:fe})}})},`dimmer_${M}`)})})]})]})},J0=({min:a,max:t,step:r,value:i,rangeValue:l,onChange:u,onRangeChange:f,showRange:h=!1,disabled:d=!1,animSettings:g,progressRef:v,workerId:x,clipDuration:y,bpm:E,getFftLevels:S})=>{const w=T.useRef(null),D=T.useRef(null),U=T.useRef(null),[k,C]=T.useState(null),M=a!==void 0?a:0,F=t!==void 0?t:1,H=l&&l[0]!==void 0?l[0]:M,fe=l&&l[1]!==void 0?l[1]:F,de=i!==void 0?i:M,ce=Z=>{const z=F-M;return z===0?0:(Z-M)/z*100};T.useEffect(()=>{let Z;const z=()=>{if(k==="value"){Z=requestAnimationFrame(z);return}let Q=de;if(g&&g.syncMode&&v&&v.current){const B={progress:x&&v.current[x]!==void 0?v.current[x]:0,time:performance.now(),clipDuration:y||1,bpm:E||120,fftLevels:S?S():{low:0,mid:0,high:0}};Q=W0(null,de,g,B)}const $=ce(Q);D.current&&(D.current.style.left=`${$}%`),U.current&&(U.current.style.width=`${$}%`),Z=requestAnimationFrame(z)};return Z=requestAnimationFrame(z),()=>cancelAnimationFrame(Z)},[g,v,x,de,k,M,F,E,S,y]);const le=(Z,z)=>{if(d)return;Z.preventDefault(),Z.stopPropagation(),C(z);const Q=W=>{if(!w.current)return;const B=w.current.getBoundingClientRect(),P=W.clientX-B.left;let V=Math.max(0,Math.min(100,P/B.width*100)),pe=M+V/100*(F-M);r&&(pe=Math.round(pe/r)*r,V=(pe-M)/(F-M)*100),z==="value"?(pe=Math.max(H,Math.min(fe,pe)),D.current&&(D.current.style.left=`${ce(pe)}%`),U.current&&!h&&(U.current.style.width=`${ce(pe)}%`),u&&u(pe)):z==="min"?(pe=Math.max(M,Math.min(fe,pe)),f&&f([pe,fe])):z==="max"&&(pe=Math.max(H,Math.min(F,pe)),f&&f([H,pe]))},$=()=>{C(null),window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",$)};window.addEventListener("mousemove",Q),window.addEventListener("mouseup",$)};return m.jsx("div",{className:"range-slider-container",style:{position:"relative",width:"100%",height:"20px",display:"flex",alignItems:"center"},children:m.jsxs("div",{className:"range-slider-track",ref:w,style:{width:"100%",height:"4px",background:"#444",borderRadius:"2px",position:"relative"},children:[h&&m.jsx("div",{className:"range-slider-fill",style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:`${ce(H)}%`,width:`${ce(fe)-ce(H)}%`}}),!h&&m.jsx("div",{className:"value-slider-fill",ref:U,style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:"0%",borderRadius:"2px"}}),h&&m.jsx("div",{className:"range-slider-handle min-handle",style:{left:`${ce(H)}%`},onMouseDown:Z=>le(Z,"min"),title:`Min: ${H.toFixed(2)}`}),h&&m.jsx("div",{className:"range-slider-handle max-handle",style:{left:`${ce(fe)}%`},onMouseDown:Z=>le(Z,"max"),title:`Max: ${fe.toFixed(2)}`}),m.jsx("div",{className:"range-slider-handle value-handle",ref:D,style:{position:"absolute",width:"6px",height:"16px",top:"-50%",transform:"translate(-50%, -25%)",cursor:"pointer",zIndex:20,boxShadow:"0 0 2px rgba(0,0,0,0.5)"},onMouseDown:Z=>le(Z,"value"),title:`Value: ${de.toFixed(2)}`})]})})},mn=({title:a,children:t,icon:r,defaultCollapsed:i=!1,headerActions:l})=>{const[u,f]=T.useState(i);return m.jsxs("div",{className:`settings-card ${u?"collapsed":""}`,children:[m.jsxs("div",{className:"settings-card-header",onClick:()=>f(!u),style:{cursor:"pointer",userSelect:"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",style:{transform:u?"rotate(0deg)":"rotate(90deg)",transition:"transform 0.2s"},children:m.jsx("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"})}),r&&m.jsx("span",{className:`bi ${r}`}),m.jsx("h4",{children:a})]}),l&&m.jsx("div",{onClick:h=>h.stopPropagation(),children:l})]}),!u&&m.jsx("div",{className:"settings-card-content",children:t})]})},em=({animSettings:a,onChange:t})=>{const{direction:r="forward",style:i="loop",syncMode:l=null,duration:u=1,beats:f=8,speedMultiplier:h=1}=a||{},d=(v,x)=>t({...a,[v]:x}),g=(v,x,y=!1)=>{let S=a?.[v]||(v==="beats"?8:1);y?S=x>1?S*2:S/2:S+=x,S<.01&&(S=.01),!y&&v!=="beats"&&(S=Math.round(S*100)/100),d(v,S)};return m.jsxs("div",{className:"anim-controls-container",children:[m.jsxs("div",{className:"anim-row controls-row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"5px"},children:[m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${r==="backward"?"active":""}`,onClick:()=>d("direction","backward"),title:"Backward",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",transform:"scale(-1 1)",children:m.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})}),m.jsx("button",{className:`speed-control-button ${r==="pause"?"active":""}`,onClick:()=>d("direction","pause"),title:"Pause",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"25",height:"20",viewBox:"0 0 16 16",className:"icon flat-color",children:m.jsx("path",{d:"M3 1h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m7 0h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m0 0"})})}),m.jsx("button",{className:`speed-control-button ${r==="forward"?"active":""}`,onClick:()=>d("direction","forward"),title:"Forward",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",children:m.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})})]}),m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${i==="once"?"active":""}`,onClick:()=>d("style","once"),title:"Once",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M43.8233 25.2305C43.7019 25.9889 43.5195 26.727 43.2814 27.4395 42.763 28.9914 41.9801 30.4222 40.9863 31.6785 38.4222 34.9201 34.454 37 30 37H16C9.39697 37 4 31.6785 4 25 4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M24 19V31",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M24 19 21 22 19.5 23.5",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),m.jsx("button",{className:`speed-control-button ${i==="bounce"?"active":""}`,onClick:()=>d("style","bounce"),title:"Bounce",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M42 19H5.99998",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M30 7 42 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M6.79897 29H42.799",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M6.79895 29 18.799 41",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),m.jsx("button",{className:`speed-control-button ${i==="loop"?"active":""}`,onClick:()=>d("style","loop"),title:"Loop",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M4 25C4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M44 23C44 29.6498 38.6038 35 32 35H4",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M10 41 4 35 10 29",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${l==="fps"?"active":""}`,onClick:()=>d("syncMode",l==="fps"?null:"fps"),style:{flex:1,padding:0,fontSize:"10px"},children:"F"}),m.jsx("button",{className:`speed-control-button ${l==="timeline"?"active":""}`,onClick:()=>d("syncMode",l==="timeline"?null:"timeline"),style:{flex:1,padding:0,fontSize:"10px"},children:"T"}),m.jsx("button",{className:`speed-control-button ${l==="bpm"?"active":""}`,onClick:()=>d("syncMode",l==="bpm"?null:"bpm"),style:{flex:1,padding:0,fontSize:"10px"},children:"B"}),m.jsx("button",{className:`speed-control-button ${l==="fft"?"active":""}`,onClick:()=>d("syncMode",l==="fft"?null:"fft"),style:{flex:1,padding:0,fontSize:"10px"},children:"FFT"})]})]}),l==="fft"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Range"}),m.jsxs("select",{value:a?.fftRange||"low",onChange:v=>d("fftRange",v.target.value),style:{fontSize:"10px",background:"#333",border:"1px solid #555",color:"white"},children:[m.jsx("option",{value:"low",children:"Low"}),m.jsx("option",{value:"mid",children:"Mid"}),m.jsx("option",{value:"high",children:"High"})]})]})}),l==="timeline"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Duration (s)"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",-1),children:"-1"}),m.jsx("input",{type:"number",value:typeof u=="number"?u.toFixed(2):u,onChange:v=>d("duration",parseFloat(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",1),children:"+1"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",.5,!0),children:"/2"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",2,!0),children:"*2"})]})]})}),l==="bpm"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Beats"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",-1),children:"-1"}),m.jsx("input",{type:"number",value:f,onChange:v=>d("beats",parseInt(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",1),children:"+1"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",.5,!0),children:"/2"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",2,!0),children:"*2"})]})]})}),(l==="timeline"||l==="bpm"||l==="fps")&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Speed"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("speedMultiplier",-.1),children:"-0.1"}),m.jsx("input",{type:"number",value:typeof h=="number"?h.toFixed(2):h,onChange:v=>d("speedMultiplier",parseFloat(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("speedMultiplier",.1),children:"+0.1"})]})]})})]})},oy=({control:a,value:t,onChange:r,animSettings:i,onAnimChange:l,effectId:u,context:f,progressRef:h,workerId:d,clipDuration:g,bpm:v,getFftLevels:x})=>{const[y,E]=T.useState(!1),[S,w]=T.useState(!1),D=M=>{M.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:a.type,paramName:a.id,effectId:u,min:a.min,max:a.max,step:a.step,...f}))},U=i?.range||[a.min,a.max],k=M=>{l({...i,range:M})},C=M=>{l({range:U,...M})};return m.jsxs("div",{className:`param-editor ${y?"expanded":""}`,onMouseEnter:()=>w(!0),onMouseLeave:()=>w(!1),style:{marginBottom:"8px",display:"grid",gridTemplateColumns:"1fr",gap:"2px"},children:[m.jsx("div",{className:"param-row-label",style:{width:"100%"},children:m.jsx("label",{className:"param-label",draggable:!0,onDragStart:D,style:{fontSize:"11px",color:"#aaa"},children:a.label})}),m.jsxs("div",{className:"param-row-control",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[m.jsx("button",{className:`anim-toggle-btn ${y?"active":""}`,style:{visibility:S||y||i?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>E(!y),title:"Animate",children:""}),m.jsx("div",{className:"control-input-wrapper",style:{display:"flex",alignItems:"center",height:"100%"},children:a.type==="range"?m.jsx(Ct,{id:`${u}_${a.id}`,style:{width:"100%"},children:m.jsx(J0,{min:a.min,max:a.max,step:a.step,value:t,rangeValue:U,onChange:r,onRangeChange:k,showRange:y,animSettings:i,progressRef:h,workerId:d,clipDuration:g,bpm:v,getFftLevels:x})}):a.type==="text"?m.jsx("input",{type:"text",value:t,onChange:M=>r(M.target.value),className:"param-text-input"}):a.type==="checkbox"?m.jsx(Ct,{id:`${u}_${a.id}`,children:m.jsx("input",{type:"checkbox",checked:t,onChange:M=>r(M.target.checked),className:"param-checkbox"})}):a.type==="select"?m.jsx("select",{value:t,onChange:M=>r(M.target.value),className:"param-select",children:a.options.map(M=>m.jsx("option",{value:M,children:M},M))}):null}),a.type==="range"&&m.jsx("input",{type:"number",value:typeof t=="number"?t.toFixed(2):t,onChange:M=>r(parseFloat(M.target.value)||0),className:"param-number-input",step:a.step,style:{width:"100%",fontSize:"10px"}})]}),y&&a.type==="range"&&m.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:m.jsx(em,{animSettings:i,onChange:C})})]})},uy=({customOrder:a=[],assignedDacs:t=[],onChange:r})=>{const[i,l]=T.useState(null),u=a&&a.length>0?a:t.map((d,g)=>({ip:d.ip,channel:d.channel,label:`Ch ${d.channel} (${d.hostName||d.ip})`,originalIndex:g})),f=(d,g)=>{l(u[g])},h=(d,g)=>{d.preventDefault();const v=u[g];if(i===v)return;const x=u.filter(y=>y!==i);x.splice(g,0,i),r(x)};return m.jsxs("div",{className:"custom-order-editor",style:{marginBottom:"10px",padding:"5px",background:"#222",borderRadius:"4px"},children:[m.jsx("label",{style:{fontSize:"10px",color:"#888"},children:"Channel Order (Drag to Sort)"}),m.jsx("ul",{style:{listStyle:"none",padding:0,margin:"5px 0"},children:u.map((d,g)=>m.jsxs("li",{draggable:!0,onDragStart:v=>f(v,g),onDragOver:v=>h(v,g),style:{background:"#333",border:"1px solid #444",padding:"4px",marginBottom:"2px",fontSize:"10px",cursor:"grab",display:"flex",alignItems:"center"},children:[m.jsx("span",{style:{marginRight:"5px",color:"#666"},children:""}),d.label||`Ch ${d.channel} ${d.ip?`(${d.ip})`:""}`]},g))})]})},tm=({effect:a,assignedDacs:t=[],onParamChange:r,onRemove:i,syncSettings:l={},onSetParamSync:u,context:f={},progressRef:h,clipDuration:d,bpm:g,getFftLevels:v})=>{if(!a)return null;const x=rn.find(U=>U.id===a.id);if(!x)return null;const y=a.id==="delay",E=a.id==="chase",S=a.params.enabled!==!1,w=a.params.mode==="channel",D=U=>{U.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"enabled",label:`${a.name} ON`,...f}))};return m.jsxs(mn,{title:a.name,headerActions:m.jsxs("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(y||E)&&m.jsx("button",{className:"mode-toggle-btn",onClick:()=>r("mode",w?"frame":"channel"),style:{fontSize:"9px",padding:"2px 5px",background:w?"#444":"var(--theme-color)",border:"none",color:"white",borderRadius:"3px",cursor:"pointer"},children:w?"CHANNEL":"FRAME"}),m.jsx(Ct,{id:`${a.id}_blackout`,children:m.jsx("button",{className:`layer-control-button ${S?"":"active"}`,onClick:()=>r("enabled",!S),draggable:!0,onDragStart:D,style:{padding:"2px",background:S?"none":"red",border:"none",color:"white",cursor:"pointer",display:"flex"},title:"Toggle Effect",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx("button",{className:"remove-effect-btn",onClick:i,children:""})]}),children:[y&&m.jsx(m.Fragment,{children:a.params.useCustomOrder&&m.jsx(uy,{customOrder:a.params.customOrder,assignedDacs:t,onChange:U=>r("customOrder",U)})}),x.paramControls.map(U=>{if(y&&["customOrder"].includes(U.id)||U.showIf&&!Object.entries(U.showIf).every(([F,H])=>a.params[F]===H))return null;const k=`${a.instanceId||a.id}.${U.id}`,C=typeof l[k]=="object"?l[k]:{syncMode:l[k]};return m.jsx(oy,{control:U,value:a.params[U.id],onChange:M=>r(U.id,M),animSettings:C,onAnimChange:M=>u(k,M),effectId:a.id,context:f,progressRef:h,workerId:f.workerId,clipDuration:d,bpm:g,getFftLevels:v},U.id)})]})},cy=({control:a,value:t,onChange:r,syncSettings:i,onSetParamSync:l,layerIndex:u,colIndex:f,progressRef:h,workerId:d,generatorId:g,clipDuration:v})=>{const[x,y]=T.useState(!1),[E,S]=T.useState(!1),w=M=>{M.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:a.type,paramName:a.id,targetType:"generator",layerIndex:u,colIndex:f,min:a.min,max:a.max,step:a.step}))},D=`${g}.${a.id}`,U=typeof i[D]=="object"?i[D]:{syncMode:i[D]},k=U?.range||[a.min,a.max],C=M=>{l(D,{...U,range:M})};return m.jsxs("div",{className:`param-editor ${x?"expanded":""}`,onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),style:{marginBottom:"8px"},children:[m.jsx("div",{className:"param-label-row",style:{display:"flex",alignItems:"center"},children:m.jsx("label",{draggable:!0,onDragStart:w,className:"param-label",style:{fontSize:"11px",color:"#aaa"},children:a.label})}),m.jsxs("div",{className:"control-row",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[m.jsx("button",{className:`anim-toggle-btn ${x?"active":""}`,style:{visibility:E||x||U?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>y(!x),title:"Animate",children:""}),m.jsx("div",{className:"control-input-wrapper",children:a.type==="range"?m.jsx(J0,{min:a.min,max:a.max,step:a.step,value:t,rangeValue:k,onChange:M=>r(a.id,M),onRangeChange:C,showRange:x,animSettings:U,progressRef:h,workerId:d,clipDuration:v}):a.type==="number"?m.jsx("input",{type:"number",value:t,onChange:M=>r(a.id,parseFloat(M.target.value)||0),className:"param-number-input",step:a.step}):a.type==="text"?m.jsx("input",{type:"text",value:t,onChange:M=>r(a.id,M.target.value),className:"param-text-input"}):a.type==="checkbox"?m.jsx("input",{type:"checkbox",checked:t,onChange:M=>r(a.id,M.target.checked),className:"param-checkbox"}):null}),a.type==="range"&&m.jsx("input",{type:"number",value:typeof t=="number"?t.toFixed(2):t,onChange:M=>r(a.id,parseFloat(M.target.value)||0),className:"param-number-input",step:a.step,style:{width:"100%",fontSize:"10px"}})]}),x&&a.type==="range"&&m.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:m.jsx(em,{animSettings:U,onChange:M=>l(D,M)})})]})},fy=({selectedGeneratorId:a,selectedGeneratorParams:t,onParameterChange:r,syncSettings:i={},onSetParamSync:l,layerIndex:u,colIndex:f,progressRef:h,workerId:d,clipDuration:g})=>{const[v,x]=T.useState([]),[y,E]=T.useState([]),[S,w]=T.useState(!1);if(!a)return m.jsx("div",{className:"generator-settings-panel",children:"No generator selected."});const D=gf.find(k=>k.id===a);if(!D)return m.jsxs("div",{className:"generator-settings-panel",children:["Generator definition not found for ID: ",a]});T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getProjectFonts)try{const C=await window.electronAPI.getProjectFonts();E(C)}catch(C){console.error("Failed to load project fonts:",C)}})()},[]);const U=async k=>{const C=k.target.value;if(C==="browse")if(window.electronAPI&&window.electronAPI.showFontFileDialog){const M=await window.electronAPI.showFontFileDialog();M&&r("fontUrl",M)}else console.error("Font file dialog API not available.");else if(C==="load-system"){w(!0);try{const F=(await window.electronAPI.getSystemFonts()).map(H=>({name:H.split(/[\\/]/).pop(),path:H})).sort((H,fe)=>H.name.localeCompare(fe.name));x(F)}catch(M){console.error("Failed to load system fonts:",M)}w(!1)}else r("fontUrl",C)};return m.jsx(mn,{title:`${D.name} Settings`,children:D.paramControls.map(k=>{if(k.id==="fontUrl"){const C=t[k.id]||"src/fonts/Geometr415 Blk BT Black.ttf";return m.jsxs("div",{className:"param-editor",children:[m.jsx("label",{className:"param-label",children:k.label}),m.jsxs("div",{className:"font-selector-container",children:[m.jsxs("select",{className:"param-select",onChange:U,value:C,children:[y.length>0?m.jsx("optgroup",{label:"Project Fonts",children:y.map(M=>m.jsx("option",{value:M.path,children:M.name},M.path))}):m.jsx("optgroup",{label:"Default Fonts",children:m.jsx("option",{value:"src/fonts/Geometr415 Blk BT Black.ttf",children:"Geometr415"})}),v.length>0?m.jsx("optgroup",{label:"System Fonts",children:v.map(M=>m.jsx("option",{value:M.path,children:M.name},M.path))}):m.jsx("option",{value:"load-system",children:S?"Loading...":"Load System Fonts..."}),m.jsx("optgroup",{label:"Actions",children:m.jsx("option",{value:"browse",children:"Browse File..."})})]}),m.jsx("span",{className:"font-path-tiny",title:C,children:C.split(/[\\/]/).pop()})]})]},k.id)}return m.jsx(cy,{control:k,value:t[k.id],onChange:r,syncSettings:i,onSetParamSync:l,layerIndex:u,colIndex:f,progressRef:h,workerId:d,generatorId:a,clipDuration:g},k.id)})})},dy=({settings:a,onUpdate:t})=>{const{mode:r="fps",duration:i=1,beats:l=8,speedMultiplier:u=1,fps:f=60}=a||{},h=g=>{t({mode:g})},d=(g,v,x=!1)=>{let y=a[g]||(g==="beats"?8:g==="fps"?60:1);x?y=v>1?y*2:y/2:y+=v,y<.01&&(y=.01),t({[g]:y})};return m.jsxs(mn,{title:"Clip Playback",children:[m.jsxs("div",{className:"playback-mode-selector",children:[m.jsx("button",{className:r==="fps"?"active":"",onClick:()=>h("fps"),children:"FPS"}),m.jsx("button",{className:r==="timeline"?"active":"",onClick:()=>h("timeline"),children:"Timeline"}),m.jsx("button",{className:r==="bpm"?"active":"",onClick:()=>h("bpm"),children:"BPM Sync"})]}),m.jsxs("div",{className:"playback-controls",children:[r==="fps"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Speed (FPS)"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("fps",-1),children:"-1"}),m.jsx("input",{type:"number",value:f,onChange:g=>t({fps:parseInt(g.target.value)||60})}),m.jsx("button",{onClick:()=>d("fps",1),children:"+1"}),m.jsx("button",{onClick:()=>d("fps",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("fps",2,!0),children:"*2"})]})]}),m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Duration (s) (for effects)"}),m.jsx("div",{className:"value-adjuster",children:m.jsx("input",{type:"number",value:i.toFixed(2),onChange:g=>t({duration:parseFloat(g.target.value)||1})})})]})]}),r==="timeline"&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Duration (s)"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("duration",-1),children:"-1"}),m.jsx("input",{type:"number",value:i.toFixed(2),onChange:g=>t({duration:parseFloat(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("duration",1),children:"+1"}),m.jsx("button",{onClick:()=>d("duration",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("duration",2,!0),children:"*2"})]})]}),r==="bpm"&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Beats"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("beats",-1),children:"-1"}),m.jsx("input",{type:"number",value:l,onChange:g=>t({beats:parseInt(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("beats",1),children:"+1"}),m.jsx("button",{onClick:()=>d("beats",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("beats",2,!0),children:"*2"})]})]}),(r==="timeline"||r==="bpm")&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Speed Multiplier"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("speedMultiplier",-.1),children:"-0.1"}),m.jsx("input",{type:"number",value:u.toFixed(2),onChange:g=>t({speedMultiplier:parseFloat(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("speedMultiplier",.1),children:"+0.1"})]})]})]})]})},nm=T.createContext(),Sl=()=>T.useContext(nm),py=({children:a})=>{const[t,r]=T.useState(null),[i,l]=T.useState(null),[u,f]=T.useState(null),[h,d]=T.useState({source:"external",lowRange:[20,250],midRange:[250,4e3],highRange:[4e3,2e4],gain:1,holdTime:100,fallTime:500,calculationMode:"average",smoothingTimeConstant:.8}),[g,v]=T.useState({low:0,mid:0,high:0}),x=T.useRef(new Uint8Array(0)),y=T.useRef({low:0,mid:0,high:0}),E=T.useRef({low:0,mid:0,high:0,lastUpdateTime:Date.now(),peakTimes:{low:0,mid:0,high:0}}),[S,w]=T.useState([]),[D,U]=T.useState("default"),[k,C]=T.useState(1),M=T.useRef({}),F=T.useRef({}),H=T.useRef({}),fe=T.useCallback(async()=>{try{const ge=(await navigator.mediaDevices.enumerateDevices()).filter(Ee=>Ee.kind==="audiooutput");if(w(ge),window.electronAPI&&window.electronAPI.setAudioDevices){const Ee=ge.map(Ke=>({deviceId:Ke.deviceId,label:Ke.label,groupId:Ke.groupId}));window.electronAPI.setAudioDevices(Ee)}}catch(te){console.error("Error enumerating audio devices:",te)}},[]);T.useEffect(()=>{fe();let te;return window.electronAPI&&window.electronAPI.onUpdateAudioDeviceId&&(te=window.electronAPI.onUpdateAudioDeviceId(ge=>{U(ge)})),navigator.mediaDevices.addEventListener("devicechange",fe),()=>{navigator.mediaDevices.removeEventListener("devicechange",fe),te&&te()}},[fe]);const de=T.useCallback(te=>{if(!t||!i)return null;try{const ge=t.createMediaElementSource(te);return ge.connect(i),ge.connect(t.destination),ge}catch(ge){return console.warn("MediaElementSource already connected?",ge),null}},[t,i]),ce=T.useCallback(async(te,ge,Ee=1,Ke=!0)=>{if(M.current[te]&&(M.current[te].pause(),M.current[te].src=""),H.current[te]=Ee,!ge)return;if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(ge))throw new Error(`Audio file not found: ${ge}`);const ke=new Audio(`file://${ge}`);if(ke.crossOrigin="anonymous",ke.volume=Ee*k,D&&ke.setSinkId)try{await ke.setSinkId(D)}catch(at){console.error("Error setting audio sink ID:",at)}if(M.current[te]=ke,t){const at=de(ke);at&&(F.current[te]=at)}if(Ke)try{await ke.play()}catch(at){throw console.error("Error playing audio:",at),at}return ke},[D,de,k,t]),le=T.useCallback(te=>{C(te),Object.keys(M.current).forEach(ge=>{const Ee=M.current[ge],Ke=H.current[ge]??1;Ee&&(Ee.volume=te*Ke)})},[]),Z=T.useCallback((te,ge)=>{H.current[te]=ge;const Ee=M.current[te];Ee&&(Ee.volume=ge*k)},[k]),z=T.useCallback(te=>{if(M.current[te]&&(M.current[te].pause(),M.current[te].src="",delete M.current[te],F.current[te])){try{F.current[te].disconnect()}catch{}delete F.current[te]}},[]),Q=T.useCallback(te=>{M.current[te]&&M.current[te].pause()},[]),$=T.useCallback(async te=>{if(M.current[te]&&M.current[te].paused)try{await M.current[te].play()}catch(ge){console.error("Error resuming:",ge)}},[]),W=T.useCallback(te=>{const ge=Math.max(.0625,Math.min(te,16));Object.values(M.current).forEach(Ee=>{try{Ee.playbackRate=ge}catch(Ke){console.warn("Failed to set playbackRate:",Ke)}})},[]),B=T.useCallback(te=>{M.current[te]&&(M.current[te].currentTime=0)},[]),P=T.useCallback((te,ge)=>{M.current[te]&&(M.current[te].currentTime=ge)},[]),V=T.useCallback(()=>Object.keys(M.current).forEach(z),[z]),pe=T.useCallback(()=>Object.keys(M.current).forEach(Q),[Q]),R=T.useCallback(()=>Object.keys(M.current).forEach($),[$]),G=T.useCallback(()=>Object.keys(M.current).forEach(B),[B]),ie=T.useCallback(te=>{const ge=M.current[te];return ge?{currentTime:ge.currentTime,duration:ge.duration,paused:ge.paused}:null},[]),ve=T.useCallback(()=>{if(t)return;const te=new(window.AudioContext||window.webkitAudioContext),ge=te.createAnalyser();ge.fftSize=2048,ge.smoothingTimeConstant=h.smoothingTimeConstant,x.current=new Uint8Array(ge.frequencyBinCount),r(te),l(ge)},[t,h.smoothingTimeConstant]);return T.useEffect(()=>{const te=()=>{ve(),window.removeEventListener("mousedown",te),window.removeEventListener("keydown",te)};return window.addEventListener("mousedown",te),window.addEventListener("keydown",te),()=>{window.removeEventListener("mousedown",te),window.removeEventListener("keydown",te)}},[ve]),T.useEffect(()=>{i&&(i.smoothingTimeConstant=h.smoothingTimeConstant)},[i,h.smoothingTimeConstant]),T.useEffect(()=>{if(!t||!i||h.source!=="external"){u&&(u.disconnect(),f(null));return}let te=null;return(async()=>{try{te=await navigator.mediaDevices.getUserMedia({audio:!0});const Ee=t.createMediaStreamSource(te);Ee.connect(i),f(Ee)}catch(Ee){console.error("Failed to get external audio stream:",Ee)}})(),()=>{te&&te.getTracks().forEach(Ee=>Ee.stop())}},[t,i,h.source]),T.useEffect(()=>{if(!i)return;let te;const ge=()=>{i.getByteFrequencyData(x.current);const Ee=t.sampleRate,Ke=i.frequencyBinCount,ke=Ee/i.fftSize,at=Te=>{const Kt=Math.floor(Te[0]/ke),Gt=Math.floor(Te[1]/ke);if(h.calculationMode==="peak"){let ut=0;for(let Bt=Kt;Bt<=Gt&&Bt<Ke;Bt++)x.current[Bt]>ut&&(ut=x.current[Bt]);return ut/255}else{let ut=0,Bt=0;for(let gn=Kt;gn<=Gt&&gn<Ke;gn++)ut+=x.current[gn],Bt++;return Bt>0?ut/Bt/255:0}},$t=at(h.lowRange),Be=at(h.midRange),Ue=at(h.highRange),ye=Date.now(),ne=Math.max(0,ye-E.current.lastUpdateTime);E.current.lastUpdateTime=ye;const ft=(Te,Kt)=>{let Gt=Te*h.gain;const ut=E.current[Kt],Bt=E.current.peakTimes[Kt]||0;if(Gt>=ut)return E.current.peakTimes[Kt]=ye,Gt;{if(ye-Bt<h.holdTime)return ut;if(h.fallTime<=0)return 0;const cr=ne/h.fallTime,na=ut-cr;return Math.max(0,isNaN(na)?0:na)}},ht={low:ft($t,"low"),mid:ft(Be,"mid"),high:ft(Ue,"high")};y.current=ht,E.current={...ht,lastUpdateTime:ye,peakTimes:E.current.peakTimes},te=requestAnimationFrame(ge)};return ge(),()=>cancelAnimationFrame(te)},[t,i,h]),m.jsx(nm.Provider,{value:{audioCtx:t,analyser:i,fftSettings:h,setFftSettings:d,fftLevels:y.current,fftLevelsRef:y,getFftLevels:()=>y.current,connectMediaElement:de,initAudio:ve,devices:S,selectedDeviceId:D,setSelectedDeviceId:U,globalVolume:k,setVolume:le,setClipVolume:Z,playAudio:ce,stopAudio:z,pauseAudio:Q,resumeAudio:$,setPlaybackRate:W,resetAudio:B,seekAudio:P,stopAllAudio:V,pauseAllAudio:pe,resumeAllAudio:R,resetAllAudio:G,getAudioInfo:ie},children:a})},hy=({audioFile:a,layerIndex:t,onSeek:r,onLoadError:i})=>{const l=T.useRef(null),u=T.useRef(null),{audioCtx:f,getAudioInfo:h}=Sl(),[d,g]=T.useState(null),[v,x]=T.useState("rgb(255, 94, 0)"),y=T.useRef(null),E=T.useRef(!1),S=T.useCallback(()=>{const C=document.createElement("div");C.style.display="none",C.style.color="var(--theme-color)",document.body.appendChild(C);const M=getComputedStyle(C).color;document.body.removeChild(C),M&&M!=="rgba(0, 0, 0, 0)"&&x(M)},[]);T.useEffect(()=>{S();const C=new MutationObserver(S);return C.observe(document.documentElement,{attributes:!0,attributeFilter:["style","class"]}),()=>C.disconnect()},[S]),T.useEffect(()=>{if(!a?.path||!f)return;let C=!0;const M=async()=>{try{if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(a.path))throw new Error(`File not found: ${a.path}`);const F=await fetch(`file://${a.path}`);if(!F.ok)throw new Error(`HTTP error! status: ${F.status}`);const H=await F.arrayBuffer();if(!C)return;const fe=await f.decodeAudioData(H);C&&g(fe)}catch(F){if(!C)return;console.error("Failed to load/decode audio for waveform:",F),i&&i(F)}};return g(null),M(),()=>{C=!1}},[a,f,i]);const w=T.useCallback((C,M,F,H,fe)=>{if(!H)return;const de=H.getChannelData(0),ce=F/2,le=2,z=le+2;C.clearRect(0,0,M,F);const Q=B=>{C.fillStyle=B,C.beginPath();for(let P=0;P<M;P+=z){const V=Math.floor(P*(de.length/M)),pe=Math.floor((P+le)*(de.length/M));let R=1,G=-1;for(let te=V;te<pe&&te<de.length;te++){const ge=de[te];ge<R&&(R=ge),ge>G&&(G=ge)}const ie=(1+R)*ce,ve=Math.max(1,(G-R)*ce);C.roundRect?C.roundRect(P,ie,le,ve,1):C.rect(P,ie,le,ve)}C.fill()},$=M*fe;let W=v;v.startsWith("rgb(")&&(W=v.replace("rgb","rgba").replace(")",", 0.25)")),Q(W),fe>0&&(C.save(),C.beginPath(),C.rect(0,0,$,F),C.clip(),Q(v),C.restore()),C.fillStyle="#ffffff",C.fillRect($,0,1,F)},[v]);T.useEffect(()=>{const C=l.current;if(!C||!d)return;const M=C.getContext("2d"),F=()=>{const H=C.getBoundingClientRect();(C.width!==H.width||C.height!==H.height)&&(C.width=H.width,C.height=H.height);const fe=C.width,de=C.height;let ce=0;if(t!=null){const le=h(t);le&&le.duration>0&&(ce=le.currentTime/le.duration)}ce=Math.max(0,Math.min(1,ce)),w(M,fe,de,d,ce),y.current=requestAnimationFrame(F)};return F(),()=>{y.current&&cancelAnimationFrame(y.current)}},[d,t,h,w]);const D=C=>{E.current=!0,k(C),window.addEventListener("mouseup",U),window.addEventListener("mousemove",k)},U=()=>{E.current=!1,window.removeEventListener("mouseup",U),window.removeEventListener("mousemove",k)},k=C=>{if(!l.current||!d)return;const M=l.current.getBoundingClientRect(),F=C.clientX-M.left,H=M.width,de=Math.max(0,Math.min(1,F/H))*d.duration;r&&r(de)};return m.jsx("div",{ref:u,className:"wave-player-container",style:{width:"100%",height:"35px",marginBottom:"10px",background:"transparent",borderRadius:"4px",overflow:"hidden"},onMouseDown:D,children:m.jsx("canvas",{ref:l,style:{width:"100%",height:"100%",display:"block",cursor:"pointer"}})})},my=({selectedLayerIndex:a,selectedColIndex:t,clip:r,audioInfo:i,bpm:l,getFftLevels:u,onAssignAudio:f,onRemoveAudio:h,onUpdateAudioVolume:d,onUpdatePlaybackSettings:g,onSetParamSync:v,onToggleDacMirror:x,onRemoveDac:y,onRemoveEffect:E,onReorderEffects:S,onAddEffect:w,onParameterChange:D,onGeneratorParameterChange:U,progressRef:k,onAudioError:C})=>{const[M,F]=T.useState({}),[H,fe]=T.useState(null),{seekAudio:de}=Sl(),ce=T.useRef(0),le=ea.useCallback(Be=>{C&&C(a,t)},[C,a,t]);if(T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(Ue=>{F(ye=>({...ye,[Ue.ip]:Ue.status}))})},[]),a===null||t===null)return m.jsxs("div",{className:"clip-settings-panel settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Clip Settings"})}),m.jsx("p",{className:"info-text",children:"Select a clip to view settings."})]});const Z=Be=>{Be.preventDefault(),Be.stopPropagation();try{const Ue=Be.dataTransfer.getData("application/json");if(!Ue)return;const ye=JSON.parse(Ue);ye&&ye.type&&w&&w(ye)}catch(Ue){console.error("Failed to drop effect in ClipSettingsPanel:",Ue)}},z=Be=>{Be.preventDefault(),Be.dataTransfer.dropEffect="copy"},Q=Be=>{fe(Be)},$=(Be,Ue)=>{if(Be.preventDefault(),H===null||H===Ue)return;const ye=Date.now();ye-ce.current<200||(ce.current=ye,S&&(S(a,t,H,Ue),fe(Ue)))},W=Be=>{fe(null)},{effects:B=[],assignedDacs:P=[],playbackSettings:V={},syncSettings:pe={},audioFile:R=null,audioVolume:G=1,type:ie=null,generatorDefinition:ve=null,currentParams:te={},workerId:ge=null}=r||{},Ee=B.length>0,Ke=ie==="generator"&&!!ve,ke=P.length>0;let at=1;if(V.mode==="timeline")at=V.duration||1;else if(V.mode==="bpm"){const Be=l||120;at=(V.beats||8)*60/Be}else{const Be=V.fps||r?.fps||30;at=(r?.totalFrames||30)/Be}const $t=ge||(ie==="ilda"?`ilda-${a}-${t}`:ie==="generator"?`generator-${a}-${t}`:null);return i&&i.duration&&i.currentTime/i.duration*100,m.jsxs("div",{className:"clip-settings-panel settings-panel-base",onDrop:Z,onDragOver:z,children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Clip Settings"})}),m.jsx(mn,{title:"Audio",children:R?m.jsxs("div",{className:"assigned-audio-info",style:{position:"relative"},children:[m.jsx("button",{className:"remove-effect-btn",onClick:h,style:{position:"absolute",top:"-5px",right:"-5px",fontSize:"14px"},children:""}),m.jsx("div",{className:"audio-file-name",title:R.path,style:{paddingRight:"15px",marginBottom:"8px",fontSize:"11px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:R.name}),m.jsx(hy,{audioFile:R,audioInfo:i,layerIndex:a,onSeek:Be=>de(a,Be),onLoadError:le}),m.jsxs("div",{className:"audio-volume-control",style:{marginTop:"10px"},children:[m.jsxs("label",{style:{fontSize:"10px",display:"block",marginBottom:"2px"},children:["Volume: ",Math.round(G*100),"%"]}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:G,onChange:Be=>d(a,t,parseFloat(Be.target.value)),className:"slider_hor",style:{width:"100%",height:"4px"}})]})]}):m.jsx("button",{className:"assign-audio-btn",onClick:f,children:"Assign Audio File"})}),m.jsx(dy,{settings:V,onUpdate:Be=>g(a,t,Be)}),ke&&m.jsx(mn,{title:"Assigned DACs",children:m.jsx("ul",{className:"assigned-dacs-list",children:P.map((Be,Ue)=>{const ye=M[Be.ip];return m.jsxs("li",{className:"assigned-dac-item",children:[m.jsxs("div",{className:"dac-info-block",children:[m.jsxs("span",{className:"dac-name-tiny",children:[Be.hostName||Be.ip," - Ch ",Be.channel]}),ye&&m.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",ye.playback_state===2?"PLAYING":ye.playback_state===1?"PREPARED":"IDLE"," | Buf: ",ye.buffer_fullness,ye.buffer_capacity?`/${ye.buffer_capacity}`:""," | PPS: ",ye.point_rate]})]}),m.jsxs("div",{className:"dac-mirror-controls",children:[m.jsx("button",{className:`mirror-btn ${Be.mirrorX?"active":""}`,onClick:()=>x(a,t,Ue,"x"),title:"Mirror X Axis",children:"X"}),m.jsx("button",{className:`mirror-btn ${Be.mirrorY?"active":""}`,onClick:()=>x(a,t,Ue,"y"),title:"Mirror Y Axis",children:"Y"})]}),m.jsx("button",{className:"remove-dac-btn",onClick:()=>y(Ue),children:""})]},`${Be.unitID||Be.ip}-${Be.channel}-${Ue}`)})})}),Ke&&m.jsx(fy,{selectedGeneratorId:ve.id,selectedGeneratorParams:te,onParameterChange:U,syncSettings:pe,onSetParamSync:v,layerIndex:a,colIndex:t,progressRef:k,workerId:$t,clipDuration:at,bpm:l,getFftLevels:u}),m.jsx(mn,{title:"Clip Effects",children:m.jsx("div",{className:"clip-effects-list",style:{minHeight:"50px"},onDrop:W,children:Ee?B.map((Be,Ue)=>m.jsx("div",{draggable:!0,onDragStart:()=>Q(Ue),onDragOver:ye=>$(ye,Ue),children:m.jsx(tm,{effect:Be,assignedDacs:P,syncSettings:pe,onSetParamSync:v,context:{layerIndex:a,colIndex:t,effectIndex:Ue,targetType:"effect",workerId:$t},onParamChange:(ye,ne)=>D(a,t,Ue,ye,ne),onRemove:()=>E(a,t,Ue),progressRef:k,clipDuration:at,bpm:l,getFftLevels:u})},Be.instanceId||Be.id+Ue)):m.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},gy=({selectedLayerIndex:a,autopilotMode:t,onAutopilotChange:r,layerEffects:i,assignedDacs:l=[],onToggleDacMirror:u,onRemoveDac:f,onAddEffect:h,onRemoveEffect:d,onParamChange:g})=>{const[v,x]=T.useState({});if(T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(w=>{x(D=>({...D,[w.ip]:w.status}))})},[]),a===null)return m.jsxs("div",{className:"settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Layer Settings"})}),m.jsx("div",{className:"settings-card-content",children:m.jsx("p",{className:"info-text",children:"Select a layer to edit settings"})})]});const y=S=>{S.preventDefault(),S.stopPropagation();try{const w=JSON.parse(S.dataTransfer.getData("application/json"));w&&w.id&&h(w)}catch(w){console.error("Failed to drop effect:",w)}},E=S=>{S.preventDefault(),S.dataTransfer.dropEffect="copy"};return m.jsxs("div",{className:"settings-panel-base",onDrop:y,onDragOver:E,children:[m.jsx("h3",{children:"Layer Settings"}),l&&l.length>0&&m.jsx(mn,{title:"Assigned DACs",children:m.jsx("ul",{className:"assigned-dacs-list",children:l.map((S,w)=>{const D=v[S.ip];return m.jsxs("li",{className:"assigned-dac-item",children:[m.jsxs("div",{className:"dac-info-block",children:[m.jsxs("span",{className:"dac-name-tiny",children:[S.hostName||S.ip," - Ch ",S.channel]}),D&&m.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",D.playback_state===2?"PLAYING":D.playback_state===1?"PREPARED":"IDLE"," | Buf: ",D.buffer_fullness,D.buffer_capacity?`/${D.buffer_capacity}`:""," | PPS: ",D.point_rate]})]}),m.jsxs("div",{className:"dac-mirror-controls",children:[m.jsx("button",{className:`mirror-btn ${S.mirrorX?"active":""}`,onClick:()=>u(a,w,"x"),title:"Mirror X Axis",children:"X"}),m.jsx("button",{className:`mirror-btn ${S.mirrorY?"active":""}`,onClick:()=>u(a,w,"y"),title:"Mirror Y Axis",children:"Y"})]}),m.jsx("button",{className:"remove-dac-btn",onClick:()=>f(a,w),children:""})]},`${S.unitID||S.ip}-${S.channel}-${w}`)})})}),m.jsx(mn,{title:`Layer ${a+1} Autopilot`,children:m.jsxs("div",{className:"param-editor",children:[m.jsx("label",{children:"Mode"}),m.jsx("div",{className:"clip-playback-settings",children:m.jsxs("div",{className:"playback-mode-selector",children:[m.jsx("button",{className:t==="off"?"active":"",onClick:()=>r("off"),children:"OFF"}),m.jsx("button",{className:t==="forward"?"active":"",onClick:()=>r("forward"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-forward-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"m9.77 12.11 4.012-2.953a.647.647 0 0 0 0-1.114L9.771 5.09a.644.644 0 0 0-.971.557V6.65H2v3.9h6.8v1.003c0 .505.545.808.97.557"})})}),m.jsx("button",{className:t==="random"?"active":"",onClick:()=>r("random"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-shuffle",viewBox:"0 0 16 16",children:[m.jsx("path",{fillRule:"evenodd",d:"M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"}),m.jsx("path",{d:"M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"})]})})]})})]})}),m.jsx(mn,{title:"Layer Effects",children:m.jsx("div",{className:"layer-effects-list",style:{minHeight:"50px"},children:i&&i.length>0?i.map((S,w)=>m.jsx(tm,{effect:S,onRemove:()=>d(w),onParamChange:(D,U)=>g(w,D,U),syncSettings:{},onSetParamSync:()=>{},context:{layerIndex:a,colIndex:null,effectIndex:w,targetType:"layerEffect"}},S.instanceId||w)):m.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},vy=({message:a,visible:t})=>t?m.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#333",color:"white",padding:"10px 20px",borderRadius:"5px",zIndex:1e3,opacity:t?1:0,transition:"opacity 0.5s ease-in-out"},children:a}):null,am=T.createContext(null),rm=()=>T.useContext(am),yy=({children:a,onWorkerMessage:t})=>{const r=T.useRef(null);return r.current===null&&(r.current=new Worker(new URL(""+new URL("rendering.worker-Dp_eJUWO.js",import.meta.url).href,import.meta.url),{type:"module"})),T.useEffect(()=>{const i=r.current;return t&&(i.onmessage=t),()=>{i.terminate(),t&&(i.onmessage=null)}},[t]),m.jsx(am.Provider,{value:r.current,children:a})},by=({frame:a,effects:t,showBeamEffect:r,beamAlpha:i,fadeAlpha:l,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d={},bpm:g=120,clipDuration:v=1,progress:x=0,previewTime:y=0,fftLevels:E={low:0,mid:0,high:0},effectStates:S=null,onToggleBeamEffect:w,onCycleDisplayMode:D})=>{const U=T.useRef(null),k=rm(),C=T.useRef(`ilda-player-${Math.random()}`);return T.useEffect(()=>{const M=U.current;if(!M||!k)return;const F=M.transferControlToOffscreen();return k.postMessage({action:"register",payload:{id:C.current,canvas:F,type:"single",data:{showBeamEffect:r,beamAlpha:i,fadeAlpha:l,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d,bpm:g,clipDuration:v,progress:x,previewTime:y,fftLevels:E,effectStates:S}}},[F]),()=>{k.postMessage({action:"deregister",payload:{id:C.current}})}},[]),T.useEffect(()=>{if(!k)return;const M=a?[a]:[];k.postMessage({action:"update",payload:{id:C.current,data:{ildaFrames:M,effects:t,showBeamEffect:r,beamAlpha:i,fadeAlpha:l,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d,bpm:g,clipDuration:v,progress:x,previewTime:y,fftLevels:E,effectStates:S}}})},[k,a,t,r,i,l,u,f,h,d,g,v,x,y,E,S]),m.jsxs("div",{className:"ilda-player",children:[m.jsx("h3",{children:"Selected Preview"}),m.jsxs("div",{className:"renderSettingToggle",children:[m.jsx("button",{onClick:w,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),m.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),m.jsx("button",{onClick:D,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),m.jsx("canvas",{ref:U,width:"300",height:"300",style:{backgroundColor:"black"}})]})},xy=ea.memo(by),Sy=({activeFrames:a,showBeamEffect:t,beamAlpha:r,fadeAlpha:i,previewScanRate:l,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:d,previewTime:g=0,fftLevels:v={low:0,mid:0,high:0},onToggleBeamEffect:x,onCycleDisplayMode:y})=>{const E=T.useRef(null),S=rm(),w=T.useRef(`world-preview-${Math.random()}`);return T.useEffect(()=>{const D=E.current;if(!D||!S)return;const U=D.transferControlToOffscreen();return S.postMessage({action:"register",payload:{id:w.current,canvas:U,type:"world",data:{showBeamEffect:t,beamAlpha:r,fadeAlpha:i,previewScanRate:l,beamRenderMode:u,previewTime:g,fftLevels:v}}},[U]),()=>{S.postMessage({action:"deregister",payload:{id:w.current}})}},[]),T.useEffect(()=>{if(!S)return;const D=Object.entries(a).map(([U,{frame:k,effects:C,layerIndex:M,syncSettings:F,bpm:H,clipDuration:fe,progress:de,effectStates:ce}])=>({frames:[k],effects:C,workerId:U,layerIndex:M,syncSettings:F,bpm:H,clipDuration:fe,progress:de,effectStates:ce}));S.postMessage({action:"update",payload:{id:w.current,data:{worldData:D,showBeamEffect:t,beamAlpha:r,fadeAlpha:i,previewScanRate:l,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:d,previewTime:g,fftLevels:v}}})},[S,a,t,r,i,l,u,f,h,d,g,v]),m.jsxs("div",{className:"world-preview",children:[m.jsx("h3",{children:"World Preview"}),m.jsxs("div",{className:"renderSettingToggle",children:[m.jsx("button",{onClick:x,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),m.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),m.jsx("button",{onClick:y,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),m.jsx("canvas",{ref:E,width:"300",height:"300",style:{backgroundColor:"black"}})]})},Ey=({bpm:a,onBpmChange:t})=>{const[r,i]=T.useState([]),[l,u]=T.useState(a);T.useEffect(()=>{u(a)},[a]);const f=()=>{const d=Date.now(),g=[...r,d].slice(-4);if(i(g),g.length>=2){const v=[];for(let E=1;E<g.length;E++)v.push(g[E]-g[E-1]);const x=v.reduce((E,S)=>E+S)/v.length,y=Math.round(6e4/x);t(y)}},h=d=>{const g=parseFloat(d.target.value);u(d.target.value),!isNaN(g)&&g>0&&g<999&&t(g)};return m.jsx("div",{className:"bpm-controls",children:m.jsxs("div",{className:"bpm-display",children:[m.jsx(Ct,{id:"bpm_tap",children:m.jsx("button",{className:"bpm-tap-btn",onClick:f,children:"TAP"})}),m.jsxs("div",{className:"bpm-fine-controls",children:[m.jsx(Ct,{id:"bpm_fine_down",children:m.jsx("button",{className:"bpm-fine-btn",onClick:()=>t(Math.max(1,a-.1)),children:"-"})}),m.jsx(Ct,{id:"bpm_value",children:m.jsx("input",{type:"number",className:"bpm-input",value:l,onChange:h,min:"1",max:"999",step:"0.1"})}),m.jsx(Ct,{id:"bpm_fine_up",children:m.jsx("button",{className:"bpm-fine-btn",onClick:()=>t(Math.min(999,a+.1)),children:"+"})})]}),m.jsx("span",{className:"bpm-label",children:"BPM"})]})})},Ay=({onPlay:a,onPause:t,onStop:r,isPlaying:i,isStopped:l})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"transport",label:h.toUpperCase()}))};return m.jsxs("div",{className:"transport-controls",children:[m.jsx(Ct,{id:"transport_play",children:m.jsx("button",{className:`speed-control-button ${i?"active":""}`,onClick:a,draggable:!0,onDragStart:f=>u(f,"play"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-play-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"})})})}),m.jsx(Ct,{id:"transport_pause",children:m.jsx("button",{className:`speed-control-button ${!i&&!l?"active":""}`,onClick:t,draggable:!0,onDragStart:f=>u(f,"pause"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-pause-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5m5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5"})})})}),m.jsx(Ct,{id:"transport_stop",children:m.jsx("button",{className:`speed-control-button ${l?"active":""}`,onClick:r,draggable:!0,onDragStart:f=>u(f,"stop"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-stop-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"})})})})]})},wy=({value:a,onToggle:t,label:r,onDrop:i,isAssigned:l,...u})=>{const f=d=>{d.preventDefault(),d.dataTransfer.dropEffect="link"},h=d=>{d.preventDefault();try{const g=d.dataTransfer.getData("application/x-truelazer-param");console.log("[QuickButton] Dropped Data Raw:",g);const v=JSON.parse(g);console.log("[QuickButton] Dropped Data Parsed:",v),v&&(v.type==="toggle"||v.type==="checkbox")?i(v):console.warn("[QuickButton] Invalid data type for button:",v?.type)}catch(g){console.error("[QuickButton] Drop Error:",g)}};return m.jsx("div",{className:`quick-assign-button ${a?"active":""} ${l?"":"unassigned"}`,onClick:l?t:void 0,onDragOver:f,onDrop:h,...u,children:m.jsx("div",{className:"button-label",title:r||"Empty",children:r||"Assign"})})},Ty=({assigns:a,onUpdateKnob:t,onToggleButton:r,onAssign:i})=>m.jsxs("div",{className:"global-quick-assigns-panel",children:[m.jsx("div",{className:"quick-assigns-row knobs-row",children:Array.from({length:8}).map((l,u)=>{const f=!!a.knobs[u].link;return m.jsx(Ct,{id:`quick_knob_${u}`,children:m.jsx(Ai,{value:a.knobs[u]?.value||0,label:a.knobs[u]?.label,isAssigned:f,onChange:h=>f&&t(u,h),onDrop:h=>{console.log(`[GlobalQuickAssigns] Knob ${u} Drop Data:`,h),i("knob",u,h)}})},`knob-${u}`)})}),m.jsx("div",{className:"quick-assigns-row buttons-row",children:Array.from({length:8}).map((l,u)=>{const f=!!a.buttons[u].link;return m.jsx(Ct,{id:`quick_btn_${u}`,children:m.jsx(wy,{value:a.buttons[u]?.value||!1,label:a.buttons[u]?.label,isAssigned:f,onToggle:()=>r(u),onDrop:h=>{console.log(`[GlobalQuickAssigns] Button ${u} Drop Data:`,h),i("button",u,h)}})},`btn-${u}`)})})]}),Cy=({enabledShortcuts:a={},onOpenOutputSettings:t,quickAssigns:r,onUpdateKnob:i,onToggleButton:l,onAssign:u})=>{const{midiInitialized:f,midiInputs:h,selectedMidiInputId:d,setSelectedMidiInputId:g,isMapping:v,startMapping:x,stopMapping:y,learningId:E,lastMidiEvent:S,setMappings:w,saveMappings:D,exportMappings:U,importMappings:k}=Jo(),{artnetInitialized:C,isMapping:M,startMapping:F,stopMapping:H,setMappings:fe,saveMappings:de,exportMappings:ce,importMappings:le,lastDmxEvent:Z}=Cf()||{},{isMapping:z,startMapping:Q,stopMapping:$,setMappings:W,saveMappings:B,exportMappings:P,importMappings:V}=Mf()||{},[pe,R]=T.useState([]),[G,ie]=T.useState(""),[ve,te]=T.useState(!1),[ge,Ee]=T.useState(57121),[Ke,ke]=T.useState("127.0.0.1"),[at,$t]=T.useState(57120),[Be,Ue]=T.useState(null);T.useEffect(()=>{const Te=async()=>{if(a.artnet)try{const ut=await window.electronAPI.getArtnetUniverses();R(ut),ut.length>0&&ie(ut[0].id)}catch(ut){console.error("Failed to fetch Art-Net universes:",ut)}},Kt=async()=>{if(a.osc)try{if((await window.electronAPI.initializeOsc({localPort:ge,remoteAddress:Ke,remotePort:at})).success)return te(!0),window.electronAPI.onOscMessageReceived(({oscMessage:gn})=>{Ue(gn)})}catch(ut){console.error("Failed to initialize OSC:",ut)}};let Gt=()=>{};return Te(),Kt().then(ut=>{typeof ut=="function"&&(Gt=ut)}),()=>{typeof Gt=="function"&&Gt()}},[a]);const ye=Te=>g(Te.target.value),ne=()=>v?y():x(),ft=()=>M?H():F(),ht=()=>z?$():Q();return m.jsxs("div",{className:"settings-panel settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Global Settings"})}),r&&m.jsx(mn,{title:"Quick Assigns",children:m.jsx(Ty,{assigns:r,onUpdateKnob:i,onToggleButton:l,onAssign:u})}),m.jsxs(mn,{title:"Channel/DAC Settings",children:[m.jsx("p",{className:"info-text",children:"Output routing and safety zones configuration."}),m.jsx("button",{className:"small-btn",style:{width:"100%",marginTop:"5px"},onClick:t,children:"Open Output Settings"})]}),(a.midi||a.artnet||a.osc||a.keyboard)&&m.jsxs("div",{className:"shortcuts-settings-panel",children:[a.keyboard&&m.jsx(mn,{title:"Keyboard Shortcuts",children:m.jsxs("div",{className:"keyboard-config",children:[m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${z?"active":""}`,onClick:ht,style:{backgroundColor:z?"var(--theme-color)":"",gridColumn:"span 2"},children:z?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:B,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:P,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:V,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>W({}),children:"Clear"})]}),m.jsx("p",{className:"info-text",style:{fontSize:"9px",color:"#666",marginTop:"5px"},children:'Assign keys to buttons/sliders by activating "Start Mapping" and clicking a control.'})]})}),a.midi&&m.jsx(mn,{title:"MIDI Shortcuts",children:f?m.jsxs("div",{className:"midi-config",children:[m.jsx("select",{className:"param-select",value:d,onChange:ye,style:{marginBottom:"8px",width:"100%"},children:h.map(Te=>m.jsx("option",{value:Te.id,children:Te.name},Te.id))}),m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${v?"active":""}`,onClick:ne,style:{backgroundColor:v?"var(--theme-color)":"",gridColumn:"span 2"},children:v?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:D,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:U,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:k,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>w({}),children:"Clear"})]}),S&&m.jsxs("div",{className:"last-event-status",children:[S.type," ",S.note||S.controller," (CH",S.channel,")"]})]}):m.jsx("p",{className:"loading-text",children:"Initializing MIDI..."})}),a.artnet&&m.jsx(mn,{title:"ArtNet Shortcuts",children:C?m.jsxs("div",{className:"artnet-config",children:[m.jsx("select",{className:"param-select",value:G,onChange:Te=>{ie(Te.target.value);const Kt=parseInt(Te.target.value.replace("universe-",""));window.electronAPI&&window.electronAPI.listenArtnetUniverse&&window.electronAPI.listenArtnetUniverse(Kt)},style:{marginBottom:"8px",width:"100%"},children:pe.map(Te=>m.jsx("option",{value:Te.id,children:Te.name},Te.id))}),m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${M?"active":""}`,onClick:ft,style:{backgroundColor:M?"var(--theme-color)":"",gridColumn:"span 2"},children:M?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:de,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:ce,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:le,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>fe({}),children:"Clear"})]}),Z&&m.jsxs("div",{className:"last-event-status",children:["UNIV ",Z.universe," CH ",Z.channel+1," (Val: ",Z.value,")"]})]}):m.jsx("p",{className:"loading-text",children:"Initializing Art-Net..."})}),a.osc&&m.jsx(mn,{title:"OSC Shortcuts",children:m.jsx("div",{className:"osc-config",children:m.jsxs("p",{className:"info-text",children:["Listening on port: ",ge]})})})]})]})},My=({show:a,title:t,initialValue:r,onSave:i,onClose:l})=>{const[u,f]=T.useState(r||"");if(T.useEffect(()=>{a&&f(r||"")},[a,r]),!a)return null;const h=()=>{i(u),l()},d=g=>{g.key==="Enter"&&h(),g.key==="Escape"&&l()};return m.jsx("div",{className:"shortcuts-modal-overlay",style:{pointerEvents:"auto"},children:m.jsxs("div",{className:"shortcuts-modal-content",style:{maxWidth:"400px"},children:[m.jsx("h3",{children:t||"Rename"}),m.jsxs("div",{className:"settings-section",style:{border:"none"},children:[m.jsx("input",{type:"text",value:u,onChange:g=>f(g.target.value),onKeyDown:d,autoFocus:!0,style:{width:"100%",padding:"8px",backgroundColor:"#1a1a1a",color:"white",border:"1px solid var(--theme-color)",borderRadius:"4px",marginBottom:"15px"}}),m.jsxs("div",{className:"button-row",style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[m.jsx("button",{onClick:l,children:"Cancel"}),m.jsx("button",{onClick:h,style:{backgroundColor:"var(--theme-color)",color:"black"},children:"Save"})]})]})]})})},Ny=({safetyZones:a,outputArea:t,testLineY:r,testLineEnabled:i,transformationEnabled:l,transformationMode:u,flipX:f,flipY:h,onUpdateSafetyZones:d,onUpdateOutputArea:g,selectedZoneIndex:v,onSelectZone:x,gridSize:y=20,snapToGrid:E=!1})=>{const S=T.useRef(null),[w,D]=T.useState(null),U=(Z,z,Q)=>{Z.strokeStyle="#333",Z.lineWidth=1,Z.beginPath();for(let $=0;$<=y;$++){const W=$/y,B=W*z,P=W*Q;Z.moveTo(B,0),Z.lineTo(B,Q),Z.moveTo(0,P),Z.lineTo(z,P)}Z.stroke(),Z.strokeStyle="#666",Z.lineWidth=2,Z.beginPath(),Z.moveTo(z/2,0),Z.lineTo(z/2,Q),Z.moveTo(0,Q/2),Z.lineTo(z,Q/2),Z.stroke(),Z.fillStyle="#aaa",Z.font="10px monospace",Z.fillText("0,0",5,12),Z.fillText("1,0",z-25,12),Z.fillText("0,1",5,Q-5),Z.fillText("1,1",z-25,Q-5)},k=(Z,z,Q,$=!1,W=!1)=>{const{x:B,y:P,w:V,h:pe}=z;if(Z.fillStyle=Q,Z.fillRect(B,P,V,pe),Z.strokeStyle=$?"#fff":W?"#0089ff":"#ff0000",Z.lineWidth=$?2:1,Z.strokeRect(B,P,V,pe),$||W){Z.fillStyle="#fff";const G=(te,ge)=>Z.fillRect(te-6/2,ge-6/2,6,6);G(B,P),G(B+V,P),G(B,P+pe),G(B+V,P+pe);const ie=4;Z.fillStyle="#ccc";const ve=(te,ge)=>Z.fillRect(te-ie/2,ge-ie/2,ie,ie);ve(B+V/2,P),ve(B+V/2,P+pe),ve(B,P+pe/2),ve(B+V,P+pe/2)}},C=()=>{const Z=S.current;if(!Z)return;const z=Z.getContext("2d"),{width:Q,height:$}=Z;if(z.clearRect(0,0,Q,$),U(z,Q,$),l&&t&&k(z,{x:t.x*Q,y:t.y*$,w:t.w*Q,h:t.h*$},"rgba(0, 137, 255, 0.2)",!1,!0),a.forEach((W,B)=>{k(z,{x:W.x*Q,y:W.y*$,w:W.w*Q,h:W.h*$},"rgba(255, 0, 0, 0.3)",B===v)}),i){let W=r;h&&(W=1-W);let B=0,P=1;if(l&&t){if(u==="scale")B=t.x,P=t.x+t.w,W=t.y+W*t.h;else if(u==="crop"){if(W<t.y||W>t.y+t.h)return;B=Math.max(0,t.x),P=Math.min(1,t.x+t.w)}}const V=W*$,pe=B*Q,R=P*Q;let G=[[pe,R]];a&&a.length>0&&a.forEach(ie=>{const ve=ie.y*$,te=ie.h*$,ge=ie.x*Q,Ee=ie.w*Q;if(V>=ve&&V<=ve+te){const Ke=[];G.forEach(ke=>{const[at,$t]=ke,Be=ge,Ue=ge+Ee;Ue<=at||Be>=$t?Ke.push(ke):(Be>at&&Ke.push([at,Be]),Ue<$t&&Ke.push([Ue,$t]))}),G=Ke}}),z.strokeStyle="#00ff00",z.lineWidth=2,z.beginPath(),G.forEach(ie=>{z.moveTo(ie[0],V),z.lineTo(ie[1],V)}),z.stroke()}};T.useEffect(()=>{C()},[a,t,r,i,l,v,y,f,h]);const M=Z=>{const z=S.current.getBoundingClientRect();return{x:(Z.clientX-z.left)/z.width,y:(Z.clientY-z.top)/z.height}},F=(Z,z,Q)=>{if(!Q)return null;const $=.03;return Math.abs(Z-Q.x)<$&&Math.abs(z-Q.y)<$?"nw":Math.abs(Z-(Q.x+Q.w))<$&&Math.abs(z-Q.y)<$?"ne":Math.abs(Z-Q.x)<$&&Math.abs(z-(Q.y+Q.h))<$?"sw":Math.abs(Z-(Q.x+Q.w))<$&&Math.abs(z-(Q.y+Q.h))<$?"se":Math.abs(z-Q.y)<$&&Z>=Q.x&&Z<=Q.x+Q.w?"n":Math.abs(z-(Q.y+Q.h))<$&&Z>=Q.x&&Z<=Q.x+Q.w?"s":Math.abs(Z-Q.x)<$&&z>=Q.y&&z<=Q.y+Q.h?"w":Math.abs(Z-(Q.x+Q.w))<$&&z>=Q.y&&z<=Q.y+Q.h?"e":null},H=(Z,z,Q)=>Q?Z>=Q.x&&Z<=Q.x+Q.w&&z>=Q.y&&z<=Q.y+Q.h:!1,fe=Z=>{const{x:z,y:Q}=M(Z);if(v!==null&&a[v]){const $=a[v],W=F(z,Q,$);if(W){D({type:"zone",index:v,handle:W,startX:z,startY:Q,originalRect:{...$}});return}}for(let $=a.length-1;$>=0;$--){const W=a[$];if(W&&H(z,Q,W)){x($);const B=F(z,Q,W);D({type:"zone",index:$,handle:B||"move",startX:z,startY:Q,originalRect:{...W}});return}}if(l&&t){const $=F(z,Q,t);if($){D({type:"output",handle:$,startX:z,startY:Q,originalRect:{...t}}),x(null);return}if(H(z,Q,t)){D({type:"output",handle:"move",startX:z,startY:Q,originalRect:{...t}}),x(null);return}}x(null)},de=Z=>{if(!E)return Z;const z=1/y;return Math.round(Z/z)*z},ce=Z=>{if(!w)return;const{x:z,y:Q}=M(Z),$=z-w.startX,W=Q-w.startY,B=(P,V,pe,R)=>{let G={...P};if(V==="move")G.x=de(P.x+pe),G.y=de(P.y+R);else{if(V.includes("w")){const ie=de(P.x+pe);G.w=P.x+P.w-ie,G.x=ie}if(V.includes("e")){const ie=de(P.x+P.w+pe);G.w=ie-G.x}if(V.includes("n")){const ie=de(P.y+R);G.h=P.y+P.h-ie,G.y=ie}if(V.includes("s")){const ie=de(P.y+P.h+R);G.h=ie-G.y}}return G.w<.01&&(G.w=.01),G.h<.01&&(G.h=.01),G};if(w.type==="zone"){const P=B(w.originalRect,w.handle,$,W);d(w.index,P)}else if(w.type==="output"){const P=B(w.originalRect,w.handle,$,W);g(P)}},le=()=>{D(null)};return m.jsx("div",{className:"output-canvas-container",style:{width:"100%",height:"100%"},children:m.jsx("canvas",{ref:S,width:600,height:600,style:{width:"100%",height:"100%",display:"block"},className:"output-canvas",onMouseDown:fe,onMouseMove:ce,onMouseUp:le,onMouseLeave:le})})},Ry=({show:a,onClose:t,dacs:r=[],dacSettings:i={},onUpdateDacSettings:l})=>{const[u,f]=T.useState(null),[h,d]=T.useState(null),[g,v]=T.useState(20),[x,y]=T.useState(!1),E=T.useMemo(()=>{const C=[];return r.forEach(M=>{M.channels&&M.channels.length>0?M.channels.forEach(F=>{C.push({id:`${M.ip}:${F.serviceID}`,displayName:`${M.hostName||M.unitID||"DAC"} : ${F.name||`CH ${F.serviceID}`}`,ip:M.ip,channel:F.serviceID,dacName:M.hostName||M.unitID})}):C.push({id:`${M.ip}:0`,displayName:M.hostName||M.unitID||`DAC ${M.ip}`,ip:M.ip,channel:0,dacName:M.hostName||M.unitID})}),C},[r]);if(T.useEffect(()=>{E.length>0&&!u&&f(E[0].id)},[E,u]),!a)return null;const S=i[u]||{safetyZones:[],outputArea:{x:.1,y:.1,w:.8,h:.8},transformationEnabled:!1,transformationMode:"crop",testLineEnabled:!1,testLineY:.5,flipX:!1,flipY:!1},w=C=>{u&&l(u,{...S,...C})},D=()=>{const C={x:.4,y:.4,w:.2,h:.2};w({safetyZones:[...S.safetyZones,C]}),d(S.safetyZones.length)},U=()=>{w({safetyZones:[]}),d(null)},k=(C,M)=>{const F=[...S.safetyZones];F[C]=M,w({safetyZones:F})};return m.jsx("div",{className:"output-settings-modal-overlay",children:m.jsxs("div",{className:"output-settings-modal-content",children:[m.jsxs("div",{className:"output-settings-header",children:[m.jsx("h2",{children:"Output Settings"}),m.jsx("button",{className:"close-btn",onClick:t,children:"Close"})]}),m.jsxs("div",{className:"output-settings-body",children:[m.jsx("div",{className:"output-settings-col",children:m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Available Outputs"}),m.jsxs("ul",{className:"dac-list",children:[E.length===0?m.jsx("li",{style:{color:"#666",fontStyle:"italic"},children:"No Outputs detected"}):null,E.map((C,M)=>m.jsxs("li",{className:`dac-list-item ${u===C.id?"selected":""}`,onClick:()=>f(C.id),children:[m.jsx("span",{style:{fontWeight:"bold",fontSize:"0.9em"},children:C.displayName}),m.jsx("span",{style:{fontSize:"0.7em",color:"#888"},children:C.ip})]},C.id))]})]})}),m.jsxs("div",{className:"output-settings-col canvas-col",children:[m.jsxs("div",{className:"canvas-toolbar",children:[m.jsx("button",{className:"tool-btn",onClick:D,title:"Add Safety Zone",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-plus-square",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),m.jsx("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})]})}),m.jsx("button",{className:`tool-btn ${S.transformationEnabled?"active":""}`,onClick:()=>w({transformationEnabled:!S.transformationEnabled}),title:"Toggle Output Transformation",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-border-outer",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M7.5 1.906v.938h1v-.938zm0 1.875v.938h1V3.78h-1zm0 1.875v.938h1v-.938zM1.906 8.5h.938v-1h-.938zm1.875 0h.938v-1H3.78v1zm1.875 0h.938v-1h-.938zm2.813 0v-.031H8.5V7.53h-.031V7.5H7.53v.031H7.5v.938h.031V8.5zm.937 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zM7.5 9.406v.938h1v-.938zm0 1.875v.938h1v-.938zm0 1.875v.938h1v-.938z"}),m.jsx("path",{d:"M0 0v16h16V0zm1 1h14v14H1z"})]})}),m.jsx("button",{className:`tool-btn ${S.testLineEnabled?"active":""}`,onClick:()=>w({testLineEnabled:!S.testLineEnabled}),title:"Toggle Test Line",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),m.jsx("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})]})}),m.jsx("span",{style:{width:1,background:"#555",margin:"0 5px"}}),m.jsx("button",{className:`tool-btn ${x?"active":""}`,onClick:()=>y(!x),title:"Snap to Grid",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-magnet-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M15 12h-4v3h4zM5 12H1v3h4zM0 8a8 8 0 1 1 16 0v8h-6V8a2 2 0 1 0-4 0v8H0z"})})}),m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginLeft:5},children:[m.jsx("span",{style:{fontSize:10,color:"#aaa"},children:"Grid:"}),m.jsx("input",{type:"number",min:"5",max:"100",value:g,onChange:C=>v(parseInt(C.target.value)),className:"param-number-input",style:{width:40}})]})]}),m.jsx(Ny,{safetyZones:S.safetyZones,outputArea:S.outputArea,testLineY:S.testLineY,testLineEnabled:S.testLineEnabled,transformationEnabled:S.transformationEnabled,transformationMode:S.transformationMode,flipX:S.flipX,flipY:S.flipY,onUpdateSafetyZones:k,onUpdateOutputArea:C=>w({outputArea:C}),selectedZoneIndex:h,onSelectZone:d,gridSize:g,snapToGrid:x})]}),m.jsx("div",{className:"output-settings-col",children:u?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Output Transformation"}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Enable Editing"}),m.jsx("input",{type:"checkbox",checked:S.transformationEnabled,onChange:C=>w({transformationEnabled:C.target.checked})})]}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Flip X"}),m.jsx("input",{type:"checkbox",checked:S.flipX||!1,onChange:C=>w({flipX:C.target.checked})})]}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Flip Y"}),m.jsx("input",{type:"checkbox",checked:S.flipY||!1,onChange:C=>w({flipY:C.target.checked})})]}),S.transformationEnabled&&m.jsxs("div",{className:"control-row",children:[m.jsx("label",{style:{flex:1},children:"Mode"}),m.jsxs("select",{className:"param-select",value:S.transformationMode,onChange:C=>w({transformationMode:C.target.value}),children:[m.jsx("option",{value:"crop",children:"Crop"}),m.jsx("option",{value:"scale",children:"Scale"})]})]})]}),m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Safety Zones"}),m.jsxs("div",{className:"control-row",style:{justifyContent:"space-between",marginBottom:5},children:[m.jsx("button",{className:"small-btn",onClick:D,children:"Add New"}),m.jsx("button",{className:"small-btn clear",onClick:U,children:"Clear All"})]}),m.jsx("div",{className:"zone-list",children:S.safetyZones.map((C,M)=>m.jsxs("div",{className:`zone-item ${h===M?"selected":""}`,onClick:()=>d(M),children:[m.jsxs("span",{children:["Zone ",M+1]}),m.jsx("button",{className:"delete-zone-btn",onClick:F=>{F.stopPropagation(),h===M&&d(null);const H=S.safetyZones.filter((fe,de)=>de!==M);w({safetyZones:H})},children:""})]},M))}),h!==null&&m.jsxs("div",{style:{marginTop:10,borderTop:"1px solid #333",paddingTop:5},children:[m.jsx("label",{children:"Selected Zone Properties"}),m.jsx("div",{style:{fontSize:"0.8em",color:"#aaa"},children:"Select and drag zone on canvas to resize."})]})]}),m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Test Output"}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Enable Test Line"}),m.jsx("input",{type:"checkbox",checked:S.testLineEnabled,onChange:C=>w({testLineEnabled:C.target.checked})})]}),S.testLineEnabled&&m.jsxs("div",{className:"control-row",children:[m.jsx("label",{children:"Y Position"}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:S.testLineY,onChange:C=>w({testLineY:parseFloat(C.target.value)}),className:"param-slider"})]})]})]}):m.jsx("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"Select an Output to configure settings"})})]})]})})},im=()=>{const a=Sl();return a||{}},Dy=({show:a,onClose:t,initialTab:r="output"})=>{const i=Sl(),{fftSettings:l,setFftSettings:u}=i||{},{devices:f,selectedDeviceId:h,setSelectedDeviceId:d,globalVolume:g,setVolume:v}=im(),[x,y]=T.useState(r);if(ea.useEffect(()=>{a&&y(r)},[a,r]),!a)return null;if(!l)return m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content",style:{padding:"20px",color:"red",border:"1px solid red",background:"#222"},children:[m.jsx("h3",{children:"Error"}),m.jsx("p",{children:"Audio Context is not available."}),m.jsx("p",{children:"Please restart the application or report this bug."}),m.jsx("button",{onClick:t,style:{marginTop:"10px",padding:"5px 10px"},children:"Close"})]}),m.jsx("style",{children:`
                    .modal-overlay {
                        position: fixed;
                        top: 0; left: 0; right: 0; bottom: 0;
                        background: rgba(0, 0, 0, 0.7);
                        display: flex; justify-content: center; align-items: center;
                        z-index: 10000;
                    }
                `})]});const E=(S,w,D)=>{const U={...l},k=`${S}Range`;U[k][w]=parseFloat(D),u(U)};return m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content audio-settings-window",style:{minWidth:"400px"},children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:"Audio Settings"}),m.jsx("button",{className:"close-btn",onClick:t,children:""})]}),m.jsxs("div",{className:"tab-header",style:{display:"flex",gap:"10px",marginBottom:"15px",borderBottom:"1px solid #444"},children:[m.jsx("button",{className:`tab-btn ${x==="output"?"active":""}`,onClick:()=>y("output"),style:{padding:"8px 15px",background:"none",border:"none",color:x==="output"?"var(--theme-color)":"#888",borderBottom:x==="output"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"Audio Output"}),m.jsx("button",{className:`tab-btn ${x==="fft"?"active":""}`,onClick:()=>y("fft"),style:{padding:"8px 15px",background:"none",border:"none",color:x==="fft"?"var(--theme-color)":"#888",borderBottom:x==="fft"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"FFT Settings"})]}),m.jsxs("div",{className:"modal-body",children:[x==="output"&&m.jsxs("div",{className:"audio-output-settings",children:[m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Device"}),m.jsx("select",{className:"param-select",value:h,onChange:S=>d(S.target.value),style:{width:"100%",padding:"5px"},children:f.map(S=>m.jsx("option",{value:S.deviceId,children:S.label||`Device ${S.deviceId.slice(0,5)}`},S.deviceId))})]}),m.jsxs("div",{className:"settings-row",style:{textAlign:"center"},children:[m.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Volume"}),m.jsx("div",{style:{display:"flex",justifyContent:"center"},children:m.jsx(Ai,{value:g,onChange:v,label:"MASTER",isAssigned:!0,size:60})})]})]}),x==="fft"&&m.jsxs("div",{className:"fft-settings",children:[m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Source"}),m.jsxs("select",{className:"param-select",value:l.source,onChange:S=>u({...l,source:S.target.value}),style:{width:"100%",padding:"5px"},children:[m.jsx("option",{value:"external",children:"External (Microphone/Loopback)"}),m.jsx("option",{value:"clip",children:"Clip FFT (Audio from active clips)"})]})]}),m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Calculation Mode"}),m.jsxs("select",{className:"param-select",value:l.calculationMode||"average",onChange:S=>u({...l,calculationMode:S.target.value}),style:{width:"100%",padding:"5px"},children:[m.jsx("option",{value:"average",children:"Average (Smooth)"}),m.jsx("option",{value:"peak",children:"Peak (Transient/Punchy)"})]})]}),m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Ranges (Hz)"}),m.jsxs("div",{className:"range-controls",style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"10px",alignItems:"center"},children:[m.jsx("span",{children:"Low:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:l.lowRange[0],onChange:S=>E("low",0,S.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:l.lowRange[1],onChange:S=>E("low",1,S.target.value),style:{width:"60px"}})]}),m.jsx("span",{children:"Mid:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:l.midRange[0],onChange:S=>E("mid",0,S.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:l.midRange[1],onChange:S=>E("mid",1,S.target.value),style:{width:"60px"}})]}),m.jsx("span",{children:"High:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:l.highRange[0],onChange:S=>E("high",0,S.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:l.highRange[1],onChange:S=>E("high",1,S.target.value),style:{width:"60px"}})]})]})]}),m.jsxs("div",{className:"settings-row",style:{display:"flex",justifyContent:"space-around",textAlign:"center"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"GAIN"}),m.jsx(Ai,{value:l.gain/5,onChange:S=>u({...l,gain:S*5}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"SMOOTH"}),m.jsx(Ai,{value:l.smoothingTimeConstant||.8,onChange:S=>u({...l,smoothingTimeConstant:S}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"HOLD"}),m.jsx(Ai,{value:l.holdTime/1e3,onChange:S=>u({...l,holdTime:S*1e3}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"FALL"}),m.jsx(Ai,{value:l.fallTime/2e3,onChange:S=>u({...l,fallTime:S*2e3}),isAssigned:!0,size:40})]})]})]})]})]}),m.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .param-select, input {
                    background: #111;
                    border: 1px solid #444;
                    color: white;
                    border-radius: 4px;
                }
            `})]})},_y=({missingFiles:a,onRelocate:t,onClose:r})=>!a||a.length===0?null:m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content",style:{width:"500px",maxHeight:"80vh",display:"flex",flexDirection:"column"},children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:"Missing Files"}),m.jsx("button",{className:"close-btn",onClick:r,children:""})]}),m.jsxs("div",{className:"modal-body",style:{overflowY:"auto",flex:1},children:[m.jsx("p",{style:{marginBottom:"15px",color:"#ccc",fontSize:"0.9em"},children:"The following files could not be found. Please locate one of them to update the path for all matching files in the same directory."}),m.jsx("ul",{style:{listStyle:"none",padding:0},children:a.map((i,l)=>m.jsxs("li",{style:{background:"#333",padding:"10px",marginBottom:"5px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{overflow:"hidden"},children:[m.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9em"},children:i.fileName}),m.jsx("div",{style:{fontSize:"0.8em",color:"#888",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"350px"},children:i.filePath})]}),m.jsx("button",{className:"small-btn",onClick:()=>t(i),style:{marginLeft:"10px",whiteSpace:"nowrap"},children:"Locate"})]},l))})]})]}),m.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex; justify-content: center; align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .small-btn {
                    background: var(--theme-color);
                    color: black;
                    border: none;
                    padding: 5px 10px;
                    border-radius: 3px;
                    cursor: pointer;
                    font-weight: bold;
                }
                .small-btn:hover {
                    opacity: 0.9;
                }
            `})]});class Oy extends ea.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?m.jsx("h1",{children:"Something went wrong."}):this.props.children}}const sm=T.createContext(null),ky=()=>T.useContext(sm),Ly=({children:a})=>{const[t,r]=T.useState(null);return T.useEffect(()=>{if(!t){const i=new Worker(new URL(""+new URL("ilda-parser.worker-Don4LfHc.js",import.meta.url).href,import.meta.url));r(i)}return()=>{t&&t.terminate()}},[t]),m.jsx(sm.Provider,{value:t,children:a})},lm=T.createContext(null),Uy=({children:a})=>{const t=T.useMemo(()=>{try{const r=new Worker(new URL(""+new URL("generators.worker-EkgwJKrR.js",import.meta.url).href,import.meta.url),{type:"module"});return r.onerror=i=>{console.error("Generator Worker instantiation or internal error:",i)},r}catch(r){return console.error("Failed to create Generator Worker:",r),null}},[]);return T.useEffect(()=>{if(t)return()=>{t.terminate()}},[t]),m.jsx(lm.Provider,{value:t,children:a})},Iy=()=>{const a=T.useContext(lm);if(a===void 0)throw new Error("useGeneratorWorker must be used within a GeneratorWorkerProvider");return a};var By=X0();const Fy=wf(By),jy=()=>{const{isMapping:a,mappings:t,learningId:r}=Jo(),{isMapping:i,mappings:l,learningId:u}=Cf()||{},{isMapping:f,mappings:h,learningId:d}=Mf()||{},g=a||i||f,[v,x]=T.useState([]),y=T.useCallback(()=>{if(!g)return;const E=document.querySelectorAll("[data-mappable-id]"),S=Array.from(E).map(w=>{const D=w.getBoundingClientRect();return{id:w.getAttribute("data-mappable-id"),rect:{top:D.top,left:D.left,width:D.width,height:D.height}}});x(S)},[g]);return T.useEffect(()=>{if(g){y(),window.addEventListener("resize",y);const E=setTimeout(y,100);return()=>{window.removeEventListener("resize",y),clearTimeout(E)}}else x([])},[g,y]),g?Fy.createPortal(m.jsx("div",{className:"midi-mapping-global-overlay-container",children:v.map(E=>{const S=t[E.id],w=l?l[E.id]:null,D=h?h[E.id]:null,U=a&&r===E.id||i&&u===E.id||f&&d===E.id;let k=null;return a?k=S?S.label:null:i?k=w?w.label:null:f&&(k=D?D.label:null),m.jsx("div",{className:`midi-mapping-label-box ${U?"learning":""} ${k?"mapped":""} ${i?"artnet-mapping":""} ${f?"keyboard-mapping":""}`,style:{position:"fixed",top:E.rect.top,left:E.rect.left,width:E.rect.width,height:E.rect.height,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:m.jsx("div",{className:"mapping-label",children:k||"+"})},E.id)})}),document.body):null};String.prototype.codePointAt||(function(){var a=(function(){try{var r={},i=Object.defineProperty,l=i(r,r,r)&&i}catch{}return l})(),t=function(r){if(this==null)throw TypeError();var i=String(this),l=i.length,u=r?Number(r):0;if(u!=u&&(u=0),!(u<0||u>=l)){var f=i.charCodeAt(u),h;return f>=55296&&f<=56319&&l>u+1&&(h=i.charCodeAt(u+1),h>=56320&&h<=57343)?(f-55296)*1024+h-56320+65536:f}};a?a(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t})();function om(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var Py=new om,Gy=new om,um=new Uint8Array(30),cm=new Uint16Array(30),zy=new Uint8Array(30),Hy=new Uint16Array(30);function fm(a,t,r,i){var l,u;for(l=0;l<r;++l)a[l]=0;for(l=0;l<30-r;++l)a[l+r]=l/r|0;for(u=i,l=0;l<30;++l)t[l]=u,u+=1<<a[l]}function Yy(a,t){var r;for(r=0;r<7;++r)a.table[r]=0;for(a.table[7]=24,a.table[8]=152,a.table[9]=112,r=0;r<24;++r)a.trans[r]=256+r;for(r=0;r<144;++r)a.trans[24+r]=r;for(r=0;r<8;++r)a.trans[168+r]=280+r;for(r=0;r<112;++r)a.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}Yy(Py,Gy);fm(um,cm,4,3);fm(zy,Hy,2,1);um[28]=0;cm[28]=258;function ls(a,t,r,i,l){return Math.pow(1-l,3)*a+3*Math.pow(1-l,2)*l*t+3*(1-l)*Math.pow(l,2)*r+Math.pow(l,3)*i}function $r(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}$r.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};$r.prototype.addPoint=function(a,t){typeof a=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),typeof t=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))};$r.prototype.addX=function(a){this.addPoint(a,null)};$r.prototype.addY=function(a){this.addPoint(null,a)};$r.prototype.addBezier=function(a,t,r,i,l,u,f,h){var d=[a,t],g=[r,i],v=[l,u],x=[f,h];this.addPoint(a,t),this.addPoint(f,h);for(var y=0;y<=1;y++){var E=6*d[y]-12*g[y]+6*v[y],S=-3*d[y]+9*g[y]-9*v[y]+3*x[y],w=3*g[y]-3*d[y];if(S===0){if(E===0)continue;var D=-w/E;0<D&&D<1&&(y===0&&this.addX(ls(d[y],g[y],v[y],x[y],D)),y===1&&this.addY(ls(d[y],g[y],v[y],x[y],D)));continue}var U=Math.pow(E,2)-4*w*S;if(!(U<0)){var k=(-E+Math.sqrt(U))/(2*S);0<k&&k<1&&(y===0&&this.addX(ls(d[y],g[y],v[y],x[y],k)),y===1&&this.addY(ls(d[y],g[y],v[y],x[y],k)));var C=(-E-Math.sqrt(U))/(2*S);0<C&&C<1&&(y===0&&this.addX(ls(d[y],g[y],v[y],x[y],C)),y===1&&this.addY(ls(d[y],g[y],v[y],x[y],C)))}}};$r.prototype.addQuad=function(a,t,r,i,l,u){var f=a+.6666666666666666*(r-a),h=t+2/3*(i-t),d=f+1/3*(l-a),g=h+1/3*(u-t);this.addBezier(a,t,f,h,d,g,l,u)};function Qt(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}Qt.prototype.moveTo=function(a,t){this.commands.push({type:"M",x:a,y:t})};Qt.prototype.lineTo=function(a,t){this.commands.push({type:"L",x:a,y:t})};Qt.prototype.curveTo=Qt.prototype.bezierCurveTo=function(a,t,r,i,l,u){this.commands.push({type:"C",x1:a,y1:t,x2:r,y2:i,x:l,y:u})};Qt.prototype.quadTo=Qt.prototype.quadraticCurveTo=function(a,t,r,i){this.commands.push({type:"Q",x1:a,y1:t,x:r,y:i})};Qt.prototype.close=Qt.prototype.closePath=function(){this.commands.push({type:"Z"})};Qt.prototype.extend=function(a){if(a.commands)a=a.commands;else if(a instanceof $r){var t=a;this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),this.close();return}Array.prototype.push.apply(this.commands,a)};Qt.prototype.getBoundingBox=function(){for(var a=new $r,t=0,r=0,i=0,l=0,u=0;u<this.commands.length;u++){var f=this.commands[u];switch(f.type){case"M":a.addPoint(f.x,f.y),t=i=f.x,r=l=f.y;break;case"L":a.addPoint(f.x,f.y),i=f.x,l=f.y;break;case"Q":a.addQuad(i,l,f.x1,f.y1,f.x,f.y),i=f.x,l=f.y;break;case"C":a.addBezier(i,l,f.x1,f.y1,f.x2,f.y2,f.x,f.y),i=f.x,l=f.y;break;case"Z":i=t,l=r;break;default:throw new Error("Unexpected path command "+f.type)}}return a.isEmpty()&&a.addPoint(0,0),a};Qt.prototype.draw=function(a){a.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];r.type==="M"?a.moveTo(r.x,r.y):r.type==="L"?a.lineTo(r.x,r.y):r.type==="C"?a.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):r.type==="Q"?a.quadraticCurveTo(r.x1,r.y1,r.x,r.y):r.type==="Z"&&a.closePath()}this.fill&&(a.fillStyle=this.fill,a.fill()),this.stroke&&(a.strokeStyle=this.stroke,a.lineWidth=this.strokeWidth,a.stroke())};Qt.prototype.toPathData=function(a){a=a!==void 0?a:2;function t(f){return Math.round(f)===f?""+Math.round(f):f.toFixed(a)}function r(){for(var f=arguments,h="",d=0;d<arguments.length;d+=1){var g=f[d];g>=0&&d>0&&(h+=" "),h+=t(g)}return h}for(var i="",l=0;l<this.commands.length;l+=1){var u=this.commands[l];u.type==="M"?i+="M"+r(u.x,u.y):u.type==="L"?i+="L"+r(u.x,u.y):u.type==="C"?i+="C"+r(u.x1,u.y1,u.x2,u.y2,u.x,u.y):u.type==="Q"?i+="Q"+r(u.x1,u.y1,u.x,u.y):u.type==="Z"&&(i+="Z")}return i};Qt.prototype.toSVG=function(a){var t='<path d="';return t+=this.toPathData(a),t+='"',this.fill&&this.fill!=="black"&&(this.fill===null?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>",t};Qt.prototype.toDOMElement=function(a){var t=this.toPathData(a),r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",t),r};function dm(a){throw new Error(a)}function u0(a,t){a||dm(t)}var Qe={fail:dm,argument:u0,assert:u0},c0=32768,f0=2147483648,cs={},we={},qe={};function Sa(a){return function(){return a}}we.BYTE=function(a){return Qe.argument(a>=0&&a<=255,"Byte value should be between 0 and 255."),[a]};qe.BYTE=Sa(1);we.CHAR=function(a){return[a.charCodeAt(0)]};qe.CHAR=Sa(1);we.CHARARRAY=function(a){typeof a>"u"&&(a="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],r=0;r<a.length;r+=1)t[r]=a.charCodeAt(r);return t};qe.CHARARRAY=function(a){return typeof a>"u"?0:a.length};we.USHORT=function(a){return[a>>8&255,a&255]};qe.USHORT=Sa(2);we.SHORT=function(a){return a>=c0&&(a=-(2*c0-a)),[a>>8&255,a&255]};qe.SHORT=Sa(2);we.UINT24=function(a){return[a>>16&255,a>>8&255,a&255]};qe.UINT24=Sa(3);we.ULONG=function(a){return[a>>24&255,a>>16&255,a>>8&255,a&255]};qe.ULONG=Sa(4);we.LONG=function(a){return a>=f0&&(a=-(2*f0-a)),[a>>24&255,a>>16&255,a>>8&255,a&255]};qe.LONG=Sa(4);we.FIXED=we.ULONG;qe.FIXED=qe.ULONG;we.FWORD=we.SHORT;qe.FWORD=qe.SHORT;we.UFWORD=we.USHORT;qe.UFWORD=qe.USHORT;we.LONGDATETIME=function(a){return[0,0,0,0,a>>24&255,a>>16&255,a>>8&255,a&255]};qe.LONGDATETIME=Sa(8);we.TAG=function(a){return Qe.argument(a.length===4,"Tag should be exactly 4 ASCII characters."),[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]};qe.TAG=Sa(4);we.Card8=we.BYTE;qe.Card8=qe.BYTE;we.Card16=we.USHORT;qe.Card16=qe.USHORT;we.OffSize=we.BYTE;qe.OffSize=qe.BYTE;we.SID=we.USHORT;qe.SID=qe.USHORT;we.NUMBER=function(a){return a>=-107&&a<=107?[a+139]:a>=108&&a<=1131?(a=a-108,[(a>>8)+247,a&255]):a>=-1131&&a<=-108?(a=-a-108,[(a>>8)+251,a&255]):a>=-32768&&a<=32767?we.NUMBER16(a):we.NUMBER32(a)};qe.NUMBER=function(a){return we.NUMBER(a).length};we.NUMBER16=function(a){return[28,a>>8&255,a&255]};qe.NUMBER16=Sa(3);we.NUMBER32=function(a){return[29,a>>24&255,a>>16&255,a>>8&255,a&255]};qe.NUMBER32=Sa(5);we.REAL=function(a){var t=a.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(r){var i=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));t=(Math.round(a*i)/i).toString()}for(var l="",u=0,f=t.length;u<f;u+=1){var h=t[u];h==="e"?l+=t[++u]==="-"?"c":"b":h==="."?l+="a":h==="-"?l+="e":l+=h}l+=l.length&1?"f":"ff";for(var d=[30],g=0,v=l.length;g<v;g+=2)d.push(parseInt(l.substr(g,2),16));return d};qe.REAL=function(a){return we.REAL(a).length};we.NAME=we.CHARARRAY;qe.NAME=qe.CHARARRAY;we.STRING=we.CHARARRAY;qe.STRING=qe.CHARARRAY;cs.UTF8=function(a,t,r){for(var i=[],l=r,u=0;u<l;u++,t+=1)i[u]=a.getUint8(t);return String.fromCharCode.apply(null,i)};cs.UTF16=function(a,t,r){for(var i=[],l=r/2,u=0;u<l;u++,t+=2)i[u]=a.getUint16(t);return String.fromCharCode.apply(null,i)};we.UTF16=function(a){for(var t=[],r=0;r<a.length;r+=1){var i=a.charCodeAt(r);t[t.length]=i>>8&255,t[t.length]=i&255}return t};qe.UTF16=function(a){return a.length*2};var vf={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};cs.MACSTRING=function(a,t,r,i){var l=vf[i];if(l!==void 0){for(var u="",f=0;f<r;f++){var h=a.getUint8(t+f);h<=127?u+=String.fromCharCode(h):u+=l[h&127]}return u}};var Bo=typeof WeakMap=="function"&&new WeakMap,Fo,qy=function(a){if(!Fo){Fo={};for(var t in vf)Fo[t]=new String(t)}var r=Fo[a];if(r!==void 0){if(Bo){var i=Bo.get(r);if(i!==void 0)return i}var l=vf[a];if(l!==void 0){for(var u={},f=0;f<l.length;f++)u[l.charCodeAt(f)]=f+128;return Bo&&Bo.set(r,u),u}}};we.MACSTRING=function(a,t){var r=qy(t);if(r!==void 0){for(var i=[],l=0;l<a.length;l++){var u=a.charCodeAt(l);if(u>=128&&(u=r[u],u===void 0))return;i[l]=u}return i}};qe.MACSTRING=function(a,t){var r=we.MACSTRING(a,t);return r!==void 0?r.length:0};function yf(a){return a>=-128&&a<=127}function Vy(a,t,r){for(var i=0,l=a.length;t<l&&i<64&&a[t]===0;)++t,++i;return r.push(128|i-1),t}function Xy(a,t,r){for(var i=0,l=a.length,u=t;u<l&&i<64;){var f=a[u];if(!yf(f)||f===0&&u+1<l&&a[u+1]===0)break;++u,++i}r.push(i-1);for(var h=t;h<u;++h)r.push(a[h]+256&255);return u}function Zy(a,t,r){for(var i=0,l=a.length,u=t;u<l&&i<64;){var f=a[u];if(f===0||yf(f)&&u+1<l&&yf(a[u+1]))break;++u,++i}r.push(64|i-1);for(var h=t;h<u;++h){var d=a[h];r.push(d+65536>>8&255,d+256&255)}return u}we.VARDELTAS=function(a){for(var t=0,r=[];t<a.length;){var i=a[t];i===0?t=Vy(a,t,r):i>=-128&&i<=127?t=Xy(a,t,r):t=Zy(a,t,r)}return r};we.INDEX=function(a){for(var t=1,r=[t],i=[],l=0;l<a.length;l+=1){var u=we.OBJECT(a[l]);Array.prototype.push.apply(i,u),t+=u.length,r.push(t)}if(i.length===0)return[0,0];for(var f=[],h=1+Math.floor(Math.log(t)/Math.log(2))/8|0,d=[void 0,we.BYTE,we.USHORT,we.UINT24,we.ULONG][h],g=0;g<r.length;g+=1){var v=d(r[g]);Array.prototype.push.apply(f,v)}return Array.prototype.concat(we.Card16(a.length),we.OffSize(h),f,i)};qe.INDEX=function(a){return we.INDEX(a).length};we.DICT=function(a){for(var t=[],r=Object.keys(a),i=r.length,l=0;l<i;l+=1){var u=parseInt(r[l],0),f=a[u];t=t.concat(we.OPERAND(f.value,f.type)),t=t.concat(we.OPERATOR(u))}return t};qe.DICT=function(a){return we.DICT(a).length};we.OPERATOR=function(a){return a<1200?[a]:[12,a-1200]};we.OPERAND=function(a,t){var r=[];if(Array.isArray(t))for(var i=0;i<t.length;i+=1)Qe.argument(a.length===t.length,"Not enough arguments given for type"+t),r=r.concat(we.OPERAND(a[i],t[i]));else if(t==="SID")r=r.concat(we.NUMBER(a));else if(t==="offset")r=r.concat(we.NUMBER32(a));else if(t==="number")r=r.concat(we.NUMBER(a));else if(t==="real")r=r.concat(we.REAL(a));else throw new Error("Unknown operand type "+t);return r};we.OP=we.BYTE;qe.OP=qe.BYTE;var jo=typeof WeakMap=="function"&&new WeakMap;we.CHARSTRING=function(a){if(jo){var t=jo.get(a);if(t!==void 0)return t}for(var r=[],i=a.length,l=0;l<i;l+=1){var u=a[l];r=r.concat(we[u.type](u.value))}return jo&&jo.set(a,r),r};qe.CHARSTRING=function(a){return we.CHARSTRING(a).length};we.OBJECT=function(a){var t=we[a.type];return Qe.argument(t!==void 0,"No encoding function for type "+a.type),t(a.value)};qe.OBJECT=function(a){var t=qe[a.type];return Qe.argument(t!==void 0,"No sizeOf function for type "+a.type),t(a.value)};we.TABLE=function(a){for(var t=[],r=a.fields.length,i=[],l=[],u=0;u<r;u+=1){var f=a.fields[u],h=we[f.type];Qe.argument(h!==void 0,"No encoding function for field type "+f.type+" ("+f.name+")");var d=a[f.name];d===void 0&&(d=f.value);var g=h(d);f.type==="TABLE"?(l.push(t.length),t=t.concat([0,0]),i.push(g)):t=t.concat(g)}for(var v=0;v<i.length;v+=1){var x=l[v],y=t.length;Qe.argument(y<65536,"Table "+a.tableName+" too big."),t[x]=y>>8,t[x+1]=y&255,t=t.concat(i[v])}return t};qe.TABLE=function(a){for(var t=0,r=a.fields.length,i=0;i<r;i+=1){var l=a.fields[i],u=qe[l.type];Qe.argument(u!==void 0,"No sizeOf function for field type "+l.type+" ("+l.name+")");var f=a[l.name];f===void 0&&(f=l.value),t+=u(f),l.type==="TABLE"&&(t+=2)}return t};we.RECORD=we.TABLE;qe.RECORD=qe.TABLE;we.LITERAL=function(a){return a};qe.LITERAL=function(a){return a.length};function an(a,t,r){if(t.length&&(t[0].name!=="coverageFormat"||t[0].value===1))for(var i=0;i<t.length;i+=1){var l=t[i];this[l.name]=l.value}if(this.tableName=a,this.fields=t,r)for(var u=Object.keys(r),f=0;f<u.length;f+=1){var h=u[f],d=r[h];this[h]!==void 0&&(this[h]=d)}}an.prototype.encode=function(){return we.TABLE(this)};an.prototype.sizeOf=function(){return qe.TABLE(this)};function yl(a,t,r){r===void 0&&(r=t.length);var i=new Array(t.length+1);i[0]={name:a+"Count",type:"USHORT",value:r};for(var l=0;l<t.length;l++)i[l+1]={name:a+l,type:"USHORT",value:t[l]};return i}function bf(a,t,r){var i=t.length,l=new Array(i+1);l[0]={name:a+"Count",type:"USHORT",value:i};for(var u=0;u<i;u++)l[u+1]={name:a+u,type:"TABLE",value:r(t[u],u)};return l}function bl(a,t,r){var i=t.length,l=[];l[0]={name:a+"Count",type:"USHORT",value:i};for(var u=0;u<i;u++)l=l.concat(r(t[u],u));return l}function Vo(a){a.format===1?an.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(yl("glyph",a.glyphs))):a.format===2?an.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(bl("rangeRecord",a.ranges,function(t){return[{name:"startGlyphID",type:"USHORT",value:t.start},{name:"endGlyphID",type:"USHORT",value:t.end},{name:"startCoverageIndex",type:"USHORT",value:t.index}]}))):Qe.assert(!1,"Coverage format must be 1 or 2.")}Vo.prototype=Object.create(an.prototype);Vo.prototype.constructor=Vo;function Xo(a){an.call(this,"scriptListTable",bl("scriptRecord",a,function(t,r){var i=t.script,l=i.defaultLangSys;return Qe.assert(!!l,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+r,type:"TAG",value:t.tag},{name:"script"+r,type:"TABLE",value:new an("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new an("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:l.reqFeatureIndex}].concat(yl("featureIndex",l.featureIndexes)))}].concat(bl("langSys",i.langSysRecords,function(u,f){var h=u.langSys;return[{name:"langSysTag"+f,type:"TAG",value:u.tag},{name:"langSys"+f,type:"TABLE",value:new an("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:h.reqFeatureIndex}].concat(yl("featureIndex",h.featureIndexes)))}]})))}]}))}Xo.prototype=Object.create(an.prototype);Xo.prototype.constructor=Xo;function Zo(a){an.call(this,"featureListTable",bl("featureRecord",a,function(t,r){var i=t.feature;return[{name:"featureTag"+r,type:"TAG",value:t.tag},{name:"feature"+r,type:"TABLE",value:new an("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(yl("lookupListIndex",i.lookupListIndexes)))}]}))}Zo.prototype=Object.create(an.prototype);Zo.prototype.constructor=Zo;function Qo(a,t){an.call(this,"lookupListTable",bf("lookup",a,function(r){var i=t[r.lookupType];return Qe.assert(!!i,"Unable to write GSUB lookup type "+r.lookupType+" tables."),new an("lookupTable",[{name:"lookupType",type:"USHORT",value:r.lookupType},{name:"lookupFlag",type:"USHORT",value:r.lookupFlag}].concat(bf("subtable",r.subtables,i)))}))}Qo.prototype=Object.create(an.prototype);Qo.prototype.constructor=Qo;var Oe={Table:an,Record:an,Coverage:Vo,ScriptList:Xo,FeatureList:Zo,LookupList:Qo,ushortList:yl,tableList:bf,recordList:bl};function d0(a,t){return a.getUint8(t)}function $o(a,t){return a.getUint16(t,!1)}function Qy(a,t){return a.getInt16(t,!1)}function Nf(a,t){return a.getUint32(t,!1)}function pm(a,t){var r=a.getInt16(t,!1),i=a.getUint16(t+2,!1);return r+i/65535}function $y(a,t){for(var r="",i=t;i<t+4;i+=1)r+=String.fromCharCode(a.getInt8(i));return r}function Ky(a,t,r){for(var i=0,l=0;l<r;l+=1)i<<=8,i+=a.getUint8(t+l);return i}function Wy(a,t,r){for(var i=[],l=t;l<r;l+=1)i.push(a.getUint8(l));return i}function Jy(a){for(var t="",r=0;r<a.length;r+=1)t+=String.fromCharCode(a[r]);return t}var e1={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function re(a,t){this.data=a,this.offset=t,this.relativeOffset=0}re.prototype.parseByte=function(){var a=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,a};re.prototype.parseChar=function(){var a=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,a};re.prototype.parseCard8=re.prototype.parseByte;re.prototype.parseUShort=function(){var a=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,a};re.prototype.parseCard16=re.prototype.parseUShort;re.prototype.parseSID=re.prototype.parseUShort;re.prototype.parseOffset16=re.prototype.parseUShort;re.prototype.parseShort=function(){var a=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,a};re.prototype.parseF2Dot14=function(){var a=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,a};re.prototype.parseULong=function(){var a=Nf(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,a};re.prototype.parseOffset32=re.prototype.parseULong;re.prototype.parseFixed=function(){var a=pm(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,a};re.prototype.parseString=function(a){var t=this.data,r=this.offset+this.relativeOffset,i="";this.relativeOffset+=a;for(var l=0;l<a;l++)i+=String.fromCharCode(t.getUint8(r+l));return i};re.prototype.parseTag=function(){return this.parseString(4)};re.prototype.parseLongDateTime=function(){var a=Nf(this.data,this.offset+this.relativeOffset+4);return a-=2082844800,this.relativeOffset+=8,a};re.prototype.parseVersion=function(a){var t=$o(this.data,this.offset+this.relativeOffset),r=$o(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,a===void 0&&(a=4096),t+r/a/10};re.prototype.skip=function(a,t){t===void 0&&(t=1),this.relativeOffset+=e1[a]*t};re.prototype.parseULongList=function(a){a===void 0&&(a=this.parseULong());for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getUint32(i),i+=4;return this.relativeOffset+=a*4,t};re.prototype.parseOffset16List=re.prototype.parseUShortList=function(a){a===void 0&&(a=this.parseUShort());for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getUint16(i),i+=2;return this.relativeOffset+=a*2,t};re.prototype.parseShortList=function(a){for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getInt16(i),i+=2;return this.relativeOffset+=a*2,t};re.prototype.parseByteList=function(a){for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getUint8(i++);return this.relativeOffset+=a,t};re.prototype.parseList=function(a,t){t||(t=a,a=this.parseUShort());for(var r=new Array(a),i=0;i<a;i++)r[i]=t.call(this);return r};re.prototype.parseList32=function(a,t){t||(t=a,a=this.parseULong());for(var r=new Array(a),i=0;i<a;i++)r[i]=t.call(this);return r};re.prototype.parseRecordList=function(a,t){t||(t=a,a=this.parseUShort());for(var r=new Array(a),i=Object.keys(t),l=0;l<a;l++){for(var u={},f=0;f<i.length;f++){var h=i[f],d=t[h];u[h]=d.call(this)}r[l]=u}return r};re.prototype.parseRecordList32=function(a,t){t||(t=a,a=this.parseULong());for(var r=new Array(a),i=Object.keys(t),l=0;l<a;l++){for(var u={},f=0;f<i.length;f++){var h=i[f],d=t[h];u[h]=d.call(this)}r[l]=u}return r};re.prototype.parseStruct=function(a){if(typeof a=="function")return a.call(this);for(var t=Object.keys(a),r={},i=0;i<t.length;i++){var l=t[i],u=a[l];r[l]=u.call(this)}return r};re.prototype.parseValueRecord=function(a){if(a===void 0&&(a=this.parseUShort()),a!==0){var t={};return a&1&&(t.xPlacement=this.parseShort()),a&2&&(t.yPlacement=this.parseShort()),a&4&&(t.xAdvance=this.parseShort()),a&8&&(t.yAdvance=this.parseShort()),a&16&&(t.xPlaDevice=void 0,this.parseShort()),a&32&&(t.yPlaDevice=void 0,this.parseShort()),a&64&&(t.xAdvDevice=void 0,this.parseShort()),a&128&&(t.yAdvDevice=void 0,this.parseShort()),t}};re.prototype.parseValueRecordList=function(){for(var a=this.parseUShort(),t=this.parseUShort(),r=new Array(t),i=0;i<t;i++)r[i]=this.parseValueRecord(a);return r};re.prototype.parsePointer=function(a){var t=this.parseOffset16();if(t>0)return new re(this.data,this.offset+t).parseStruct(a)};re.prototype.parsePointer32=function(a){var t=this.parseOffset32();if(t>0)return new re(this.data,this.offset+t).parseStruct(a)};re.prototype.parseListOfLists=function(a){for(var t=this.parseOffset16List(),r=t.length,i=this.relativeOffset,l=new Array(r),u=0;u<r;u++){var f=t[u];if(f===0){l[u]=void 0;continue}if(this.relativeOffset=f,a){for(var h=this.parseOffset16List(),d=new Array(h.length),g=0;g<h.length;g++)this.relativeOffset=f+h[g],d[g]=a.call(this);l[u]=d}else l[u]=this.parseUShortList()}return this.relativeOffset=i,l};re.prototype.parseCoverage=function(){var a=this.offset+this.relativeOffset,t=this.parseUShort(),r=this.parseUShort();if(t===1)return{format:1,glyphs:this.parseUShortList(r)};if(t===2){for(var i=new Array(r),l=0;l<r;l++)i[l]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}throw new Error("0x"+a.toString(16)+": Coverage format must be 1 or 2.")};re.prototype.parseClassDef=function(){var a=this.offset+this.relativeOffset,t=this.parseUShort();if(t===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(t===2)return{format:2,ranges:this.parseRecordList({start:re.uShort,end:re.uShort,classId:re.uShort})};throw new Error("0x"+a.toString(16)+": ClassDef format must be 1 or 2.")};re.list=function(a,t){return function(){return this.parseList(a,t)}};re.list32=function(a,t){return function(){return this.parseList32(a,t)}};re.recordList=function(a,t){return function(){return this.parseRecordList(a,t)}};re.recordList32=function(a,t){return function(){return this.parseRecordList32(a,t)}};re.pointer=function(a){return function(){return this.parsePointer(a)}};re.pointer32=function(a){return function(){return this.parsePointer32(a)}};re.tag=re.prototype.parseTag;re.byte=re.prototype.parseByte;re.uShort=re.offset16=re.prototype.parseUShort;re.uShortList=re.prototype.parseUShortList;re.uLong=re.offset32=re.prototype.parseULong;re.uLongList=re.prototype.parseULongList;re.struct=re.prototype.parseStruct;re.coverage=re.prototype.parseCoverage;re.classDef=re.prototype.parseClassDef;var p0={reserved:re.uShort,reqFeatureIndex:re.uShort,featureIndexes:re.uShortList};re.prototype.parseScriptList=function(){return this.parsePointer(re.recordList({tag:re.tag,script:re.pointer({defaultLangSys:re.pointer(p0),langSysRecords:re.recordList({tag:re.tag,langSys:re.pointer(p0)})})}))||[]};re.prototype.parseFeatureList=function(){return this.parsePointer(re.recordList({tag:re.tag,feature:re.pointer({featureParams:re.offset16,lookupListIndexes:re.uShortList})}))||[]};re.prototype.parseLookupList=function(a){return this.parsePointer(re.list(re.pointer(function(){var t=this.parseUShort();Qe.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var r=this.parseUShort(),i=r&16;return{lookupType:t,lookupFlag:r,subtables:this.parseList(re.pointer(a[t])),markFilteringSet:i?this.parseUShort():void 0}})))||[]};re.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var a=this.parseUShort(),t=this.parseUShort();Qe.argument(a===1&&t<1,"GPOS/GSUB feature variations table unknown.");var r=this.parseRecordList32({conditionSetOffset:re.offset32,featureTableSubstitutionOffset:re.offset32});return r})||[]};var We={getByte:d0,getCard8:d0,getUShort:$o,getCard16:$o,getShort:Qy,getULong:Nf,getFixed:pm,getTag:$y,getOffset:Ky,getBytes:Wy,bytesToString:Jy,Parser:re};function t1(a,t){t.parseUShort(),a.length=t.parseULong(),a.language=t.parseULong();var r;a.groupCount=r=t.parseULong(),a.glyphIndexMap={};for(var i=0;i<r;i+=1)for(var l=t.parseULong(),u=t.parseULong(),f=t.parseULong(),h=l;h<=u;h+=1)a.glyphIndexMap[h]=f,f++}function n1(a,t,r,i,l){a.length=t.parseUShort(),a.language=t.parseUShort();var u;a.segCount=u=t.parseUShort()>>1,t.skip("uShort",3),a.glyphIndexMap={};for(var f=new We.Parser(r,i+l+14),h=new We.Parser(r,i+l+16+u*2),d=new We.Parser(r,i+l+16+u*4),g=new We.Parser(r,i+l+16+u*6),v=i+l+16+u*8,x=0;x<u-1;x+=1)for(var y=void 0,E=f.parseUShort(),S=h.parseUShort(),w=d.parseShort(),D=g.parseUShort(),U=S;U<=E;U+=1)D!==0?(v=g.offset+g.relativeOffset-2,v+=D,v+=(U-S)*2,y=We.getUShort(r,v),y!==0&&(y=y+w&65535)):y=U+w&65535,a.glyphIndexMap[U]=y}function a1(a,t){var r={};r.version=We.getUShort(a,t),Qe.argument(r.version===0,"cmap table version should be 0."),r.numTables=We.getUShort(a,t+2);for(var i=-1,l=r.numTables-1;l>=0;l-=1){var u=We.getUShort(a,t+4+l*8),f=We.getUShort(a,t+4+l*8+2);if(u===3&&(f===0||f===1||f===10)||u===0&&(f===0||f===1||f===2||f===3||f===4)){i=We.getULong(a,t+4+l*8+4);break}}if(i===-1)throw new Error("No valid cmap sub-tables found.");var h=new We.Parser(a,t+i);if(r.format=h.parseUShort(),r.format===12)t1(r,h);else if(r.format===4)n1(r,h,a,t,i);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");return r}function r1(a,t,r){a.segments.push({end:t,start:t,delta:-(t-r),offset:0,glyphIndex:r})}function i1(a){a.segments.push({end:65535,start:65535,delta:1,offset:0})}function s1(a){var t=!0,r;for(r=a.length-1;r>0;r-=1){var i=a.get(r);if(i.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),t=!1;break}}var l=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:t?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:t?12:20}];t||(l=l.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),l=l.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var u=new Oe.Table("cmap",l);for(u.segments=[],r=0;r<a.length;r+=1){for(var f=a.get(r),h=0;h<f.unicodes.length;h+=1)r1(u,f.unicodes[h],r);u.segments=u.segments.sort(function(k,C){return k.start-C.start})}i1(u);var d=u.segments.length,g=0,v=[],x=[],y=[],E=[],S=[],w=[];for(r=0;r<d;r+=1){var D=u.segments[r];D.end<=65535&&D.start<=65535?(v=v.concat({name:"end_"+r,type:"USHORT",value:D.end}),x=x.concat({name:"start_"+r,type:"USHORT",value:D.start}),y=y.concat({name:"idDelta_"+r,type:"SHORT",value:D.delta}),E=E.concat({name:"idRangeOffset_"+r,type:"USHORT",value:D.offset}),D.glyphId!==void 0&&(S=S.concat({name:"glyph_"+r,type:"USHORT",value:D.glyphId}))):g+=1,!t&&D.glyphIndex!==void 0&&(w=w.concat({name:"cmap12Start_"+r,type:"ULONG",value:D.start}),w=w.concat({name:"cmap12End_"+r,type:"ULONG",value:D.end}),w=w.concat({name:"cmap12Glyph_"+r,type:"ULONG",value:D.glyphIndex}))}if(u.segCountX2=(d-g)*2,u.searchRange=Math.pow(2,Math.floor(Math.log(d-g)/Math.log(2)))*2,u.entrySelector=Math.log(u.searchRange/2)/Math.log(2),u.rangeShift=u.segCountX2-u.searchRange,u.fields=u.fields.concat(v),u.fields.push({name:"reservedPad",type:"USHORT",value:0}),u.fields=u.fields.concat(x),u.fields=u.fields.concat(y),u.fields=u.fields.concat(E),u.fields=u.fields.concat(S),u.cmap4Length=14+v.length*2+2+x.length*2+y.length*2+E.length*2+S.length*2,!t){var U=16+w.length*4;u.cmap12Offset=20+u.cmap4Length,u.fields=u.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:U},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:w.length/3}]),u.fields=u.fields.concat(w)}return u}var l1={parse:a1,make:s1},Yo=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],o1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],u1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],h0=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function hm(a){this.font=a}hm.prototype.charToGlyphIndex=function(a){var t=a.codePointAt(0),r=this.font.glyphs;if(r){for(var i=0;i<r.length;i+=1)for(var l=r.get(i),u=0;u<l.unicodes.length;u+=1)if(l.unicodes[u]===t)return i}return null};function Ko(a,t){this.encoding=a,this.charset=t}Ko.prototype.charToGlyphIndex=function(a){var t=a.codePointAt(0),r=this.encoding[t];return this.charset.indexOf(r)};function c1(a,t,r,i,l){a.beginPath(),a.moveTo(t,r),a.lineTo(i,l),a.stroke()}var Ei={line:c1};function f1(a,t){var r=t||new Qt;return{configurable:!0,get:function(){return typeof r=="function"&&(r=r()),r},set:function(i){r=i}}}function ta(a){this.bindConstructorValues(a)}ta.prototype.bindConstructorValues=function(a){this.index=a.index||0,this.name=a.name||null,this.unicode=a.unicode||void 0,this.unicodes=a.unicodes||a.unicode!==void 0?[a.unicode]:[],"xMin"in a&&(this.xMin=a.xMin),"yMin"in a&&(this.yMin=a.yMin),"xMax"in a&&(this.xMax=a.xMax),"yMax"in a&&(this.yMax=a.yMax),"advanceWidth"in a&&(this.advanceWidth=a.advanceWidth),Object.defineProperty(this,"path",f1(this,a.path))};ta.prototype.addUnicode=function(a){this.unicodes.length===0&&(this.unicode=a),this.unicodes.push(a)};ta.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};ta.prototype.getPath=function(a,t,r,i,l){a=a!==void 0?a:0,t=t!==void 0?t:0,r=r!==void 0?r:72;var u,f;i||(i={});var h=i.xScale,d=i.yScale;if(i.hinting&&l&&l.hinting&&(f=this.path&&l.hinting.exec(this,r)),f)u=l.hinting.getCommands(f),a=Math.round(a),t=Math.round(t),h=d=1;else{u=this.path.commands;var g=1/(this.path.unitsPerEm||1e3)*r;h===void 0&&(h=g),d===void 0&&(d=g)}for(var v=new Qt,x=0;x<u.length;x+=1){var y=u[x];y.type==="M"?v.moveTo(a+y.x*h,t+-y.y*d):y.type==="L"?v.lineTo(a+y.x*h,t+-y.y*d):y.type==="Q"?v.quadraticCurveTo(a+y.x1*h,t+-y.y1*d,a+y.x*h,t+-y.y*d):y.type==="C"?v.curveTo(a+y.x1*h,t+-y.y1*d,a+y.x2*h,t+-y.y2*d,a+y.x*h,t+-y.y*d):y.type==="Z"&&v.closePath()}return v};ta.prototype.getContours=function(){if(this.points===void 0)return[];for(var a=[],t=[],r=0;r<this.points.length;r+=1){var i=this.points[r];t.push(i),i.lastPointOfContour&&(a.push(t),t=[])}return Qe.argument(t.length===0,"There are still points left in the current contour."),a};ta.prototype.getMetrics=function(){for(var a=this.path.commands,t=[],r=[],i=0;i<a.length;i+=1){var l=a[i];l.type!=="Z"&&(t.push(l.x),r.push(l.y)),(l.type==="Q"||l.type==="C")&&(t.push(l.x1),r.push(l.y1)),l.type==="C"&&(t.push(l.x2),r.push(l.y2))}var u={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(u.xMin)||(u.xMin=0),isFinite(u.xMax)||(u.xMax=this.advanceWidth),isFinite(u.yMin)||(u.yMin=0),isFinite(u.yMax)||(u.yMax=0),u.rightSideBearing=this.advanceWidth-u.leftSideBearing-(u.xMax-u.xMin),u};ta.prototype.draw=function(a,t,r,i,l){this.getPath(t,r,i,l).draw(a)};ta.prototype.drawPoints=function(a,t,r,i){function l(x,y,E,S){a.beginPath();for(var w=0;w<x.length;w+=1)a.moveTo(y+x[w].x*S,E+x[w].y*S),a.arc(y+x[w].x*S,E+x[w].y*S,2,0,Math.PI*2,!1);a.closePath(),a.fill()}t=t!==void 0?t:0,r=r!==void 0?r:0,i=i!==void 0?i:24;for(var u=1/this.path.unitsPerEm*i,f=[],h=[],d=this.path,g=0;g<d.commands.length;g+=1){var v=d.commands[g];v.x!==void 0&&f.push({x:v.x,y:-v.y}),v.x1!==void 0&&h.push({x:v.x1,y:-v.y1}),v.x2!==void 0&&h.push({x:v.x2,y:-v.y2})}a.fillStyle="blue",l(f,t,r,u),a.fillStyle="red",l(h,t,r,u)};ta.prototype.drawMetrics=function(a,t,r,i){var l;t=t!==void 0?t:0,r=r!==void 0?r:0,i=i!==void 0?i:24,l=1/this.path.unitsPerEm*i,a.lineWidth=1,a.strokeStyle="black",Ei.line(a,t,-1e4,t,1e4),Ei.line(a,-1e4,r,1e4,r);var u=this.xMin||0,f=this.yMin||0,h=this.xMax||0,d=this.yMax||0,g=this.advanceWidth||0;a.strokeStyle="blue",Ei.line(a,t+u*l,-1e4,t+u*l,1e4),Ei.line(a,t+h*l,-1e4,t+h*l,1e4),Ei.line(a,-1e4,r+-f*l,1e4,r+-f*l),Ei.line(a,-1e4,r+-d*l,1e4,r+-d*l),a.strokeStyle="green",Ei.line(a,t+g*l,-1e4,t+g*l,1e4)};function Po(a,t,r){Object.defineProperty(a,t,{get:function(){return a.path,a[r]},set:function(i){a[r]=i},enumerable:!0,configurable:!0})}function Rf(a,t){if(this.font=a,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++){var i=t[r];i.path.unitsPerEm=a.unitsPerEm,this.glyphs[r]=i}this.length=t&&t.length||0}Rf.prototype.get=function(a){if(this.glyphs[a]===void 0){this.font._push(a),typeof this.glyphs[a]=="function"&&(this.glyphs[a]=this.glyphs[a]());var t=this.glyphs[a],r=this.font._IndexToUnicodeMap[a];if(r)for(var i=0;i<r.unicodes.length;i++)t.addUnicode(r.unicodes[i]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+a:t.name=this.font.cffEncoding.charset[a]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(a)),this.glyphs[a].advanceWidth=this.font._hmtxTableData[a].advanceWidth,this.glyphs[a].leftSideBearing=this.font._hmtxTableData[a].leftSideBearing}else typeof this.glyphs[a]=="function"&&(this.glyphs[a]=this.glyphs[a]());return this.glyphs[a]};Rf.prototype.push=function(a,t){this.glyphs[a]=t,this.length++};function d1(a,t){return new ta({index:t,font:a})}function p1(a,t,r,i,l,u){return function(){var f=new ta({index:t,font:a});return f.path=function(){r(f,i,l);var h=u(a.glyphs,f);return h.unitsPerEm=a.unitsPerEm,h},Po(f,"xMin","_xMin"),Po(f,"xMax","_xMax"),Po(f,"yMin","_yMin"),Po(f,"yMax","_yMax"),f}}function h1(a,t,r,i){return function(){var l=new ta({index:t,font:a});return l.path=function(){var u=r(a,l,i);return u.unitsPerEm=a.unitsPerEm,u},l}}var ja={GlyphSet:Rf,glyphLoader:d1,ttfGlyphLoader:p1,cffGlyphLoader:h1};function mm(a,t){if(a===t)return!0;if(Array.isArray(a)&&Array.isArray(t)){if(a.length!==t.length)return!1;for(var r=0;r<a.length;r+=1)if(!mm(a[r],t[r]))return!1;return!0}else return!1}function xf(a){var t;return a.length<1240?t=107:a.length<33900?t=1131:t=32768,t}function Vr(a,t,r){var i=[],l=[],u=We.getCard16(a,t),f,h;if(u!==0){var d=We.getByte(a,t+2);f=t+(u+1)*d+2;for(var g=t+3,v=0;v<u+1;v+=1)i.push(We.getOffset(a,g,d)),g+=d;h=f+i[u]}else h=t+2;for(var x=0;x<i.length-1;x+=1){var y=We.getBytes(a,f+i[x],f+i[x+1]);r&&(y=r(y)),l.push(y)}return{objects:l,startOffset:t,endOffset:h}}function m1(a,t){var r=[],i=We.getCard16(a,t),l,u;if(i!==0){var f=We.getByte(a,t+2);l=t+(i+1)*f+2;for(var h=t+3,d=0;d<i+1;d+=1)r.push(We.getOffset(a,h,f)),h+=f;u=l+r[i]}else u=t+2;return{offsets:r,startOffset:t,endOffset:u}}function g1(a,t,r,i,l){var u=We.getCard16(r,i),f=0;if(u!==0){var h=We.getByte(r,i+2);f=i+(u+1)*h+2}var d=We.getBytes(r,f+t[a],f+t[a+1]);return d}function v1(a){for(var t="",r=15,i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var l=a.parseByte(),u=l>>4,f=l&15;if(u===r||(t+=i[u],f===r))break;t+=i[f]}return parseFloat(t)}function y1(a,t){var r,i,l,u;if(t===28)return r=a.parseByte(),i=a.parseByte(),r<<8|i;if(t===29)return r=a.parseByte(),i=a.parseByte(),l=a.parseByte(),u=a.parseByte(),r<<24|i<<16|l<<8|u;if(t===30)return v1(a);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return r=a.parseByte(),(t-247)*256+r+108;if(t>=251&&t<=254)return r=a.parseByte(),-(t-251)*256-r-108;throw new Error("Invalid b0 "+t)}function b1(a){for(var t={},r=0;r<a.length;r+=1){var i=a[r][0],l=a[r][1],u=void 0;if(l.length===1?u=l[0]:u=l,t.hasOwnProperty(i)&&!isNaN(t[i]))throw new Error("Object "+t+" already has key "+i);t[i]=u}return t}function gm(a,t,r){t=t!==void 0?t:0;var i=new We.Parser(a,t),l=[],u=[];for(r=r!==void 0?r:a.length;i.relativeOffset<r;){var f=i.parseByte();f<=21?(f===12&&(f=1200+i.parseByte()),l.push([f,u]),u=[]):u.push(y1(i,f))}return b1(l)}function ml(a,t){return t<=390?t=Yo[t]:t=a[t-391],t}function vm(a,t,r){for(var i={},l,u=0;u<t.length;u+=1){var f=t[u];if(Array.isArray(f.type)){var h=[];h.length=f.type.length;for(var d=0;d<f.type.length;d++)l=a[f.op]!==void 0?a[f.op][d]:void 0,l===void 0&&(l=f.value!==void 0&&f.value[d]!==void 0?f.value[d]:null),f.type[d]==="SID"&&(l=ml(r,l)),h[d]=l;i[f.name]=h}else l=a[f.op],l===void 0&&(l=f.value!==void 0?f.value:null),f.type==="SID"&&(l=ml(r,l)),i[f.name]=l}return i}function x1(a,t){var r={};return r.formatMajor=We.getCard8(a,t),r.formatMinor=We.getCard8(a,t+1),r.size=We.getCard8(a,t+2),r.offsetSize=We.getCard8(a,t+3),r.startOffset=t,r.endOffset=t+4,r}var ym=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],bm=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function S1(a,t){var r=gm(a,0,a.byteLength);return vm(r,ym,t)}function xm(a,t,r,i){var l=gm(a,t,r);return vm(l,bm,i)}function m0(a,t,r,i){for(var l=[],u=0;u<r.length;u+=1){var f=new DataView(new Uint8Array(r[u]).buffer),h=S1(f,i);h._subrs=[],h._subrsBias=0,h._defaultWidthX=0,h._nominalWidthX=0;var d=h.private[0],g=h.private[1];if(d!==0&&g!==0){var v=xm(a,g+t,d,i);if(h._defaultWidthX=v.defaultWidthX,h._nominalWidthX=v.nominalWidthX,v.subrs!==0){var x=g+v.subrs,y=Vr(a,x+t);h._subrs=y.objects,h._subrsBias=xf(h._subrs)}h._privateDict=v}l.push(h)}return l}function E1(a,t,r,i){var l,u,f=new We.Parser(a,t);r-=1;var h=[".notdef"],d=f.parseCard8();if(d===0)for(var g=0;g<r;g+=1)l=f.parseSID(),h.push(ml(i,l));else if(d===1)for(;h.length<=r;){l=f.parseSID(),u=f.parseCard8();for(var v=0;v<=u;v+=1)h.push(ml(i,l)),l+=1}else if(d===2)for(;h.length<=r;){l=f.parseSID(),u=f.parseCard16();for(var x=0;x<=u;x+=1)h.push(ml(i,l)),l+=1}else throw new Error("Unknown charset format "+d);return h}function A1(a,t,r){var i,l={},u=new We.Parser(a,t),f=u.parseCard8();if(f===0)for(var h=u.parseCard8(),d=0;d<h;d+=1)i=u.parseCard8(),l[i]=d;else if(f===1){var g=u.parseCard8();i=1;for(var v=0;v<g;v+=1)for(var x=u.parseCard8(),y=u.parseCard8(),E=x;E<=x+y;E+=1)l[E]=i,i+=1}else throw new Error("Unknown encoding format "+f);return new Ko(l,r)}function g0(a,t,r){var i,l,u,f,h=new Qt,d=[],g=0,v=!1,x=!1,y=0,E=0,S,w,D,U;if(a.isCIDFont){var k=a.tables.cff.topDict._fdSelect[t.index],C=a.tables.cff.topDict._fdArray[k];S=C._subrs,w=C._subrsBias,D=C._defaultWidthX,U=C._nominalWidthX}else S=a.tables.cff.topDict._subrs,w=a.tables.cff.topDict._subrsBias,D=a.tables.cff.topDict._defaultWidthX,U=a.tables.cff.topDict._nominalWidthX;var M=D;function F(de,ce){x&&h.closePath(),h.moveTo(de,ce),x=!0}function H(){var de;de=d.length%2!==0,de&&!v&&(M=d.shift()+U),g+=d.length>>1,d.length=0,v=!0}function fe(de){for(var ce,le,Z,z,Q,$,W,B,P,V,pe,R,G=0;G<de.length;){var ie=de[G];switch(G+=1,ie){case 1:H();break;case 3:H();break;case 4:d.length>1&&!v&&(M=d.shift()+U,v=!0),E+=d.pop(),F(y,E);break;case 5:for(;d.length>0;)y+=d.shift(),E+=d.shift(),h.lineTo(y,E);break;case 6:for(;d.length>0&&(y+=d.shift(),h.lineTo(y,E),d.length!==0);)E+=d.shift(),h.lineTo(y,E);break;case 7:for(;d.length>0&&(E+=d.shift(),h.lineTo(y,E),d.length!==0);)y+=d.shift(),h.lineTo(y,E);break;case 8:for(;d.length>0;)i=y+d.shift(),l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),E=f+d.shift(),h.curveTo(i,l,u,f,y,E);break;case 10:Q=d.pop()+w,$=S[Q],$&&fe($);break;case 11:return;case 12:switch(ie=de[G],G+=1,ie){case 35:i=y+d.shift(),l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),W=u+d.shift(),B=f+d.shift(),P=W+d.shift(),V=B+d.shift(),pe=P+d.shift(),R=V+d.shift(),y=pe+d.shift(),E=R+d.shift(),d.shift(),h.curveTo(i,l,u,f,W,B),h.curveTo(P,V,pe,R,y,E);break;case 34:i=y+d.shift(),l=E,u=i+d.shift(),f=l+d.shift(),W=u+d.shift(),B=f,P=W+d.shift(),V=f,pe=P+d.shift(),R=E,y=pe+d.shift(),h.curveTo(i,l,u,f,W,B),h.curveTo(P,V,pe,R,y,E);break;case 36:i=y+d.shift(),l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),W=u+d.shift(),B=f,P=W+d.shift(),V=f,pe=P+d.shift(),R=V+d.shift(),y=pe+d.shift(),h.curveTo(i,l,u,f,W,B),h.curveTo(P,V,pe,R,y,E);break;case 37:i=y+d.shift(),l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),W=u+d.shift(),B=f+d.shift(),P=W+d.shift(),V=B+d.shift(),pe=P+d.shift(),R=V+d.shift(),Math.abs(pe-y)>Math.abs(R-E)?y=pe+d.shift():E=R+d.shift(),h.curveTo(i,l,u,f,W,B),h.curveTo(P,V,pe,R,y,E);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+ie),d.length=0}break;case 14:d.length>0&&!v&&(M=d.shift()+U,v=!0),x&&(h.closePath(),x=!1);break;case 18:H();break;case 19:case 20:H(),G+=g+7>>3;break;case 21:d.length>2&&!v&&(M=d.shift()+U,v=!0),E+=d.pop(),y+=d.pop(),F(y,E);break;case 22:d.length>1&&!v&&(M=d.shift()+U,v=!0),y+=d.pop(),F(y,E);break;case 23:H();break;case 24:for(;d.length>2;)i=y+d.shift(),l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),E=f+d.shift(),h.curveTo(i,l,u,f,y,E);y+=d.shift(),E+=d.shift(),h.lineTo(y,E);break;case 25:for(;d.length>6;)y+=d.shift(),E+=d.shift(),h.lineTo(y,E);i=y+d.shift(),l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),E=f+d.shift(),h.curveTo(i,l,u,f,y,E);break;case 26:for(d.length%2&&(y+=d.shift());d.length>0;)i=y,l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u,E=f+d.shift(),h.curveTo(i,l,u,f,y,E);break;case 27:for(d.length%2&&(E+=d.shift());d.length>0;)i=y+d.shift(),l=E,u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),E=f,h.curveTo(i,l,u,f,y,E);break;case 28:ce=de[G],le=de[G+1],d.push((ce<<24|le<<16)>>16),G+=2;break;case 29:Q=d.pop()+a.gsubrsBias,$=a.gsubrs[Q],$&&fe($);break;case 30:for(;d.length>0&&(i=y,l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),E=f+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,E),d.length!==0);)i=y+d.shift(),l=E,u=i+d.shift(),f=l+d.shift(),E=f+d.shift(),y=u+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,E);break;case 31:for(;d.length>0&&(i=y+d.shift(),l=E,u=i+d.shift(),f=l+d.shift(),E=f+d.shift(),y=u+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,E),d.length!==0);)i=y,l=E+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),E=f+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,E);break;default:ie<32?console.log("Glyph "+t.index+": unknown operator "+ie):ie<247?d.push(ie-139):ie<251?(ce=de[G],G+=1,d.push((ie-247)*256+ce+108)):ie<255?(ce=de[G],G+=1,d.push(-(ie-251)*256-ce-108)):(ce=de[G],le=de[G+1],Z=de[G+2],z=de[G+3],G+=4,d.push((ce<<24|le<<16|Z<<8|z)/65536))}}}return fe(r),t.advanceWidth=M,h}function w1(a,t,r,i){var l=[],u,f=new We.Parser(a,t),h=f.parseCard8();if(h===0)for(var d=0;d<r;d++){if(u=f.parseCard8(),u>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+i+")");l.push(u)}else if(h===3){var g=f.parseCard16(),v=f.parseCard16();if(v!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+v);for(var x,y=0;y<g;y++){if(u=f.parseCard8(),x=f.parseCard16(),u>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+i+")");if(x>r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+x);for(;v<x;v++)l.push(u);v=x}if(x!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+x)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+h);return l}function T1(a,t,r,i){r.tables.cff={};var l=x1(a,t),u=Vr(a,l.endOffset,We.bytesToString),f=Vr(a,u.endOffset),h=Vr(a,f.endOffset,We.bytesToString),d=Vr(a,h.endOffset);r.gsubrs=d.objects,r.gsubrsBias=xf(r.gsubrs);var g=m0(a,t,f.objects,h.objects);if(g.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+g.length);var v=g[0];if(r.tables.cff.topDict=v,v._privateDict&&(r.defaultWidthX=v._privateDict.defaultWidthX,r.nominalWidthX=v._privateDict.nominalWidthX),v.ros[0]!==void 0&&v.ros[1]!==void 0&&(r.isCIDFont=!0),r.isCIDFont){var x=v.fdArray,y=v.fdSelect;if(x===0||y===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");x+=t;var E=Vr(a,x),S=m0(a,t,E.objects,h.objects);v._fdArray=S,y+=t,v._fdSelect=w1(a,y,r.numGlyphs,S.length)}var w=t+v.private[1],D=xm(a,w,v.private[0],h.objects);if(r.defaultWidthX=D.defaultWidthX,r.nominalWidthX=D.nominalWidthX,D.subrs!==0){var U=w+D.subrs,k=Vr(a,U);r.subrs=k.objects,r.subrsBias=xf(r.subrs)}else r.subrs=[],r.subrsBias=0;var C;i.lowMemory?(C=m1(a,t+v.charStrings),r.nGlyphs=C.offsets.length):(C=Vr(a,t+v.charStrings),r.nGlyphs=C.objects.length);var M=E1(a,t+v.charset,r.nGlyphs,h.objects);if(v.encoding===0?r.cffEncoding=new Ko(o1,M):v.encoding===1?r.cffEncoding=new Ko(u1,M):r.cffEncoding=A1(a,t+v.encoding,M),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new ja.GlyphSet(r),i.lowMemory)r._push=function(fe){var de=g1(fe,C.offsets,a,t+v.charStrings);r.glyphs.push(fe,ja.cffGlyphLoader(r,fe,g0,de))};else for(var F=0;F<r.nGlyphs;F+=1){var H=C.objects[F];r.glyphs.push(F,ja.cffGlyphLoader(r,F,g0,H))}}function Sm(a,t){var r,i=Yo.indexOf(a);return i>=0&&(r=i),i=t.indexOf(a),i>=0?r=i+Yo.length:(r=Yo.length+t.length,t.push(a)),r}function C1(){return new Oe.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function M1(a){var t=new Oe.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<a.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:a[r]});return t}function Em(a,t,r){for(var i={},l=0;l<a.length;l+=1){var u=a[l],f=t[u.name];f!==void 0&&!mm(f,u.value)&&(u.type==="SID"&&(f=Sm(f,r)),i[u.op]={name:u.name,type:u.type,value:f})}return i}function v0(a,t){var r=new Oe.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Em(ym,a,t),r}function y0(a){var t=new Oe.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:a}],t}function N1(a){var t=new Oe.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<a.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:a[r]});return t}function R1(){return new Oe.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function D1(a,t){for(var r=new Oe.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<a.length;i+=1){var l=a[i],u=Sm(l,t);r.fields.push({name:"glyph_"+i,type:"SID",value:u})}return r}function _1(a){var t=[],r=a.path;t.push({name:"width",type:"NUMBER",value:a.advanceWidth});for(var i=0,l=0,u=0;u<r.commands.length;u+=1){var f=void 0,h=void 0,d=r.commands[u];if(d.type==="Q"){var g=.3333333333333333,v=2/3;d={type:"C",x:d.x,y:d.y,x1:Math.round(g*i+v*d.x1),y1:Math.round(g*l+v*d.y1),x2:Math.round(g*d.x+v*d.x1),y2:Math.round(g*d.y+v*d.y1)}}if(d.type==="M")f=Math.round(d.x-i),h=Math.round(d.y-l),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(d.x),l=Math.round(d.y);else if(d.type==="L")f=Math.round(d.x-i),h=Math.round(d.y-l),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rlineto",type:"OP",value:5}),i=Math.round(d.x),l=Math.round(d.y);else if(d.type==="C"){var x=Math.round(d.x1-i),y=Math.round(d.y1-l),E=Math.round(d.x2-d.x1),S=Math.round(d.y2-d.y1);f=Math.round(d.x-d.x2),h=Math.round(d.y-d.y2),t.push({name:"dx1",type:"NUMBER",value:x}),t.push({name:"dy1",type:"NUMBER",value:y}),t.push({name:"dx2",type:"NUMBER",value:E}),t.push({name:"dy2",type:"NUMBER",value:S}),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(d.x),l=Math.round(d.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function O1(a){for(var t=new Oe.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<a.length;r+=1){var i=a.get(r),l=_1(i);t.charStrings.push({name:i.name,type:"CHARSTRING",value:l})}return t}function k1(a,t){var r=new Oe.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Em(bm,a,t),r}function L1(a,t){for(var r=new Oe.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/t.unitsPerEm,l={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},u={},f=[],h,d=1;d<a.length;d+=1)h=a.get(d),f.push(h.name);var g=[];r.header=C1(),r.nameIndex=M1([t.postScriptName]);var v=v0(l,g);r.topDictIndex=y0(v),r.globalSubrIndex=R1(),r.charsets=D1(f,g),r.charStringsIndex=O1(a),r.privateDict=k1(u,g),r.stringIndex=N1(g);var x=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return l.charset=x,l.encoding=0,l.charStrings=l.charset+r.charsets.sizeOf(),l.private[1]=l.charStrings+r.charStringsIndex.sizeOf(),v=v0(l,g),r.topDictIndex=y0(v),r}var U1={parse:T1,make:L1};function I1(a,t){var r={},i=new We.Parser(a,t);return r.version=i.parseVersion(),r.fontRevision=Math.round(i.parseFixed()*1e3)/1e3,r.checkSumAdjustment=i.parseULong(),r.magicNumber=i.parseULong(),Qe.argument(r.magicNumber===1594834165,"Font header has wrong magic number."),r.flags=i.parseUShort(),r.unitsPerEm=i.parseUShort(),r.created=i.parseLongDateTime(),r.modified=i.parseLongDateTime(),r.xMin=i.parseShort(),r.yMin=i.parseShort(),r.xMax=i.parseShort(),r.yMax=i.parseShort(),r.macStyle=i.parseUShort(),r.lowestRecPPEM=i.parseUShort(),r.fontDirectionHint=i.parseShort(),r.indexToLocFormat=i.parseShort(),r.glyphDataFormat=i.parseShort(),r}function B1(a){var t=Math.round(new Date().getTime()/1e3)+2082844800,r=t;return a.createdTimestamp&&(r=a.createdTimestamp+2082844800),new Oe.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],a)}var F1={parse:I1,make:B1};function j1(a,t){var r={},i=new We.Parser(a,t);return r.version=i.parseVersion(),r.ascender=i.parseShort(),r.descender=i.parseShort(),r.lineGap=i.parseShort(),r.advanceWidthMax=i.parseUShort(),r.minLeftSideBearing=i.parseShort(),r.minRightSideBearing=i.parseShort(),r.xMaxExtent=i.parseShort(),r.caretSlopeRise=i.parseShort(),r.caretSlopeRun=i.parseShort(),r.caretOffset=i.parseShort(),i.relativeOffset+=8,r.metricDataFormat=i.parseShort(),r.numberOfHMetrics=i.parseUShort(),r}function P1(a){return new Oe.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],a)}var G1={parse:j1,make:P1};function z1(a,t,r,i,l){for(var u,f,h=new We.Parser(a,t),d=0;d<i;d+=1){d<r&&(u=h.parseUShort(),f=h.parseShort());var g=l.get(d);g.advanceWidth=u,g.leftSideBearing=f}}function H1(a,t,r,i,l){a._hmtxTableData={};for(var u,f,h=new We.Parser(t,r),d=0;d<l;d+=1)d<i&&(u=h.parseUShort(),f=h.parseShort()),a._hmtxTableData[d]={advanceWidth:u,leftSideBearing:f}}function Y1(a,t,r,i,l,u,f){f.lowMemory?H1(a,t,r,i,l):z1(t,r,i,l,u)}function q1(a){for(var t=new Oe.Table("hmtx",[]),r=0;r<a.length;r+=1){var i=a.get(r),l=i.advanceWidth||0,u=i.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:l}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:u})}return t}var V1={parse:Y1,make:q1};function X1(a){for(var t=new Oe.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:a.length}]),r="",i=12+a.length*4,l=0;l<a.length;++l){var u=r.indexOf(a[l]);u<0&&(u=r.length,r+=a[l]),t.fields.push({name:"offset "+l,type:"USHORT",value:i+u}),t.fields.push({name:"length "+l,type:"USHORT",value:a[l].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t}function Z1(a,t){var r=new We.Parser(a,t),i=r.parseULong();Qe.argument(i===1,"Unsupported ltag table version."),r.skip("uLong",1);for(var l=r.parseULong(),u=[],f=0;f<l;f++){for(var h="",d=t+r.parseUShort(),g=r.parseUShort(),v=d;v<d+g;++v)h+=String.fromCharCode(a.getInt8(v));u.push(h)}return u}var Q1={make:X1,parse:Z1};function $1(a,t){var r={},i=new We.Parser(a,t);return r.version=i.parseVersion(),r.numGlyphs=i.parseUShort(),r.version===1&&(r.maxPoints=i.parseUShort(),r.maxContours=i.parseUShort(),r.maxCompositePoints=i.parseUShort(),r.maxCompositeContours=i.parseUShort(),r.maxZones=i.parseUShort(),r.maxTwilightPoints=i.parseUShort(),r.maxStorage=i.parseUShort(),r.maxFunctionDefs=i.parseUShort(),r.maxInstructionDefs=i.parseUShort(),r.maxStackElements=i.parseUShort(),r.maxSizeOfInstructions=i.parseUShort(),r.maxComponentElements=i.parseUShort(),r.maxComponentDepth=i.parseUShort()),r}function K1(a){return new Oe.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:a}])}var W1={parse:$1,make:K1},Am=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],wm={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},J1={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Tm={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function eb(a,t,r){switch(a){case 0:if(t===65535)return"und";if(r)return r[t];break;case 1:return wm[t];case 3:return Tm[t]}}var Sf="utf-16",tb={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},nb={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Cm(a,t,r){switch(a){case 0:return Sf;case 1:return nb[r]||tb[t];case 3:if(t===1||t===10)return Sf;break}}function ab(a,t,r){for(var i={},l=new We.Parser(a,t),u=l.parseUShort(),f=l.parseUShort(),h=l.offset+l.parseUShort(),d=0;d<f;d++){var g=l.parseUShort(),v=l.parseUShort(),x=l.parseUShort(),y=l.parseUShort(),E=Am[y]||y,S=l.parseUShort(),w=l.parseUShort(),D=eb(g,x,r),U=Cm(g,v,x);if(U!==void 0&&D!==void 0){var k=void 0;if(U===Sf?k=cs.UTF16(a,h+w,S):k=cs.MACSTRING(a,h+w,S,U),k){var C=i[E];C===void 0&&(C=i[E]={}),C[D]=k}}}return u===1&&l.parseUShort(),i}function af(a){var t={};for(var r in a)t[a[r]]=parseInt(r);return t}function b0(a,t,r,i,l,u){return new Oe.Record("NameRecord",[{name:"platformID",type:"USHORT",value:a},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:l},{name:"offset",type:"USHORT",value:u}])}function rb(a,t){var r=a.length,i=t.length-r+1;e:for(var l=0;l<i;l++)for(;l<i;l++){for(var u=0;u<r;u++)if(t[l+u]!==a[u])continue e;return l}return-1}function x0(a,t){var r=rb(a,t);if(r<0){r=t.length;for(var i=0,l=a.length;i<l;++i)t.push(a[i])}return r}function ib(a,t){var r,i=[],l={},u=af(Am);for(var f in a){var h=u[f];if(h===void 0&&(h=f),r=parseInt(h),isNaN(r))throw new Error('Name table entry "'+f+'" does not exist, see nameTableNames for complete list.');l[r]=a[f],i.push(r)}for(var d=af(wm),g=af(Tm),v=[],x=[],y=0;y<i.length;y++){r=i[y];var E=l[r];for(var S in E){var w=E[S],D=1,U=d[S],k=J1[U],C=Cm(D,k,U),M=we.MACSTRING(w,C);M===void 0&&(D=0,U=t.indexOf(S),U<0&&(U=t.length,t.push(S)),k=4,M=we.UTF16(w));var F=x0(M,x);v.push(b0(D,k,U,r,M.length,F));var H=g[S];if(H!==void 0){var fe=we.UTF16(w),de=x0(fe,x);v.push(b0(3,1,H,r,fe.length,de))}}}v.sort(function(Z,z){return Z.platformID-z.platformID||Z.encodingID-z.encodingID||Z.languageID-z.languageID||Z.nameID-z.nameID});for(var ce=new Oe.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:v.length},{name:"stringOffset",type:"USHORT",value:6+v.length*12}]),le=0;le<v.length;le++)ce.fields.push({name:"record_"+le,type:"RECORD",value:v[le]});return ce.fields.push({name:"strings",type:"LITERAL",value:x}),ce}var sb={parse:ab,make:ib},Ef=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function lb(a){for(var t=0;t<Ef.length;t+=1){var r=Ef[t];if(a>=r.begin&&a<r.end)return t}return-1}function ob(a,t){var r={},i=new We.Parser(a,t);r.version=i.parseUShort(),r.xAvgCharWidth=i.parseShort(),r.usWeightClass=i.parseUShort(),r.usWidthClass=i.parseUShort(),r.fsType=i.parseUShort(),r.ySubscriptXSize=i.parseShort(),r.ySubscriptYSize=i.parseShort(),r.ySubscriptXOffset=i.parseShort(),r.ySubscriptYOffset=i.parseShort(),r.ySuperscriptXSize=i.parseShort(),r.ySuperscriptYSize=i.parseShort(),r.ySuperscriptXOffset=i.parseShort(),r.ySuperscriptYOffset=i.parseShort(),r.yStrikeoutSize=i.parseShort(),r.yStrikeoutPosition=i.parseShort(),r.sFamilyClass=i.parseShort(),r.panose=[];for(var l=0;l<10;l++)r.panose[l]=i.parseByte();return r.ulUnicodeRange1=i.parseULong(),r.ulUnicodeRange2=i.parseULong(),r.ulUnicodeRange3=i.parseULong(),r.ulUnicodeRange4=i.parseULong(),r.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),r.fsSelection=i.parseUShort(),r.usFirstCharIndex=i.parseUShort(),r.usLastCharIndex=i.parseUShort(),r.sTypoAscender=i.parseShort(),r.sTypoDescender=i.parseShort(),r.sTypoLineGap=i.parseShort(),r.usWinAscent=i.parseUShort(),r.usWinDescent=i.parseUShort(),r.version>=1&&(r.ulCodePageRange1=i.parseULong(),r.ulCodePageRange2=i.parseULong()),r.version>=2&&(r.sxHeight=i.parseShort(),r.sCapHeight=i.parseShort(),r.usDefaultChar=i.parseUShort(),r.usBreakChar=i.parseUShort(),r.usMaxContent=i.parseUShort()),r}function ub(a){return new Oe.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],a)}var S0={parse:ob,make:ub,unicodeRanges:Ef,getUnicodeRange:lb};function cb(a,t){var r={},i=new We.Parser(a,t);switch(r.version=i.parseVersion(),r.italicAngle=i.parseFixed(),r.underlinePosition=i.parseShort(),r.underlineThickness=i.parseShort(),r.isFixedPitch=i.parseULong(),r.minMemType42=i.parseULong(),r.maxMemType42=i.parseULong(),r.minMemType1=i.parseULong(),r.maxMemType1=i.parseULong(),r.version){case 1:r.names=h0.slice();break;case 2:r.numberOfGlyphs=i.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var l=0;l<r.numberOfGlyphs;l++)r.glyphNameIndex[l]=i.parseUShort();r.names=[];for(var u=0;u<r.numberOfGlyphs;u++)if(r.glyphNameIndex[u]>=h0.length){var f=i.parseChar();r.names.push(i.parseString(f))}break;case 2.5:r.numberOfGlyphs=i.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var h=0;h<r.numberOfGlyphs;h++)r.offset[h]=i.parseChar();break}return r}function fb(){return new Oe.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var db={parse:cb,make:fb},ba=new Array(9);ba[1]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(re.coverage),deltaGlyphId:this.parseUShort()};if(r===2)return{substFormat:2,coverage:this.parsePointer(re.coverage),substitute:this.parseOffset16List()};Qe.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")};ba[2]=function(){var t=this.parseUShort();return Qe.argument(t===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),sequences:this.parseListOfLists()}};ba[3]=function(){var t=this.parseUShort();return Qe.argument(t===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),alternateSets:this.parseListOfLists()}};ba[4]=function(){var t=this.parseUShort();return Qe.argument(t===1,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var us={sequenceIndex:re.uShort,lookupListIndex:re.uShort};ba[5]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:r,coverage:this.parsePointer(re.coverage),ruleSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{input:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,us)}})};if(r===2)return{substFormat:r,coverage:this.parsePointer(re.coverage),classDef:this.parsePointer(re.classDef),classSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{classes:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,us)}})};if(r===3){var i=this.parseUShort(),l=this.parseUShort();return{substFormat:r,coverages:this.parseList(i,re.pointer(re.coverage)),lookupRecords:this.parseRecordList(l,us)}}Qe.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};ba[6]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(re.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(us)}})};if(r===2)return{substFormat:2,coverage:this.parsePointer(re.coverage),backtrackClassDef:this.parsePointer(re.classDef),inputClassDef:this.parsePointer(re.classDef),lookaheadClassDef:this.parsePointer(re.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(us)}})};if(r===3)return{substFormat:3,backtrackCoverage:this.parseList(re.pointer(re.coverage)),inputCoverage:this.parseList(re.pointer(re.coverage)),lookaheadCoverage:this.parseList(re.pointer(re.coverage)),lookupRecords:this.parseRecordList(us)};Qe.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};ba[7]=function(){var t=this.parseUShort();Qe.argument(t===1,"GSUB Extension Substitution subtable identifier-format must be 1");var r=this.parseUShort(),i=new re(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:r,extension:ba[r].call(i)}};ba[8]=function(){var t=this.parseUShort();return Qe.argument(t===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),backtrackCoverage:this.parseList(re.pointer(re.coverage)),lookaheadCoverage:this.parseList(re.pointer(re.coverage)),substitutes:this.parseUShortList()}};function pb(a,t){t=t||0;var r=new re(a,t),i=r.parseVersion(1);return Qe.argument(i===1||i===1.1,"Unsupported GSUB table version."),i===1?{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(ba)}:{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(ba),variations:r.parseFeatureVariationsList()}}var fs=new Array(9);fs[1]=function(t){return t.substFormat===1?new Oe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Oe.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new Oe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Oe.Coverage(t.coverage)}].concat(Oe.ushortList("substitute",t.substitute)))};fs[2]=function(t){return Qe.assert(t.substFormat===1,"Lookup type 2 substFormat must be 1."),new Oe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Oe.Coverage(t.coverage)}].concat(Oe.tableList("seqSet",t.sequences,function(r){return new Oe.Table("sequenceSetTable",Oe.ushortList("sequence",r))})))};fs[3]=function(t){return Qe.assert(t.substFormat===1,"Lookup type 3 substFormat must be 1."),new Oe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Oe.Coverage(t.coverage)}].concat(Oe.tableList("altSet",t.alternateSets,function(r){return new Oe.Table("alternateSetTable",Oe.ushortList("alternate",r))})))};fs[4]=function(t){return Qe.assert(t.substFormat===1,"Lookup type 4 substFormat must be 1."),new Oe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Oe.Coverage(t.coverage)}].concat(Oe.tableList("ligSet",t.ligatureSets,function(r){return new Oe.Table("ligatureSetTable",Oe.tableList("ligature",r,function(i){return new Oe.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:i.ligGlyph}].concat(Oe.ushortList("component",i.components,i.components.length+1)))}))})))};fs[6]=function(t){if(t.substFormat===1){var r=new Oe.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:t.substFormat},{name:"coverage",type:"TABLE",value:new Oe.Coverage(t.coverage)}].concat(Oe.tableList("chainRuleSet",t.chainRuleSets,function(u){return new Oe.Table("chainRuleSetTable",Oe.tableList("chainRule",u,function(f){var h=Oe.ushortList("backtrackGlyph",f.backtrack,f.backtrack.length).concat(Oe.ushortList("inputGlyph",f.input,f.input.length+1)).concat(Oe.ushortList("lookaheadGlyph",f.lookahead,f.lookahead.length)).concat(Oe.ushortList("substitution",[],f.lookupRecords.length));return f.lookupRecords.forEach(function(d,g){h=h.concat({name:"sequenceIndex"+g,type:"USHORT",value:d.sequenceIndex}).concat({name:"lookupListIndex"+g,type:"USHORT",value:d.lookupListIndex})}),new Oe.Table("chainRuleTable",h)}))})));return r}else if(t.substFormat===2)Qe.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(t.substFormat===3){var i=[{name:"substFormat",type:"USHORT",value:t.substFormat}];i.push({name:"backtrackGlyphCount",type:"USHORT",value:t.backtrackCoverage.length}),t.backtrackCoverage.forEach(function(u,f){i.push({name:"backtrackCoverage"+f,type:"TABLE",value:new Oe.Coverage(u)})}),i.push({name:"inputGlyphCount",type:"USHORT",value:t.inputCoverage.length}),t.inputCoverage.forEach(function(u,f){i.push({name:"inputCoverage"+f,type:"TABLE",value:new Oe.Coverage(u)})}),i.push({name:"lookaheadGlyphCount",type:"USHORT",value:t.lookaheadCoverage.length}),t.lookaheadCoverage.forEach(function(u,f){i.push({name:"lookaheadCoverage"+f,type:"TABLE",value:new Oe.Coverage(u)})}),i.push({name:"substitutionCount",type:"USHORT",value:t.lookupRecords.length}),t.lookupRecords.forEach(function(u,f){i=i.concat({name:"sequenceIndex"+f,type:"USHORT",value:u.sequenceIndex}).concat({name:"lookupListIndex"+f,type:"USHORT",value:u.lookupListIndex})});var l=new Oe.Table("chainContextTable",i);return l}Qe.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function hb(a){return new Oe.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Oe.ScriptList(a.scripts)},{name:"features",type:"TABLE",value:new Oe.FeatureList(a.features)},{name:"lookups",type:"TABLE",value:new Oe.LookupList(a.lookups,fs)}])}var mb={parse:pb,make:hb};function gb(a,t){var r=new We.Parser(a,t),i=r.parseULong();Qe.argument(i===1,"Unsupported META table version."),r.parseULong(),r.parseULong();for(var l=r.parseULong(),u={},f=0;f<l;f++){var h=r.parseTag(),d=r.parseULong(),g=r.parseULong(),v=cs.UTF8(a,t+d,g);u[h]=v}return u}function vb(a){var t=Object.keys(a).length,r="",i=16+t*12,l=new Oe.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:t}]);for(var u in a){var f=r.length;r+=a[u],l.fields.push({name:"tag "+u,type:"TAG",value:u}),l.fields.push({name:"offset "+u,type:"ULONG",value:i+f}),l.fields.push({name:"length "+u,type:"ULONG",value:a[u].length})}return l.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),l}var yb={parse:gb,make:vb};function E0(a){return Math.log(a)/Math.log(2)|0}function Df(a){for(;a.length%4!==0;)a.push(0);for(var t=0,r=0;r<a.length;r+=4)t+=(a[r]<<24)+(a[r+1]<<16)+(a[r+2]<<8)+a[r+3];return t%=Math.pow(2,32),t}function A0(a,t,r,i){return new Oe.Record("Table Record",[{name:"tag",type:"TAG",value:a!==void 0?a:""},{name:"checkSum",type:"ULONG",value:t!==void 0?t:0},{name:"offset",type:"ULONG",value:r!==void 0?r:0},{name:"length",type:"ULONG",value:i!==void 0?i:0}])}function Mm(a){var t=new Oe.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=a,t.numTables=a.length;var r=Math.pow(2,E0(t.numTables));t.searchRange=16*r,t.entrySelector=E0(r),t.rangeShift=t.numTables*16-t.searchRange;for(var i=[],l=[],u=t.sizeOf()+A0().sizeOf()*t.numTables;u%4!==0;)u+=1,l.push({name:"padding",type:"BYTE",value:0});for(var f=0;f<a.length;f+=1){var h=a[f];Qe.argument(h.tableName.length===4,"Table name"+h.tableName+" is invalid.");var d=h.sizeOf(),g=A0(h.tableName,Df(h.encode()),u,d);for(i.push({name:g.tag+" Table Record",type:"RECORD",value:g}),l.push({name:h.tableName+" table",type:"RECORD",value:h}),u+=d,Qe.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!==0;)u+=1,l.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(v,x){return v.value.tag>x.value.tag?1:-1}),t.fields=t.fields.concat(i),t.fields=t.fields.concat(l),t}function w0(a,t,r){for(var i=0;i<t.length;i+=1){var l=a.charToGlyphIndex(t[i]);if(l>0){var u=a.glyphs.get(l);return u.getMetrics()}}return r}function bb(a){for(var t=0,r=0;r<a.length;r+=1)t+=a[r];return t/a.length}function xb(a){for(var t=[],r=[],i=[],l=[],u=[],f=[],h=[],d,g=0,v=0,x=0,y=0,E=0,S=0;S<a.glyphs.length;S+=1){var w=a.glyphs.get(S),D=w.unicode|0;if(isNaN(w.advanceWidth))throw new Error("Glyph "+w.name+" ("+S+"): advanceWidth is not a number.");(d>D||d===void 0)&&D>0&&(d=D),g<D&&(g=D);var U=S0.getUnicodeRange(D);if(U<32)v|=1<<U;else if(U<64)x|=1<<U-32;else if(U<96)y|=1<<U-64;else if(U<123)E|=1<<U-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(w.name!==".notdef"){var k=w.getMetrics();t.push(k.xMin),r.push(k.yMin),i.push(k.xMax),l.push(k.yMax),f.push(k.leftSideBearing),h.push(k.rightSideBearing),u.push(w.advanceWidth)}}var C={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,l),advanceWidthMax:Math.max.apply(null,u),advanceWidthAvg:bb(u),minLeftSideBearing:Math.min.apply(null,f),maxLeftSideBearing:Math.max.apply(null,f),minRightSideBearing:Math.min.apply(null,h)};C.ascender=a.ascender,C.descender=a.descender;var M=F1.make({flags:3,unitsPerEm:a.unitsPerEm,xMin:C.xMin,yMin:C.yMin,xMax:C.xMax,yMax:C.yMax,lowestRecPPEM:3,createdTimestamp:a.createdTimestamp}),F=G1.make({ascender:C.ascender,descender:C.descender,advanceWidthMax:C.advanceWidthMax,minLeftSideBearing:C.minLeftSideBearing,minRightSideBearing:C.minRightSideBearing,xMaxExtent:C.maxLeftSideBearing+(C.xMax-C.xMin),numberOfHMetrics:a.glyphs.length}),H=W1.make(a.glyphs.length),fe=S0.make(Object.assign({xAvgCharWidth:Math.round(C.advanceWidthAvg),usFirstCharIndex:d,usLastCharIndex:g,ulUnicodeRange1:v,ulUnicodeRange2:x,ulUnicodeRange3:y,ulUnicodeRange4:E,sTypoAscender:C.ascender,sTypoDescender:C.descender,sTypoLineGap:0,usWinAscent:C.yMax,usWinDescent:Math.abs(C.yMin),ulCodePageRange1:1,sxHeight:w0(a,"xyvw",{yMax:Math.round(C.ascender/2)}).yMax,sCapHeight:w0(a,"HIKLEFJMNTZBDPRAGOQSUVWXY",C).yMax,usDefaultChar:a.hasChar(" ")?32:0,usBreakChar:a.hasChar(" ")?32:0},a.tables.os2)),de=V1.make(a.glyphs),ce=l1.make(a.glyphs),le=a.getEnglishName("fontFamily"),Z=a.getEnglishName("fontSubfamily"),z=le+" "+Z,Q=a.getEnglishName("postScriptName");Q||(Q=le.replace(/\s/g,"")+"-"+Z);var $={};for(var W in a.names)$[W]=a.names[W];$.uniqueID||($.uniqueID={en:a.getEnglishName("manufacturer")+":"+z}),$.postScriptName||($.postScriptName={en:Q}),$.preferredFamily||($.preferredFamily=a.names.fontFamily),$.preferredSubfamily||($.preferredSubfamily=a.names.fontSubfamily);var B=[],P=sb.make($,B),V=B.length>0?Q1.make(B):void 0,pe=db.make(),R=U1.make(a.glyphs,{version:a.getEnglishName("version"),fullName:z,familyName:le,weightName:Z,postScriptName:Q,unitsPerEm:a.unitsPerEm,fontBBox:[0,C.yMin,C.ascender,C.advanceWidthMax]}),G=a.metas&&Object.keys(a.metas).length>0?yb.make(a.metas):void 0,ie=[M,F,H,fe,P,ce,pe,R,de];V&&ie.push(V),a.tables.gsub&&ie.push(mb.make(a.tables.gsub)),G&&ie.push(G);for(var ve=Mm(ie),te=ve.encode(),ge=Df(te),Ee=ve.fields,Ke=!1,ke=0;ke<Ee.length;ke+=1)if(Ee[ke].name==="head table"){Ee[ke].value.checkSumAdjustment=2981146554-ge,Ke=!0;break}if(!Ke)throw new Error("Could not find head table with checkSum to adjust.");return ve}var Sb={make:Mm,fontToTable:xb,computeCheckSum:Df};function rf(a,t){for(var r=0,i=a.length-1;r<=i;){var l=r+i>>>1,u=a[l].tag;if(u===t)return l;u<t?r=l+1:i=l-1}return-r-1}function T0(a,t){for(var r=0,i=a.length-1;r<=i;){var l=r+i>>>1,u=a[l];if(u===t)return l;u<t?r=l+1:i=l-1}return-r-1}function C0(a,t){for(var r,i=0,l=a.length-1;i<=l;){var u=i+l>>>1;r=a[u];var f=r.start;if(f===t)return r;f<t?i=u+1:l=u-1}if(i>0)return r=a[i-1],t>r.end?0:r}function El(a,t){this.font=a,this.tableName=t}El.prototype={searchTag:rf,binSearch:T0,getTable:function(a){var t=this.font.tables[this.tableName];return!t&&a&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var a=this.getTable();return a?a.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){var a=this.getTable();if(a){for(var t=!1,r=0;r<a.scripts.length;r++){var i=a.scripts[r].tag;if(i==="DFLT")return i;i==="latn"&&(t=!0)}if(t)return"latn"}},getScriptTable:function(a,t){var r=this.getTable(t);if(r){a=a||"DFLT";var i=r.scripts,l=rf(r.scripts,a);if(l>=0)return i[l].script;if(t){var u={tag:a,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-l,0,u),u.script}}},getLangSysTable:function(a,t,r){var i=this.getScriptTable(a,r);if(i){if(!t||t==="dflt"||t==="DFLT")return i.defaultLangSys;var l=rf(i.langSysRecords,t);if(l>=0)return i.langSysRecords[l].langSys;if(r){var u={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-l,0,u),u.langSys}}},getFeatureTable:function(a,t,r,i){var l=this.getLangSysTable(a,t,i);if(l){for(var u,f=l.featureIndexes,h=this.font.tables[this.tableName].features,d=0;d<f.length;d++)if(u=h[f[d]],u.tag===r)return u.feature;if(i){var g=h.length;return Qe.assert(g===0||r>=h[g-1].tag,"Features must be added in alphabetical order."),u={tag:r,feature:{params:0,lookupListIndexes:[]}},h.push(u),f.push(g),u.feature}}},getLookupTables:function(a,t,r,i,l){var u=this.getFeatureTable(a,t,r,l),f=[];if(u){for(var h,d=u.lookupListIndexes,g=this.font.tables[this.tableName].lookups,v=0;v<d.length;v++)h=g[d[v]],h.lookupType===i&&f.push(h);if(f.length===0&&l){h={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var x=g.length;return g.push(h),d.push(x),[h]}}return f},getGlyphClass:function(a,t){switch(a.format){case 1:return a.startGlyph<=t&&t<a.startGlyph+a.classes.length?a.classes[t-a.startGlyph]:0;case 2:var r=C0(a.ranges,t);return r?r.classId:0}},getCoverageIndex:function(a,t){switch(a.format){case 1:var r=T0(a.glyphs,t);return r>=0?r:-1;case 2:var i=C0(a.ranges,t);return i?i.index+t-i.start:-1}},expandCoverage:function(a){if(a.format===1)return a.glyphs;for(var t=[],r=a.ranges,i=0;i<r.length;i++)for(var l=r[i],u=l.start,f=l.end,h=u;h<=f;h++)t.push(h);return t}};function Al(a){El.call(this,a,"gpos")}Al.prototype=El.prototype;Al.prototype.init=function(){var a=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(a)};Al.prototype.getKerningValue=function(a,t,r){for(var i=0;i<a.length;i++)for(var l=a[i].subtables,u=0;u<l.length;u++){var f=l[u],h=this.getCoverageIndex(f.coverage,t);if(!(h<0))switch(f.posFormat){case 1:for(var d=f.pairSets[h],g=0;g<d.length;g++){var v=d[g];if(v.secondGlyph===r)return v.value1&&v.value1.xAdvance||0}break;case 2:var x=this.getGlyphClass(f.classDef1,t),y=this.getGlyphClass(f.classDef2,r),E=f.classRecords[x][y];return E.value1&&E.value1.xAdvance||0}}return 0};Al.prototype.getKerningTables=function(a,t){if(this.font.tables.gpos)return this.getLookupTables(a,t,"kern",2)};function In(a){El.call(this,a,"gsub")}function Eb(a,t){var r=a.length;if(r!==t.length)return!1;for(var i=0;i<r;i++)if(a[i]!==t[i])return!1;return!0}function _f(a,t,r){for(var i=a.subtables,l=0;l<i.length;l++){var u=i[l];if(u.substFormat===t)return u}if(r)return i.push(r),r}In.prototype=El.prototype;In.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};In.prototype.getSingle=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,1),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++){var d=f[h],g=this.expandCoverage(d.coverage),v=void 0;if(d.substFormat===1){var x=d.deltaGlyphId;for(v=0;v<g.length;v++){var y=g[v];i.push({sub:y,by:y+x})}}else{var E=d.substitute;for(v=0;v<g.length;v++)i.push({sub:g[v],by:E[v]})}}return i};In.prototype.getMultiple=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,2),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++){var d=f[h],g=this.expandCoverage(d.coverage),v=void 0;for(v=0;v<g.length;v++){var x=g[v],y=d.sequences[v];i.push({sub:x,by:y})}}return i};In.prototype.getAlternates=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,3),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++)for(var d=f[h],g=this.expandCoverage(d.coverage),v=d.alternateSets,x=0;x<g.length;x++)i.push({sub:g[x],by:v[x]});return i};In.prototype.getLigatures=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,4),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++)for(var d=f[h],g=this.expandCoverage(d.coverage),v=d.ligatureSets,x=0;x<g.length;x++)for(var y=g[x],E=v[x],S=0;S<E.length;S++){var w=E[S];i.push({sub:[y].concat(w.components),by:w.ligGlyph})}return i};In.prototype.addSingle=function(a,t,r,i){var l=this.getLookupTables(r,i,a,1,!0)[0],u=_f(l,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Qe.assert(u.coverage.format===1,"Single: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.substitute.splice(h,0,0)),u.substitute[h]=t.by};In.prototype.addMultiple=function(a,t,r,i){Qe.assert(t.by instanceof Array&&t.by.length>1,'Multiple: "by" must be an array of two or more ids');var l=this.getLookupTables(r,i,a,2,!0)[0],u=_f(l,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Qe.assert(u.coverage.format===1,"Multiple: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.sequences.splice(h,0,0)),u.sequences[h]=t.by};In.prototype.addAlternate=function(a,t,r,i){var l=this.getLookupTables(r,i,a,3,!0)[0],u=_f(l,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Qe.assert(u.coverage.format===1,"Alternate: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.alternateSets.splice(h,0,0)),u.alternateSets[h]=t.by};In.prototype.addLigature=function(a,t,r,i){var l=this.getLookupTables(r,i,a,4,!0)[0],u=l.subtables[0];u||(u={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},l.subtables[0]=u),Qe.assert(u.coverage.format===1,"Ligature: unable to modify coverage table format "+u.coverage.format);var f=t.sub[0],h=t.sub.slice(1),d={ligGlyph:t.by,components:h},g=this.binSearch(u.coverage.glyphs,f);if(g>=0){for(var v=u.ligatureSets[g],x=0;x<v.length;x++)if(Eb(v[x].components,h))return;v.push(d)}else g=-1-g,u.coverage.glyphs.splice(g,0,f),u.ligatureSets.splice(g,0,[d])};In.prototype.getFeature=function(a,t,r){if(/ss\d\d/.test(a))return this.getSingle(a,t,r);switch(a){case"aalt":case"salt":return this.getSingle(a,t,r).concat(this.getAlternates(a,t,r));case"dlig":case"liga":case"rlig":return this.getLigatures(a,t,r);case"ccmp":return this.getMultiple(a,t,r).concat(this.getLigatures(a,t,r));case"stch":return this.getMultiple(a,t,r)}};In.prototype.add=function(a,t,r,i){if(/ss\d\d/.test(a))return this.addSingle(a,t,r,i);switch(a){case"aalt":case"salt":return typeof t.by=="number"?this.addSingle(a,t,r,i):this.addAlternate(a,t,r,i);case"dlig":case"liga":case"rlig":return this.addLigature(a,t,r,i);case"ccmp":return t.by instanceof Array?this.addMultiple(a,t,r,i):this.addLigature(a,t,r,i)}};function Ab(){return typeof window<"u"}function wb(a){for(var t=new Buffer(a.byteLength),r=new Uint8Array(a),i=0;i<t.length;++i)t[i]=r[i];return t}function hl(a,t){if(!a)throw t}function M0(a,t,r,i,l){var u;return(t&i)>0?(u=a.parseByte(),(t&l)===0&&(u=-u),u=r+u):(t&l)>0?u=r:u=r+a.parseShort(),u}function Nm(a,t,r){var i=new We.Parser(t,r);a.numberOfContours=i.parseShort(),a._xMin=i.parseShort(),a._yMin=i.parseShort(),a._xMax=i.parseShort(),a._yMax=i.parseShort();var l,u;if(a.numberOfContours>0){for(var f=a.endPointIndices=[],h=0;h<a.numberOfContours;h+=1)f.push(i.parseUShort());a.instructionLength=i.parseUShort(),a.instructions=[];for(var d=0;d<a.instructionLength;d+=1)a.instructions.push(i.parseByte());var g=f[f.length-1]+1;l=[];for(var v=0;v<g;v+=1)if(u=i.parseByte(),l.push(u),(u&8)>0)for(var x=i.parseByte(),y=0;y<x;y+=1)l.push(u),v+=1;if(Qe.argument(l.length===g,"Bad flags."),f.length>0){var E=[],S;if(g>0){for(var w=0;w<g;w+=1)u=l[w],S={},S.onCurve=!!(u&1),S.lastPointOfContour=f.indexOf(w)>=0,E.push(S);for(var D=0,U=0;U<g;U+=1)u=l[U],S=E[U],S.x=M0(i,u,D,2,16),D=S.x;for(var k=0,C=0;C<g;C+=1)u=l[C],S=E[C],S.y=M0(i,u,k,4,32),k=S.y}a.points=E}else a.points=[]}else if(a.numberOfContours===0)a.points=[];else{a.isComposite=!0,a.points=[],a.components=[];for(var M=!0;M;){l=i.parseUShort();var F={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(l&1)>0?(l&2)>0?(F.dx=i.parseShort(),F.dy=i.parseShort()):F.matchedPoints=[i.parseUShort(),i.parseUShort()]:(l&2)>0?(F.dx=i.parseChar(),F.dy=i.parseChar()):F.matchedPoints=[i.parseByte(),i.parseByte()],(l&8)>0?F.xScale=F.yScale=i.parseF2Dot14():(l&64)>0?(F.xScale=i.parseF2Dot14(),F.yScale=i.parseF2Dot14()):(l&128)>0&&(F.xScale=i.parseF2Dot14(),F.scale01=i.parseF2Dot14(),F.scale10=i.parseF2Dot14(),F.yScale=i.parseF2Dot14()),a.components.push(F),M=!!(l&32)}if(l&256){a.instructionLength=i.parseUShort(),a.instructions=[];for(var H=0;H<a.instructionLength;H+=1)a.instructions.push(i.parseByte())}}}function sf(a,t){for(var r=[],i=0;i<a.length;i+=1){var l=a[i],u={x:t.xScale*l.x+t.scale01*l.y+t.dx,y:t.scale10*l.x+t.yScale*l.y+t.dy,onCurve:l.onCurve,lastPointOfContour:l.lastPointOfContour};r.push(u)}return r}function Tb(a){for(var t=[],r=[],i=0;i<a.length;i+=1){var l=a[i];r.push(l),l.lastPointOfContour&&(t.push(r),r=[])}return Qe.argument(r.length===0,"There are still points left in the current contour."),t}function Rm(a){var t=new Qt;if(!a)return t;for(var r=Tb(a),i=0;i<r.length;++i){var l=r[i],u=null,f=l[l.length-1],h=l[0];if(f.onCurve)t.moveTo(f.x,f.y);else if(h.onCurve)t.moveTo(h.x,h.y);else{var d={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5};t.moveTo(d.x,d.y)}for(var g=0;g<l.length;++g)if(u=f,f=h,h=l[(g+1)%l.length],f.onCurve)t.lineTo(f.x,f.y);else{var v=h;u.onCurve||((f.x+u.x)*.5,(f.y+u.y)*.5),h.onCurve||(v={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5}),t.quadraticCurveTo(f.x,f.y,v.x,v.y)}t.closePath()}return t}function Dm(a,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var i=t.components[r],l=a.get(i.glyphIndex);if(l.getPath(),l.points){var u=void 0;if(i.matchedPoints===void 0)u=sf(l.points,i);else{if(i.matchedPoints[0]>t.points.length-1||i.matchedPoints[1]>l.points.length-1)throw Error("Matched points out of range in "+t.name);var f=t.points[i.matchedPoints[0]],h=l.points[i.matchedPoints[1]],d={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};h=sf([h],d)[0],d.dx=f.x-h.x,d.dy=f.y-h.y,u=sf(l.points,d)}t.points=t.points.concat(u)}}return Rm(t.points)}function Cb(a,t,r,i){for(var l=new ja.GlyphSet(i),u=0;u<r.length-1;u+=1){var f=r[u],h=r[u+1];f!==h?l.push(u,ja.ttfGlyphLoader(i,u,Nm,a,t+f,Dm)):l.push(u,ja.glyphLoader(i,u))}return l}function Mb(a,t,r,i){var l=new ja.GlyphSet(i);return i._push=function(u){var f=r[u],h=r[u+1];f!==h?l.push(u,ja.ttfGlyphLoader(i,u,Nm,a,t+f,Dm)):l.push(u,ja.glyphLoader(i,u))},l}function Nb(a,t,r,i,l){return l.lowMemory?Mb(a,t,r,i):Cb(a,t,r,i)}var Rb={getPath:Rm,parse:Nb},_m,Ti,Om,Af;function km(a){this.font=a,this.getCommands=function(t){return Rb.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Db(a){return a}function Lm(a){return Math.sign(a)*Math.round(Math.abs(a))}function _b(a){return Math.sign(a)*Math.round(Math.abs(a*2))/2}function Ob(a){return Math.sign(a)*(Math.round(Math.abs(a)+.5)-.5)}function kb(a){return Math.sign(a)*Math.ceil(Math.abs(a))}function Lb(a){return Math.sign(a)*Math.floor(Math.abs(a))}var Um=function(a){var t=this.srPeriod,r=this.srPhase,i=this.srThreshold,l=1;return a<0&&(a=-a,l=-1),a+=i-r,a=Math.trunc(a/t)*t,a+=r,a<0?r*l:a*l},Fa={x:1,y:0,axis:"x",distance:function(a,t,r,i){return(r?a.xo:a.x)-(i?t.xo:t.x)},interpolate:function(a,t,r,i){var l,u,f,h,d,g,v;if(!i||i===this){if(l=a.xo-t.xo,u=a.xo-r.xo,d=t.x-t.xo,g=r.x-r.xo,f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){a.x=a.xo+(d+g)/2;return}a.x=a.xo+(d*h+g*f)/v;return}if(l=i.distance(a,t,!0,!0),u=i.distance(a,r,!0,!0),d=i.distance(t,t,!1,!0),g=i.distance(r,r,!1,!0),f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){Fa.setRelative(a,a,(d+g)/2,i,!0);return}Fa.setRelative(a,a,(d*h+g*f)/v,i,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(a,t,r,i,l){if(!i||i===this){a.x=(l?t.xo:t.x)+r;return}var u=l?t.xo:t.x,f=l?t.yo:t.y,h=u+r*i.x,d=f+r*i.y;a.x=h+(a.y-d)/i.normalSlope},slope:0,touch:function(a){a.xTouched=!0},touched:function(a){return a.xTouched},untouch:function(a){a.xTouched=!1}},lr={x:0,y:1,axis:"y",distance:function(a,t,r,i){return(r?a.yo:a.y)-(i?t.yo:t.y)},interpolate:function(a,t,r,i){var l,u,f,h,d,g,v;if(!i||i===this){if(l=a.yo-t.yo,u=a.yo-r.yo,d=t.y-t.yo,g=r.y-r.yo,f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){a.y=a.yo+(d+g)/2;return}a.y=a.yo+(d*h+g*f)/v;return}if(l=i.distance(a,t,!0,!0),u=i.distance(a,r,!0,!0),d=i.distance(t,t,!1,!0),g=i.distance(r,r,!1,!0),f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){lr.setRelative(a,a,(d+g)/2,i,!0);return}lr.setRelative(a,a,(d*h+g*f)/v,i,!0)},normalSlope:0,setRelative:function(a,t,r,i,l){if(!i||i===this){a.y=(l?t.yo:t.y)+r;return}var u=l?t.xo:t.x,f=l?t.yo:t.y,h=u+r*i.x,d=f+r*i.y;a.y=d+i.normalSlope*(a.x-h)},slope:Number.POSITIVE_INFINITY,touch:function(a){a.yTouched=!0},touched:function(a){return a.yTouched},untouch:function(a){a.yTouched=!1}};Object.freeze(Fa);Object.freeze(lr);function wl(a,t){this.x=a,this.y=t,this.axis=void 0,this.slope=t/a,this.normalSlope=-a/t,Object.freeze(this)}wl.prototype.distance=function(a,t,r,i){return this.x*Fa.distance(a,t,r,i)+this.y*lr.distance(a,t,r,i)};wl.prototype.interpolate=function(a,t,r,i){var l,u,f,h,d,g,v;if(f=i.distance(a,t,!0,!0),h=i.distance(a,r,!0,!0),l=i.distance(t,t,!1,!0),u=i.distance(r,r,!1,!0),d=Math.abs(f),g=Math.abs(h),v=d+g,v===0){this.setRelative(a,a,(l+u)/2,i,!0);return}this.setRelative(a,a,(l*g+u*d)/v,i,!0)};wl.prototype.setRelative=function(a,t,r,i,l){i=i||this;var u=l?t.xo:t.x,f=l?t.yo:t.y,h=u+r*i.x,d=f+r*i.y,g=i.normalSlope,v=this.slope,x=a.x,y=a.y;a.x=(v*x-g*h+d-y)/(v-g),a.y=v*(a.x-x)+y};wl.prototype.touch=function(a){a.xTouched=!0,a.yTouched=!0};function Tl(a,t){var r=Math.sqrt(a*a+t*t);return a/=r,t/=r,a===1&&t===0?Fa:a===0&&t===1?lr:new wl(a,t)}function or(a,t,r,i){this.x=this.xo=Math.round(a*64)/64,this.y=this.yo=Math.round(t*64)/64,this.lastPointOfContour=r,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}or.prototype.nextTouched=function(a){for(var t=this.nextPointOnContour;!a.touched(t)&&t!==this;)t=t.nextPointOnContour;return t};or.prototype.prevTouched=function(a){for(var t=this.prevPointOnContour;!a.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var xl=Object.freeze(new or(0,0)),Ub={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Xr(a,t){switch(this.env=a,this.stack=[],this.prog=t,a){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Fa,this.round=Lm}}km.prototype.exec=function(a,t){if(typeof t!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var r=this.font,i=this._prepState;if(!i||i.ppem!==t){var l=this._fpgmState;if(!l){Xr.prototype=Ub,l=this._fpgmState=new Xr("fpgm",r.tables.fpgm),l.funcs=[],l.font=r,exports.DEBUG&&(console.log("---EXEC FPGM---"),l.step=-1);try{Ti(l)}catch(g){console.log("Hinting error in FPGM:"+g),this._errorState=3;return}}Xr.prototype=l,i=this._prepState=new Xr("prep",r.tables.prep),i.ppem=t;var u=r.tables.cvt;if(u)for(var f=i.cvt=new Array(u.length),h=t/r.unitsPerEm,d=0;d<u.length;d++)f[d]=u[d]*h;else i.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),i.step=-1);try{Ti(i)}catch(g){this._errorState<2&&console.log("Hinting error in PREP:"+g),this._errorState=2}}if(!(this._errorState>1))try{return Om(a,i)}catch(g){this._errorState<1&&(console.log("Hinting error:"+g),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};Om=function(a,t){var r=t.ppem/t.font.unitsPerEm,i=r,l=a.components,u,f,h;if(Xr.prototype=t,!l)h=new Xr("glyf",a.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),h.step=-1),Af(a,h,r,i),f=h.gZone;else{var d=t.font;f=[],u=[];for(var g=0;g<l.length;g++){var v=l[g],x=d.glyphs.get(v.glyphIndex);h=new Xr("glyf",x.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+g+"---"),h.step=-1),Af(x,h,r,i);for(var y=Math.round(v.dx*r),E=Math.round(v.dy*i),S=h.gZone,w=h.contours,D=0;D<S.length;D++){var U=S[D];U.xTouched=U.yTouched=!1,U.xo=U.x=U.x+y,U.yo=U.y=U.y+E}var k=f.length;f.push.apply(f,S);for(var C=0;C<w.length;C++)u.push(w[C]+k)}a.instructions&&!h.inhibitGridFit&&(h=new Xr("glyf",a.instructions),h.gZone=h.z0=h.z1=h.z2=f,h.contours=u,f.push(new or(0,0),new or(Math.round(a.advanceWidth*r),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),h.step=-1),Ti(h),f.length-=2)}return f};Af=function(a,t,r,i){for(var l=a.points||[],u=l.length,f=t.gZone=t.z0=t.z1=t.z2=[],h=t.contours=[],d,g=0;g<u;g++)d=l[g],f[g]=new or(d.x*r,d.y*i,d.lastPointOfContour,d.onCurve);for(var v,x,y=0;y<u;y++)d=f[y],v||(v=d,h.push(y)),d.lastPointOfContour?(d.nextPointOnContour=v,v.prevPointOnContour=d,v=void 0):(x=f[y+1],d.nextPointOnContour=x,x.prevPointOnContour=d);if(!t.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(var E=0;E<u;E++)console.log(E,f[E].x,f[E].y)}if(f.push(new or(0,0),new or(Math.round(a.advanceWidth*r),0)),Ti(t),f.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",t.stack);for(var S=0;S<u;S++)console.log(S,f[S].x,f[S].y)}}};Ti=function(a){var t=a.prog;if(t){var r=t.length,i;for(a.ip=0;a.ip<r;a.ip++){if(exports.DEBUG&&a.step++,i=_m[t[a.ip]],!i)throw new Error("unknown instruction: 0x"+Number(t[a.ip]).toString(16));i(a)}}};function eu(a){for(var t=a.tZone=new Array(a.gZone.length),r=0;r<t.length;r++)t[r]=new or(0,0)}function Im(a,t){var r=a.prog,i=a.ip,l=1,u;do if(u=r[++i],u===88)l++;else if(u===89)l--;else if(u===64)i+=r[i+1]+1;else if(u===65)i+=2*r[i+1]+1;else if(u>=176&&u<=183)i+=u-176+1;else if(u>=184&&u<=191)i+=(u-184+1)*2;else if(t&&l===1&&u===27)break;while(l>0);a.ip=i}function N0(a,t){exports.DEBUG&&console.log(t.step,"SVTCA["+a.axis+"]"),t.fv=t.pv=t.dpv=a}function R0(a,t){exports.DEBUG&&console.log(t.step,"SPVTCA["+a.axis+"]"),t.pv=t.dpv=a}function D0(a,t){exports.DEBUG&&console.log(t.step,"SFVTCA["+a.axis+"]"),t.fv=a}function _0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z2[i],f=t.z1[l];exports.DEBUG&&console.log("SPVTL["+a+"]",i,l);var h,d;a?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.pv=t.dpv=Tl(h,d)}function O0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z2[i],f=t.z1[l];exports.DEBUG&&console.log("SFVTL["+a+"]",i,l);var h,d;a?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.fv=Tl(h,d)}function Ib(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SPVFS[]",r,i),a.pv=a.dpv=Tl(i,r)}function Bb(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SPVFS[]",r,i),a.fv=Tl(i,r)}function Fb(a){var t=a.stack,r=a.pv;exports.DEBUG&&console.log(a.step,"GPV[]"),t.push(r.x*16384),t.push(r.y*16384)}function jb(a){var t=a.stack,r=a.fv;exports.DEBUG&&console.log(a.step,"GFV[]"),t.push(r.x*16384),t.push(r.y*16384)}function Pb(a){a.fv=a.pv,exports.DEBUG&&console.log(a.step,"SFVTPV[]")}function Gb(a){var t=a.stack,r=t.pop(),i=t.pop(),l=t.pop(),u=t.pop(),f=t.pop(),h=a.z0,d=a.z1,g=h[r],v=h[i],x=d[l],y=d[u],E=a.z2[f];exports.DEBUG&&console.log("ISECT[], ",r,i,l,u,f);var S=g.x,w=g.y,D=v.x,U=v.y,k=x.x,C=x.y,M=y.x,F=y.y,H=(S-D)*(C-F)-(w-U)*(k-M),fe=S*U-w*D,de=k*F-C*M;E.x=(fe*(k-M)-de*(S-D))/H,E.y=(fe*(C-F)-de*(w-U))/H}function zb(a){a.rp0=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP0[]",a.rp0)}function Hb(a){a.rp1=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP1[]",a.rp1)}function Yb(a){a.rp2=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP2[]",a.rp2)}function qb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP0[]",t),a.zp0=t,t){case 0:a.tZone||eu(a),a.z0=a.tZone;break;case 1:a.z0=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Vb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP1[]",t),a.zp1=t,t){case 0:a.tZone||eu(a),a.z1=a.tZone;break;case 1:a.z1=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Xb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP2[]",t),a.zp2=t,t){case 0:a.tZone||eu(a),a.z2=a.tZone;break;case 1:a.z2=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Zb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZPS[]",t),a.zp0=a.zp1=a.zp2=t,t){case 0:a.tZone||eu(a),a.z0=a.z1=a.z2=a.tZone;break;case 1:a.z0=a.z1=a.z2=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Qb(a){a.loop=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SLOOP[]",a.loop)}function $b(a){exports.DEBUG&&console.log(a.step,"RTG[]"),a.round=Lm}function Kb(a){exports.DEBUG&&console.log(a.step,"RTHG[]"),a.round=Ob}function Wb(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SMD[]",t),a.minDis=t/64}function Jb(a){exports.DEBUG&&console.log(a.step,"ELSE[]"),Im(a,!1)}function ex(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"JMPR[]",t),a.ip+=t-1}function tx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCVTCI[]",t),a.cvCutIn=t/64}function nx(a){var t=a.stack;exports.DEBUG&&console.log(a.step,"DUP[]"),t.push(t[t.length-1])}function lf(a){exports.DEBUG&&console.log(a.step,"POP[]"),a.stack.pop()}function ax(a){exports.DEBUG&&console.log(a.step,"CLEAR[]"),a.stack.length=0}function rx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SWAP[]"),t.push(r),t.push(i)}function ix(a){var t=a.stack;exports.DEBUG&&console.log(a.step,"DEPTH[]"),t.push(t.length)}function sx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"LOOPCALL[]",r,i);var l=a.ip,u=a.prog;a.prog=a.funcs[r];for(var f=0;f<i;f++)Ti(a),exports.DEBUG&&console.log(++a.step,f+1<i?"next loopcall":"done loopcall",f);a.ip=l,a.prog=u}function lx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"CALL[]",t);var r=a.ip,i=a.prog;a.prog=a.funcs[t],Ti(a),a.ip=r,a.prog=i,exports.DEBUG&&console.log(++a.step,"returning from",t)}function ox(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"CINDEX[]",r),t.push(t[t.length-r])}function ux(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"MINDEX[]",r),t.push(t.splice(t.length-r,1)[0])}function cx(a){if(a.env!=="fpgm")throw new Error("FDEF not allowed here");var t=a.stack,r=a.prog,i=a.ip,l=t.pop(),u=i;for(exports.DEBUG&&console.log(a.step,"FDEF[]",l);r[++i]!==45;);a.ip=i,a.funcs[l]=r.slice(u+1,i)}function k0(a,t){var r=t.stack.pop(),i=t.z0[r],l=t.fv,u=t.pv;exports.DEBUG&&console.log(t.step,"MDAP["+a+"]",r);var f=u.distance(i,xl);a&&(f=t.round(f)),l.setRelative(i,xl,f,u),l.touch(i),t.rp0=t.rp1=r}function L0(a,t){var r=t.z2,i=r.length-2,l,u,f;exports.DEBUG&&console.log(t.step,"IUP["+a.axis+"]");for(var h=0;h<i;h++)l=r[h],!a.touched(l)&&(u=l.prevTouched(a),u!==l&&(f=l.nextTouched(a),u===f&&a.setRelative(l,l,a.distance(u,u,!1,!0),a,!0),a.interpolate(l,u,f,a)))}function U0(a,t){for(var r=t.stack,i=a?t.rp1:t.rp2,l=(a?t.z0:t.z1)[i],u=t.fv,f=t.pv,h=t.loop,d=t.z2;h--;){var g=r.pop(),v=d[g],x=f.distance(l,l,!1,!0);u.setRelative(v,v,x,f),u.touch(v),exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-h)+": ":"")+"SHP["+(a?"rp1":"rp2")+"]",g)}t.loop=1}function I0(a,t){var r=t.stack,i=a?t.rp1:t.rp2,l=(a?t.z0:t.z1)[i],u=t.fv,f=t.pv,h=r.pop(),d=t.z2[t.contours[h]],g=d;exports.DEBUG&&console.log(t.step,"SHC["+a+"]",h);var v=f.distance(l,l,!1,!0);do g!==l&&u.setRelative(g,g,v,f),g=g.nextPointOnContour;while(g!==d)}function B0(a,t){var r=t.stack,i=a?t.rp1:t.rp2,l=(a?t.z0:t.z1)[i],u=t.fv,f=t.pv,h=r.pop();exports.DEBUG&&console.log(t.step,"SHZ["+a+"]",h);var d;switch(h){case 0:d=t.tZone;break;case 1:d=t.gZone;break;default:throw new Error("Invalid zone")}for(var g,v=f.distance(l,l,!1,!0),x=d.length-2,y=0;y<x;y++)g=d[y],u.setRelative(g,g,v,f)}function fx(a){for(var t=a.stack,r=a.loop,i=a.fv,l=t.pop()/64,u=a.z2;r--;){var f=t.pop(),h=u[f];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-r)+": ":"")+"SHPIX[]",f,l),i.setRelative(h,h,l),i.touch(h)}a.loop=1}function dx(a){for(var t=a.stack,r=a.rp1,i=a.rp2,l=a.loop,u=a.z0[r],f=a.z1[i],h=a.fv,d=a.dpv,g=a.z2;l--;){var v=t.pop(),x=g[v];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-l)+": ":"")+"IP[]",v,r,"<->",i),h.interpolate(x,u,f,d),h.touch(x)}a.loop=1}function F0(a,t){var r=t.stack,i=r.pop()/64,l=r.pop(),u=t.z1[l],f=t.z0[t.rp0],h=t.fv,d=t.pv;h.setRelative(u,f,i,d),h.touch(u),exports.DEBUG&&console.log(t.step,"MSIRP["+a+"]",i,l),t.rp1=t.rp0,t.rp2=l,a&&(t.rp0=l)}function px(a){for(var t=a.stack,r=a.rp0,i=a.z0[r],l=a.loop,u=a.fv,f=a.pv,h=a.z1;l--;){var d=t.pop(),g=h[d];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-l)+": ":"")+"ALIGNRP[]",d),u.setRelative(g,i,0,f),u.touch(g)}a.loop=1}function hx(a){exports.DEBUG&&console.log(a.step,"RTDG[]"),a.round=_b}function j0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z0[l],f=t.fv,h=t.pv,d=t.cvt[i];exports.DEBUG&&console.log(t.step,"MIAP["+a+"]",i,"(",d,")",l);var g=h.distance(u,xl);a&&(Math.abs(g-d)<t.cvCutIn&&(g=d),g=t.round(g)),f.setRelative(u,xl,g,h),t.zp0===0&&(u.xo=u.x,u.yo=u.y),f.touch(u),t.rp0=t.rp1=l}function mx(a){var t=a.prog,r=a.ip,i=a.stack,l=t[++r];exports.DEBUG&&console.log(a.step,"NPUSHB[]",l);for(var u=0;u<l;u++)i.push(t[++r]);a.ip=r}function gx(a){var t=a.ip,r=a.prog,i=a.stack,l=r[++t];exports.DEBUG&&console.log(a.step,"NPUSHW[]",l);for(var u=0;u<l;u++){var f=r[++t]<<8|r[++t];f&32768&&(f=-((f^65535)+1)),i.push(f)}a.ip=t}function vx(a){var t=a.stack,r=a.store;r||(r=a.store=[]);var i=t.pop(),l=t.pop();exports.DEBUG&&console.log(a.step,"WS",i,l),r[l]=i}function yx(a){var t=a.stack,r=a.store,i=t.pop();exports.DEBUG&&console.log(a.step,"RS",i);var l=r&&r[i]||0;t.push(l)}function bx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"WCVTP",r,i),a.cvt[i]=r/64}function xx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"RCVT",r),t.push(a.cvt[r]*64)}function P0(a,t){var r=t.stack,i=r.pop(),l=t.z2[i];exports.DEBUG&&console.log(t.step,"GC["+a+"]",i),r.push(t.dpv.distance(l,xl,a,!1)*64)}function G0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z1[i],f=t.z0[l],h=t.dpv.distance(f,u,a,a);exports.DEBUG&&console.log(t.step,"MD["+a+"]",i,l,"->",h),t.stack.push(Math.round(h*64))}function Sx(a){exports.DEBUG&&console.log(a.step,"MPPEM[]"),a.stack.push(a.ppem)}function Ex(a){exports.DEBUG&&console.log(a.step,"FLIPON[]"),a.autoFlip=!0}function Ax(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"LT[]",r,i),t.push(i<r?1:0)}function wx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"LTEQ[]",r,i),t.push(i<=r?1:0)}function Tx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"GT[]",r,i),t.push(i>r?1:0)}function Cx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"GTEQ[]",r,i),t.push(i>=r?1:0)}function Mx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"EQ[]",r,i),t.push(r===i?1:0)}function Nx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"NEQ[]",r,i),t.push(r!==i?1:0)}function Rx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"ODD[]",r),t.push(Math.trunc(r)%2?1:0)}function Dx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"EVEN[]",r),t.push(Math.trunc(r)%2?0:1)}function _x(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"IF[]",t),t||(Im(a,!0),exports.DEBUG&&console.log(a.step,"EIF[]"))}function Ox(a){exports.DEBUG&&console.log(a.step,"EIF[]")}function kx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"AND[]",r,i),t.push(r&&i?1:0)}function Lx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"OR[]",r,i),t.push(r||i?1:0)}function Ux(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"NOT[]",r),t.push(r?0:1)}function of(a,t){var r=t.stack,i=r.pop(),l=t.fv,u=t.pv,f=t.ppem,h=t.deltaBase+(a-1)*16,d=t.deltaShift,g=t.z0;exports.DEBUG&&console.log(t.step,"DELTAP["+a+"]",i,r);for(var v=0;v<i;v++){var x=r.pop(),y=r.pop(),E=h+((y&240)>>4);if(E===f){var S=(y&15)-8;S>=0&&S++,exports.DEBUG&&console.log(t.step,"DELTAPFIX",x,"by",S*d);var w=g[x];l.setRelative(w,w,S*d,u)}}}function Ix(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"SDB[]",r),a.deltaBase=r}function Bx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"SDS[]",r),a.deltaShift=Math.pow(.5,r)}function Fx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"ADD[]",r,i),t.push(i+r)}function jx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SUB[]",r,i),t.push(i-r)}function Px(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"DIV[]",r,i),t.push(i*64/r)}function Gx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"MUL[]",r,i),t.push(i*r/64)}function zx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"ABS[]",r),t.push(Math.abs(r))}function Hx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"NEG[]",r),t.push(-r)}function Yx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"FLOOR[]",r),t.push(Math.floor(r/64)*64)}function qx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"CEILING[]",r),t.push(Math.ceil(r/64)*64)}function Go(a,t){var r=t.stack,i=r.pop();exports.DEBUG&&console.log(t.step,"ROUND[]"),r.push(t.round(i/64)*64)}function Vx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"WCVTF[]",r,i),a.cvt[i]=r*a.ppem/a.font.unitsPerEm}function uf(a,t){var r=t.stack,i=r.pop(),l=t.ppem,u=t.deltaBase+(a-1)*16,f=t.deltaShift;exports.DEBUG&&console.log(t.step,"DELTAC["+a+"]",i,r);for(var h=0;h<i;h++){var d=r.pop(),g=r.pop(),v=u+((g&240)>>4);if(v===l){var x=(g&15)-8;x>=0&&x++;var y=x*f;exports.DEBUG&&console.log(t.step,"DELTACFIX",d,"by",y),t.cvt[d]+=y}}}function Xx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SROUND[]",t),a.round=Um;var r;switch(t&192){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(a.srPeriod=r,t&48){case 0:a.srPhase=0;break;case 16:a.srPhase=.25*r;break;case 32:a.srPhase=.5*r;break;case 48:a.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}t&=15,t===0?a.srThreshold=0:a.srThreshold=(t/8-.5)*r}function Zx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"S45ROUND[]",t),a.round=Um;var r;switch(t&192){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(a.srPeriod=r,t&48){case 0:a.srPhase=0;break;case 16:a.srPhase=.25*r;break;case 32:a.srPhase=.5*r;break;case 48:a.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}t&=15,t===0?a.srThreshold=0:a.srThreshold=(t/8-.5)*r}function Qx(a){exports.DEBUG&&console.log(a.step,"ROFF[]"),a.round=Db}function $x(a){exports.DEBUG&&console.log(a.step,"RUTG[]"),a.round=kb}function Kx(a){exports.DEBUG&&console.log(a.step,"RDTG[]"),a.round=Lb}function Wx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCANCTRL[]",t)}function z0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z2[i],f=t.z1[l];exports.DEBUG&&console.log(t.step,"SDPVTL["+a+"]",i,l);var h,d;a?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.dpv=Tl(h,d)}function Jx(a){var t=a.stack,r=t.pop(),i=0;exports.DEBUG&&console.log(a.step,"GETINFO[]",r),r&1&&(i=35),r&32&&(i|=4096),t.push(i)}function eS(a){var t=a.stack,r=t.pop(),i=t.pop(),l=t.pop();exports.DEBUG&&console.log(a.step,"ROLL[]"),t.push(i),t.push(r),t.push(l)}function tS(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"MAX[]",r,i),t.push(Math.max(i,r))}function nS(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"MIN[]",r,i),t.push(Math.min(i,r))}function aS(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCANTYPE[]",t)}function rS(a){var t=a.stack.pop(),r=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"INSTCTRL[]",t,r),t){case 1:a.inhibitGridFit=!!r;return;case 2:a.ignoreCvt=!!r;return;default:throw new Error("invalid INSTCTRL[] selector")}}function Yr(a,t){var r=t.stack,i=t.prog,l=t.ip;exports.DEBUG&&console.log(t.step,"PUSHB["+a+"]");for(var u=0;u<a;u++)r.push(i[++l]);t.ip=l}function qr(a,t){var r=t.ip,i=t.prog,l=t.stack;exports.DEBUG&&console.log(t.ip,"PUSHW["+a+"]");for(var u=0;u<a;u++){var f=i[++r]<<8|i[++r];f&32768&&(f=-((f^65535)+1)),l.push(f)}t.ip=r}function _e(a,t,r,i,l,u){var f=u.stack,h=a&&f.pop(),d=f.pop(),g=u.rp0,v=u.z0[g],x=u.z1[d],y=u.minDis,E=u.fv,S=u.dpv,w,D,U,k;D=w=S.distance(x,v,!0,!0),U=D>=0?1:-1,D=Math.abs(D),a&&(k=u.cvt[h],i&&Math.abs(D-k)<u.cvCutIn&&(D=k)),r&&D<y&&(D=y),i&&(D=u.round(D)),E.setRelative(x,v,U*D,S),E.touch(x),exports.DEBUG&&console.log(u.step,(a?"MIRP[":"MDRP[")+(t?"M":"m")+(r?">":"_")+(i?"R":"_")+(l===0?"Gr":l===1?"Bl":l===2?"Wh":"")+"]",a?h+"("+u.cvt[h]+","+k+")":"",d,"(d =",w,"->",U*D,")"),u.rp1=u.rp0,u.rp2=d,t&&(u.rp0=d)}_m=[N0.bind(void 0,lr),N0.bind(void 0,Fa),R0.bind(void 0,lr),R0.bind(void 0,Fa),D0.bind(void 0,lr),D0.bind(void 0,Fa),_0.bind(void 0,0),_0.bind(void 0,1),O0.bind(void 0,0),O0.bind(void 0,1),Ib,Bb,Fb,jb,Pb,Gb,zb,Hb,Yb,qb,Vb,Xb,Zb,Qb,$b,Kb,Wb,Jb,ex,tx,void 0,void 0,nx,lf,ax,rx,ix,ox,ux,void 0,void 0,void 0,sx,lx,cx,void 0,k0.bind(void 0,0),k0.bind(void 0,1),L0.bind(void 0,lr),L0.bind(void 0,Fa),U0.bind(void 0,0),U0.bind(void 0,1),I0.bind(void 0,0),I0.bind(void 0,1),B0.bind(void 0,0),B0.bind(void 0,1),fx,dx,F0.bind(void 0,0),F0.bind(void 0,1),px,hx,j0.bind(void 0,0),j0.bind(void 0,1),mx,gx,vx,yx,bx,xx,P0.bind(void 0,0),P0.bind(void 0,1),void 0,G0.bind(void 0,0),G0.bind(void 0,1),Sx,void 0,Ex,void 0,void 0,Ax,wx,Tx,Cx,Mx,Nx,Rx,Dx,_x,Ox,kx,Lx,Ux,of.bind(void 0,1),Ix,Bx,Fx,jx,Px,Gx,zx,Hx,Yx,qx,Go.bind(void 0,0),Go.bind(void 0,1),Go.bind(void 0,2),Go.bind(void 0,3),void 0,void 0,void 0,void 0,Vx,of.bind(void 0,2),of.bind(void 0,3),uf.bind(void 0,1),uf.bind(void 0,2),uf.bind(void 0,3),Xx,Zx,void 0,void 0,Qx,void 0,$x,Kx,lf,lf,void 0,void 0,void 0,void 0,void 0,Wx,z0.bind(void 0,0),z0.bind(void 0,1),Jx,void 0,eS,tS,nS,aS,rS,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Yr.bind(void 0,1),Yr.bind(void 0,2),Yr.bind(void 0,3),Yr.bind(void 0,4),Yr.bind(void 0,5),Yr.bind(void 0,6),Yr.bind(void 0,7),Yr.bind(void 0,8),qr.bind(void 0,1),qr.bind(void 0,2),qr.bind(void 0,3),qr.bind(void 0,4),qr.bind(void 0,5),qr.bind(void 0,6),qr.bind(void 0,7),qr.bind(void 0,8),_e.bind(void 0,0,0,0,0,0),_e.bind(void 0,0,0,0,0,1),_e.bind(void 0,0,0,0,0,2),_e.bind(void 0,0,0,0,0,3),_e.bind(void 0,0,0,0,1,0),_e.bind(void 0,0,0,0,1,1),_e.bind(void 0,0,0,0,1,2),_e.bind(void 0,0,0,0,1,3),_e.bind(void 0,0,0,1,0,0),_e.bind(void 0,0,0,1,0,1),_e.bind(void 0,0,0,1,0,2),_e.bind(void 0,0,0,1,0,3),_e.bind(void 0,0,0,1,1,0),_e.bind(void 0,0,0,1,1,1),_e.bind(void 0,0,0,1,1,2),_e.bind(void 0,0,0,1,1,3),_e.bind(void 0,0,1,0,0,0),_e.bind(void 0,0,1,0,0,1),_e.bind(void 0,0,1,0,0,2),_e.bind(void 0,0,1,0,0,3),_e.bind(void 0,0,1,0,1,0),_e.bind(void 0,0,1,0,1,1),_e.bind(void 0,0,1,0,1,2),_e.bind(void 0,0,1,0,1,3),_e.bind(void 0,0,1,1,0,0),_e.bind(void 0,0,1,1,0,1),_e.bind(void 0,0,1,1,0,2),_e.bind(void 0,0,1,1,0,3),_e.bind(void 0,0,1,1,1,0),_e.bind(void 0,0,1,1,1,1),_e.bind(void 0,0,1,1,1,2),_e.bind(void 0,0,1,1,1,3),_e.bind(void 0,1,0,0,0,0),_e.bind(void 0,1,0,0,0,1),_e.bind(void 0,1,0,0,0,2),_e.bind(void 0,1,0,0,0,3),_e.bind(void 0,1,0,0,1,0),_e.bind(void 0,1,0,0,1,1),_e.bind(void 0,1,0,0,1,2),_e.bind(void 0,1,0,0,1,3),_e.bind(void 0,1,0,1,0,0),_e.bind(void 0,1,0,1,0,1),_e.bind(void 0,1,0,1,0,2),_e.bind(void 0,1,0,1,0,3),_e.bind(void 0,1,0,1,1,0),_e.bind(void 0,1,0,1,1,1),_e.bind(void 0,1,0,1,1,2),_e.bind(void 0,1,0,1,1,3),_e.bind(void 0,1,1,0,0,0),_e.bind(void 0,1,1,0,0,1),_e.bind(void 0,1,1,0,0,2),_e.bind(void 0,1,1,0,0,3),_e.bind(void 0,1,1,0,1,0),_e.bind(void 0,1,1,0,1,1),_e.bind(void 0,1,1,0,1,2),_e.bind(void 0,1,1,0,1,3),_e.bind(void 0,1,1,1,0,0),_e.bind(void 0,1,1,1,0,1),_e.bind(void 0,1,1,1,0,2),_e.bind(void 0,1,1,1,0,3),_e.bind(void 0,1,1,1,1,0),_e.bind(void 0,1,1,1,1,1),_e.bind(void 0,1,1,1,1,2),_e.bind(void 0,1,1,1,1,3)];function ds(a){this.char=a,this.state={},this.activeState=null}function Of(a,t,r){this.contextName=r,this.startIndex=a,this.endOffset=t}function iS(a,t,r){this.contextName=a,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=r}function xa(a,t){this.context=a,this.index=t,this.length=a.length,this.current=a[t],this.backtrack=a.slice(0,t),this.lookahead=a.slice(t+1)}function tu(a){this.eventId=a,this.subscribers=[]}function sS(a){var t=this,r=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];r.forEach(function(l){Object.defineProperty(t.events,l,{value:new tu(l)})}),a&&r.forEach(function(l){var u=a[l];typeof u=="function"&&t.events[l].subscribe(u)});var i=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];i.forEach(function(l){t.events[l].subscribe(t.updateContextsRanges)})}function It(a){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],sS.call(this,a)}ds.prototype.setState=function(a,t){return this.state[a]=t,this.activeState={key:a,value:this.state[a]},this.activeState};ds.prototype.getState=function(a){return this.state[a]||null};It.prototype.inboundIndex=function(a){return a>=0&&a<this.tokens.length};It.prototype.composeRUD=function(a){var t=this,r=!0,i=a.map(function(u){return t[u[0]].apply(t,u.slice(1).concat(r))}),l=function(u){return typeof u=="object"&&u.hasOwnProperty("FAIL")};if(i.every(l))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:i.filter(l)};this.dispatch("composeRUD",[i.filter(function(u){return!l(u)})])};It.prototype.replaceRange=function(a,t,r,i){t=t!==null?t:this.tokens.length;var l=r.every(function(f){return f instanceof ds});if(!isNaN(a)&&this.inboundIndex(a)&&l){var u=this.tokens.splice.apply(this.tokens,[a,t].concat(r));return i||this.dispatch("replaceToken",[a,t,r]),[u,r]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};It.prototype.replaceToken=function(a,t,r){if(!isNaN(a)&&this.inboundIndex(a)&&t instanceof ds){var i=this.tokens.splice(a,1,t);return r||this.dispatch("replaceToken",[a,t]),[i[0],t]}else return{FAIL:"replaceToken: invalid token or index."}};It.prototype.removeRange=function(a,t,r){t=isNaN(t)?this.tokens.length:t;var i=this.tokens.splice(a,t);return r||this.dispatch("removeRange",[i,a,t]),i};It.prototype.removeToken=function(a,t){if(!isNaN(a)&&this.inboundIndex(a)){var r=this.tokens.splice(a,1);return t||this.dispatch("removeToken",[r,a]),r}else return{FAIL:"removeToken: invalid token index."}};It.prototype.insertToken=function(a,t,r){var i=a.every(function(l){return l instanceof ds});return i?(this.tokens.splice.apply(this.tokens,[t,0].concat(a)),r||this.dispatch("insertToken",[a,t]),a):{FAIL:"insertToken: invalid token(s)."}};It.prototype.registerModifier=function(a,t,r){this.events.newToken.subscribe(function(i,l){var u=[i,l],f=t===null||t.apply(this,u)===!0,h=[i,l];if(f){var d=r.apply(this,h);i.setState(a,d)}}),this.registeredModifiers.push(a)};tu.prototype.subscribe=function(a){return typeof a=="function"?this.subscribers.push(a)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};tu.prototype.unsubscribe=function(a){this.subscribers.splice(a,1)};xa.prototype.setCurrentIndex=function(a){this.index=a,this.current=this.context[a],this.backtrack=this.context.slice(0,a),this.lookahead=this.context.slice(a+1)};xa.prototype.get=function(a){switch(!0){case a===0:return this.current;case(a<0&&Math.abs(a)<=this.backtrack.length):return this.backtrack.slice(a)[0];case(a>0&&a<=this.lookahead.length):return this.lookahead[a-1];default:return null}};It.prototype.rangeToText=function(a){if(a instanceof Of)return this.getRangeTokens(a).map(function(t){return t.char}).join("")};It.prototype.getText=function(){return this.tokens.map(function(a){return a.char}).join("")};It.prototype.getContext=function(a){var t=this.registeredContexts[a];return t||null};It.prototype.on=function(a,t){var r=this.events[a];return r?r.subscribe(t):null};It.prototype.dispatch=function(a,t){var r=this,i=this.events[a];i instanceof tu&&i.subscribers.forEach(function(l){l.apply(r,t||[])})};It.prototype.registerContextChecker=function(a,t,r){if(this.getContext(a))return{FAIL:"context name '"+a+"' is already registered."};if(typeof t!="function")return{FAIL:"missing context start check."};if(typeof r!="function")return{FAIL:"missing context end check."};var i=new iS(a,t,r);return this.registeredContexts[a]=i,this.contextCheckers.push(i),i};It.prototype.getRangeTokens=function(a){var t=a.startIndex+a.endOffset;return[].concat(this.tokens.slice(a.startIndex,t))};It.prototype.getContextRanges=function(a){var t=this.getContext(a);return t?t.ranges:{FAIL:"context checker '"+a+"' is not registered."}};It.prototype.resetContextsRanges=function(){var a=this.registeredContexts;for(var t in a)if(a.hasOwnProperty(t)){var r=a[t];r.ranges=[]}};It.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var a=this.tokens.map(function(i){return i.char}),t=0;t<a.length;t++){var r=new xa(a,t);this.runContextCheck(r)}this.dispatch("updateContextsRanges",[this.registeredContexts])};It.prototype.setEndOffset=function(a,t){var r=this.getContext(t).openRange.startIndex,i=new Of(r,a,t),l=this.getContext(t).ranges;return i.rangeId=t+"."+l.length,l.push(i),this.getContext(t).openRange=null,i};It.prototype.runContextCheck=function(a){var t=this,r=a.index;this.contextCheckers.forEach(function(i){var l=i.contextName,u=t.getContext(l).openRange;if(!u&&i.checkStart(a)&&(u=new Of(r,null,l),t.getContext(l).openRange=u,t.dispatch("contextStart",[l,r])),u&&i.checkEnd(a)){var f=r-u.startIndex+1,h=t.setEndOffset(f,l);t.dispatch("contextEnd",[l,h])}})};It.prototype.tokenize=function(a){this.tokens=[],this.resetContextsRanges();var t=Array.from(a);this.dispatch("start");for(var r=0;r<t.length;r++){var i=t[r],l=new xa(t,r);this.dispatch("next",[l]),this.runContextCheck(l);var u=new ds(i);this.tokens.push(u),this.dispatch("newToken",[u,l])}return this.dispatch("end",[this.tokens]),this.tokens};function Zr(a){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(a)}function Bm(a){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(a)}function Qr(a){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(a)}function qo(a){return/[A-z]/.test(a)}function lS(a){return/\s/.test(a)}function Bn(a){this.font=a,this.features={}}function wi(a){this.id=a.id,this.tag=a.tag,this.substitution=a.substitution}function Cl(a,t){if(!a)return-1;switch(t.format){case 1:return t.glyphs.indexOf(a);case 2:for(var r=t.ranges,i=0;i<r.length;i++){var l=r[i];if(a>=l.start&&a<=l.end){var u=a-l.start;return l.index+u}}break;default:return-1}return-1}function oS(a,t){var r=Cl(a,t.coverage);return r===-1?null:a+t.deltaGlyphId}function uS(a,t){var r=Cl(a,t.coverage);return r===-1?null:t.substitute[r]}function cf(a,t){for(var r=[],i=0;i<a.length;i++){var l=a[i],u=t.current;u=Array.isArray(u)?u[0]:u;var f=Cl(u,l);f!==-1&&r.push(f)}return r.length!==a.length?-1:r}function cS(a,t){var r=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(a.context.length<r)return[];var i=cf(t.inputCoverage,a);if(i===-1)return[];var l=t.inputCoverage.length-1;if(a.lookahead.length<t.lookaheadCoverage.length)return[];for(var u=a.lookahead.slice(l);u.length&&Qr(u[0].char);)u.shift();var f=new xa(u,0),h=cf(t.lookaheadCoverage,f),d=[].concat(a.backtrack);for(d.reverse();d.length&&Qr(d[0].char);)d.shift();if(d.length<t.backtrackCoverage.length)return[];var g=new xa(d,0),v=cf(t.backtrackCoverage,g),x=i.length===t.inputCoverage.length&&h.length===t.lookaheadCoverage.length&&v.length===t.backtrackCoverage.length,y=[];if(x)for(var E=0;E<t.lookupRecords.length;E++)for(var S=t.lookupRecords[E],w=S.lookupListIndex,D=this.getLookupByIndex(w),U=0;U<D.subtables.length;U++){var k=D.subtables[U],C=this.getLookupMethod(D,k),M=this.getSubstitutionType(D,k);if(M==="12")for(var F=0;F<i.length;F++){var H=a.get(F),fe=C(H);fe&&y.push(fe)}}return y}function fS(a,t){var r=a.current,i=Cl(r,t.coverage);if(i===-1)return null;for(var l,u=t.ligatureSets[i],f=0;f<u.length;f++){l=u[f];for(var h=0;h<l.components.length;h++){var d=a.lookahead[h],g=l.components[h];if(d!==g)break;if(h===l.components.length-1)return l}}return null}function dS(a,t){var r=Cl(a,t.coverage);return r===-1?null:t.sequences[r]}Bn.prototype.getDefaultScriptFeaturesIndexes=function(){for(var a=this.font.tables.gsub.scripts,t=0;t<a.length;t++){var r=a[t];if(r.tag==="DFLT")return r.script.defaultLangSys.featureIndexes}return[]};Bn.prototype.getScriptFeaturesIndexes=function(a){var t=this.font.tables;if(!t.gsub)return[];if(!a)return this.getDefaultScriptFeaturesIndexes();for(var r=this.font.tables.gsub.scripts,i=0;i<r.length;i++){var l=r[i];if(l.tag===a&&l.script.defaultLangSys)return l.script.defaultLangSys.featureIndexes;var u=l.langSysRecords;if(u)for(var f=0;f<u.length;f++){var h=u[f];if(h.tag===a){var d=h.langSys;return d.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};Bn.prototype.mapTagsToFeatures=function(a,t){for(var r={},i=0;i<a.length;i++){var l=a[i].tag,u=a[i].feature;r[l]=u}this.features[t].tags=r};Bn.prototype.getScriptFeatures=function(a){var t=this.features[a];if(this.features.hasOwnProperty(a))return t;var r=this.getScriptFeaturesIndexes(a);if(!r)return null;var i=this.font.tables.gsub;return t=r.map(function(l){return i.features[l]}),this.features[a]=t,this.mapTagsToFeatures(t,a),t};Bn.prototype.getSubstitutionType=function(a,t){var r=a.lookupType.toString(),i=t.substFormat.toString();return r+i};Bn.prototype.getLookupMethod=function(a,t){var r=this,i=this.getSubstitutionType(a,t);switch(i){case"11":return function(l){return oS.apply(r,[l,t])};case"12":return function(l){return uS.apply(r,[l,t])};case"63":return function(l){return cS.apply(r,[l,t])};case"41":return function(l){return fS.apply(r,[l,t])};case"21":return function(l){return dS.apply(r,[l,t])};default:throw new Error("lookupType: "+a.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}};Bn.prototype.lookupFeature=function(a){var t=a.contextParams,r=t.index,i=this.getFeature({tag:a.tag,script:a.script});if(!i)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+a.tag+"' for script '"+a.script+"'.");for(var l=this.getFeatureLookups(i),u=[].concat(t.context),f=0;f<l.length;f++)for(var h=l[f],d=this.getLookupSubtables(h),g=0;g<d.length;g++){var v=d[g],x=this.getSubstitutionType(h,v),y=this.getLookupMethod(h,v),E=void 0;switch(x){case"11":E=y(t.current),E&&u.splice(r,1,new wi({id:11,tag:a.tag,substitution:E}));break;case"12":E=y(t.current),E&&u.splice(r,1,new wi({id:12,tag:a.tag,substitution:E}));break;case"63":E=y(t),Array.isArray(E)&&E.length&&u.splice(r,1,new wi({id:63,tag:a.tag,substitution:E}));break;case"41":E=y(t),E&&u.splice(r,1,new wi({id:41,tag:a.tag,substitution:E}));break;case"21":E=y(t.current),E&&u.splice(r,1,new wi({id:21,tag:a.tag,substitution:E}));break}t=new xa(u,r),!(Array.isArray(E)&&!E.length)&&(E=null)}return u.length?u:null};Bn.prototype.supports=function(a){if(!a.script)return!1;this.getScriptFeatures(a.script);var t=this.features.hasOwnProperty(a.script);if(!a.tag)return t;var r=this.features[a.script].some(function(i){return i.tag===a.tag});return t&&r};Bn.prototype.getLookupSubtables=function(a){return a.subtables||null};Bn.prototype.getLookupByIndex=function(a){var t=this.font.tables.gsub.lookups;return t[a]||null};Bn.prototype.getFeatureLookups=function(a){return a.lookupListIndexes.map(this.getLookupByIndex.bind(this))};Bn.prototype.getFeature=function(t){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script);var r=this.features[t.script];return r?r.tags[t.tag]?this.features[t.script].tags[t.tag]:null:{FAIL:"No feature for script "+t.script}};function pS(a){var t=a.current,r=a.get(-1);return r===null&&Zr(t)||!Zr(r)&&Zr(t)}function hS(a){var t=a.get(1);return t===null||!Zr(t)}var mS={startCheck:pS,endCheck:hS};function gS(a){var t=a.current,r=a.get(-1);return(Zr(t)||Qr(t))&&!Zr(r)}function vS(a){var t=a.get(1);switch(!0){case t===null:return!0;case(!Zr(t)&&!Qr(t)):var r=lS(t);if(!r)return!0;if(r){var i=!1;if(i=a.lookahead.some(function(l){return Zr(l)||Qr(l)}),!i)return!0}break;default:return!1}}var yS={startCheck:gS,endCheck:vS};function bS(a,t,r){t[r].setState(a.tag,a.substitution)}function xS(a,t,r){t[r].setState(a.tag,a.substitution)}function SS(a,t,r){a.substitution.forEach(function(i,l){var u=t[r+l];u.setState(a.tag,i)})}function ES(a,t,r){var i=t[r];i.setState(a.tag,a.substitution.ligGlyph);for(var l=a.substitution.components.length,u=0;u<l;u++)i=t[r+u+1],i.setState("deleted",!0)}var H0={11:bS,12:xS,63:SS,41:ES};function kf(a,t,r){a instanceof wi&&H0[a.id]&&H0[a.id](a,t,r)}function AS(a){for(var t=[].concat(a.backtrack),r=t.length-1;r>=0;r--){var i=t[r],l=Bm(i),u=Qr(i);if(!l&&!u)return!0;if(l)return!1}return!1}function wS(a){if(Bm(a.current))return!1;for(var t=0;t<a.lookahead.length;t++){var r=a.lookahead[t],i=Qr(r);if(!i)return!0}return!1}function TS(a){var t=this,r="arab",i=this.featuresTags[r],l=this.tokenizer.getRangeTokens(a);if(l.length!==1){var u=new xa(l.map(function(h){return h.getState("glyphIndex")}),0),f=new xa(l.map(function(h){return h.char}),0);l.forEach(function(h,d){if(!Qr(h.char)){u.setCurrentIndex(d),f.setCurrentIndex(d);var g=0;AS(f)&&(g|=1),wS(f)&&(g|=2);var v;switch(g){case 1:v="fina";break;case 2:v="init";break;case 3:v="medi";break}if(i.indexOf(v)!==-1){var x=t.query.lookupFeature({tag:v,script:r,contextParams:u});if(x instanceof Error)return console.info(x.message);x.forEach(function(y,E){y instanceof wi&&(kf(y,l,E),u.context[E]=y.substitution)})}}})}}function Y0(a,t){var r=a.map(function(i){return i.activeState.value});return new xa(r,0)}function CS(a){var t=this,r="arab",i=this.tokenizer.getRangeTokens(a),l=Y0(i);l.context.forEach(function(u,f){l.setCurrentIndex(f);var h=t.query.lookupFeature({tag:"rlig",script:r,contextParams:l});h.length&&(h.forEach(function(d){return kf(d,i,f)}),l=Y0(i))})}function MS(a){var t=a.current,r=a.get(-1);return r===null&&qo(t)||!qo(r)&&qo(t)}function NS(a){var t=a.get(1);return t===null||!qo(t)}var RS={startCheck:MS,endCheck:NS};function q0(a,t){var r=a.map(function(i){return i.activeState.value});return new xa(r,0)}function DS(a){var t=this,r="latn",i=this.tokenizer.getRangeTokens(a),l=q0(i);l.context.forEach(function(u,f){l.setCurrentIndex(f);var h=t.query.lookupFeature({tag:"liga",script:r,contextParams:l});h.length&&(h.forEach(function(d){return kf(d,i,f)}),l=q0(i))})}function Ea(a){this.baseDir=a||"ltr",this.tokenizer=new It,this.featuresTags={}}Ea.prototype.setText=function(a){this.text=a};Ea.prototype.contextChecks={latinWordCheck:RS,arabicWordCheck:mS,arabicSentenceCheck:yS};function ff(a){var t=this.contextChecks[a+"Check"];return this.tokenizer.registerContextChecker(a,t.startCheck,t.endCheck)}function _S(){return ff.call(this,"latinWord"),ff.call(this,"arabicWord"),ff.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function OS(){var a=this,t=this.tokenizer.getContextRanges("arabicSentence");t.forEach(function(r){var i=a.tokenizer.getRangeTokens(r);a.tokenizer.replaceRange(r.startIndex,r.endOffset,i.reverse())})}Ea.prototype.registerFeatures=function(a,t){var r=this,i=t.filter(function(l){return r.query.supports({script:a,tag:l})});this.featuresTags.hasOwnProperty(a)?this.featuresTags[a]=this.featuresTags[a].concat(i):this.featuresTags[a]=i};Ea.prototype.applyFeatures=function(a,t){if(!a)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Bn(a));for(var r=0;r<t.length;r++){var i=t[r];this.query.supports({script:i.script})&&this.registerFeatures(i.script,i.tags)}};Ea.prototype.registerModifier=function(a,t,r){this.tokenizer.registerModifier(a,t,r)};function Lf(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function kS(){var a=this,t="arab";if(this.featuresTags.hasOwnProperty(t)){Lf.call(this);var r=this.tokenizer.getContextRanges("arabicWord");r.forEach(function(i){TS.call(a,i)})}}function LS(){var a=this,t="arab";if(this.featuresTags.hasOwnProperty(t)){var r=this.featuresTags[t];if(r.indexOf("rlig")!==-1){Lf.call(this);var i=this.tokenizer.getContextRanges("arabicWord");i.forEach(function(l){CS.call(a,l)})}}}function US(){var a=this,t="latn";if(this.featuresTags.hasOwnProperty(t)){var r=this.featuresTags[t];if(r.indexOf("liga")!==-1){Lf.call(this);var i=this.tokenizer.getContextRanges("latinWord");i.forEach(function(l){DS.call(a,l)})}}}Ea.prototype.checkContextReady=function(a){return!!this.tokenizer.getContext(a)};Ea.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(kS.call(this),LS.call(this)),this.checkContextReady("latinWord")&&US.call(this),this.checkContextReady("arabicSentence")&&OS.call(this)};Ea.prototype.processText=function(a){(!this.text||this.text!==a)&&(this.setText(a),_S.call(this),this.applyFeaturesToContexts())};Ea.prototype.getBidiText=function(a){return this.processText(a),this.tokenizer.getText()};Ea.prototype.getTextGlyphs=function(a){this.processText(a);for(var t=[],r=0;r<this.tokenizer.tokens.length;r++){var i=this.tokenizer.tokens[r];if(!i.state.deleted){var l=i.activeState.value;t.push(Array.isArray(l)?l[0]:l)}}return t};function wt(a){a=a||{},a.tables=a.tables||{},a.empty||(hl(a.familyName,"When creating a new Font object, familyName is required."),hl(a.styleName,"When creating a new Font object, styleName is required."),hl(a.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),hl(a.ascender,"When creating a new Font object, ascender is required."),hl(a.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:a.familyName||" "},fontSubfamily:{en:a.styleName||" "},fullName:{en:a.fullName||a.familyName+" "+a.styleName},postScriptName:{en:a.postScriptName||(a.familyName+a.styleName).replace(/\s/g,"")},designer:{en:a.designer||" "},designerURL:{en:a.designerURL||" "},manufacturer:{en:a.manufacturer||" "},manufacturerURL:{en:a.manufacturerURL||" "},license:{en:a.license||" "},licenseURL:{en:a.licenseURL||" "},version:{en:a.version||"Version 0.1"},description:{en:a.description||" "},copyright:{en:a.copyright||" "},trademark:{en:a.trademark||" "}},this.unitsPerEm=a.unitsPerEm||1e3,this.ascender=a.ascender,this.descender=a.descender,this.createdTimestamp=a.createdTimestamp,this.tables=Object.assign(a.tables,{os2:Object.assign({usWeightClass:a.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:a.widthClass||this.usWidthClasses.MEDIUM,fsSelection:a.fsSelection||this.fsSelectionValues.REGULAR},a.tables.os2)})),this.supported=!0,this.glyphs=new ja.GlyphSet(this,a.glyphs||[]),this.encoding=new hm(this),this.position=new Al(this),this.substitution=new In(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new km(this)}})}wt.prototype.hasChar=function(a){return this.encoding.charToGlyphIndex(a)!==null};wt.prototype.charToGlyphIndex=function(a){return this.encoding.charToGlyphIndex(a)};wt.prototype.charToGlyph=function(a){var t=this.charToGlyphIndex(a),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r};wt.prototype.updateFeatures=function(a){return this.defaultRenderOptions.features.map(function(t){return t.script==="latn"?{script:"latn",tags:t.tags.filter(function(r){return a[r]})}:t})};wt.prototype.stringToGlyphs=function(a,t){var r=this,i=new Ea,l=function(x){return r.charToGlyphIndex(x.char)};i.registerModifier("glyphIndex",null,l);var u=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;i.applyFeatures(this,u);for(var f=i.getTextGlyphs(a),h=f.length,d=new Array(h),g=this.glyphs.get(0),v=0;v<h;v+=1)d[v]=this.glyphs.get(f[v])||g;return d};wt.prototype.nameToGlyphIndex=function(a){return this.glyphNames.nameToGlyphIndex(a)};wt.prototype.nameToGlyph=function(a){var t=this.nameToGlyphIndex(a),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r};wt.prototype.glyphIndexToName=function(a){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(a):""};wt.prototype.getKerningValue=function(a,t){a=a.index||a,t=t.index||t;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,a,t):this.kerningPairs[a+","+t]||0};wt.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};wt.prototype.forEachGlyph=function(a,t,r,i,l,u){t=t!==void 0?t:0,r=r!==void 0?r:0,i=i!==void 0?i:72,l=Object.assign({},this.defaultRenderOptions,l);var f=1/this.unitsPerEm*i,h=this.stringToGlyphs(a,l),d;if(l.kerning){var g=l.script||this.position.getDefaultScriptName();d=this.position.getKerningTables(g,l.language)}for(var v=0;v<h.length;v+=1){var x=h[v];if(u.call(this,x,t,r,i,l),x.advanceWidth&&(t+=x.advanceWidth*f),l.kerning&&v<h.length-1){var y=d?this.position.getKerningValue(d,x.index,h[v+1].index):this.getKerningValue(x,h[v+1]);t+=y*f}l.letterSpacing?t+=l.letterSpacing*i:l.tracking&&(t+=l.tracking/1e3*i)}return t};wt.prototype.getPath=function(a,t,r,i,l){var u=new Qt;return this.forEachGlyph(a,t,r,i,l,function(f,h,d,g){var v=f.getPath(h,d,g,l,this);u.extend(v)}),u};wt.prototype.getPaths=function(a,t,r,i,l){var u=[];return this.forEachGlyph(a,t,r,i,l,function(f,h,d,g){var v=f.getPath(h,d,g,l,this);u.push(v)}),u};wt.prototype.getAdvanceWidth=function(a,t,r){return this.forEachGlyph(a,0,0,t,r,function(){})};wt.prototype.draw=function(a,t,r,i,l,u){this.getPath(t,r,i,l,u).draw(a)};wt.prototype.drawPoints=function(a,t,r,i,l,u){this.forEachGlyph(t,r,i,l,u,function(f,h,d,g){f.drawPoints(a,h,d,g)})};wt.prototype.drawMetrics=function(a,t,r,i,l,u){this.forEachGlyph(t,r,i,l,u,function(f,h,d,g){f.drawMetrics(a,h,d,g)})};wt.prototype.getEnglishName=function(a){var t=this.names[a];if(t)return t.en};wt.prototype.validate=function(){var a=this;function t(i,l){}function r(i){var l=a.getEnglishName(i);l&&l.trim().length>0}r("fontFamily"),r("weightName"),r("manufacturer"),r("copyright"),r("version"),this.unitsPerEm>0};wt.prototype.toTables=function(){return Sb.fontToTable(this)};wt.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};wt.prototype.toArrayBuffer=function(){for(var a=this.toTables(),t=a.encode(),r=new ArrayBuffer(t.length),i=new Uint8Array(r),l=0;l<t.length;l++)i[l]=t[l];return r};wt.prototype.download=function(a){var t=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");a=a||t.replace(/\s/g,"")+"-"+r+".otf";var i=this.toArrayBuffer();if(Ab())if(window.URL=window.URL||window.webkitURL,window.URL){var l=new DataView(i),u=new Blob([l],{type:"font/opentype"}),f=document.createElement("a");f.href=window.URL.createObjectURL(u),f.download=a;var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!1),f.dispatchEvent(h)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var d=require("fs"),g=wb(i);d.writeFileSync(a,g)}};wt.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};wt.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};wt.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var ur=new Array(10);ur[1]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{posFormat:1,coverage:this.parsePointer(re.coverage),value:this.parseValueRecord()};if(r===2)return{posFormat:2,coverage:this.parsePointer(re.coverage),values:this.parseValueRecordList()};Qe.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};ur[2]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();Qe.assert(r===1||r===2,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var i=this.parsePointer(re.coverage),l=this.parseUShort(),u=this.parseUShort();if(r===1)return{posFormat:r,coverage:i,valueFormat1:l,valueFormat2:u,pairSets:this.parseList(re.pointer(re.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(l),value2:this.parseValueRecord(u)}})))};if(r===2){var f=this.parsePointer(re.classDef),h=this.parsePointer(re.classDef),d=this.parseUShort(),g=this.parseUShort();return{posFormat:r,coverage:i,valueFormat1:l,valueFormat2:u,classDef1:f,classDef2:h,class1Count:d,class2Count:g,classRecords:this.parseList(d,re.list(g,function(){return{value1:this.parseValueRecord(l),value2:this.parseValueRecord(u)}}))}}};ur[3]=function(){return{error:"GPOS Lookup 3 not supported"}};ur[4]=function(){return{error:"GPOS Lookup 4 not supported"}};ur[5]=function(){return{error:"GPOS Lookup 5 not supported"}};ur[6]=function(){return{error:"GPOS Lookup 6 not supported"}};ur[7]=function(){return{error:"GPOS Lookup 7 not supported"}};ur[8]=function(){return{error:"GPOS Lookup 8 not supported"}};ur[9]=function(){return{error:"GPOS Lookup 9 not supported"}};new Array(10);const Wo=()=>Math.random().toString(36).substr(2,9),IS=ea.memo(({playbackFps:a,onSpeedChange:t})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_speed",targetType:"global",label:"SPEED",min:1,max:120,step:1}))};return m.jsxs("div",{className:"master-speed-slider",draggable:!0,onDragStart:r,children:[m.jsxs("label",{htmlFor:"masterSpeedRange",children:[a," FPS"]}),m.jsx(Ct,{id:"master_speed",children:m.jsx("input",{type:"range",min:"1",max:"120",value:a,className:"slider_hor",id:"masterSpeedRange",onChange:i=>t(parseInt(i.target.value))})})]})}),BS=ea.memo(({isWorldOutputActive:a,onToggleWorldOutput:t})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"laser_output",targetType:"global",label:"LASER"}))};return m.jsx("div",{className:"container",draggable:!0,onDragStart:r,children:m.jsx(Ct,{id:"laser_output",children:m.jsx("input",{type:"checkbox",checked:a,onChange:t})})})}),gl=(a,t,r,i)=>!Array.isArray(a)||a.length!==t?Array(t).fill(null).map((l,u)=>Array(r).fill(null).map((f,h)=>i(u,h))):a.map((l,u)=>!Array.isArray(l)||l.length!==r?Array(r).fill(null).map((f,h)=>i(u,h)):l),Fm=a=>({columns:Array.from({length:8},(t,r)=>`Col ${r+1}`),layers:Array.from({length:5},(t,r)=>`Layer ${r+1}`),clipContents:gl(a?.clipContents,5,8,()=>({parsing:!1})),clipNames:gl(a?.clipNames,5,8,(t,r)=>`Clip ${t+1}-${r+1}`),thumbnailFrameIndexes:Array(5).fill(null).map(()=>Array(8).fill(0)),layerEffects:Array(5).fill([]),layerAssignedDacs:a?.layerAssignedDacs??Array(5).fill([]),layerIntensities:Array(5).fill(1),layerAutopilots:Array(5).fill("off"),layerBlackouts:Array(5).fill(!1),layerSolos:Array(5).fill(!1),masterIntensity:1,globalBlackout:!1,selectedLayerIndex:null,selectedColIndex:null,notification:{message:"",visible:!1},dacs:[],selectedDac:a?.dacAssignment?.selectedDac??a?.selectedDac??null,ildaFrames:[],selectedIldaWorkerId:null,selectedIldaTotalFrames:0,bpm:a?.bpm??120,showBeamEffect:a?.renderSettings?.showBeamEffect??!0,beamAlpha:a?.renderSettings?.beamAlpha??.1,fadeAlpha:a?.renderSettings?.fadeAlpha??.13,playbackFps:a?.renderSettings?.playbackFps??60,previewScanRate:a?.renderSettings?.previewScanRate??1,beamRenderMode:a?.renderSettings?.beamRenderMode??"both",worldShowBeamEffect:a?.renderSettings?.worldShowBeamEffect??!0,worldBeamRenderMode:a?.renderSettings?.worldBeamRenderMode??"both",activeClipIndexes:Array(5).fill(null),isPlaying:!1,isStopped:!0,isWorldOutputActive:!1,thumbnailRenderMode:a?.thumbnailRenderMode??"still",theme:a?.theme??"orange",projectLoadTimestamp:null,clipClipboard:null,dacOutputSettings:a?.dacOutputSettings??{},quickAssigns:{knobs:Array(8).fill(null).map(()=>({value:0,label:null,link:null})),buttons:Array(8).fill(null).map(()=>({value:!1,label:null,link:null}))}});function FS(a,t){switch(t.type){case"SET_DAC_OUTPUT_SETTINGS":return{...a,dacOutputSettings:{...a.dacOutputSettings,[t.payload.id]:t.payload.settings}};case"SET_COLUMNS":return{...a,columns:t.payload};case"SET_COLUMN_NAME":{const r=[...a.columns];return r[t.payload.index]=t.payload.name,{...a,columns:r}}case"SET_LAYERS":return{...a,layers:t.payload};case"SET_LAYER_NAME":{const r=[...a.layers];return r[t.payload.index]=t.payload.name,{...a,layers:r}}case"SET_CLIP_CONTENT":{const r=[...a.clipContents];if(!r[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),a;r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=r[t.payload.layerIndex][t.payload.colIndex]||{};return r[t.payload.layerIndex][t.payload.colIndex]={...i,...t.payload.content},{...a,clipContents:r}}case"SET_CLIP_NAME":{const r=[...a.clipNames];return r[t.payload.layerIndex]=[...r[t.payload.layerIndex]],r[t.payload.layerIndex][t.payload.colIndex]=t.payload.name,{...a,clipNames:r}}case"SET_THUMBNAIL_FRAME_INDEX":{const r=[...a.thumbnailFrameIndexes];return r[t.payload.layerIndex][t.payload.colIndex]=t.payload.index,{...a,thumbnailFrameIndexes:r}}case"ADD_LAYER_EFFECT":{const r=[...a.layerEffects],i={...t.payload.effect,instanceId:Wo(),params:{...t.payload.effect.defaultParams}};return r[t.payload.layerIndex].push(i),{...a,layerEffects:r}}case"ADD_CLIP_EFFECT":{const r=[...a.clipContents];if(!r[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),a;r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=r[t.payload.layerIndex][t.payload.colIndex]||{},l={...t.payload.effect,instanceId:Wo(),params:{...t.payload.effect.defaultParams}},u={...i,effects:[...i.effects||[],l]};return r[t.payload.layerIndex][t.payload.colIndex]=u,{...a,clipContents:r}}case"SET_SELECTED_CLIP":return{...a,selectedLayerIndex:t.payload.layerIndex,selectedColIndex:t.payload.colIndex};case"SET_NOTIFICATION":return{...a,notification:t.payload};case"SET_ILDA_FRAMES":return{...a,ildaFrames:t.payload};case"SET_SELECTED_ILDA_DATA":return{...a,selectedIldaWorkerId:t.payload.workerId,selectedIldaTotalFrames:t.payload.totalFrames,selectedGeneratorId:t.payload.generatorId,selectedGeneratorParams:t.payload.generatorParams};case"SET_ACTIVE_CLIP":{const r=[...a.activeClipIndexes];return r[t.payload.layerIndex]=t.payload.colIndex,{...a,activeClipIndexes:r}}case"CLEAR_CLIP":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]],r[t.payload.layerIndex][t.payload.colIndex]=null;const i=[...a.clipNames];i[t.payload.layerIndex][t.payload.colIndex]=`Clip ${t.payload.layerIndex+1}-${t.payload.colIndex+1}`;const l=[...a.thumbnailFrameIndexes];l[t.payload.layerIndex][t.payload.colIndex]=0;const u=[...a.activeClipIndexes];return u[t.payload.layerIndex]===t.payload.colIndex&&(u[t.payload.layerIndex]=null),a.selectedLayerIndex===t.payload.layerIndex&&a.selectedColIndex===t.payload.colIndex?{...a,clipContents:r,clipNames:i,thumbnailFrameIndexes:l,activeClipIndexes:u,selectedLayerIndex:null,selectedColIndex:null,selectedIldaWorkerId:null,selectedIldaTotalFrames:0,selectedGeneratorId:null,selectedGeneratorParams:{}}:{...a,clipContents:r,clipNames:i,thumbnailFrameIndexes:l,activeClipIndexes:u}}case"DEACTIVATE_LAYER_CLIPS":{const r=[...a.activeClipIndexes];return r[t.payload.layerIndex]=null,{...a,activeClipIndexes:r}}case"CLEAR_ALL_ACTIVE_CLIPS":return{...a,activeClipIndexes:Array(a.layers.length).fill(null)};case"SET_LAYER_INTENSITY":{const r=[...a.layerIntensities];return r[t.payload.layerIndex]=t.payload.intensity,{...a,layerIntensities:r}}case"SET_LAYER_AUTOPILOT":{const r=[...a.layerAutopilots];return r[t.payload.layerIndex]=t.payload.mode,{...a,layerAutopilots:r}}case"TOGGLE_LAYER_BLACKOUT":{const r=[...a.layerBlackouts];return r[t.payload.layerIndex]=!r[t.payload.layerIndex],{...a,layerBlackouts:r}}case"TOGGLE_LAYER_SOLO":{const r=[...a.layerSolos],i=r[t.payload.layerIndex];return r.fill(!1),i||(r[t.payload.layerIndex]=!0),{...a,layerSolos:r}}case"SET_MASTER_INTENSITY":return{...a,masterIntensity:t.payload};case"TOGGLE_GLOBAL_BLACKOUT":return{...a,globalBlackout:!a.globalBlackout};case"SET_RENDER_SETTING":return{...a,[t.payload.setting]:t.payload.value};case"REMOVE_CLIP_EFFECT":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};if(i&&i.effects){const l=[...i.effects];l.splice(t.payload.effectIndex,1),i.effects=l,r[t.payload.layerIndex][t.payload.colIndex]=i}return{...a,clipContents:r}}case"REORDER_CLIP_EFFECTS":{const{layerIndex:r,colIndex:i,oldIndex:l,newIndex:u}=t.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h&&h.effects){const d=[...h.effects],[g]=d.splice(l,1);d.splice(u,0,g),h.effects=d,f[r][i]=h}return{...a,clipContents:f}}case"REMOVE_LAYER_EFFECT":{const r=[...a.layerEffects];return r[t.payload.layerIndex]&&(r[t.payload.layerIndex]=[...r[t.payload.layerIndex]],r[t.payload.layerIndex].splice(t.payload.effectIndex,1)),{...a,layerEffects:r}}case"UPDATE_LAYER_EFFECT_PARAMETER":{const r=[...a.layerEffects];if(r[t.payload.layerIndex]){r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=t.payload.effectIndex;if(r[t.payload.layerIndex][i]){const l={...r[t.payload.layerIndex][i]};l.params={...l.params,[t.payload.paramName]:t.payload.newValue},r[t.payload.layerIndex][i]=l}}return{...a,layerEffects:r}}case"UPDATE_EFFECT_PARAMETER":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};if(i&&i.effects){const l=[...i.effects],u={...l[t.payload.effectIndex]};u.params={...u.params,[t.payload.paramName]:t.payload.newValue},l[t.payload.effectIndex]=u,i.effects=l,r[t.payload.layerIndex][t.payload.colIndex]=i}return{...a,clipContents:r}}case"UPDATE_CLIP_PLAYBACK_SETTINGS":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};return i&&(i.playbackSettings={...i.playbackSettings||{mode:"fps",duration:1,beats:8,speedMultiplier:1},...t.payload.settings},r[t.payload.layerIndex][t.payload.colIndex]=i),{...a,clipContents:r}}case"SET_CLIP_PARAM_SYNC":{const{layerIndex:r,colIndex:i,paramId:l,syncMode:u}=t.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h){const d=h.syncSettings||{},g=d[l]===u?null:u;h.syncSettings={...d,[l]:g},f[r][i]=h}return{...a,clipContents:f}}case"UPDATE_GENERATOR_PARAM":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};return i&&i.type==="generator"&&i.currentParams&&(i.currentParams={...i.currentParams,[t.payload.paramName]:t.payload.newValue},r[t.payload.layerIndex][t.payload.colIndex]=i,a.selectedLayerIndex===t.payload.layerIndex&&a.selectedColIndex===t.payload.colIndex)?{...a,clipContents:r,selectedGeneratorParams:i.currentParams}:{...a,clipContents:r}}case"SET_DACS":return{...a,dacs:t.payload};case"SET_BPM":return{...a,bpm:t.payload};case"SET_SELECTED_DAC":return{...a,selectedDac:t.payload};case"SET_IS_PLAYING":return{...a,isPlaying:t.payload};case"SET_IS_STOPPED":return{...a,isStopped:t.payload};case"SET_WORLD_OUTPUT_ACTIVE":return{...a,isWorldOutputActive:t.payload};case"TOGGLE_WORLD_OUTPUT_ACTIVE":return{...a,isWorldOutputActive:!a.isWorldOutputActive};case"SET_CLIPBOARD":return{...a,clipClipboard:t.payload};case"SET_CLIP_DAC":{const r=[...a.clipContents];if(!r[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),a;r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=r[t.payload.layerIndex][t.payload.colIndex]||{};let l=i.assignedDacs||[];const u=[],f=d=>{const{channels:g,allChannels:v,...x}=d;return x};if(t.payload.dac.allChannels&&t.payload.dac.channels)t.payload.dac.channels.forEach(d=>{l.some(g=>g.ip===t.payload.dac.ip&&g.channel===d.serviceID)||u.push({...f(t.payload.dac),channel:d.serviceID,mirrorX:!1,mirrorY:!1})});else{const d=t.payload.dac.channel;d!==void 0&&!l.some(g=>g.ip===t.payload.dac.ip&&g.channel===d)&&u.push({...f(t.payload.dac),channel:d,mirrorX:!1,mirrorY:!1})}if(u.length===0)return a;const h={...i,assignedDacs:[...l,...u]};return r[t.payload.layerIndex][t.payload.colIndex]=h,{...a,clipContents:r}}case"SET_LAYER_DAC":{const{layerIndex:r,dac:i}=t.payload,l=[...a.layerAssignedDacs],u=l[r]||[];let f=[];const h=d=>{const{channels:g,allChannels:v,...x}=d;return x};if(i.allChannels&&i.channels)i.channels.forEach(d=>{u.some(g=>g.ip===i.ip&&g.channel===d.serviceID)||f.push({...h(i),channel:d.serviceID,mirrorX:!1,mirrorY:!1})});else{const d=i.channel;d!==void 0&&!u.some(g=>g.ip===i.ip&&g.channel===d)&&f.push({...h(i),channel:d,mirrorX:!1,mirrorY:!1})}return f.length===0?a:(l[r]=[...u,...f],{...a,layerAssignedDacs:l})}case"TOGGLE_CLIP_DAC_MIRROR":{const{layerIndex:r,colIndex:i,dacIndex:l,axis:u}=t.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h&&h.assignedDacs){const d=[...h.assignedDacs],g={...d[l]};return u==="x"&&(g.mirrorX=!g.mirrorX),u==="y"&&(g.mirrorY=!g.mirrorY),d[l]=g,h.assignedDacs=d,f[r][i]=h,{...a,clipContents:f}}return a}case"REMOVE_CLIP_DAC":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const{layerIndex:i,colIndex:l,dacIndex:u}=t.payload,f=r[i][l];if(f&&f.assignedDacs){const h=[...f.assignedDacs];return h.splice(u,1),r[t.payload.layerIndex][t.payload.colIndex]={...f,assignedDacs:h},{...a,clipContents:r}}return a}case"TOGGLE_LAYER_DAC_MIRROR":{const{layerIndex:r,dacIndex:i,axis:l}=t.payload,u=[...a.layerAssignedDacs],f=u[r]?[...u[r]]:[];if(f[i]){const h={...f[i]};return l==="x"&&(h.mirrorX=!h.mirrorX),l==="y"&&(h.mirrorY=!h.mirrorY),f[i]=h,u[r]=f,{...a,layerAssignedDacs:u}}return a}case"REMOVE_LAYER_DAC":{const{layerIndex:r,dacIndex:i}=t.payload,l=[...a.layerAssignedDacs];if(l[r]){const u=[...l[r]];return u.splice(i,1),l[r]=u,{...a,layerAssignedDacs:l}}return a}case"SET_CLIP_AUDIO":{const r=[...a.clipContents],{layerIndex:i,colIndex:l,audioFile:u}=t.payload;r[i]=[...r[i]];const f=r[i][l];return f?(r[i][l]={...f,audioFile:u,audioVolume:f.audioVolume!==void 0?f.audioVolume:1},{...a,clipContents:r}):a}case"SET_CLIP_AUDIO_VOLUME":{const r=[...a.clipContents],{layerIndex:i,colIndex:l,volume:u}=t.payload;r[i]=[...r[i]];const f=r[i][l];return f?(r[i][l]={...f,audioVolume:u},{...a,clipContents:r}):a}case"REMOVE_CLIP_AUDIO":{const r=[...a.clipContents],{layerIndex:i,colIndex:l}=t.payload;r[i]=[...r[i]];const u=r[i][l];return u?(r[i][l]={...u,audioFile:null},{...a,clipContents:r}):a}case"SET_CLIP_PARSING_STATUS":{const{layerIndex:r,colIndex:i,status:l}=t.payload,u=[...a.clipContents];u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,parsing:l},{...a,clipContents:u}}case"SET_BULK_PARSING_STATUS":{const r=[...a.clipContents];return new Set(t.payload.map(l=>l.layerIndex)).forEach(l=>{r[l]&&(r[l]=[...r[l]])}),t.payload.forEach(({layerIndex:l,colIndex:u,status:f})=>{if(r[l]){const h=r[l][u]||{};r[l][u]={...h,parsing:f}}}),{...a,clipContents:r}}case"SET_THUMBNAIL_RENDER_MODE":return{...a,thumbnailRenderMode:t.payload};case"SET_CLIP_TRIGGER_STYLE":{const{layerIndex:r,colIndex:i,style:l}=t.payload,u=[...a.clipContents];u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,triggerStyle:l},{...a,clipContents:u}}case"SET_THEME":return{...a,theme:t.payload};case"UPDATE_THUMBNAIL":{const{layerIndex:r,colIndex:i,frameIndex:l}=t.payload,u=[...a.thumbnailFrameIndexes];return u[r]=[...u[r]],u[r][i]=l,{...a,thumbnailFrameIndexes:u}}case"RESET_STATE":return Fm({});case"LOAD_PROJECT":{const r={...a,...t.payload};return r.clipContents=gl(r.clipContents,5,8,()=>({parsing:!1})),r.clipNames=gl(r.clipNames,5,8,(i,l)=>`Clip ${i+1}-${l+1}`),r.clipContents=r.clipContents.map(i=>i.map(l=>l&&l.type==="ilda"?{...l,workerId:null,parsing:!1}:l)),r.activeClipIndexes=Array(a.layers.length).fill(null),r.selectedLayerIndex=null,r.selectedColIndex=null,r.selectedIldaWorkerId=null,r.selectedIldaTotalFrames=0,r.selectedGeneratorId=null,r.selectedGeneratorParams={},r.projectLoadTimestamp=Date.now(),r}case"LOAD_SETTINGS":return{...a,showBeamEffect:t.payload.renderSettings?.showBeamEffect??a.showBeamEffect,beamAlpha:t.payload.renderSettings?.beamAlpha??a.beamAlpha,fadeAlpha:t.payload.renderSettings?.fadeAlpha??a.fadeAlpha,playbackFps:t.payload.renderSettings?.playbackFps??a.playbackFps,previewScanRate:t.payload.renderSettings?.previewScanRate??a.previewScanRate,beamRenderMode:t.payload.renderSettings?.beamRenderMode??a.beamRenderMode,theme:t.payload.theme??a.theme,thumbnailRenderMode:t.payload.thumbnailRenderMode??a.thumbnailRenderMode,selectedDac:t.payload.selectedDac??a.selectedDac,clipNames:t.payload.clipNames?gl(t.payload.clipNames,5,8,(r,i)=>`Clip ${r+1}-${i+1}`):a.clipNames,dacOutputSettings:t.payload.dacOutputSettings??a.dacOutputSettings};case"ASSIGN_QUICK_CONTROL":{const{type:r,index:i,link:l}=t.payload,u={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},f=r==="knob"?"knobs":"buttons";return u[f][i]={...u[f][i],label:l.paramName||l.paramId,link:l,min:l.min,max:l.max,step:l.step},{...a,quickAssigns:u}}case"UPDATE_QUICK_CONTROL":{const{type:r,index:i,value:l}=t.payload,u={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},f=r==="knob"?"knobs":"buttons",h=u[f][i];u[f][i]={...h,value:l};let d={...a,quickAssigns:u};if(h.link){const{layerIndex:g,colIndex:v,effectIndex:x,targetType:y}=h.link,E=h.link.paramName||h.link.paramId;let S=l;if(r==="knob"&&h.min!==void 0&&h.max!==void 0&&(S=h.min+l*(h.max-h.min),h.step&&(S=Math.round(S/h.step)*h.step),S=parseFloat(S.toFixed(5))),console.log(`Updating ${y} param ${E} to ${S} (Link: L${g} C${v} E${x})`),y==="layerEffect"){const w=[...d.layerEffects];if(w[g]&&(w[g]=[...w[g]],w[g][x])){const D={...w[g][x]};D.params={...D.params,[E]:S},w[g][x]=D,d={...d,layerEffects:w}}}else if(y==="global")E==="master_intensity"?d={...d,masterIntensity:S}:E==="master_speed"&&(d={...d,playbackFps:S});else{const w=[...d.clipContents];if(w[g]){w[g]=[...w[g]];const D=w[g][v];if(D)if(y==="effect"&&D.effects&&D.effects[x]){const U=[...D.effects],k={...U[x]};k.params={...k.params,[E]:S},U[x]=k,w[g][v]={...D,effects:U}}else y==="generator"&&(w[g][v]={...D,currentParams:{...D.currentParams,[E]:S}});d.clipContents=w}}}return d}case"TOGGLE_QUICK_BUTTON":{const{index:r}=t.payload,l=!a.quickAssigns.buttons[r].value,u={...a.quickAssigns,buttons:[...a.quickAssigns.buttons]};u.buttons[r]={...u.buttons[r],value:l};let f={...a,quickAssigns:u};const h=u.buttons[r];if(h.link){const{layerIndex:d,colIndex:g,effectIndex:v,paramName:x,targetType:y}=h.link;if(y==="layer"){if(x==="blackout"){const E=[...f.layerBlackouts];E[d]=l,f={...f,layerBlackouts:E}}else if(x==="solo"){const E=[...f.layerSolos];l?(E.fill(!1),E[d]=!0):E[d]=!1,f={...f,layerSolos:E}}else if(x==="clear"){if(l){const E=[...f.activeClipIndexes];E[d]=null,f={...f,activeClipIndexes:E},u.buttons[r].value=!1,f.quickAssigns=u}}else if(x==="autopilot"){const E=[...f.layerAutopilots];E[d]=l?"forward":"off",f={...f,layerAutopilots:E}}}else{const E=[...f.clipContents];if(E[d]){E[d]=[...E[d]];const S=E[d][g];if(S)if(y==="effect"&&S.effects&&S.effects[v]){const w=[...S.effects],D={...w[v]};D.params={...D.params,[x]:l},w[v]=D,E[d][g]={...S,effects:w}}else y==="generator"&&(E[d][g]={...S,currentParams:{...S.currentParams,[x]:l}});f.clipContents=E}}}return f}case"UPDATE_CLIP_FILE_PATH":{const{oldPath:r,newPath:i}=t.payload;console.log(`Reducer: Updating clip path from ${r} to ${i}`);const l=a.clipContents.map(u=>u.map(f=>{let h=f;return f&&f.filePath===r&&(h={...h,filePath:i,parsingFailed:!1}),f&&f.audioFile&&f.audioFile.path===r&&(h={...h,audioFile:{...f.audioFile,path:i}}),h}));return{...a,clipContents:l}}case"SET_CLIP_PARSING_FAILED":{const{layerIndex:r,colIndex:i,failed:l}=t.payload,u=[...a.clipContents];if(u[r]){u[r]=[...u[r]];const f=u[r][i];f&&(u[r][i]={...f,parsingFailed:l})}return{...a,clipContents:u}}default:return a}}const zo={orange:{full:60,dim:10},yellow:{full:74,dim:15},cyan:{full:36,dim:35},"light-blue":{full:41,dim:43},blue:{full:45,dim:47},magenta:{full:53,dim:55},red:{full:5,dim:7},green:{full:21,dim:23},white:{full:3,dim:1}},jS=({isPlaying:a,globalBlackout:t,layerBlackouts:r,layerSolos:i,isWorldOutputActive:l,clipContents:u,activeClipIndexes:f,theme:h,bpm:d,quickAssigns:g})=>{const{sendFeedback:v,mappings:x,selectedMidiInputId:y,midiInitialized:E}=Jo();return T.useEffect(()=>{if(!y||!E||!a){E&&y&&Ho(y,"F#6",0,1);return}let S=!1;const w=6e4/(d||120),D=setInterval(()=>{S=!S,Ho(y,"F#6",S?127:0,1)},w/2);return()=>{clearInterval(D),Ho(y,"F#6",0,1)}},[a,d,y,E]),T.useEffect(()=>{v("transport_play",a),v("transport_stop",!a)},[a,v]),T.useEffect(()=>{v("comp_blackout",t)},[t,v]),T.useEffect(()=>{v("laser_output",l)},[l,v]),T.useEffect(()=>{r.forEach((S,w)=>{v(`layer_${w}_blackout`,S)})},[r,v]),T.useEffect(()=>{i.forEach((S,w)=>{v(`layer_${w}_solo`,S)})},[i,v]),T.useEffect(()=>{if(!u||!f)return;const S=zo[h]||zo.orange;u.forEach((w,D)=>{w.forEach((U,k)=>{const C=`clip_${D}_${k}`;if(x[C]){const M=f[D]===k,F=U!==null&&(U.type==="ilda"||U.type==="generator"),H=U?.triggerStyle||"normal";let fe=0,de=null;M?(fe=S.full,H==="toggle"&&(de=10)):F&&(fe=S.dim),v(C,fe,de)}})})},[u,f,h,x,v]),T.useEffect(()=>{if(!g)return;const S=zo[h]||zo.orange;g.buttons.forEach((w,D)=>{v(`quick_btn_${D}`,w.value?S.full:0)})},[g,h,v]),null},df=async(a,t,r,i)=>{if(!a||!a.points)return null;let l=a;try{t&&t.length>0&&(l=vl(a,t,{progress:0,time:0,effectStates:{},assignedDacs:[]}))}catch(S){console.warn("Failed to apply effects for thumbnail:",S)}const u=128,f=128,h=document.createElement("canvas");h.width=u,h.height=f;const d=h.getContext("2d");d.fillStyle="#000000",d.fillRect(0,0,u,f);const g=l.points,v=l.isTypedArray||g instanceof Float32Array,x=v?g.length/8:g.length;d.lineWidth=1.5,d.lineCap="round";let y=null,E=null;for(let S=0;S<x;S++){let w,D,U,k,C,M;if(v)w=g[S*8],D=g[S*8+1],U=g[S*8+3],k=g[S*8+4],C=g[S*8+5],M=g[S*8+6]>.5;else{const fe=g[S];w=fe.x,D=fe.y,U=fe.r,k=fe.g,C=fe.b,M=fe.blanking}const F=(w+1)*.5*u,H=(1-(D+1)*.5)*f;if(!M&&y!==null){d.beginPath(),d.moveTo(y,E),d.lineTo(F,H);const fe=Math.floor(Math.max(0,Math.min(1,U))*255),de=Math.floor(Math.max(0,Math.min(1,k))*255),ce=Math.floor(Math.max(0,Math.min(1,C))*255);d.strokeStyle=`rgb(${fe},${de},${ce})`,d.stroke()}y=F,E=H}try{const w=await(await new Promise(D=>h.toBlob(D,"image/png"))).arrayBuffer();if(window.electronAPI&&window.electronAPI.saveThumbnail){const D=`thumb_L${r}_C${i}.png`;return await window.electronAPI.saveThumbnail(w,D)}}catch(S){console.error("Error generating/saving thumbnail:",S)}return null},V0=ea.memo(({type:a,previewFrameCountRef:t,totalPointsSentRef:r,activeChannelsCountRef:i,lastStatUpdateTimeRef:l})=>{const[u,f]=T.useState({cpu:"0.0",ram:"0",fps:0,pps:0,avgPps:0});return T.useEffect(()=>{const h=window.electronAPI?.onSystemStats(g=>{f(v=>({...v,...g}))});let d;return a==="performance"&&l&&t&&r&&i&&(d=setInterval(()=>{const g=performance.now(),v=(g-(l.current||0))/1e3;if(v>0){const x=Math.round((t.current||0)/v),y=Math.round((r.current||0)/v),E=(i.current||0)>0?Math.round(y/i.current):0;f(S=>({...S,fps:x,pps:y,avgPps:E})),t.current=0,r.current=0,l.current=g}},1e3)),()=>{h&&h(),d&&clearInterval(d)}},[a,t,r,i,l]),a==="system"?m.jsxs("div",{className:"systemStats",children:[m.jsxs("p",{children:["CPU: ",u.cpu,"%"]}),m.jsxs("p",{children:["RAM: ",u.ram,"MB"]})]}):m.jsxs("div",{className:"performanceStats",children:[m.jsxs("p",{children:["FPS: ",u.fps]}),m.jsxs("p",{children:["OutPPS: ",u.avgPps," (Avg)"]})]})}),PS=ea.memo(({clipContents:a,activeClipIndexes:t,layerEffects:r,bpm:i,playbackFps:l,selectedLayerIndex:u,selectedColIndex:f,liveFramesRef:h,progressRef:d,selectedDac:g,liveDacOutputSettingsRef:v,dacOutputSettings:x,getAudioInfo:y,fftLevels:E,getFftLevels:S,effectStatesRef:w,clipActivationTimesRef:D,showBeamEffect:U,beamAlpha:k,fadeAlpha:C,previewScanRate:M,beamRenderMode:F,worldShowBeamEffect:H,worldBeamRenderMode:fe,masterIntensity:de,layerIntensities:ce,globalBlackout:le,layerSolos:Z,layerBlackouts:z,handleToggleBeamEffect:Q,handleCycleDisplayMode:$,previewFrameCountRef:W,totalPointsSentRef:B,activeChannelsCountRef:P,lastStatUpdateTimeRef:V})=>{const[pe,R]=T.useState(0),G=T.useRef(0),ie=T.useRef(performance.now()),ve=1e3/70;T.useEffect(()=>{let Ue;const ye=ne=>{ne-G.current>ve&&(W.current++,ie.current=performance.now(),R(ft=>ft+1),G.current=ne),Ue=requestAnimationFrame(ye)};return Ue=requestAnimationFrame(ye),()=>cancelAnimationFrame(Ue)},[ve,W]);const te=u!==null&&f!==null?a[u][f]:null,ge=f!==null?te?.type==="ilda"?te?.workerId:`generator-${u}-${f}`:u!==null&&t[u]!==null?a[u][t[u]]?.type==="ilda"?a[u][t[u]]?.workerId:`generator-${u}-${t[u]}`:null,Ee=ge?h.current[ge]:null,Ke=ge&&d.current[ge]||0;let ke=[],at=1;if(u!==null){const Ue=r[u]||[];if(f!==null)ke=[...te?.effects||[],...Ue];else{const ft=t[u];ft!==null?ke=[...a[u][ft]?.effects||[],...Ue]:ke=Ue}const ye=Z.some(ft=>ft);let ne=ce[u];le?ne=0:ye?ne=Z[u]?z[u]?0:ne:0:z[u]&&(ne=0),at=ne*de}const $t=T.useMemo(()=>{const Ue={};return t.forEach((ye,ne)=>{if(ye!==null){const ft=a[ne][ye];if(ft){let ht=ft.type==="ilda"?ft.workerId:`generator-${ne}-${ye}`;ht&&h.current[ht]&&(Ue[ht]={frame:h.current[ht],effects:[...ft.effects||[],...r[ne]||[]],layerIndex:ne,syncSettings:ft.syncSettings||{},bpm:i,clipDuration:(()=>{const Te=ft.playbackSettings||{};return Te.mode==="timeline"?Te.duration||1:Te.mode==="bpm"?(Te.beats||8)*60/(i||120):(ft.totalFrames||30)/(ft.fps||l||30)})(),progress:d.current[ht]||0,effectStates:w.current,clipActivationTime:D.current[ne]||0})}}}),Ue},[t,a,pe,i,r,l,h,d,w,D]),Be=T.useMemo(()=>{const Ue=Z.some(ye=>ye);return ce.map((ye,ne)=>le?0:Ue?Z[ne]?z[ne]?0:ye:0:z[ne]?0:ye)},[ce,z,Z,le]);return m.jsxs("div",{className:"side-panel",children:[m.jsx(V0,{type:"system",previewFrameCountRef:W,totalPointsSentRef:B,activeChannelsCountRef:P,lastStatUpdateTimeRef:V}),m.jsx(xy,{frame:Ee,effects:ke,showBeamEffect:U,beamAlpha:k,fadeAlpha:C,previewScanRate:M,beamRenderMode:F,intensity:at,syncSettings:te?.syncSettings,bpm:i,clipDuration:(()=>{const Ue=te?.playbackSettings||{};return Ue.mode==="timeline"?Ue.duration||1:Ue.mode==="bpm"?(Ue.beats||8)*60/(i||120):(te?.totalFrames||30)/(te?.fps||l||30)})(),progress:Ke,previewTime:ie.current,fftLevels:S?S():E,effectStates:w.current,clipActivationTime:u!==null&&D.current[u]||0,onToggleBeamEffect:()=>Q("clip"),onCycleDisplayMode:()=>$("clip")}),m.jsx(Sy,{activeFrames:$t,showBeamEffect:H,beamAlpha:k,fadeAlpha:C,previewScanRate:M,beamRenderMode:fe,layerIntensities:Be,masterIntensity:de,dacSettings:g?v.current?v.current[`${g.ip}:${g.channel}`]:x[`${g.ip}:${g.channel}`]:null,previewTime:ie.current,fftLevels:S?S():E,onToggleBeamEffect:()=>Q("world"),onCycleDisplayMode:()=>$("world")}),m.jsx(V0,{type:"performance",previewFrameCountRef:W,totalPointsSentRef:B,activeChannelsCountRef:P,lastStatUpdateTimeRef:V})]})});function GS(){const a=ky(),t=Iy(),r=T.useRef(null),{fftLevels:i,getFftLevels:l}=Sl()||{};T.useEffect(()=>{const _=new Worker(new URL(""+new URL("ui-generators.worker-EkgwJKrR.js",import.meta.url).href,import.meta.url),{type:"module"});r.current=_;const N=I=>{if(I.data.layerIndex!==void 0&&I.data.colIndex!==void 0){const O=`${I.data.layerIndex}-${I.data.colIndex}`;if(vr.current.set(O,!1),Ra.current.has(O)){const{message:q,transferables:me}=Ra.current.get(O);Ra.current.delete(O),console.log(`[App.jsx] UI Generator ${O} free, processing pending seq ${q.seq}`),vr.current.set(O,!0),_.postMessage(q,me)}}if(I.data.success){const{layerIndex:O,colIndex:q,frames:me,generatorDefinition:ae,currentParams:Ae,isLive:Fe,seq:$e}=I.data;if($e!==void 0){if($e<gr.current)return;gr.current=$e}const xe=`generator-${O}-${q}`;if(U.current[xe]=me[0],!Fe){ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:O,colIndex:q,content:{type:"generator",generatorDefinition:ae,frames:me,currentParams:Ae,playbackSettings:{mode:"timeline",duration:5,beats:8,speedMultiplier:1}}}});const Me=Ca.current[O][q],Ce=`Clip ${O+1}-${q+1}`;Me===Ce&&ne({type:"SET_CLIP_NAME",payload:{layerIndex:O,colIndex:q,name:ae.name}})}}else _t(`UI Generator error: ${I.data.error}`)};return _.addEventListener("message",N),()=>{_.removeEventListener("message",N),_.terminate()}},[]);const{devices:u,selectedDeviceId:f,setSelectedDeviceId:h,playAudio:d,stopAudio:g,pauseAllAudio:v,resumeAllAudio:x,setPlaybackRate:y,resetAllAudio:E,stopAllAudio:S,getAudioInfo:w,setClipVolume:D}=im();T.useRef(new Set),T.useRef(0);const U=T.useRef({}),k=T.useRef(new Map),C=T.useRef({}),M=T.useRef({}),F=T.useRef({}),H=T.useRef({}),[fe,de]=T.useState(null),[ce,le]=T.useState(!1),[Z,z]=T.useState(!1),[Q,$]=T.useState({midi:!1,artnet:!1,osc:!1,keyboard:!1}),[W,B]=T.useState(!1),[P,V]=T.useState(!1),[pe,R]=T.useState(!1),[G,ie]=T.useState(!1),[ve,te]=T.useState({title:"",initialValue:"",onSave:()=>{}}),[ge,Ee]=T.useState("files"),[Ke,ke]=T.useState([]),at=T.useRef(0),$t=T.useRef(0),Be=T.useRef(0),Ue=T.useRef(performance.now()),[ye,ne]=T.useReducer(FS,Fm(ce?fe:{})),{columns:ft,layers:ht,clipContents:Te,clipNames:Kt,thumbnailFrameIndexes:Gt,layerEffects:ut,layerAssignedDacs:Bt,layerIntensities:gn,layerAutopilots:cr,layerBlackouts:na,layerSolos:fr,masterIntensity:Aa,globalBlackout:zt,selectedLayerIndex:Ie,selectedColIndex:Je,notification:Ml,dacs:Kr,selectedDac:aa,ildaFrames:ps,selectedIldaWorkerId:ra,selectedIldaTotalFrames:ia,showBeamEffect:sa,beamAlpha:Fn,fadeAlpha:dr,playbackFps:la,previewScanRate:Pa,beamRenderMode:jn,worldShowBeamEffect:Wr,worldBeamRenderMode:nu,activeClipIndexes:Ht,isPlaying:Pn,isWorldOutputActive:Gn,selectedGeneratorId:Nl,selectedGeneratorParams:au,thumbnailRenderMode:Rl,theme:Tn,dacOutputSettings:mt}=ye,Dt=T.useMemo(()=>ht.map((_,N)=>{const I=Ht[N];if(I!==null){const O=Te[N][I];if(O){let q,me=null;if(O.type==="ilda"&&O.workerId&&O.totalFrames)return q=O.workerId,me=O.stillFrame,{type:"ilda",workerId:q,totalFrames:O.totalFrames,effects:O.effects||[],dac:O.dac||null,assignedDacs:O.assignedDacs||[],ildaFormat:O.ildaFormat||0,stillFrame:me,layerIndex:N,syncSettings:O.syncSettings||{},fps:O.fps||null};if(O.type==="generator"&&O.frames&&O.generatorDefinition)return q=`generator-${N}-${I}`,me=O.stillFrame||O.frames?.[0]||null,{type:"generator",workerId:q,totalFrames:O.frames.length,effects:O.effects||[],dac:O.dac||null,assignedDacs:O.assignedDacs||[],ildaFormat:0,stillFrame:me,layerIndex:N,syncSettings:O.syncSettings||{},fps:O.fps||null}}}return null}).filter(Boolean),[ht,Ht,Te]),Nt=T.useRef(Te),Tt=T.useRef(null),wa=T.useRef(!1),oa=T.useRef(null),Ci=T.useRef(!1);T.useEffect(()=>{Te&&(Tt.current=structuredClone(Te))},[]),T.useEffect(()=>{mt&&(oa.current=structuredClone(mt))},[]);const pr=T.useRef(gn),Mi=T.useRef(cr),zn=T.useRef(ut),Ga=T.useRef(Aa),hr=T.useRef(na),Ta=T.useRef(fr),Ft=T.useRef(zt),Jr=T.useRef(mt),hs=T.useRef(Kr),ua=T.useRef([]),vn=T.useRef(Ht),Dl=T.useRef(Bt),Ca=T.useRef(Kt),Ni=T.useRef(ra),ru=T.useRef(ia),ei=T.useRef({}),Ma=T.useRef(new Map),Cn=T.useRef(new Map),mr=T.useRef(null),ti=T.useRef({}),yn=T.useRef(null),Na=T.useRef(0),gr=T.useRef(0),vr=T.useRef(new Map),Ra=T.useRef(new Map);T.useRef(performance.now()),T.useEffect(()=>{if(wa.current){wa.current=!1;return}Te&&(Tt.current=structuredClone(Te))},[Te]),T.useEffect(()=>{if(Ci.current){Ci.current=!1;return}mt&&(oa.current=structuredClone(mt))},[mt]),T.useEffect(()=>{pr.current=gn,Mi.current=cr,zn.current=ut,Ga.current=Aa,hr.current=na,Ta.current=fr,Ft.current=zt,hs.current=Kr,ua.current=Dt,Nt.current=Te,vn.current=Ht,Dl.current=Bt,Ca.current=Kt,Ni.current=ra,ru.current=ia},[gn,Bt,cr,ut,Aa,na,fr,zt,mt,Kr,Dt,Te,Ht,Kt,ra,ia]);const bn=T.useCallback(_=>{const N=1-_*2,I=[],O=100;for(let q=0;q<O;q++){const me=q/(O-1)*2-1;I.push({x:me,y:N,r:0,g:255,b:0,blanking:!1})}return{points:I,isTypedArray:!1}},[]),ms=T.useCallback((_,N)=>{oa.current&&(oa.current[_]=N,Ci.current=!0),ne({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:_,settings:N}})},[]),gs=T.useCallback(_=>{ne({type:"SET_RENDER_SETTING",payload:{setting:"playbackFps",value:_}})},[]);T.useEffect(()=>{const _=la/60;y(_)},[la,y]);const _t=_=>{ne({type:"SET_NOTIFICATION",payload:{message:_,visible:!0}}),setTimeout(()=>{ne({type:"SET_NOTIFICATION",payload:{message:"",visible:!1}})},3e3)};T.useEffect(()=>{const _={orange:"#ff5e00",yellow:"#ffd400",cyan:"#00fff3","light-blue":"#0089ff",blue:"#005aff",magenta:"#fb00ff",red:"#ff0000",green:"#00ff00",white:"#ffffff"},N=_[Tn]||_.orange;document.documentElement.style.setProperty("--theme-color",N);const I=parseInt(N.slice(1,3),16),O=parseInt(N.slice(3,5),16),q=parseInt(N.slice(5,7),16);document.documentElement.style.setProperty("--theme-color-transparent",`rgba(${I}, ${O}, ${q}, 0.3)`),window.electronAPI&&window.electronAPI.setTheme&&window.electronAPI.setTheme(Tn)},[Tn]),T.useEffect(()=>{window.electronAPI&&window.electronAPI.setSelectedDac&&window.electronAPI.setSelectedDac(aa)},[aa]),T.useMemo(()=>{const _=new Set;return ra&&_.add(ra),Dt.forEach(N=>{N&&N.type==="ilda"&&N.workerId&&_.add(N.workerId)}),Array.from(_)},[ra,Dt]),T.useEffect(()=>{if(!a)return;const _=async xe=>{if(xe.data.type==="get-frame"&&xe.data.success)if(xe.data.isStillFrame){const{workerId:je,frame:Me,layerIndex:Ce,colIndex:Ve}=xe.data;let Ne=null;const Re=(Tt.current?Tt.current:Nt.current)?.[Ce]?.[Ve],He=Re?.effects||[];let Xe=null;const Ze=Re?.assignedDacs||[];if(Ze.length>0){const yt=Ze[0],dt=`${yt.ip}:${yt.channel}`;Xe=Jr.current[dt]}else if(aa){const yt=`${aa.ip}:${aa.channel}`;Xe=Jr.current[yt]}let et=Me;Xe&&(et=hf(Me,Xe)),Ne=await df(et,He,Ce,Ve),ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:Ce,colIndex:Ve,content:{stillFrame:Me,parsing:!1,thumbnailPath:Ne,thumbnailVersion:Date.now()}}})}else U.current[xe.data.workerId]=xe.data.frame;else if(xe.data.type==="parse-ilda"&&xe.data.success){const{workerId:je,totalFrames:Me,ildaFormat:Ce,fileName:Ve,filePath:Ne,layerIndex:Ge,colIndex:Re}=xe.data,He={type:"ilda",workerId:je,totalFrames:Me,ildaFormat:Ce,fileName:Ve,filePath:Ne,parsing:!0,playbackSettings:{mode:"fps",duration:Me/60,beats:8,speedMultiplier:1}};ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:Ge,colIndex:Re,content:He}});const Xe=Ca.current[Ge][Re],Ze=`Clip ${Ge+1}-${Re+1}`;Xe===Ze&&ne({type:"SET_CLIP_NAME",payload:{layerIndex:Ge,colIndex:Re,name:Ve}})}else if(xe.data.type==="get-all-frames"&&xe.data.success){console.log("Received get-all-frames response:",xe.data);const{frames:je,workerId:Me,layerIndex:Ce,colIndex:Ve}=xe.data;r0(async()=>{const{framesToIlda:Ne}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Ne}},[],import.meta.url).then(({framesToIlda:Ne})=>{const Ge=Ne(je),He=Nt.current[Ce][Ve].fileName||"export.ild";window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(Ge,He).then(Xe=>{Xe.success?_t(`Exported to ${Xe.filePath}`):Xe.error&&_t(`Export failed: ${Xe.error}`)})}).catch(Ne=>console.error("Failed to load ilda-writer in response:",Ne))}else if(xe.data.success===!1){_t(`Worker error: ${xe.data.error}`);const{layerIndex:je,colIndex:Me}=xe.data;je!==void 0&&Me!==void 0&&ne({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:je,colIndex:Me,status:!1}})}};a.addEventListener("message",_);let N,I,O=0;const q=60,me=1e3/q,ae=xe=>{if(xe.length===0)return null;if(xe.length===1)return xe[0];let je=0;xe.forEach((Ve,Ne)=>{const Re=Ve.points instanceof Float32Array||Ve.isTypedArray?Ve.points.length/8:Ve.points.length;je+=Re,Ne<xe.length-1&&(je+=2)});const Me=new Float32Array(je*8);let Ce=0;return xe.forEach((Ve,Ne)=>{const Ge=Ve.points instanceof Float32Array||Ve.isTypedArray,Re=Ge?Ve.points.length/8:Ve.points.length;for(let He=0;He<Re;He++){const Xe=(Ce+He)*8;if(Ge){const Ze=He*8;Me.set(Ve.points.subarray(Ze,Ze+8),Xe)}else{const Ze=Ve.points[He];Me[Xe]=Ze.x,Me[Xe+1]=Ze.y,Me[Xe+2]=Ze.z||0,Me[Xe+3]=Ze.r,Me[Xe+4]=Ze.g,Me[Xe+5]=Ze.b,Me[Xe+6]=Ze.blanking?1:0,Me[Xe+7]=Ze.lastPoint?1:0}Me[Xe+7]=0}if(Ce+=Re,Ne<xe.length-1){const He=xe[Ne+1],Xe=He.points instanceof Float32Array||He.isTypedArray,Ze=Me[(Ce-1)*8],et=Me[(Ce-1)*8+1];let yt,dt;Xe?(yt=He.points[0],dt=He.points[1]):(yt=He.points[0].x,dt=He.points[0].y);let Ot=Ce*8;Me[Ot]=Ze,Me[Ot+1]=et,Me[Ot+6]=1,Me[Ot+3]=0,Me[Ot+4]=0,Me[Ot+5]=0;let sn=(Ce+1)*8;Me[sn]=yt,Me[sn+1]=dt,Me[sn+6]=1,Me[sn+3]=0,Me[sn+4]=0,Me[sn+5]=0,Ce+=2}}),Me[(je-1)*8+7]=1,{points:Me,isTypedArray:!0}},Ae=xe=>{if(!Gn){cancelAnimationFrame(I);return}if(xe-O>me){if(window.electronAPI&&Gn){const je=new Map;ua.current.forEach(Ce=>{if(Ce&&U.current[Ce.workerId]){const Ve=Dl.current[Ce.layerIndex]||[],Ne=Ce.assignedDacs||[];let Ge=[...Ve,...Ne];Ge.length===0&&aa&&(Ge=[aa]);const Re=[],He=new Set;if(Ge.forEach(lt=>{const Oa=lt.channel!==void 0?lt.channel:lt.channels&&lt.channels.length>0?lt.channels[0].serviceID:0,Yn=`${lt.ip}:${Oa}`;He.has(Yn)||(He.add(Yn),Re.push({...lt,channel:Oa}))}),Re.length===0)return;const Ze=(Tt.current||Nt.current)[Ce.layerIndex][vn.current[Ce.layerIndex]],et=Ze?Ze.effects||[]:Ce.effects||[],yt=Ce.layerIndex,dt=zn.current[yt]||[],Ot=[...et,...dt],sn=U.current[Ce.workerId],Yt=pr.current[Ce.layerIndex],Sn=Ft.current,Wt=hr.current[Ce.layerIndex],Ha=Ta.current[Ce.layerIndex],ha=Ta.current.some(lt=>lt);let Jt=Yt;Sn?Jt=0:ha?Ha?Wt&&(Jt=0):Jt=0:Wt&&(Jt=0);const kt=Jt*Ga.current;if(kt<=0)return;const Ya=C.current[Ce.workerId]||0;Ce.syncSettings;const _i={...sn,points:Fe(sn.points)?sn.points:sn.points.map(lt=>({...lt,r:Math.round(lt.r*kt),g:Math.round(lt.g*kt),b:Math.round(lt.b*kt)}))};if(Fe(_i.points)){const lt=_i.points,Oa=lt.length/8,Yn=new Float32Array(lt);for(let Mn=0;Mn<Oa;Mn++)Yn[Mn*8+3]*=kt,Yn[Mn*8+4]*=kt,Yn[Mn*8+5]*=kt;_i.points=Yn}const Sr=Ze?Ze.playbackSettings:Ce.playbackSettings||{};let si=1;if(Sr.mode==="timeline")si=Sr.duration||1;else if(Sr.mode==="bpm"){const lt=ye.bpm||120;si=(Sr.beats||8)*60/lt}else{const lt=Sr.fps||Ce.fps||la||30;si=(Ce.totalFrames||30)/lt}const Ll=Sr.speedMultiplier||1;Ll!==0&&(si/=Ll);const qa=vl(_i,Ot,{progress:Ya,time:xe,effectStates:k.current,assignedDacs:Ce.assignedDacs,syncSettings:Ce.syncSettings||{},bpm:ye.bpm,clipDuration:si,fftLevels:l?l():i});Re.forEach((lt,Oa)=>{const Yn=lt.ip,Mn=lt.channel||(lt.channels&&lt.channels.length>0?lt.channels[0].serviceID:0);if(Mn!==void 0){const Va=`${Yn}:${Mn}`;je.has(Va)||je.set(Va,{ip:Yn,channel:Mn,type:lt.type,frames:[]});let Xa=qa;if(qa.points&&qa.points._channelDistributions){const qn=qa.points._channelDistributions.get(Oa);if(qn){const Er=qa.points.subarray(qn.start,qn.start+qn.length);Xa={...qa,points:Er}}else Xa={...qa,points:new Float32Array(0)}}if(lt.mirrorX||lt.mirrorY){const qn=Xa.points,Er=Xa.isTypedArray,Ul=Er?qn.length/8:qn.length,Vn=Er?new Float32Array(qn):qn.map(pn=>({...pn}));for(let pn=0;pn<Ul;pn++)Er?(lt.mirrorX&&(Vn[pn*8]=-Vn[pn*8]),lt.mirrorY&&(Vn[pn*8+1]=-Vn[pn*8+1])):(lt.mirrorX&&(Vn[pn].x=-Vn[pn].x),lt.mirrorY&&(Vn[pn].y=-Vn[pn].y));Xa={...Xa,points:Vn}}je.get(Va).frames.push(Xa)}})}}),hs.current.forEach(Ce=>{(Ce.channels&&Ce.channels.length>0?Ce.channels.map(Ne=>Ne.serviceID):[0]).forEach(Ne=>{const Ge=`${Ce.ip}:${Ne}`,Re=oa.current?oa.current[Ge]:Jr.current[Ge];if(Re){je.has(Ge)||je.set(Ge,{ip:Ce.ip,channel:Ne,type:Ce.type,frames:[]});const He=je.get(Ge);if(Re.testLineEnabled){const Xe=bn(Re.testLineY!==void 0?Re.testLineY:.5);He.frames=[Xe]}}})});let Me=0;je.forEach(Ce=>{let Ve=ae(Ce.frames);const Ne=`${Ce.ip}:${Ce.channel}`,Ge=oa.current?oa.current[Ne]:Jr.current[Ne];if(Ve&&Ge){if(Ge.dimmer!==void 0&&Ge.dimmer<1){const Re=Ge.dimmer,He=Ve.points,Xe=Ve.isTypedArray,Ze=Xe?He.length/8:He.length;for(let et=0;et<Ze;et++)Xe?(He[et*8+3]*=Re,He[et*8+4]*=Re,He[et*8+5]*=Re):(He[et].r*=Re,He[et].g*=Re,He[et].b*=Re)}Ve=hf(Ve,Ge)}if(Ve){Me++;const Re=Fe(Ve.points)?Ve.points.length/8:Ve.points.length;$t.current+=Re,window.electronAPI.sendFrame(Ce.ip,Ce.channel,Ve,q,Ce.type)}}),Be.current=Me}O=xe}I=requestAnimationFrame(Ae)};function Fe(xe){return!!xe&&(xe instanceof Float32Array||xe.buffer instanceof ArrayBuffer)}const $e=xe=>{const je=1e3/la,Me=ye.bpm||120,Ce=(Ne,Ge,Re)=>{F.current[Re]||(F.current[Re]=xe);let He=xe-F.current[Re];He>1e3&&(He=je),Pn&&(ti.current[Re]===void 0&&(ti.current[Re]=0),ti.current[Re]+=He);const Xe=ti.current[Re]||0,Ze=vn.current[Ge]!==null?w(Ge):null;let et=H.current[Re]||0,yt=0;const dt=Ne.totalFrames||1,Ot=Ne.playbackSettings||{mode:"fps",duration:dt/60,beats:8,speedMultiplier:1};if(Ze&&Pn&&!Ze.paused)yt=Ze.duration>0?Ze.currentTime/Ze.duration:0,et=Math.floor(yt*dt);else if(Ot.mode==="timeline"){const Sn=Ot.duration*1e3/(Ot.speedMultiplier||1);Sn>0&&(yt=Xe/Sn%1,et=Math.floor(yt*dt))}else if(Ot.mode==="bpm"){const Sn=6e4/Me,Wt=Ot.beats*Sn/(Ot.speedMultiplier||1);Wt>0&&(yt=Xe/Wt%1,et=Math.floor(yt*dt))}else{const Wt=1e3/((Ot.fps||60)*(Ot.speedMultiplier||1));if(He>=Wt){const Ha=Math.floor(He/Wt);Pn?(F.current[Re]=xe-He%Wt,et=et+Ha):F.current[Re]=xe,yt=dt>0?et%dt/dt:0}else return}Ot.mode!=="fps"&&(F.current[Re]=xe),isNaN(et)&&(et=0),isNaN(yt)&&(yt=0);const Yt=(ei.current[Re]||0)>.9&&yt<.1;if(ei.current[Re]=yt,C.current[Re]=yt,dt>0&&(et=et%dt,et<0&&(et+=dt)),Yt&&Pn){const Sn=Mi.current[Ge];if(Sn&&Sn!=="off"){const Wt=Nt.current[Ge],Ha=vn.current[Ge];let ha=-1;if(Sn==="forward")for(let Jt=1;Jt<Wt.length;Jt++){const kt=(Ha+Jt)%Wt.length,Ya=Wt[kt];if(Ya&&(Ya.type==="ilda"||Ya.type==="generator")){ha=kt;break}}else if(Sn==="random"){const Jt=Wt.map((kt,Ya)=>kt&&(kt.type==="ilda"||kt.type==="generator")?Ya:-1).filter(kt=>kt!==-1);if(Jt.length>0){const kt=Math.floor(Math.random()*Jt.length);ha=Jt[kt],ha===Ha&&Jt.length>1&&(ha=Jt[(kt+1)%Jt.length])}}ha!==-1&&ha!==Ha&&setTimeout(()=>{br(Ge,ha)},0)}}(H.current[Re]!==et||!U.current[Re])&&(H.current[Re]=et,Ne.type==="ilda"?a.postMessage({type:"get-frame",workerId:Re,frameIndex:et}):Ne.type==="generator"&&(Ne.frames&&Ne.frames.length>1?Ne.frames[et%Ne.frames.length]&&(U.current[Re]=Ne.frames[et%Ne.frames.length]):!U.current[Re]&&Ne.frames&&Ne.frames.length>0&&(U.current[Re]=Ne.frames[0])))};ht.forEach((Ne,Ge)=>{const Re=vn.current[Ge];if(Re===null)return;const Xe=(Tt.current||Nt.current)[Ge][Re];if(!Xe)return;let Ze=Xe.type==="ilda"?Xe.workerId:Xe.type==="generator"?`generator-${Ge}-${Re}`:null;Ze&&Ce(Xe,Ge,Ze)});const Ve=Ni.current;if(Ve&&!ua.current.some(Ne=>Ne.workerId===Ve)){const Ne=Ie,Ge=Je;if(Ne!==null&&Ge!==null){const He=(Tt.current||Nt.current)[Ne][Ge];He&&Ce(He,Ne,Ve)}}if(yn.current){const{layerIndex:Ne,colIndex:Ge}=yn.current,Re=vn.current[Ne]===Ge,He=Ni.current;if(!Re){const Ze=(Tt.current||Nt.current)[Ne]?.[Ge];if(Ze){let et=Ze.type==="ilda"?Ze.workerId:Ze.type==="generator"?`generator-${Ne}-${Ge}`:null;et&&et!==He&&Ce(Ze,Ne,et)}}}N=requestAnimationFrame($e)};return N=requestAnimationFrame($e),Gn?I=requestAnimationFrame(Ae):cancelAnimationFrame(I),()=>{a.removeEventListener("message",_),cancelAnimationFrame(N),cancelAnimationFrame(I)}},[a,la,Pn,Gn,aa,w,ye.bpm,Ie,Je]),T.useEffect(()=>{let _,N,I;return window.electronAPI&&(_=window.electronAPI.onClipContextMenuCommand((O,q,me)=>{if(console.log(`Clip context menu command received: ${O} for ${q}-${me}`),O==="export-ilda"){const ae=Nt.current[q][me];console.log("Exporting clip:",ae),ae&&(ae.type==="ilda"&&ae.workerId&&a?(_t("Preparing ILDA export..."),console.log("Requesting frames from worker:",ae.workerId),a.postMessage({type:"get-all-frames",workerId:ae.workerId,layerIndex:q,colIndex:me})):ae.type==="generator"&&ae.frames?(console.log("Exporting generator frames with effects..."),r0(async()=>{const{framesToIlda:Ae}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Ae}},[],import.meta.url).then(({framesToIlda:Ae})=>{const Fe=la||60;let $e=2;if(ae.playbackSettings)if(ae.playbackSettings.mode==="timeline"&&ae.playbackSettings.duration)$e=ae.playbackSettings.duration;else if(ae.playbackSettings.mode==="bpm"&&ae.playbackSettings.beats){const Ne=ye.bpm||120;$e=ae.playbackSettings.beats/Ne*60}else ae.playbackSettings.mode==="fps"&&ae.frames.length>1&&($e=ae.frames.length/Fe);const xe=Math.ceil($e*Fe),je=[],Me=new Map;for(let Ne=0;Ne<xe;Ne++){const Ge=Ne*(1e3/Fe),Re=Ne/xe,He=Math.floor(Re*ae.frames.length)%ae.frames.length,Xe=ae.frames[He];if(Xe){const Ze={...Xe},et=(ae.effects||[]).filter(Yt=>!((Yt.id==="delay"||Yt.id==="chase")&&Yt.params?.mode==="channel")),yt=vl(Ze,et,{time:Ge,progress:Re,effectStates:Me,syncSettings:ae.syncSettings||{},bpm:ye.bpm,clipDuration:$e,assignedDacs:ae.assignedDacs||[]}),dt=yt.points,Ot=dt.length/8,sn=[];for(let Yt=0;Yt<Ot;Yt++)sn.push({x:dt[Yt*8],y:dt[Yt*8+1],z:dt[Yt*8+2],r:dt[Yt*8+3],g:dt[Yt*8+4],b:dt[Yt*8+5],blanking:dt[Yt*8+6]>.5,lastPoint:dt[Yt*8+7]>.5});je.push({...yt,points:sn,frameName:`Frame ${Ne}`,companyName:"TrueLazer"})}}const Ce=Ae(je),Ve=`${ae.generatorDefinition?.name||"generator"}_export.ild`;window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(Ce,Ve).then(Ne=>{Ne.success?_t(`Exported to ${Ne.filePath}`):Ne.error&&_t(`Export failed: ${Ne.error}`)})}).catch(Ae=>console.error("Failed to export generator:",Ae))):(console.warn("Clip type not supported for export or missing data:",ae.type,ae),ae.type==="ilda"&&!ae.workerId?_t("Clip data not loaded. Please play the clip to load it."):ae.type==="generator"&&!ae.frames&&_t("Generator not rendered yet.")))}else if(O==="update-thumbnail"){const ae=Te[q][me];if(ae){if(ae.type==="ilda"&&ae.workerId&&a){const Ae=H.current[ae.workerId]||0;a.postMessage({type:"get-frame",workerId:ae.workerId,frameIndex:Ae,isStillFrame:!0,layerIndex:q,colIndex:me})}else if(ae.type==="generator"&&ae.generatorDefinition){const Ae=H.current[`generator-${q}-${me}`]||0,Fe=ae.frames?.[Ae%ae.frames.length];if(Fe){const $e=ae.effects||[];df(Fe,$e,q,me).then(xe=>{ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:q,colIndex:me,content:{stillFrame:Fe,thumbnailPath:xe,thumbnailVersion:Date.now()}}})})}}}}else if(O==="clear-clip")ne({type:"CLEAR_CLIP",payload:{layerIndex:q,colIndex:me}});else if(O==="rename-clip"){const ae=Ca.current[q][me];te({title:"Rename Clip",initialValue:ae,onSave:Ae=>ne({type:"SET_CLIP_NAME",payload:{layerIndex:q,colIndex:me,name:Ae}})}),B(!0)}else if(O==="copy-clip"){const ae={content:Nt.current[q][me],name:Ca.current[q][me]};ne({type:"SET_CLIPBOARD",payload:ae}),_t("Clip copied.")}else if(O==="cut-clip"){const ae={content:Nt.current[q][me],name:Ca.current[q][me]};ne({type:"SET_CLIPBOARD",payload:ae}),ne({type:"CLEAR_CLIP",payload:{layerIndex:q,colIndex:me}}),_t("Clip cut.")}else if(O==="paste-clip")if(ye.clipClipboard){const{content:ae,name:Ae}=ye.clipClipboard;let Fe={...ae};Fe.type==="ilda"&&(Fe.workerId=null),ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:q,colIndex:me,content:Fe}}),ne({type:"SET_CLIP_NAME",payload:{layerIndex:q,colIndex:me,name:Ae}}),_t("Clip pasted."),setTimeout(()=>{const $e=Fe;if($e.type==="generator"&&$e.generatorDefinition){const xe=`${q}-${me}`,je={...$e.generatorDefinition.defaultParams,...$e.currentParams};Ma.current.set(xe,JSON.stringify(je));const Me=++Na.current;yr(q,me,$e.generatorDefinition,$e.currentParams,Me)}},100)}else _t("Clipboard is empty.");else O==="set-trigger-style-normal"?ne({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:q,colIndex:me,style:"normal"}}):O==="set-trigger-style-toggle"?ne({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:q,colIndex:me,style:"toggle"}}):O==="set-trigger-style-flash"&&ne({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:q,colIndex:me,style:"flash"}})}),N=window.electronAPI.onLayerFullContextMenuCommand((O,q)=>{if(console.log(`Layer context menu command received: ${O} for ${q}`),O==="layer-rename"){const me=ht[q];te({title:"Rename Layer",initialValue:me,onSave:ae=>ne({type:"SET_LAYER_NAME",payload:{index:q,name:ae}})}),B(!0)}else O==="layer-clear-clips"&&ne({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:q}})}),I=window.electronAPI.onContextMenuActionFromMain(O=>{if(console.log("General context menu action received:",O),O.type==="rename-column"){const q=ft[O.index];te({title:"Rename Column",initialValue:q,onSave:me=>ne({type:"SET_COLUMN_NAME",payload:{index:O.index,name:me}})}),B(!0)}else if(O.type==="rename-layer"){const q=ht[O.index];te({title:"Rename Layer",initialValue:q,onSave:me=>ne({type:"SET_LAYER_NAME",payload:{index:O.index,name:me}})}),B(!0)}})),()=>{_&&_(),N&&N(),I&&I()}},[Te,Kt,ht,ft,a,t,ye.clipClipboard]);const vs=T.useRef(Gt);T.useEffect(()=>{for(let _=0;_<ht.length;_++)for(let N=0;N<ft.length;N++){const I=Gt[_][N],O=vs.current[_][N],q=Te[_][N],me=q?.workerId,ae=Cn.current.get(`${_}-${N}`),Ae=I!==O;(Ae||me&&!ae)&&q&&q.type==="ilda"&&me&&(console.log(`[App.jsx] Fetching still frame for ${_}-${N} at index ${I}. Reason: ${Ae?"index change":"worker ready"}`),a.postMessage({type:"get-frame",workerId:me,frameIndex:I,isStillFrame:!0,layerIndex:_,colIndex:N})),me?Cn.current.set(`${_}-${N}`,me):Cn.current.delete(`${_}-${N}`)}vs.current=Gt},[Gt,Te,ht.length,ft.length,a]),T.useEffect(()=>{t&&Te.forEach((_,N)=>{_.forEach((I,O)=>{if(I&&I.type==="generator"&&I.generatorDefinition){if(I.generatorDefinition.id==="ndi-source")return;const q=`${N}-${O}`,me={...I.generatorDefinition.defaultParams,...I.currentParams||{}},ae=JSON.stringify(me);if(Ma.current.get(q)!==ae){console.log(`[App.jsx] Generator ${q} params changed, regenerating...`);const Ae=++Na.current;yr(N,O,I.generatorDefinition,I.currentParams,Ae),Ma.current.set(q,ae)}}})})},[Te,t]),T.useEffect(()=>{if(!ye.projectLoadTimestamp||!a||!t)return;console.log("Project loaded, regenerating content...");const _=[];Te.forEach((N,I)=>{N.forEach((O,q)=>{if(O){if(O.type==="ilda"&&O.filePath&&!O.workerId)console.log(`Reparsing ILDA file for clip ${I}-${q}: ${O.filePath}`),a.postMessage({type:"load-and-parse-ilda",fileName:O.fileName,filePath:O.filePath,layerIndex:I,colIndex:q});else if(O.type==="generator"&&O.generatorDefinition){console.log(`Regenerating generator clip ${I}-${q} on project load`);const me=++Na.current;yr(I,q,O.generatorDefinition,O.currentParams,me)}O.audioFile&&O.audioFile.path&&window.electronAPI&&window.electronAPI.checkFileExists&&_.push(window.electronAPI.checkFileExists(O.audioFile.path).then(me=>{me||ke(ae=>{const Ae=`audio-${I}-${q}`;return ae.some(Fe=>Fe.requestId===Ae)?ae:[...ae,{filePath:O.audioFile.path,fileName:O.audioFile.name||O.audioFile.path.split(/[/\\]/).pop(),requestId:Ae,type:"audio"}]})}))}})})},[ye.projectLoadTimestamp,a,t]),T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onUpdateThumbnailRenderMode){const _=window.electronAPI.onUpdateThumbnailRenderMode(N=>{console.log("App.jsx: Received thumbnail mode update:",N),ne({type:"SET_THUMBNAIL_RENDER_MODE",payload:N})});return()=>_()}},[]);const ca=T.useRef(ye);T.useEffect(()=>{ca.current=ye},[ye]),T.useEffect(()=>{let _,N,I,O,q;return window.electronAPI&&(_=window.electronAPI.on("new-project",()=>ne({type:"RESET_STATE"})),N=window.electronAPI.on("open-project",()=>{}),I=window.electronAPI.on("save-project",()=>{console.log("Saving project with state:",ca.current),window.electronAPI.send("save-project",ca.current)}),O=window.electronAPI.on("save-project-as",()=>{console.log("Saving project AS with state:",ca.current),window.electronAPI.send("save-project-as",ca.current)}),q=window.electronAPI.on("load-project-data",me=>{ne({type:"LOAD_PROJECT",payload:me})})),()=>{_&&_(),N&&N(),I&&I(),O&&O(),q&&q()}},[]),T.useEffect(()=>{let _,N;return(async()=>{if(window.electronAPI&&window.electronAPI.getAllSettings){const O=await window.electronAPI.getAllSettings();O&&(O.shortcutsState&&$(O.shortcutsState),ne({type:"LOAD_SETTINGS",payload:O}))}})(),window.electronAPI&&(_=window.electronAPI.onMenuAction(O=>{if(console.log("Menu action received:",O),O==="output-settings")V(!0);else if(O==="settings-audio-output")R(!0);else if(O==="settings-audio-fft")ie(!0);else if(O.startsWith("set-theme-")){const q=O.split("set-theme-")[1];ne({type:"SET_THEME",payload:q})}else if(O==="shortcuts-window"||O.startsWith("open-")&&O.endsWith("-settings"))z(!0);else if(O.startsWith("toggle-")){const q=O.split("-");if(q.length===3){const me=q[1],ae=q[2]==="true";$(Ae=>({...Ae,[me]:ae}))}}}),N=window.electronAPI.onRenderSettingsCommand(O=>{console.log("Render settings command received:",O),ne({type:"SET_RENDER_SETTING",payload:{setting:O.setting,value:O.value}})})),()=>{_&&_(),N&&N()}},[]),T.useEffect(()=>{if(!a)return;const _=async N=>{if(N.data.type==="request-file-content"){const{filePath:I,requestId:O}=N.data;try{if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(I))throw new Error(`File not found: ${I}`);const q=await window.electronAPI.readFileForWorker(I);a.postMessage({type:"file-content-response",requestId:O,arrayBuffer:q},[q])}catch(q){console.warn(`File missing or read error: ${I}`,q.message);const me=I.split(/[/\\]/).pop();ke(ae=>ae.some(Ae=>Ae.requestId===O)?ae:[...ae,{filePath:I,fileName:me,requestId:O}])}}else if(N.data.type==="parsing-status"){const{layerIndex:I,colIndex:O,status:q}=N.data;ne({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:I,colIndex:O,status:q}}),q||ne({type:"SET_CLIP_PARSING_FAILED",payload:{layerIndex:I,colIndex:O,failed:!0}})}};return a.addEventListener("message",_),()=>{a.removeEventListener("message",_)}},[a]),T.useEffect(()=>{if(!a)return;const _=[];Te.forEach((N,I)=>{N.forEach((O,q)=>{O&&O.type==="ilda"&&O.filePath&&!O.workerId&&!O.parsing&&!O.parsingFailed&&_.push({layerIndex:I,colIndex:q,fileName:O.fileName,filePath:O.filePath})})}),_.length>0&&(console.log(`Triggering re-parse for ${_.length} clips.`),ne({type:"SET_BULK_PARSING_STATUS",payload:_.map(N=>({layerIndex:N.layerIndex,colIndex:N.colIndex,status:!0}))}),_.forEach(N=>{a.postMessage({type:"load-and-parse-ilda",fileName:N.fileName,filePath:N.filePath,layerIndex:N.layerIndex,colIndex:N.colIndex})}))},[Te,a]);const _l=Tt.current||Te;if(Ie!==null){const _=ut[Ie]||[];if(Je!==null)[..._l[Ie][Je]?.effects||[],..._];else{const N=Ht[Ie];N!==null&&[..._l[Ie][N]?.effects||[],..._]}}const xn=T.useCallback((_,N,I,O,q)=>{if(Tt.current&&Tt.current[_]&&Tt.current[_][N]){const me=Tt.current[_][N];me&&me.effects&&me.effects[I]&&(me.effects[I].params[O]=q,wa.current=!0)}ne({type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:_,colIndex:N,effectIndex:I,paramName:O,newValue:q}})},[]);T.useEffect(()=>{if(!t)return;const _=N=>{if(N.data.layerIndex!==void 0&&N.data.colIndex!==void 0){const I=`${N.data.layerIndex}-${N.data.colIndex}`;if(vr.current.set(I,!1),Ra.current.has(I)){const{message:O,transferables:q}=Ra.current.get(I);Ra.current.delete(I),console.log(`[App.jsx] Generator ${I} free, processing pending seq ${O.seq}`),vr.current.set(I,!0),t.postMessage(O,q)}}if(N.data.success){const{layerIndex:I,colIndex:O,frames:q,generatorDefinition:me,currentParams:ae,isLive:Ae,seq:Fe}=N.data;if(Fe!==void 0){if(Fe<gr.current)return;gr.current=Fe}const $e=`generator-${I}-${O}`;if(U.current[$e]=q[0],!Ae&&Fe===Na.current){const xe={type:"generator",generatorDefinition:me,frames:q,stillFrame:q[0],currentParams:ae,playbackSettings:{mode:"fps",duration:q.length/60,beats:8,speedMultiplier:1}};ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:I,colIndex:O,content:xe}});const je=Ca.current[I][O],Me=`Clip ${I+1}-${O+1}`;je===Me&&ne({type:"SET_CLIP_NAME",payload:{layerIndex:I,colIndex:O,name:me.name}})}else window.electronAPI&&window.electronAPI.ndiSignalReady&&window.electronAPI.ndiSignalReady()}else _t(`Error generating frames: ${N.data.error}`)};return t.addEventListener("message",_),()=>{t.removeEventListener("message",_)}},[t,ye.clipContents]);const ys=T.useCallback((_,N,I)=>{if(t){const O=`${_}-${N}`,q={...I.defaultParams};Ma.current.set(O,JSON.stringify(q));const me=++Na.current;yr(_,N,I,I.defaultParams,me)}},[t]),yr=async(_,N,I,O,q)=>{const me={...I.defaultParams,...O},ae=`${_}-${N}`;let Ae=null;if(["text","ndi-source","spout-receiver"].includes(I.id)){const xe="src/fonts/Geometr415 Blk BT Black.ttf";let je=me.fontUrl||xe;["https://raw.githubusercontent.com/google/fonts/main/ofl/roboto/Roboto-Regular.ttf","https://raw.githubusercontent.com/googlefonts/roboto-2/main/src/hinted/Roboto-Regular.ttf"].includes(je)&&(je=xe);try{if(je.startsWith("http"))if(window.electronAPI&&window.electronAPI.fetchUrlAsArrayBuffer)Ae=await window.electronAPI.fetchUrlAsArrayBuffer(je);else throw new Error("URL fetching API is not available.");else if(window.electronAPI&&window.electronAPI.readFileForWorker)Ae=await window.electronAPI.readFileForWorker(je);else throw new Error("File reading API is not available.")}catch(Ce){console.error(`Failed to load font for text generator at ${_}-${N}:`,Ce),_t(`Font error: ${Ce.message}`);return}}const Fe={type:"generate",layerIndex:_,colIndex:N,generator:I,params:me,fontBuffer:Ae,seq:q},$e=Ae?[Ae]:[];vr.current.get(ae)?(console.log(`[App.jsx] Generator ${ae} busy, queuing seq ${q}`),Ra.current.set(ae,{message:Fe,transferables:$e})):(vr.current.set(ae,!0),r.current&&r.current.postMessage(Fe,$e))},Hn=T.useCallback(_=>{g(_),ne({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:_}})},[g]),fa=T.useCallback(()=>{S(),ne({type:"CLEAR_ALL_ACTIVE_CLIPS"})},[S]),ni=T.useCallback(()=>{x(),ht.forEach((_,N)=>{const I=Ht[N];if(I!==null){const O=Te[N][I];O&&O.audioFile&&!w(N)&&d(N,O.audioFile.path,O.audioVolume??1,!0)}}),ne({type:"SET_IS_PLAYING",payload:!0}),ne({type:"SET_IS_STOPPED",payload:!1})},[x,ht,Ht,Te,w,d]),ai=T.useCallback(()=>{v(),ne({type:"SET_IS_PLAYING",payload:!1}),ne({type:"SET_IS_STOPPED",payload:!1})},[v]),da=T.useCallback(()=>{E(),v(),ne({type:"SET_IS_PLAYING",payload:!1}),ne({type:"SET_IS_STOPPED",payload:!0}),H.current={}},[E,v]),ri=T.useCallback((_,N)=>{ne({type:"SET_SELECTED_CLIP",payload:{layerIndex:_,colIndex:N}});const I=Te[_][N];if(I&&I.type==="ilda")ne({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:I.workerId,totalFrames:I.totalFrames,generatorId:null,generatorParams:{}}});else if(I&&I.type==="generator"){const O=`generator-${_}-${N}`;ne({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:O,generatorId:I.generatorDefinition.id,generatorParams:I.currentParams,totalFrames:I.frames.length}})}else ne({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:null,totalFrames:0,generatorId:null,generatorParams:{}}})},[Te]),Ol=T.useCallback((_,N,I)=>{I?yn.current={layerIndex:_,colIndex:N}:yn.current&&yn.current.layerIndex===_&&yn.current.colIndex===N&&(yn.current=null)},[]),br=T.useCallback((_,N,I=!0)=>{const O=Te[_][N];if(!O){I&&(ri(_,N),Hn(_));return}const q=O.triggerStyle||"normal",me=Ht[_];if(q==="normal"){if(!I)return}else if(q==="toggle"){if(!I)return;if(me===N){Hn(_);return}}else if(q==="flash"&&!I){me===N&&Hn(_);return}if(O&&O.type==="generator"&&O.frames&&O.frames.length>0){const ae=`generator-${_}-${N}`;U.current[ae]=O.frames[0],F.current[ae]=performance.now(),H.current[ae]=0}else O&&O.type==="ilda"&&O.workerId&&(F.current[O.workerId]=performance.now(),H.current[O.workerId]=0);if(O&&O.audioFile?d(_,O.audioFile.path,O.audioVolume??1,Pn).catch(ae=>{console.warn(`Failed to play audio for clip ${_}-${N}:`,ae),ke(Ae=>{const Fe=`audio-${_}-${N}`;return Ae.some($e=>$e.requestId===Fe)?Ae:[...Ae,{filePath:O.audioFile.path,fileName:O.audioFile.name||O.audioFile.path.split(/[/\\]/).pop(),requestId:Fe,type:"audio"}]})}):g(_),M.current[_]=performance.now(),ne({type:"SET_ACTIVE_CLIP",payload:{layerIndex:_,colIndex:N}}),O){if(O.type==="ilda"&&O.workerId){const ae=H.current[O.workerId]||0;ne({type:"UPDATE_THUMBNAIL",payload:{layerIndex:_,colIndex:N,frameIndex:ae}})}else if(O.type==="generator"&&O.frames){const ae=H.current[`generator-${_}-${N}`]||0,Ae=O.frames[ae%O.frames.length];Ae&&ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:_,colIndex:N,content:{stillFrame:Ae}}})}}},[Te,Ht,Hn,d,Pn,g,ri]),bs=T.useCallback((_,N,I)=>{if(Tt.current&&Tt.current[_]&&Tt.current[_][N]){const O=Tt.current[_][N];if(O){const q={...I,instanceId:Wo(),params:{...I.defaultParams}};O.effects=[...O.effects||[],q],wa.current=!0}}ne({type:"ADD_CLIP_EFFECT",payload:{layerIndex:_,colIndex:N,effect:I}})},[]),iu=T.useCallback((_,N)=>{const I=rn.find(O=>(O.id||O.name)===N);if(I){if(zn.current&&zn.current[_]){const O={...I,instanceId:Wo(),params:{...I.defaultParams}};zn.current[_].push(O)}ne({type:"ADD_LAYER_EFFECT",payload:{layerIndex:_,effect:I}})}},[]),su=T.useCallback((_,N,I)=>{wa.current=!0,ne({type:"SET_CLIP_DAC",payload:{layerIndex:_,colIndex:N,dac:I}})},[]),Ri=T.useCallback((_,N)=>{ne({type:"SET_LAYER_DAC",payload:{layerIndex:_,dac:N}})},[]),xs=_=>{window.electronAPI&&window.electronAPI.showLayerFullContextMenu&&window.electronAPI.showLayerFullContextMenu(_)},Ss=_=>{window.electronAPI&&window.electronAPI.showColumnContextMenu&&window.electronAPI.showColumnContextMenu(_)},Da=_=>{ht.forEach((N,I)=>{const O=Te[I][_];O&&(O.type==="ilda"||O.type==="generator")?br(I,_):Hn(I)})},xr=T.useCallback(_=>{ne({type:"SET_SELECTED_DAC",payload:_})},[]),kl=T.useCallback(_=>{ne({type:"SET_DACS",payload:_})},[]),Es=(_,N)=>{if(Ie!==null&&Je!==null){let I=null,O={};if(Tt.current&&Tt.current[Ie]&&Tt.current[Ie][Je]){const Ae=Tt.current[Ie][Je];Ae&&Ae.currentParams&&(Ae.currentParams[_]=N,wa.current=!0,I=Ae,O=Ae.currentParams)}if(I||(I=Te[Ie][Je],I&&I.currentParams&&(O={...I.currentParams,[_]:N})),!I||!I.generatorDefinition)return;ne({type:"UPDATE_GENERATOR_PARAM",payload:{layerIndex:Ie,colIndex:Je,paramName:_,newValue:N}});const q=`${Ie}-${Je}`,me={...I.generatorDefinition.defaultParams,...O};Ma.current.set(q,JSON.stringify(me));const ae=++Na.current;yr(Ie,Je,I.generatorDefinition,O,ae)}},cn=Ie!==null&&Je!==null?Te[Ie][Je]:null;T.useEffect(()=>{if(!window.electronAPI||!t)return;(async()=>{let N=null;ht.forEach((O,q)=>{const me=Ht[q];if(me!==null){const ae=Te[q][me];ae&&ae.type==="generator"&&ae.generatorDefinition?.id==="ndi-source"&&(N=ae)}}),!N&&cn?.type==="generator"&&cn?.generatorDefinition?.id==="ndi-source"&&(N=cn);const I=N?.currentParams?.sourceName;I&&I!=="No Source"?I!==mr.current&&(console.log(`[NDI] Switching to source: ${I}`),await window.electronAPI.ndiCreateReceiver(I),mr.current=I):mr.current&&(console.log("[NDI] Destroying receiver"),await window.electronAPI.ndiDestroyReceiver(),mr.current=null)})()},[Ht,Te,cn,ht]),T.useEffect(()=>{const _=[...Dt,cn].find(N=>N?.type==="generator"&&N?.generatorDefinition?.id==="ndi-source");if(_&&window.electronAPI?.ndiUpdateSettings){const{captureWidth:N,captureHeight:I}=_.currentParams||{};N&&I&&window.electronAPI.ndiUpdateSettings({width:N,height:I})}},[Dt,cn]),T.useEffect(()=>{if(!window.electronAPI||!t)return;const _=window.electronAPI.onNdiFrame(N=>{vn.current.forEach((I,O)=>{if(I===null)return;const q=Nt.current[O][I];q&&q.type==="generator"&&q.generatorDefinition?.id==="ndi-source"&&t.postMessage({type:"generate",layerIndex:O,colIndex:I,generator:q.generatorDefinition,params:{...q.generatorDefinition.defaultParams,...q.currentParams},ndiFrame:N,isLive:!0})}),cn?.type==="generator"&&cn?.generatorDefinition?.id==="ndi-source"&&t.postMessage({type:"generate",layerIndex:Ie,colIndex:Je,generator:cn.generatorDefinition,params:{...cn.generatorDefinition.defaultParams,...cn.currentParams},ndiFrame:N,isLive:!0})});return()=>_()},[Ht,Te,cn,Ie,Je,ht,t]);const za=T.useCallback((_,N,I=127,O="noteon")=>{if(N===0&&!_.endsWith("_intensity")&&_!=="master_intensity"&&_!=="master_speed"&&!_.startsWith("clip_")&&_!=="bpm_value"&&_!=="bpm_fine_up"&&_!=="bpm_fine_down"&&!_.startsWith("quick_")&&!_.startsWith("dimmer_"))return;const q=N/I;switch(_){case"transport_play":N>0&&ni();break;case"transport_pause":N>0&&ai();break;case"transport_stop":N>0&&da();break;case"comp_blackout":N>0&&ne({type:"TOGGLE_GLOBAL_BLACKOUT"});break;case"comp_clear":N>0&&fa();break;case"master_intensity":ne({type:"SET_MASTER_INTENSITY",payload:q});break;case"master_speed":const me=Math.max(1,Math.round(q*120));gs(me);break;case"laser_output":N>0&&ne({type:"TOGGLE_WORLD_OUTPUT_ACTIVE"});break;case"bpm_value":if(O==="controlchange"){let ae=0;N<=10?ae=N:N>=118&&(ae=N-128),ae!==0&&ne({type:"SET_BPM",payload:Math.max(1,Math.min(999,(ye.bpm||120)+ae))})}break;case"bpm_fine_up":N>0&&ne({type:"SET_BPM",payload:Math.min(999,(ye.bpm||120)+.1)});break;case"bpm_fine_down":N>0&&ne({type:"SET_BPM",payload:Math.max(1,(ye.bpm||120)-.1)});break;case"bpm_tap":break;default:if(_.startsWith("layer_")){const ae=_.split("_"),Ae=parseInt(ae[1]),Fe=ae[2];Fe==="blackout"&&N>0?ne({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:Ae}}):Fe==="solo"&&N>0?ne({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:Ae}}):Fe==="intensity"?ne({type:"SET_LAYER_INTENSITY",payload:{layerIndex:Ae,intensity:q}}):Fe==="clear"&&N>0&&Hn(Ae)}else if(_.startsWith("clip_")){const ae=_.split("_"),Ae=parseInt(ae[1]),Fe=parseInt(ae[2]);ae[3]==="preview"?N>0&&ri(Ae,Fe):br(Ae,Fe,N>0)}else if(_.startsWith("column_")){const ae=_.split("_"),Ae=parseInt(ae[1]);N>0&&Da(Ae)}else if(_.startsWith("quick_knob_")){const ae=parseInt(_.split("_")[2]);ne({type:"UPDATE_QUICK_CONTROL",payload:{type:"knob",index:ae,value:q}})}else if(_.startsWith("quick_btn_")){const ae=parseInt(_.split("_")[2]);N>0&&ne({type:"TOGGLE_QUICK_BUTTON",payload:{index:ae}})}else if(_.startsWith("dimmer_")){const ae=_.replace("dimmer_","").replace(/_/g,"."),Ae=mt[ae]||{};ne({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:ae,settings:{...Ae,dimmer:q}}})}else{const ae=_.split("_");if(ae.length>=2&&Ie!==null&&Je!==null){const Ae=Te[Ie][Je];if(Ae&&Ae.effects){const Fe=ae[0],$e=ae.slice(1).join("_"),xe=Ae.effects.findIndex(je=>je.id===Fe);if(xe!==-1){const Me=rn.find(Ce=>Ce.id===Fe)?.paramControls.find(Ce=>Ce.id===$e);if(Me){let Ce=q;Me.type==="range"||Me.type==="number"?Ce=Me.min+(Me.max-Me.min)*q:Me.type==="checkbox"&&(Ce=q>.5),ne({type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:Ie,colIndex:Je,effectIndex:xe,paramName:$e,newValue:Ce}})}}}}}}},[ni,ai,da,fa,Hn,gs,ye.bpm,ri,br,Da,Te,Ie,Je,mt]),pa=T.useCallback(_=>{if(_==="world"){const I=!(ye.worldShowBeamEffect??!0);if(ne({type:"SET_RENDER_SETTING",payload:{setting:"worldShowBeamEffect",value:I}}),window.electronAPI&&window.electronAPI.setRenderSettings){const O={...ye.renderSettings,showBeamEffect:ye.showBeamEffect,beamRenderMode:ye.beamRenderMode,previewScanRate:ye.previewScanRate,beamAlpha:ye.beamAlpha,fadeAlpha:ye.fadeAlpha,worldShowBeamEffect:I,worldBeamRenderMode:ye.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(O)}}else{const N=!sa;if(ne({type:"SET_RENDER_SETTING",payload:{setting:"showBeamEffect",value:N}}),window.electronAPI&&window.electronAPI.setRenderSettings){const I={showBeamEffect:N,beamRenderMode:jn,previewScanRate:Pa,beamAlpha:Fn,fadeAlpha:dr,worldShowBeamEffect:ye.worldShowBeamEffect??!0,worldBeamRenderMode:ye.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(I)}}},[sa,jn,Pa,Fn,dr,ye.worldShowBeamEffect,ye.worldBeamRenderMode]),As=T.useCallback(_=>{if(_==="world"){const N=ye.worldBeamRenderMode??"both";let I="points";if(N==="both"?I="points":N==="points"?I="lines":N==="lines"&&(I="both"),ne({type:"SET_RENDER_SETTING",payload:{setting:"worldBeamRenderMode",value:I}}),window.electronAPI&&window.electronAPI.setRenderSettings){const O={showBeamEffect:sa,beamRenderMode:jn,previewScanRate:Pa,beamAlpha:Fn,fadeAlpha:dr,worldShowBeamEffect:ye.worldShowBeamEffect??!0,worldBeamRenderMode:I};window.electronAPI.setRenderSettings(O)}}else{let N="points";if(jn==="both"?N="points":jn==="points"?N="lines":jn==="lines"&&(N="both"),ne({type:"SET_RENDER_SETTING",payload:{setting:"beamRenderMode",value:N}}),window.electronAPI&&window.electronAPI.setRenderSettings){const I={showBeamEffect:sa,beamRenderMode:N,previewScanRate:Pa,beamAlpha:Fn,fadeAlpha:dr,worldShowBeamEffect:ye.worldShowBeamEffect??!0,worldBeamRenderMode:ye.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(I)}}},[sa,jn,Pa,Fn,dr,ye.worldShowBeamEffect,ye.worldBeamRenderMode]),ii=T.useCallback(()=>{const _=!Gn;ne({type:"SET_WORLD_OUTPUT_ACTIVE",payload:_}),window.electronAPI&&(_?ye.dacs.forEach(N=>{window.electronAPI.startDacOutput(N.ip,N.type)}):ye.dacs.forEach(N=>{window.electronAPI.stopDacOutput(N.ip,N.type)}))},[Gn,ye.dacs]),_a=async _=>{if(!(!window.electronAPI||!window.electronAPI.showOpenDialog))try{const N=await window.electronAPI.showOpenDialog({title:`Locate missing file: ${_.fileName}`,defaultPath:_.filePath,filters:[{name:"ILDA Files",extensions:["ild"]},{name:"All Files",extensions:["*"]}],properties:["openFile"]});if(N){const I=N,O=window.electronAPI.pathSeparator||(I.includes("/")?"/":"\\");if(ne({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:_.filePath,newPath:I}}),_.type!=="audio"){const xe=await window.electronAPI.readFileForWorker(I);a&&a.postMessage({type:"file-content-response",requestId:_.requestId,arrayBuffer:xe},[xe])}ke(xe=>xe.filter(je=>je.requestId!==_.requestId));const q=xe=>xe.substring(0,xe.lastIndexOf(O)),me=xe=>xe.substring(xe.lastIndexOf(O)+1),ae=q(_.filePath),Ae=q(I);console.log(`[Relocate] Scanning for other files moving from [${ae}] to [${Ae}]`);const Fe=ca.current.clipContents.flat().filter(xe=>xe),$e=new Set([_.filePath]);for(const xe of Fe){if(xe.type==="ilda"&&xe.filePath&&!$e.has(xe.filePath)&&q(xe.filePath)===ae){const je=me(xe.filePath),Me=`${Ae}${O}${je}`;xe.filePath!==Me&&await window.electronAPI.checkFileExists(Me)&&(console.log(`[Relocate] Auto-resolving ILDA: ${je}`),ne({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:xe.filePath,newPath:Me}}),$e.add(xe.filePath),a&&ke(Ve=>Ve.filter(Ne=>Ne.filePath!==xe.filePath)))}if(xe.audioFile&&xe.audioFile.path&&!$e.has(xe.audioFile.path)&&q(xe.audioFile.path)===ae){const je=me(xe.audioFile.path),Me=`${Ae}${O}${je}`;xe.audioFile.path!==Me&&await window.electronAPI.checkFileExists(Me)&&(console.log(`[Relocate] Auto-resolving Audio: ${je}`),ne({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:xe.audioFile.path,newPath:Me}}),$e.add(xe.audioFile.path),ke(Ve=>Ve.filter(Ne=>Ne.filePath!==xe.audioFile.path)))}}}}catch(N){console.error("Relocation failed:",N),_t(`Relocation failed: ${N.message}`)}},ws=T.useCallback((_,N)=>{console.log(`Thumbnail load error for ${_}-${N}, requesting regeneration...`);const I=Nt.current[_][N];if(I)if(I.type==="ilda"&&I.workerId&&a){const O=Gt[_][N]||0;a.postMessage({type:"get-frame",workerId:I.workerId,frameIndex:O,isStillFrame:!0,layerIndex:_,colIndex:N})}else I.type==="generator"&&I.stillFrame&&df(I.stillFrame,I.effects,_,N).then(O=>{O&&ne({type:"SET_CLIP_CONTENT",payload:{layerIndex:_,colIndex:N,content:{thumbnailPath:O,thumbnailVersion:Date.now()}}})})},[Nt,Gt,a]),Di=T.useCallback((_,N)=>{const I=Nt.current[_][N];I&&I.audioFile&&ke(O=>{const q=`audio-${_}-${N}`;return O.some(me=>me.requestId===q)?O:[...O,{filePath:I.audioFile.path,fileName:I.audioFile.name||I.audioFile.path.split(/[/\\]/).pop(),requestId:q,type:"audio"}]})},[Nt]);return m.jsx(kv,{onMidiCommand:za,children:m.jsx(Lv,{onArtnetCommand:(_,N)=>za(_,N,255),children:m.jsxs(Uv,{onCommand:za,enabled:Q.keyboard,children:[m.jsx(jS,{isPlaying:Pn,globalBlackout:zt,layerBlackouts:na,layerSolos:fr,isWorldOutputActive:Gn,clipContents:Te,activeClipIndexes:Ht,theme:Tn,bpm:ye.bpm,quickAssigns:ye.quickAssigns}),m.jsx(jy,{}),m.jsx("div",{className:"app",children:m.jsxs(Oy,{children:[m.jsx(vy,{message:Ml.message,visible:Ml.visible}),m.jsx(Ry,{show:P,onClose:()=>V(!1),dacs:Kr,dacSettings:mt,onUpdateDacSettings:ms}),m.jsx(Dy,{show:pe||G,onClose:()=>{R(!1),ie(!1)},initialTab:G?"fft":"output"}),m.jsx(My,{show:W,title:ve.title,initialValue:ve.initialValue,onSave:ve.onSave,onClose:()=>z(!1)||B(!1)}),m.jsx(_y,{missingFiles:Ke,onRelocate:_a,onClose:()=>ke([])}),m.jsxs("div",{className:"main-content",children:[m.jsxs("div",{className:"top-bar-left-area",children:[m.jsx(Bv,{masterIntensity:ye.masterIntensity,onMasterIntensityChange:_=>ne({type:"SET_MASTER_INTENSITY",payload:_}),onClearAllActive:fa,isGlobalBlackout:zt,onToggleGlobalBlackout:()=>ne({type:"TOGGLE_GLOBAL_BLACKOUT"})}),m.jsx(BS,{isWorldOutputActive:Gn,onToggleWorldOutput:ii})]}),m.jsxs("div",{className:"layer-controls-container",children:[ht.map((_,N)=>{const I=Dt.find(q=>{const me=Ht[N];if(me===null)return!1;const ae=Te[N][me];return ae?ae.type==="ilda"?q.workerId===ae.workerId:ae.type==="generator"?q.workerId===`generator-${N}-${me}`:!1:!1})||null,O=I?U.current[I.workerId]:null;return m.jsx(ty,{layerName:_,index:N,onDropEffect:q=>iu(N,q),onDropDac:(q,me)=>Ri(q,me),layerEffects:ut[N],activeClipData:I,liveFrame:O,thumbnailRenderMode:Rl,intensity:ye.layerIntensities[N],onIntensityChange:q=>ne({type:"SET_LAYER_INTENSITY",payload:{layerIndex:N,intensity:q}}),onDeactivateLayerClips:()=>Hn(N),onShowLayerFullContextMenu:()=>xs(N),isBlackout:na[N],isSolo:fr[N],onToggleBlackout:()=>ne({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:N}}),onToggleSolo:()=>ne({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:N}}),onLayerSelect:q=>ne({type:"SET_SELECTED_CLIP",payload:{layerIndex:q,colIndex:null}})},N)}),"          "]}),m.jsx("div",{className:"clip-deck-container",children:m.jsxs("div",{className:"clip-deck",children:[m.jsx("div",{className:"column-headers-container",children:ft.map((_,N)=>m.jsx(Fv,{name:_,index:N,onTrigger:()=>Da(N),onShowColumnHeaderContextMenu:()=>Ss(N)},N))}),ht.map((_,N)=>m.jsx("div",{className:"layer-row",children:ft.map((I,O)=>{const q=Te?.[N]?.[O];let me=null;q&&q.type==="ilda"?me=q.workerId:q&&q.type==="generator"&&(me=`generator-${N}-${O}`);const ae=me?U.current[me]:null,Ae=q?.stillFrame||(q?.type==="generator"?q.frames?.[0]:null);return m.jsx(ay,{layerIndex:N,colIndex:O,clipName:Kt?.[N]?.[O]||`Clip ${N+1}-${O+1}`,clipContent:q,thumbnailFrameIndex:Gt[N][O],thumbnailRenderMode:Rl,liveFrame:ae,stillFrame:Ae,onActivateClick:Fe=>br(N,O,Fe),isActive:Ht[N]===O,onUnsupportedFile:_t,onDropEffect:Fe=>bs(N,O,Fe),onDropGenerator:ys,onDropDac:(Fe,$e,xe)=>{su(Fe,$e,xe)},onLabelClick:()=>ri(N,O),isSelected:Ie===N&&Je===O,ildaParserWorker:a,onClipHover:Ol,onThumbnailError:ws},O)})},N))]})}),m.jsx(PS,{clipContents:Te,activeClipIndexes:Ht,layerEffects:ut,bpm:ye.bpm,playbackFps:la,selectedLayerIndex:Ie,selectedColIndex:Je,liveFramesRef:U,progressRef:C,selectedDac:aa,liveDacOutputSettingsRef:oa,dacOutputSettings:mt,getAudioInfo:w,fftLevels:i,getFftLevels:l,effectStatesRef:k,clipActivationTimesRef:M,showBeamEffect:sa,beamAlpha:Fn,fadeAlpha:dr,previewScanRate:Pa,beamRenderMode:jn,worldShowBeamEffect:Wr,worldBeamRenderMode:nu,masterIntensity:Aa,layerIntensities:gn,globalBlackout:zt,layerSolos:fr,layerBlackouts:na,handleToggleBeamEffect:pa,handleCycleDisplayMode:As,previewFrameCountRef:at,totalPointsSentRef:$t,activeChannelsCountRef:Be,lastStatUpdateTimeRef:Ue}),m.jsxs("div",{className:"middle-bar",children:[m.jsx("div",{className:"middle-bar-left-area",children:m.jsx(Ey,{bpm:ye.bpm,onBpmChange:_=>ne({type:"SET_BPM",payload:_})})}),m.jsxs("div",{className:"middle-bar-mid-area",children:[m.jsx(Ay,{onPlay:ni,onPause:ai,onStop:da,isPlaying:Pn,isStopped:ye.isStopped}),m.jsx(IS,{playbackFps:la,onSpeedChange:gs})]}),"          			",m.jsx("div",{className:"middle-bar-right-area",children:m.jsx("p",{children:" Right Section of Middle-Bar"})})]}),"          ",m.jsxs("div",{className:"bottom-panel",children:[m.jsxs("div",{className:"bottom-panel-tabs-container",children:[m.jsxs("div",{className:"bottom-panel-tabs",children:[m.jsx("button",{className:`tab-button ${ge==="files"?"active":""}`,onClick:()=>Ee("files"),children:"Files"}),m.jsx("button",{className:`tab-button ${ge==="generators"?"active":""}`,onClick:()=>Ee("generators"),children:"Generators"}),m.jsx("button",{className:`tab-button ${ge==="effects"?"active":""}`,onClick:()=>Ee("effects"),children:"Effects"})]}),m.jsxs("div",{className:"bottom-panel-tab-content",children:[ge==="files"&&m.jsx(ry,{onDropIld:(_,N,I)=>a.postMessage({type:"parse-ilda",file:I,layerIndex:_,colIndex:N})}),ge==="generators"&&m.jsx(iy,{}),ge==="effects"&&m.jsx(sy,{})]})]}),m.jsx(ly,{dacs:Kr,onDacSelected:xr,onDacsDiscovered:kl,dacSettings:mt,onUpdateDacSettings:ms}),m.jsx(gy,{selectedLayerIndex:Ie,autopilotMode:Ie!==null?ye.layerAutopilots[Ie]:"off",onAutopilotChange:_=>ne({type:"SET_LAYER_AUTOPILOT",payload:{layerIndex:Ie,mode:_}}),layerEffects:Ie!==null?ut[Ie]:[],assignedDacs:Ie!==null&&ye.layerAssignedDacs?ye.layerAssignedDacs[Ie]:[],onToggleDacMirror:(_,N,I)=>ne({type:"TOGGLE_LAYER_DAC_MIRROR",payload:{layerIndex:_,dacIndex:N,axis:I}}),onRemoveDac:(_,N)=>ne({type:"REMOVE_LAYER_DAC",payload:{layerIndex:_,dacIndex:N}}),onAddEffect:_=>Ie!==null&&ne({type:"ADD_LAYER_EFFECT",payload:{layerIndex:Ie,effect:_}}),onRemoveEffect:_=>Ie!==null&&ne({type:"REMOVE_LAYER_EFFECT",payload:{layerIndex:Ie,effectIndex:_}}),onParamChange:(_,N,I)=>Ie!==null&&ne({type:"UPDATE_LAYER_EFFECT_PARAMETER",payload:{layerIndex:Ie,effectIndex:_,paramName:N,newValue:I}})}),m.jsx(my,{selectedLayerIndex:Ie,selectedColIndex:Je,clip:cn,audioInfo:w(Ie),bpm:ye.bpm,getFftLevels:l,onAssignAudio:async()=>{const _=await window.electronAPI.showAudioFileDialog();if(_){const N=_.split(/[\\/]/).pop();ne({type:"SET_CLIP_AUDIO",payload:{layerIndex:Ie,colIndex:Je,audioFile:{path:_,name:N}}})}},onRemoveAudio:()=>{g(Ie),ne({type:"REMOVE_CLIP_AUDIO",payload:{layerIndex:Ie,colIndex:Je}})},onUpdateAudioVolume:(_,N,I)=>{ne({type:"SET_CLIP_AUDIO_VOLUME",payload:{layerIndex:_,colIndex:N,volume:I}}),D(_,I)},onUpdatePlaybackSettings:(_,N,I)=>ne({type:"UPDATE_CLIP_PLAYBACK_SETTINGS",payload:{layerIndex:_,colIndex:N,settings:I}}),onSetParamSync:(_,N)=>ne({type:"SET_CLIP_PARAM_SYNC",payload:{layerIndex:Ie,colIndex:Je,paramId:_,syncMode:N}}),onToggleDacMirror:(_,N,I,O)=>ne({type:"TOGGLE_CLIP_DAC_MIRROR",payload:{layerIndex:_,colIndex:N,dacIndex:I,axis:O}}),onRemoveDac:_=>ne({type:"REMOVE_CLIP_DAC",payload:{layerIndex:Ie,colIndex:Je,dacIndex:_}}),onRemoveEffect:(_,N,I)=>ne({type:"REMOVE_CLIP_EFFECT",payload:{layerIndex:_,colIndex:N,effectIndex:I}}),onReorderEffects:(_,N,I,O)=>ne({type:"REORDER_CLIP_EFFECTS",payload:{layerIndex:_,colIndex:N,oldIndex:I,newIndex:O}}),onAddEffect:_=>ne({type:"ADD_CLIP_EFFECT",payload:{layerIndex:Ie,colIndex:Je,effect:_}}),onParameterChange:xn,onGeneratorParameterChange:Es,progressRef:C,onAudioError:Di}),m.jsx(Cy,{enabledShortcuts:Q,onOpenOutputSettings:()=>V(!0),onOpenShortcutsSettings:()=>z(!0),quickAssigns:ye.quickAssigns,onUpdateKnob:(_,N)=>{const I=ye.quickAssigns.knobs[_];I&&I.link&&(I.link.targetType==="effect"||I.link.targetType==="generator"||I.link.targetType==="layerEffect")&&(wa.current=!0),ne({type:"UPDATE_QUICK_CONTROL",payload:{type:"knob",index:_,value:N}})},onToggleButton:_=>{const N=ye.quickAssigns.buttons[_],I=N.link;I&&(I.targetType==="transport"?I.paramName==="play"?ni():I.paramName==="pause"?ai():I.paramName==="stop"&&da():I.targetType==="global"?I.paramName==="blackout"?ne({type:"TOGGLE_GLOBAL_BLACKOUT"}):I.paramName==="laser_output"?ne({type:"TOGGLE_WORLD_OUTPUT_ACTIVE"}):I.paramName==="clear"&&fa():wa.current=!0),ne({type:"UPDATE_QUICK_CONTROL",payload:{type:"button",index:_,value:!N.value}})},onAssign:(_,N,I)=>ne({type:"ASSIGN_QUICK_CONTROL",payload:{type:_,index:N,link:I}})})]})]})]})})]})})})}Ev.createRoot(document.getElementById("root")).render(m.jsx(yy,{children:m.jsx(Ly,{children:m.jsxs(Uy,{children:[" ",m.jsx(py,{children:m.jsx(GS,{})})]})})}));
