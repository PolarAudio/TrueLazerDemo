(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=r(l);fetch(l.href,u)}})();function Nf(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ef={exports:{}},bl={};var $h;function gv(){if($h)return bl;$h=1;var a=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(i,l,u){var f=null;if(u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),"key"in l){u={};for(var h in l)h!=="key"&&(u[h]=l[h])}else u=l;return l=u.ref,{$$typeof:a,type:i,key:f,ref:l!==void 0?l:null,props:u}}return bl.Fragment=t,bl.jsx=r,bl.jsxs=r,bl}var Wh;function vv(){return Wh||(Wh=1,ef.exports=gv()),ef.exports}var m=vv(),tf={exports:{}},nt={};var Kh;function yv(){if(Kh)return nt;Kh=1;var a=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),E=Symbol.iterator;function y(_){return _===null||typeof _!="object"?null:(_=E&&_[E]||_["@@iterator"],typeof _=="function"?_:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,A={};function N(_,z,ie){this.props=_,this.context=z,this.refs=A,this.updater=ie||x}N.prototype.isReactComponent={},N.prototype.setState=function(_,z){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,z,"setState")},N.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};function D(){}D.prototype=N.prototype;function L(_,z,ie){this.props=_,this.context=z,this.refs=A,this.updater=ie||x}var M=L.prototype=new D;M.constructor=L,S(M,N.prototype),M.isPureReactComponent=!0;var C=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},V=Object.prototype.hasOwnProperty;function te(_,z,ie,ve,ne,he){return ie=he.ref,{$$typeof:a,type:_,key:z,ref:ie!==void 0?ie:null,props:he}}function de(_,z){return te(_.type,z,void 0,void 0,void 0,_.props)}function ye(_){return typeof _=="object"&&_!==null&&_.$$typeof===a}function pe(_){var z={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function(ie){return z[ie]})}var q=/\/+/g;function j(_,z){return typeof _=="object"&&_!==null&&_.key!=null?pe(""+_.key):z.toString(36)}function $(){}function W(_){switch(_.status){case"fulfilled":return _.value;case"rejected":throw _.reason;default:switch(typeof _.status=="string"?_.then($,$):(_.status="pending",_.then(function(z){_.status==="pending"&&(_.status="fulfilled",_.value=z)},function(z){_.status==="pending"&&(_.status="rejected",_.reason=z)})),_.status){case"fulfilled":return _.value;case"rejected":throw _.reason}}throw _}function J(_,z,ie,ve,ne){var he=typeof _;(he==="undefined"||he==="boolean")&&(_=null);var xe=!1;if(_===null)xe=!0;else switch(he){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(_.$$typeof){case a:case t:xe=!0;break;case v:return xe=_._init,J(xe(_._payload),z,ie,ve,ne)}}if(xe)return ne=ne(_),xe=ve===""?"."+j(_,0):ve,C(ne)?(ie="",xe!=null&&(ie=xe.replace(q,"$&/")+"/"),J(ne,z,ie,"",function(st){return st})):ne!=null&&(ye(ne)&&(ne=de(ne,ie+(ne.key==null||_&&_.key===ne.key?"":(""+ne.key).replace(q,"$&/")+"/")+xe)),z.push(ne)),1;xe=0;var Ye=ve===""?".":ve+":";if(C(_))for(var Be=0;Be<_.length;Be++)ve=_[Be],he=Ye+j(ve,Be),xe+=J(ve,z,ie,he,ne);else if(Be=y(_),typeof Be=="function")for(_=Be.call(_),Be=0;!(ve=_.next()).done;)ve=ve.value,he=Ye+j(ve,Be++),xe+=J(ve,z,ie,he,ne);else if(he==="object"){if(typeof _.then=="function")return J(W(_),z,ie,ve,ne);throw z=String(_),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return xe}function U(_,z,ie){if(_==null)return _;var ve=[],ne=0;return J(_,ve,"","",function(he){return z.call(ie,he,ne++)}),ve}function G(_){if(_._status===-1){var z=_._result;z=z(),z.then(function(ie){(_._status===0||_._status===-1)&&(_._status=1,_._result=ie)},function(ie){(_._status===0||_._status===-1)&&(_._status=2,_._result=ie)}),_._status===-1&&(_._status=0,_._result=z)}if(_._status===1)return _._result.default;throw _._result}var X=typeof reportError=="function"?reportError:function(_){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof _=="object"&&_!==null&&typeof _.message=="string"?String(_.message):String(_),error:_});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",_);return}console.error(_)};function me(){}return nt.Children={map:U,forEach:function(_,z,ie){U(_,function(){z.apply(this,arguments)},ie)},count:function(_){var z=0;return U(_,function(){z++}),z},toArray:function(_){return U(_,function(z){return z})||[]},only:function(_){if(!ye(_))throw Error("React.Children.only expected to receive a single React element child.");return _}},nt.Component=N,nt.Fragment=r,nt.Profiler=l,nt.PureComponent=L,nt.StrictMode=i,nt.Suspense=d,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,nt.__COMPILER_RUNTIME={__proto__:null,c:function(_){return B.H.useMemoCache(_)}},nt.cache=function(_){return function(){return _.apply(null,arguments)}},nt.cloneElement=function(_,z,ie){if(_==null)throw Error("The argument must be a React element, but you passed "+_+".");var ve=S({},_.props),ne=_.key,he=void 0;if(z!=null)for(xe in z.ref!==void 0&&(he=void 0),z.key!==void 0&&(ne=""+z.key),z)!V.call(z,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&z.ref===void 0||(ve[xe]=z[xe]);var xe=arguments.length-2;if(xe===1)ve.children=ie;else if(1<xe){for(var Ye=Array(xe),Be=0;Be<xe;Be++)Ye[Be]=arguments[Be+2];ve.children=Ye}return te(_.type,ne,void 0,void 0,he,ve)},nt.createContext=function(_){return _={$$typeof:f,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null},_.Provider=_,_.Consumer={$$typeof:u,_context:_},_},nt.createElement=function(_,z,ie){var ve,ne={},he=null;if(z!=null)for(ve in z.key!==void 0&&(he=""+z.key),z)V.call(z,ve)&&ve!=="key"&&ve!=="__self"&&ve!=="__source"&&(ne[ve]=z[ve]);var xe=arguments.length-2;if(xe===1)ne.children=ie;else if(1<xe){for(var Ye=Array(xe),Be=0;Be<xe;Be++)Ye[Be]=arguments[Be+2];ne.children=Ye}if(_&&_.defaultProps)for(ve in xe=_.defaultProps,xe)ne[ve]===void 0&&(ne[ve]=xe[ve]);return te(_,he,void 0,void 0,null,ne)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(_){return{$$typeof:h,render:_}},nt.isValidElement=ye,nt.lazy=function(_){return{$$typeof:v,_payload:{_status:-1,_result:_},_init:G}},nt.memo=function(_,z){return{$$typeof:g,type:_,compare:z===void 0?null:z}},nt.startTransition=function(_){var z=B.T,ie={};B.T=ie;try{var ve=_(),ne=B.S;ne!==null&&ne(ie,ve),typeof ve=="object"&&ve!==null&&typeof ve.then=="function"&&ve.then(me,X)}catch(he){X(he)}finally{B.T=z}},nt.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},nt.use=function(_){return B.H.use(_)},nt.useActionState=function(_,z,ie){return B.H.useActionState(_,z,ie)},nt.useCallback=function(_,z){return B.H.useCallback(_,z)},nt.useContext=function(_){return B.H.useContext(_)},nt.useDebugValue=function(){},nt.useDeferredValue=function(_,z){return B.H.useDeferredValue(_,z)},nt.useEffect=function(_,z,ie){var ve=B.H;if(typeof ie=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ve.useEffect(_,z)},nt.useId=function(){return B.H.useId()},nt.useImperativeHandle=function(_,z,ie){return B.H.useImperativeHandle(_,z,ie)},nt.useInsertionEffect=function(_,z){return B.H.useInsertionEffect(_,z)},nt.useLayoutEffect=function(_,z){return B.H.useLayoutEffect(_,z)},nt.useMemo=function(_,z){return B.H.useMemo(_,z)},nt.useOptimistic=function(_,z){return B.H.useOptimistic(_,z)},nt.useReducer=function(_,z,ie){return B.H.useReducer(_,z,ie)},nt.useRef=function(_){return B.H.useRef(_)},nt.useState=function(_){return B.H.useState(_)},nt.useSyncExternalStore=function(_,z,ie){return B.H.useSyncExternalStore(_,z,ie)},nt.useTransition=function(){return B.H.useTransition()},nt.version="19.1.1",nt}var Jh;function Rf(){return Jh||(Jh=1,tf.exports=yv()),tf.exports}var T=Rf();const _n=Nf(T);var nf={exports:{}},xl={},af={exports:{}},rf={};var e0;function bv(){return e0||(e0=1,(function(a){function t(U,G){var X=U.length;U.push(G);e:for(;0<X;){var me=X-1>>>1,_=U[me];if(0<l(_,G))U[me]=G,U[X]=_,X=me;else break e}}function r(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var G=U[0],X=U.pop();if(X!==G){U[0]=X;e:for(var me=0,_=U.length,z=_>>>1;me<z;){var ie=2*(me+1)-1,ve=U[ie],ne=ie+1,he=U[ne];if(0>l(ve,X))ne<_&&0>l(he,ve)?(U[me]=he,U[ne]=X,me=ne):(U[me]=ve,U[ie]=X,me=ie);else if(ne<_&&0>l(he,X))U[me]=he,U[ne]=X,me=ne;else break e}}return G}function l(U,G){var X=U.sortIndex-G.sortIndex;return X!==0?X:U.id-G.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var f=Date,h=f.now();a.unstable_now=function(){return f.now()-h}}var d=[],g=[],v=1,E=null,y=3,x=!1,S=!1,A=!1,N=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function C(U){for(var G=r(g);G!==null;){if(G.callback===null)i(g);else if(G.startTime<=U)i(g),G.sortIndex=G.expirationTime,t(d,G);else break;G=r(g)}}function B(U){if(A=!1,C(U),!S)if(r(d)!==null)S=!0,V||(V=!0,j());else{var G=r(g);G!==null&&J(B,G.startTime-U)}}var V=!1,te=-1,de=5,ye=-1;function pe(){return N?!0:!(a.unstable_now()-ye<de)}function q(){if(N=!1,V){var U=a.unstable_now();ye=U;var G=!0;try{e:{S=!1,A&&(A=!1,L(te),te=-1),x=!0;var X=y;try{t:{for(C(U),E=r(d);E!==null&&!(E.expirationTime>U&&pe());){var me=E.callback;if(typeof me=="function"){E.callback=null,y=E.priorityLevel;var _=me(E.expirationTime<=U);if(U=a.unstable_now(),typeof _=="function"){E.callback=_,C(U),G=!0;break t}E===r(d)&&i(d),C(U)}else i(d);E=r(d)}if(E!==null)G=!0;else{var z=r(g);z!==null&&J(B,z.startTime-U),G=!1}}break e}finally{E=null,y=X,x=!1}G=void 0}}finally{G?j():V=!1}}}var j;if(typeof M=="function")j=function(){M(q)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,W=$.port2;$.port1.onmessage=q,j=function(){W.postMessage(null)}}else j=function(){D(q,0)};function J(U,G){te=D(function(){U(a.unstable_now())},G)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(U){U.callback=null},a.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<U?Math.floor(1e3/U):5},a.unstable_getCurrentPriorityLevel=function(){return y},a.unstable_next=function(U){switch(y){case 1:case 2:case 3:var G=3;break;default:G=y}var X=y;y=G;try{return U()}finally{y=X}},a.unstable_requestPaint=function(){N=!0},a.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var X=y;y=U;try{return G()}finally{y=X}},a.unstable_scheduleCallback=function(U,G,X){var me=a.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?me+X:me):X=me,U){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=X+_,U={id:v++,callback:G,priorityLevel:U,startTime:X,expirationTime:_,sortIndex:-1},X>me?(U.sortIndex=X,t(g,U),r(d)===null&&U===r(g)&&(A?(L(te),te=-1):A=!0,J(B,X-me))):(U.sortIndex=_,t(d,U),S||x||(S=!0,V||(V=!0,j()))),U},a.unstable_shouldYield=pe,a.unstable_wrapCallback=function(U){var G=y;return function(){var X=y;y=G;try{return U.apply(this,arguments)}finally{y=X}}}})(rf)),rf}var t0;function xv(){return t0||(t0=1,af.exports=bv()),af.exports}var sf={exports:{}},gn={};var n0;function Sv(){if(n0)return gn;n0=1;var a=Rf();function t(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(d,g,v){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:d,containerInfo:g,implementation:v}}var f=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,g){if(d==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return gn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,gn.createPortal=function(d,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(t(299));return u(d,g,null,v)},gn.flushSync=function(d){var g=f.T,v=i.p;try{if(f.T=null,i.p=2,d)return d()}finally{f.T=g,i.p=v,i.d.f()}},gn.preconnect=function(d,g){typeof d=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(d,g))},gn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},gn.preinit=function(d,g){if(typeof d=="string"&&g&&typeof g.as=="string"){var v=g.as,E=h(v,g.crossOrigin),y=typeof g.integrity=="string"?g.integrity:void 0,x=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;v==="style"?i.d.S(d,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:E,integrity:y,fetchPriority:x}):v==="script"&&i.d.X(d,{crossOrigin:E,integrity:y,fetchPriority:x,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},gn.preinitModule=function(d,g){if(typeof d=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var v=h(g.as,g.crossOrigin);i.d.M(d,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(d)},gn.preload=function(d,g){if(typeof d=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var v=g.as,E=h(v,g.crossOrigin);i.d.L(d,v,{crossOrigin:E,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},gn.preloadModule=function(d,g){if(typeof d=="string")if(g){var v=h(g.as,g.crossOrigin);i.d.m(d,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(d)},gn.requestFormReset=function(d){i.d.r(d)},gn.unstable_batchedUpdates=function(d,g){return d(g)},gn.useFormState=function(d,g,v){return f.H.useFormState(d,g,v)},gn.useFormStatus=function(){return f.H.useHostTransitionStatus()},gn.version="19.1.1",gn}var a0;function $0(){if(a0)return sf.exports;a0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),sf.exports=Sv(),sf.exports}var r0;function Ev(){if(r0)return xl;r0=1;var a=xv(),t=Rf(),r=$0();function i(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function f(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(u(e)!==e)throw Error(i(188))}function d(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(i(188));return n!==e?null:e}for(var s=e,o=n;;){var c=s.return;if(c===null)break;var p=c.alternate;if(p===null){if(o=c.return,o!==null){s=o;continue}break}if(c.child===p.child){for(p=c.child;p;){if(p===s)return h(c),e;if(p===o)return h(c),n;p=p.sibling}throw Error(i(188))}if(s.return!==o.return)s=c,o=p;else{for(var b=!1,w=c.child;w;){if(w===s){b=!0,s=c,o=p;break}if(w===o){b=!0,o=c,s=p;break}w=w.sibling}if(!b){for(w=p.child;w;){if(w===s){b=!0,s=p,o=c;break}if(w===o){b=!0,o=p,s=c;break}w=w.sibling}if(!b)throw Error(i(189))}}if(s.alternate!==o)throw Error(i(190))}if(s.tag!==3)throw Error(i(188));return s.stateNode.current===s?e:n}function g(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=g(e),n!==null)return n;e=e.sibling}return null}var v=Object.assign,E=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),M=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),ye=Symbol.for("react.activity"),pe=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function j(e){return e===null||typeof e!="object"?null:(e=q&&e[q]||e["@@iterator"],typeof e=="function"?e:null)}var $=Symbol.for("react.client.reference");function W(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===$?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case N:return"Profiler";case A:return"StrictMode";case B:return"Suspense";case V:return"SuspenseList";case ye:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case x:return"Portal";case M:return(e.displayName||"Context")+".Provider";case L:return(e._context.displayName||"Context")+".Consumer";case C:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case te:return n=e.displayName||null,n!==null?n:W(e.type)||"Memo";case de:n=e._payload,e=e._init;try{return W(e(n))}catch{}}return null}var J=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},me=[],_=-1;function z(e){return{current:e}}function ie(e){0>_||(e.current=me[_],me[_]=null,_--)}function ve(e,n){_++,me[_]=e.current,e.current=n}var ne=z(null),he=z(null),xe=z(null),Ye=z(null);function Be(e,n){switch(ve(xe,n),ve(he,e),ve(ne,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Ah(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Ah(n),e=Th(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}ie(ne),ve(ne,e)}function st(){ie(ne),ie(he),ie(xe)}function At(e){e.memoizedState!==null&&ve(Ye,e);var n=ne.current,s=Th(n,e.type);n!==s&&(ve(he,e),ve(ne,s))}function Ie(e){he.current===e&&(ie(ne),ie(he)),Ye.current===e&&(ie(Ye),hl._currentValue=X)}var Ke=Object.prototype.hasOwnProperty,rt=a.unstable_scheduleCallback,mt=a.unstable_cancelCallback,we=a.unstable_shouldYield,se=a.unstable_requestPaint,Fe=a.unstable_now,xt=a.unstable_getCurrentPriorityLevel,Rt=a.unstable_ImmediatePriority,Je=a.unstable_UserBlockingPriority,Ue=a.unstable_NormalPriority,vn=a.unstable_LowPriority,Yn=a.unstable_IdlePriority,qn=a.log,Es=a.unstable_setDisableYieldValue,Ea=null,an=null;function yn(e){if(typeof qn=="function"&&Es(e),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Ea,e)}catch{}}var Ht=Math.clz32?Math.clz32:Ge,Di=Math.log,mr=Math.LN2;function Ge(e){return e>>>=0,e===0?32:31-(Di(e)/mr|0)|0}var ft=256,Kr=4194304;function On(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function An(e,n,s){var o=e.pendingLanes;if(o===0)return 0;var c=0,p=e.suspendedLanes,b=e.pingedLanes;e=e.warmLanes;var w=o&134217727;return w!==0?(o=w&~p,o!==0?c=On(o):(b&=w,b!==0?c=On(b):s||(s=w&~e,s!==0&&(c=On(s))))):(w=o&~p,w!==0?c=On(w):b!==0?c=On(b):s||(s=o&~e,s!==0&&(c=On(s)))),c===0?0:n!==0&&n!==c&&(n&p)===0&&(p=c&-c,s=n&-n,p>=s||p===32&&(s&4194048)!==0)?n:c}function _i(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function gr(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oi(){var e=ft;return ft<<=1,(ft&4194048)===0&&(ft=256),e}function Ia(){var e=Kr;return Kr<<=1,(Kr&62914560)===0&&(Kr=4194304),e}function wa(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function Vn(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function kn(e,n,s,o,c,p){var b=e.pendingLanes;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=s,e.entangledLanes&=s,e.errorRecoveryDisabledLanes&=s,e.shellSuspendCounter=0;var w=e.entanglements,I=e.expirationTimes,Q=e.hiddenUpdates;for(s=b&~s;0<s;){var le=31-Ht(s),fe=1<<le;w[le]=0,I[le]=-1;var K=Q[le];if(K!==null)for(Q[le]=null,le=0;le<K.length;le++){var ee=K[le];ee!==null&&(ee.lane&=-536870913)}s&=~fe}o!==0&&Aa(e,o,0),p!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=p&~(b&~n))}function Aa(e,n,s){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-Ht(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|s&4194090}function sa(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var o=31-Ht(s),c=1<<o;c&n|e[o]&n&&(e[o]|=n),s&=~c}}function ws(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function As(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Yt(){var e=G.p;return e!==0?e:(e=window.event,e===void 0?32:Yh(e.type))}function la(e,n){var s=G.p;try{return G.p=e,n()}finally{G.p=s}}var rn=Math.random().toString(36).slice(2),sn="__reactFiber$"+rn,bn="__reactProps$"+rn,Ba="__reactContainer$"+rn,vr="__reactEvents$"+rn,Tn="__reactListeners$"+rn,Fa="__reactHandles$"+rn,Zt="__reactResources$"+rn,dt="__reactMarker$"+rn;function Xn(e){delete e[sn],delete e[bn],delete e[vr],delete e[Tn],delete e[Fa]}function dn(e){var n=e[sn];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Ba]||s[sn]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=Rh(e);e!==null;){if(s=e[sn])return s;e=Rh(e)}return n}e=s,s=e.parentNode}return null}function Ta(e){if(e=e[sn]||e[Ba]){var n=e.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return e}return null}function ja(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(i(33))}function Pa(e){var n=e[Zt];return n||(n=e[Zt]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Dt(e){e[dt]=!0}var Jr=new Set,Ts={};function oa(e,n){Ga(e,n),Ga(e+"Capture",n)}function Ga(e,n){for(Ts[e]=n,e=0;e<n.length;e++)Jr.add(n[e])}var Ul=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ei={},Cs={};function Ms(e){return Ke.call(Cs,e)?!0:Ke.call(ei,e)?!1:Ul.test(e)?Cs[e]=!0:(ei[e]=!0,!1)}function Zn(e,n,s){if(Ms(n))if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+s)}}function ti(e,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+s)}}function ln(e,n,s,o){if(o===null)e.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttributeNS(n,s,""+o)}}var ni,Il;function za(e){if(ni===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);ni=n&&n[1]||"",Il=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ni+e+Il}var Ha=!1;function ai(e,n){if(!e||Ha)return"";Ha=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(ee){var K=ee}Reflect.construct(e,[],fe)}else{try{fe.call()}catch(ee){K=ee}e.call(fe.prototype)}}else{try{throw Error()}catch(ee){K=ee}(fe=e())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(ee){if(ee&&K&&typeof ee.stack=="string")return[ee.stack,K.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=o.DetermineComponentFrameRoot(),b=p[0],w=p[1];if(b&&w){var I=b.split(`
`),Q=w.split(`
`);for(c=o=0;o<I.length&&!I[o].includes("DetermineComponentFrameRoot");)o++;for(;c<Q.length&&!Q[c].includes("DetermineComponentFrameRoot");)c++;if(o===I.length||c===Q.length)for(o=I.length-1,c=Q.length-1;1<=o&&0<=c&&I[o]!==Q[c];)c--;for(;1<=o&&0<=c;o--,c--)if(I[o]!==Q[c]){if(o!==1||c!==1)do if(o--,c--,0>c||I[o]!==Q[c]){var le=`
`+I[o].replace(" at new "," at ");return e.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",e.displayName)),le}while(1<=o&&0<=c);break}}}finally{Ha=!1,Error.prepareStackTrace=s}return(s=e?e.displayName||e.name:"")?za(s):""}function ki(e){switch(e.tag){case 26:case 27:case 5:return za(e.type);case 16:return za("Lazy");case 13:return za("Suspense");case 19:return za("SuspenseList");case 0:case 15:return ai(e.type,!1);case 11:return ai(e.type.render,!1);case 1:return ai(e.type,!0);case 31:return za("Activity");default:return""}}function ri(e){try{var n="";do n+=ki(e),e=e.return;while(e);return n}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}function qt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ya(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Li(e){var n=Ya(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),o=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var c=s.get,p=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return c.call(this)},set:function(b){o=""+b,p.call(this,b)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function ua(e){e._valueTracker||(e._valueTracker=Li(e))}function Ca(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),o="";return e&&(o=Ya(e)?e.checked?"true":"false":e.value),e=o,e!==s?(n.setValue(e),!0):!1}function Ui(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Bl=/[\n"\\]/g;function xn(e){return e.replace(Bl,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Ft(e,n,s,o,c,p,b,w){e.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?e.type=b:e.removeAttribute("type"),n!=null?b==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+qt(n)):e.value!==""+qt(n)&&(e.value=""+qt(n)):b!=="submit"&&b!=="reset"||e.removeAttribute("value"),n!=null?Ma(e,b,qt(n)):s!=null?Ma(e,b,qt(s)):o!=null&&e.removeAttribute("value"),c==null&&p!=null&&(e.defaultChecked=!!p),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+qt(w):e.removeAttribute("name")}function Ns(e,n,s,o,c,p,b,w){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||s!=null){if(!(p!=="submit"&&p!=="reset"||n!=null))return;s=s!=null?""+qt(s):"",n=n!=null?""+qt(n):s,w||n===e.value||(e.value=n),e.defaultValue=n}o=o??c,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=w?e.checked:!!o,e.defaultChecked=!!o,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(e.name=b)}function Ma(e,n,s){n==="number"&&Ui(e.ownerDocument)===e||e.defaultValue===""+s||(e.defaultValue=""+s)}function qa(e,n,s,o){if(e=e.options,n){n={};for(var c=0;c<s.length;c++)n["$"+s[c]]=!0;for(s=0;s<e.length;s++)c=n.hasOwnProperty("$"+e[s].value),e[s].selected!==c&&(e[s].selected=c),c&&o&&(e[s].defaultSelected=!0)}else{for(s=""+qt(s),n=null,c=0;c<e.length;c++){if(e[c].value===s){e[c].selected=!0,o&&(e[c].defaultSelected=!0);return}n!==null||e[c].disabled||(n=e[c])}n!==null&&(n.selected=!0)}}function Fl(e,n,s){if(n!=null&&(n=""+qt(n),n!==e.value&&(e.value=n),s==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=s!=null?""+qt(s):""}function jl(e,n,s,o){if(n==null){if(o!=null){if(s!=null)throw Error(i(92));if(J(o)){if(1<o.length)throw Error(i(93));o=o[0]}s=o}s==null&&(s=""),n=s}s=qt(n),e.defaultValue=s,o=e.textContent,o===s&&o!==""&&o!==null&&(e.value=o)}function Qn(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var Na=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ii(e,n,s){var o=n.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,s):typeof s!="number"||s===0||Na.has(n)?n==="float"?e.cssFloat=s:e[n]=(""+s).trim():e[n]=s+"px"}function si(e,n,s){if(n!=null&&typeof n!="object")throw Error(i(62));if(e=e.style,s!=null){for(var o in s)!s.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var c in n)o=n[c],n.hasOwnProperty(c)&&s[c]!==o&&ii(e,c,o)}else for(var p in n)n.hasOwnProperty(p)&&ii(e,p,n[p])}function yr(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ii=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),li=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bi(e){return li.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Va=null;function Rs(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var br=null,xr=null;function Pl(e){var n=Ta(e);if(n&&(e=n.stateNode)){var s=e[bn]||null;e:switch(e=n.stateNode,n.type){case"input":if(Ft(e,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+xn(""+n)+'"][type="radio"]'),n=0;n<s.length;n++){var o=s[n];if(o!==e&&o.form===e.form){var c=o[bn]||null;if(!c)throw Error(i(90));Ft(o,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(n=0;n<s.length;n++)o=s[n],o.form===e.form&&Ca(o)}break e;case"textarea":Fl(e,s.value,s.defaultValue);break e;case"select":n=s.value,n!=null&&qa(e,!!s.multiple,n,!1)}}}var Ds=!1;function Gl(e,n,s){if(Ds)return e(n,s);Ds=!0;try{var o=e(n);return o}finally{if(Ds=!1,(br!==null||xr!==null)&&(Ao(),br&&(n=br,e=xr,xr=br=null,Pl(n),e)))for(n=0;n<e.length;n++)Pl(e[n])}}function Xa(e,n){var s=e.stateNode;if(s===null)return null;var o=s[bn]||null;if(o===null)return null;s=o[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(i(231,n,typeof s));return s}var ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_s=!1;if(ca)try{var oi={};Object.defineProperty(oi,"passive",{get:function(){_s=!0}}),window.addEventListener("test",oi,oi),window.removeEventListener("test",oi,oi)}catch{_s=!1}var kt=null,Fi=null,Sr=null;function zl(){if(Sr)return Sr;var e,n=Fi,s=n.length,o,c="value"in kt?kt.value:kt.textContent,p=c.length;for(e=0;e<s&&n[e]===c[e];e++);var b=s-e;for(o=1;o<=b&&n[s-o]===c[p-o];o++);return Sr=c.slice(e,1<o?1-o:void 0)}function ji(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function ui(){return!0}function Hl(){return!1}function pn(e){function n(s,o,c,p,b){this._reactName=s,this._targetInst=c,this.type=o,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(s=e[w],this[w]=s?s(p):p[w]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?ui:Hl,this.isPropagationStopped=Hl,this}return v(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=ui)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=ui)},persist:function(){},isPersistent:ui}),n}var Za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},O=pn(Za),R=v({},Za,{view:0,detail:0}),F=pn(R),k,H,ce,ae=v({},R,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gt,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ce&&(ce&&e.type==="mousemove"?(k=e.screenX-ce.screenX,H=e.screenY-ce.screenY):H=k=0,ce=e),k)},movementY:function(e){return"movementY"in e?e.movementY:H}}),Ee=pn(ae),Oe=v({},ae,{dataTransfer:0}),Xe=pn(Oe),ge=v({},R,{relatedTarget:0}),ke=pn(ge),Me=v({},Za,{animationName:0,elapsedTime:0,pseudoElement:0}),Te=pn(Me),qe=v({},Za,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ce=pn(qe),je=v({},Za,{data:0}),Ne=pn(je),He={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tt(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=$e[e])?!!n[e]:!1}function gt(){return tt}var vt=v({},R,{key:function(e){if(e.key){var n=He[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=ji(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gt,charCode:function(e){return e.type==="keypress"?ji(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ji(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lt=pn(vt),on=v({},ae,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jt=pn(on),Cn=v({},R,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gt}),hn=pn(Cn),Qa=v({},Za,{propertyName:0,elapsedTime:0,pseudoElement:0}),fa=pn(Qa),Kt=v({},ae,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pt=pn(Kt),$a=v({},Za,{newState:0,oldState:0}),Pi=pn($a),Er=[9,13,27,32],Wa=ca&&"CompositionEvent"in window,wr=null;ca&&"documentMode"in document&&(wr=document.documentMode);var Ka=ca&&"TextEvent"in window&&!wr,lt=ca&&(!Wa||wr&&8<wr&&11>=wr),da=" ",Ln=!1;function $n(e,n){switch(e){case"keyup":return Er.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gi(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mn=!1;function pa(e,n){switch(e){case"compositionend":return Gi(n);case"keypress":return n.which!==32?null:(Ln=!0,da);case"textInput":return e=n.data,e===da&&Ln?null:e;default:return null}}function ci(e,n){if(Mn)return e==="compositionend"||!Wa&&$n(e,n)?(e=zl(),Sr=Fi=kt=null,Mn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return lt&&n.locale!=="ko"?null:n.data;default:return null}}var uu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!uu[e.type]:n==="textarea"}function Sn(e,n,s,o){br?xr?xr.push(o):xr=[o]:br=o,n=Do(n,"onChange"),0<n.length&&(s=new O("onChange","change",null,s,o),e.push({event:s,listeners:n}))}var Os=null,ks=null;function qm(e){bh(e,0)}function Yl(e){var n=ja(e);if(Ca(n))return e}function Pf(e,n){if(e==="change")return n}var Gf=!1;if(ca){var cu;if(ca){var fu="oninput"in document;if(!fu){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),fu=typeof zf.oninput=="function"}cu=fu}else cu=!1;Gf=cu&&(!document.documentMode||9<document.documentMode)}function Hf(){Os&&(Os.detachEvent("onpropertychange",Yf),ks=Os=null)}function Yf(e){if(e.propertyName==="value"&&Yl(ks)){var n=[];Sn(n,ks,e,Rs(e)),Gl(qm,n)}}function Vm(e,n,s){e==="focusin"?(Hf(),Os=n,ks=s,Os.attachEvent("onpropertychange",Yf)):e==="focusout"&&Hf()}function Xm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Yl(ks)}function Zm(e,n){if(e==="click")return Yl(n)}function Qm(e,n){if(e==="input"||e==="change")return Yl(n)}function $m(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Un=typeof Object.is=="function"?Object.is:$m;function Ls(e,n){if(Un(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),o=Object.keys(n);if(s.length!==o.length)return!1;for(o=0;o<s.length;o++){var c=s[o];if(!Ke.call(n,c)||!Un(e[c],n[c]))return!1}return!0}function qf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vf(e,n){var s=qf(e);e=0;for(var o;s;){if(s.nodeType===3){if(o=e+s.textContent.length,e<=n&&o>=n)return{node:s,offset:n-e};e=o}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=qf(s)}}function Xf(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Xf(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Zf(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Ui(e.document);n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=Ui(e.document)}return n}function du(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var Wm=ca&&"documentMode"in document&&11>=document.documentMode,zi=null,pu=null,Us=null,hu=!1;function Qf(e,n,s){var o=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;hu||zi==null||zi!==Ui(o)||(o=zi,"selectionStart"in o&&du(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Us&&Ls(Us,o)||(Us=o,o=Do(pu,"onSelect"),0<o.length&&(n=new O("onSelect","select",null,n,s),e.push({event:n,listeners:o}),n.target=zi)))}function fi(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var Hi={animationend:fi("Animation","AnimationEnd"),animationiteration:fi("Animation","AnimationIteration"),animationstart:fi("Animation","AnimationStart"),transitionrun:fi("Transition","TransitionRun"),transitionstart:fi("Transition","TransitionStart"),transitioncancel:fi("Transition","TransitionCancel"),transitionend:fi("Transition","TransitionEnd")},mu={},$f={};ca&&($f=document.createElement("div").style,"AnimationEvent"in window||(delete Hi.animationend.animation,delete Hi.animationiteration.animation,delete Hi.animationstart.animation),"TransitionEvent"in window||delete Hi.transitionend.transition);function di(e){if(mu[e])return mu[e];if(!Hi[e])return e;var n=Hi[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in $f)return mu[e]=n[s];return e}var Wf=di("animationend"),Kf=di("animationiteration"),Jf=di("animationstart"),Km=di("transitionrun"),Jm=di("transitionstart"),eg=di("transitioncancel"),ed=di("transitionend"),td=new Map,gu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gu.push("scrollEnd");function ha(e,n){td.set(e,n),oa(n,[e])}var nd=new WeakMap;function Kn(e,n){if(typeof e=="object"&&e!==null){var s=nd.get(e);return s!==void 0?s:(n={value:e,source:n,stack:ri(n)},nd.set(e,n),n)}return{value:e,source:n,stack:ri(n)}}var Jn=[],Yi=0,vu=0;function ql(){for(var e=Yi,n=vu=Yi=0;n<e;){var s=Jn[n];Jn[n++]=null;var o=Jn[n];Jn[n++]=null;var c=Jn[n];Jn[n++]=null;var p=Jn[n];if(Jn[n++]=null,o!==null&&c!==null){var b=o.pending;b===null?c.next=c:(c.next=b.next,b.next=c),o.pending=c}p!==0&&ad(s,c,p)}}function Vl(e,n,s,o){Jn[Yi++]=e,Jn[Yi++]=n,Jn[Yi++]=s,Jn[Yi++]=o,vu|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function yu(e,n,s,o){return Vl(e,n,s,o),Xl(e)}function qi(e,n){return Vl(e,null,null,n),Xl(e)}function ad(e,n,s){e.lanes|=s;var o=e.alternate;o!==null&&(o.lanes|=s);for(var c=!1,p=e.return;p!==null;)p.childLanes|=s,o=p.alternate,o!==null&&(o.childLanes|=s),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(c=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,c&&n!==null&&(c=31-Ht(s),e=p.hiddenUpdates,o=e[c],o===null?e[c]=[n]:o.push(n),n.lane=s|536870912),p):null}function Xl(e){if(50<sl)throw sl=0,Ac=null,Error(i(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Vi={};function tg(e,n,s,o){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function In(e,n,s,o){return new tg(e,n,s,o)}function bu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ja(e,n){var s=e.alternate;return s===null?(s=In(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&65011712,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s.refCleanup=e.refCleanup,s}function rd(e,n){e.flags&=65011714;var s=e.alternate;return s===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=s.childLanes,e.lanes=s.lanes,e.child=s.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=s.memoizedProps,e.memoizedState=s.memoizedState,e.updateQueue=s.updateQueue,e.type=s.type,n=s.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Zl(e,n,s,o,c,p){var b=0;if(o=e,typeof e=="function")bu(e)&&(b=1);else if(typeof e=="string")b=av(e,s,ne.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ye:return e=In(31,s,n,c),e.elementType=ye,e.lanes=p,e;case S:return pi(s.children,c,p,n);case A:b=8,c|=24;break;case N:return e=In(12,s,n,c|2),e.elementType=N,e.lanes=p,e;case B:return e=In(13,s,n,c),e.elementType=B,e.lanes=p,e;case V:return e=In(19,s,n,c),e.elementType=V,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D:case M:b=10;break e;case L:b=9;break e;case C:b=11;break e;case te:b=14;break e;case de:b=16,o=null;break e}b=29,s=Error(i(130,e===null?"null":typeof e,"")),o=null}return n=In(b,s,n,c),n.elementType=e,n.type=o,n.lanes=p,n}function pi(e,n,s,o){return e=In(7,e,o,n),e.lanes=s,e}function xu(e,n,s){return e=In(6,e,null,n),e.lanes=s,e}function Su(e,n,s){return n=In(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Xi=[],Zi=0,Ql=null,$l=0,ea=[],ta=0,hi=null,er=1,tr="";function mi(e,n){Xi[Zi++]=$l,Xi[Zi++]=Ql,Ql=e,$l=n}function id(e,n,s){ea[ta++]=er,ea[ta++]=tr,ea[ta++]=hi,hi=e;var o=er;e=tr;var c=32-Ht(o)-1;o&=~(1<<c),s+=1;var p=32-Ht(n)+c;if(30<p){var b=c-c%5;p=(o&(1<<b)-1).toString(32),o>>=b,c-=b,er=1<<32-Ht(n)+c|s<<c|o,tr=p+e}else er=1<<p|s<<c|o,tr=e}function Eu(e){e.return!==null&&(mi(e,1),id(e,1,0))}function wu(e){for(;e===Ql;)Ql=Xi[--Zi],Xi[Zi]=null,$l=Xi[--Zi],Xi[Zi]=null;for(;e===hi;)hi=ea[--ta],ea[ta]=null,tr=ea[--ta],ea[ta]=null,er=ea[--ta],ea[ta]=null}var En=null,Ut=null,ht=!1,gi=null,Ra=!1,Au=Error(i(519));function vi(e){var n=Error(i(418,""));throw Fs(Kn(n,e)),Au}function sd(e){var n=e.stateNode,s=e.type,o=e.memoizedProps;switch(n[sn]=e,n[bn]=o,s){case"dialog":ut("cancel",n),ut("close",n);break;case"iframe":case"object":case"embed":ut("load",n);break;case"video":case"audio":for(s=0;s<ol.length;s++)ut(ol[s],n);break;case"source":ut("error",n);break;case"img":case"image":case"link":ut("error",n),ut("load",n);break;case"details":ut("toggle",n);break;case"input":ut("invalid",n),Ns(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0),ua(n);break;case"select":ut("invalid",n);break;case"textarea":ut("invalid",n),jl(n,o.value,o.defaultValue,o.children),ua(n)}s=o.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||n.textContent===""+s||o.suppressHydrationWarning===!0||wh(n.textContent,s)?(o.popover!=null&&(ut("beforetoggle",n),ut("toggle",n)),o.onScroll!=null&&ut("scroll",n),o.onScrollEnd!=null&&ut("scrollend",n),o.onClick!=null&&(n.onclick=_o),n=!0):n=!1,n||vi(e)}function ld(e){for(En=e.return;En;)switch(En.tag){case 5:case 13:Ra=!1;return;case 27:case 3:Ra=!0;return;default:En=En.return}}function Is(e){if(e!==En)return!1;if(!ht)return ld(e),ht=!0,!1;var n=e.tag,s;if((s=n!==3&&n!==27)&&((s=n===5)&&(s=e.type,s=!(s!=="form"&&s!=="button")||Pc(e.type,e.memoizedProps)),s=!s),s&&Ut&&vi(e),ld(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8)if(s=e.data,s==="/$"){if(n===0){Ut=ga(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++;e=e.nextSibling}Ut=null}}else n===27?(n=Ut,jr(e.type)?(e=Yc,Yc=null,Ut=e):Ut=n):Ut=En?ga(e.stateNode.nextSibling):null;return!0}function Bs(){Ut=En=null,ht=!1}function od(){var e=gi;return e!==null&&(Dn===null?Dn=e:Dn.push.apply(Dn,e),gi=null),e}function Fs(e){gi===null?gi=[e]:gi.push(e)}var Tu=z(null),yi=null,nr=null;function Ar(e,n,s){ve(Tu,n._currentValue),n._currentValue=s}function ar(e){e._currentValue=Tu.current,ie(Tu)}function Cu(e,n,s){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===s)break;e=e.return}}function Mu(e,n,s,o){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var p=c.dependencies;if(p!==null){var b=c.child;p=p.firstContext;e:for(;p!==null;){var w=p;p=c;for(var I=0;I<n.length;I++)if(w.context===n[I]){p.lanes|=s,w=p.alternate,w!==null&&(w.lanes|=s),Cu(p.return,s,e),o||(b=null);break e}p=w.next}}else if(c.tag===18){if(b=c.return,b===null)throw Error(i(341));b.lanes|=s,p=b.alternate,p!==null&&(p.lanes|=s),Cu(b,s,e),b=null}else b=c.child;if(b!==null)b.return=c;else for(b=c;b!==null;){if(b===e){b=null;break}if(c=b.sibling,c!==null){c.return=b.return,b=c;break}b=b.return}c=b}}function js(e,n,s,o){e=null;for(var c=n,p=!1;c!==null;){if(!p){if((c.flags&524288)!==0)p=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var b=c.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var w=c.type;Un(c.pendingProps.value,b.value)||(e!==null?e.push(w):e=[w])}}else if(c===Ye.current){if(b=c.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(hl):e=[hl])}c=c.return}e!==null&&Mu(n,e,s,o),n.flags|=262144}function Wl(e){for(e=e.firstContext;e!==null;){if(!Un(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function bi(e){yi=e,nr=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function mn(e){return ud(yi,e)}function Kl(e,n){return yi===null&&bi(e),ud(e,n)}function ud(e,n){var s=n._currentValue;if(n={context:n,memoizedValue:s,next:null},nr===null){if(e===null)throw Error(i(308));nr=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else nr=nr.next=n;return s}var ng=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(s,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(s){return s()})}},ag=a.unstable_scheduleCallback,rg=a.unstable_NormalPriority,Qt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nu(){return{controller:new ng,data:new Map,refCount:0}}function Ps(e){e.refCount--,e.refCount===0&&ag(rg,function(){e.controller.abort()})}var Gs=null,Ru=0,Qi=0,$i=null;function ig(e,n){if(Gs===null){var s=Gs=[];Ru=0,Qi=_c(),$i={status:"pending",value:void 0,then:function(o){s.push(o)}}}return Ru++,n.then(cd,cd),n}function cd(){if(--Ru===0&&Gs!==null){$i!==null&&($i.status="fulfilled");var e=Gs;Gs=null,Qi=0,$i=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function sg(e,n){var s=[],o={status:"pending",value:null,reason:null,then:function(c){s.push(c)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var c=0;c<s.length;c++)(0,s[c])(n)},function(c){for(o.status="rejected",o.reason=c,c=0;c<s.length;c++)(0,s[c])(void 0)}),o}var fd=U.S;U.S=function(e,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&ig(e,n),fd!==null&&fd(e,n)};var xi=z(null);function Du(){var e=xi.current;return e!==null?e:Ct.pooledCache}function Jl(e,n){n===null?ve(xi,xi.current):ve(xi,n.pool)}function dd(){var e=Du();return e===null?null:{parent:Qt._currentValue,pool:e}}var zs=Error(i(460)),pd=Error(i(474)),eo=Error(i(542)),_u={then:function(){}};function hd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function to(){}function md(e,n,s){switch(s=e[s],s===void 0?e.push(n):s!==n&&(n.then(to,to),n=s),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,vd(e),e;default:if(typeof n.status=="string")n.then(to,to);else{if(e=Ct,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var c=n;c.status="fulfilled",c.value=o}},function(o){if(n.status==="pending"){var c=n;c.status="rejected",c.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,vd(e),e}throw Hs=n,zs}}var Hs=null;function gd(){if(Hs===null)throw Error(i(459));var e=Hs;return Hs=null,e}function vd(e){if(e===zs||e===eo)throw Error(i(483))}var Tr=!1;function Ou(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ku(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Cr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Mr(e,n,s){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(yt&2)!==0){var c=o.pending;return c===null?n.next=n:(n.next=c.next,c.next=n),o.pending=n,n=Xl(e),ad(e,null,s),n}return Vl(e,o,n,s),Xl(e)}function Ys(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,s|=o,n.lanes=s,sa(e,s)}}function Lu(e,n){var s=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,s===o)){var c=null,p=null;if(s=s.firstBaseUpdate,s!==null){do{var b={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};p===null?c=p=b:p=p.next=b,s=s.next}while(s!==null);p===null?c=p=n:p=p.next=n}else c=p=n;s={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:p,shared:o.shared,callbacks:o.callbacks},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}var Uu=!1;function qs(){if(Uu){var e=$i;if(e!==null)throw e}}function Vs(e,n,s,o){Uu=!1;var c=e.updateQueue;Tr=!1;var p=c.firstBaseUpdate,b=c.lastBaseUpdate,w=c.shared.pending;if(w!==null){c.shared.pending=null;var I=w,Q=I.next;I.next=null,b===null?p=Q:b.next=Q,b=I;var le=e.alternate;le!==null&&(le=le.updateQueue,w=le.lastBaseUpdate,w!==b&&(w===null?le.firstBaseUpdate=Q:w.next=Q,le.lastBaseUpdate=I))}if(p!==null){var fe=c.baseState;b=0,le=Q=I=null,w=p;do{var K=w.lane&-536870913,ee=K!==w.lane;if(ee?(ct&K)===K:(o&K)===K){K!==0&&K===Qi&&(Uu=!0),le!==null&&(le=le.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Ve=e,Pe=w;K=n;var wt=s;switch(Pe.tag){case 1:if(Ve=Pe.payload,typeof Ve=="function"){fe=Ve.call(wt,fe,K);break e}fe=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=Pe.payload,K=typeof Ve=="function"?Ve.call(wt,fe,K):Ve,K==null)break e;fe=v({},fe,K);break e;case 2:Tr=!0}}K=w.callback,K!==null&&(e.flags|=64,ee&&(e.flags|=8192),ee=c.callbacks,ee===null?c.callbacks=[K]:ee.push(K))}else ee={lane:K,tag:w.tag,payload:w.payload,callback:w.callback,next:null},le===null?(Q=le=ee,I=fe):le=le.next=ee,b|=K;if(w=w.next,w===null){if(w=c.shared.pending,w===null)break;ee=w,w=ee.next,ee.next=null,c.lastBaseUpdate=ee,c.shared.pending=null}}while(!0);le===null&&(I=fe),c.baseState=I,c.firstBaseUpdate=Q,c.lastBaseUpdate=le,p===null&&(c.shared.lanes=0),Ur|=b,e.lanes=b,e.memoizedState=fe}}function yd(e,n){if(typeof e!="function")throw Error(i(191,e));e.call(n)}function bd(e,n){var s=e.callbacks;if(s!==null)for(e.callbacks=null,e=0;e<s.length;e++)yd(s[e],n)}var Wi=z(null),no=z(0);function xd(e,n){e=cr,ve(no,e),ve(Wi,n),cr=e|n.baseLanes}function Iu(){ve(no,cr),ve(Wi,Wi.current)}function Bu(){cr=no.current,ie(Wi),ie(no)}var Nr=0,at=null,St=null,Vt=null,ao=!1,Ki=!1,Si=!1,ro=0,Xs=0,Ji=null,lg=0;function Gt(){throw Error(i(321))}function Fu(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!Un(e[s],n[s]))return!1;return!0}function ju(e,n,s,o,c,p){return Nr=p,at=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,U.H=e===null||e.memoizedState===null?ap:rp,Si=!1,p=s(o,c),Si=!1,Ki&&(p=Ed(n,s,o,c)),Sd(e),p}function Sd(e){U.H=co;var n=St!==null&&St.next!==null;if(Nr=0,Vt=St=at=null,ao=!1,Xs=0,Ji=null,n)throw Error(i(300));e===null||Jt||(e=e.dependencies,e!==null&&Wl(e)&&(Jt=!0))}function Ed(e,n,s,o){at=e;var c=0;do{if(Ki&&(Ji=null),Xs=0,Ki=!1,25<=c)throw Error(i(301));if(c+=1,Vt=St=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}U.H=hg,p=n(s,o)}while(Ki);return p}function og(){var e=U.H,n=e.useState()[0];return n=typeof n.then=="function"?Zs(n):n,e=e.useState()[0],(St!==null?St.memoizedState:null)!==e&&(at.flags|=1024),n}function Pu(){var e=ro!==0;return ro=0,e}function Gu(e,n,s){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~s}function zu(e){if(ao){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}ao=!1}Nr=0,Vt=St=at=null,Ki=!1,Xs=ro=0,Ji=null}function Nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?at.memoizedState=Vt=e:Vt=Vt.next=e,Vt}function Xt(){if(St===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=St.next;var n=Vt===null?at.memoizedState:Vt.next;if(n!==null)Vt=n,St=e;else{if(e===null)throw at.alternate===null?Error(i(467)):Error(i(310));St=e,e={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Vt===null?at.memoizedState=Vt=e:Vt=Vt.next=e}return Vt}function Hu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zs(e){var n=Xs;return Xs+=1,Ji===null&&(Ji=[]),e=md(Ji,e,n),n=at,(Vt===null?n.memoizedState:Vt.next)===null&&(n=n.alternate,U.H=n===null||n.memoizedState===null?ap:rp),e}function io(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Zs(e);if(e.$$typeof===M)return mn(e)}throw Error(i(438,String(e)))}function Yu(e){var n=null,s=at.updateQueue;if(s!==null&&(n=s.memoCache),n==null){var o=at.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(c){return c.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),s===null&&(s=Hu(),at.updateQueue=s),s.memoCache=n,s=n.data[n.index],s===void 0)for(s=n.data[n.index]=Array(e),o=0;o<e;o++)s[o]=pe;return n.index++,s}function rr(e,n){return typeof n=="function"?n(e):n}function so(e){var n=Xt();return qu(n,St,e)}function qu(e,n,s){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=e.baseQueue,p=o.pending;if(p!==null){if(c!==null){var b=c.next;c.next=p.next,p.next=b}n.baseQueue=c=p,o.pending=null}if(p=e.baseState,c===null)e.memoizedState=p;else{n=c.next;var w=b=null,I=null,Q=n,le=!1;do{var fe=Q.lane&-536870913;if(fe!==Q.lane?(ct&fe)===fe:(Nr&fe)===fe){var K=Q.revertLane;if(K===0)I!==null&&(I=I.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),fe===Qi&&(le=!0);else if((Nr&K)===K){Q=Q.next,K===Qi&&(le=!0);continue}else fe={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},I===null?(w=I=fe,b=p):I=I.next=fe,at.lanes|=K,Ur|=K;fe=Q.action,Si&&s(p,fe),p=Q.hasEagerState?Q.eagerState:s(p,fe)}else K={lane:fe,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},I===null?(w=I=K,b=p):I=I.next=K,at.lanes|=fe,Ur|=fe;Q=Q.next}while(Q!==null&&Q!==n);if(I===null?b=p:I.next=w,!Un(p,e.memoizedState)&&(Jt=!0,le&&(s=$i,s!==null)))throw s;e.memoizedState=p,e.baseState=b,e.baseQueue=I,o.lastRenderedState=p}return c===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Vu(e){var n=Xt(),s=n.queue;if(s===null)throw Error(i(311));s.lastRenderedReducer=e;var o=s.dispatch,c=s.pending,p=n.memoizedState;if(c!==null){s.pending=null;var b=c=c.next;do p=e(p,b.action),b=b.next;while(b!==c);Un(p,n.memoizedState)||(Jt=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),s.lastRenderedState=p}return[p,o]}function wd(e,n,s){var o=at,c=Xt(),p=ht;if(p){if(s===void 0)throw Error(i(407));s=s()}else s=n();var b=!Un((St||c).memoizedState,s);b&&(c.memoizedState=s,Jt=!0),c=c.queue;var w=Cd.bind(null,o,c,e);if(Qs(2048,8,w,[e]),c.getSnapshot!==n||b||Vt!==null&&Vt.memoizedState.tag&1){if(o.flags|=2048,es(9,lo(),Td.bind(null,o,c,s,n),null),Ct===null)throw Error(i(349));p||(Nr&124)!==0||Ad(o,n,s)}return s}function Ad(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=at.updateQueue,n===null?(n=Hu(),at.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function Td(e,n,s,o){n.value=s,n.getSnapshot=o,Md(n)&&Nd(e)}function Cd(e,n,s){return s(function(){Md(n)&&Nd(e)})}function Md(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!Un(e,s)}catch{return!0}}function Nd(e){var n=qi(e,2);n!==null&&Gn(n,e,2)}function Xu(e){var n=Nn();if(typeof e=="function"){var s=e;if(e=s(),Si){yn(!0);try{s()}finally{yn(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:e},n}function Rd(e,n,s,o){return e.baseState=s,qu(e,St,typeof o=="function"?o:rr)}function ug(e,n,s,o,c){if(uo(e))throw Error(i(485));if(e=n.action,e!==null){var p={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};U.T!==null?s(!0):p.isTransition=!1,o(p),s=n.pending,s===null?(p.next=n.pending=p,Dd(n,p)):(p.next=s.next,n.pending=s.next=p)}}function Dd(e,n){var s=n.action,o=n.payload,c=e.state;if(n.isTransition){var p=U.T,b={};U.T=b;try{var w=s(c,o),I=U.S;I!==null&&I(b,w),_d(e,n,w)}catch(Q){Zu(e,n,Q)}finally{U.T=p}}else try{p=s(c,o),_d(e,n,p)}catch(Q){Zu(e,n,Q)}}function _d(e,n,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(o){Od(e,n,o)},function(o){return Zu(e,n,o)}):Od(e,n,s)}function Od(e,n,s){n.status="fulfilled",n.value=s,kd(n),e.state=s,n=e.pending,n!==null&&(s=n.next,s===n?e.pending=null:(s=s.next,n.next=s,Dd(e,s)))}function Zu(e,n,s){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=s,kd(n),n=n.next;while(n!==o)}e.action=null}function kd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Ld(e,n){return n}function Ud(e,n){if(ht){var s=Ct.formState;if(s!==null){e:{var o=at;if(ht){if(Ut){t:{for(var c=Ut,p=Ra;c.nodeType!==8;){if(!p){c=null;break t}if(c=ga(c.nextSibling),c===null){c=null;break t}}p=c.data,c=p==="F!"||p==="F"?c:null}if(c){Ut=ga(c.nextSibling),o=c.data==="F!";break e}}vi(o)}o=!1}o&&(n=s[0])}}return s=Nn(),s.memoizedState=s.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ld,lastRenderedState:n},s.queue=o,s=ep.bind(null,at,o),o.dispatch=s,o=Xu(!1),p=Ju.bind(null,at,!1,o.queue),o=Nn(),c={state:n,dispatch:null,action:e,pending:null},o.queue=c,s=ug.bind(null,at,c,p,s),c.dispatch=s,o.memoizedState=e,[n,s,!1]}function Id(e){var n=Xt();return Bd(n,St,e)}function Bd(e,n,s){if(n=qu(e,n,Ld)[0],e=so(rr)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Zs(n)}catch(b){throw b===zs?eo:b}else o=n;n=Xt();var c=n.queue,p=c.dispatch;return s!==n.memoizedState&&(at.flags|=2048,es(9,lo(),cg.bind(null,c,s),null)),[o,p,e]}function cg(e,n){e.action=n}function Fd(e){var n=Xt(),s=St;if(s!==null)return Bd(n,s,e);Xt(),n=n.memoizedState,s=Xt();var o=s.queue.dispatch;return s.memoizedState=e,[n,o,!1]}function es(e,n,s,o){return e={tag:e,create:s,deps:o,inst:n,next:null},n=at.updateQueue,n===null&&(n=Hu(),at.updateQueue=n),s=n.lastEffect,s===null?n.lastEffect=e.next=e:(o=s.next,s.next=e,e.next=o,n.lastEffect=e),e}function lo(){return{destroy:void 0,resource:void 0}}function jd(){return Xt().memoizedState}function oo(e,n,s,o){var c=Nn();o=o===void 0?null:o,at.flags|=e,c.memoizedState=es(1|n,lo(),s,o)}function Qs(e,n,s,o){var c=Xt();o=o===void 0?null:o;var p=c.memoizedState.inst;St!==null&&o!==null&&Fu(o,St.memoizedState.deps)?c.memoizedState=es(n,p,s,o):(at.flags|=e,c.memoizedState=es(1|n,p,s,o))}function Pd(e,n){oo(8390656,8,e,n)}function Gd(e,n){Qs(2048,8,e,n)}function zd(e,n){return Qs(4,2,e,n)}function Hd(e,n){return Qs(4,4,e,n)}function Yd(e,n){if(typeof n=="function"){e=e();var s=n(e);return function(){typeof s=="function"?s():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function qd(e,n,s){s=s!=null?s.concat([e]):null,Qs(4,4,Yd.bind(null,n,e),s)}function Qu(){}function Vd(e,n){var s=Xt();n=n===void 0?null:n;var o=s.memoizedState;return n!==null&&Fu(n,o[1])?o[0]:(s.memoizedState=[e,n],e)}function Xd(e,n){var s=Xt();n=n===void 0?null:n;var o=s.memoizedState;if(n!==null&&Fu(n,o[1]))return o[0];if(o=e(),Si){yn(!0);try{e()}finally{yn(!1)}}return s.memoizedState=[o,n],o}function $u(e,n,s){return s===void 0||(Nr&1073741824)!==0?e.memoizedState=n:(e.memoizedState=s,e=$p(),at.lanes|=e,Ur|=e,s)}function Zd(e,n,s,o){return Un(s,n)?s:Wi.current!==null?(e=$u(e,s,o),Un(e,n)||(Jt=!0),e):(Nr&42)===0?(Jt=!0,e.memoizedState=s):(e=$p(),at.lanes|=e,Ur|=e,n)}function Qd(e,n,s,o,c){var p=G.p;G.p=p!==0&&8>p?p:8;var b=U.T,w={};U.T=w,Ju(e,!1,n,s);try{var I=c(),Q=U.S;if(Q!==null&&Q(w,I),I!==null&&typeof I=="object"&&typeof I.then=="function"){var le=sg(I,o);$s(e,n,le,Pn(e))}else $s(e,n,o,Pn(e))}catch(fe){$s(e,n,{then:function(){},status:"rejected",reason:fe},Pn())}finally{G.p=p,U.T=b}}function fg(){}function Wu(e,n,s,o){if(e.tag!==5)throw Error(i(476));var c=$d(e).queue;Qd(e,c,n,X,s===null?fg:function(){return Wd(e),s(o)})}function $d(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:X},next:null};var s={};return n.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:s},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function Wd(e){var n=$d(e).next.queue;$s(e,n,{},Pn())}function Ku(){return mn(hl)}function Kd(){return Xt().memoizedState}function Jd(){return Xt().memoizedState}function dg(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var s=Pn();e=Cr(s);var o=Mr(n,e,s);o!==null&&(Gn(o,n,s),Ys(o,n,s)),n={cache:Nu()},e.payload=n;return}n=n.return}}function pg(e,n,s){var o=Pn();s={lane:o,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null},uo(e)?tp(n,s):(s=yu(e,n,s,o),s!==null&&(Gn(s,e,o),np(s,n,o)))}function ep(e,n,s){var o=Pn();$s(e,n,s,o)}function $s(e,n,s,o){var c={lane:o,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null};if(uo(e))tp(n,c);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var b=n.lastRenderedState,w=p(b,s);if(c.hasEagerState=!0,c.eagerState=w,Un(w,b))return Vl(e,n,c,0),Ct===null&&ql(),!1}catch{}if(s=yu(e,n,c,o),s!==null)return Gn(s,e,o),np(s,n,o),!0}return!1}function Ju(e,n,s,o){if(o={lane:2,revertLane:_c(),action:o,hasEagerState:!1,eagerState:null,next:null},uo(e)){if(n)throw Error(i(479))}else n=yu(e,s,o,2),n!==null&&Gn(n,e,2)}function uo(e){var n=e.alternate;return e===at||n!==null&&n===at}function tp(e,n){Ki=ao=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function np(e,n,s){if((s&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,s|=o,n.lanes=s,sa(e,s)}}var co={readContext:mn,use:io,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useLayoutEffect:Gt,useInsertionEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useSyncExternalStore:Gt,useId:Gt,useHostTransitionStatus:Gt,useFormState:Gt,useActionState:Gt,useOptimistic:Gt,useMemoCache:Gt,useCacheRefresh:Gt},ap={readContext:mn,use:io,useCallback:function(e,n){return Nn().memoizedState=[e,n===void 0?null:n],e},useContext:mn,useEffect:Pd,useImperativeHandle:function(e,n,s){s=s!=null?s.concat([e]):null,oo(4194308,4,Yd.bind(null,n,e),s)},useLayoutEffect:function(e,n){return oo(4194308,4,e,n)},useInsertionEffect:function(e,n){oo(4,2,e,n)},useMemo:function(e,n){var s=Nn();n=n===void 0?null:n;var o=e();if(Si){yn(!0);try{e()}finally{yn(!1)}}return s.memoizedState=[o,n],o},useReducer:function(e,n,s){var o=Nn();if(s!==void 0){var c=s(n);if(Si){yn(!0);try{s(n)}finally{yn(!1)}}}else c=n;return o.memoizedState=o.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},o.queue=e,e=e.dispatch=pg.bind(null,at,e),[o.memoizedState,e]},useRef:function(e){var n=Nn();return e={current:e},n.memoizedState=e},useState:function(e){e=Xu(e);var n=e.queue,s=ep.bind(null,at,n);return n.dispatch=s,[e.memoizedState,s]},useDebugValue:Qu,useDeferredValue:function(e,n){var s=Nn();return $u(s,e,n)},useTransition:function(){var e=Xu(!1);return e=Qd.bind(null,at,e.queue,!0,!1),Nn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,s){var o=at,c=Nn();if(ht){if(s===void 0)throw Error(i(407));s=s()}else{if(s=n(),Ct===null)throw Error(i(349));(ct&124)!==0||Ad(o,n,s)}c.memoizedState=s;var p={value:s,getSnapshot:n};return c.queue=p,Pd(Cd.bind(null,o,p,e),[e]),o.flags|=2048,es(9,lo(),Td.bind(null,o,p,s,n),null),s},useId:function(){var e=Nn(),n=Ct.identifierPrefix;if(ht){var s=tr,o=er;s=(o&~(1<<32-Ht(o)-1)).toString(32)+s,n=""+n+"R"+s,s=ro++,0<s&&(n+="H"+s.toString(32)),n+=""}else s=lg++,n=""+n+"r"+s.toString(32)+"";return e.memoizedState=n},useHostTransitionStatus:Ku,useFormState:Ud,useActionState:Ud,useOptimistic:function(e){var n=Nn();n.memoizedState=n.baseState=e;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=s,n=Ju.bind(null,at,!0,s),s.dispatch=n,[e,n]},useMemoCache:Yu,useCacheRefresh:function(){return Nn().memoizedState=dg.bind(null,at)}},rp={readContext:mn,use:io,useCallback:Vd,useContext:mn,useEffect:Gd,useImperativeHandle:qd,useInsertionEffect:zd,useLayoutEffect:Hd,useMemo:Xd,useReducer:so,useRef:jd,useState:function(){return so(rr)},useDebugValue:Qu,useDeferredValue:function(e,n){var s=Xt();return Zd(s,St.memoizedState,e,n)},useTransition:function(){var e=so(rr)[0],n=Xt().memoizedState;return[typeof e=="boolean"?e:Zs(e),n]},useSyncExternalStore:wd,useId:Kd,useHostTransitionStatus:Ku,useFormState:Id,useActionState:Id,useOptimistic:function(e,n){var s=Xt();return Rd(s,St,e,n)},useMemoCache:Yu,useCacheRefresh:Jd},hg={readContext:mn,use:io,useCallback:Vd,useContext:mn,useEffect:Gd,useImperativeHandle:qd,useInsertionEffect:zd,useLayoutEffect:Hd,useMemo:Xd,useReducer:Vu,useRef:jd,useState:function(){return Vu(rr)},useDebugValue:Qu,useDeferredValue:function(e,n){var s=Xt();return St===null?$u(s,e,n):Zd(s,St.memoizedState,e,n)},useTransition:function(){var e=Vu(rr)[0],n=Xt().memoizedState;return[typeof e=="boolean"?e:Zs(e),n]},useSyncExternalStore:wd,useId:Kd,useHostTransitionStatus:Ku,useFormState:Fd,useActionState:Fd,useOptimistic:function(e,n){var s=Xt();return St!==null?Rd(s,St,e,n):(s.baseState=e,[e,s.queue.dispatch])},useMemoCache:Yu,useCacheRefresh:Jd},ts=null,Ws=0;function fo(e){var n=Ws;return Ws+=1,ts===null&&(ts=[]),md(ts,e,n)}function Ks(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function po(e,n){throw n.$$typeof===E?Error(i(525)):(e=Object.prototype.toString.call(n),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function ip(e){var n=e._init;return n(e._payload)}function sp(e){function n(Y,P){if(e){var Z=Y.deletions;Z===null?(Y.deletions=[P],Y.flags|=16):Z.push(P)}}function s(Y,P){if(!e)return null;for(;P!==null;)n(Y,P),P=P.sibling;return null}function o(Y){for(var P=new Map;Y!==null;)Y.key!==null?P.set(Y.key,Y):P.set(Y.index,Y),Y=Y.sibling;return P}function c(Y,P){return Y=Ja(Y,P),Y.index=0,Y.sibling=null,Y}function p(Y,P,Z){return Y.index=Z,e?(Z=Y.alternate,Z!==null?(Z=Z.index,Z<P?(Y.flags|=67108866,P):Z):(Y.flags|=67108866,P)):(Y.flags|=1048576,P)}function b(Y){return e&&Y.alternate===null&&(Y.flags|=67108866),Y}function w(Y,P,Z,oe){return P===null||P.tag!==6?(P=xu(Z,Y.mode,oe),P.return=Y,P):(P=c(P,Z),P.return=Y,P)}function I(Y,P,Z,oe){var Re=Z.type;return Re===S?le(Y,P,Z.props.children,oe,Z.key):P!==null&&(P.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===de&&ip(Re)===P.type)?(P=c(P,Z.props),Ks(P,Z),P.return=Y,P):(P=Zl(Z.type,Z.key,Z.props,null,Y.mode,oe),Ks(P,Z),P.return=Y,P)}function Q(Y,P,Z,oe){return P===null||P.tag!==4||P.stateNode.containerInfo!==Z.containerInfo||P.stateNode.implementation!==Z.implementation?(P=Su(Z,Y.mode,oe),P.return=Y,P):(P=c(P,Z.children||[]),P.return=Y,P)}function le(Y,P,Z,oe,Re){return P===null||P.tag!==7?(P=pi(Z,Y.mode,oe,Re),P.return=Y,P):(P=c(P,Z),P.return=Y,P)}function fe(Y,P,Z){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return P=xu(""+P,Y.mode,Z),P.return=Y,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case y:return Z=Zl(P.type,P.key,P.props,null,Y.mode,Z),Ks(Z,P),Z.return=Y,Z;case x:return P=Su(P,Y.mode,Z),P.return=Y,P;case de:var oe=P._init;return P=oe(P._payload),fe(Y,P,Z)}if(J(P)||j(P))return P=pi(P,Y.mode,Z,null),P.return=Y,P;if(typeof P.then=="function")return fe(Y,fo(P),Z);if(P.$$typeof===M)return fe(Y,Kl(Y,P),Z);po(Y,P)}return null}function K(Y,P,Z,oe){var Re=P!==null?P.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Re!==null?null:w(Y,P,""+Z,oe);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case y:return Z.key===Re?I(Y,P,Z,oe):null;case x:return Z.key===Re?Q(Y,P,Z,oe):null;case de:return Re=Z._init,Z=Re(Z._payload),K(Y,P,Z,oe)}if(J(Z)||j(Z))return Re!==null?null:le(Y,P,Z,oe,null);if(typeof Z.then=="function")return K(Y,P,fo(Z),oe);if(Z.$$typeof===M)return K(Y,P,Kl(Y,Z),oe);po(Y,Z)}return null}function ee(Y,P,Z,oe,Re){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Y=Y.get(Z)||null,w(P,Y,""+oe,Re);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return Y=Y.get(oe.key===null?Z:oe.key)||null,I(P,Y,oe,Re);case x:return Y=Y.get(oe.key===null?Z:oe.key)||null,Q(P,Y,oe,Re);case de:var it=oe._init;return oe=it(oe._payload),ee(Y,P,Z,oe,Re)}if(J(oe)||j(oe))return Y=Y.get(Z)||null,le(P,Y,oe,Re,null);if(typeof oe.then=="function")return ee(Y,P,Z,fo(oe),Re);if(oe.$$typeof===M)return ee(Y,P,Z,Kl(P,oe),Re);po(P,oe)}return null}function Ve(Y,P,Z,oe){for(var Re=null,it=null,Le=P,ze=P=0,tn=null;Le!==null&&ze<Z.length;ze++){Le.index>ze?(tn=Le,Le=null):tn=Le.sibling;var pt=K(Y,Le,Z[ze],oe);if(pt===null){Le===null&&(Le=tn);break}e&&Le&&pt.alternate===null&&n(Y,Le),P=p(pt,P,ze),it===null?Re=pt:it.sibling=pt,it=pt,Le=tn}if(ze===Z.length)return s(Y,Le),ht&&mi(Y,ze),Re;if(Le===null){for(;ze<Z.length;ze++)Le=fe(Y,Z[ze],oe),Le!==null&&(P=p(Le,P,ze),it===null?Re=Le:it.sibling=Le,it=Le);return ht&&mi(Y,ze),Re}for(Le=o(Le);ze<Z.length;ze++)tn=ee(Le,Y,ze,Z[ze],oe),tn!==null&&(e&&tn.alternate!==null&&Le.delete(tn.key===null?ze:tn.key),P=p(tn,P,ze),it===null?Re=tn:it.sibling=tn,it=tn);return e&&Le.forEach(function(Yr){return n(Y,Yr)}),ht&&mi(Y,ze),Re}function Pe(Y,P,Z,oe){if(Z==null)throw Error(i(151));for(var Re=null,it=null,Le=P,ze=P=0,tn=null,pt=Z.next();Le!==null&&!pt.done;ze++,pt=Z.next()){Le.index>ze?(tn=Le,Le=null):tn=Le.sibling;var Yr=K(Y,Le,pt.value,oe);if(Yr===null){Le===null&&(Le=tn);break}e&&Le&&Yr.alternate===null&&n(Y,Le),P=p(Yr,P,ze),it===null?Re=Yr:it.sibling=Yr,it=Yr,Le=tn}if(pt.done)return s(Y,Le),ht&&mi(Y,ze),Re;if(Le===null){for(;!pt.done;ze++,pt=Z.next())pt=fe(Y,pt.value,oe),pt!==null&&(P=p(pt,P,ze),it===null?Re=pt:it.sibling=pt,it=pt);return ht&&mi(Y,ze),Re}for(Le=o(Le);!pt.done;ze++,pt=Z.next())pt=ee(Le,Y,ze,pt.value,oe),pt!==null&&(e&&pt.alternate!==null&&Le.delete(pt.key===null?ze:pt.key),P=p(pt,P,ze),it===null?Re=pt:it.sibling=pt,it=pt);return e&&Le.forEach(function(mv){return n(Y,mv)}),ht&&mi(Y,ze),Re}function wt(Y,P,Z,oe){if(typeof Z=="object"&&Z!==null&&Z.type===S&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case y:e:{for(var Re=Z.key;P!==null;){if(P.key===Re){if(Re=Z.type,Re===S){if(P.tag===7){s(Y,P.sibling),oe=c(P,Z.props.children),oe.return=Y,Y=oe;break e}}else if(P.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===de&&ip(Re)===P.type){s(Y,P.sibling),oe=c(P,Z.props),Ks(oe,Z),oe.return=Y,Y=oe;break e}s(Y,P);break}else n(Y,P);P=P.sibling}Z.type===S?(oe=pi(Z.props.children,Y.mode,oe,Z.key),oe.return=Y,Y=oe):(oe=Zl(Z.type,Z.key,Z.props,null,Y.mode,oe),Ks(oe,Z),oe.return=Y,Y=oe)}return b(Y);case x:e:{for(Re=Z.key;P!==null;){if(P.key===Re)if(P.tag===4&&P.stateNode.containerInfo===Z.containerInfo&&P.stateNode.implementation===Z.implementation){s(Y,P.sibling),oe=c(P,Z.children||[]),oe.return=Y,Y=oe;break e}else{s(Y,P);break}else n(Y,P);P=P.sibling}oe=Su(Z,Y.mode,oe),oe.return=Y,Y=oe}return b(Y);case de:return Re=Z._init,Z=Re(Z._payload),wt(Y,P,Z,oe)}if(J(Z))return Ve(Y,P,Z,oe);if(j(Z)){if(Re=j(Z),typeof Re!="function")throw Error(i(150));return Z=Re.call(Z),Pe(Y,P,Z,oe)}if(typeof Z.then=="function")return wt(Y,P,fo(Z),oe);if(Z.$$typeof===M)return wt(Y,P,Kl(Y,Z),oe);po(Y,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,P!==null&&P.tag===6?(s(Y,P.sibling),oe=c(P,Z),oe.return=Y,Y=oe):(s(Y,P),oe=xu(Z,Y.mode,oe),oe.return=Y,Y=oe),b(Y)):s(Y,P)}return function(Y,P,Z,oe){try{Ws=0;var Re=wt(Y,P,Z,oe);return ts=null,Re}catch(Le){if(Le===zs||Le===eo)throw Le;var it=In(29,Le,null,Y.mode);return it.lanes=oe,it.return=Y,it}}}var ns=sp(!0),lp=sp(!1),na=z(null),Da=null;function Rr(e){var n=e.alternate;ve($t,$t.current&1),ve(na,e),Da===null&&(n===null||Wi.current!==null||n.memoizedState!==null)&&(Da=e)}function op(e){if(e.tag===22){if(ve($t,$t.current),ve(na,e),Da===null){var n=e.alternate;n!==null&&n.memoizedState!==null&&(Da=e)}}else Dr()}function Dr(){ve($t,$t.current),ve(na,na.current)}function ir(e){ie(na),Da===e&&(Da=null),ie($t)}var $t=z(0);function ho(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||Hc(s)))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}function ec(e,n,s,o){n=e.memoizedState,s=s(o,n),s=s==null?n:v({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var tc={enqueueSetState:function(e,n,s){e=e._reactInternals;var o=Pn(),c=Cr(o);c.payload=n,s!=null&&(c.callback=s),n=Mr(e,c,o),n!==null&&(Gn(n,e,o),Ys(n,e,o))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var o=Pn(),c=Cr(o);c.tag=1,c.payload=n,s!=null&&(c.callback=s),n=Mr(e,c,o),n!==null&&(Gn(n,e,o),Ys(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=Pn(),o=Cr(s);o.tag=2,n!=null&&(o.callback=n),n=Mr(e,o,s),n!==null&&(Gn(n,e,s),Ys(n,e,s))}};function up(e,n,s,o,c,p,b){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,p,b):n.prototype&&n.prototype.isPureReactComponent?!Ls(s,o)||!Ls(c,p):!0}function cp(e,n,s,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,o),n.state!==e&&tc.enqueueReplaceState(n,n.state,null)}function Ei(e,n){var s=n;if("ref"in n){s={};for(var o in n)o!=="ref"&&(s[o]=n[o])}if(e=e.defaultProps){s===n&&(s=v({},s));for(var c in e)s[c]===void 0&&(s[c]=e[c])}return s}var mo=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function fp(e){mo(e)}function dp(e){console.error(e)}function pp(e){mo(e)}function go(e,n){try{var s=e.onUncaughtError;s(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function hp(e,n,s){try{var o=e.onCaughtError;o(s.value,{componentStack:s.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function nc(e,n,s){return s=Cr(s),s.tag=3,s.payload={element:null},s.callback=function(){go(e,n)},s}function mp(e){return e=Cr(e),e.tag=3,e}function gp(e,n,s,o){var c=s.type.getDerivedStateFromError;if(typeof c=="function"){var p=o.value;e.payload=function(){return c(p)},e.callback=function(){hp(n,s,o)}}var b=s.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(e.callback=function(){hp(n,s,o),typeof c!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var w=o.stack;this.componentDidCatch(o.value,{componentStack:w!==null?w:""})})}function mg(e,n,s,o,c){if(s.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=s.alternate,n!==null&&js(n,s,c,!0),s=na.current,s!==null){switch(s.tag){case 13:return Da===null?Cc():s.alternate===null&&It===0&&(It=3),s.flags&=-257,s.flags|=65536,s.lanes=c,o===_u?s.flags|=16384:(n=s.updateQueue,n===null?s.updateQueue=new Set([o]):n.add(o),Nc(e,o,c)),!1;case 22:return s.flags|=65536,o===_u?s.flags|=16384:(n=s.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},s.updateQueue=n):(s=n.retryQueue,s===null?n.retryQueue=new Set([o]):s.add(o)),Nc(e,o,c)),!1}throw Error(i(435,s.tag))}return Nc(e,o,c),Cc(),!1}if(ht)return n=na.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=c,o!==Au&&(e=Error(i(422),{cause:o}),Fs(Kn(e,s)))):(o!==Au&&(n=Error(i(423),{cause:o}),Fs(Kn(n,s))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,o=Kn(o,s),c=nc(e.stateNode,o,c),Lu(e,c),It!==4&&(It=2)),!1;var p=Error(i(520),{cause:o});if(p=Kn(p,s),il===null?il=[p]:il.push(p),It!==4&&(It=2),n===null)return!0;o=Kn(o,s),s=n;do{switch(s.tag){case 3:return s.flags|=65536,e=c&-c,s.lanes|=e,e=nc(s.stateNode,o,e),Lu(s,e),!1;case 1:if(n=s.type,p=s.stateNode,(s.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Ir===null||!Ir.has(p))))return s.flags|=65536,c&=-c,s.lanes|=c,c=mp(c),gp(c,e,s,o),Lu(s,c),!1}s=s.return}while(s!==null);return!1}var vp=Error(i(461)),Jt=!1;function un(e,n,s,o){n.child=e===null?lp(n,null,s,o):ns(n,e.child,s,o)}function yp(e,n,s,o,c){s=s.render;var p=n.ref;if("ref"in o){var b={};for(var w in o)w!=="ref"&&(b[w]=o[w])}else b=o;return bi(n),o=ju(e,n,s,b,p,c),w=Pu(),e!==null&&!Jt?(Gu(e,n,c),sr(e,n,c)):(ht&&w&&Eu(n),n.flags|=1,un(e,n,o,c),n.child)}function bp(e,n,s,o,c){if(e===null){var p=s.type;return typeof p=="function"&&!bu(p)&&p.defaultProps===void 0&&s.compare===null?(n.tag=15,n.type=p,xp(e,n,p,o,c)):(e=Zl(s.type,null,o,n,n.mode,c),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!cc(e,c)){var b=p.memoizedProps;if(s=s.compare,s=s!==null?s:Ls,s(b,o)&&e.ref===n.ref)return sr(e,n,c)}return n.flags|=1,e=Ja(p,o),e.ref=n.ref,e.return=n,n.child=e}function xp(e,n,s,o,c){if(e!==null){var p=e.memoizedProps;if(Ls(p,o)&&e.ref===n.ref)if(Jt=!1,n.pendingProps=o=p,cc(e,c))(e.flags&131072)!==0&&(Jt=!0);else return n.lanes=e.lanes,sr(e,n,c)}return ac(e,n,s,o,c)}function Sp(e,n,s){var o=n.pendingProps,c=o.children,p=e!==null?e.memoizedState:null;if(o.mode==="hidden"){if((n.flags&128)!==0){if(o=p!==null?p.baseLanes|s:s,e!==null){for(c=n.child=e.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;n.childLanes=p&~o}else n.childLanes=0,n.child=null;return Ep(e,n,o,s)}if((s&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Jl(n,p!==null?p.cachePool:null),p!==null?xd(n,p):Iu(),op(n);else return n.lanes=n.childLanes=536870912,Ep(e,n,p!==null?p.baseLanes|s:s,s)}else p!==null?(Jl(n,p.cachePool),xd(n,p),Dr(),n.memoizedState=null):(e!==null&&Jl(n,null),Iu(),Dr());return un(e,n,c,s),n.child}function Ep(e,n,s,o){var c=Du();return c=c===null?null:{parent:Qt._currentValue,pool:c},n.memoizedState={baseLanes:s,cachePool:c},e!==null&&Jl(n,null),Iu(),op(n),e!==null&&js(e,n,o,!0),null}function vo(e,n){var s=n.ref;if(s===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(i(284));(e===null||e.ref!==s)&&(n.flags|=4194816)}}function ac(e,n,s,o,c){return bi(n),s=ju(e,n,s,o,void 0,c),o=Pu(),e!==null&&!Jt?(Gu(e,n,c),sr(e,n,c)):(ht&&o&&Eu(n),n.flags|=1,un(e,n,s,c),n.child)}function wp(e,n,s,o,c,p){return bi(n),n.updateQueue=null,s=Ed(n,o,s,c),Sd(e),o=Pu(),e!==null&&!Jt?(Gu(e,n,p),sr(e,n,p)):(ht&&o&&Eu(n),n.flags|=1,un(e,n,s,p),n.child)}function Ap(e,n,s,o,c){if(bi(n),n.stateNode===null){var p=Vi,b=s.contextType;typeof b=="object"&&b!==null&&(p=mn(b)),p=new s(o,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=tc,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=o,p.state=n.memoizedState,p.refs={},Ou(n),b=s.contextType,p.context=typeof b=="object"&&b!==null?mn(b):Vi,p.state=n.memoizedState,b=s.getDerivedStateFromProps,typeof b=="function"&&(ec(n,s,b,o),p.state=n.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&tc.enqueueReplaceState(p,p.state,null),Vs(n,o,p,c),qs(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){p=n.stateNode;var w=n.memoizedProps,I=Ei(s,w);p.props=I;var Q=p.context,le=s.contextType;b=Vi,typeof le=="object"&&le!==null&&(b=mn(le));var fe=s.getDerivedStateFromProps;le=typeof fe=="function"||typeof p.getSnapshotBeforeUpdate=="function",w=n.pendingProps!==w,le||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(w||Q!==b)&&cp(n,p,o,b),Tr=!1;var K=n.memoizedState;p.state=K,Vs(n,o,p,c),qs(),Q=n.memoizedState,w||K!==Q||Tr?(typeof fe=="function"&&(ec(n,s,fe,o),Q=n.memoizedState),(I=Tr||up(n,s,I,o,K,Q,b))?(le||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=Q),p.props=o,p.state=Q,p.context=b,o=I):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{p=n.stateNode,ku(e,n),b=n.memoizedProps,le=Ei(s,b),p.props=le,fe=n.pendingProps,K=p.context,Q=s.contextType,I=Vi,typeof Q=="object"&&Q!==null&&(I=mn(Q)),w=s.getDerivedStateFromProps,(Q=typeof w=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==fe||K!==I)&&cp(n,p,o,I),Tr=!1,K=n.memoizedState,p.state=K,Vs(n,o,p,c),qs();var ee=n.memoizedState;b!==fe||K!==ee||Tr||e!==null&&e.dependencies!==null&&Wl(e.dependencies)?(typeof w=="function"&&(ec(n,s,w,o),ee=n.memoizedState),(le=Tr||up(n,s,le,o,K,ee,I)||e!==null&&e.dependencies!==null&&Wl(e.dependencies))?(Q||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,ee,I),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,ee,I)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===e.memoizedProps&&K===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&K===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=ee),p.props=o,p.state=ee,p.context=I,o=le):(typeof p.componentDidUpdate!="function"||b===e.memoizedProps&&K===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&K===e.memoizedState||(n.flags|=1024),o=!1)}return p=o,vo(e,n),o=(n.flags&128)!==0,p||o?(p=n.stateNode,s=o&&typeof s.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&o?(n.child=ns(n,e.child,null,c),n.child=ns(n,null,s,c)):un(e,n,s,c),n.memoizedState=p.state,e=n.child):e=sr(e,n,c),e}function Tp(e,n,s,o){return Bs(),n.flags|=256,un(e,n,s,o),n.child}var rc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ic(e){return{baseLanes:e,cachePool:dd()}}function sc(e,n,s){return e=e!==null?e.childLanes&~s:0,n&&(e|=aa),e}function Cp(e,n,s){var o=n.pendingProps,c=!1,p=(n.flags&128)!==0,b;if((b=p)||(b=e!==null&&e.memoizedState===null?!1:($t.current&2)!==0),b&&(c=!0,n.flags&=-129),b=(n.flags&32)!==0,n.flags&=-33,e===null){if(ht){if(c?Rr(n):Dr(),ht){var w=Ut,I;if(I=w){e:{for(I=w,w=Ra;I.nodeType!==8;){if(!w){w=null;break e}if(I=ga(I.nextSibling),I===null){w=null;break e}}w=I}w!==null?(n.memoizedState={dehydrated:w,treeContext:hi!==null?{id:er,overflow:tr}:null,retryLane:536870912,hydrationErrors:null},I=In(18,null,null,0),I.stateNode=w,I.return=n,n.child=I,En=n,Ut=null,I=!0):I=!1}I||vi(n)}if(w=n.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return Hc(w)?n.lanes=32:n.lanes=536870912,null;ir(n)}return w=o.children,o=o.fallback,c?(Dr(),c=n.mode,w=yo({mode:"hidden",children:w},c),o=pi(o,c,s,null),w.return=n,o.return=n,w.sibling=o,n.child=w,c=n.child,c.memoizedState=ic(s),c.childLanes=sc(e,b,s),n.memoizedState=rc,o):(Rr(n),lc(n,w))}if(I=e.memoizedState,I!==null&&(w=I.dehydrated,w!==null)){if(p)n.flags&256?(Rr(n),n.flags&=-257,n=oc(e,n,s)):n.memoizedState!==null?(Dr(),n.child=e.child,n.flags|=128,n=null):(Dr(),c=o.fallback,w=n.mode,o=yo({mode:"visible",children:o.children},w),c=pi(c,w,s,null),c.flags|=2,o.return=n,c.return=n,o.sibling=c,n.child=o,ns(n,e.child,null,s),o=n.child,o.memoizedState=ic(s),o.childLanes=sc(e,b,s),n.memoizedState=rc,n=c);else if(Rr(n),Hc(w)){if(b=w.nextSibling&&w.nextSibling.dataset,b)var Q=b.dgst;b=Q,o=Error(i(419)),o.stack="",o.digest=b,Fs({value:o,source:null,stack:null}),n=oc(e,n,s)}else if(Jt||js(e,n,s,!1),b=(s&e.childLanes)!==0,Jt||b){if(b=Ct,b!==null&&(o=s&-s,o=(o&42)!==0?1:ws(o),o=(o&(b.suspendedLanes|s))!==0?0:o,o!==0&&o!==I.retryLane))throw I.retryLane=o,qi(e,o),Gn(b,e,o),vp;w.data==="$?"||Cc(),n=oc(e,n,s)}else w.data==="$?"?(n.flags|=192,n.child=e.child,n=null):(e=I.treeContext,Ut=ga(w.nextSibling),En=n,ht=!0,gi=null,Ra=!1,e!==null&&(ea[ta++]=er,ea[ta++]=tr,ea[ta++]=hi,er=e.id,tr=e.overflow,hi=n),n=lc(n,o.children),n.flags|=4096);return n}return c?(Dr(),c=o.fallback,w=n.mode,I=e.child,Q=I.sibling,o=Ja(I,{mode:"hidden",children:o.children}),o.subtreeFlags=I.subtreeFlags&65011712,Q!==null?c=Ja(Q,c):(c=pi(c,w,s,null),c.flags|=2),c.return=n,o.return=n,o.sibling=c,n.child=o,o=c,c=n.child,w=e.child.memoizedState,w===null?w=ic(s):(I=w.cachePool,I!==null?(Q=Qt._currentValue,I=I.parent!==Q?{parent:Q,pool:Q}:I):I=dd(),w={baseLanes:w.baseLanes|s,cachePool:I}),c.memoizedState=w,c.childLanes=sc(e,b,s),n.memoizedState=rc,o):(Rr(n),s=e.child,e=s.sibling,s=Ja(s,{mode:"visible",children:o.children}),s.return=n,s.sibling=null,e!==null&&(b=n.deletions,b===null?(n.deletions=[e],n.flags|=16):b.push(e)),n.child=s,n.memoizedState=null,s)}function lc(e,n){return n=yo({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function yo(e,n){return e=In(22,e,null,n),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function oc(e,n,s){return ns(n,e.child,null,s),e=lc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Mp(e,n,s){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),Cu(e.return,n,s)}function uc(e,n,s,o,c){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:s,tailMode:c}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=o,p.tail=s,p.tailMode=c)}function Np(e,n,s){var o=n.pendingProps,c=o.revealOrder,p=o.tail;if(un(e,n,o.children,s),o=$t.current,(o&2)!==0)o=o&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Mp(e,s,n);else if(e.tag===19)Mp(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}switch(ve($t,o),c){case"forwards":for(s=n.child,c=null;s!==null;)e=s.alternate,e!==null&&ho(e)===null&&(c=s),s=s.sibling;s=c,s===null?(c=n.child,n.child=null):(c=s.sibling,s.sibling=null),uc(n,!1,c,s,p);break;case"backwards":for(s=null,c=n.child,n.child=null;c!==null;){if(e=c.alternate,e!==null&&ho(e)===null){n.child=c;break}e=c.sibling,c.sibling=s,s=c,c=e}uc(n,!0,s,null,p);break;case"together":uc(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function sr(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),Ur|=n.lanes,(s&n.childLanes)===0)if(e!==null){if(js(e,n,s,!1),(s&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(i(153));if(n.child!==null){for(e=n.child,s=Ja(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=Ja(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function cc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Wl(e)))}function gg(e,n,s){switch(n.tag){case 3:Be(n,n.stateNode.containerInfo),Ar(n,Qt,e.memoizedState.cache),Bs();break;case 27:case 5:At(n);break;case 4:Be(n,n.stateNode.containerInfo);break;case 10:Ar(n,n.type,n.memoizedProps.value);break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(Rr(n),n.flags|=128,null):(s&n.child.childLanes)!==0?Cp(e,n,s):(Rr(n),e=sr(e,n,s),e!==null?e.sibling:null);Rr(n);break;case 19:var c=(e.flags&128)!==0;if(o=(s&n.childLanes)!==0,o||(js(e,n,s,!1),o=(s&n.childLanes)!==0),c){if(o)return Np(e,n,s);n.flags|=128}if(c=n.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),ve($t,$t.current),o)break;return null;case 22:case 23:return n.lanes=0,Sp(e,n,s);case 24:Ar(n,Qt,e.memoizedState.cache)}return sr(e,n,s)}function Rp(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps)Jt=!0;else{if(!cc(e,s)&&(n.flags&128)===0)return Jt=!1,gg(e,n,s);Jt=(e.flags&131072)!==0}else Jt=!1,ht&&(n.flags&1048576)!==0&&id(n,$l,n.index);switch(n.lanes=0,n.tag){case 16:e:{e=n.pendingProps;var o=n.elementType,c=o._init;if(o=c(o._payload),n.type=o,typeof o=="function")bu(o)?(e=Ei(o,e),n.tag=1,n=Ap(null,n,o,e,s)):(n.tag=0,n=ac(null,n,o,e,s));else{if(o!=null){if(c=o.$$typeof,c===C){n.tag=11,n=yp(null,n,o,e,s);break e}else if(c===te){n.tag=14,n=bp(null,n,o,e,s);break e}}throw n=W(o)||o,Error(i(306,n,""))}}return n;case 0:return ac(e,n,n.type,n.pendingProps,s);case 1:return o=n.type,c=Ei(o,n.pendingProps),Ap(e,n,o,c,s);case 3:e:{if(Be(n,n.stateNode.containerInfo),e===null)throw Error(i(387));o=n.pendingProps;var p=n.memoizedState;c=p.element,ku(e,n),Vs(n,o,null,s);var b=n.memoizedState;if(o=b.cache,Ar(n,Qt,o),o!==p.cache&&Mu(n,[Qt],s,!0),qs(),o=b.element,p.isDehydrated)if(p={element:o,isDehydrated:!1,cache:b.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=Tp(e,n,o,s);break e}else if(o!==c){c=Kn(Error(i(424)),n),Fs(c),n=Tp(e,n,o,s);break e}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Ut=ga(e.firstChild),En=n,ht=!0,gi=null,Ra=!0,s=lp(n,null,o,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Bs(),o===c){n=sr(e,n,s);break e}un(e,n,o,s)}n=n.child}return n;case 26:return vo(e,n),e===null?(s=kh(n.type,null,n.pendingProps,null))?n.memoizedState=s:ht||(s=n.type,e=n.pendingProps,o=Oo(xe.current).createElement(s),o[sn]=n,o[bn]=e,fn(o,s,e),Dt(o),n.stateNode=o):n.memoizedState=kh(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return At(n),e===null&&ht&&(o=n.stateNode=Dh(n.type,n.pendingProps,xe.current),En=n,Ra=!0,c=Ut,jr(n.type)?(Yc=c,Ut=ga(o.firstChild)):Ut=c),un(e,n,n.pendingProps.children,s),vo(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&ht&&((c=o=Ut)&&(o=Yg(o,n.type,n.pendingProps,Ra),o!==null?(n.stateNode=o,En=n,Ut=ga(o.firstChild),Ra=!1,c=!0):c=!1),c||vi(n)),At(n),c=n.type,p=n.pendingProps,b=e!==null?e.memoizedProps:null,o=p.children,Pc(c,p)?o=null:b!==null&&Pc(c,b)&&(n.flags|=32),n.memoizedState!==null&&(c=ju(e,n,og,null,null,s),hl._currentValue=c),vo(e,n),un(e,n,o,s),n.child;case 6:return e===null&&ht&&((e=s=Ut)&&(s=qg(s,n.pendingProps,Ra),s!==null?(n.stateNode=s,En=n,Ut=null,e=!0):e=!1),e||vi(n)),null;case 13:return Cp(e,n,s);case 4:return Be(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=ns(n,null,o,s):un(e,n,o,s),n.child;case 11:return yp(e,n,n.type,n.pendingProps,s);case 7:return un(e,n,n.pendingProps,s),n.child;case 8:return un(e,n,n.pendingProps.children,s),n.child;case 12:return un(e,n,n.pendingProps.children,s),n.child;case 10:return o=n.pendingProps,Ar(n,n.type,o.value),un(e,n,o.children,s),n.child;case 9:return c=n.type._context,o=n.pendingProps.children,bi(n),c=mn(c),o=o(c),n.flags|=1,un(e,n,o,s),n.child;case 14:return bp(e,n,n.type,n.pendingProps,s);case 15:return xp(e,n,n.type,n.pendingProps,s);case 19:return Np(e,n,s);case 31:return o=n.pendingProps,s=n.mode,o={mode:o.mode,children:o.children},e===null?(s=yo(o,s),s.ref=n.ref,n.child=s,s.return=n,n=s):(s=Ja(e.child,o),s.ref=n.ref,n.child=s,s.return=n,n=s),n;case 22:return Sp(e,n,s);case 24:return bi(n),o=mn(Qt),e===null?(c=Du(),c===null&&(c=Ct,p=Nu(),c.pooledCache=p,p.refCount++,p!==null&&(c.pooledCacheLanes|=s),c=p),n.memoizedState={parent:o,cache:c},Ou(n),Ar(n,Qt,c)):((e.lanes&s)!==0&&(ku(e,n),Vs(n,null,null,s),qs()),c=e.memoizedState,p=n.memoizedState,c.parent!==o?(c={parent:o,cache:o},n.memoizedState=c,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=c),Ar(n,Qt,o)):(o=p.cache,Ar(n,Qt,o),o!==c.cache&&Mu(n,[Qt],s,!0))),un(e,n,n.pendingProps.children,s),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function lr(e){e.flags|=4}function Dp(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Fh(n)){if(n=na.current,n!==null&&((ct&4194048)===ct?Da!==null:(ct&62914560)!==ct&&(ct&536870912)===0||n!==Da))throw Hs=_u,pd;e.flags|=8192}}function bo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Ia():536870912,e.lanes|=n,ss|=n)}function Js(e,n){if(!ht)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Ot(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,o=0;if(n)for(var c=e.child;c!==null;)s|=c.lanes|c.childLanes,o|=c.subtreeFlags&65011712,o|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)s|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=o,e.childLanes=s,n}function vg(e,n,s){var o=n.pendingProps;switch(wu(n),n.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(n),null;case 1:return Ot(n),null;case 3:return s=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),ar(Qt),st(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Is(n)?lr(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,od())),Ot(n),null;case 26:return s=n.memoizedState,e===null?(lr(n),s!==null?(Ot(n),Dp(n,s)):(Ot(n),n.flags&=-16777217)):s?s!==e.memoizedState?(lr(n),Ot(n),Dp(n,s)):(Ot(n),n.flags&=-16777217):(e.memoizedProps!==o&&lr(n),Ot(n),n.flags&=-16777217),null;case 27:Ie(n),s=xe.current;var c=n.type;if(e!==null&&n.stateNode!=null)e.memoizedProps!==o&&lr(n);else{if(!o){if(n.stateNode===null)throw Error(i(166));return Ot(n),null}e=ne.current,Is(n)?sd(n):(e=Dh(c,o,s),n.stateNode=e,lr(n))}return Ot(n),null;case 5:if(Ie(n),s=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&lr(n);else{if(!o){if(n.stateNode===null)throw Error(i(166));return Ot(n),null}if(e=ne.current,Is(n))sd(n);else{switch(c=Oo(xe.current),e){case 1:e=c.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:e=c.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":e=c.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":e=c.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof o.is=="string"?c.createElement("select",{is:o.is}):c.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e=typeof o.is=="string"?c.createElement(s,{is:o.is}):c.createElement(s)}}e[sn]=n,e[bn]=o;e:for(c=n.child;c!==null;){if(c.tag===5||c.tag===6)e.appendChild(c.stateNode);else if(c.tag!==4&&c.tag!==27&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===n)break e;for(;c.sibling===null;){if(c.return===null||c.return===n)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}n.stateNode=e;e:switch(fn(e,s,o),s){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&lr(n)}}return Ot(n),n.flags&=-16777217,null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&lr(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(i(166));if(e=xe.current,Is(n)){if(e=n.stateNode,s=n.memoizedProps,o=null,c=En,c!==null)switch(c.tag){case 27:case 5:o=c.memoizedProps}e[sn]=n,e=!!(e.nodeValue===s||o!==null&&o.suppressHydrationWarning===!0||wh(e.nodeValue,s)),e||vi(n)}else e=Oo(e).createTextNode(o),e[sn]=n,n.stateNode=e}return Ot(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Is(n),o!==null&&o.dehydrated!==null){if(e===null){if(!c)throw Error(i(318));if(c=n.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));c[sn]=n}else Bs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ot(n),c=!1}else c=od(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return n.flags&256?(ir(n),n):(ir(n),null)}if(ir(n),(n.flags&128)!==0)return n.lanes=s,n;if(s=o!==null,e=e!==null&&e.memoizedState!==null,s){o=n.child,c=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(c=o.alternate.memoizedState.cachePool.pool);var p=null;o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==c&&(o.flags|=2048)}return s!==e&&s&&(n.child.flags|=8192),bo(n,n.updateQueue),Ot(n),null;case 4:return st(),e===null&&Uc(n.stateNode.containerInfo),Ot(n),null;case 10:return ar(n.type),Ot(n),null;case 19:if(ie($t),c=n.memoizedState,c===null)return Ot(n),null;if(o=(n.flags&128)!==0,p=c.rendering,p===null)if(o)Js(c,!1);else{if(It!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(p=ho(e),p!==null){for(n.flags|=128,Js(c,!1),e=p.updateQueue,n.updateQueue=e,bo(n,e),n.subtreeFlags=0,e=s,s=n.child;s!==null;)rd(s,e),s=s.sibling;return ve($t,$t.current&1|2),n.child}e=e.sibling}c.tail!==null&&Fe()>Eo&&(n.flags|=128,o=!0,Js(c,!1),n.lanes=4194304)}else{if(!o)if(e=ho(p),e!==null){if(n.flags|=128,o=!0,e=e.updateQueue,n.updateQueue=e,bo(n,e),Js(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!ht)return Ot(n),null}else 2*Fe()-c.renderingStartTime>Eo&&s!==536870912&&(n.flags|=128,o=!0,Js(c,!1),n.lanes=4194304);c.isBackwards?(p.sibling=n.child,n.child=p):(e=c.last,e!==null?e.sibling=p:n.child=p,c.last=p)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=Fe(),n.sibling=null,e=$t.current,ve($t,o?e&1|2:e&1),n):(Ot(n),null);case 22:case 23:return ir(n),Bu(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(s&536870912)!==0&&(n.flags&128)===0&&(Ot(n),n.subtreeFlags&6&&(n.flags|=8192)):Ot(n),s=n.updateQueue,s!==null&&bo(n,s.retryQueue),s=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==s&&(n.flags|=2048),e!==null&&ie(xi),null;case 24:return s=null,e!==null&&(s=e.memoizedState.cache),n.memoizedState.cache!==s&&(n.flags|=2048),ar(Qt),Ot(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function yg(e,n){switch(wu(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return ar(Qt),st(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Ie(n),null;case 13:if(ir(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Bs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return ie($t),null;case 4:return st(),null;case 10:return ar(n.type),null;case 22:case 23:return ir(n),Bu(),e!==null&&ie(xi),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return ar(Qt),null;case 25:return null;default:return null}}function _p(e,n){switch(wu(n),n.tag){case 3:ar(Qt),st();break;case 26:case 27:case 5:Ie(n);break;case 4:st();break;case 13:ir(n);break;case 19:ie($t);break;case 10:ar(n.type);break;case 22:case 23:ir(n),Bu(),e!==null&&ie(xi);break;case 24:ar(Qt)}}function el(e,n){try{var s=n.updateQueue,o=s!==null?s.lastEffect:null;if(o!==null){var c=o.next;s=c;do{if((s.tag&e)===e){o=void 0;var p=s.create,b=s.inst;o=p(),b.destroy=o}s=s.next}while(s!==c)}}catch(w){Tt(n,n.return,w)}}function _r(e,n,s){try{var o=n.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var p=c.next;o=p;do{if((o.tag&e)===e){var b=o.inst,w=b.destroy;if(w!==void 0){b.destroy=void 0,c=n;var I=s,Q=w;try{Q()}catch(le){Tt(c,I,le)}}}o=o.next}while(o!==p)}}catch(le){Tt(n,n.return,le)}}function Op(e){var n=e.updateQueue;if(n!==null){var s=e.stateNode;try{bd(n,s)}catch(o){Tt(e,e.return,o)}}}function kp(e,n,s){s.props=Ei(e.type,e.memoizedProps),s.state=e.memoizedState;try{s.componentWillUnmount()}catch(o){Tt(e,n,o)}}function tl(e,n){try{var s=e.ref;if(s!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof s=="function"?e.refCleanup=s(o):s.current=o}}catch(c){Tt(e,n,c)}}function _a(e,n){var s=e.ref,o=e.refCleanup;if(s!==null)if(typeof o=="function")try{o()}catch(c){Tt(e,n,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(c){Tt(e,n,c)}else s.current=null}function Lp(e){var n=e.type,s=e.memoizedProps,o=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":s.autoFocus&&o.focus();break e;case"img":s.src?o.src=s.src:s.srcSet&&(o.srcset=s.srcSet)}}catch(c){Tt(e,e.return,c)}}function fc(e,n,s){try{var o=e.stateNode;jg(o,e.type,s,n),o[bn]=n}catch(c){Tt(e,e.return,c)}}function Up(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&jr(e.type)||e.tag===4}function dc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Up(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&jr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pc(e,n,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(e,n):(n=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,n.appendChild(e),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=_o));else if(o!==4&&(o===27&&jr(e.type)&&(s=e.stateNode,n=null),e=e.child,e!==null))for(pc(e,n,s),e=e.sibling;e!==null;)pc(e,n,s),e=e.sibling}function xo(e,n,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(o!==4&&(o===27&&jr(e.type)&&(s=e.stateNode),e=e.child,e!==null))for(xo(e,n,s),e=e.sibling;e!==null;)xo(e,n,s),e=e.sibling}function Ip(e){var n=e.stateNode,s=e.memoizedProps;try{for(var o=e.type,c=n.attributes;c.length;)n.removeAttributeNode(c[0]);fn(n,o,s),n[sn]=e,n[bn]=s}catch(p){Tt(e,e.return,p)}}var or=!1,zt=!1,hc=!1,Bp=typeof WeakSet=="function"?WeakSet:Set,en=null;function bg(e,n){if(e=e.containerInfo,Fc=Fo,e=Zf(e),du(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var o=s.getSelection&&s.getSelection();if(o&&o.rangeCount!==0){s=o.anchorNode;var c=o.anchorOffset,p=o.focusNode;o=o.focusOffset;try{s.nodeType,p.nodeType}catch{s=null;break e}var b=0,w=-1,I=-1,Q=0,le=0,fe=e,K=null;t:for(;;){for(var ee;fe!==s||c!==0&&fe.nodeType!==3||(w=b+c),fe!==p||o!==0&&fe.nodeType!==3||(I=b+o),fe.nodeType===3&&(b+=fe.nodeValue.length),(ee=fe.firstChild)!==null;)K=fe,fe=ee;for(;;){if(fe===e)break t;if(K===s&&++Q===c&&(w=b),K===p&&++le===o&&(I=b),(ee=fe.nextSibling)!==null)break;fe=K,K=fe.parentNode}fe=ee}s=w===-1||I===-1?null:{start:w,end:I}}else s=null}s=s||{start:0,end:0}}else s=null;for(jc={focusedElem:e,selectionRange:s},Fo=!1,en=n;en!==null;)if(n=en,e=n.child,(n.subtreeFlags&1024)!==0&&e!==null)e.return=n,en=e;else for(;en!==null;){switch(n=en,p=n.alternate,e=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,s=n,c=p.memoizedProps,p=p.memoizedState,o=s.stateNode;try{var Ve=Ei(s.type,c,s.elementType===s.type);e=o.getSnapshotBeforeUpdate(Ve,p),o.__reactInternalSnapshotBeforeUpdate=e}catch(Pe){Tt(s,s.return,Pe)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,s=e.nodeType,s===9)zc(e);else if(s===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":zc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=n.sibling,e!==null){e.return=n.return,en=e;break}en=n.return}}function Fp(e,n,s){var o=s.flags;switch(s.tag){case 0:case 11:case 15:Or(e,s),o&4&&el(5,s);break;case 1:if(Or(e,s),o&4)if(e=s.stateNode,n===null)try{e.componentDidMount()}catch(b){Tt(s,s.return,b)}else{var c=Ei(s.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(c,n,e.__reactInternalSnapshotBeforeUpdate)}catch(b){Tt(s,s.return,b)}}o&64&&Op(s),o&512&&tl(s,s.return);break;case 3:if(Or(e,s),o&64&&(e=s.updateQueue,e!==null)){if(n=null,s.child!==null)switch(s.child.tag){case 27:case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}try{bd(e,n)}catch(b){Tt(s,s.return,b)}}break;case 27:n===null&&o&4&&Ip(s);case 26:case 5:Or(e,s),n===null&&o&4&&Lp(s),o&512&&tl(s,s.return);break;case 12:Or(e,s);break;case 13:Or(e,s),o&4&&Gp(e,s),o&64&&(e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(s=Ng.bind(null,s),Vg(e,s))));break;case 22:if(o=s.memoizedState!==null||or,!o){n=n!==null&&n.memoizedState!==null||zt,c=or;var p=zt;or=o,(zt=n)&&!p?kr(e,s,(s.subtreeFlags&8772)!==0):Or(e,s),or=c,zt=p}break;case 30:break;default:Or(e,s)}}function jp(e){var n=e.alternate;n!==null&&(e.alternate=null,jp(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Xn(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var _t=null,Rn=!1;function ur(e,n,s){for(s=s.child;s!==null;)Pp(e,n,s),s=s.sibling}function Pp(e,n,s){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Ea,s)}catch{}switch(s.tag){case 26:zt||_a(s,n),ur(e,n,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:zt||_a(s,n);var o=_t,c=Rn;jr(s.type)&&(_t=s.stateNode,Rn=!1),ur(e,n,s),cl(s.stateNode),_t=o,Rn=c;break;case 5:zt||_a(s,n);case 6:if(o=_t,c=Rn,_t=null,ur(e,n,s),_t=o,Rn=c,_t!==null)if(Rn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(s.stateNode)}catch(p){Tt(s,n,p)}else try{_t.removeChild(s.stateNode)}catch(p){Tt(s,n,p)}break;case 18:_t!==null&&(Rn?(e=_t,Nh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,s.stateNode),yl(e)):Nh(_t,s.stateNode));break;case 4:o=_t,c=Rn,_t=s.stateNode.containerInfo,Rn=!0,ur(e,n,s),_t=o,Rn=c;break;case 0:case 11:case 14:case 15:zt||_r(2,s,n),zt||_r(4,s,n),ur(e,n,s);break;case 1:zt||(_a(s,n),o=s.stateNode,typeof o.componentWillUnmount=="function"&&kp(s,n,o)),ur(e,n,s);break;case 21:ur(e,n,s);break;case 22:zt=(o=zt)||s.memoizedState!==null,ur(e,n,s),zt=o;break;default:ur(e,n,s)}}function Gp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{yl(e)}catch(s){Tt(n,n.return,s)}}function xg(e){switch(e.tag){case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Bp),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Bp),n;default:throw Error(i(435,e.tag))}}function mc(e,n){var s=xg(e);n.forEach(function(o){var c=Rg.bind(null,e,o);s.has(o)||(s.add(o),o.then(c,c))})}function Bn(e,n){var s=n.deletions;if(s!==null)for(var o=0;o<s.length;o++){var c=s[o],p=e,b=n,w=b;e:for(;w!==null;){switch(w.tag){case 27:if(jr(w.type)){_t=w.stateNode,Rn=!1;break e}break;case 5:_t=w.stateNode,Rn=!1;break e;case 3:case 4:_t=w.stateNode.containerInfo,Rn=!0;break e}w=w.return}if(_t===null)throw Error(i(160));Pp(p,b,c),_t=null,Rn=!1,p=c.alternate,p!==null&&(p.return=null),c.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)zp(n,e),n=n.sibling}var ma=null;function zp(e,n){var s=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Bn(n,e),Fn(e),o&4&&(_r(3,e,e.return),el(3,e),_r(5,e,e.return));break;case 1:Bn(n,e),Fn(e),o&512&&(zt||s===null||_a(s,s.return)),o&64&&or&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(s=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=s===null?o:s.concat(o))));break;case 26:var c=ma;if(Bn(n,e),Fn(e),o&512&&(zt||s===null||_a(s,s.return)),o&4){var p=s!==null?s.memoizedState:null;if(o=e.memoizedState,s===null)if(o===null)if(e.stateNode===null){e:{o=e.type,s=e.memoizedProps,c=c.ownerDocument||c;t:switch(o){case"title":p=c.getElementsByTagName("title")[0],(!p||p[dt]||p[sn]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=c.createElement(o),c.head.insertBefore(p,c.querySelector("head > title"))),fn(p,o,s),p[sn]=e,Dt(p),o=p;break e;case"link":var b=Ih("link","href",c).get(o+(s.href||""));if(b){for(var w=0;w<b.length;w++)if(p=b[w],p.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&p.getAttribute("rel")===(s.rel==null?null:s.rel)&&p.getAttribute("title")===(s.title==null?null:s.title)&&p.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){b.splice(w,1);break t}}p=c.createElement(o),fn(p,o,s),c.head.appendChild(p);break;case"meta":if(b=Ih("meta","content",c).get(o+(s.content||""))){for(w=0;w<b.length;w++)if(p=b[w],p.getAttribute("content")===(s.content==null?null:""+s.content)&&p.getAttribute("name")===(s.name==null?null:s.name)&&p.getAttribute("property")===(s.property==null?null:s.property)&&p.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&p.getAttribute("charset")===(s.charSet==null?null:s.charSet)){b.splice(w,1);break t}}p=c.createElement(o),fn(p,o,s),c.head.appendChild(p);break;default:throw Error(i(468,o))}p[sn]=e,Dt(p),o=p}e.stateNode=o}else Bh(c,e.type,e.stateNode);else e.stateNode=Uh(c,o,e.memoizedProps);else p!==o?(p===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):p.count--,o===null?Bh(c,e.type,e.stateNode):Uh(c,o,e.memoizedProps)):o===null&&e.stateNode!==null&&fc(e,e.memoizedProps,s.memoizedProps)}break;case 27:Bn(n,e),Fn(e),o&512&&(zt||s===null||_a(s,s.return)),s!==null&&o&4&&fc(e,e.memoizedProps,s.memoizedProps);break;case 5:if(Bn(n,e),Fn(e),o&512&&(zt||s===null||_a(s,s.return)),e.flags&32){c=e.stateNode;try{Qn(c,"")}catch(ee){Tt(e,e.return,ee)}}o&4&&e.stateNode!=null&&(c=e.memoizedProps,fc(e,c,s!==null?s.memoizedProps:c)),o&1024&&(hc=!0);break;case 6:if(Bn(n,e),Fn(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,s=e.stateNode;try{s.nodeValue=o}catch(ee){Tt(e,e.return,ee)}}break;case 3:if(Uo=null,c=ma,ma=ko(n.containerInfo),Bn(n,e),ma=c,Fn(e),o&4&&s!==null&&s.memoizedState.isDehydrated)try{yl(n.containerInfo)}catch(ee){Tt(e,e.return,ee)}hc&&(hc=!1,Hp(e));break;case 4:o=ma,ma=ko(e.stateNode.containerInfo),Bn(n,e),Fn(e),ma=o;break;case 12:Bn(n,e),Fn(e);break;case 13:Bn(n,e),Fn(e),e.child.flags&8192&&e.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(Sc=Fe()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,mc(e,o)));break;case 22:c=e.memoizedState!==null;var I=s!==null&&s.memoizedState!==null,Q=or,le=zt;if(or=Q||c,zt=le||I,Bn(n,e),zt=le,or=Q,Fn(e),o&8192)e:for(n=e.stateNode,n._visibility=c?n._visibility&-2:n._visibility|1,c&&(s===null||I||or||zt||wi(e)),s=null,n=e;;){if(n.tag===5||n.tag===26){if(s===null){I=s=n;try{if(p=I.stateNode,c)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{w=I.stateNode;var fe=I.memoizedProps.style,K=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;w.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(ee){Tt(I,I.return,ee)}}}else if(n.tag===6){if(s===null){I=n;try{I.stateNode.nodeValue=c?"":I.memoizedProps}catch(ee){Tt(I,I.return,ee)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;s===n&&(s=null),n=n.return}s===n&&(s=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(s=o.retryQueue,s!==null&&(o.retryQueue=null,mc(e,s))));break;case 19:Bn(n,e),Fn(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,mc(e,o)));break;case 30:break;case 21:break;default:Bn(n,e),Fn(e)}}function Fn(e){var n=e.flags;if(n&2){try{for(var s,o=e.return;o!==null;){if(Up(o)){s=o;break}o=o.return}if(s==null)throw Error(i(160));switch(s.tag){case 27:var c=s.stateNode,p=dc(e);xo(e,p,c);break;case 5:var b=s.stateNode;s.flags&32&&(Qn(b,""),s.flags&=-33);var w=dc(e);xo(e,w,b);break;case 3:case 4:var I=s.stateNode.containerInfo,Q=dc(e);pc(e,Q,I);break;default:throw Error(i(161))}}catch(le){Tt(e,e.return,le)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Hp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;Hp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Or(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Fp(e,n.alternate,n),n=n.sibling}function wi(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:_r(4,n,n.return),wi(n);break;case 1:_a(n,n.return);var s=n.stateNode;typeof s.componentWillUnmount=="function"&&kp(n,n.return,s),wi(n);break;case 27:cl(n.stateNode);case 26:case 5:_a(n,n.return),wi(n);break;case 22:n.memoizedState===null&&wi(n);break;case 30:wi(n);break;default:wi(n)}e=e.sibling}}function kr(e,n,s){for(s=s&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,c=e,p=n,b=p.flags;switch(p.tag){case 0:case 11:case 15:kr(c,p,s),el(4,p);break;case 1:if(kr(c,p,s),o=p,c=o.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(Q){Tt(o,o.return,Q)}if(o=p,c=o.updateQueue,c!==null){var w=o.stateNode;try{var I=c.shared.hiddenCallbacks;if(I!==null)for(c.shared.hiddenCallbacks=null,c=0;c<I.length;c++)yd(I[c],w)}catch(Q){Tt(o,o.return,Q)}}s&&b&64&&Op(p),tl(p,p.return);break;case 27:Ip(p);case 26:case 5:kr(c,p,s),s&&o===null&&b&4&&Lp(p),tl(p,p.return);break;case 12:kr(c,p,s);break;case 13:kr(c,p,s),s&&b&4&&Gp(c,p);break;case 22:p.memoizedState===null&&kr(c,p,s),tl(p,p.return);break;case 30:break;default:kr(c,p,s)}n=n.sibling}}function gc(e,n){var s=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==s&&(e!=null&&e.refCount++,s!=null&&Ps(s))}function vc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ps(e))}function Oa(e,n,s,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Yp(e,n,s,o),n=n.sibling}function Yp(e,n,s,o){var c=n.flags;switch(n.tag){case 0:case 11:case 15:Oa(e,n,s,o),c&2048&&el(9,n);break;case 1:Oa(e,n,s,o);break;case 3:Oa(e,n,s,o),c&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ps(e)));break;case 12:if(c&2048){Oa(e,n,s,o),e=n.stateNode;try{var p=n.memoizedProps,b=p.id,w=p.onPostCommit;typeof w=="function"&&w(b,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(I){Tt(n,n.return,I)}}else Oa(e,n,s,o);break;case 13:Oa(e,n,s,o);break;case 23:break;case 22:p=n.stateNode,b=n.alternate,n.memoizedState!==null?p._visibility&2?Oa(e,n,s,o):nl(e,n):p._visibility&2?Oa(e,n,s,o):(p._visibility|=2,as(e,n,s,o,(n.subtreeFlags&10256)!==0)),c&2048&&gc(b,n);break;case 24:Oa(e,n,s,o),c&2048&&vc(n.alternate,n);break;default:Oa(e,n,s,o)}}function as(e,n,s,o,c){for(c=c&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var p=e,b=n,w=s,I=o,Q=b.flags;switch(b.tag){case 0:case 11:case 15:as(p,b,w,I,c),el(8,b);break;case 23:break;case 22:var le=b.stateNode;b.memoizedState!==null?le._visibility&2?as(p,b,w,I,c):nl(p,b):(le._visibility|=2,as(p,b,w,I,c)),c&&Q&2048&&gc(b.alternate,b);break;case 24:as(p,b,w,I,c),c&&Q&2048&&vc(b.alternate,b);break;default:as(p,b,w,I,c)}n=n.sibling}}function nl(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var s=e,o=n,c=o.flags;switch(o.tag){case 22:nl(s,o),c&2048&&gc(o.alternate,o);break;case 24:nl(s,o),c&2048&&vc(o.alternate,o);break;default:nl(s,o)}n=n.sibling}}var al=8192;function rs(e){if(e.subtreeFlags&al)for(e=e.child;e!==null;)qp(e),e=e.sibling}function qp(e){switch(e.tag){case 26:rs(e),e.flags&al&&e.memoizedState!==null&&iv(ma,e.memoizedState,e.memoizedProps);break;case 5:rs(e);break;case 3:case 4:var n=ma;ma=ko(e.stateNode.containerInfo),rs(e),ma=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=al,al=16777216,rs(e),al=n):rs(e));break;default:rs(e)}}function Vp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function rl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];en=o,Zp(o,e)}Vp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Xp(e),e=e.sibling}function Xp(e){switch(e.tag){case 0:case 11:case 15:rl(e),e.flags&2048&&_r(9,e,e.return);break;case 3:rl(e);break;case 12:rl(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,So(e)):rl(e);break;default:rl(e)}}function So(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];en=o,Zp(o,e)}Vp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:_r(8,n,n.return),So(n);break;case 22:s=n.stateNode,s._visibility&2&&(s._visibility&=-3,So(n));break;default:So(n)}e=e.sibling}}function Zp(e,n){for(;en!==null;){var s=en;switch(s.tag){case 0:case 11:case 15:_r(8,s,n);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var o=s.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Ps(s.memoizedState.cache)}if(o=s.child,o!==null)o.return=s,en=o;else e:for(s=e;en!==null;){o=en;var c=o.sibling,p=o.return;if(jp(o),o===s){en=null;break e}if(c!==null){c.return=p,en=c;break e}en=p}}}var Sg={getCacheForType:function(e){var n=mn(Qt),s=n.data.get(e);return s===void 0&&(s=e(),n.data.set(e,s)),s}},Eg=typeof WeakMap=="function"?WeakMap:Map,yt=0,Ct=null,ot=null,ct=0,bt=0,jn=null,Lr=!1,is=!1,yc=!1,cr=0,It=0,Ur=0,Ai=0,bc=0,aa=0,ss=0,il=null,Dn=null,xc=!1,Sc=0,Eo=1/0,wo=null,Ir=null,cn=0,Br=null,ls=null,os=0,Ec=0,wc=null,Qp=null,sl=0,Ac=null;function Pn(){if((yt&2)!==0&&ct!==0)return ct&-ct;if(U.T!==null){var e=Qi;return e!==0?e:_c()}return Yt()}function $p(){aa===0&&(aa=(ct&536870912)===0||ht?Oi():536870912);var e=na.current;return e!==null&&(e.flags|=32),aa}function Gn(e,n,s){(e===Ct&&(bt===2||bt===9)||e.cancelPendingCommit!==null)&&(us(e,0),Fr(e,ct,aa,!1)),Vn(e,s),((yt&2)===0||e!==Ct)&&(e===Ct&&((yt&2)===0&&(Ai|=s),It===4&&Fr(e,ct,aa,!1)),ka(e))}function Wp(e,n,s){if((yt&6)!==0)throw Error(i(327));var o=!s&&(n&124)===0&&(n&e.expiredLanes)===0||_i(e,n),c=o?Tg(e,n):Mc(e,n,!0),p=o;do{if(c===0){is&&!o&&Fr(e,n,0,!1);break}else{if(s=e.current.alternate,p&&!wg(s)){c=Mc(e,n,!1),p=!1;continue}if(c===2){if(p=n,e.errorRecoveryDisabledLanes&p)var b=0;else b=e.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){n=b;e:{var w=e;c=il;var I=w.current.memoizedState.isDehydrated;if(I&&(us(w,b).flags|=256),b=Mc(w,b,!1),b!==2){if(yc&&!I){w.errorRecoveryDisabledLanes|=p,Ai|=p,c=4;break e}p=Dn,Dn=c,p!==null&&(Dn===null?Dn=p:Dn.push.apply(Dn,p))}c=b}if(p=!1,c!==2)continue}}if(c===1){us(e,0),Fr(e,n,0,!0);break}e:{switch(o=e,p=c,p){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:Fr(o,n,aa,!Lr);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(c=Sc+300-Fe(),10<c)){if(Fr(o,n,aa,!Lr),An(o,0,!0)!==0)break e;o.timeoutHandle=Ch(Kp.bind(null,o,s,Dn,wo,xc,n,aa,Ai,ss,Lr,p,2,-0,0),c);break e}Kp(o,s,Dn,wo,xc,n,aa,Ai,ss,Lr,p,0,-0,0)}}break}while(!0);ka(e)}function Kp(e,n,s,o,c,p,b,w,I,Q,le,fe,K,ee){if(e.timeoutHandle=-1,fe=n.subtreeFlags,(fe&8192||(fe&16785408)===16785408)&&(pl={stylesheets:null,count:0,unsuspend:rv},qp(n),fe=sv(),fe!==null)){e.cancelPendingCommit=fe(ih.bind(null,e,n,p,s,o,c,b,w,I,le,1,K,ee)),Fr(e,p,b,!Q);return}ih(e,n,p,s,o,c,b,w,I)}function wg(e){for(var n=e;;){var s=n.tag;if((s===0||s===11||s===15)&&n.flags&16384&&(s=n.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var o=0;o<s.length;o++){var c=s[o],p=c.getSnapshot;c=c.value;try{if(!Un(p(),c))return!1}catch{return!1}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Fr(e,n,s,o){n&=~bc,n&=~Ai,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var c=n;0<c;){var p=31-Ht(c),b=1<<p;o[p]=-1,c&=~b}s!==0&&Aa(e,s,n)}function Ao(){return(yt&6)===0?(ll(0),!1):!0}function Tc(){if(ot!==null){if(bt===0)var e=ot.return;else e=ot,nr=yi=null,zu(e),ts=null,Ws=0,e=ot;for(;e!==null;)_p(e.alternate,e),e=e.return;ot=null}}function us(e,n){var s=e.timeoutHandle;s!==-1&&(e.timeoutHandle=-1,Gg(s)),s=e.cancelPendingCommit,s!==null&&(e.cancelPendingCommit=null,s()),Tc(),Ct=e,ot=s=Ja(e.current,null),ct=n,bt=0,jn=null,Lr=!1,is=_i(e,n),yc=!1,ss=aa=bc=Ai=Ur=It=0,Dn=il=null,xc=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var c=31-Ht(o),p=1<<c;n|=e[c],o&=~p}return cr=n,ql(),s}function Jp(e,n){at=null,U.H=co,n===zs||n===eo?(n=gd(),bt=3):n===pd?(n=gd(),bt=4):bt=n===vp?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,jn=n,ot===null&&(It=1,go(e,Kn(n,e.current)))}function eh(){var e=U.H;return U.H=co,e===null?co:e}function th(){var e=U.A;return U.A=Sg,e}function Cc(){It=4,Lr||(ct&4194048)!==ct&&na.current!==null||(is=!0),(Ur&134217727)===0&&(Ai&134217727)===0||Ct===null||Fr(Ct,ct,aa,!1)}function Mc(e,n,s){var o=yt;yt|=2;var c=eh(),p=th();(Ct!==e||ct!==n)&&(wo=null,us(e,n)),n=!1;var b=It;e:do try{if(bt!==0&&ot!==null){var w=ot,I=jn;switch(bt){case 8:Tc(),b=6;break e;case 3:case 2:case 9:case 6:na.current===null&&(n=!0);var Q=bt;if(bt=0,jn=null,cs(e,w,I,Q),s&&is){b=0;break e}break;default:Q=bt,bt=0,jn=null,cs(e,w,I,Q)}}Ag(),b=It;break}catch(le){Jp(e,le)}while(!0);return n&&e.shellSuspendCounter++,nr=yi=null,yt=o,U.H=c,U.A=p,ot===null&&(Ct=null,ct=0,ql()),b}function Ag(){for(;ot!==null;)nh(ot)}function Tg(e,n){var s=yt;yt|=2;var o=eh(),c=th();Ct!==e||ct!==n?(wo=null,Eo=Fe()+500,us(e,n)):is=_i(e,n);e:do try{if(bt!==0&&ot!==null){n=ot;var p=jn;t:switch(bt){case 1:bt=0,jn=null,cs(e,n,p,1);break;case 2:case 9:if(hd(p)){bt=0,jn=null,ah(n);break}n=function(){bt!==2&&bt!==9||Ct!==e||(bt=7),ka(e)},p.then(n,n);break e;case 3:bt=7;break e;case 4:bt=5;break e;case 7:hd(p)?(bt=0,jn=null,ah(n)):(bt=0,jn=null,cs(e,n,p,7));break;case 5:var b=null;switch(ot.tag){case 26:b=ot.memoizedState;case 5:case 27:var w=ot;if(!b||Fh(b)){bt=0,jn=null;var I=w.sibling;if(I!==null)ot=I;else{var Q=w.return;Q!==null?(ot=Q,To(Q)):ot=null}break t}}bt=0,jn=null,cs(e,n,p,5);break;case 6:bt=0,jn=null,cs(e,n,p,6);break;case 8:Tc(),It=6;break e;default:throw Error(i(462))}}Cg();break}catch(le){Jp(e,le)}while(!0);return nr=yi=null,U.H=o,U.A=c,yt=s,ot!==null?0:(Ct=null,ct=0,ql(),It)}function Cg(){for(;ot!==null&&!we();)nh(ot)}function nh(e){var n=Rp(e.alternate,e,cr);e.memoizedProps=e.pendingProps,n===null?To(e):ot=n}function ah(e){var n=e,s=n.alternate;switch(n.tag){case 15:case 0:n=wp(s,n,n.pendingProps,n.type,void 0,ct);break;case 11:n=wp(s,n,n.pendingProps,n.type.render,n.ref,ct);break;case 5:zu(n);default:_p(s,n),n=ot=rd(n,cr),n=Rp(s,n,cr)}e.memoizedProps=e.pendingProps,n===null?To(e):ot=n}function cs(e,n,s,o){nr=yi=null,zu(n),ts=null,Ws=0;var c=n.return;try{if(mg(e,c,n,s,ct)){It=1,go(e,Kn(s,e.current)),ot=null;return}}catch(p){if(c!==null)throw ot=c,p;It=1,go(e,Kn(s,e.current)),ot=null;return}n.flags&32768?(ht||o===1?e=!0:is||(ct&536870912)!==0?e=!1:(Lr=e=!0,(o===2||o===9||o===3||o===6)&&(o=na.current,o!==null&&o.tag===13&&(o.flags|=16384))),rh(n,e)):To(n)}function To(e){var n=e;do{if((n.flags&32768)!==0){rh(n,Lr);return}e=n.return;var s=vg(n.alternate,n,cr);if(s!==null){ot=s;return}if(n=n.sibling,n!==null){ot=n;return}ot=n=e}while(n!==null);It===0&&(It=5)}function rh(e,n){do{var s=yg(e.alternate,e);if(s!==null){s.flags&=32767,ot=s;return}if(s=e.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!n&&(e=e.sibling,e!==null)){ot=e;return}ot=e=s}while(e!==null);It=6,ot=null}function ih(e,n,s,o,c,p,b,w,I){e.cancelPendingCommit=null;do Co();while(cn!==0);if((yt&6)!==0)throw Error(i(327));if(n!==null){if(n===e.current)throw Error(i(177));if(p=n.lanes|n.childLanes,p|=vu,kn(e,s,p,b,w,I),e===Ct&&(ot=Ct=null,ct=0),ls=n,Br=e,os=s,Ec=p,wc=c,Qp=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Dg(Ue,function(){return ch(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=U.T,U.T=null,c=G.p,G.p=2,b=yt,yt|=4;try{bg(e,n,s)}finally{yt=b,G.p=c,U.T=o}}cn=1,sh(),lh(),oh()}}function sh(){if(cn===1){cn=0;var e=Br,n=ls,s=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||s){s=U.T,U.T=null;var o=G.p;G.p=2;var c=yt;yt|=4;try{zp(n,e);var p=jc,b=Zf(e.containerInfo),w=p.focusedElem,I=p.selectionRange;if(b!==w&&w&&w.ownerDocument&&Xf(w.ownerDocument.documentElement,w)){if(I!==null&&du(w)){var Q=I.start,le=I.end;if(le===void 0&&(le=Q),"selectionStart"in w)w.selectionStart=Q,w.selectionEnd=Math.min(le,w.value.length);else{var fe=w.ownerDocument||document,K=fe&&fe.defaultView||window;if(K.getSelection){var ee=K.getSelection(),Ve=w.textContent.length,Pe=Math.min(I.start,Ve),wt=I.end===void 0?Pe:Math.min(I.end,Ve);!ee.extend&&Pe>wt&&(b=wt,wt=Pe,Pe=b);var Y=Vf(w,Pe),P=Vf(w,wt);if(Y&&P&&(ee.rangeCount!==1||ee.anchorNode!==Y.node||ee.anchorOffset!==Y.offset||ee.focusNode!==P.node||ee.focusOffset!==P.offset)){var Z=fe.createRange();Z.setStart(Y.node,Y.offset),ee.removeAllRanges(),Pe>wt?(ee.addRange(Z),ee.extend(P.node,P.offset)):(Z.setEnd(P.node,P.offset),ee.addRange(Z))}}}}for(fe=[],ee=w;ee=ee.parentNode;)ee.nodeType===1&&fe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<fe.length;w++){var oe=fe[w];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}Fo=!!Fc,jc=Fc=null}finally{yt=c,G.p=o,U.T=s}}e.current=n,cn=2}}function lh(){if(cn===2){cn=0;var e=Br,n=ls,s=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||s){s=U.T,U.T=null;var o=G.p;G.p=2;var c=yt;yt|=4;try{Fp(e,n.alternate,n)}finally{yt=c,G.p=o,U.T=s}}cn=3}}function oh(){if(cn===4||cn===3){cn=0,se();var e=Br,n=ls,s=os,o=Qp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?cn=5:(cn=0,ls=Br=null,uh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Ir=null),As(s),n=n.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Ea,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=U.T,c=G.p,G.p=2,U.T=null;try{for(var p=e.onRecoverableError,b=0;b<o.length;b++){var w=o[b];p(w.value,{componentStack:w.stack})}}finally{U.T=n,G.p=c}}(os&3)!==0&&Co(),ka(e),c=e.pendingLanes,(s&4194090)!==0&&(c&42)!==0?e===Ac?sl++:(sl=0,Ac=e):sl=0,ll(0)}}function uh(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Ps(n)))}function Co(e){return sh(),lh(),oh(),ch()}function ch(){if(cn!==5)return!1;var e=Br,n=Ec;Ec=0;var s=As(os),o=U.T,c=G.p;try{G.p=32>s?32:s,U.T=null,s=wc,wc=null;var p=Br,b=os;if(cn=0,ls=Br=null,os=0,(yt&6)!==0)throw Error(i(331));var w=yt;if(yt|=4,Xp(p.current),Yp(p,p.current,b,s),yt=w,ll(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Ea,p)}catch{}return!0}finally{G.p=c,U.T=o,uh(e,n)}}function fh(e,n,s){n=Kn(s,n),n=nc(e.stateNode,n,2),e=Mr(e,n,2),e!==null&&(Vn(e,2),ka(e))}function Tt(e,n,s){if(e.tag===3)fh(e,e,s);else for(;n!==null;){if(n.tag===3){fh(n,e,s);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ir===null||!Ir.has(o))){e=Kn(s,e),s=mp(2),o=Mr(n,s,2),o!==null&&(gp(s,o,n,e),Vn(o,2),ka(o));break}}n=n.return}}function Nc(e,n,s){var o=e.pingCache;if(o===null){o=e.pingCache=new Eg;var c=new Set;o.set(n,c)}else c=o.get(n),c===void 0&&(c=new Set,o.set(n,c));c.has(s)||(yc=!0,c.add(s),e=Mg.bind(null,e,n,s),n.then(e,e))}function Mg(e,n,s){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&s,e.warmLanes&=~s,Ct===e&&(ct&s)===s&&(It===4||It===3&&(ct&62914560)===ct&&300>Fe()-Sc?(yt&2)===0&&us(e,0):bc|=s,ss===ct&&(ss=0)),ka(e)}function dh(e,n){n===0&&(n=Ia()),e=qi(e,n),e!==null&&(Vn(e,n),ka(e))}function Ng(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),dh(e,s)}function Rg(e,n){var s=0;switch(e.tag){case 13:var o=e.stateNode,c=e.memoizedState;c!==null&&(s=c.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(n),dh(e,s)}function Dg(e,n){return rt(e,n)}var Mo=null,fs=null,Rc=!1,No=!1,Dc=!1,Ti=0;function ka(e){e!==fs&&e.next===null&&(fs===null?Mo=fs=e:fs=fs.next=e),No=!0,Rc||(Rc=!0,Og())}function ll(e,n){if(!Dc&&No){Dc=!0;do for(var s=!1,o=Mo;o!==null;){if(e!==0){var c=o.pendingLanes;if(c===0)var p=0;else{var b=o.suspendedLanes,w=o.pingedLanes;p=(1<<31-Ht(42|e)+1)-1,p&=c&~(b&~w),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(s=!0,gh(o,p))}else p=ct,p=An(o,o===Ct?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(p&3)===0||_i(o,p)||(s=!0,gh(o,p));o=o.next}while(s);Dc=!1}}function _g(){ph()}function ph(){No=Rc=!1;var e=0;Ti!==0&&(Pg()&&(e=Ti),Ti=0);for(var n=Fe(),s=null,o=Mo;o!==null;){var c=o.next,p=hh(o,n);p===0?(o.next=null,s===null?Mo=c:s.next=c,c===null&&(fs=s)):(s=o,(e!==0||(p&3)!==0)&&(No=!0)),o=c}ll(e)}function hh(e,n){for(var s=e.suspendedLanes,o=e.pingedLanes,c=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var b=31-Ht(p),w=1<<b,I=c[b];I===-1?((w&s)===0||(w&o)!==0)&&(c[b]=gr(w,n)):I<=n&&(e.expiredLanes|=w),p&=~w}if(n=Ct,s=ct,s=An(e,e===n?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,s===0||e===n&&(bt===2||bt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&mt(o),e.callbackNode=null,e.callbackPriority=0;if((s&3)===0||_i(e,s)){if(n=s&-s,n===e.callbackPriority)return n;switch(o!==null&&mt(o),As(s)){case 2:case 8:s=Je;break;case 32:s=Ue;break;case 268435456:s=Yn;break;default:s=Ue}return o=mh.bind(null,e),s=rt(s,o),e.callbackPriority=n,e.callbackNode=s,n}return o!==null&&o!==null&&mt(o),e.callbackPriority=2,e.callbackNode=null,2}function mh(e,n){if(cn!==0&&cn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var s=e.callbackNode;if(Co()&&e.callbackNode!==s)return null;var o=ct;return o=An(e,e===Ct?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(Wp(e,o,n),hh(e,Fe()),e.callbackNode!=null&&e.callbackNode===s?mh.bind(null,e):null)}function gh(e,n){if(Co())return null;Wp(e,n,!0)}function Og(){zg(function(){(yt&6)!==0?rt(Rt,_g):ph()})}function _c(){return Ti===0&&(Ti=Oi()),Ti}function vh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Bi(""+e)}function yh(e,n){var s=n.ownerDocument.createElement("input");return s.name=n.name,s.value=n.value,e.id&&s.setAttribute("form",e.id),n.parentNode.insertBefore(s,n),e=new FormData(e),s.parentNode.removeChild(s),e}function kg(e,n,s,o,c){if(n==="submit"&&s&&s.stateNode===c){var p=vh((c[bn]||null).action),b=o.submitter;b&&(n=(n=b[bn]||null)?vh(n.formAction):b.getAttribute("formAction"),n!==null&&(p=n,b=null));var w=new O("action","action",null,o,c);e.push({event:w,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Ti!==0){var I=b?yh(c,b):new FormData(c);Wu(s,{pending:!0,data:I,method:c.method,action:p},null,I)}}else typeof p=="function"&&(w.preventDefault(),I=b?yh(c,b):new FormData(c),Wu(s,{pending:!0,data:I,method:c.method,action:p},p,I))},currentTarget:c}]})}}for(var Oc=0;Oc<gu.length;Oc++){var kc=gu[Oc],Lg=kc.toLowerCase(),Ug=kc[0].toUpperCase()+kc.slice(1);ha(Lg,"on"+Ug)}ha(Wf,"onAnimationEnd"),ha(Kf,"onAnimationIteration"),ha(Jf,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(Km,"onTransitionRun"),ha(Jm,"onTransitionStart"),ha(eg,"onTransitionCancel"),ha(ed,"onTransitionEnd"),Ga("onMouseEnter",["mouseout","mouseover"]),Ga("onMouseLeave",["mouseout","mouseover"]),Ga("onPointerEnter",["pointerout","pointerover"]),Ga("onPointerLeave",["pointerout","pointerover"]),oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oa("onBeforeInput",["compositionend","keypress","textInput","paste"]),oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ig=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ol));function bh(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var o=e[s],c=o.event;o=o.listeners;e:{var p=void 0;if(n)for(var b=o.length-1;0<=b;b--){var w=o[b],I=w.instance,Q=w.currentTarget;if(w=w.listener,I!==p&&c.isPropagationStopped())break e;p=w,c.currentTarget=Q;try{p(c)}catch(le){mo(le)}c.currentTarget=null,p=I}else for(b=0;b<o.length;b++){if(w=o[b],I=w.instance,Q=w.currentTarget,w=w.listener,I!==p&&c.isPropagationStopped())break e;p=w,c.currentTarget=Q;try{p(c)}catch(le){mo(le)}c.currentTarget=null,p=I}}}}function ut(e,n){var s=n[vr];s===void 0&&(s=n[vr]=new Set);var o=e+"__bubble";s.has(o)||(xh(n,e,2,!1),s.add(o))}function Lc(e,n,s){var o=0;n&&(o|=4),xh(s,e,o,n)}var Ro="_reactListening"+Math.random().toString(36).slice(2);function Uc(e){if(!e[Ro]){e[Ro]=!0,Jr.forEach(function(s){s!=="selectionchange"&&(Ig.has(s)||Lc(s,!1,e),Lc(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Ro]||(n[Ro]=!0,Lc("selectionchange",!1,n))}}function xh(e,n,s,o){switch(Yh(n)){case 2:var c=uv;break;case 8:c=cv;break;default:c=Qc}s=c.bind(null,n,s,e),c=void 0,!_s||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(c=!0),o?c!==void 0?e.addEventListener(n,s,{capture:!0,passive:c}):e.addEventListener(n,s,!0):c!==void 0?e.addEventListener(n,s,{passive:c}):e.addEventListener(n,s,!1)}function Ic(e,n,s,o,c){var p=o;if((n&1)===0&&(n&2)===0&&o!==null)e:for(;;){if(o===null)return;var b=o.tag;if(b===3||b===4){var w=o.stateNode.containerInfo;if(w===c)break;if(b===4)for(b=o.return;b!==null;){var I=b.tag;if((I===3||I===4)&&b.stateNode.containerInfo===c)return;b=b.return}for(;w!==null;){if(b=dn(w),b===null)return;if(I=b.tag,I===5||I===6||I===26||I===27){o=p=b;continue e}w=w.parentNode}}o=o.return}Gl(function(){var Q=p,le=Rs(s),fe=[];e:{var K=td.get(e);if(K!==void 0){var ee=O,Ve=e;switch(e){case"keypress":if(ji(s)===0)break e;case"keydown":case"keyup":ee=Lt;break;case"focusin":Ve="focus",ee=ke;break;case"focusout":Ve="blur",ee=ke;break;case"beforeblur":case"afterblur":ee=ke;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Ee;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Xe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=hn;break;case Wf:case Kf:case Jf:ee=Te;break;case ed:ee=fa;break;case"scroll":case"scrollend":ee=F;break;case"wheel":ee=Pt;break;case"copy":case"cut":case"paste":ee=Ce;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=jt;break;case"toggle":case"beforetoggle":ee=Pi}var Pe=(n&4)!==0,wt=!Pe&&(e==="scroll"||e==="scrollend"),Y=Pe?K!==null?K+"Capture":null:K;Pe=[];for(var P=Q,Z;P!==null;){var oe=P;if(Z=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||Z===null||Y===null||(oe=Xa(P,Y),oe!=null&&Pe.push(ul(P,oe,Z))),wt)break;P=P.return}0<Pe.length&&(K=new ee(K,Ve,null,s,le),fe.push({event:K,listeners:Pe}))}}if((n&7)===0){e:{if(K=e==="mouseover"||e==="pointerover",ee=e==="mouseout"||e==="pointerout",K&&s!==Va&&(Ve=s.relatedTarget||s.fromElement)&&(dn(Ve)||Ve[Ba]))break e;if((ee||K)&&(K=le.window===le?le:(K=le.ownerDocument)?K.defaultView||K.parentWindow:window,ee?(Ve=s.relatedTarget||s.toElement,ee=Q,Ve=Ve?dn(Ve):null,Ve!==null&&(wt=u(Ve),Pe=Ve.tag,Ve!==wt||Pe!==5&&Pe!==27&&Pe!==6)&&(Ve=null)):(ee=null,Ve=Q),ee!==Ve)){if(Pe=Ee,oe="onMouseLeave",Y="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(Pe=jt,oe="onPointerLeave",Y="onPointerEnter",P="pointer"),wt=ee==null?K:ja(ee),Z=Ve==null?K:ja(Ve),K=new Pe(oe,P+"leave",ee,s,le),K.target=wt,K.relatedTarget=Z,oe=null,dn(le)===Q&&(Pe=new Pe(Y,P+"enter",Ve,s,le),Pe.target=Z,Pe.relatedTarget=wt,oe=Pe),wt=oe,ee&&Ve)t:{for(Pe=ee,Y=Ve,P=0,Z=Pe;Z;Z=ds(Z))P++;for(Z=0,oe=Y;oe;oe=ds(oe))Z++;for(;0<P-Z;)Pe=ds(Pe),P--;for(;0<Z-P;)Y=ds(Y),Z--;for(;P--;){if(Pe===Y||Y!==null&&Pe===Y.alternate)break t;Pe=ds(Pe),Y=ds(Y)}Pe=null}else Pe=null;ee!==null&&Sh(fe,K,ee,Pe,!1),Ve!==null&&wt!==null&&Sh(fe,wt,Ve,Pe,!0)}}e:{if(K=Q?ja(Q):window,ee=K.nodeName&&K.nodeName.toLowerCase(),ee==="select"||ee==="input"&&K.type==="file")var Re=Pf;else if(Wn(K))if(Gf)Re=Qm;else{Re=Xm;var it=Vm}else ee=K.nodeName,!ee||ee.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?Q&&yr(Q.elementType)&&(Re=Pf):Re=Zm;if(Re&&(Re=Re(e,Q))){Sn(fe,Re,s,le);break e}it&&it(e,K,Q),e==="focusout"&&Q&&K.type==="number"&&Q.memoizedProps.value!=null&&Ma(K,"number",K.value)}switch(it=Q?ja(Q):window,e){case"focusin":(Wn(it)||it.contentEditable==="true")&&(zi=it,pu=Q,Us=null);break;case"focusout":Us=pu=zi=null;break;case"mousedown":hu=!0;break;case"contextmenu":case"mouseup":case"dragend":hu=!1,Qf(fe,s,le);break;case"selectionchange":if(Wm)break;case"keydown":case"keyup":Qf(fe,s,le)}var Le;if(Wa)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else Mn?$n(e,s)&&(ze="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(ze="onCompositionStart");ze&&(lt&&s.locale!=="ko"&&(Mn||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&Mn&&(Le=zl()):(kt=le,Fi="value"in kt?kt.value:kt.textContent,Mn=!0)),it=Do(Q,ze),0<it.length&&(ze=new Ne(ze,e,null,s,le),fe.push({event:ze,listeners:it}),Le?ze.data=Le:(Le=Gi(s),Le!==null&&(ze.data=Le)))),(Le=Ka?pa(e,s):ci(e,s))&&(ze=Do(Q,"onBeforeInput"),0<ze.length&&(it=new Ne("onBeforeInput","beforeinput",null,s,le),fe.push({event:it,listeners:ze}),it.data=Le)),kg(fe,e,Q,s,le)}bh(fe,n)})}function ul(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Do(e,n){for(var s=n+"Capture",o=[];e!==null;){var c=e,p=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||p===null||(c=Xa(e,s),c!=null&&o.unshift(ul(e,c,p)),c=Xa(e,n),c!=null&&o.push(ul(e,c,p))),e.tag===3)return o;e=e.return}return[]}function ds(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Sh(e,n,s,o,c){for(var p=n._reactName,b=[];s!==null&&s!==o;){var w=s,I=w.alternate,Q=w.stateNode;if(w=w.tag,I!==null&&I===o)break;w!==5&&w!==26&&w!==27||Q===null||(I=Q,c?(Q=Xa(s,p),Q!=null&&b.unshift(ul(s,Q,I))):c||(Q=Xa(s,p),Q!=null&&b.push(ul(s,Q,I)))),s=s.return}b.length!==0&&e.push({event:n,listeners:b})}var Bg=/\r\n?/g,Fg=/\u0000|\uFFFD/g;function Eh(e){return(typeof e=="string"?e:""+e).replace(Bg,`
`).replace(Fg,"")}function wh(e,n){return n=Eh(n),Eh(e)===n}function _o(){}function Et(e,n,s,o,c,p){switch(s){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||Qn(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&Qn(e,""+o);break;case"className":ti(e,"class",o);break;case"tabIndex":ti(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":ti(e,s,o);break;case"style":si(e,o,p);break;case"data":if(n!=="object"){ti(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||s!=="href")){e.removeAttribute(s);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(s);break}o=Bi(""+o),e.setAttribute(s,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(s==="formAction"?(n!=="input"&&Et(e,n,"name",c.name,c,null),Et(e,n,"formEncType",c.formEncType,c,null),Et(e,n,"formMethod",c.formMethod,c,null),Et(e,n,"formTarget",c.formTarget,c,null)):(Et(e,n,"encType",c.encType,c,null),Et(e,n,"method",c.method,c,null),Et(e,n,"target",c.target,c,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(s);break}o=Bi(""+o),e.setAttribute(s,o);break;case"onClick":o!=null&&(e.onclick=_o);break;case"onScroll":o!=null&&ut("scroll",e);break;case"onScrollEnd":o!=null&&ut("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(s=o.__html,s!=null){if(c.children!=null)throw Error(i(60));e.innerHTML=s}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}s=Bi(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(s,""+o):e.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(s,""):e.removeAttribute(s);break;case"capture":case"download":o===!0?e.setAttribute(s,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(s,o):e.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(s,o):e.removeAttribute(s);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(s):e.setAttribute(s,o);break;case"popover":ut("beforetoggle",e),ut("toggle",e),Zn(e,"popover",o);break;case"xlinkActuate":ln(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":ln(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":ln(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":ln(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":ln(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":ln(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":ln(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":ln(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":ln(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Zn(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=Ii.get(s)||s,Zn(e,s,o))}}function Bc(e,n,s,o,c,p){switch(s){case"style":si(e,o,p);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(s=o.__html,s!=null){if(c.children!=null)throw Error(i(60));e.innerHTML=s}}break;case"children":typeof o=="string"?Qn(e,o):(typeof o=="number"||typeof o=="bigint")&&Qn(e,""+o);break;case"onScroll":o!=null&&ut("scroll",e);break;case"onScrollEnd":o!=null&&ut("scrollend",e);break;case"onClick":o!=null&&(e.onclick=_o);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ts.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(c=s.endsWith("Capture"),n=s.slice(2,c?s.length-7:void 0),p=e[bn]||null,p=p!=null?p[s]:null,typeof p=="function"&&e.removeEventListener(n,p,c),typeof o=="function")){typeof p!="function"&&p!==null&&(s in e?e[s]=null:e.hasAttribute(s)&&e.removeAttribute(s)),e.addEventListener(n,o,c);break e}s in e?e[s]=o:o===!0?e.setAttribute(s,""):Zn(e,s,o)}}}function fn(e,n,s){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ut("error",e),ut("load",e);var o=!1,c=!1,p;for(p in s)if(s.hasOwnProperty(p)){var b=s[p];if(b!=null)switch(p){case"src":o=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:Et(e,n,p,b,s,null)}}c&&Et(e,n,"srcSet",s.srcSet,s,null),o&&Et(e,n,"src",s.src,s,null);return;case"input":ut("invalid",e);var w=p=b=c=null,I=null,Q=null;for(o in s)if(s.hasOwnProperty(o)){var le=s[o];if(le!=null)switch(o){case"name":c=le;break;case"type":b=le;break;case"checked":I=le;break;case"defaultChecked":Q=le;break;case"value":p=le;break;case"defaultValue":w=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,n));break;default:Et(e,n,o,le,s,null)}}Ns(e,p,w,I,Q,b,c,!1),ua(e);return;case"select":ut("invalid",e),o=b=p=null;for(c in s)if(s.hasOwnProperty(c)&&(w=s[c],w!=null))switch(c){case"value":p=w;break;case"defaultValue":b=w;break;case"multiple":o=w;default:Et(e,n,c,w,s,null)}n=p,s=b,e.multiple=!!o,n!=null?qa(e,!!o,n,!1):s!=null&&qa(e,!!o,s,!0);return;case"textarea":ut("invalid",e),p=c=o=null;for(b in s)if(s.hasOwnProperty(b)&&(w=s[b],w!=null))switch(b){case"value":o=w;break;case"defaultValue":c=w;break;case"children":p=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:Et(e,n,b,w,s,null)}jl(e,o,c,p),ua(e);return;case"option":for(I in s)s.hasOwnProperty(I)&&(o=s[I],o!=null)&&(I==="selected"?e.selected=o&&typeof o!="function"&&typeof o!="symbol":Et(e,n,I,o,s,null));return;case"dialog":ut("beforetoggle",e),ut("toggle",e),ut("cancel",e),ut("close",e);break;case"iframe":case"object":ut("load",e);break;case"video":case"audio":for(o=0;o<ol.length;o++)ut(ol[o],e);break;case"image":ut("error",e),ut("load",e);break;case"details":ut("toggle",e);break;case"embed":case"source":case"link":ut("error",e),ut("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in s)if(s.hasOwnProperty(Q)&&(o=s[Q],o!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:Et(e,n,Q,o,s,null)}return;default:if(yr(n)){for(le in s)s.hasOwnProperty(le)&&(o=s[le],o!==void 0&&Bc(e,n,le,o,s,void 0));return}}for(w in s)s.hasOwnProperty(w)&&(o=s[w],o!=null&&Et(e,n,w,o,s,null))}function jg(e,n,s,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,p=null,b=null,w=null,I=null,Q=null,le=null;for(ee in s){var fe=s[ee];if(s.hasOwnProperty(ee)&&fe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":I=fe;default:o.hasOwnProperty(ee)||Et(e,n,ee,null,o,fe)}}for(var K in o){var ee=o[K];if(fe=s[K],o.hasOwnProperty(K)&&(ee!=null||fe!=null))switch(K){case"type":p=ee;break;case"name":c=ee;break;case"checked":Q=ee;break;case"defaultChecked":le=ee;break;case"value":b=ee;break;case"defaultValue":w=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,n));break;default:ee!==fe&&Et(e,n,K,ee,o,fe)}}Ft(e,b,w,I,Q,le,p,c);return;case"select":ee=b=w=K=null;for(p in s)if(I=s[p],s.hasOwnProperty(p)&&I!=null)switch(p){case"value":break;case"multiple":ee=I;default:o.hasOwnProperty(p)||Et(e,n,p,null,o,I)}for(c in o)if(p=o[c],I=s[c],o.hasOwnProperty(c)&&(p!=null||I!=null))switch(c){case"value":K=p;break;case"defaultValue":w=p;break;case"multiple":b=p;default:p!==I&&Et(e,n,c,p,o,I)}n=w,s=b,o=ee,K!=null?qa(e,!!s,K,!1):!!o!=!!s&&(n!=null?qa(e,!!s,n,!0):qa(e,!!s,s?[]:"",!1));return;case"textarea":ee=K=null;for(w in s)if(c=s[w],s.hasOwnProperty(w)&&c!=null&&!o.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:Et(e,n,w,null,o,c)}for(b in o)if(c=o[b],p=s[b],o.hasOwnProperty(b)&&(c!=null||p!=null))switch(b){case"value":K=c;break;case"defaultValue":ee=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(i(91));break;default:c!==p&&Et(e,n,b,c,o,p)}Fl(e,K,ee);return;case"option":for(var Ve in s)K=s[Ve],s.hasOwnProperty(Ve)&&K!=null&&!o.hasOwnProperty(Ve)&&(Ve==="selected"?e.selected=!1:Et(e,n,Ve,null,o,K));for(I in o)K=o[I],ee=s[I],o.hasOwnProperty(I)&&K!==ee&&(K!=null||ee!=null)&&(I==="selected"?e.selected=K&&typeof K!="function"&&typeof K!="symbol":Et(e,n,I,K,o,ee));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in s)K=s[Pe],s.hasOwnProperty(Pe)&&K!=null&&!o.hasOwnProperty(Pe)&&Et(e,n,Pe,null,o,K);for(Q in o)if(K=o[Q],ee=s[Q],o.hasOwnProperty(Q)&&K!==ee&&(K!=null||ee!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(i(137,n));break;default:Et(e,n,Q,K,o,ee)}return;default:if(yr(n)){for(var wt in s)K=s[wt],s.hasOwnProperty(wt)&&K!==void 0&&!o.hasOwnProperty(wt)&&Bc(e,n,wt,void 0,o,K);for(le in o)K=o[le],ee=s[le],!o.hasOwnProperty(le)||K===ee||K===void 0&&ee===void 0||Bc(e,n,le,K,o,ee);return}}for(var Y in s)K=s[Y],s.hasOwnProperty(Y)&&K!=null&&!o.hasOwnProperty(Y)&&Et(e,n,Y,null,o,K);for(fe in o)K=o[fe],ee=s[fe],!o.hasOwnProperty(fe)||K===ee||K==null&&ee==null||Et(e,n,fe,K,o,ee)}var Fc=null,jc=null;function Oo(e){return e.nodeType===9?e:e.ownerDocument}function Ah(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Th(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Pc(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Gc=null;function Pg(){var e=window.event;return e&&e.type==="popstate"?e===Gc?!1:(Gc=e,!0):(Gc=null,!1)}var Ch=typeof setTimeout=="function"?setTimeout:void 0,Gg=typeof clearTimeout=="function"?clearTimeout:void 0,Mh=typeof Promise=="function"?Promise:void 0,zg=typeof queueMicrotask=="function"?queueMicrotask:typeof Mh<"u"?function(e){return Mh.resolve(null).then(e).catch(Hg)}:Ch;function Hg(e){setTimeout(function(){throw e})}function jr(e){return e==="head"}function Nh(e,n){var s=n,o=0,c=0;do{var p=s.nextSibling;if(e.removeChild(s),p&&p.nodeType===8)if(s=p.data,s==="/$"){if(0<o&&8>o){s=o;var b=e.ownerDocument;if(s&1&&cl(b.documentElement),s&2&&cl(b.body),s&4)for(s=b.head,cl(s),b=s.firstChild;b;){var w=b.nextSibling,I=b.nodeName;b[dt]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&b.rel.toLowerCase()==="stylesheet"||s.removeChild(b),b=w}}if(c===0){e.removeChild(p),yl(n);return}c--}else s==="$"||s==="$?"||s==="$!"?c++:o=s.charCodeAt(0)-48;else o=0;s=p}while(s);yl(n)}function zc(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var s=n;switch(n=n.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":zc(s),Xn(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}e.removeChild(s)}}function Yg(e,n,s,o){for(;e.nodeType===1;){var c=s;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[dt])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=ga(e.nextSibling),e===null)break}return null}function qg(e,n,s){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=ga(e.nextSibling),e===null))return null;return e}function Hc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Vg(e,n){var s=e.ownerDocument;if(e.data!=="$?"||s.readyState==="complete")n();else{var o=function(){n(),s.removeEventListener("DOMContentLoaded",o)};s.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function ga(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return e}var Yc=null;function Rh(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}function Dh(e,n,s){switch(n=Oo(s),e){case"html":if(e=n.documentElement,!e)throw Error(i(452));return e;case"head":if(e=n.head,!e)throw Error(i(453));return e;case"body":if(e=n.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function cl(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Xn(e)}var ra=new Map,_h=new Set;function ko(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var fr=G.d;G.d={f:Xg,r:Zg,D:Qg,C:$g,L:Wg,m:Kg,X:ev,S:Jg,M:tv};function Xg(){var e=fr.f(),n=Ao();return e||n}function Zg(e){var n=Ta(e);n!==null&&n.tag===5&&n.type==="form"?Wd(n):fr.r(e)}var ps=typeof document>"u"?null:document;function Oh(e,n,s){var o=ps;if(o&&typeof n=="string"&&n){var c=xn(n);c='link[rel="'+e+'"][href="'+c+'"]',typeof s=="string"&&(c+='[crossorigin="'+s+'"]'),_h.has(c)||(_h.add(c),e={rel:e,crossOrigin:s,href:n},o.querySelector(c)===null&&(n=o.createElement("link"),fn(n,"link",e),Dt(n),o.head.appendChild(n)))}}function Qg(e){fr.D(e),Oh("dns-prefetch",e,null)}function $g(e,n){fr.C(e,n),Oh("preconnect",e,n)}function Wg(e,n,s){fr.L(e,n,s);var o=ps;if(o&&e&&n){var c='link[rel="preload"][as="'+xn(n)+'"]';n==="image"&&s&&s.imageSrcSet?(c+='[imagesrcset="'+xn(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(c+='[imagesizes="'+xn(s.imageSizes)+'"]')):c+='[href="'+xn(e)+'"]';var p=c;switch(n){case"style":p=hs(e);break;case"script":p=ms(e)}ra.has(p)||(e=v({rel:"preload",href:n==="image"&&s&&s.imageSrcSet?void 0:e,as:n},s),ra.set(p,e),o.querySelector(c)!==null||n==="style"&&o.querySelector(fl(p))||n==="script"&&o.querySelector(dl(p))||(n=o.createElement("link"),fn(n,"link",e),Dt(n),o.head.appendChild(n)))}}function Kg(e,n){fr.m(e,n);var s=ps;if(s&&e){var o=n&&typeof n.as=="string"?n.as:"script",c='link[rel="modulepreload"][as="'+xn(o)+'"][href="'+xn(e)+'"]',p=c;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ms(e)}if(!ra.has(p)&&(e=v({rel:"modulepreload",href:e},n),ra.set(p,e),s.querySelector(c)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(dl(p)))return}o=s.createElement("link"),fn(o,"link",e),Dt(o),s.head.appendChild(o)}}}function Jg(e,n,s){fr.S(e,n,s);var o=ps;if(o&&e){var c=Pa(o).hoistableStyles,p=hs(e);n=n||"default";var b=c.get(p);if(!b){var w={loading:0,preload:null};if(b=o.querySelector(fl(p)))w.loading=5;else{e=v({rel:"stylesheet",href:e,"data-precedence":n},s),(s=ra.get(p))&&qc(e,s);var I=b=o.createElement("link");Dt(I),fn(I,"link",e),I._p=new Promise(function(Q,le){I.onload=Q,I.onerror=le}),I.addEventListener("load",function(){w.loading|=1}),I.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Lo(b,n,o)}b={type:"stylesheet",instance:b,count:1,state:w},c.set(p,b)}}}function ev(e,n){fr.X(e,n);var s=ps;if(s&&e){var o=Pa(s).hoistableScripts,c=ms(e),p=o.get(c);p||(p=s.querySelector(dl(c)),p||(e=v({src:e,async:!0},n),(n=ra.get(c))&&Vc(e,n),p=s.createElement("script"),Dt(p),fn(p,"link",e),s.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(c,p))}}function tv(e,n){fr.M(e,n);var s=ps;if(s&&e){var o=Pa(s).hoistableScripts,c=ms(e),p=o.get(c);p||(p=s.querySelector(dl(c)),p||(e=v({src:e,async:!0,type:"module"},n),(n=ra.get(c))&&Vc(e,n),p=s.createElement("script"),Dt(p),fn(p,"link",e),s.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(c,p))}}function kh(e,n,s,o){var c=(c=xe.current)?ko(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(n=hs(s.href),s=Pa(c).hoistableStyles,o=s.get(n),o||(o={type:"style",instance:null,count:0,state:null},s.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){e=hs(s.href);var p=Pa(c).hoistableStyles,b=p.get(e);if(b||(c=c.ownerDocument||c,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,b),(p=c.querySelector(fl(e)))&&!p._p&&(b.instance=p,b.state.loading=5),ra.has(e)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},ra.set(e,s),p||nv(c,e,s,b.state))),n&&o===null)throw Error(i(528,""));return b}if(n&&o!==null)throw Error(i(529,""));return null;case"script":return n=s.async,s=s.src,typeof s=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ms(s),s=Pa(c).hoistableScripts,o=s.get(n),o||(o={type:"script",instance:null,count:0,state:null},s.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function hs(e){return'href="'+xn(e)+'"'}function fl(e){return'link[rel="stylesheet"]['+e+"]"}function Lh(e){return v({},e,{"data-precedence":e.precedence,precedence:null})}function nv(e,n,s,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),fn(n,"link",s),Dt(n),e.head.appendChild(n))}function ms(e){return'[src="'+xn(e)+'"]'}function dl(e){return"script[async]"+e}function Uh(e,n,s){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+xn(s.href)+'"]');if(o)return n.instance=o,Dt(o),o;var c=v({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),Dt(o),fn(o,"style",c),Lo(o,s.precedence,e),n.instance=o;case"stylesheet":c=hs(s.href);var p=e.querySelector(fl(c));if(p)return n.state.loading|=4,n.instance=p,Dt(p),p;o=Lh(s),(c=ra.get(c))&&qc(o,c),p=(e.ownerDocument||e).createElement("link"),Dt(p);var b=p;return b._p=new Promise(function(w,I){b.onload=w,b.onerror=I}),fn(p,"link",o),n.state.loading|=4,Lo(p,s.precedence,e),n.instance=p;case"script":return p=ms(s.src),(c=e.querySelector(dl(p)))?(n.instance=c,Dt(c),c):(o=s,(c=ra.get(p))&&(o=v({},s),Vc(o,c)),e=e.ownerDocument||e,c=e.createElement("script"),Dt(c),fn(c,"link",o),e.head.appendChild(c),n.instance=c);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,Lo(o,s.precedence,e));return n.instance}function Lo(e,n,s){for(var o=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=o.length?o[o.length-1]:null,p=c,b=0;b<o.length;b++){var w=o[b];if(w.dataset.precedence===n)p=w;else if(p!==c)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=s.nodeType===9?s.head:s,n.insertBefore(e,n.firstChild))}function qc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Vc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Uo=null;function Ih(e,n,s){if(Uo===null){var o=new Map,c=Uo=new Map;c.set(s,o)}else c=Uo,o=c.get(s),o||(o=new Map,c.set(s,o));if(o.has(e))return o;for(o.set(e,null),s=s.getElementsByTagName(e),c=0;c<s.length;c++){var p=s[c];if(!(p[dt]||p[sn]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(n)||"";b=e+b;var w=o.get(b);w?w.push(p):o.set(b,[p])}}return o}function Bh(e,n,s){e=e.ownerDocument||e,e.head.insertBefore(s,n==="title"?e.querySelector("head > title"):null)}function av(e,n,s){if(s===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Fh(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var pl=null;function rv(){}function iv(e,n,s){if(pl===null)throw Error(i(475));var o=pl;if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=hs(s.href),p=e.querySelector(fl(c));if(p){e=p._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(o.count++,o=Io.bind(o),e.then(o,o)),n.state.loading|=4,n.instance=p,Dt(p);return}p=e.ownerDocument||e,s=Lh(s),(c=ra.get(c))&&qc(s,c),p=p.createElement("link"),Dt(p);var b=p;b._p=new Promise(function(w,I){b.onload=w,b.onerror=I}),fn(p,"link",s),n.instance=p}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(n,e),(e=n.state.preload)&&(n.state.loading&3)===0&&(o.count++,n=Io.bind(o),e.addEventListener("load",n),e.addEventListener("error",n))}}function sv(){if(pl===null)throw Error(i(475));var e=pl;return e.stylesheets&&e.count===0&&Xc(e,e.stylesheets),0<e.count?function(n){var s=setTimeout(function(){if(e.stylesheets&&Xc(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(s)}}:null}function Io(){if(this.count--,this.count===0){if(this.stylesheets)Xc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Bo=null;function Xc(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Bo=new Map,n.forEach(lv,e),Bo=null,Io.call(e))}function lv(e,n){if(!(n.state.loading&4)){var s=Bo.get(e);if(s)var o=s.get(null);else{s=new Map,Bo.set(e,s);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<c.length;p++){var b=c[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(s.set(b.dataset.precedence,b),o=b)}o&&s.set(null,o)}c=n.instance,b=c.getAttribute("data-precedence"),p=s.get(b)||o,p===o&&s.set(null,c),s.set(b,c),this.count++,o=Io.bind(this),c.addEventListener("load",o),c.addEventListener("error",o),p?p.parentNode.insertBefore(c,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),n.state.loading|=4}}var hl={$$typeof:M,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function ov(e,n,s,o,c,p,b,w){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=wa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wa(0),this.hiddenUpdates=wa(null),this.identifierPrefix=o,this.onUncaughtError=c,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function jh(e,n,s,o,c,p,b,w,I,Q,le,fe){return e=new ov(e,n,s,b,w,I,Q,fe),n=1,p===!0&&(n|=24),p=In(3,null,null,n),e.current=p,p.stateNode=e,n=Nu(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:o,isDehydrated:s,cache:n},Ou(p),e}function Ph(e){return e?(e=Vi,e):Vi}function Gh(e,n,s,o,c,p){c=Ph(c),o.context===null?o.context=c:o.pendingContext=c,o=Cr(n),o.payload={element:s},p=p===void 0?null:p,p!==null&&(o.callback=p),s=Mr(e,o,n),s!==null&&(Gn(s,e,n),Ys(s,e,n))}function zh(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function Zc(e,n){zh(e,n),(e=e.alternate)&&zh(e,n)}function Hh(e){if(e.tag===13){var n=qi(e,67108864);n!==null&&Gn(n,e,67108864),Zc(e,67108864)}}var Fo=!0;function uv(e,n,s,o){var c=U.T;U.T=null;var p=G.p;try{G.p=2,Qc(e,n,s,o)}finally{G.p=p,U.T=c}}function cv(e,n,s,o){var c=U.T;U.T=null;var p=G.p;try{G.p=8,Qc(e,n,s,o)}finally{G.p=p,U.T=c}}function Qc(e,n,s,o){if(Fo){var c=$c(o);if(c===null)Ic(e,n,o,jo,s),qh(e,o);else if(dv(c,e,n,s,o))o.stopPropagation();else if(qh(e,o),n&4&&-1<fv.indexOf(e)){for(;c!==null;){var p=Ta(c);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=On(p.pendingLanes);if(b!==0){var w=p;for(w.pendingLanes|=2,w.entangledLanes|=2;b;){var I=1<<31-Ht(b);w.entanglements[1]|=I,b&=~I}ka(p),(yt&6)===0&&(Eo=Fe()+500,ll(0))}}break;case 13:w=qi(p,2),w!==null&&Gn(w,p,2),Ao(),Zc(p,2)}if(p=$c(o),p===null&&Ic(e,n,o,jo,s),p===c)break;c=p}c!==null&&o.stopPropagation()}else Ic(e,n,o,null,s)}}function $c(e){return e=Rs(e),Wc(e)}var jo=null;function Wc(e){if(jo=null,e=dn(e),e!==null){var n=u(e);if(n===null)e=null;else{var s=n.tag;if(s===13){if(e=f(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return jo=e,null}function Yh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xt()){case Rt:return 2;case Je:return 8;case Ue:case vn:return 32;case Yn:return 268435456;default:return 32}default:return 32}}var Kc=!1,Pr=null,Gr=null,zr=null,ml=new Map,gl=new Map,Hr=[],fv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function qh(e,n){switch(e){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":zr=null;break;case"pointerover":case"pointerout":ml.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(n.pointerId)}}function vl(e,n,s,o,c,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:s,eventSystemFlags:o,nativeEvent:p,targetContainers:[c]},n!==null&&(n=Ta(n),n!==null&&Hh(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,c!==null&&n.indexOf(c)===-1&&n.push(c),e)}function dv(e,n,s,o,c){switch(n){case"focusin":return Pr=vl(Pr,e,n,s,o,c),!0;case"dragenter":return Gr=vl(Gr,e,n,s,o,c),!0;case"mouseover":return zr=vl(zr,e,n,s,o,c),!0;case"pointerover":var p=c.pointerId;return ml.set(p,vl(ml.get(p)||null,e,n,s,o,c)),!0;case"gotpointercapture":return p=c.pointerId,gl.set(p,vl(gl.get(p)||null,e,n,s,o,c)),!0}return!1}function Vh(e){var n=dn(e.target);if(n!==null){var s=u(n);if(s!==null){if(n=s.tag,n===13){if(n=f(s),n!==null){e.blockedOn=n,la(e.priority,function(){if(s.tag===13){var o=Pn();o=ws(o);var c=qi(s,o);c!==null&&Gn(c,s,o),Zc(s,o)}});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Po(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=$c(e.nativeEvent);if(s===null){s=e.nativeEvent;var o=new s.constructor(s.type,s);Va=o,s.target.dispatchEvent(o),Va=null}else return n=Ta(s),n!==null&&Hh(n),e.blockedOn=s,!1;n.shift()}return!0}function Xh(e,n,s){Po(e)&&s.delete(n)}function pv(){Kc=!1,Pr!==null&&Po(Pr)&&(Pr=null),Gr!==null&&Po(Gr)&&(Gr=null),zr!==null&&Po(zr)&&(zr=null),ml.forEach(Xh),gl.forEach(Xh)}function Go(e,n){e.blockedOn===n&&(e.blockedOn=null,Kc||(Kc=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,pv)))}var zo=null;function Zh(e){zo!==e&&(zo=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){zo===e&&(zo=null);for(var n=0;n<e.length;n+=3){var s=e[n],o=e[n+1],c=e[n+2];if(typeof o!="function"){if(Wc(o||s)===null)continue;break}var p=Ta(s);p!==null&&(e.splice(n,3),n-=3,Wu(p,{pending:!0,data:c,method:s.method,action:o},o,c))}}))}function yl(e){function n(I){return Go(I,e)}Pr!==null&&Go(Pr,e),Gr!==null&&Go(Gr,e),zr!==null&&Go(zr,e),ml.forEach(n),gl.forEach(n);for(var s=0;s<Hr.length;s++){var o=Hr[s];o.blockedOn===e&&(o.blockedOn=null)}for(;0<Hr.length&&(s=Hr[0],s.blockedOn===null);)Vh(s),s.blockedOn===null&&Hr.shift();if(s=(e.ownerDocument||e).$$reactFormReplay,s!=null)for(o=0;o<s.length;o+=3){var c=s[o],p=s[o+1],b=c[bn]||null;if(typeof p=="function")b||Zh(s);else if(b){var w=null;if(p&&p.hasAttribute("formAction")){if(c=p,b=p[bn]||null)w=b.formAction;else if(Wc(c)!==null)continue}else w=b.action;typeof w=="function"?s[o+1]=w:(s.splice(o,3),o-=3),Zh(s)}}}function Jc(e){this._internalRoot=e}Ho.prototype.render=Jc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(i(409));var s=n.current,o=Pn();Gh(s,o,e,n,null,null)},Ho.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Gh(e.current,2,null,e,null,null),Ao(),n[Ba]=null}};function Ho(e){this._internalRoot=e}Ho.prototype.unstable_scheduleHydration=function(e){if(e){var n=Yt();e={blockedOn:null,target:e,priority:n};for(var s=0;s<Hr.length&&n!==0&&n<Hr[s].priority;s++);Hr.splice(s,0,e),s===0&&Vh(e)}};var Qh=t.version;if(Qh!=="19.1.1")throw Error(i(527,Qh,"19.1.1"));G.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=d(n),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var hv={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yo.isDisabled&&Yo.supportsFiber)try{Ea=Yo.inject(hv),an=Yo}catch{}}return xl.createRoot=function(e,n){if(!l(e))throw Error(i(299));var s=!1,o="",c=fp,p=dp,b=pp,w=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(b=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(w=n.unstable_transitionCallbacks)),n=jh(e,1,!1,null,null,s,o,c,p,b,w,null),e[Ba]=n.current,Uc(e),new Jc(n)},xl.hydrateRoot=function(e,n,s){if(!l(e))throw Error(i(299));var o=!1,c="",p=fp,b=dp,w=pp,I=null,Q=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(I=s.unstable_transitionCallbacks),s.formState!==void 0&&(Q=s.formState)),n=jh(e,1,!0,n,s??null,o,c,p,b,w,I,Q),n.context=Ph(null),s=n.current,o=Pn(),o=ws(o),c=Cr(o),c.callback=null,Mr(s,c,o),s=o,n.current.lanes=s,Vn(n,s),ka(n),e[Ba]=n.current,Uc(e),new Ho(n)},xl.version="19.1.1",xl}var i0;function wv(){if(i0)return nf.exports;i0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),nf.exports=Ev(),nf.exports}var Av=wv();const Tv=Nf(Av),Cv="modulepreload",Mv=function(a,t){return new URL(a,t).href},s0={},l0=function(t,r,i){let l=Promise.resolve();if(r&&r.length>0){let g=function(v){return Promise.all(v.map(E=>Promise.resolve(E).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),d=h?.nonce||h?.getAttribute("nonce");l=g(r.map(v=>{if(v=Mv(v,i),v in s0)return;s0[v]=!0;const E=v.endsWith(".css"),y=E?'[rel="stylesheet"]':"";if(i)for(let S=f.length-1;S>=0;S--){const A=f[S];if(A.href===v&&(!E||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${y}`))return;const x=document.createElement("link");if(x.rel=E?"stylesheet":Cv,E||(x.as="script"),x.crossOrigin="",x.href=v,d&&x.setAttribute("nonce",d),document.head.appendChild(x),E)return new Promise((S,A)=>{x.addEventListener("load",S),x.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${v}`)))})}))}function u(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return l.then(f=>{for(const h of f||[])h.status==="rejected"&&u(h.reason);return t().catch(u)})};class va{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,r,i={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==va.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof r!="function")throw new TypeError("The callback must be a function.");const l=new o0(t,this,r,i);return this.eventMap[t]||(this.eventMap[t]=[]),i.prepend?this.eventMap[t].unshift(l):this.eventMap[t].push(l),l}addOneTimeListener(t,r,i={}){i.remaining=1,this.addListener(t,r,i)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,r){return t===void 0?this.eventMap[va.ANY_EVENT]&&this.eventMap[va.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,i])=>i.length>0):this.eventMap[t]&&this.eventMap[t].length>0?r instanceof o0?this.eventMap[t].filter(l=>l===r).length>0:typeof r=="function"?this.eventMap[t].filter(l=>l.callback===r).length>0:r==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(r=>{r.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(r=>{r.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...r){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let i=[],l=this.eventMap[va.ANY_EVENT]||[];return this.eventMap[t]&&(l=l.concat(this.eventMap[t])),l.forEach(u=>{if(u.suspended)return;let f=[...r];Array.isArray(u.arguments)&&(f=f.concat(u.arguments)),u.remaining>0&&(i.push(u.callback.apply(u.context,f)),u.count++),--u.remaining<1&&u.remove()}),i}removeListener(t,r,i={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let l=this.eventMap[t].filter(u=>r&&u.callback!==r||i.remaining&&i.remaining!==u.remaining||i.context&&i.context!==u.context);l.length?this.eventMap[t]=l:delete this.eventMap[t]}async waitFor(t,r={}){return r.duration=parseInt(r.duration),(isNaN(r.duration)||r.duration<=0)&&(r.duration=1/0),new Promise((i,l)=>{let u,f=this.addListener(t,()=>{clearTimeout(u),i()},{remaining:1});r.duration!==1/0&&(u=setTimeout(()=>{f.remove(),l("The duration expired before the event was emitted.")},r.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class o0{constructor(t,r,i,l={}){if(typeof t!="string"&&!(t instanceof String)&&t!==va.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!r)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof i!="function")throw new TypeError("The 'callback' must be a function.");l.arguments!==void 0&&!Array.isArray(l.arguments)&&(l.arguments=[l.arguments]),l=Object.assign({context:r,remaining:1/0,arguments:void 0,duration:1/0},l),l.duration!==1/0&&setTimeout(()=>this.remove(),l.duration),this.arguments=l.arguments,this.callback=i,this.context=l.context,this.count=0,this.event=t,this.remaining=parseInt(l.remaining)>=1?parseInt(l.remaining):1/0,this.suspended=!1,this.target=r}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}class ue{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),ue.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),ue.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),ue.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),ue.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}class vs{constructor(t,r={}){this.duration=be.defaults.note.duration,this.attack=be.defaults.note.attack,this.release=be.defaults.note.release,r.duration!=null&&(this.duration=r.duration),r.attack!=null&&(this.attack=r.attack),r.rawAttack!=null&&(this.attack=Se.from7bitToFloat(r.rawAttack)),r.release!=null&&(this.release=r.release),r.rawRelease!=null&&(this.release=Se.from7bitToFloat(r.rawRelease)),Number.isInteger(t)?this.identifier=Se.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const r=Se.getNoteDetails(t);if(be.validation&&!t)throw new Error("Invalid note identifier");this._name=r.name,this._accidental=r.accidental,this._octave=r.octave}get name(){return this._name}set name(t){if(be.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(be.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(be.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(be.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(be.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(be.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return Se.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=Se.from7bitToFloat(t)}get rawRelease(){return Se.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=Se.from7bitToFloat(t)}get number(){return Se.toNoteNumber(this.identifier)}getOffsetNumber(t=0,r=0){return be.validation&&(t=parseInt(t)||0,r=parseInt(r)||0),Math.min(Math.max(this.number+t*12+r,0),127)}}class Se{static toNoteNumber(t,r=0){if(r=r==null?0:parseInt(r),isNaN(r))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const i=this.getNoteDetails(t);if(!i)throw new TypeError("Invalid note identifier");const l={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let u=(i.octave+1+r)*12;if(u+=l[i.name],i.accidental&&(i.accidental.startsWith("b")?u-=i.accidental.length:u+=i.accidental.length),u<0||u>127)throw new RangeError("Invalid octaveOffset value");return u}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const r=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!r)throw new TypeError("Invalid note identifier");const i=r[1].toUpperCase(),l=parseInt(r[3]);let u=r[2].toLowerCase();return u=u===""?void 0:u,{accidental:u,identifier:i+(u||"")+l,name:i,octave:l}}static sanitizeChannels(t){let r;if(be.validation){if(t==="all")r=["all"];else if(t==="none")return[]}return Array.isArray(t)?r=t:r=[t],r.indexOf("all")>-1&&(r=ue.MIDI_CHANNEL_NUMBERS),r.map(function(i){return parseInt(i)}).filter(function(i){return i>=1&&i<=16})}static toTimestamp(t){let r=!1;const i=parseFloat(t);return isNaN(i)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?i>=0&&(r=be.time+i):i>=0&&(r=i),r)}static guessNoteNumber(t,r){r=parseInt(r)||0;let i=!1;if(Number.isInteger(t)&&t>=0&&t<=127)i=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)i=parseInt(t);else if(typeof t=="string"||t instanceof String)try{i=this.toNoteNumber(t.trim(),r)}catch{return!1}return i}static toNoteIdentifier(t,r){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(r=r==null?0:parseInt(r),isNaN(r))throw new RangeError("Invalid octaveOffset value");const i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],l=Math.floor(t/12-1)+r;return i[t%12]+l.toString()}static buildNote(t,r={}){if(r.octaveOffset=parseInt(r.octaveOffset)||0,t instanceof vs)return t;let i=this.guessNoteNumber(t,r.octaveOffset);if(i===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return r.octaveOffset=void 0,new vs(i,r)}static buildNoteArray(t,r={}){let i=[];return Array.isArray(t)||(t=[t]),t.forEach(l=>{i.push(this.buildNote(l,r))}),i}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,r=0){be.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),r=Math.min(Math.max(parseInt(r)||0,0),127));const i=((t<<7)+r)/16383;return Math.min(Math.max(i,0),1)}static fromFloatToMsbLsb(t){be.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const r=Math.round(t*16383);return{msb:r>>7,lsb:r&127}}static offsetNumber(t,r=0,i=0){if(be.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");r=parseInt(r)||0,i=parseInt(i)||0}return Math.min(Math.max(t+r*12+i,0),127)}static getPropertyByValue(t,r){return Object.keys(t).find(i=>t[i]===r)}static getCcNameByNumber(t){if(!(be.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return ue.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let r=ue.CONTROL_CHANGE_MESSAGES.find(i=>i.name===t);return r?r.number:ue.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let r in ue.CHANNEL_MODE_MESSAGES)if(ue.CHANNEL_MODE_MESSAGES.hasOwnProperty(r)&&t===ue.CHANNEL_MODE_MESSAGES[r])return r;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}class Nv extends va{constructor(t,r){super(),this._output=t,this._number=r,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,r={time:0}){return this.output.send(t,r),this}sendKeyAftertouch(t,r,i={}){if(be.validation){if(i.useRawValue&&(i.rawValue=i.useRawValue),isNaN(parseFloat(r)))throw new RangeError("Invalid key aftertouch value.");if(i.rawValue){if(!(r>=0&&r<=127&&Number.isInteger(r)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(r>=0&&r<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}i.rawValue||(r=Se.fromFloatTo7Bit(r));const l=be.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),Se.buildNoteArray(t).forEach(u=>{this.send([(ue.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),u.getOffsetNumber(l),r],{time:Se.toTimestamp(i.time)})}),this}sendControlChange(t,r,i={}){if(typeof t=="string"&&(t=Se.getCcNumberByName(t)),Array.isArray(r)||(r=[r]),be.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(r=r.map(l=>{const u=Math.min(Math.max(parseInt(l),0),127);if(isNaN(u))throw new TypeError("Values must be integers between 0 and 127");return u}),r.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return r.forEach((l,u)=>{this.send([(ue.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+u*32,r[u]],{time:Se.toTimestamp(i.time)})}),this}_selectNonRegisteredParameter(t,r={}){return this.sendControlChange(99,t[0],r),this.sendControlChange(98,t[1],r),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,r={}){return this.sendControlChange(101,t[0],r),this.sendControlChange(100,t[1],r),this}_setCurrentParameter(t,r={}){return t=[].concat(t),this.sendControlChange(6,t[0],r),t.length<2?this:(this.sendControlChange(38,t[1],r),this)}sendRpnDecrement(t,r={}){if(Array.isArray(t)||(t=ue.REGISTERED_PARAMETERS[t]),be.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let i=!1;if(Object.getOwnPropertyNames(ue.REGISTERED_PARAMETERS).forEach(l=>{ue.REGISTERED_PARAMETERS[l][0]===t[0]&&ue.REGISTERED_PARAMETERS[l][1]===t[1]&&(i=!0)}),!i)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,r),this.sendControlChange(97,0,r),this._deselectRegisteredParameter(r),this}sendRpnIncrement(t,r={}){if(Array.isArray(t)||(t=ue.REGISTERED_PARAMETERS[t]),be.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let i=!1;if(Object.getOwnPropertyNames(ue.REGISTERED_PARAMETERS).forEach(l=>{ue.REGISTERED_PARAMETERS[l][0]===t[0]&&ue.REGISTERED_PARAMETERS[l][1]===t[1]&&(i=!0)}),!i)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,r),this.sendControlChange(96,0,r),this._deselectRegisteredParameter(r),this}playNote(t,r={}){this.sendNoteOn(t,r);const i=Array.isArray(t)?t:[t];for(let l of i)if(parseInt(l.duration)>0){const u={time:(Se.toTimestamp(r.time)||be.time)+parseInt(l.duration),release:l.release,rawRelease:l.rawRelease};this.sendNoteOff(l,u)}else if(parseInt(r.duration)>0){const u={time:(Se.toTimestamp(r.time)||be.time)+parseInt(r.duration),release:r.release,rawRelease:r.rawRelease};this.sendNoteOff(l,u)}return this}sendNoteOff(t,r={}){if(be.validation){if(r.rawRelease!=null&&!(r.rawRelease>=0&&r.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(r.release!=null&&!(r.release>=0&&r.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");r.rawVelocity&&(r.rawRelease=r.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),r.velocity&&(r.release=r.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let i=64;r.rawRelease!=null?i=r.rawRelease:isNaN(r.release)||(i=Math.round(r.release*127));const l=be.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Se.buildNoteArray(t,{rawRelease:parseInt(i)}).forEach(u=>{this.send([(ue.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),u.getOffsetNumber(l),u.rawRelease],{time:Se.toTimestamp(r.time)})}),this}stopNote(t,r={}){return this.sendNoteOff(t,r)}sendNoteOn(t,r={}){if(be.validation){if(r.rawAttack!=null&&!(r.rawAttack>=0&&r.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(r.attack!=null&&!(r.attack>=0&&r.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");r.rawVelocity&&(r.rawAttack=r.velocity,r.rawRelease=r.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),r.velocity&&(r.attack=r.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let i=64;r.rawAttack!=null?i=r.rawAttack:isNaN(r.attack)||(i=Math.round(r.attack*127));const l=be.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Se.buildNoteArray(t,{rawAttack:i}).forEach(u=>{this.send([(ue.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),u.getOffsetNumber(l),u.rawAttack],{time:Se.toTimestamp(r.time)})}),this}sendChannelMode(t,r=0,i={}){if(typeof t=="string"&&(t=ue.CHANNEL_MODE_MESSAGES[t]),be.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(r))||r<0||r>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(ue.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,r],{time:Se.toTimestamp(i.time)}),this}sendOmniMode(t,r={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,r):this.sendChannelMode("omnimodeoff",0,r),this}sendChannelAftertouch(t,r={}){if(be.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(r.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return r.rawValue||(t=Se.fromFloatTo7Bit(t)),this.send([(ue.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:Se.toTimestamp(r.time)}),this}sendMasterTuning(t,r={}){if(t=parseFloat(t)||0,be.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let i=Math.floor(t)+64,l=t-Math.floor(t);l=Math.round((l+1)/2*16383);let u=l>>7&127,f=l&127;return this.sendRpnValue("channelcoarsetuning",i,r),this.sendRpnValue("channelfinetuning",[u,f],r),this}sendModulationRange(t,r,i={}){if(be.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(r!=null&&(!Number.isInteger(r)||!(r>=0&&r<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return r>=0&&r<=127||(r=0),this.sendRpnValue("modulationrange",[t,r],i),this}sendNrpnValue(t,r,i={}){if(r=[].concat(r),be.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");r.forEach(l=>{if(!(l>=0&&l<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,i),this._setCurrentParameter(r,i),this._deselectNonRegisteredParameter(i),this}sendPitchBend(t,r={}){if(be.validation)if(r.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(r.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let i=0,l=0;if(r.rawValue&&Array.isArray(t))i=t[0],l=t[1];else if(r.rawValue&&!Array.isArray(t))i=t;else{const u=Se.fromFloatToMsbLsb((t+1)/2);i=u.msb,l=u.lsb}return this.send([(ue.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),l,i],{time:Se.toTimestamp(r.time)}),this}sendPitchBendRange(t,r,i={}){if(be.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(r)||!(r>=0&&r<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,r],i),this}sendProgramChange(t,r={}){if(t=parseInt(t)||0,be.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(ue.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:Se.toTimestamp(r.time)}),this}sendRpnValue(t,r,i={}){if(Array.isArray(t)||(t=ue.REGISTERED_PARAMETERS[t]),be.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(r).forEach(l=>{if(!(l>=0&&l<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,i),this._setCurrentParameter(r,i),this._deselectRegisteredParameter(i),this}sendTuningBank(t,r={}){if(be.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,r),this}sendTuningProgram(t,r={}){if(be.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,r),this}sendLocalControl(t,r={}){return t?this.sendChannelMode("localcontrol",127,r):this.sendChannelMode("localcontrol",0,r)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,r={}){return t==="mono"?this.sendChannelMode("monomodeon",0,r):this.sendChannelMode("polymodeon",0,r)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}class gf extends va{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let r=1;r<=16;r++)this.channels[r]=new Nv(this,r);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let r={timestamp:be.time};t.port.connection==="open"?(r.type="opened",r.target=this,r.port=r.target,this.emit("opened",r)):t.port.connection==="closed"&&t.port.state==="connected"?(r.type="closed",r.target=this,r.port=r.target,this.emit("closed",r)):t.port.connection==="closed"&&t.port.state==="disconnected"?(r.type="disconnected",r.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",r)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,r={time:0},i=0){if(t instanceof W0&&(t=Se.isNode?t.data:t.rawData),t instanceof Uint8Array&&Se.isNode&&(t=Array.from(t)),be.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(r)&&(t=t.concat(r)),r=isNaN(i)?{time:0}:{time:i}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(l=>{if(l=parseInt(l),!(l>=0&&l<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),r||(r={time:0})}return this._midiOutput.send(t,Se.toTimestamp(r.time)),this}sendSysex(t,r=[],i={}){if(t=[].concat(t),r instanceof Uint8Array){const l=new Uint8Array(1+t.length+r.length+1);l[0]=ue.SYSTEM_MESSAGES.sysex,l.set(Uint8Array.from(t),1),l.set(r,1+t.length),l[l.length-1]=ue.SYSTEM_MESSAGES.sysexend,this.send(l,{time:i.time})}else{const l=t.concat(r,ue.SYSTEM_MESSAGES.sysexend);this.send([ue.SYSTEM_MESSAGES.sysex].concat(l),{time:i.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():be.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,r={}){if(be.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([ue.SYSTEM_MESSAGES.timecode,t],{time:r.time}),this}sendSongPosition(t=0,r={}){t=Math.floor(t)||0;var i=t>>7&127,l=t&127;return this.send([ue.SYSTEM_MESSAGES.songposition,i,l],{time:r.time}),this}sendSongSelect(t=0,r={}){if(be.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([ue.SYSTEM_MESSAGES.songselect,t],{time:r.time}),this}sendTuneRequest(t={}){return this.send([ue.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([ue.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([ue.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([ue.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([ue.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([ue.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([ue.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return be.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendKeyAftertouch(t,r,i)}),this}sendControlChange(t,r,i={},l={}){if(be.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const u=i;i=l,i.channels=u,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(u=>{this.channels[u].sendControlChange(t,r,i)}),this}sendPitchBendRange(t=0,r=0,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendPitchBendRange(t,r,i)}),this}setPitchBendRange(t=0,r=0,i="all",l={}){return be.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,r,l)}sendRpnValue(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendRpnValue(t,r,i)}),this}setRegisteredParameter(t,r=[],i="all",l={}){return be.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,r,l)}sendChannelAftertouch(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendChannelAftertouch(t,r)}),this}sendPitchBend(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendPitchBend(t,r)}),this}sendProgramChange(t=0,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendProgramChange(t,r)}),this}sendModulationRange(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendModulationRange(t,r,i)}),this}setModulationRange(t=0,r=0,i="all",l={}){return be.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,r,l)}sendMasterTuning(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendMasterTuning(t,r)}),this}setMasterTuning(t,r={},i={}){return be.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,i)}sendTuningProgram(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendTuningProgram(t,r)}),this}setTuningProgram(t,r="all",i={}){return be.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,i)}sendTuningBank(t=0,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendTuningBank(t,r)}),this}setTuningBank(t,r="all",i={}){return be.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,i)}sendChannelMode(t,r=0,i={},l={}){if(be.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const u=i;i=l,i.channels=u,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(u=>{this.channels[u].sendChannelMode(t,r,i)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},r={}){if(be.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const i=t;t=r,t.channels=i,t.channels==="all"&&(t.channels=ue.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(t.channels).forEach(i=>{this.channels[i].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendPolyphonicMode(t,r)}),this}sendLocalControl(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendLocalControl(t,r)}),this}sendOmniMode(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendOmniMode(t,r)}),this}sendNrpnValue(t,r,i={}){return i.channels==null&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].sendNrpnValue(t,r,i)}),this}setNonRegisteredParameter(t,r=[],i="all",l={}){return be.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),l.channels=i,l.channels==="all"&&(l.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,r,l)}sendRpnIncrement(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnIncrement(t,r)}),this}incrementRegisteredParameter(t,r="all",i={}){return be.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,i)}sendRpnDecrement(t,r={}){return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnDecrement(t,r)}),this}decrementRegisteredParameter(t,r="all",i={}){return be.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),i.channels=r,i.channels==="all"&&(i.channels=ue.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,i)}sendNoteOff(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendNoteOff(t,r)}),this}stopNote(t,r){return this.sendNoteOff(t,r)}playNote(t,r={},i={}){if(be.validation&&(r.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),r.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].playNote(t,r)}),this}sendNoteOn(t,r={},i={}){if(be.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const l=r;r=i,r.channels=l,r.channels==="all"&&(r.channels=ue.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(r.channels).forEach(l=>{this.channels[l].sendNoteOn(t,r)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}class u0{constructor(t=[],r={}){this.destinations=[],this.types=[...Object.keys(ue.SYSTEM_MESSAGES),...Object.keys(ue.CHANNEL_MESSAGES)],this.channels=ue.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),r.types&&!Array.isArray(r.types)&&(r.types=[r.types]),r.channels&&!Array.isArray(r.channels)&&(r.channels=[r.channels]),be.validation&&(t.forEach(i=>{if(!(i instanceof gf))throw new TypeError("Destinations must be of type 'Output'.")}),r.types!==void 0&&r.types.forEach(i=>{if(!ue.SYSTEM_MESSAGES.hasOwnProperty(i)&&!ue.CHANNEL_MESSAGES.hasOwnProperty(i))throw new TypeError("Type must be a valid message type.")}),r.channels!==void 0&&r.channels.forEach(i=>{if(!ue.MIDI_CHANNEL_NUMBERS.includes(i))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,r.types&&(this.types=r.types),r.channels&&(this.channels=r.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(r=>{be.validation&&!(r instanceof gf)||r.send(t)}))}}class Rv extends va{constructor(t,r){super(),this._input=t,this._number=r,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const r=Object.assign({},t);r.port=this.input,r.target=this,r.type="midimessage",this.emit(r.type,r),this._parseEventForStandardMessages(r)}_parseEventForStandardMessages(t){const r=Object.assign({},t);r.type=r.message.type||"unknownmessage";const i=t.message.dataBytes[0],l=t.message.dataBytes[1];if(r.type==="noteoff"||r.type==="noteon"&&l===0)this.notesState[i]=!1,r.type="noteoff",r.note=new vs(Se.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+be.octaveOffset),{rawAttack:0,rawRelease:l}),r.value=Se.from7bitToFloat(l),r.rawValue=l,r.velocity=r.note.release,r.rawVelocity=r.note.rawRelease;else if(r.type==="noteon")this.notesState[i]=!0,r.note=new vs(Se.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+be.octaveOffset),{rawAttack:l}),r.value=Se.from7bitToFloat(l),r.rawValue=l,r.velocity=r.note.attack,r.rawVelocity=r.note.rawAttack;else if(r.type==="keyaftertouch")r.note=new vs(Se.offsetNumber(i,this.octaveOffset+this.input.octaveOffset+be.octaveOffset)),r.value=Se.from7bitToFloat(l),r.rawValue=l,r.identifier=r.note.identifier,r.key=r.note.number,r.rawKey=i;else if(r.type==="controlchange"){r.controller={number:i,name:ue.CONTROL_CHANGE_MESSAGES[i].name,description:ue.CONTROL_CHANGE_MESSAGES[i].description,position:ue.CONTROL_CHANGE_MESSAGES[i].position},r.subtype=r.controller.name||"controller"+i,r.value=Se.from7bitToFloat(l),r.rawValue=l;const u=Object.assign({},r);u.type=`${r.type}-controller${i}`,delete u.subtype,this.emit(u.type,u);const f=Object.assign({},r);f.type=`${r.type}-`+ue.CONTROL_CHANGE_MESSAGES[i].name,delete f.subtype,f.type.indexOf("controller")!==0&&this.emit(f.type,f),r.message.dataBytes[0]>=120&&this._parseChannelModeMessage(r),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(r.message.dataBytes[0])&&this._parseEventForParameterNumber(r)}else r.type==="programchange"?(r.value=i,r.rawValue=r.value):r.type==="channelaftertouch"?(r.value=Se.from7bitToFloat(i),r.rawValue=i):r.type==="pitchbend"?(r.value=((l<<7)+i-8192)/8192,r.rawValue=(l<<7)+i):r.type="unknownmessage";this.emit(r.type,r)}_parseChannelModeMessage(t){const r=Object.assign({},t);r.type=r.controller.name,r.type==="localcontrol"&&(r.value=r.message.data[2]===127,r.rawValue=r.message.data[2]),r.type==="omnimodeon"?(r.type="omnimode",r.value=!0,r.rawValue=r.message.data[2]):r.type==="omnimodeoff"&&(r.type="omnimode",r.value=!1,r.rawValue=r.message.data[2]),r.type==="monomodeon"?(r.type="monomode",r.value=!0,r.rawValue=r.message.data[2]):r.type==="polymodeon"&&(r.type="monomode",r.value=!1,r.rawValue=r.message.data[2]),this.emit(r.type,r)}_parseEventForParameterNumber(t){const r=t.message.dataBytes[0],i=t.message.dataBytes[1];r===99||r===101?(this._nrpnBuffer=[],this._rpnBuffer=[],r===99?this._nrpnBuffer=[t.message]:i!==127&&(this._rpnBuffer=[t.message])):r===98||r===100?r===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&i!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(r===6||r===38||r===96||r===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,r,i,l){t=t==="nrpn"?"nrpn":"rpn";const u={target:l.target,timestamp:l.timestamp,message:l.message,parameterMsb:r,parameterLsb:i,value:Se.from7bitToFloat(l.message.dataBytes[1]),rawValue:l.message.dataBytes[1]};t==="rpn"?u.parameter=Object.keys(ue.REGISTERED_PARAMETERS).find(d=>ue.REGISTERED_PARAMETERS[d][0]===r&&ue.REGISTERED_PARAMETERS[d][1]===i):u.parameter=(r<<7)+i;const f=ue.CONTROL_CHANGE_MESSAGES[l.message.dataBytes[0]].name;u.type=`${t}-${f}`,this.emit(u.type,u);const h=Object.assign({},u);h.type==="nrpn-dataincrement"?h.type="nrpn-databuttonincrement":h.type==="nrpn-datadecrement"?h.type="nrpn-databuttondecrement":h.type==="rpn-dataincrement"?h.type="rpn-databuttonincrement":h.type==="rpn-datadecrement"&&(h.type="rpn-databuttondecrement"),this.emit(h.type,h),u.type=t,u.subtype=f,this.emit(u.type,u)}getChannelModeByNumber(t){return be.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),Se.getChannelModeByNumber(t)}getCcNameByNumber(t){if(be.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return Se.getCcNameByNumber(t)}getNoteState(t){t instanceof vs&&(t=t.identifier);const r=Se.guessNoteNumber(t,be.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[r]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}class W0{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=Se.getPropertyByValue(ue.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=Se.getPropertyByValue(ue.SYSTEM_MESSAGES,this.command)),this.statusByte===ue.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}class Dv extends va{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let r=1;r<=16;r++)this.channels[r]=new Rv(this,r);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let r={timestamp:be.time,target:this,port:this};t.port.connection==="open"?(r.type="opened",this.emit("opened",r)):t.port.connection==="closed"&&t.port.state==="connected"?(r.type="closed",this.emit("closed",r)):t.port.connection==="closed"&&t.port.state==="disconnected"?(r.type="disconnected",r.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",r)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const r=new W0(t.data),i={port:this,target:this,message:r,timestamp:t.timeStamp,type:"midimessage",data:r.data,rawData:r.data,statusByte:r.data[0],dataBytes:r.dataBytes};this.emit("midimessage",i),r.isSystemMessage?this._parseEvent(i):r.isChannelMessage&&this.channels[r.channel]._processMidiMessageEvent(i),this._forwarders.forEach(l=>l.forward(r))}_parseEvent(t){const r=Object.assign({},t);r.type=r.message.type||"unknownmidimessage",r.type==="songselect"&&(r.song=t.data[1]+1,r.value=t.data[1],r.rawValue=r.value),this.emit(r.type,r)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){be.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,r,i={}){if(be.validation&&typeof i=="function"){let l=r!=null?[].concat(r):void 0;r=i,i={channels:l}}if(ue.CHANNEL_EVENTS.includes(t)){i.channels===void 0&&(i.channels=ue.MIDI_CHANNEL_NUMBERS);let l=[];return Se.sanitizeChannels(i.channels).forEach(u=>{l.push(this.channels[u].addListener(t,r,i))}),l}else return super.addListener(t,r,i)}addOneTimeListener(t,r,i={}){return i.remaining=1,this.addListener(t,r,i)}on(t,r,i,l){return this.addListener(t,r,i,l)}hasListener(t,r,i={}){if(be.validation&&typeof i=="function"){let l=[].concat(r);r=i,i={channels:l}}return ue.CHANNEL_EVENTS.includes(t)?(i.channels===void 0&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),Se.sanitizeChannels(i.channels).every(l=>this.channels[l].hasListener(t,r))):super.hasListener(t,r)}removeListener(t,r,i={}){if(be.validation&&typeof i=="function"){let l=[].concat(r);r=i,i={channels:l}}if(i.channels===void 0&&(i.channels=ue.MIDI_CHANNEL_NUMBERS),t==null)return Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l]&&this.channels[l].removeListener()}),super.removeListener();ue.CHANNEL_EVENTS.includes(t)?Se.sanitizeChannels(i.channels).forEach(l=>{this.channels[l].removeListener(t,r,i)}):super.removeListener(t,r,i)}addForwarder(t,r={}){let i;return t instanceof u0?i=t:i=new u0(t,r),this._forwarders.push(i),i}removeForwarder(t){this._forwarders=this._forwarders.filter(r=>r!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return be.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}class _v extends va{constructor(){super(),this.defaults={note:{attack:Se.from7bitToFloat(64),release:Se.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},r=!1){if(Se.isNode)try{window.navigator}catch{let h=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,h)}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:r}),r&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const i={timestamp:this.time,target:this,type:"error",error:void 0},l={timestamp:this.time,target:this,type:"midiaccessgranted"},u={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(f){return i.error=f,this.emit("error",i),typeof t.callback=="function"&&t.callback(f),Promise.reject(f)}this.emit("midiaccessgranted",l),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(f){return i.error=f,this.emit("error",i),typeof t.callback=="function"&&t.callback(f),Promise.reject(f)}return this.emit("enabled",u),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(r.disconnected){for(let i=0;i<this._disconnectedInputs.length;i++)if(this._disconnectedInputs[i]._midiInput&&this._disconnectedInputs[i].id===t.toString())return this._disconnectedInputs[i]}else for(let i=0;i<this.inputs.length;i++)if(this.inputs[i]._midiInput&&this.inputs[i].id===t.toString())return this.inputs[i]}getInputByName(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(r.disconnected){for(let i=0;i<this._disconnectedInputs.length;i++)if(~this._disconnectedInputs[i].name.indexOf(t))return this._disconnectedInputs[i]}else for(let i=0;i<this.inputs.length;i++)if(~this.inputs[i].name.indexOf(t))return this.inputs[i]}getOutputByName(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(r.disconnected){for(let i=0;i<this._disconnectedOutputs.length;i++)if(~this._disconnectedOutputs[i].name.indexOf(t))return this._disconnectedOutputs[i]}else for(let i=0;i<this.outputs.length;i++)if(~this.outputs[i].name.indexOf(t))return this.outputs[i]}getOutputById(t,r={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(r.disconnected){for(let i=0;i<this._disconnectedOutputs.length;i++)if(this._disconnectedOutputs[i]._midiOutput&&this._disconnectedOutputs[i].id===t.toString())return this._disconnectedOutputs[i]}else for(let i=0;i<this.outputs.length;i++)if(this.outputs[i]._midiOutput&&this.outputs[i].id===t.toString())return this.outputs[i]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),Se.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?Se.getNoteDetails(Se.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),Se.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),Se.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),Se.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,r={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),Se.buildNoteArray(t,r)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),Se.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(r=>t.push(r.destroy())),this.outputs.forEach(r=>t.push(r.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let r={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?r.port=this.getOutputById(t.port.id):t.port.type==="input"&&(r.port=this.getInputById(t.port.id)),this.emit(t.port.state,r);const i=Object.assign({},r);i.type="portschanged",this.emit(i.type,i)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?r.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(r.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,r);const i=Object.assign({},r);i.type="portschanged",this.emit(i.type,i)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let r=this._inputs.length-1;r>=0;r--){const i=this._inputs[r];Array.from(this.interface.inputs.values()).find(u=>u===i._midiInput)||(this._disconnectedInputs.push(i),this._inputs.splice(r,1))}let t=[];return this.interface.inputs.forEach(r=>{if(!this._inputs.find(i=>i._midiInput===r)){let i=this._disconnectedInputs.find(l=>l._midiInput===r);i||(i=new Dv(r)),this._inputs.push(i),t.push(i.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let r=this._outputs.length-1;r>=0;r--){const i=this._outputs[r];Array.from(this.interface.outputs.values()).find(u=>u===i._midiOutput)||(this._disconnectedOutputs.push(i),this._outputs.splice(r,1))}let t=[];return this.interface.outputs.forEach(r=>{if(!this._outputs.find(i=>i._midiOutput===r)){let i=this._disconnectedOutputs.find(l=>l._midiOutput===r);i||(i=new gf(r)),this._outputs.push(i),t.push(i.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),Se.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),Se.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.14"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),ue.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),ue.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),ue.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),ue.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),ue.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const be=new _v;be.constructor=null;const Ov=async()=>{if(be.enabled)return be;try{return await be.enable({sysex:!0}),console.log("WebMidi is enabled with SysEx support!"),be}catch(a){throw console.error("WebMidi could not be enabled.",a),a}},c0=()=>be.enabled?be.inputs.map(a=>({id:a.id,name:a.name})):[],kv=(a,t)=>{if(be.enabled){const r=be.getInputById(a);if(r){const i=f=>{t({type:"noteon",note:f.note.identifier,velocity:f.velocity,controller:null,channel:f.message.channel})},l=f=>{t({type:"noteoff",note:f.note.identifier,velocity:0,controller:null,channel:f.message.channel})},u=f=>{t({type:"controlchange",controller:f.controller.number,value:f.rawValue,note:null,channel:f.message.channel})};return r.addListener("noteon",i),r.addListener("noteoff",l),r.addListener("controlchange",u),()=>{r.removeListener("noteon",i),r.removeListener("noteoff",l),r.removeListener("controlchange",u)}}}return()=>{}},Lv=a=>{if(be.enabled){const t=r=>{a(r)};return be.addListener("connected",t),be.addListener("disconnected",t),()=>{be.removeListener("connected",t),be.removeListener("disconnected",t)}}return()=>{}},Uv=(a,t)=>{if(be.enabled){const r=be.getInputById(a);if(r){const i=be.outputs.find(l=>l.name===r.name);i?(i.sendSysex(71,t),console.log(`Sent SysEx to ${i.name}`)):console.warn("Could not find matching MIDI Output for SysEx")}}},Wo=(a,t,r,i)=>{if(be.enabled){const l=be.getInputById(a);if(l){const u=be.outputs.find(f=>f.name===l.name);u&&u.sendNoteOn(t,{attack:r/127,channels:i})}}},K0=T.createContext(null),su=()=>T.useContext(K0),Iv=({children:a,onMidiCommand:t})=>{const[r,i]=T.useState(!1),[l,u]=T.useState([]),[f,h]=T.useState(""),[d,g]=T.useState(!1),[v,E]=T.useState(null),[y,x]=T.useState({}),[S,A]=T.useState(null),[N,D]=T.useState(!1),L=T.useRef(!1),M=T.useRef(t);T.useEffect(()=>{M.current=t},[t]),T.useEffect(()=>{(async()=>{try{if(await Ov(),i(!0),u(c0()),Lv(()=>{console.log("MIDI Device change detected, refreshing inputs..."),u(c0())}),window.electronAPI&&window.electronAPI.getMidiMappings){const U=await window.electronAPI.getMidiMappings();U&&(console.log("Loaded saved MIDI mappings:",U),x(U))}}catch(U){console.error("MIDI Init Failed:",U)}})()},[]),T.useEffect(()=>{(async()=>{if(!r||l.length===0)return;let U=f;if(!U&&window.electronAPI?.getSelectedMidiInput){const G=await window.electronAPI.getSelectedMidiInput();G&&l.some(X=>X.id===G)&&(U=G)}(!U||!l.some(G=>G.id===U))&&(U=l[0].id),U!==f&&(console.log(`MIDI: Auto-selecting input: ${U}`),h(U))})()},[r,l,f]);const C=async()=>{window.electronAPI&&window.electronAPI.saveMidiMappings&&(await window.electronAPI.saveMidiMappings(y),console.log("MIDI mappings saved to default."))},B=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(y,"midi")},V=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const J=await window.electronAPI.importMappings("midi");J.success&&J.mappings&&(x(J.mappings),console.log("MIDI mappings imported."))}},te=J=>{const U=l.find(G=>G.id===J);U&&U.name.toLowerCase().includes("apc40")&&(console.log("Detected APC40, sending initialization SysEx..."),Uv(J,[127,41,96,0,4,65,1,1,1]))};T.useEffect(()=>{f&&window.electronAPI&&window.electronAPI.saveSelectedMidiInput&&window.electronAPI.saveSelectedMidiInput(f),f&&r&&te(f)},[f,r,l]);const de=T.useCallback((J,U,G=null)=>{if(!f||!r)return;const X=y[J];if(X&&X.type==="note"){let me=0;typeof U=="number"?me=U:me=U?127:0;const _=G!==null?G:X.channel;Wo(f,X.address,me,_)}},[f,r,y]);T.useEffect(()=>{let J=()=>{};return f&&(console.log(`(Re)binding MIDI listener for: ${f}`),J=kv(f,U=>{ye.current&&A(U),pe(U)})),J},[f,d,v,y,l]);const ye=T.useRef(d);T.useEffect(()=>{ye.current=d},[d]);const pe=J=>{if(J.channel===1&&J.note==="D7"){const G=J.type==="noteon";D(G),L.current=G,console.log(`Shift ${G?"Down":"Up"}`);return}if(d&&v){if(J.type==="noteoff")return;const G=J.note||J.controller,X=L.current,me={type:J.type==="noteon"||J.type==="noteoff"?"note":"cc",channel:J.channel,address:G,requiresShift:X,label:`${X?"":""}CH${J.channel}:${G}`};console.log(`Mapped ${v} to:`,me),x(_=>({..._,[v]:me})),E(null);return}Object.entries(y).forEach(([G,X])=>{const me=(J.type==="noteon"||J.type==="noteoff")&&X.type==="note"&&J.note===X.address&&J.channel===X.channel,_=J.type==="controlchange"&&X.type==="cc"&&J.controller===X.address&&J.channel===X.channel,z=X.type==="cc"||!!X.requiresShift===L.current;if((me||_)&&z&&M.current){let ie;J.type==="controlchange"?ie=J.value??0:J.type==="noteoff"?ie=0:ie=J.velocity??0,M.current(G,ie,127,J.type)}})},W={midiInitialized:r,midiInputs:l,selectedMidiInputId:f,setSelectedMidiInputId:h,isMapping:d,startMapping:()=>g(!0),stopMapping:()=>{g(!1),E(null)},learningId:v,setLearningId:E,mappings:y,setMappings:x,removeMapping:J=>{x(U=>{const G={...U};return delete G[J],G})},saveMappings:C,exportMappings:B,importMappings:V,initializeApc40:te,sendFeedback:de,lastMidiEvent:S,isShiftDown:N};return m.jsx(K0.Provider,{value:W,children:a})},J0=T.createContext(null),Df=()=>T.useContext(J0),Bv=({children:a,onArtnetCommand:t})=>{const[r,i]=T.useState(!1),[l,u]=T.useState(!1),[f,h]=T.useState(null),[d,g]=T.useState({}),[v,E]=T.useState(null),y=T.useRef(t);T.useEffect(()=>{y.current=t},[t]),T.useEffect(()=>{(async()=>{try{if(window.electronAPI&&window.electronAPI.initializeArtnet&&(await window.electronAPI.initializeArtnet()).success&&(i(!0),console.log("Art-Net initialized for mapping")),window.electronAPI&&window.electronAPI.getArtnetMappings){const V=await window.electronAPI.getArtnetMappings();V&&(console.log("Loaded saved Art-Net mappings:",V),g(V))}}catch(V){console.error("Art-Net Init Failed:",V)}})()},[]);const x=async()=>{window.electronAPI&&window.electronAPI.saveArtnetMappings&&(await window.electronAPI.saveArtnetMappings(d),console.log("Art-Net mappings saved."))},S=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(d,"artnet")},A=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const B=await window.electronAPI.importMappings("artnet");B.success&&B.mappings&&(g(B.mappings),console.log("Art-Net mappings imported."))}};T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onArtnetDataReceived)return window.electronAPI.onArtnetDataReceived(V=>{N.current&&E(V),D(V)})},[l,f,d]);const N=T.useRef(l);T.useEffect(()=>{N.current=l},[l]);const D=B=>{const{universe:V,channel:te,value:de}=B;if(l&&f){if(de===0)return;const ye={universe:V,channel:te,label:`U${V}:CH${te+1}`};console.log(`Mapped ${f} to Art-Net:`,ye),g(pe=>({...pe,[f]:ye})),h(null);return}Object.entries(d).forEach(([ye,pe])=>{pe.universe===V&&pe.channel===te&&y.current&&y.current(ye,de)})},C={artnetInitialized:r,isMapping:l,startMapping:()=>u(!0),stopMapping:()=>{u(!1),h(null)},learningId:f,setLearningId:h,mappings:d,setMappings:g,saveMappings:x,exportMappings:S,importMappings:A,lastDmxEvent:v};return m.jsx(J0.Provider,{value:C,children:a})},em=T.createContext(null),_f=()=>T.useContext(em),Fv=({children:a,onCommand:t,enabled:r=!1})=>{const[i,l]=T.useState(!1),[u,f]=T.useState(null),[h,d]=T.useState({}),g=T.useRef(t);T.useEffect(()=>{g.current=t},[t]),T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getKeyboardMappings){const A=await window.electronAPI.getKeyboardMappings();A&&d(A)}})()},[]);const v=async()=>{window.electronAPI&&window.electronAPI.saveKeyboardMappings&&await window.electronAPI.saveKeyboardMappings(h)},E=async()=>{window.electronAPI&&window.electronAPI.exportMappings&&await window.electronAPI.exportMappings(h,"keyboard")},y=async()=>{if(window.electronAPI&&window.electronAPI.importMappings){const S=await window.electronAPI.importMappings("keyboard");S.success&&S.mappings&&d(S.mappings)}};T.useEffect(()=>{const S=A=>{if(r&&!(A.target.tagName==="INPUT"||A.target.tagName==="TEXTAREA"||A.target.isContentEditable)){if(i&&u){A.preventDefault();const N={key:A.code,label:A.code.replace("Key","").replace("Digit","")};d(D=>({...D,[u]:N})),f(null);return}Object.entries(h).forEach(([N,D])=>{A.code===D.key&&(A.preventDefault(),g.current&&g.current(N,1,1,"keydown"))})}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[r,i,u,h]);const x={isMapping:i,startMapping:()=>l(!0),stopMapping:()=>{l(!1),f(null)},learningId:u,setLearningId:f,mappings:h,setMappings:d,saveMappings:v,exportMappings:E,importMappings:y,removeMapping:S=>d(A=>{const N={...A};return delete N[S],N})};return m.jsx(em.Provider,{value:x,children:a})},Nt=({id:a,children:t})=>{const{isMapping:r,setLearningId:i,removeMapping:l}=su(),{isMapping:u,setLearningId:f,removeMapping:h}=Df()||{},{isMapping:d,setLearningId:g,removeMapping:v}=_f()||{},E=r||u||d,y=A=>{E&&(A.preventDefault(),A.stopPropagation(),r&&i(a),u&&f(a),d&&g(a))},x=A=>{E&&(A.preventDefault(),A.stopPropagation(),r&&l(a),u&&h(a),d&&v(a))},S=_n.Children.only(t);return _n.cloneElement(S,{"data-mappable-id":a,onClickCapture:E?y:S.props.onClickCapture,onContextMenu:E?x:S.props.onContextMenu,className:`${S.props.className||""} ${E?"mappable-target":""}`.trim()})},jv=({masterIntensity:a,onMasterIntensityChange:t})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_intensity",targetType:"global",label:"MASTER",min:0,max:1,step:.01}))};return m.jsx("div",{className:"master-intensity-slider",draggable:!0,onDragStart:r,children:m.jsx(Nt,{id:"master_intensity",children:m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:a,className:"slider_hor",id:"masterIntensityRange",onChange:i=>t(parseFloat(i.target.value))})})})},Pv=({masterIntensity:a,onMasterIntensityChange:t,onClearAllActive:r,isGlobalBlackout:i,onToggleGlobalBlackout:l})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"global",label:h.toUpperCase()}))};return m.jsxs("div",{className:"composition-controls",children:[m.jsx("span",{className:"layer-control-button",children:"Comp"}),m.jsx(Nt,{id:"comp_clear",children:m.jsx("span",{className:"layer-control-button",onClick:r,style:{cursor:"pointer"},draggable:!0,onDragStart:f=>u(f,"clear"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),m.jsx(Nt,{id:"comp_blackout",style:{width:"100%",display:"flex"},children:m.jsx("span",{className:"layer-control-button",onClick:l,style:{cursor:"pointer",backgroundColor:i?"red":""},draggable:!0,onDragStart:f=>u(f,"blackout"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx(jv,{masterIntensity:a,onMasterIntensityChange:t})]})},Gv=({name:a,index:t,onTrigger:r,onShowColumnHeaderContextMenu:i})=>{const l=f=>{f.preventDefault(),i&&i(t)},u=f=>{f.button===0&&r&&r()};return m.jsx(Nt,{id:`column_${t}`,children:m.jsx("div",{className:"column-header trigger-button",onClick:u,onContextMenu:l,style:{cursor:"pointer"},children:a})})},Al=[{id:"rotate",name:"Rotate",type:"transform",description:"Rotates the shape around its center.",defaultParams:{angle:0,speed:0,direction:"CW"},paramControls:[{id:"angle",label:"Angle",type:"range",min:0,max:360,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["CW","CCW"]}]},{id:"scale",name:"Scale",type:"transform",description:"Scales the shape.",defaultParams:{scaleX:1,scaleY:1},paramControls:[{id:"scaleX",label:"Scale X",type:"range",min:.01,max:5,step:.01},{id:"scaleY",label:"Scale Y",type:"range",min:.01,max:5,step:.01}]},{id:"translate",name:"Translate",type:"transform",description:"Moves the shape.",defaultParams:{translateX:0,translateY:0},paramControls:[{id:"translateX",label:"Translate X",type:"range",min:-1,max:1,step:.01},{id:"translateY",label:"Translate Y",type:"range",min:-1,max:1,step:.01}]},{id:"color",name:"Color",type:"color",description:"Changes the color of the shape with solid or rainbow modes.",defaultParams:{mode:"solid",r:255,g:255,b:255,cycleSpeed:0,rainbowSpread:1,rainbowOffset:0,rainbowPalette:"rainbow"},paramControls:[{id:"mode",label:"Mode",type:"select",options:["solid","rainbow"]},{id:"r",label:"Red",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"g",label:"Green",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1,showIf:{mode:"solid"}},{id:"cycleSpeed",label:"Cycle Speed",type:"range",min:0,max:10,step:.1},{id:"rainbowSpread",label:"Rainbow Spread",type:"range",min:.1,max:10,step:.1,showIf:{mode:"rainbow"}},{id:"rainbowOffset",label:"Rainbow Offset",type:"range",min:0,max:360,step:1,showIf:{mode:"rainbow"}},{id:"rainbowPalette",label:"Palette",type:"select",options:["rainbow","fire","ice","cyber"],showIf:{mode:"rainbow"}}]},{id:"wave",name:"Wave",type:"animation",description:"Applies a wave distortion to the shape.",defaultParams:{amplitude:.1,frequency:10,speed:1,direction:"x"},paramControls:[{id:"amplitude",label:"Amplitude",type:"range",min:.01,max:1,step:.01},{id:"frequency",label:"Frequency",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1},{id:"direction",label:"Direction",type:"select",options:["x","y"]}]},{id:"warp",name:"Warp",type:"animation",description:"Symmetrical chaotic wave distortion.",defaultParams:{amount:.1,chaos:.5,speed:1},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"chaos",label:"Chaos",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:10,step:.1}]},{id:"distortion",name:"Distortion",type:"transform",description:"Distorts the point data.",defaultParams:{amount:.1,scale:10,speed:.5},paramControls:[{id:"amount",label:"Amount",type:"range",min:0,max:1,step:.01},{id:"scale",label:"Scale",type:"range",min:1,max:50,step:1},{id:"speed",label:"Speed",type:"range",min:0,max:5,step:.1}]},{id:"move",name:"Move (Bounce)",type:"transform",description:"Moves points and bounces them off the borders.",defaultParams:{speedX:.1,speedY:.1},paramControls:[{id:"speedX",label:"Speed X",type:"range",min:0,max:2,step:.01},{id:"speedY",label:"Speed Y",type:"range",min:0,max:2,step:.01}]},{id:"delay",name:"Delay",type:"effect",description:"Frame or Channel based delay effect.",defaultParams:{mode:"frame",playstyle:"repeat",useCustomOrder:!1,delayDirection:"left_to_right",delayAmount:5,decay:.8,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat"]},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"delayDirection",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}},{id:"delayAmount",label:"Delay Time",type:"range",min:1,max:60,step:1},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01}]},{id:"chase",name:"Chase",type:"effect",description:"Frame or Channel based chase effect.",defaultParams:{mode:"frame",playstyle:"repeat",steps:4,decay:.8,speed:1,overlap:1,direction:"left_to_right",useCustomOrder:!1,customOrder:[],enabled:!0},paramControls:[{id:"mode",label:"Mode",type:"select",options:["frame","channel"]},{id:"playstyle",label:"Playstyle",type:"select",options:["once","repeat","bounce"]},{id:"steps",label:"Steps",type:"range",min:2,max:16,step:1,showIf:{mode:"frame"}},{id:"decay",label:"Decay",type:"range",min:0,max:1,step:.01},{id:"speed",label:"Speed",type:"range",min:.1,max:5,step:.1},{id:"overlap",label:"Overlap",type:"range",min:1,max:4,step:1},{id:"useCustomOrder",label:"Custom Order",type:"checkbox",showIf:{mode:"channel"}},{id:"direction",label:"Direction",type:"select",options:["center_to_out","out_to_center","left_to_right","right_to_left"],showIf:{useCustomOrder:!1}}]},{id:"blanking",name:"Blanking",type:"animation",description:"Controls the blanking of the laser output.",defaultParams:{blankingInterval:0,spacing:0},paramControls:[{id:"blankingInterval",label:"Blanking Interval",type:"range",min:0,max:10,step:1},{id:"spacing",label:"Spacing",type:"range",min:0,max:20,step:1}]},{id:"strobe",name:"Strobe",type:"animation",description:"Applies a strobe effect to the laser output.",defaultParams:{strobeSpeed:100,strobeAmount:.5},paramControls:[{id:"strobeSpeed",label:"Strobe Speed (ms)",type:"range",min:10,max:1e3,step:10},{id:"strobeAmount",label:"Strobe Amount (0-1)",type:"range",min:0,max:1,step:.01}]},{id:"mirror",name:"Mirror",type:"transform",description:"Mirrors the shape from the center.",defaultParams:{mode:"none"},paramControls:[{id:"mode",label:"Mirror Mode",type:"select",options:["none","x+","x-","y+","y-"]}]}],zv=Al.reduce((a,t)=>(a[t.id]=t,a),{});function tm(a,t,r,i){if(!r)return t;const l=typeof r=="string"?{syncMode:r}:r;if(!l.syncMode)return t;const{time:u,progress:f=0,bpm:h=120,clipDuration:d=0,fftLevels:g={low:0,mid:0,high:0},activationTime:v=0}=i;let E=0;const y=l.speedMultiplier||1,x=l.style||"loop";if(x==="once"&&v>0){const M=(u-v)*.001;let C=1;if(l.syncMode==="timeline")C=Math.max(.01,l.duration||1);else if(l.syncMode==="bpm"){const B=Math.max(.1,l.beats||4),V=h/60;C=B/(V||2)}else if(l.syncMode==="fps")return E=M*y,calculateAnimPhase(E,l,t);E=M/C*y}else if(l.syncMode==="fps")E=u*.001*y;else if(l.syncMode==="timeline"){const M=Math.max(.01,l.duration||1);d>0?E=f*d/M*y:E=0}else if(l.syncMode==="bpm"){const M=Math.max(.1,l.beats||4),C=h/60,B=M/(C||2);d>0?E=f*d/B*y:E=0}else if(l.syncMode==="fft"){const M=l.fftRange||"low",C=g[M]||0;return Hv(C,t,l)}x==="bounce"&&(E*=2);const S=l.direction||"forward";if(S==="pause")return t;let A=0;if(x==="once")A=Math.min(E,1),S==="backward"&&(A=1-A);else if(x==="bounce"){let M=E%1;Math.floor(E)%2===1?A=1-M:A=M,S==="backward"&&(A=1-A)}else A=E%1,S==="backward"&&(A=1-A);const N=l.range;let D=0,L=1;if(N&&Array.isArray(N)&&N.length===2)D=N[0],L=N[1];else return t;return D+(L-D)*A}function Hv(a,t,r){const i=r.range;return i&&Array.isArray(i)&&i.length===2?i[0]+(i[1]-i[0])*a:t}let vf=new Float32Array(1024*8);function nm(a){vf.length<a*8&&(vf=new Float32Array(a*8*2))}function Tl(a,t,r={}){const{progress:i=0,time:l=performance.now(),effectStates:u,syncSettings:f={},fftLevels:h}=r;if(!t||t.length===0)return a;const d=a.points,g=a.isTypedArray||d instanceof Float32Array,v=g?d.length/8:d.length;nm(v);const E=vf.subarray(0,v*8);if(g)E.set(d);else for(let S=0;S<v;S++){const A=d[S],N=S*8;E[N]=A.x,E[N+1]=A.y,E[N+2]=A.z||0,E[N+3]=A.r,E[N+4]=A.g,E[N+5]=A.b,E[N+6]=A.blanking?1:0,E[N+7]=A.lastPoint?1:0}const y=()=>E.length/8;let x=E;for(const S of t){const A=S.params;if(A.enabled===!1||!zv[S.id])continue;let D=A;const L=S.instanceId?`${S.instanceId}.`:`${S.id}.`;let M=!1;for(const C in A)if(f[L+C]){M=!0;break}if(M){D={...A};for(const C in D){const B=L+C;f[B]&&(D[C]=tm(C,D[C],f[B],r))}}switch(S.id){case"rotate":Yv(x,y(),D,i,l);break;case"scale":qv(x,y(),D);break;case"translate":Vv(x,y(),D);break;case"color":Xv(x,y(),D,l);break;case"wave":Qv(x,y(),D,l);break;case"blanking":$v(x,y(),D);break;case"strobe":Wv(x,y(),D,l);break;case"mirror":x=Kv(x,y(),D);break;case"warp":Jv(x,y(),D,l);break;case"distortion":ey(x,y(),D,l);break;case"move":ty(x,y(),D,l);break;case"delay":u&&S.instanceId&&(x=ny(x,y(),D,u,S.instanceId,r));break;case"chase":x=ay(x,y(),D,l,r);break}}return{...a,points:new Float32Array(x),isTypedArray:!0}}function Yv(a,t,r,i,l){const{angle:u,speed:f,direction:h}=r,d=h==="CCW"?-1:1,g=l*.001*f*d,v=u*Math.PI/180+g,E=Math.sin(v),y=Math.cos(v);for(let x=0;x<t;x++){const S=x*8,A=a[S],N=a[S+1];a[S]=A*y-N*E,a[S+1]=A*E+N*y}}function qv(a,t,r){const{scaleX:i,scaleY:l}=r;for(let u=0;u<t;u++){const f=u*8;a[f]*=i,a[f+1]*=l}}function Vv(a,t,r){const{translateX:i,translateY:l}=r;for(let u=0;u<t;u++){const f=u*8;a[f]+=i,a[f+1]+=l}}function Xv(a,t,r,i){const{mode:l,r:u,g:f,b:h,cycleSpeed:d,rainbowSpread:g,rainbowOffset:v,rainbowPalette:E}=r,y=i*.001*d;if(l==="rainbow"){const x=E||"rainbow";for(let S=0;S<t;S++){const A=S*8,N=(S/t*g+y*.5+v/360)%1;let D,L,M;x==="rainbow"?[D,L,M]=f0(N,1,.5):[D,L,M]=Zv(x,N),a[A+3]=D,a[A+4]=L,a[A+5]=M}}else if(d>0){const x=y*50%360,[S,A,N]=f0(x/360,1,.5);for(let D=0;D<t;D++){const L=D*8;a[L+3]=S,a[L+4]=A,a[L+5]=N}}else for(let x=0;x<t;x++){const S=x*8;a[S+3]=u,a[S+4]=f,a[S+5]=h}}function Zv(a,t){const r={fire:[{r:255,g:0,b:0},{r:255,g:128,b:0},{r:255,g:255,b:0},{r:255,g:0,b:0}],ice:[{r:0,g:0,b:255},{r:0,g:255,b:255},{r:255,g:255,b:255},{r:0,g:0,b:255}],cyber:[{r:255,g:0,b:255},{r:0,g:255,b:255},{r:0,g:0,b:255},{r:255,g:0,b:255}]},i=r[a]||r.fire,l=t*(i.length-1),u=Math.floor(l),f=l-u,h=i[u],d=i[u+1]||i[u];return[Math.round(h.r+(d.r-h.r)*f),Math.round(h.g+(d.g-h.g)*f),Math.round(h.b+(d.b-h.b)*f)]}function f0(a,t,r){let i,l,u;{const f=(g,v,E)=>(E<0&&(E+=1),E>1&&(E-=1),E<.16666666666666666?g+(v-g)*6*E:E<.5?v:E<.6666666666666666?g+(v-g)*(.6666666666666666-E)*6:g),h=r+t-r*t,d=2*r-h;i=f(d,h,a+1/3),l=f(d,h,a),u=f(d,h,a-1/3)}return[Math.round(i*255),Math.round(l*255),Math.round(u*255)]}function Qv(a,t,r,i){const{amplitude:l,frequency:u,speed:f,direction:h}=r,d=i*.001*f;for(let g=0;g<t;g++){const v=g*8;h==="x"?a[v+1]+=l*Math.sin(a[v]*u+d):h==="y"&&(a[v]+=l*Math.sin(a[v+1]*u+d))}}function $v(a,t,r){const{blankingInterval:i,spacing:l=0}=r;if(i<=0)return;const u=i+1+l;for(let f=0;f<t;f++)f%u>=i&&(a[f*8+6]=1)}function Wv(a,t,r,i){const{strobeSpeed:l,strobeAmount:u}=r;if(i%l/l<u)for(let h=0;h<t;h++)a[h*8+6]=1}function Kv(a,t,r){const{mode:i}=r;if(i==="none")return a;let l=0;nm(t*2);const u=[];for(let h=0;h<t;h++){const d=h*8,g=a[d],v=a[d+1];let E=!1;i==="x-"?g<=0&&(E=!0):i==="x+"?g>=0&&(E=!0):i==="y-"?v<=0&&(E=!0):i==="y+"&&v>=0&&(E=!0),E&&(u.push(d),l++)}const f=new Float32Array(l*2*8);for(let h=0;h<l;h++){const d=u[h],g=h*8;f.set(a.subarray(d,d+8),g);const v=(l+h)*8;f.set(a.subarray(d,d+8),v),(i==="x-"||i==="x+")&&(f[v]=-f[v]),(i==="y-"||i==="y+")&&(f[v+1]=-f[v+1])}return f}function Jv(a,t,r,i){const{amount:l,chaos:u,speed:f}=r,h=i*.001*f;for(let d=0;d<t;d++){const g=d*8,v=a[g],E=a[g+1],y=Math.abs(E);a[g]+=Math.sin(y*10*(1+u)+h)*l*Math.cos(h*u),a[g+1]+=Math.cos(Math.abs(v)*10*(1+u)+h)*l*Math.sin(h*u)}}function ey(a,t,r,i){const{amount:l,scale:u,speed:f}=r,h=i*.001*f;for(let d=0;d<t;d++){const g=d*8,v=Math.sin(a[g]*u+h)*Math.cos(a[g+1]*u-h),E=Math.cos(a[g]*u-h)*Math.sin(a[g+1]*u+h);a[g]+=v*l,a[g+1]+=E*l}}function ty(a,t,r,i){const{speedX:l,speedY:u}=r,f=i*.001,h=f*l,d=f*u,g=4;for(let v=0;v<t;v++){const E=v*8;let y=a[E]+h,x=a[E+1]+d,S=(y+1)%g;S<0&&(S+=g),S>2&&(S=4-S),y=S-1;let A=(x+1)%g;A<0&&(A+=g),A>2&&(A=4-A),x=A-1,a[E]=y,a[E+1]=x}}function ny(a,t,r,i,l,u){const{mode:f="frame",delayAmount:h,decay:d,delayDirection:g,useCustomOrder:v,customOrder:E,playstyle:y="repeat"}=r;i.has(l)||i.set(l,[]);const x=i.get(l);if(x.unshift(new Float32Array(a)),f==="frame"){const A=h*10+1;x.length>A&&(x.length=A);const N=new Float32Array(a.length);for(let D=0;D<t;D++){let L=0;const M=D/t;g==="left_to_right"?L=Math.floor(M*9):g==="right_to_left"?L=Math.floor((1-M)*9):g==="center_to_out"?L=Math.floor(Math.abs(M-.5)*2*9):g==="out_to_center"&&(L=Math.floor((1-Math.abs(M-.5)*2)*9));const C=L*h,B=C<x.length?x[C]:null,V=Math.pow(d,L),te=D*8;B&&B.length===a.length?(N[te]=B[te],N[te+1]=B[te+1],N[te+2]=B[te+2],N[te+3]=B[te+3]*V,N[te+4]=B[te+4]*V,N[te+5]=B[te+5]*V,N[te+6]=B[te+6],N[te+7]=B[te+7]):(N.set(a.subarray(te,te+8),te),N[te+3]=0,N[te+4]=0,N[te+5]=0,N[te+6]=1)}return N}else{const{assignedDacs:S}=u||{};let A=new Map,N=0;if(v||r.delayMode==="channel")(E&&E.length>0?E.map(q=>q.originalIndex):S?S.map((q,j)=>j):[0]).forEach((q,j)=>{A.set(q,j),N=Math.max(N,j)});else{const q=(S||[]).length||1;for(let j=0;j<q;j++){let $=j;g==="right_to_left"?$=q-1-j:g==="center_to_out"?$=Math.floor(Math.abs(j-(q-1)/2)):g==="out_to_center"&&($=Math.min(j,q-1-j)),A.set(j,$),N=Math.max(N,$)}}const L=N+1,M=h*L+1;x.length>M&&(x.length=M);const C=[];for(let pe=0;pe<L;pe++){const q=pe*h;C.push({points:q<x.length?x[q]:null,factor:Math.pow(d,pe),index:pe})}const B=C.reduce((pe,q)=>pe+(q.points?q.points.length/8:a.length/8),0),V=new Float32Array(B*8);let te=0;const de=new Array(C.length);for(let pe=0;pe<C.length;pe++){const q=C[pe],j=q.points,$=j?j.length/8:a.length/8;de[pe]=te;for(let W=0;W<$;W++){const J=W*8,U=te+W*8;j?(V[U]=j[J],V[U+1]=j[J+1],V[U+2]=j[J+2],V[U+3]=j[J+3]*q.factor,V[U+4]=j[J+4]*q.factor,V[U+5]=j[J+5]*q.factor,V[U+6]=j[J+6],V[U+7]=j[J+7]):V[U+6]=1}te+=$*8}const ye=new Map;return A.forEach((pe,q)=>{pe<C.length&&ye.set(q,{start:de[pe],length:C[pe].points?C[pe].points.length:a.length})}),V._channelDistributions=ye,V}}function ay(a,t,r,i,l={}){const{mode:u="frame",steps:f,decay:h,speed:d,overlap:g,direction:v,useCustomOrder:E,customOrder:y,playstyle:x="loop"}=r,{progress:S=0,clipDuration:A=1}=l,N=S!==void 0&&A>0;if(u==="frame"){const D=f;let L=(N?S*D:i*.001)*d;if(x==="bounce"){const C=D,B=L%(C*2);L=B>C?C*2-B:B}else x==="once"?L=Math.min(L,D):L=L%D;const M=new Float32Array(a.length);for(let C=0;C<t;C++){const B=C/t;let V=0;v==="left_to_right"?V=Math.min(D-1,Math.floor(B*D)):v==="right_to_left"?V=Math.min(D-1,Math.floor((1-B)*D)):v==="center_to_out"?V=Math.min(D-1,Math.floor(Math.abs(B-.5)*2*D)):v==="out_to_center"&&(V=Math.min(D-1,Math.floor((1-Math.abs(B-.5)*2)*D)));let te=Math.abs(L-V);te>D/2&&(te=D-te);let de=te<g?1-te/g:0;h>0&&(de=Math.pow(de,1-h));const ye=C*8;M.set(a.subarray(ye,ye+8),ye),M[ye+3]*=de,M[ye+4]*=de,M[ye+5]*=de,de<.05&&(M[ye+6]=1)}return M}else{const{assignedDacs:D}=l||{};let L=new Map,M=0;if(E)(y&&y.length>0?y.map(j=>j.originalIndex):D?D.map((j,$)=>$):[0]).forEach((j,$)=>{L.set(j,$),M++});else{M=(D?D.length:1)||1;for(let q=0;q<M;q++){let j=q;v==="right_to_left"?j=M-1-q:v==="center_to_out"?j=Math.floor(Math.abs(q-(M-1)/2)):v==="out_to_center"&&(j=Math.min(q,M-1-q)),L.set(q,j)}}const C=M;let B=(N?S*C:i*.001)*d;if(x==="bounce"){const q=C,j=B%(q*2);B=j>q?q*2-j:j}else x==="once"?B=Math.min(B,C):B=B%C;const V=t*M,te=new Float32Array(V*8),de=new Map;let ye=0;const pe=Array.from(L.keys());pe.length===0&&pe.push(0);for(const q of pe){const j=L.get(q)||0;let $=Math.abs(B-j);$>C/2&&($=C-$);let W=$<g?1-$/g:0;h>0&&(W=Math.pow(W,1-h));const J=ye;for(let U=0;U<t;U++){const G=U*8,X=ye+U*8;te.set(a.subarray(G,G+8),X),te[X+3]*=W,te[X+4]*=W,te[X+5]*=W,W<.05&&(te[X+6]=1)}de.set(q,{start:J,length:t*8}),ye+=t*8}return te._channelDistributions=de,te}}function yf(a,t,r=!1){if(!t||!a||!a.points)return a;const{safetyZones:i,outputArea:l,transformationEnabled:u,transformationMode:f,flipX:h,flipY:d}=t;let g=a.points;const v=a.isTypedArray||g instanceof Float32Array,E=v?g.length/8:g.length;let y=r?g:v?new Float32Array(g):g.map(x=>({...x}));for(let x=0;x<E;x++){let S,A,N,D,L,M;if(v?(S=y[x*8],A=y[x*8+1],N=y[x*8+3],D=y[x*8+4],L=y[x*8+5],M=y[x*8+6]):(S=y[x].x,A=y[x].y,N=y[x].r,D=y[x].g,L=y[x].b,M=y[x].blanking?1:0),u&&l){let C=(S+1)/2,B=(1-A)/2;f==="crop"?(C<l.x||C>l.x+l.w||B<l.y||B>l.y+l.h)&&(N=0,D=0,L=0,M=1):f==="scale"&&(C=l.x+C*l.w,B=l.y+B*l.h,S=C*2-1,A=1-B*2)}if(i&&i.length>0){let C=(S+1)/2,B=(1-A)/2;for(const V of i)if(C>=V.x&&C<=V.x+V.w&&B>=V.y&&B<=V.y+V.h){N=0,D=0,L=0,M=1;break}}h&&(S=-S),d&&(A=-A),S=Math.max(-1,Math.min(1,S)),A=Math.max(-1,Math.min(1,A)),v?(y[x*8]=S,y[x*8+1]=A,y[x*8+3]=N,y[x*8+4]=D,y[x*8+5]=L,y[x*8+6]=M):(y[x].x=S,y[x].y=A,y[x].r=N,y[x].g=D,y[x].b=L,y[x].blanking=M>.5)}return{...a,points:y,isTypedArray:v}}class ry{constructor(t,r){if(this.canvas=t,this.type=r,this.gl=t.getContext("webgl")||t.getContext("experimental-webgl"),this.animationFrameId=null,this.frameIndexes=Array(10).fill(0),this.pointIndexes=Array(10).fill(0),this.showBeamEffect=!1,this.beamAlpha=.5,this.fadeAlpha=.13,this.beamRenderMode="both",this.positionBuffer=null,this.colorBuffer=null,this.alphaBuffer=null,this.alphaBufferData=new Float32Array(131072),this.lastPointDrawTime=0,!this.gl){console.error("WebGL not supported");return}this.setup()}setup(){const t=this.gl,r=`
      attribute vec2 aPosition;
      attribute vec3 aColor;
      attribute float aAlpha;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
        gl_PointSize = 2.0;
        vColor = aColor;
        vAlpha = aAlpha;
      }
    `,i=`
      precision mediump float;
      varying vec3 vColor;
      varying float vAlpha;
      void main() {
        gl_FragColor = vec4(vColor, vAlpha);
      }
    `,l=this.createShader(t.VERTEX_SHADER,r),u=this.createShader(t.FRAGMENT_SHADER,i),f=this.createProgram(l,u);this.program=f,this.positionAttributeLocation=t.getAttribLocation(f,"aPosition"),this.colorAttributeLocation=t.getAttribLocation(f,"aColor"),this.alphaAttributeLocation=t.getAttribLocation(f,"aAlpha"),this.quadPositionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.quadPositionBuffer);const h=[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1];t.bufferData(t.ARRAY_BUFFER,new Float32Array(h),t.STATIC_DRAW),this.quadColorUniformLocation=t.getUniformLocation(f,"uColor"),this.quadAlphaUniformLocation=t.getUniformLocation(f,"uAlpha");const d=`
      attribute vec2 aPosition;
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
      }
    `,g=`
      precision mediump float;
      uniform vec4 uColor;
      void main() {
        gl_FragColor = uColor;
      }
    `,v=this.createShader(t.VERTEX_SHADER,d),E=this.createShader(t.FRAGMENT_SHADER,g);this.fadeProgram=this.createProgram(v,E),this.fadePositionAttributeLocation=t.getAttribLocation(this.fadeProgram,"aPosition"),this.fadeColorUniformLocation=t.getUniformLocation(this.fadeProgram,"uColor"),t.useProgram(f);const y=131072;this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,y*2*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,y*3*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),this.alphaBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.alphaBuffer),t.bufferData(t.ARRAY_BUFFER,y*1*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_DRAW),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(0,0,0,1)}reset(){this.frameIndexes.fill(0),this.pointIndexes.fill(0),this.clearCanvas()}createShader(t,r){const i=this.gl,l=i.createShader(t);if(i.shaderSource(l,r),i.compileShader(l),i.getShaderParameter(l,i.COMPILE_STATUS))return l;console.error(i.getShaderInfoLog(l)),i.deleteShader(l)}createProgram(t,r){const i=this.gl,l=i.createProgram();if(i.attachShader(l,t),i.attachShader(l,r),i.linkProgram(l),i.getProgramParameter(l,i.LINK_STATUS))return l;console.error(i.getProgramInfoLog(l)),i.deleteProgram(l)}render(t){t.showBeamEffect!==void 0&&this.setBeamEffect(t.showBeamEffect),t.beamAlpha!==void 0&&this.setBeamAlpha(t.beamAlpha),t.fadeAlpha!==void 0&&this.setFadeAlpha(t.fadeAlpha),t.beamRenderMode!==void 0&&(this.beamRenderMode=t.beamRenderMode),this.type==="world"?this.renderWorld(t.worldData,t.previewScanRate,t.layerIntensities,t.masterIntensity,t.dacSettings,t.previewTime,t.fftLevels):this.renderSingle(t.ildaFrames,t.previewScanRate,t.intensity,t.effects,t.syncSettings,t.bpm,t.clipDuration,t.progress,t.previewTime,t.fftLevels,t.effectStates)}renderSingle(t,r,i,l,u={},f=120,h=1,d=null,g=null,v={low:0,mid:0,high:0},E=null){const y=this.gl;if(y.viewport(0,0,y.canvas.width,y.canvas.height),this.drawFadeQuad(),!t||t.length===0)return;const x=this.frameIndexes[0]%t.length,S=t[x],A=d!==null?d:x/t.length,N=g!==null?g:performance.now();this.draw(S,l,this.showBeamEffect,this.beamAlpha,r,this.beamRenderMode,i,0,A,N,u,f,h,v,E),this.frameIndexes[0]++,this.frameIndexes[0]>=t.length&&(this.frameIndexes[0]=0)}renderWorld(t,r,i,l,u,f=null,h={low:0,mid:0,high:0}){const d=this.gl;d.viewport(0,0,d.canvas.width,d.canvas.height),this.drawFadeQuad();const g=f!==null?f:performance.now();t.forEach(v=>{if(v&&v.frames&&v.frames.length>0){const E=v.frames[0];if(E){const y=v.layerIndex||0;if(v.syncSettings,v.bpm,y>=this.frameIndexes.length){const A=y+5;for(;this.frameIndexes.length<A;)this.frameIndexes.push(0),this.pointIndexes.push(0)}const S=(i[y]!==void 0?i[y]:1)*l;if(S>.001){const A=v.progress!==void 0?v.progress:this.frameIndexes[y]%v.frames.length/v.frames.length,{syncSettings:N={},bpm:D=120,clipDuration:L=1,effectStates:M=null}=v;let C=E;if(u){let B=E;if(u.dimmer!==void 0&&u.dimmer<1){const V=E.points,te=E.isTypedArray||V instanceof Float32Array,de=te?V.length/8:V.length,ye=te?new Float32Array(V):V.map(pe=>({...pe}));for(let pe=0;pe<de;pe++)te?(ye[pe*8+3]*=u.dimmer,ye[pe*8+4]*=u.dimmer,ye[pe*8+5]*=u.dimmer):(ye[pe].r*=u.dimmer,ye[pe].g*=u.dimmer,ye[pe].b*=u.dimmer);B={...E,points:ye,isTypedArray:te}}C=yf(B,u)}this.draw(C,v.effects,this.showBeamEffect,this.beamAlpha,r,this.beamRenderMode,S,y,A,g,N,D,L,h,M)}}}}),t.forEach(v=>{if(v&&v.frames){const E=v.layerIndex||0;this.frameIndexes[E]++,this.frameIndexes[E]>=v.frames.length&&(this.frameIndexes[E]=0)}})}drawFadeQuad(){const t=this.gl;this.fadeProgram&&(t.useProgram(this.fadeProgram),t.bindBuffer(t.ARRAY_BUFFER,this.quadPositionBuffer),t.enableVertexAttribArray(this.fadePositionAttributeLocation),t.vertexAttribPointer(this.fadePositionAttributeLocation,2,t.FLOAT,!1,0,0),t.uniform4f(this.fadeColorUniformLocation,0,0,0,this.fadeAlpha),t.drawArrays(t.TRIANGLES,0,6))}setBeamEffect(t){this.showBeamEffect=t}setBeamAlpha(t){this.beamAlpha=t}setFadeAlpha(t){this.fadeAlpha=t}draw(t,r,i,l,u,f,h=1,d=0,g=0,v=performance.now(),E={},y=120,x=1,S={low:0,mid:0,high:0},A=null){if(this.gl,!t||!t.points)return;const N=Tl(t,r,{progress:g,time:v,syncSettings:E,bpm:y,clipDuration:x,fftLevels:S,effectStates:A}),D=N.points,L=N.isTypedArray,M=L?D.length/8:D.length;if(M===0)return;const C=Math.max(1,Math.floor(M/u));let B=this.pointIndexes[d]||0;B>=M&&(B=0);const V=pe=>{const q=(B+pe)%M;if(L){const j=q*8;return{x:D[j],y:D[j+1],r:D[j+3],g:D[j+4],b:D[j+5],blanking:D[j+6]===1}}else{const j=D[q];return{x:j.x,y:j.y,r:j.r,g:j.g,b:j.b,blanking:j.blanking}}},te=()=>{const pe=f==="points"||f==="both",q=f==="lines"||f==="both";let j=[],$=[];for(let W=0;W<C;W++){const J=V(W);if(J.blanking){j.length>0&&(q&&this._drawSegment(new Float32Array(j),new Float32Array($),1,j.length/2,!1),pe&&this._drawSegment(new Float32Array(j),new Float32Array($),1,j.length/2,!0),j=[],$=[]);continue}j.push(J.x,J.y),$.push(J.r/255*h,J.g/255*h,J.b/255*h)}j.length>0&&(q&&this._drawSegment(new Float32Array(j),new Float32Array($),1,j.length/2,!1),pe&&this._drawSegment(new Float32Array(j),new Float32Array($),1,j.length/2,!0))},de=()=>{const pe=[],q=[];for(let j=0;j<C;j++){const $=V(j);if(!$.blanking){pe.push(0,0,$.x,$.y);const W=[$.r/255*h,$.g/255*h,$.b/255*h];q.push(...W,...W)}}pe.length>0&&this._drawLines(new Float32Array(pe),new Float32Array(q),l,pe.length/2)},ye=()=>{const pe=[],q=[];let j=V(0);for(let $=1;$<C;$++){const W=V($);if(!j.blanking&&!W.blanking){pe.push(0,0,j.x,j.y,W.x,W.y);const J=[j.r/255*h,j.g/255*h,j.b/255*h],U=[W.r/255*h,W.g/255*h,W.b/255*h],G=[(J[0]+U[0])/2,(J[1]+U[1])/2,(J[2]+U[2])/2],X=.3,me=[J[0]*X,J[1]*X,J[2]*X],_=[U[0]*X,U[1]*X,U[2]*X];q.push(...G,...me,..._)}j=W}pe.length>0&&this._drawTriangles(new Float32Array(pe),new Float32Array(q),l,pe.length/2)};te(),i&&(f==="points"?de():f==="lines"?ye():f==="both"&&(ye(),de())),this.pointIndexes[d]=(B+C)%M}_drawSegment(t,r,i,l,u=!1){const f=this.gl;f.useProgram(this.program),f.bindBuffer(f.ARRAY_BUFFER,this.positionBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,t),f.enableVertexAttribArray(this.positionAttributeLocation),f.vertexAttribPointer(this.positionAttributeLocation,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,r),f.enableVertexAttribArray(this.colorAttributeLocation),f.vertexAttribPointer(this.colorAttributeLocation,3,f.FLOAT,!1,0,0),this.alphaBufferData.length<l&&(this.alphaBufferData=new Float32Array(l*2)),this.alphaBufferData.fill(i,0,l);const h=this.alphaBufferData.subarray(0,l);f.bindBuffer(f.ARRAY_BUFFER,this.alphaBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,h),f.enableVertexAttribArray(this.alphaAttributeLocation),f.vertexAttribPointer(this.alphaAttributeLocation,1,f.FLOAT,!1,0,0),f.drawArrays(u?f.POINTS:f.LINE_STRIP,0,l)}_drawLines(t,r,i,l){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,t),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,r),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0),this.alphaBufferData.length<l&&(this.alphaBufferData=new Float32Array(l*2)),this.alphaBufferData.fill(i,0,l);const f=this.alphaBufferData.subarray(0,l);u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.LINES,0,l)}_drawTriangles(t,r,i,l){const u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.positionBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,t),u.enableVertexAttribArray(this.positionAttributeLocation),u.vertexAttribPointer(this.positionAttributeLocation,2,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,this.colorBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,r),u.enableVertexAttribArray(this.colorAttributeLocation),u.vertexAttribPointer(this.colorAttributeLocation,3,u.FLOAT,!1,0,0),this.alphaBufferData.length<l&&(this.alphaBufferData=new Float32Array(l*2)),this.alphaBufferData.fill(i,0,l);const f=this.alphaBufferData.subarray(0,l);u.bindBuffer(u.ARRAY_BUFFER,this.alphaBuffer),u.bufferSubData(u.ARRAY_BUFFER,0,f),u.enableVertexAttribArray(this.alphaAttributeLocation),u.vertexAttribPointer(this.alphaAttributeLocation,1,u.FLOAT,!1,0,0),u.drawArrays(u.TRIANGLES,0,l)}clearCanvas(){const t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}destroy(){if(cancelAnimationFrame(this.animationFrameId),this.gl){const t=this.gl.getExtension("WEBGL_losing_context");t&&t.loseContext()}}}const am=({frame:a,effects:t,width:r=100,height:i=100})=>{const l=T.useRef(null),u=T.useRef(null),[f,h]=T.useState(null);return T.useEffect(()=>(l.current&&!u.current&&(u.current=new ry(l.current,"single")),()=>{u.current&&(u.current.destroy(),u.current=null)}),[]),T.useEffect(()=>{if(!a){h(null);return}let d=a;if(t&&t.length>0){const g=a.points,v=a.isTypedArray||g instanceof Float32Array;let E;v?E=new Float32Array(g):E=g.map(x=>({...x}));const y={...a,points:E,isTypedArray:v};d=Tl(y,t,{time:performance.now(),progress:0,effectStates:new Map})}h(d)},[a,t]),T.useEffect(()=>{u.current&&f?u.current.render({ildaFrames:[f],previewScanRate:1,intensity:1,effects:[],syncSettings:{}}):u.current&&u.current.clearCanvas()},[f]),m.jsx("div",{className:"clip-thumbnail",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"black"},children:m.jsx("canvas",{ref:l,width:r,height:i,style:{width:"100%",height:"100%",backgroundColor:"black"}})})},iy=({frame:a,width:t=50,height:r=50})=>{const i=T.useRef(null);return T.useEffect(()=>{const l=i.current;if(!l||!a||!a.points)return;const u=l.getContext("2d");u.fillStyle="#000000",u.fillRect(0,0,t,r);const f=a.points,h=a.isTypedArray||f instanceof Float32Array,d=h?f.length/8:f.length;u.lineWidth=1.5,u.lineCap="round";let g=null,v=null;for(let E=0;E<d;E++){let y,x,S,A,N,D;if(h)y=f[E*8],x=f[E*8+1],S=f[E*8+3],A=f[E*8+4],N=f[E*8+5],D=f[E*8+6]>.5;else{const C=f[E];y=C.x,x=C.y,S=C.r,A=C.g,N=C.b,D=C.blanking}const L=(y+1)*.5*t,M=(1-(x+1)*.5)*r;if(D){g=null,v=null;continue}else if(g!==null){u.beginPath(),u.moveTo(g,v),u.lineTo(L,M);const C=Math.floor(Math.max(0,Math.min(1,S))*255),B=Math.floor(Math.max(0,Math.min(1,A))*255),V=Math.floor(Math.max(0,Math.min(1,N))*255);u.strokeStyle=`rgb(${C},${B},${V})`,u.stroke()}g=L,v=M}},[a,t,r]),m.jsx("canvas",{ref:i,width:t,height:r,style:{width:"100%",height:"100%",backgroundColor:"black",display:"block",borderRadius:"5px"}})},Of=_n.memo(iy),sy=({layerName:a,index:t,onDropEffect:r,onDropDac:i,layerEffects:l,activeClipData:u,onDeactivateLayerClips:f,onShowLayerFullContextMenu:h,thumbnailRenderMode:d,intensity:g,onIntensityChange:v,liveFrame:E,isBlackout:y,isSolo:x,onToggleBlackout:S,onToggleSolo:A,onLayerSelect:N})=>{const[D,L]=T.useState(l||[]),[M,C]=T.useState(!1),[B,V]=T.useState(!1);T.useEffect(()=>{L(l||[])},[l]);const te=T.useMemo(()=>[...u?.effects||[],...l||[]],[u?.effects,l]),de=(W,J,U,G,X)=>{W.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:J,paramName:U,targetType:G,layerIndex:t,label:X}))},ye=W=>{W.preventDefault(),console.log(`Right-clicked LayerControls at index: ${t}`),h&&h(t)},pe=W=>{W.preventDefault(),W.stopPropagation(),C(!0),W.dataTransfer.dropEffect="copy"},q=W=>{W.preventDefault(),W.stopPropagation(),C(!1)},j=W=>{W.preventDefault(),W.stopPropagation(),C(!1);const J=W.dataTransfer.getData("application/json");if(J)try{const G=JSON.parse(J);if(G.type==="transform"||G.type==="animation"||G.type==="color"||G.type==="effect"){if(r){r(G.id||G.name);return}}else if(G.ip&&(typeof G.channel=="number"||G.allChannels)&&i){i(t,G);return}}catch(G){console.error("Error parsing drop data in LayerControls:",G)}const U=W.dataTransfer.getData("text/plain");if(U.startsWith("effect_")){const G=U.replace("effect_","");r&&r(G)}},$=d==="active"||d==="hover"&&B;return m.jsxs("div",{className:`layer-controls ${M?"dragging":""}`,onContextMenu:ye,onDragOver:pe,onDragLeave:q,onDrop:j,children:[m.jsxs("div",{className:"grid-layer",children:[m.jsx(Nt,{id:`layer_${t}_clear`,children:m.jsx("span",{className:"layer-control-button full-height",onClick:()=>f(t),draggable:!0,onDragStart:W=>de(W,"toggle","clear","layer",`L${t+1} Clear`),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})})}),m.jsxs("div",{className:"layer-control-group",children:[m.jsx(Nt,{id:`layer_${t}_blackout`,children:m.jsx("span",{className:"layer-control-button half-height",onClick:S,style:{backgroundColor:y?"red":""},draggable:!0,onDragStart:W=>de(W,"toggle","blackout","layer",`L${t+1} Blackout`),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye-slash-fill",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx(Nt,{id:`layer_${t}_solo`,children:m.jsx("span",{className:"layer-control-button half-height",onClick:A,style:{backgroundColor:x?"var(--theme-color)":"",color:x?"black":""},draggable:!0,onDragStart:W=>de(W,"toggle","solo","layer",`L${t+1} Solo`),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-1-square",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z"}),m.jsx("path",{d:"M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"})]})})})]}),m.jsxs("select",{className:"layer-blend-dropdown",children:[m.jsx("option",{children:"Normal"}),m.jsx("option",{children:"Add"}),m.jsx("option",{children:"Subtract"})]})]}),m.jsx("div",{className:"layer-control-row",children:m.jsx(Nt,{id:`layer_${t}_intensity`,children:m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:g,className:"slider_ver",id:"layer-intensity-slider",onChange:W=>v(parseFloat(W.target.value))})})}),m.jsx("div",{className:"layer-preview-thumbnail",onMouseEnter:()=>V(!0),onMouseLeave:()=>V(!1),style:{overflow:"hidden"},children:u?$?m.jsx(am,{frame:E||u.stillFrame,effects:te}):u.thumbnailPath?m.jsx("img",{src:`file://${u.thumbnailPath}?t=${u.thumbnailVersion||Date.now()}`,alt:"layer-thumbnail",style:{width:"100%",height:"100%",objectFit:"contain"}}):m.jsx(Of,{frame:u.stillFrame}):D.length>0&&m.jsx("div",{className:"applied-effects",children:D.map((W,J)=>m.jsx("span",{className:"effect-tag",children:(W.name||W.id||"???").substring(0,3).toUpperCase()},W.instanceId||J))})}),m.jsx("span",{className:"layer-name-label",onClick:()=>N&&N(t),children:a})]})},ly=({clipName:a,layerIndex:t,colIndex:r,onDropGenerator:i,onDropEffect:l,clipContent:u,thumbnailFrameIndex:f,onUnsupportedFile:h,onActivateClick:d,onLabelClick:g,isSelected:v,isActive:E,ildaParserWorker:y,onDropDac:x,thumbnailRenderMode:S,liveFrame:A,stillFrame:N,onClipHover:D,onThumbnailError:L})=>{const[M,C]=T.useState(!1),[B,V]=T.useState(!1),te=a,de=S==="active"||S==="hover"&&M,ye=X=>{X.preventDefault(),X.stopPropagation(),V(!0),X.dataTransfer.dropEffect="copy"},pe=X=>{X.preventDefault(),X.stopPropagation(),X.currentTarget.contains(X.relatedTarget)||V(!1)},q=()=>{C(!0),D&&D(t,r,!0)},j=()=>{C(!1),d(!1),D&&D(t,r,!1)},$=async X=>{const me=X.name;if(!y){h("ILDA parser not available.");return}if(me.toLowerCase().endsWith(".ild"))try{const _=await X.arrayBuffer();console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFileDrop): ${_.byteLength}`),y.postMessage({type:"parse-ilda",arrayBuffer:_,fileName:me,filePath:X.path,layerIndex:t,colIndex:r},[_])}catch(_){console.error("[Clip.jsx] handleFileDrop - Error reading file:",_),h(`Error reading file: ${_.message}`)}else h("Please drop a valid .ild file")},W=async(X,me)=>{if(!me.toLowerCase().endsWith(".ild")){console.log("Unsupported file type:",me),h("Please drop a valid .ild file");return}if(!y){h("ILDA parser not available.");return}try{if(window.electronAPI&&window.electronAPI.readFileAsBinary){const z=(await window.electronAPI.readFileAsBinary(X)).slice().buffer;console.log(`[Clip.jsx] ArrayBuffer byteLength before posting to worker (handleFilePathDrop): ${z.byteLength}`),y.postMessage({type:"parse-ilda",arrayBuffer:z,fileName:me,filePath:X,layerIndex:t,colIndex:r},[z])}else h("Binary file access not available")}catch(_){console.error("Error processing file path:",_),console.error("Error stack:",_.stack),h(`Error processing file: ${_.message}`)}},J=X=>{X.preventDefault(),X.stopPropagation(),V(!1);const me=X.dataTransfer.getData("application/json");if(me)try{const z=JSON.parse(me);if(z.filePath&&z.fileName){W(z.filePath,z.fileName);return}if(z.type==="transform"||z.type==="animation"||z.type==="color"||z.type==="effect"){if(l){l(z),g();return}}else if(z.ip&&(typeof z.channel=="number"||z.allChannels)){if(x){x(t,r,z);return}}else if(z.name&&i){i(t,r,z);return}}catch(z){console.error("Error parsing dropped data:",z)}const _=X.dataTransfer.files;if(_&&_.length>0){$(_[0]);return}console.log("No recognized data format found in drop"),h("No valid ILD file, effect, or generator dropped.")},U=X=>{X.preventDefault(),X.stopPropagation()},G=X=>{X.preventDefault(),window.electronAPI&&window.electronAPI.showClipContextMenu&&window.electronAPI.showClipContextMenu(t,r,u?.triggerStyle||"normal")};return m.jsxs("div",{className:`clip ${B?"dragging":""} ${E?"active-clip":""} `,onDragEnter:U,onDragOver:ye,onDragLeave:pe,onDrop:J,onContextMenu:G,children:[m.jsx(Nt,{id:`clip_${t}_${r}`,children:m.jsx("div",{className:"clip-thumbnail",onMouseDown:X=>{X.button===0&&d(!0)},onMouseUp:X=>{X.button===0&&d(!1)},onMouseEnter:q,onMouseLeave:j,style:{overflow:"hidden"},children:u&&u.parsing?m.jsx("div",{className:"clip-loading-spinner"}):m.jsxs(m.Fragment,{children:[de&&u?m.jsx(am,{frame:A||N,effects:u?.effects}):u?.thumbnailPath?m.jsx("img",{src:`file://${u.thumbnailPath}?t=${u.thumbnailVersion||Date.now()}`,alt:"thumbnail",onError:()=>L&&L(t,r),style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}):N&&m.jsx(Of,{frame:N}),u?.triggerStyle&&u.triggerStyle!=="normal"&&m.jsxs("p",{className:"clip_icons",children:[u.triggerStyle==="toggle"&&m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-toggles",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M4.5 9a3.5 3.5 0 1 0 0 7h7a3.5 3.5 0 1 0 0-7zm7 6a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m-7-14a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5m2.45 0A3.5 3.5 0 0 1 8 3.5 3.5 3.5 0 0 1 6.95 6h4.55a2.5 2.5 0 0 0 0-5zM4.5 0h7a3.5 3.5 0 1 1 0 7h-7a3.5 3.5 0 1 1 0-7"})}),u.triggerStyle==="flash"&&m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-lightning-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641z"})})]})]})})}),m.jsx(Nt,{id:`clip_${t}_${r}_preview`,children:m.jsx("span",{className:`clip-label ${v?"selected-clip":""}`,onClick:g,children:te})})]})},oy=_n.memo(ly),rm=T.createContext(null),im=()=>T.useContext(rm),uy=({children:a})=>{const[t,r]=T.useState(null);return T.useEffect(()=>{if(!t){const i=new Worker(new URL(""+new URL("ilda-parser.worker-CqOHicn0.js",import.meta.url).href,import.meta.url));r(i)}return()=>{t&&t.terminate()}},[t]),m.jsx(rm.Provider,{value:t,children:a})},cy=({onDropIld:a})=>{const[t,r]=T.useState(""),[i,l]=T.useState([]),[u,f]=T.useState("list"),[h,d]=T.useState({}),g=im(),v=T.useRef(new Set);T.useEffect(()=>{if(!g)return;const y=x=>{x.data.browserFile&&(x.data.type==="parse-ilda"&&x.data.success?g.postMessage({type:"get-frame",workerId:x.data.workerId,frameIndex:0,browserFile:!0,filePath:x.data.filePath}):x.data.type==="get-frame"&&x.data.success&&d(S=>({...S,[x.data.filePath]:x.data.frame})))};return g.addEventListener("message",y),()=>g.removeEventListener("message",y)},[g]),T.useEffect(()=>{u==="thumbnails"&&i.length>0&&g&&i.forEach(y=>{if(!h[y]&&!v.current.has(y)){v.current.add(y);const x=y.split(/[/\\]/).pop();g.postMessage({type:"load-and-parse-ilda",fileName:x,filePath:y,browserFile:!0})}})},[u,i,g,h]),T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getUserIldaPath){const x=await window.electronAPI.getUserIldaPath();if(x){r(x);const S=await window.electronAPI.readIldFiles(x);l(S),v.current.clear(),d({})}}})()},[]);const E=async()=>{if(window.electronAPI){const y=await window.electronAPI.openFileExplorer();if(y){r(y);const x=await window.electronAPI.readIldFiles(y);l(x),v.current.clear(),d({})}}};return m.jsxs("div",{className:"file-browser",children:[m.jsx("button",{onClick:E,children:"Open Folder"}),m.jsxs("div",{className:"list_switcher",children:[m.jsx("button",{className:u==="list"?"active":"",onClick:()=>f("list"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",fill:"currentColor",className:"bi bi-list",viewBox:"0 0 16 16",children:m.jsx("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"})})}),m.jsx("button",{className:u==="thumbnails"?"active":"",onClick:()=>f("thumbnails"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",fill:"currentColor",className:"bi bi-image",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}),m.jsx("path",{d:"M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"})]})})]}),t&&m.jsxs("p",{className:"fileBrowser",children:["Selected Directory: ",t.split(/[/\\]/).filter(Boolean).pop()]}),m.jsx("div",{className:"ild-file-grid",style:{display:u==="thumbnails"?null:"none"},children:i.length>0?i.map((y,x)=>{const S=y.split(/[/\\]/).pop(),A=h[y];return m.jsxs("div",{className:"ild-file-preview",draggable:!0,onDragStart:N=>N.dataTransfer.setData("application/json",JSON.stringify({filePath:y,fileName:S})),children:[m.jsx("div",{className:"file_thumbnail",children:A?m.jsx(Of,{frame:A}):m.jsx("div",{className:"clip-loading-spinner"})}),m.jsx("div",{className:"file_name",children:S})]},x)}):m.jsx("p",{children:"No ILD files found in selected directory."})}),m.jsx("div",{className:"ild-file-list",style:{display:u==="list"?null:"none"},children:i.length>0?i.map((y,x)=>{const S=y.split(/[/\\]/).pop();return m.jsx("div",{className:"ild-file-item",draggable:!0,onDragStart:A=>A.dataTransfer.setData("application/json",JSON.stringify({filePath:y,fileName:S})),children:S},x)}):m.jsx("p",{children:"No ILD files found in selected directory."})})]})},bf=[{id:"circle",name:"Circle",description:"Generates a simple circle.",defaultParams:{radius:.5,numPoints:100,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"radius",label:"Radius",type:"range",min:.01,max:1,step:.01},{id:"numPoints",label:"Number of Points",type:"range",min:3,max:360,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"square",name:"Square",description:"Generates a simple square.",defaultParams:{width:1,height:1,pointDensity:25,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"width",label:"Width",type:"range",min:.01,max:2,step:.01},{id:"height",label:"Height",type:"range",min:.01,max:2,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:100,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"line",name:"Line",description:"Generates a straight line.",defaultParams:{x1:-.5,y1:0,x2:.5,y2:0,pointDensity:50,r:255,g:255,b:255},paramControls:[{id:"x1",label:"X1",type:"range",min:-1,max:1,step:.01},{id:"y1",label:"Y1",type:"range",min:-1,max:1,step:.01},{id:"x2",label:"X2",type:"range",min:-1,max:1,step:.01},{id:"y2",label:"Y2",type:"range",min:-1,max:1,step:.01},{id:"pointDensity",label:"Point Density",type:"range",min:2,max:200,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"text",name:"Text",description:"Generates text.",defaultParams:{text:"TrueLazer",x:0,y:.3,fontSize:72,numPoints:200,fontUrl:"src/fonts/Geometr415 Blk BT Black.ttf",r:255,g:255,b:255},paramControls:[{id:"text",label:"Text Content",type:"text"},{id:"fontUrl",label:"Fonts",type:"text"},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"fontSize",label:"Font Size",type:"range",min:10,max:200,step:1},{id:"numPoints",label:"Target Points",type:"range",min:10,max:1e3,step:1},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"star",name:"Star",description:"Generates a star shape.",defaultParams:{outerRadius:.5,innerRadius:.2,numSpikes:5,pointDensity:10,x:0,y:0,r:255,g:255,b:255},paramControls:[{id:"outerRadius",label:"Outer Radius",type:"range",min:.01,max:1,step:.01},{id:"innerRadius",label:"Inner Radius",type:"range",min:.01,max:1,step:.01},{id:"numSpikes",label:"Number of Spikes",type:"range",min:3,max:20,step:1},{id:"pointDensity",label:"Point Density",type:"range",min:1,max:50,step:1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"ndi-source",name:"NDI Source",description:"Placeholder for NDI Video Input.",defaultParams:{sourceName:"No Source",threshold:128,edgeDetection:!1,captureWidth:1280,captureHeight:720,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Source Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"captureWidth",label:"Capture Width",type:"range",min:64,max:1280,step:8},{id:"captureHeight",label:"Capture Height",type:"range",min:64,max:720,step:8},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]},{id:"spout-receiver",name:"Spout Receiver",description:"Placeholder for Spout Video Input.",defaultParams:{sourceName:"Spout Input",threshold:128,edgeDetection:!1,x:0,y:0,scale:1,r:255,g:255,b:255},paramControls:[{id:"sourceName",label:"Sender Name",type:"text"},{id:"threshold",label:"Threshold",type:"range",min:0,max:255,step:1},{id:"edgeDetection",label:"Edge Detection",type:"checkbox"},{id:"scale",label:"Scale",type:"range",min:.1,max:2,step:.1},{id:"x",label:"X Position",type:"range",min:-1,max:1,step:.01},{id:"y",label:"Y Position",type:"range",min:-1,max:1,step:.01},{id:"r",label:"Red",type:"range",min:0,max:255,step:1},{id:"g",label:"Green",type:"range",min:0,max:255,step:1},{id:"b",label:"Blue",type:"range",min:0,max:255,step:1}]}],fy=()=>{const[a,t]=T.useState([]);T.useEffect(()=>{const l=async()=>{if(window.electronAPI&&window.electronAPI.ndiFindSources){const f=await window.electronAPI.ndiFindSources();t(f||[])}};l();const u=setInterval(l,5e3);return()=>clearInterval(u)},[]);const r=(l,u)=>{l.dataTransfer.setData("application/json",JSON.stringify(u))},i=(l,u)=>{const f=bf.find(d=>d.id==="ndi-source"),h={...f,defaultParams:{...f.defaultParams,sourceName:u.name}};l.dataTransfer.setData("application/json",JSON.stringify(h))};return m.jsxs("div",{className:"generator-panel",children:[m.jsx("div",{className:"generator-list",children:bf.filter(l=>l.id!=="ndi-source"&&l.id!=="spout-receiver").map(l=>m.jsx("div",{className:"generator-item",draggable:!0,onDragStart:u=>r(u,l),children:l.name},l.id))}),m.jsx("h3",{style:{marginTop:"10px"},children:"NDI Sources"}),m.jsx("div",{className:"generator-list",children:a.length>0?a.map((l,u)=>m.jsx("div",{className:"generator-item ndi-item",draggable:!0,onDragStart:f=>i(f,l),children:l.name},`${l.name}-${u}`)):m.jsx("div",{className:"empty-msg",children:"No NDI sources found"})})]})},dy=()=>{const a=(t,r)=>{t.dataTransfer.setData("application/json",JSON.stringify(r))};return m.jsx("div",{className:"effect-panel",children:Al.map(t=>m.jsx("div",{draggable:!0,onDragStart:r=>a(r,t),className:"effect-item",children:t.name},t.id))})},Mi=({value:a,onChange:t,label:r,onDrop:i,size:l=40,isAssigned:u,className:f,...h})=>{const d=T.useRef(null),g=x=>{i&&(x.preventDefault(),x.dataTransfer.dropEffect="link")},v=x=>{if(i){x.preventDefault();try{const S=x.dataTransfer.getData("application/x-truelazer-param");console.log("[RadialKnob] Dropped Data Raw:",S);const A=JSON.parse(S);console.log("[RadialKnob] Dropped Data Parsed:",A),A&&(A.type==="range"||A.type==="number")?i(A):console.warn("[RadialKnob] Invalid data type for knob:",A?.type)}catch(S){console.error("[RadialKnob] Drop Error:",S)}}},E=-135+a*270,y=x=>{if(!u)return;x.preventDefault();const S=x.clientY,A=a,N=L=>{const C=(S-L.clientY)/200;let B=Math.max(0,Math.min(1,A+C));t(B)},D=()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",D)};window.addEventListener("mousemove",N),window.addEventListener("mouseup",D)};return T.useEffect(()=>{const x=d.current;if(!x)return;const S=A=>{if(!u)return;A.preventDefault(),A.stopPropagation();const N=A.deltaY*-.001;let D=Math.max(0,Math.min(1,a+N));t(D)};return x.addEventListener("wheel",S,{passive:!1}),()=>{x.removeEventListener("wheel",S)}},[a,t,u]),m.jsxs("div",{className:`quick-assign-knob ${u?"":"unassigned"} ${f||""}`.trim(),ref:d,style:{cursor:u?"ns-resize":"default",userSelect:"none",opacity:u?1:.5},onDragOver:g,onDrop:v,onMouseDown:y,...h,children:[m.jsx("div",{className:"knob-label",title:r,children:r}),m.jsx("div",{className:"knob-circle",children:m.jsx("div",{className:"knob-indicator",style:{transform:`rotate(${E}deg)`}})}),m.jsxs("div",{className:"knob-value",style:{fontSize:"9px",color:"#888",marginTop:"2px"},children:[Math.round(a*100),"%"]})]})},py=({dacs:a=[],onDacSelected:t,onDacsDiscovered:r,dacSettings:i={},onUpdateDacSettings:l})=>{const[u,f]=T.useState(!1),[h,d]=T.useState(null),[g,v]=T.useState([]),[E,y]=T.useState(null),x=_n.useRef(!1);T.useEffect(()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(L=>{v(L),L.length>0&&y(L[0])})},[]),T.useEffect(()=>{u&&!x.current&&(x.current=!0,console.log("Starting DAC scan on:",E?.address),window.electronAPI?window.electronAPI.discoverDacs(2e3,E?.address).then(async L=>{console.log("DACs discovered:",L);const M=await Promise.all(L.map(async C=>{try{const B=await window.electronAPI.getDacServices(C.ip,E?.address,C.type),V=C.type&&C.type.toLowerCase()==="etherdream"?B:B.filter(te=>te.serviceID!==0);return{...C,channels:V}}catch(B){return console.error(`Error fetching services for DAC ${C.ip}:`,B),{...C,channels:[]}}}));r&&r(M)}).catch(L=>{console.error("Error discovering DACs:",L)}).finally(()=>{f(!1),x.current=!1}):(console.warn("electronAPI is not available. Cannot discover DACs."),f(!1),x.current=!1))},[u,E,r]);const S=(L,M)=>{const C={...L,channel:M};d(C),t&&t(C)},A=(L,M,C)=>{L.stopPropagation();const B={...M,channel:C};L.dataTransfer.setData("application/json",JSON.stringify(B))},N=L=>{const M=L.target.value,C=g.find(B=>B.address===M);y(C)},D=(L,M)=>{L.stopPropagation();const C={...M,allChannels:!0};L.dataTransfer.setData("application/json",JSON.stringify(C))};return m.jsxs("div",{className:"dac-panel",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"DACs"})}),m.jsxs("div",{className:"network-interface-selector",style:{display:"flex",gap:5,padding:"5px 10px"},children:[m.jsxs("div",{style:{flex:1,display:"flex"},children:[m.jsx("select",{onChange:N,value:E?.address||"",style:{width:"100%",height:"100%",background:"#2a2a2a",color:"#aaa",borderRadius:"5px",cursor:"pointer",marginBottom:2},children:g.map(L=>m.jsxs("option",{value:L.address,children:[L.name," (",L.address,")"]},L.address))}),m.jsx("button",{onClick:()=>{window.electronAPI&&window.electronAPI.getNetworkInterfaces().then(L=>{v(L),L.length>0&&!E&&y(L[0])})},style:{fontSize:"9px",padding:"2px",background:"#333",border:"1px solid #555",color:"#ccc",cursor:"pointer",borderRadius:"5px"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[m.jsx("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),m.jsx("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"})]})})]}),m.jsx("label",{style:{display:"flex",alignItems:"center",fontSize:"10px"},children:m.jsx("input",{type:"checkbox",checked:u,onChange:L=>f(L.target.checked),disabled:u,style:{height:"100%"}})})]}),m.jsx("div",{className:"dac-list",children:a.map(L=>m.jsxs("div",{className:"dac-group",draggable:!0,onDragStart:M=>D(M,L),children:[m.jsxs("div",{className:"dac-ip",children:[L.hostName||L.ip," (",L.ip,")"]}),m.jsx("div",{className:"dac-channels",children:L.channels&&L.channels.length>0?L.channels.map(M=>m.jsxs("div",{className:`dac-channel-item ${h&&(h.unitID===L.unitID||h.ip===L.ip)&&h.channel===M.serviceID?"selected":""}`,onClick:()=>S(L,M.serviceID),draggable:!0,onDragStart:C=>A(C,L,M.serviceID),children:["Channel ",M.serviceID," (",M.name,")"]},`${L.unitID||L.ip}-${M.serviceID}`)):m.jsx("div",{className:"dac-channel-item no-channels",children:"No channels found"})})]},L.unitID||L.ip))}),a.length>0&&m.jsxs("div",{className:"dac-dimmers-section",children:[m.jsx("h4",{children:"Channel Dimmers"}),m.jsx("div",{className:"dac-dimmers-grid",children:a.flatMap(L=>(L.channels||[]).map(M=>({dac:L,ch:M}))).map(({dac:L,ch:M})=>{const C=`${L.ip}:${M.serviceID}`,B=i[C]||{},V=B.dimmer!==void 0?B.dimmer:1;return m.jsx(Nt,{id:`dimmer_${C.replace(/\./g,"_")}`,children:m.jsx(Mi,{label:`${L.hostName||L.ip} Ch${M.serviceID}`,value:V,onChange:te=>{l&&l(C,{...B,dimmer:te})}})},`dimmer_${C}`)})})]})]})},sm=({min:a,max:t,step:r,value:i,rangeValue:l,onChange:u,onRangeChange:f,showRange:h=!1,disabled:d=!1,animSettings:g,progressRef:v,workerId:E,clipDuration:y,bpm:x,getFftLevels:S})=>{const A=T.useRef(null),N=T.useRef(null),D=T.useRef(null),[L,M]=T.useState(null),C=a!==void 0?a:0,B=t!==void 0?t:1,V=l&&l[0]!==void 0?l[0]:C,te=l&&l[1]!==void 0?l[1]:B,de=i!==void 0?i:C,ye=q=>{const j=B-C;return j===0?0:(q-C)/j*100};T.useEffect(()=>{let q;const j=()=>{if(L==="value"){q=requestAnimationFrame(j);return}let $=de;if(g&&g.syncMode&&v&&v.current){const U={progress:E&&v.current[E]!==void 0?v.current[E]:0,time:performance.now(),clipDuration:y||1,bpm:x||120,fftLevels:S?S():{low:0,mid:0,high:0}};$=tm(null,de,g,U)}const W=ye($);N.current&&(N.current.style.left=`${W}%`),D.current&&(D.current.style.width=`${W}%`),q=requestAnimationFrame(j)};return q=requestAnimationFrame(j),()=>cancelAnimationFrame(q)},[g,v,E,de,L,C,B,x,S,y]);const pe=(q,j)=>{if(d)return;q.preventDefault(),q.stopPropagation(),M(j);const $=J=>{if(!A.current)return;const U=A.current.getBoundingClientRect(),G=J.clientX-U.left;let X=Math.max(0,Math.min(100,G/U.width*100)),me=C+X/100*(B-C);r&&(me=Math.round(me/r)*r,X=(me-C)/(B-C)*100),j==="value"?(me=Math.max(V,Math.min(te,me)),N.current&&(N.current.style.left=`${ye(me)}%`),D.current&&!h&&(D.current.style.width=`${ye(me)}%`),u&&u(me)):j==="min"?(me=Math.max(C,Math.min(te,me)),f&&f([me,te])):j==="max"&&(me=Math.max(V,Math.min(B,me)),f&&f([V,me]))},W=()=>{M(null),window.removeEventListener("mousemove",$),window.removeEventListener("mouseup",W)};window.addEventListener("mousemove",$),window.addEventListener("mouseup",W)};return m.jsx("div",{className:"range-slider-container",style:{position:"relative",width:"100%",height:"20px",display:"flex",alignItems:"center"},children:m.jsxs("div",{className:"range-slider-track",ref:A,style:{width:"100%",height:"4px",background:"#444",borderRadius:"2px",position:"relative"},children:[h&&m.jsx("div",{className:"range-slider-fill",style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:`${ye(V)}%`,width:`${ye(te)-ye(V)}%`}}),!h&&m.jsx("div",{className:"value-slider-fill",ref:D,style:{position:"absolute",height:"100%",background:"var(--theme-color-transparent)",left:"0%",borderRadius:"2px"}}),h&&m.jsx("div",{className:"range-slider-handle min-handle",style:{left:`${ye(V)}%`},onMouseDown:q=>pe(q,"min"),title:`Min: ${V.toFixed(2)}`}),h&&m.jsx("div",{className:"range-slider-handle max-handle",style:{left:`${ye(te)}%`},onMouseDown:q=>pe(q,"max"),title:`Max: ${te.toFixed(2)}`}),m.jsx("div",{className:"range-slider-handle value-handle",ref:N,style:{position:"absolute",width:"6px",height:"16px",top:"-50%",transform:"translate(-50%, -25%)",cursor:"pointer",zIndex:20,boxShadow:"0 0 2px rgba(0,0,0,0.5)"},onMouseDown:q=>pe(q,"value"),title:`Value: ${de.toFixed(2)}`})]})})},wn=({title:a,children:t,icon:r,defaultCollapsed:i=!1,headerActions:l})=>{const[u,f]=T.useState(i);return m.jsxs("div",{className:`settings-card ${u?"collapsed":""}`,children:[m.jsxs("div",{className:"settings-card-header",onClick:()=>f(!u),style:{userSelect:"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",cursor:"pointer"},children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",style:{transform:u?"rotate(0deg)":"rotate(90deg)",transition:"transform 0.2s"},children:m.jsx("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"})}),r&&m.jsx("span",{className:`bi ${r}`}),m.jsx("h4",{children:a})]}),l&&m.jsx("div",{onClick:h=>h.stopPropagation(),children:l})]}),!u&&m.jsx("div",{className:"settings-card-content",children:t})]})},lm=({animSettings:a,onChange:t})=>{const{direction:r="forward",style:i="loop",syncMode:l=null,duration:u=1,beats:f=8,speedMultiplier:h=1}=a||{},d=(v,E)=>t({...a,[v]:E}),g=(v,E,y=!1)=>{let S=a?.[v]||(v==="beats"?8:1);y?S=E>1?S*2:S/2:S+=E,S<.01&&(S=.01),!y&&v!=="beats"&&(S=Math.round(S*100)/100),d(v,S)};return m.jsxs("div",{className:"anim-controls-container",children:[m.jsxs("div",{className:"anim-row controls-row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"5px"},children:[m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${r==="backward"?"active":""}`,onClick:()=>d("direction","backward"),title:"Backward",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",transform:"scale(-1 1)",children:m.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})}),m.jsx("button",{className:`speed-control-button ${r==="pause"?"active":""}`,onClick:()=>d("direction","pause"),title:"Pause",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"25",height:"20",viewBox:"0 0 16 16",className:"icon flat-color",children:m.jsx("path",{d:"M3 1h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m7 0h3c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1m0 0"})})}),m.jsx("button",{className:`speed-control-button ${r==="forward"?"active":""}`,onClick:()=>d("direction","forward"),title:"Forward",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsx("svg",{width:"30",height:"20",viewBox:"0 0 24 24","data-name":"Flat Color",className:"icon flat-color",children:m.jsx("path",{d:"M17 2a1 1 0 0 0-1 1v7.08l-8.43-5.9a1 1 0 0 0-1-.07A1 1 0 0 0 6 5v14a1 1 0 0 0 .54.89A1 1 0 0 0 7 20a1 1 0 0 0 .57-.18l8.43-5.9V21a1 1 0 0 0 2 0V3a1 1 0 0 0-1-1",stroke:"black"})})})]}),m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${i==="once"?"active":""}`,onClick:()=>d("style","once"),title:"Once",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M43.8233 25.2305C43.7019 25.9889 43.5195 26.727 43.2814 27.4395 42.763 28.9914 41.9801 30.4222 40.9863 31.6785 38.4222 34.9201 34.454 37 30 37H16C9.39697 37 4 31.6785 4 25 4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M24 19V31",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M24 19 21 22 19.5 23.5",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),m.jsx("button",{className:`speed-control-button ${i==="bounce"?"active":""}`,onClick:()=>d("style","bounce"),title:"Bounce",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M42 19H5.99998",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M30 7 42 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M6.79897 29H42.799",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M6.79895 29 18.799 41",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),m.jsx("button",{className:`speed-control-button ${i==="loop"?"active":""}`,onClick:()=>d("style","loop"),title:"Loop",style:{flex:1,padding:0,fontSize:"10px"},children:m.jsxs("svg",{width:"30",height:"20",viewBox:"0 0 48 48",fill:"none",className:"icon two-color",children:[m.jsx("path",{d:"M4 25C4 18.3502 9.39624 13 16 13L44 13",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M38 7 44 13 38 19",stroke:"black",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M44 23C44 29.6498 38.6038 35 32 35H4",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M10 41 4 35 10 29",stroke:"var(--theme-color)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),m.jsxs("div",{className:"btn-group",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:`speed-control-button ${l==="fps"?"active":""}`,onClick:()=>d("syncMode",l==="fps"?null:"fps"),style:{flex:1,padding:0,fontSize:"10px"},children:"F"}),m.jsx("button",{className:`speed-control-button ${l==="timeline"?"active":""}`,onClick:()=>d("syncMode",l==="timeline"?null:"timeline"),style:{flex:1,padding:0,fontSize:"10px"},children:"T"}),m.jsx("button",{className:`speed-control-button ${l==="bpm"?"active":""}`,onClick:()=>d("syncMode",l==="bpm"?null:"bpm"),style:{flex:1,padding:0,fontSize:"10px"},children:"B"}),m.jsx("button",{className:`speed-control-button ${l==="fft"?"active":""}`,onClick:()=>d("syncMode",l==="fft"?null:"fft"),style:{flex:1,padding:0,fontSize:"10px"},children:"FFT"})]})]}),l==="fft"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Range"}),m.jsxs("select",{value:a?.fftRange||"low",onChange:v=>d("fftRange",v.target.value),style:{fontSize:"10px",background:"#333",border:"1px solid #555",color:"white"},children:[m.jsx("option",{value:"low",children:"Low"}),m.jsx("option",{value:"mid",children:"Mid"}),m.jsx("option",{value:"high",children:"High"})]})]})}),l==="timeline"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Duration (s)"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",-1),children:"-1"}),m.jsx("input",{type:"number",value:typeof u=="number"?u.toFixed(2):u,onChange:v=>d("duration",parseFloat(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",1),children:"+1"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",.5,!0),children:"/2"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("duration",2,!0),children:"*2"})]})]})}),l==="bpm"&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Beats"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",-1),children:"-1"}),m.jsx("input",{type:"number",value:f,onChange:v=>d("beats",parseInt(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",1),children:"+1"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",.5,!0),children:"/2"}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("beats",2,!0),children:"*2"})]})]})}),(l==="timeline"||l==="bpm"||l==="fps")&&m.jsx("div",{className:"anim-sub-settings",style:{marginTop:"5px",padding:"2px",background:"rgba(0,0,0,0.2)"},children:m.jsxs("div",{className:"control-group",style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"10px"},children:[m.jsx("label",{style:{color:"#aaa",marginRight:"5px"},children:"Speed"}),m.jsxs("div",{className:"value-adjuster",style:{display:"flex",gap:"2px"},children:[m.jsx("button",{className:"tiny-btn",onClick:()=>g("speedMultiplier",-.1),children:"-0.1"}),m.jsx("input",{type:"number",value:typeof h=="number"?h.toFixed(2):h,onChange:v=>d("speedMultiplier",parseFloat(v.target.value)||1),style:{width:"40px",fontSize:"10px",textAlign:"center",background:"#333",border:"1px solid #555",color:"white"}}),m.jsx("button",{className:"tiny-btn",onClick:()=>g("speedMultiplier",.1),children:"+0.1"})]})]})})]})},hy=({control:a,value:t,onChange:r,animSettings:i,onAnimChange:l,effectId:u,context:f,progressRef:h,workerId:d,clipDuration:g,bpm:v,getFftLevels:E})=>{const[y,x]=T.useState(!1),[S,A]=T.useState(!1),N=C=>{C.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:a.type,paramName:a.id,effectId:u,min:a.min,max:a.max,step:a.step,...f}))},D=i?.range||[a.min,a.max],L=C=>{l({...i,range:C})},M=C=>{l({range:D,...C})};return m.jsxs("div",{className:`param-editor ${y?"expanded":""}`,onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),style:{marginBottom:"8px",display:"grid",gridTemplateColumns:"1fr",gap:"2px"},children:[m.jsx("div",{className:"param-row-label",style:{width:"100%"},children:m.jsx("label",{className:"param-label",draggable:!0,onDragStart:N,style:{fontSize:"11px",color:"#aaa"},children:a.label})}),m.jsxs("div",{className:"param-row-control",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[m.jsx("button",{className:`anim-toggle-btn ${y?"active":""}`,style:{visibility:S||y||i?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>x(!y),title:"Animate",children:""}),m.jsx("div",{className:"control-input-wrapper",style:{display:"flex",alignItems:"center",height:"100%"},children:a.type==="range"?m.jsx(Nt,{id:`${u}_${a.id}`,style:{width:"100%"},children:m.jsx(sm,{min:a.min,max:a.max,step:a.step,value:t,rangeValue:D,onChange:r,onRangeChange:L,showRange:y,animSettings:i,progressRef:h,workerId:d,clipDuration:g,bpm:v,getFftLevels:E})}):a.type==="text"?m.jsx("input",{type:"text",value:t,onChange:C=>r(C.target.value),className:"param-text-input"}):a.type==="checkbox"?m.jsx(Nt,{id:`${u}_${a.id}`,children:m.jsx("input",{type:"checkbox",checked:t,onChange:C=>r(C.target.checked),className:"param-checkbox"})}):a.type==="select"?m.jsx("select",{value:t,onChange:C=>r(C.target.value),className:"param-select",children:a.options.map(C=>m.jsx("option",{value:C,children:C},C))}):null}),a.type==="range"&&m.jsx("input",{type:"number",value:typeof t=="number"?t.toFixed(2):t,onChange:C=>r(parseFloat(C.target.value)||0),className:"param-number-input",step:a.step,style:{width:"100%",fontSize:"10px"}})]}),y&&a.type==="range"&&m.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:m.jsx(lm,{animSettings:i,onChange:M})})]})},my=({customOrder:a=[],assignedDacs:t=[],onChange:r})=>{const[i,l]=T.useState(null),u=a&&a.length>0?a:t.map((d,g)=>({ip:d.ip,channel:d.channel,label:`Ch ${d.channel} (${d.hostName||d.ip})`,originalIndex:g})),f=(d,g)=>{l(u[g])},h=(d,g)=>{d.preventDefault();const v=u[g];if(i===v)return;const E=u.filter(y=>y!==i);E.splice(g,0,i),r(E)};return m.jsxs("div",{className:"custom-order-editor",style:{marginBottom:"10px",padding:"5px",background:"#222",borderRadius:"4px"},children:[m.jsx("label",{style:{fontSize:"10px",color:"#888"},children:"Channel Order (Drag to Sort)"}),m.jsx("ul",{style:{listStyle:"none",padding:0,margin:"5px 0"},children:u.map((d,g)=>m.jsxs("li",{draggable:!0,onDragStart:v=>f(v,g),onDragOver:v=>h(v,g),style:{background:"#333",border:"1px solid #444",padding:"4px",marginBottom:"2px",fontSize:"10px",cursor:"grab",display:"flex",alignItems:"center"},children:[m.jsx("span",{style:{marginRight:"5px",color:"#666"},children:""}),d.label||`Ch ${d.channel} ${d.ip?`(${d.ip})`:""}`]},g))})]})},om=({effect:a,assignedDacs:t=[],onParamChange:r,onRemove:i,syncSettings:l={},onSetParamSync:u,context:f={},progressRef:h,clipDuration:d,bpm:g,getFftLevels:v})=>{if(!a)return null;const E=Al.find(D=>D.id===a.id);if(!E)return null;const y=a.id==="delay",x=a.id==="chase",S=a.params.enabled!==!1,A=a.params.mode==="channel",N=D=>{D.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"enabled",label:`${a.name} ON`,...f}))};return m.jsxs(wn,{title:a.name,headerActions:m.jsxs("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(y||x)&&m.jsx("button",{className:"mode-toggle-btn",onClick:()=>r("mode",A?"frame":"channel"),style:{fontSize:"9px",padding:"2px 5px",background:A?"#444":"var(--theme-color)",border:"none",color:"white",borderRadius:"3px",cursor:"pointer"},children:A?"CHANNEL":"FRAME"}),m.jsx(Nt,{id:`${a.id}_blackout`,children:m.jsx("button",{className:`layer-control-button ${S?"":"active"}`,onClick:()=>r("enabled",!S),draggable:!0,onDragStart:N,style:{padding:"2px",background:S?"none":"red",border:"none",color:"white",cursor:"pointer",display:"flex"},title:"Toggle Effect",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"}),m.jsx("path",{d:"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"})]})})}),m.jsx("button",{className:"remove-effect-btn",onClick:i,children:""})]}),children:[y&&m.jsx(m.Fragment,{children:a.params.useCustomOrder&&m.jsx(my,{customOrder:a.params.customOrder,assignedDacs:t,onChange:D=>r("customOrder",D)})}),E.paramControls.map(D=>{if(y&&["customOrder"].includes(D.id)||D.showIf&&!Object.entries(D.showIf).every(([B,V])=>a.params[B]===V))return null;const L=`${a.instanceId||a.id}.${D.id}`,M=typeof l[L]=="object"?l[L]:{syncMode:l[L]};return m.jsx(hy,{control:D,value:a.params[D.id],onChange:C=>r(D.id,C),animSettings:M,onAnimChange:C=>u(L,C),effectId:a.id,context:f,progressRef:h,workerId:f.workerId,clipDuration:d,bpm:g,getFftLevels:v},D.id)})]})},gy=({control:a,value:t,onChange:r,syncSettings:i,onSetParamSync:l,layerIndex:u,colIndex:f,progressRef:h,workerId:d,generatorId:g,clipDuration:v})=>{const[E,y]=T.useState(!1),[x,S]=T.useState(!1),A=C=>{C.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:a.type,paramName:a.id,targetType:"generator",layerIndex:u,colIndex:f,min:a.min,max:a.max,step:a.step}))},N=`${g}.${a.id}`,D=typeof i[N]=="object"?i[N]:{syncMode:i[N]},L=D?.range||[a.min,a.max],M=C=>{l(N,{...D,range:C})};return m.jsxs("div",{className:`param-editor ${E?"expanded":""}`,onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),style:{marginBottom:"8px"},children:[m.jsx("div",{className:"param-label-row",style:{display:"flex",alignItems:"center"},children:m.jsx("label",{draggable:!0,onDragStart:A,className:"param-label",style:{fontSize:"11px",color:"#aaa",cursor:"grab"},children:a.label})}),m.jsxs("div",{className:"control-row",style:{display:"grid",gridTemplateColumns:"20px 1fr 50px",gap:"5px",alignItems:"center"},children:[m.jsx("button",{className:`anim-toggle-btn ${E?"active":""}`,style:{visibility:x||E||D?.syncMode?"visible":"hidden",background:"none",border:"none",color:"#666",cursor:"pointer",padding:0,fontSize:"14px"},onClick:()=>y(!E),title:"Animate",children:""}),m.jsx("div",{className:"control-input-wrapper",children:a.type==="range"?m.jsx(sm,{min:a.min,max:a.max,step:a.step,value:t,rangeValue:L,onChange:C=>r(a.id,C),onRangeChange:M,showRange:E,animSettings:D,progressRef:h,workerId:d,clipDuration:v}):a.type==="number"?m.jsx("input",{type:"number",value:t,onChange:C=>r(a.id,parseFloat(C.target.value)||0),className:"param-number-input",step:a.step}):a.type==="text"?m.jsx("input",{type:"text",value:t,onChange:C=>r(a.id,C.target.value),className:"param-text-input"}):a.type==="checkbox"?m.jsx("input",{type:"checkbox",checked:t,onChange:C=>r(a.id,C.target.checked),className:"param-checkbox"}):null}),a.type==="range"&&m.jsx("input",{type:"number",value:typeof t=="number"?t.toFixed(2):t,onChange:C=>r(a.id,parseFloat(C.target.value)||0),className:"param-number-input",step:a.step,style:{width:"100%",fontSize:"10px"}})]}),E&&a.type==="range"&&m.jsx("div",{className:"param-anim-settings",style:{marginTop:"5px",padding:"5px",background:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:m.jsx(lm,{animSettings:D,onChange:C=>l(N,C)})})]})},vy=({selectedGeneratorId:a,selectedGeneratorParams:t,onParameterChange:r,syncSettings:i={},onSetParamSync:l,layerIndex:u,colIndex:f,progressRef:h,workerId:d,clipDuration:g})=>{const[v,E]=T.useState([]),[y,x]=T.useState([]),[S,A]=T.useState(!1);if(!a)return m.jsx("div",{className:"generator-settings-panel",children:"No generator selected."});const N=bf.find(L=>L.id===a);if(!N)return m.jsxs("div",{className:"generator-settings-panel",children:["Generator definition not found for ID: ",a]});T.useEffect(()=>{(async()=>{if(window.electronAPI&&window.electronAPI.getProjectFonts)try{const M=await window.electronAPI.getProjectFonts();x(M)}catch(M){console.error("Failed to load project fonts:",M)}})()},[]);const D=async L=>{const M=L.target.value;if(M==="browse")if(window.electronAPI&&window.electronAPI.showFontFileDialog){const C=await window.electronAPI.showFontFileDialog();C&&r("fontUrl",C)}else console.error("Font file dialog API not available.");else if(M==="load-system"){A(!0);try{const B=(await window.electronAPI.getSystemFonts()).map(V=>({name:V.split(/[\\/]/).pop(),path:V})).sort((V,te)=>V.name.localeCompare(te.name));E(B)}catch(C){console.error("Failed to load system fonts:",C)}A(!1)}else r("fontUrl",M)};return m.jsx(wn,{title:`${N.name} Settings`,children:N.paramControls.map(L=>{if(L.id==="fontUrl"){const M=t[L.id]||"src/fonts/Geometr415 Blk BT Black.ttf";return m.jsxs("div",{className:"param-editor",children:[m.jsx("label",{className:"param-label",children:L.label}),m.jsxs("div",{className:"font-selector-container",children:[m.jsxs("select",{className:"param-select",onChange:D,value:M,children:[y.length>0?m.jsx("optgroup",{label:"Project Fonts",children:y.map(C=>m.jsx("option",{value:C.path,children:C.name},C.path))}):m.jsx("optgroup",{label:"Default Fonts",children:m.jsx("option",{value:"src/fonts/Geometr415 Blk BT Black.ttf",children:"Geometr415"})}),v.length>0?m.jsx("optgroup",{label:"System Fonts",children:v.map(C=>m.jsx("option",{value:C.path,children:C.name},C.path))}):m.jsx("option",{value:"load-system",children:S?"Loading...":"Load System Fonts..."}),m.jsx("optgroup",{label:"Actions",children:m.jsx("option",{value:"browse",children:"Browse File..."})})]}),m.jsx("span",{className:"font-path-tiny",title:M,children:M.split(/[\\/]/).pop()})]})]},L.id)}return m.jsx(gy,{control:L,value:t[L.id],onChange:r,syncSettings:i,onSetParamSync:l,layerIndex:u,colIndex:f,progressRef:h,workerId:d,generatorId:a,clipDuration:g},L.id)})})},yy=({settings:a,onUpdate:t})=>{const{mode:r="fps",duration:i=1,beats:l=8,speedMultiplier:u=1,fps:f=60}=a||{},h=g=>{t({mode:g})},d=(g,v,E=!1)=>{let y=a[g]||(g==="beats"?8:g==="fps"?60:1);E?y=v>1?y*2:y/2:y+=v,y<.01&&(y=.01),t({[g]:y})};return m.jsxs(wn,{title:"Clip Playback",children:[m.jsxs("div",{className:"playback-mode-selector",children:[m.jsx("button",{className:r==="fps"?"active":"button_inactive",onClick:()=>h("fps"),children:"FPS"}),m.jsx("button",{className:r==="timeline"?"active":"button_inactive",onClick:()=>h("timeline"),children:"Timeline"}),m.jsx("button",{className:r==="bpm"?"active":"button_inactive",onClick:()=>h("bpm"),children:"BPM Sync"})]}),m.jsxs("div",{className:"playback-controls",children:[r==="fps"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Speed (FPS)"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("fps",-1),children:"-1"}),m.jsx("input",{type:"number",value:f,onChange:g=>t({fps:parseInt(g.target.value)||60})}),m.jsx("button",{onClick:()=>d("fps",1),children:"+1"}),m.jsx("button",{onClick:()=>d("fps",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("fps",2,!0),children:"*2"})]})]}),m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Duration (s) (for effects)"}),m.jsx("div",{className:"value-adjuster",children:m.jsx("input",{type:"number",value:i.toFixed(2),onChange:g=>t({duration:parseFloat(g.target.value)||1})})})]})]}),r==="timeline"&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Duration (s)"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("duration",-1),children:"-1"}),m.jsx("input",{type:"number",value:i.toFixed(2),onChange:g=>t({duration:parseFloat(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("duration",1),children:"+1"}),m.jsx("button",{onClick:()=>d("duration",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("duration",2,!0),children:"*2"})]})]}),r==="bpm"&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Beats"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("beats",-1),children:"-1"}),m.jsx("input",{type:"number",value:l,onChange:g=>t({beats:parseInt(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("beats",1),children:"+1"}),m.jsx("button",{onClick:()=>d("beats",.5,!0),children:"/2"}),m.jsx("button",{onClick:()=>d("beats",2,!0),children:"*2"})]})]}),(r==="timeline"||r==="bpm")&&m.jsxs("div",{className:"control-group",children:[m.jsx("label",{children:"Speed Multiplier"}),m.jsxs("div",{className:"value-adjuster",children:[m.jsx("button",{onClick:()=>d("speedMultiplier",-.1),children:"-0.1"}),m.jsx("input",{type:"number",value:u.toFixed(2),onChange:g=>t({speedMultiplier:parseFloat(g.target.value)||1})}),m.jsx("button",{onClick:()=>d("speedMultiplier",.1),children:"+0.1"})]})]})]})]})},um=T.createContext(),Rl=()=>T.useContext(um),by=({children:a})=>{const[t,r]=T.useState(null),[i,l]=T.useState(null),[u,f]=T.useState(null),[h,d]=T.useState({source:"external",lowRange:[20,250],midRange:[250,4e3],highRange:[4e3,2e4],gain:1,holdTime:100,fallTime:500,calculationMode:"average",smoothingTimeConstant:.8}),[g,v]=T.useState({low:0,mid:0,high:0}),E=T.useRef(new Uint8Array(0)),y=T.useRef({low:0,mid:0,high:0}),x=T.useRef({low:0,mid:0,high:0,lastUpdateTime:Date.now(),peakTimes:{low:0,mid:0,high:0}}),[S,A]=T.useState([]),[N,D]=T.useState("default"),[L,M]=T.useState(1),C=T.useRef({}),B=T.useRef({}),V=T.useRef({}),te=T.useCallback(async()=>{try{const he=(await navigator.mediaDevices.enumerateDevices()).filter(xe=>xe.kind==="audiooutput");if(A(he),window.electronAPI&&window.electronAPI.setAudioDevices){const xe=he.map(Ye=>({deviceId:Ye.deviceId,label:Ye.label,groupId:Ye.groupId}));window.electronAPI.setAudioDevices(xe)}}catch(ne){console.error("Error enumerating audio devices:",ne)}},[]);T.useEffect(()=>{te();let ne;return window.electronAPI&&window.electronAPI.onUpdateAudioDeviceId&&(ne=window.electronAPI.onUpdateAudioDeviceId(he=>{D(he)})),navigator.mediaDevices.addEventListener("devicechange",te),()=>{navigator.mediaDevices.removeEventListener("devicechange",te),ne&&ne()}},[te]);const de=T.useCallback(ne=>{if(!t||!i)return null;try{const he=t.createMediaElementSource(ne);return he.connect(i),he.connect(t.destination),he}catch(he){return console.warn("MediaElementSource already connected?",he),null}},[t,i]),ye=T.useCallback(async(ne,he,xe=1,Ye=!0)=>{if(C.current[ne]&&(C.current[ne].pause(),C.current[ne].src=""),V.current[ne]=xe,!he)return;if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(he))throw new Error(`Audio file not found: ${he}`);const Be=new Audio(`file://${he}`);if(Be.crossOrigin="anonymous",Be.volume=xe*L,N&&Be.setSinkId)try{await Be.setSinkId(N)}catch(st){console.error("Error setting audio sink ID:",st)}if(C.current[ne]=Be,t){const st=de(Be);st&&(B.current[ne]=st)}if(Ye)try{await Be.play()}catch(st){throw console.error("Error playing audio:",st),st}return Be},[N,de,L,t]),pe=T.useCallback(ne=>{M(ne),Object.keys(C.current).forEach(he=>{const xe=C.current[he],Ye=V.current[he]??1;xe&&(xe.volume=ne*Ye)})},[]),q=T.useCallback((ne,he)=>{V.current[ne]=he;const xe=C.current[ne];xe&&(xe.volume=he*L)},[L]),j=T.useCallback(ne=>{if(C.current[ne]&&(C.current[ne].pause(),C.current[ne].src="",delete C.current[ne],B.current[ne])){try{B.current[ne].disconnect()}catch{}delete B.current[ne]}},[]),$=T.useCallback(ne=>{C.current[ne]&&C.current[ne].pause()},[]),W=T.useCallback(async ne=>{if(C.current[ne]&&C.current[ne].paused)try{await C.current[ne].play()}catch(he){console.error("Error resuming:",he)}},[]),J=T.useCallback(ne=>{const he=Math.max(.0625,Math.min(ne,16));Object.values(C.current).forEach(xe=>{try{xe.playbackRate=he}catch(Ye){console.warn("Failed to set playbackRate:",Ye)}})},[]),U=T.useCallback(ne=>{C.current[ne]&&(C.current[ne].currentTime=0)},[]),G=T.useCallback((ne,he)=>{C.current[ne]&&(C.current[ne].currentTime=he)},[]),X=T.useCallback(()=>Object.keys(C.current).forEach(j),[j]),me=T.useCallback(()=>Object.keys(C.current).forEach($),[$]),_=T.useCallback(()=>Object.keys(C.current).forEach(W),[W]),z=T.useCallback(()=>Object.keys(C.current).forEach(U),[U]),ie=T.useCallback(ne=>{const he=C.current[ne];return he?{currentTime:he.currentTime,duration:he.duration,paused:he.paused}:null},[]),ve=T.useCallback(()=>{if(t)return;const ne=new(window.AudioContext||window.webkitAudioContext),he=ne.createAnalyser();he.fftSize=2048,he.smoothingTimeConstant=h.smoothingTimeConstant,E.current=new Uint8Array(he.frequencyBinCount),r(ne),l(he)},[t,h.smoothingTimeConstant]);return T.useEffect(()=>{const ne=()=>{ve(),window.removeEventListener("mousedown",ne),window.removeEventListener("keydown",ne)};return window.addEventListener("mousedown",ne),window.addEventListener("keydown",ne),()=>{window.removeEventListener("mousedown",ne),window.removeEventListener("keydown",ne)}},[ve]),T.useEffect(()=>{i&&(i.smoothingTimeConstant=h.smoothingTimeConstant)},[i,h.smoothingTimeConstant]),T.useEffect(()=>{if(!t||!i||h.source!=="external"){u&&(u.disconnect(),f(null));return}let ne=null;return(async()=>{try{ne=await navigator.mediaDevices.getUserMedia({audio:!0});const xe=t.createMediaStreamSource(ne);xe.connect(i),f(xe)}catch(xe){console.error("Failed to get external audio stream:",xe)}})(),()=>{ne&&ne.getTracks().forEach(xe=>xe.stop())}},[t,i,h.source]),T.useEffect(()=>{if(!i)return;let ne;const he=()=>{i.getByteFrequencyData(E.current);const xe=t.sampleRate,Ye=i.frequencyBinCount,Be=xe/i.fftSize,st=Fe=>{const xt=Math.floor(Fe[0]/Be),Rt=Math.floor(Fe[1]/Be);if(h.calculationMode==="peak"){let Je=0;for(let Ue=xt;Ue<=Rt&&Ue<Ye;Ue++)E.current[Ue]>Je&&(Je=E.current[Ue]);return Je/255}else{let Je=0,Ue=0;for(let vn=xt;vn<=Rt&&vn<Ye;vn++)Je+=E.current[vn],Ue++;return Ue>0?Je/Ue/255:0}},At=st(h.lowRange),Ie=st(h.midRange),Ke=st(h.highRange),rt=Date.now(),mt=Math.max(0,rt-x.current.lastUpdateTime);x.current.lastUpdateTime=rt;const we=(Fe,xt)=>{let Rt=Fe*h.gain;const Je=x.current[xt],Ue=x.current.peakTimes[xt]||0;if(Rt>=Je)return x.current.peakTimes[xt]=rt,Rt;{if(rt-Ue<h.holdTime)return Je;if(h.fallTime<=0)return 0;const Yn=mt/h.fallTime,qn=Je-Yn;return Math.max(0,isNaN(qn)?0:qn)}},se={low:we(At,"low"),mid:we(Ie,"mid"),high:we(Ke,"high")};y.current=se,x.current={...se,lastUpdateTime:rt,peakTimes:x.current.peakTimes},ne=requestAnimationFrame(he)};return he(),()=>cancelAnimationFrame(ne)},[t,i,h]),m.jsx(um.Provider,{value:{audioCtx:t,analyser:i,fftSettings:h,setFftSettings:d,fftLevels:y.current,fftLevelsRef:y,getFftLevels:()=>y.current,connectMediaElement:de,initAudio:ve,devices:S,selectedDeviceId:N,setSelectedDeviceId:D,globalVolume:L,setVolume:pe,setClipVolume:q,playAudio:ye,stopAudio:j,pauseAudio:$,resumeAudio:W,setPlaybackRate:J,resetAudio:U,seekAudio:G,stopAllAudio:X,pauseAllAudio:me,resumeAllAudio:_,resetAllAudio:z,getAudioInfo:ie},children:a})},xy=({audioFile:a,layerIndex:t,onSeek:r,onLoadError:i})=>{const l=T.useRef(null),u=T.useRef(null),{audioCtx:f,getAudioInfo:h}=Rl(),[d,g]=T.useState(null),[v,E]=T.useState("rgb(255, 94, 0)"),y=T.useRef(null),x=T.useRef(!1),S=T.useCallback(()=>{const M=document.createElement("div");M.style.display="none",M.style.color="var(--theme-color)",document.body.appendChild(M);const C=getComputedStyle(M).color;document.body.removeChild(M),C&&C!=="rgba(0, 0, 0, 0)"&&E(C)},[]);T.useEffect(()=>{S();const M=new MutationObserver(S);return M.observe(document.documentElement,{attributes:!0,attributeFilter:["style","class"]}),()=>M.disconnect()},[S]),T.useEffect(()=>{if(!a?.path||!f)return;let M=!0;const C=async()=>{try{if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(a.path))throw new Error(`File not found: ${a.path}`);const B=await fetch(`file://${a.path}`);if(!B.ok)throw new Error(`HTTP error! status: ${B.status}`);const V=await B.arrayBuffer();if(!M)return;const te=await f.decodeAudioData(V);M&&g(te)}catch(B){if(!M)return;console.error("Failed to load/decode audio for waveform:",B),i&&i(B)}};return g(null),C(),()=>{M=!1}},[a,f,i]);const A=T.useCallback((M,C,B,V,te)=>{if(!V)return;const de=V.getChannelData(0),ye=B/2,pe=2,j=pe+2;M.clearRect(0,0,C,B);const $=U=>{M.fillStyle=U,M.beginPath();for(let G=0;G<C;G+=j){const X=Math.floor(G*(de.length/C)),me=Math.floor((G+pe)*(de.length/C));let _=1,z=-1;for(let ne=X;ne<me&&ne<de.length;ne++){const he=de[ne];he<_&&(_=he),he>z&&(z=he)}const ie=(1+_)*ye,ve=Math.max(1,(z-_)*ye);M.roundRect?M.roundRect(G,ie,pe,ve,1):M.rect(G,ie,pe,ve)}M.fill()},W=C*te;let J=v;v.startsWith("rgb(")&&(J=v.replace("rgb","rgba").replace(")",", 0.25)")),$(J),te>0&&(M.save(),M.beginPath(),M.rect(0,0,W,B),M.clip(),$(v),M.restore()),M.fillStyle="#ffffff",M.fillRect(W,0,1,B)},[v]);T.useEffect(()=>{const M=l.current;if(!M||!d)return;const C=M.getContext("2d"),B=()=>{const V=M.getBoundingClientRect();(M.width!==V.width||M.height!==V.height)&&(M.width=V.width,M.height=V.height);const te=M.width,de=M.height;let ye=0;if(t!=null){const pe=h(t);pe&&pe.duration>0&&(ye=pe.currentTime/pe.duration)}ye=Math.max(0,Math.min(1,ye)),A(C,te,de,d,ye),y.current=requestAnimationFrame(B)};return B(),()=>{y.current&&cancelAnimationFrame(y.current)}},[d,t,h,A]);const N=M=>{x.current=!0,L(M),window.addEventListener("mouseup",D),window.addEventListener("mousemove",L)},D=()=>{x.current=!1,window.removeEventListener("mouseup",D),window.removeEventListener("mousemove",L)},L=M=>{if(!l.current||!d)return;const C=l.current.getBoundingClientRect(),B=M.clientX-C.left,V=C.width,de=Math.max(0,Math.min(1,B/V))*d.duration;r&&r(de)};return m.jsx("div",{ref:u,className:"wave-player-container",style:{width:"100%",height:"35px",marginBottom:"10px",background:"transparent",borderRadius:"4px",overflow:"hidden"},onMouseDown:N,children:m.jsx("canvas",{ref:l,style:{width:"100%",height:"100%",display:"block",cursor:"pointer"}})})},Sy=({selectedLayerIndex:a,selectedColIndex:t,clip:r,audioInfo:i,bpm:l,getFftLevels:u,onAssignAudio:f,onRemoveAudio:h,onUpdateAudioVolume:d,onUpdatePlaybackSettings:g,onSetParamSync:v,onToggleDacMirror:E,onRemoveDac:y,onRemoveEffect:x,onReorderEffects:S,onAddEffect:A,onParameterChange:N,onGeneratorParameterChange:D,progressRef:L,onAudioError:M})=>{const[C,B]=T.useState({}),[V,te]=T.useState(null),{seekAudio:de}=Rl(),ye=T.useRef(0),pe=_n.useCallback(Ie=>{M&&M(a,t)},[M,a,t]);if(T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(Ke=>{B(rt=>({...rt,[Ke.ip]:Ke.status}))})},[]),a===null||t===null)return m.jsx("div",{className:"clip-settings-panel settings-panel-base",children:m.jsx("p",{className:"info-text",children:"Select a clip to view settings."})});const q=Ie=>{Ie.preventDefault(),Ie.stopPropagation();try{const Ke=Ie.dataTransfer.getData("application/json");if(!Ke)return;const rt=JSON.parse(Ke);rt&&rt.type&&A&&A(rt)}catch(Ke){console.error("Failed to drop effect in ClipSettingsPanel:",Ke)}},j=Ie=>{Ie.preventDefault(),Ie.dataTransfer.dropEffect="copy"},$=Ie=>{te(Ie)},W=(Ie,Ke)=>{if(Ie.preventDefault(),V===null||V===Ke)return;const rt=Date.now();rt-ye.current<200||(ye.current=rt,S&&(S(a,t,V,Ke),te(Ke)))},J=Ie=>{te(null)},{effects:U=[],assignedDacs:G=[],playbackSettings:X={},syncSettings:me={},audioFile:_=null,audioVolume:z=1,type:ie=null,generatorDefinition:ve=null,currentParams:ne={},workerId:he=null}=r||{},xe=U.length>0,Ye=ie==="generator"&&!!ve,Be=G.length>0;let st=1;if(X.mode==="timeline")st=X.duration||1;else if(X.mode==="bpm"){const Ie=l||120;st=(X.beats||8)*60/Ie}else{const Ie=X.fps||r?.fps||30;st=(r?.totalFrames||30)/Ie}const At=he||(ie==="ilda"?`ilda-${a}-${t}`:ie==="generator"?`generator-${a}-${t}`:null);return i&&i.duration&&i.currentTime/i.duration*100,m.jsxs("div",{className:"clip-settings-panel settings-panel-base",onDrop:q,onDragOver:j,children:[m.jsx(wn,{title:"Audio",children:_?m.jsxs("div",{className:"assigned-audio-info",style:{position:"relative"},children:[m.jsx("button",{className:"remove-effect-btn",onClick:h,style:{position:"absolute",top:"-5px",right:"-5px",fontSize:"14px"},children:""}),m.jsx("div",{className:"audio-file-name",title:_.path,style:{paddingRight:"15px",marginBottom:"8px",fontSize:"11px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:_.name}),m.jsx(xy,{audioFile:_,audioInfo:i,layerIndex:a,onSeek:Ie=>de(a,Ie),onLoadError:pe}),m.jsxs("div",{className:"audio-volume-control",style:{marginTop:"10px"},children:[m.jsxs("label",{style:{fontSize:"10px",display:"block",marginBottom:"2px"},children:["Volume: ",Math.round(z*100),"%"]}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:z,onChange:Ie=>d(a,t,parseFloat(Ie.target.value)),className:"slider_hor",style:{width:"100%",height:"4px"}})]})]}):m.jsx("button",{className:"assign-audio-btn",onClick:f,children:"Assign Audio File"})}),m.jsx(yy,{settings:X,onUpdate:Ie=>g(a,t,Ie)}),Be&&m.jsx(wn,{title:"Assigned DACs",children:m.jsx("ul",{className:"assigned-dacs-list",children:G.map((Ie,Ke)=>{const rt=C[Ie.ip];return m.jsxs("li",{className:"assigned-dac-item",children:[m.jsxs("div",{className:"dac-info-block",children:[m.jsxs("span",{className:"dac-name-tiny",children:[Ie.hostName||Ie.ip," - Ch ",Ie.channel]}),rt&&m.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",rt.playback_state===2?"PLAYING":rt.playback_state===1?"PREPARED":"IDLE"," | Buf: ",rt.buffer_fullness,rt.buffer_capacity?`/${rt.buffer_capacity}`:""," | PPS: ",rt.point_rate]})]}),m.jsxs("div",{className:"dac-mirror-controls",children:[m.jsx("button",{className:`mirror-btn ${Ie.mirrorX?"active":""}`,onClick:()=>E(a,t,Ke,"x"),title:"Mirror X Axis",children:"X"}),m.jsx("button",{className:`mirror-btn ${Ie.mirrorY?"active":""}`,onClick:()=>E(a,t,Ke,"y"),title:"Mirror Y Axis",children:"Y"})]}),m.jsx("button",{className:"remove-dac-btn",onClick:()=>y(Ke),children:""})]},`${Ie.unitID||Ie.ip}-${Ie.channel}-${Ke}`)})})}),Ye&&m.jsx(vy,{selectedGeneratorId:ve.id,selectedGeneratorParams:ne,onParameterChange:D,syncSettings:me,onSetParamSync:v,layerIndex:a,colIndex:t,progressRef:L,workerId:At,clipDuration:st,bpm:l,getFftLevels:u}),m.jsx(wn,{title:"Clip Effects",children:m.jsx("div",{className:"clip-effects-list",style:{minHeight:"50px"},onDrop:J,children:xe?U.map((Ie,Ke)=>m.jsx("div",{draggable:!0,onDragStart:()=>$(Ke),onDragOver:rt=>W(rt,Ke),style:{cursor:"row-resize"},children:m.jsx(om,{effect:Ie,assignedDacs:G,syncSettings:me,onSetParamSync:v,context:{layerIndex:a,colIndex:t,effectIndex:Ke,targetType:"effect",workerId:At},onParamChange:(rt,mt)=>N(a,t,Ke,rt,mt),onRemove:()=>x(a,t,Ke),progressRef:L,clipDuration:st,bpm:l,getFftLevels:u})},Ie.instanceId||Ie.id+Ke)):m.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},Ey=({selectedLayerIndex:a,autopilotMode:t,onAutopilotChange:r,layerEffects:i,assignedDacs:l=[],onToggleDacMirror:u,onRemoveDac:f,onAddEffect:h,onRemoveEffect:d,onParamChange:g})=>{const[v,E]=T.useState({});if(T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onDacStatus)return window.electronAPI.onDacStatus(A=>{E(N=>({...N,[A.ip]:A.status}))})},[]),a===null)return m.jsx("div",{className:"settings-panel-base",children:m.jsx("div",{className:"settings-card-content",children:m.jsx("p",{className:"info-text",children:"Select a layer to edit settings"})})});const y=S=>{S.preventDefault(),S.stopPropagation();try{const A=JSON.parse(S.dataTransfer.getData("application/json"));A&&A.id&&h(A)}catch(A){console.error("Failed to drop effect:",A)}},x=S=>{S.preventDefault(),S.dataTransfer.dropEffect="copy"};return m.jsxs("div",{className:"settings-panel-base",onDrop:y,onDragOver:x,children:[l&&l.length>0&&m.jsx(wn,{title:"Assigned DACs",children:m.jsx("ul",{className:"assigned-dacs-list",children:l.map((S,A)=>{const N=v[S.ip];return m.jsxs("li",{className:"assigned-dac-item",children:[m.jsxs("div",{className:"dac-info-block",children:[m.jsxs("span",{className:"dac-name-tiny",children:[S.hostName||S.ip," - Ch ",S.channel]}),N&&m.jsxs("div",{className:"dac-status-tiny",style:{fontSize:"9px",color:"#888"},children:["State: ",N.playback_state===2?"PLAYING":N.playback_state===1?"PREPARED":"IDLE"," | Buf: ",N.buffer_fullness,N.buffer_capacity?`/${N.buffer_capacity}`:""," | PPS: ",N.point_rate]})]}),m.jsxs("div",{className:"dac-mirror-controls",children:[m.jsx("button",{className:`mirror-btn ${S.mirrorX?"active":""}`,onClick:()=>u(a,A,"x"),title:"Mirror X Axis",children:"X"}),m.jsx("button",{className:`mirror-btn ${S.mirrorY?"active":""}`,onClick:()=>u(a,A,"y"),title:"Mirror Y Axis",children:"Y"})]}),m.jsx("button",{className:"remove-dac-btn",onClick:()=>f(a,A),children:""})]},`${S.unitID||S.ip}-${S.channel}-${A}`)})})}),m.jsx(wn,{title:`Layer ${a+1} Autopilot`,children:m.jsxs("div",{className:"param-editor",children:[m.jsx("label",{children:"Mode"}),m.jsx("div",{className:"clip-playback-settings",children:m.jsxs("div",{className:"playback-mode-selector",children:[m.jsx("button",{className:t==="off"?"active":"",onClick:()=>r("off"),children:"OFF"}),m.jsx("button",{className:t==="forward"?"active":"",onClick:()=>r("forward"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-forward-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"m9.77 12.11 4.012-2.953a.647.647 0 0 0 0-1.114L9.771 5.09a.644.644 0 0 0-.971.557V6.65H2v3.9h6.8v1.003c0 .505.545.808.97.557"})})}),m.jsx("button",{className:t==="random"?"active":"",onClick:()=>r("random"),children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-shuffle",viewBox:"0 0 16 16",children:[m.jsx("path",{fillRule:"evenodd",d:"M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"}),m.jsx("path",{d:"M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"})]})})]})})]})}),m.jsx(wn,{title:"Layer Effects",children:m.jsx("div",{className:"layer-effects-list",style:{minHeight:"50px"},children:i&&i.length>0?i.map((S,A)=>m.jsx(om,{effect:S,onRemove:()=>d(A),onParamChange:(N,D)=>g(A,N,D),syncSettings:{},onSetParamSync:()=>{},context:{layerIndex:a,colIndex:null,effectIndex:A,targetType:"layerEffect"}},S.instanceId||A)):m.jsx("div",{className:"info-text",style:{padding:"20px",border:"1px dashed #444",borderRadius:"5px"},children:"Drag Effects Here"})})})]})},wy=({message:a,visible:t})=>t?m.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#333",color:"white",padding:"10px 20px",borderRadius:"5px",zIndex:1e3,opacity:t?1:0,transition:"opacity 0.5s ease-in-out"},children:a}):null,cm=T.createContext(null),fm=()=>T.useContext(cm),Ay=({children:a,onWorkerMessage:t})=>{const r=T.useRef(null);return r.current===null&&(r.current=new Worker(new URL(""+new URL("rendering.worker-CPlFURn5.js",import.meta.url).href,import.meta.url),{type:"module"})),T.useEffect(()=>{const i=r.current;return t&&(i.onmessage=t),()=>{i.terminate(),t&&(i.onmessage=null)}},[t]),m.jsx(cm.Provider,{value:r.current,children:a})},Ty=({frame:a,effects:t,showBeamEffect:r,beamAlpha:i,fadeAlpha:l,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d={},bpm:g=120,clipDuration:v=1,progress:E=0,previewTime:y=0,fftLevels:x={low:0,mid:0,high:0},effectStates:S=null,onToggleBeamEffect:A,onCycleDisplayMode:N})=>{const D=T.useRef(null),L=fm(),M=T.useRef(`ilda-player-${Math.random()}`);return T.useEffect(()=>{const C=D.current;if(!C||!L)return;const B=C.transferControlToOffscreen();return L.postMessage({action:"register",payload:{id:M.current,canvas:B,type:"single",data:{showBeamEffect:r,beamAlpha:i,fadeAlpha:l,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d,bpm:g,clipDuration:v,progress:E,previewTime:y,fftLevels:x,effectStates:S}}},[B]),()=>{L.postMessage({action:"deregister",payload:{id:M.current}})}},[]),T.useEffect(()=>{if(!L)return;const C=a?[a]:[];L.postMessage({action:"update",payload:{id:M.current,data:{ildaFrames:C,effects:t,showBeamEffect:r,beamAlpha:i,fadeAlpha:l,previewScanRate:u,beamRenderMode:f,intensity:h,syncSettings:d,bpm:g,clipDuration:v,progress:E,previewTime:y,fftLevels:x,effectStates:S}}})},[L,a,t,r,i,l,u,f,h,d,g,v,E,y,x,S]),m.jsxs("div",{className:"ilda-player",children:[m.jsx("h3",{children:"Selected Preview"}),m.jsxs("div",{className:"renderSettingToggle",children:[m.jsx("button",{onClick:A,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),m.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),m.jsx("button",{onClick:N,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),m.jsx("canvas",{ref:D,width:"300",height:"300",style:{backgroundColor:"black"}})]})},Cy=_n.memo(Ty),My=({activeFrames:a,showBeamEffect:t,beamAlpha:r,fadeAlpha:i,previewScanRate:l,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:d,previewTime:g=0,fftLevels:v={low:0,mid:0,high:0},onToggleBeamEffect:E,onCycleDisplayMode:y})=>{const x=T.useRef(null),S=fm(),A=T.useRef(`world-preview-${Math.random()}`);return T.useEffect(()=>{const N=x.current;if(!N||!S)return;const D=N.transferControlToOffscreen();return S.postMessage({action:"register",payload:{id:A.current,canvas:D,type:"world",data:{showBeamEffect:t,beamAlpha:r,fadeAlpha:i,previewScanRate:l,beamRenderMode:u,previewTime:g,fftLevels:v}}},[D]),()=>{S.postMessage({action:"deregister",payload:{id:A.current}})}},[]),T.useEffect(()=>{if(!S)return;const N=Object.entries(a).map(([D,{frame:L,effects:M,layerIndex:C,syncSettings:B,bpm:V,clipDuration:te,progress:de,effectStates:ye}])=>({frames:[L],effects:M,workerId:D,layerIndex:C,syncSettings:B,bpm:V,clipDuration:te,progress:de,effectStates:ye}));S.postMessage({action:"update",payload:{id:A.current,data:{worldData:N,showBeamEffect:t,beamAlpha:r,fadeAlpha:i,previewScanRate:l,beamRenderMode:u,layerIntensities:f,masterIntensity:h,dacSettings:d,previewTime:g,fftLevels:v}}})},[S,a,t,r,i,l,u,f,h,d,g,v]),m.jsxs("div",{className:"world-preview",children:[m.jsx("h3",{children:"World Preview"}),m.jsxs("div",{className:"renderSettingToggle",children:[m.jsx("button",{onClick:E,title:"Toggle 2D/3D (Beam Effect)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-badge-3d",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M4.52 8.368h.664c.646 0 1.055.378 1.06.9.008.537-.427.919-1.086.919-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688 1.24 0 2.285-.66 2.272-1.798-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375-.013-.906-.8-1.57-2.053-1.565-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751.532 0 .928.33.928.813.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04 0 1.353-.505 2.02-1.621 2.02h-.844z"}),m.jsx("path",{d:"M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"})]})}),m.jsx("button",{onClick:y,title:"Cycle Display Mode (Points/Lines)",style:{background:"transparent",border:"none",cursor:"pointer",color:"#aaa"},children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"})})})]}),m.jsx("canvas",{ref:x,width:"300",height:"300",style:{backgroundColor:"black"}})]})},Ny=({bpm:a,onBpmChange:t})=>{const[r,i]=T.useState([]),[l,u]=T.useState(a);T.useEffect(()=>{u(a)},[a]);const f=()=>{const d=Date.now(),g=[...r,d].slice(-4);if(i(g),g.length>=2){const v=[];for(let x=1;x<g.length;x++)v.push(g[x]-g[x-1]);const E=v.reduce((x,S)=>x+S)/v.length,y=Math.round(6e4/E);t(y)}},h=d=>{const g=parseFloat(d.target.value);u(d.target.value),!isNaN(g)&&g>0&&g<999&&t(g)};return m.jsx("div",{className:"bpm-controls",children:m.jsxs("div",{className:"bpm-display",children:[m.jsx(Nt,{id:"bpm_tap",children:m.jsx("button",{className:"bpm-tap-btn",onClick:f,children:"TAP"})}),m.jsxs("div",{className:"bpm-fine-controls",children:[m.jsx(Nt,{id:"bpm_fine_down",children:m.jsx("button",{className:"bpm-fine-btn",onClick:()=>t(Math.max(1,a-.1)),children:"-"})}),m.jsx(Nt,{id:"bpm_value",children:m.jsx("input",{type:"number",className:"bpm-input",value:l,onChange:h,min:"1",max:"999",step:"0.1"})}),m.jsx(Nt,{id:"bpm_fine_up",children:m.jsx("button",{className:"bpm-fine-btn",onClick:()=>t(Math.min(999,a+.1)),children:"+"})})]}),m.jsx("span",{className:"bpm-label",children:"BPM"})]})})},Ry=({onPlay:a,onPause:t,onStop:r,isPlaying:i,isStopped:l})=>{const u=(f,h)=>{f.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:h,targetType:"transport",label:h.toUpperCase()}))};return m.jsxs("div",{className:"transport-controls",children:[m.jsx(Nt,{id:"transport_play",children:m.jsx("button",{className:`speed-control-button ${i?"active":""}`,onClick:a,draggable:!0,onDragStart:f=>u(f,"play"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-play-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"})})})}),m.jsx(Nt,{id:"transport_pause",children:m.jsx("button",{className:`speed-control-button ${!i&&!l?"active":""}`,onClick:t,draggable:!0,onDragStart:f=>u(f,"pause"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-pause-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5m5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5"})})})}),m.jsx(Nt,{id:"transport_stop",children:m.jsx("button",{className:`speed-control-button ${l?"active":""}`,onClick:r,draggable:!0,onDragStart:f=>u(f,"stop"),children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-stop-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"})})})})]})},Dy=({value:a,onToggle:t,label:r,onDrop:i,isAssigned:l,className:u,...f})=>{const h=g=>{g.preventDefault(),g.dataTransfer.dropEffect="link"},d=g=>{g.preventDefault();try{const v=g.dataTransfer.getData("application/x-truelazer-param");console.log("[QuickButton] Dropped Data Raw:",v);const E=JSON.parse(v);console.log("[QuickButton] Dropped Data Parsed:",E),E&&(E.type==="toggle"||E.type==="checkbox")?i(E):console.warn("[QuickButton] Invalid data type for button:",E?.type)}catch(v){console.error("[QuickButton] Drop Error:",v)}};return m.jsx("div",{className:`quick-assign-button ${a?"active":""} ${l?"":"unassigned"} ${u||""}`.trim(),style:{cursor:l?"pointer":"default",userSelect:"none",width:"90%",opacity:l?1:.5},onDragOver:h,onDrop:d,...f,onClick:l?t:g=>g.preventDefault(),children:m.jsx("div",{className:"button-label",title:r||"Empty",children:r||"Assign"})})},_y=({assigns:a,onUpdateKnob:t,onToggleButton:r,onAssign:i})=>m.jsxs("div",{className:"global-quick-assigns-panel",children:[m.jsx("div",{className:"quick-assigns-row knobs-row",children:Array.from({length:8}).map((l,u)=>{const f=!!a.knobs[u].link;return m.jsx(Nt,{id:`quick_knob_${u}`,children:m.jsx(Mi,{value:a.knobs[u]?.value||0,label:a.knobs[u]?.label,isAssigned:f,onChange:h=>f&&t(u,h),onDrop:h=>{console.log(`[GlobalQuickAssigns] Knob ${u} Drop Data:`,h),i("knob",u,h)}})},`knob-${u}`)})}),m.jsx("div",{className:"quick-assigns-row buttons-row",children:Array.from({length:8}).map((l,u)=>{const f=!!a.buttons[u].link;return m.jsx(Nt,{id:`quick_btn_${u}`,children:m.jsx(Dy,{value:a.buttons[u]?.value||!1,label:a.buttons[u]?.label,isAssigned:f,onToggle:()=>r(u),onDrop:h=>{console.log(`[GlobalQuickAssigns] Button ${u} Drop Data:`,h),i("button",u,h)}})},`btn-${u}`)})})]}),Oy=({enabledShortcuts:a={},onOpenOutputSettings:t,quickAssigns:r,onUpdateKnob:i,onToggleButton:l,onAssign:u})=>{const{midiInitialized:f,midiInputs:h,selectedMidiInputId:d,setSelectedMidiInputId:g,isMapping:v,startMapping:E,stopMapping:y,learningId:x,lastMidiEvent:S,setMappings:A,saveMappings:N,exportMappings:D,importMappings:L}=su(),{artnetInitialized:M,isMapping:C,startMapping:B,stopMapping:V,setMappings:te,saveMappings:de,exportMappings:ye,importMappings:pe,lastDmxEvent:q}=Df()||{},{isMapping:j,startMapping:$,stopMapping:W,setMappings:J,saveMappings:U,exportMappings:G,importMappings:X}=_f()||{},[me,_]=T.useState([]),[z,ie]=T.useState(""),[ve,ne]=T.useState(!1),[he,xe]=T.useState(57121),[Ye,Be]=T.useState("127.0.0.1"),[st,At]=T.useState(57120),[Ie,Ke]=T.useState(null);T.useEffect(()=>{const Fe=async()=>{if(a.artnet)try{const Je=await window.electronAPI.getArtnetUniverses();_(Je),Je.length>0&&ie(Je[0].id)}catch(Je){console.error("Failed to fetch Art-Net universes:",Je)}},xt=async()=>{if(a.osc)try{if((await window.electronAPI.initializeOsc({localPort:he,remoteAddress:Ye,remotePort:st})).success)return ne(!0),window.electronAPI.onOscMessageReceived(({oscMessage:vn})=>{Ke(vn)})}catch(Je){console.error("Failed to initialize OSC:",Je)}};let Rt=()=>{};return Fe(),xt().then(Je=>{typeof Je=="function"&&(Rt=Je)}),()=>{typeof Rt=="function"&&Rt()}},[a]);const rt=Fe=>g(Fe.target.value),mt=()=>v?y():E(),we=()=>C?V():B(),se=()=>j?W():$();return m.jsxs("div",{className:"settings-panel settings-panel-base",children:[m.jsx("div",{className:"settings-card-header",children:m.jsx("h4",{children:"Global Settings"})}),r&&m.jsx(wn,{title:"Quick Assigns",children:m.jsx(_y,{assigns:r,onUpdateKnob:i,onToggleButton:l,onAssign:u})}),m.jsxs(wn,{title:"Channel/DAC Settings",children:[m.jsx("p",{className:"info-text",children:"Output routing and safety zones configuration."}),m.jsx("button",{className:"small-btn",style:{width:"100%",marginTop:"5px"},onClick:t,children:"Open Output Settings"})]}),(a.midi||a.artnet||a.osc||a.keyboard)&&m.jsxs("div",{className:"shortcuts-settings-panel",children:[a.keyboard&&m.jsx(wn,{title:"Keyboard Shortcuts",children:m.jsxs("div",{className:"keyboard-config",children:[m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${j?"active":""}`,onClick:se,style:{backgroundColor:j?"var(--theme-color)":"",gridColumn:"span 2"},children:j?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:U,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:G,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:X,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>J({}),children:"Clear"})]}),m.jsx("p",{className:"info-text",style:{fontSize:"9px",color:"#666",marginTop:"5px"},children:'Assign keys to buttons/sliders by activating "Start Mapping" and clicking a control.'})]})}),a.midi&&m.jsx(wn,{title:"MIDI Shortcuts",children:f?m.jsxs("div",{className:"midi-config",children:[m.jsx("select",{className:"param-select",value:d,onChange:rt,style:{marginBottom:"8px",width:"100%"},children:h.map(Fe=>m.jsx("option",{value:Fe.id,children:Fe.name},Fe.id))}),m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${v?"active":""}`,onClick:mt,style:{backgroundColor:v?"var(--theme-color)":"",gridColumn:"span 2"},children:v?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:N,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:D,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:L,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>A({}),children:"Clear"})]}),S&&m.jsxs("div",{className:"last-event-status",children:[S.type," ",S.note||S.controller," (CH",S.channel,")"]})]}):m.jsx("p",{className:"loading-text",children:"Initializing MIDI..."})}),a.artnet&&m.jsx(wn,{title:"ArtNet Shortcuts",children:M?m.jsxs("div",{className:"artnet-config",children:[m.jsx("select",{className:"param-select",value:z,onChange:Fe=>{ie(Fe.target.value);const xt=parseInt(Fe.target.value.replace("universe-",""));window.electronAPI&&window.electronAPI.listenArtnetUniverse&&window.electronAPI.listenArtnetUniverse(xt)},style:{marginBottom:"8px",width:"100%"},children:me.map(Fe=>m.jsx("option",{value:Fe.id,children:Fe.name},Fe.id))}),m.jsxs("div",{className:"button-grid",children:[m.jsx("button",{className:`mapping-btn ${C?"active":""}`,onClick:we,style:{backgroundColor:C?"var(--theme-color)":"",gridColumn:"span 2"},children:C?"Stop Mapping":"Start Mapping"}),m.jsx("button",{className:"small-btn",onClick:de,children:"Save Default"}),m.jsx("button",{className:"small-btn",onClick:ye,children:"Export"}),m.jsx("button",{className:"small-btn",onClick:pe,children:"Import"}),m.jsx("button",{className:"small-btn clear",onClick:()=>te({}),children:"Clear"})]}),q&&m.jsxs("div",{className:"last-event-status",children:["UNIV ",q.universe," CH ",q.channel+1," (Val: ",q.value,")"]})]}):m.jsx("p",{className:"loading-text",children:"Initializing Art-Net..."})}),a.osc&&m.jsx(wn,{title:"OSC Shortcuts",children:m.jsx("div",{className:"osc-config",children:m.jsxs("p",{className:"info-text",children:["Listening on port: ",he]})})})]})]})},ky=({show:a,title:t,initialValue:r,onSave:i,onClose:l})=>{const[u,f]=T.useState(r||"");if(T.useEffect(()=>{a&&f(r||"")},[a,r]),!a)return null;const h=()=>{i(u),l()},d=g=>{g.key==="Enter"&&h(),g.key==="Escape"&&l()};return m.jsx("div",{className:"shortcuts-modal-overlay",style:{pointerEvents:"auto"},children:m.jsxs("div",{className:"shortcuts-modal-content",style:{maxWidth:"400px"},children:[m.jsx("h3",{children:t||"Rename"}),m.jsxs("div",{className:"settings-section",style:{border:"none"},children:[m.jsx("input",{type:"text",value:u,onChange:g=>f(g.target.value),onKeyDown:d,autoFocus:!0,style:{width:"100%",padding:"8px",backgroundColor:"#1a1a1a",color:"white",border:"1px solid var(--theme-color)",borderRadius:"4px",marginBottom:"15px"}}),m.jsxs("div",{className:"button-row",style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[m.jsx("button",{onClick:l,children:"Cancel"}),m.jsx("button",{onClick:h,style:{backgroundColor:"var(--theme-color)",color:"black"},children:"Save"})]})]})]})})},Ly=({safetyZones:a,outputArea:t,testLineY:r,testLineEnabled:i,transformationEnabled:l,transformationMode:u,flipX:f,flipY:h,onUpdateSafetyZones:d,onUpdateOutputArea:g,selectedZoneIndex:v,onSelectZone:E,gridSize:y=20,snapToGrid:x=!1})=>{const S=T.useRef(null),[A,N]=T.useState(null),D=(q,j,$)=>{q.strokeStyle="#333",q.lineWidth=1,q.beginPath();for(let W=0;W<=y;W++){const J=W/y,U=J*j,G=J*$;q.moveTo(U,0),q.lineTo(U,$),q.moveTo(0,G),q.lineTo(j,G)}q.stroke(),q.strokeStyle="#666",q.lineWidth=2,q.beginPath(),q.moveTo(j/2,0),q.lineTo(j/2,$),q.moveTo(0,$/2),q.lineTo(j,$/2),q.stroke(),q.fillStyle="#aaa",q.font="10px monospace",q.fillText("0,0",5,12),q.fillText("1,0",j-25,12),q.fillText("0,1",5,$-5),q.fillText("1,1",j-25,$-5)},L=(q,j,$,W=!1,J=!1)=>{const{x:U,y:G,w:X,h:me}=j;if(q.fillStyle=$,q.fillRect(U,G,X,me),q.strokeStyle=W?"#fff":J?"#0089ff":"#ff0000",q.lineWidth=W?2:1,q.strokeRect(U,G,X,me),W||J){q.fillStyle="#fff";const z=(ne,he)=>q.fillRect(ne-6/2,he-6/2,6,6);z(U,G),z(U+X,G),z(U,G+me),z(U+X,G+me);const ie=4;q.fillStyle="#ccc";const ve=(ne,he)=>q.fillRect(ne-ie/2,he-ie/2,ie,ie);ve(U+X/2,G),ve(U+X/2,G+me),ve(U,G+me/2),ve(U+X,G+me/2)}},M=()=>{const q=S.current;if(!q)return;const j=q.getContext("2d"),{width:$,height:W}=q;if(j.clearRect(0,0,$,W),D(j,$,W),l&&t&&L(j,{x:t.x*$,y:t.y*W,w:t.w*$,h:t.h*W},"rgba(0, 137, 255, 0.2)",!1,!0),a.forEach((J,U)=>{L(j,{x:J.x*$,y:J.y*W,w:J.w*$,h:J.h*W},"rgba(255, 0, 0, 0.3)",U===v)}),i){let J=r,U=0,G=1;if(l&&t){if(u==="scale")U=t.x,G=t.x+t.w,J=t.y+J*t.h;else if(u==="crop"){if(J<t.y||J>t.y+t.h)return;U=Math.max(0,t.x),G=Math.min(1,t.x+t.w)}}const X=J*W,me=U*$,_=G*$;let z=[[me,_]];a&&a.length>0&&a.forEach(ie=>{const ve=ie.y*W,ne=ie.h*W,he=ie.x*$,xe=ie.w*$;if(X>=ve&&X<=ve+ne){const Ye=[];z.forEach(Be=>{const[st,At]=Be,Ie=he,Ke=he+xe;Ke<=st||Ie>=At?Ye.push(Be):(Ie>st&&Ye.push([st,Ie]),Ke<At&&Ye.push([Ke,At]))}),z=Ye}}),j.strokeStyle="#00ff00",j.lineWidth=2,j.beginPath(),z.forEach(ie=>{j.moveTo(ie[0],X),j.lineTo(ie[1],X)}),j.stroke()}};T.useEffect(()=>{M()},[a,t,r,i,l,v,y,f,h]);const C=q=>{const j=S.current.getBoundingClientRect();return{x:(q.clientX-j.left)/j.width,y:(q.clientY-j.top)/j.height}},B=(q,j,$)=>{if(!$)return null;const W=.03;return Math.abs(q-$.x)<W&&Math.abs(j-$.y)<W?"nw":Math.abs(q-($.x+$.w))<W&&Math.abs(j-$.y)<W?"ne":Math.abs(q-$.x)<W&&Math.abs(j-($.y+$.h))<W?"sw":Math.abs(q-($.x+$.w))<W&&Math.abs(j-($.y+$.h))<W?"se":Math.abs(j-$.y)<W&&q>=$.x&&q<=$.x+$.w?"n":Math.abs(j-($.y+$.h))<W&&q>=$.x&&q<=$.x+$.w?"s":Math.abs(q-$.x)<W&&j>=$.y&&j<=$.y+$.h?"w":Math.abs(q-($.x+$.w))<W&&j>=$.y&&j<=$.y+$.h?"e":null},V=(q,j,$)=>$?q>=$.x&&q<=$.x+$.w&&j>=$.y&&j<=$.y+$.h:!1,te=q=>{const{x:j,y:$}=C(q);if(v!==null&&a[v]){const W=a[v],J=B(j,$,W);if(J){N({type:"zone",index:v,handle:J,startX:j,startY:$,originalRect:{...W}});return}}for(let W=a.length-1;W>=0;W--){const J=a[W];if(J&&V(j,$,J)){E(W);const U=B(j,$,J);N({type:"zone",index:W,handle:U||"move",startX:j,startY:$,originalRect:{...J}});return}}if(l&&t){const W=B(j,$,t);if(W){N({type:"output",handle:W,startX:j,startY:$,originalRect:{...t}}),E(null);return}if(V(j,$,t)){N({type:"output",handle:"move",startX:j,startY:$,originalRect:{...t}}),E(null);return}}E(null)},de=q=>{if(!x)return q;const j=1/y;return Math.round(q/j)*j},ye=q=>{if(!A)return;const{x:j,y:$}=C(q),W=j-A.startX,J=$-A.startY,U=(G,X,me,_)=>{let z={...G};if(X==="move")z.x=de(G.x+me),z.y=de(G.y+_);else{if(X.includes("w")){const ie=de(G.x+me);z.w=G.x+G.w-ie,z.x=ie}if(X.includes("e")){const ie=de(G.x+G.w+me);z.w=ie-z.x}if(X.includes("n")){const ie=de(G.y+_);z.h=G.y+G.h-ie,z.y=ie}if(X.includes("s")){const ie=de(G.y+G.h+_);z.h=ie-z.y}}return z.w<.01&&(z.w=.01),z.h<.01&&(z.h=.01),z};if(A.type==="zone"){const G=U(A.originalRect,A.handle,W,J);d(A.index,G)}else if(A.type==="output"){const G=U(A.originalRect,A.handle,W,J);g(G)}},pe=()=>{N(null)};return m.jsx("div",{className:"output-canvas-container",style:{width:"100%",height:"100%"},children:m.jsx("canvas",{ref:S,width:600,height:600,style:{width:"100%",height:"100%",display:"block"},className:"output-canvas",onMouseDown:te,onMouseMove:ye,onMouseUp:pe,onMouseLeave:pe})})},Uy=({show:a,onClose:t,dacs:r=[],dacSettings:i={},onUpdateDacSettings:l})=>{const[u,f]=T.useState(null),[h,d]=T.useState(null),[g,v]=T.useState(20),[E,y]=T.useState(!1),x=T.useMemo(()=>{const M=[];return r.forEach(C=>{C.channels&&C.channels.length>0?C.channels.forEach(B=>{M.push({id:`${C.ip}:${B.serviceID}`,displayName:`${C.hostName||C.unitID||"DAC"} : ${B.name||`CH ${B.serviceID}`}`,ip:C.ip,channel:B.serviceID,dacName:C.hostName||C.unitID})}):M.push({id:`${C.ip}:0`,displayName:C.hostName||C.unitID||`DAC ${C.ip}`,ip:C.ip,channel:0,dacName:C.hostName||C.unitID})}),M},[r]);if(T.useEffect(()=>{x.length>0&&!u&&f(x[0].id)},[x,u]),!a)return null;const S=i[u]||{safetyZones:[],outputArea:{x:.1,y:.1,w:.8,h:.8},transformationEnabled:!1,transformationMode:"crop",testLineEnabled:!1,testLineY:.5,flipX:!1,flipY:!1},A=M=>{u&&l(u,{...S,...M})},N=()=>{const M={x:.4,y:.4,w:.2,h:.2};A({safetyZones:[...S.safetyZones,M]}),d(S.safetyZones.length)},D=()=>{A({safetyZones:[]}),d(null)},L=(M,C)=>{const B=[...S.safetyZones];B[M]=C,A({safetyZones:B})};return m.jsx("div",{className:"output-settings-modal-overlay",children:m.jsxs("div",{className:"output-settings-modal-content",children:[m.jsxs("div",{className:"output-settings-header",children:[m.jsx("h2",{children:"Output Settings"}),m.jsx("button",{className:"close-btn",onClick:t,children:"Close"})]}),m.jsxs("div",{className:"output-settings-body",children:[m.jsx("div",{className:"output-settings-col",children:m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Available Outputs"}),m.jsxs("ul",{className:"dac-list",children:[x.length===0?m.jsx("li",{style:{color:"#666",fontStyle:"italic"},children:"No Outputs detected"}):null,x.map((M,C)=>m.jsxs("li",{className:`dac-list-item ${u===M.id?"selected":""}`,onClick:()=>f(M.id),children:[m.jsx("span",{style:{fontWeight:"bold",fontSize:"0.9em"},children:M.displayName}),m.jsx("span",{style:{fontSize:"0.7em",color:"#888"},children:M.ip})]},M.id))]})]})}),m.jsxs("div",{className:"output-settings-col canvas-col",children:[m.jsxs("div",{className:"canvas-toolbar",children:[m.jsx("button",{className:"tool-btn",onClick:N,title:"Add Safety Zone",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-plus-square",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),m.jsx("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})]})}),m.jsx("button",{className:`tool-btn ${S.transformationEnabled?"active":""}`,onClick:()=>A({transformationEnabled:!S.transformationEnabled}),title:"Toggle Output Transformation",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-border-outer",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M7.5 1.906v.938h1v-.938zm0 1.875v.938h1V3.78h-1zm0 1.875v.938h1v-.938zM1.906 8.5h.938v-1h-.938zm1.875 0h.938v-1H3.78v1zm1.875 0h.938v-1h-.938zm2.813 0v-.031H8.5V7.53h-.031V7.5H7.53v.031H7.5v.938h.031V8.5zm.937 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zm1.875 0h.938v-1h-.938zM7.5 9.406v.938h1v-.938zm0 1.875v.938h1v-.938zm0 1.875v.938h1v-.938z"}),m.jsx("path",{d:"M0 0v16h16V0zm1 1h14v14H1z"})]})}),m.jsx("button",{className:`tool-btn ${S.testLineEnabled?"active":""}`,onClick:()=>A({testLineEnabled:!S.testLineEnabled}),title:"Toggle Test Line",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-eye",viewBox:"0 0 16 16",children:[m.jsx("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),m.jsx("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})]})}),m.jsx("span",{style:{width:1,background:"#555",margin:"0 5px"}}),m.jsx("button",{className:`tool-btn ${E?"active":""}`,onClick:()=>y(!E),title:"Snap to Grid",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-magnet-fill",viewBox:"0 0 16 16",children:m.jsx("path",{d:"M15 12h-4v3h4zM5 12H1v3h4zM0 8a8 8 0 1 1 16 0v8h-6V8a2 2 0 1 0-4 0v8H0z"})})}),m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginLeft:5},children:[m.jsx("span",{style:{fontSize:10,color:"#aaa"},children:"Grid:"}),m.jsx("input",{type:"number",min:"5",max:"100",value:g,onChange:M=>v(parseInt(M.target.value)),className:"param-number-input",style:{width:40}})]})]}),m.jsx(Ly,{safetyZones:S.safetyZones,outputArea:S.outputArea,testLineY:S.testLineY,testLineEnabled:S.testLineEnabled,transformationEnabled:S.transformationEnabled,transformationMode:S.transformationMode,flipX:S.flipX,flipY:S.flipY,onUpdateSafetyZones:L,onUpdateOutputArea:M=>A({outputArea:M}),selectedZoneIndex:h,onSelectZone:d,gridSize:g,snapToGrid:E})]}),m.jsx("div",{className:"output-settings-col",children:u?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Output Transformation"}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Enable Editing"}),m.jsx("input",{type:"checkbox",checked:S.transformationEnabled,onChange:M=>A({transformationEnabled:M.target.checked})})]}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Flip X"}),m.jsx("input",{type:"checkbox",checked:S.flipX||!1,onChange:M=>A({flipX:M.target.checked})})]}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Flip Y"}),m.jsx("input",{type:"checkbox",checked:S.flipY||!1,onChange:M=>A({flipY:M.target.checked})})]}),S.transformationEnabled&&m.jsxs("div",{className:"control-row",children:[m.jsx("label",{style:{flex:1},children:"Mode"}),m.jsxs("select",{className:"param-select",value:S.transformationMode,onChange:M=>A({transformationMode:M.target.value}),children:[m.jsx("option",{value:"crop",children:"Crop"}),m.jsx("option",{value:"scale",children:"Scale"})]})]})]}),m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Safety Zones"}),m.jsxs("div",{className:"control-row",style:{justifyContent:"space-between",marginBottom:5},children:[m.jsx("button",{className:"small-btn",onClick:N,children:"Add New"}),m.jsx("button",{className:"small-btn clear",onClick:D,children:"Clear All"})]}),m.jsx("div",{className:"zone-list",children:S.safetyZones.map((M,C)=>m.jsxs("div",{className:`zone-item ${h===C?"selected":""}`,onClick:()=>d(C),children:[m.jsxs("span",{children:["Zone ",C+1]}),m.jsx("button",{className:"delete-zone-btn",onClick:B=>{B.stopPropagation(),h===C&&d(null);const V=S.safetyZones.filter((te,de)=>de!==C);A({safetyZones:V})},children:""})]},C))}),h!==null&&m.jsxs("div",{style:{marginTop:10,borderTop:"1px solid #333",paddingTop:5},children:[m.jsx("label",{children:"Selected Zone Properties"}),m.jsx("div",{style:{fontSize:"0.8em",color:"#aaa"},children:"Select and drag zone on canvas to resize."})]})]}),m.jsxs("div",{className:"settings-group",children:[m.jsx("h4",{children:"Test Output"}),m.jsxs("div",{className:"control-row",style:{marginBottom:10},children:[m.jsx("label",{style:{flex:1},children:"Enable Test Line"}),m.jsx("input",{type:"checkbox",checked:S.testLineEnabled,onChange:M=>A({testLineEnabled:M.target.checked})})]}),S.testLineEnabled&&m.jsxs("div",{className:"control-row",children:[m.jsx("label",{children:"Y Position"}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:S.testLineY,onChange:M=>A({testLineY:parseFloat(M.target.value)}),className:"param-slider"})]})]})]}):m.jsx("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"Select an Output to configure settings"})})]})]})})},dm=()=>{const a=Rl();return a||{}},Iy=({show:a,onClose:t,initialTab:r="output"})=>{const i=Rl(),{fftSettings:l,setFftSettings:u}=i||{},{devices:f,selectedDeviceId:h,setSelectedDeviceId:d,globalVolume:g,setVolume:v}=dm(),[E,y]=T.useState(r);if(_n.useEffect(()=>{a&&y(r)},[a,r]),!a)return null;if(!l)return m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content",style:{padding:"20px",color:"red",border:"1px solid red",background:"#222"},children:[m.jsx("h3",{children:"Error"}),m.jsx("p",{children:"Audio Context is not available."}),m.jsx("p",{children:"Please restart the application or report this bug."}),m.jsx("button",{onClick:t,style:{marginTop:"10px",padding:"5px 10px"},children:"Close"})]}),m.jsx("style",{children:`
                    .modal-overlay {
                        position: fixed;
                        top: 0; left: 0; right: 0; bottom: 0;
                        background: rgba(0, 0, 0, 0.7);
                        display: flex; justify-content: center; align-items: center;
                        z-index: 10000;
                    }
                `})]});const x=(S,A,N)=>{const D={...l},L=`${S}Range`;D[L][A]=parseFloat(N),u(D)};return m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content audio-settings-window",style:{minWidth:"400px"},children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:"Audio Settings"}),m.jsx("button",{className:"close-btn",onClick:t,children:""})]}),m.jsxs("div",{className:"tab-header",style:{display:"flex",gap:"10px",marginBottom:"15px",borderBottom:"1px solid #444"},children:[m.jsx("button",{className:`tab-btn ${E==="output"?"active":""}`,onClick:()=>y("output"),style:{padding:"8px 15px",background:"none",border:"none",color:E==="output"?"var(--theme-color)":"#888",borderBottom:E==="output"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"Audio Output"}),m.jsx("button",{className:`tab-btn ${E==="fft"?"active":""}`,onClick:()=>y("fft"),style:{padding:"8px 15px",background:"none",border:"none",color:E==="fft"?"var(--theme-color)":"#888",borderBottom:E==="fft"?"2px solid var(--theme-color)":"none",cursor:"pointer"},children:"FFT Settings"})]}),m.jsxs("div",{className:"modal-body",children:[E==="output"&&m.jsxs("div",{className:"audio-output-settings",children:[m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Device"}),m.jsx("select",{className:"param-select",value:h,onChange:S=>d(S.target.value),style:{width:"100%",padding:"5px"},children:f.map(S=>m.jsx("option",{value:S.deviceId,children:S.label||`Device ${S.deviceId.slice(0,5)}`},S.deviceId))})]}),m.jsxs("div",{className:"settings-row",style:{textAlign:"center"},children:[m.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Volume"}),m.jsx("div",{style:{display:"flex",justifyContent:"center"},children:m.jsx(Mi,{value:g,onChange:v,label:"MASTER",isAssigned:!0,size:60})})]})]}),E==="fft"&&m.jsxs("div",{className:"fft-settings",children:[m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Source"}),m.jsxs("select",{className:"param-select",value:l.source,onChange:S=>u({...l,source:S.target.value}),style:{width:"100%",padding:"5px"},children:[m.jsx("option",{value:"external",children:"External (Microphone/Loopback)"}),m.jsx("option",{value:"clip",children:"Clip FFT (Audio from active clips)"})]})]}),m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Calculation Mode"}),m.jsxs("select",{className:"param-select",value:l.calculationMode||"average",onChange:S=>u({...l,calculationMode:S.target.value}),style:{width:"100%",padding:"5px"},children:[m.jsx("option",{value:"average",children:"Average (Smooth)"}),m.jsx("option",{value:"peak",children:"Peak (Transient/Punchy)"})]})]}),m.jsxs("div",{className:"settings-row",style:{marginBottom:"15px"},children:[m.jsx("label",{style:{display:"block",marginBottom:"10px"},children:"Ranges (Hz)"}),m.jsxs("div",{className:"range-controls",style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"10px",alignItems:"center"},children:[m.jsx("span",{children:"Low:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:l.lowRange[0],onChange:S=>x("low",0,S.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:l.lowRange[1],onChange:S=>x("low",1,S.target.value),style:{width:"60px"}})]}),m.jsx("span",{children:"Mid:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:l.midRange[0],onChange:S=>x("mid",0,S.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:l.midRange[1],onChange:S=>x("mid",1,S.target.value),style:{width:"60px"}})]}),m.jsx("span",{children:"High:"}),m.jsxs("div",{style:{display:"flex",gap:"5px"},children:[m.jsx("input",{type:"number",value:l.highRange[0],onChange:S=>x("high",0,S.target.value),style:{width:"60px"}}),m.jsx("span",{children:"-"}),m.jsx("input",{type:"number",value:l.highRange[1],onChange:S=>x("high",1,S.target.value),style:{width:"60px"}})]})]})]}),m.jsxs("div",{className:"settings-row",style:{display:"flex",justifyContent:"space-around",textAlign:"center"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"GAIN"}),m.jsx(Mi,{value:l.gain/5,onChange:S=>u({...l,gain:S*5}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"SMOOTH"}),m.jsx(Mi,{value:l.smoothingTimeConstant||.8,onChange:S=>u({...l,smoothingTimeConstant:S}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"HOLD"}),m.jsx(Mi,{value:l.holdTime/1e3,onChange:S=>u({...l,holdTime:S*1e3}),isAssigned:!0,size:40})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"10px"},children:"FALL"}),m.jsx(Mi,{value:l.fallTime/2e3,onChange:S=>u({...l,fallTime:S*2e3}),isAssigned:!0,size:40})]})]})]})]})]}),m.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .param-select, input {
                    background: #111;
                    border: 1px solid #444;
                    color: white;
                    border-radius: 4px;
                }
            `})]})},By=({missingFiles:a,onRelocate:t,onClose:r})=>!a||a.length===0?null:m.jsxs("div",{className:"modal-overlay",children:[m.jsxs("div",{className:"modal-content",style:{width:"500px",maxHeight:"80vh",display:"flex",flexDirection:"column"},children:[m.jsxs("div",{className:"modal-header",children:[m.jsx("h3",{children:"Missing Files"}),m.jsx("button",{className:"close-btn",onClick:r,children:""})]}),m.jsxs("div",{className:"modal-body",style:{overflowY:"auto",flex:1},children:[m.jsx("p",{style:{marginBottom:"15px",color:"#ccc",fontSize:"0.9em"},children:"The following files could not be found. Please locate one of them to update the path for all matching files in the same directory."}),m.jsx("ul",{style:{listStyle:"none",padding:0},children:a.map((i,l)=>m.jsxs("li",{style:{background:"#333",padding:"10px",marginBottom:"5px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsxs("div",{style:{overflow:"hidden"},children:[m.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9em"},children:i.fileName}),m.jsx("div",{style:{fontSize:"0.8em",color:"#888",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"350px"},children:i.filePath})]}),m.jsx("button",{className:"small-btn",onClick:()=>t(i),style:{marginLeft:"10px",whiteSpace:"nowrap"},children:"Locate"})]},l))})]})]}),m.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex; justify-content: center; align-items: center;
                    z-index: 10000;
                }
                .modal-content {
                    background: #222;
                    color: white;
                    border-radius: 8px;
                    border: 1px solid #444;
                    padding: 0;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                }
                .modal-header {
                    background: #333;
                    padding: 10px 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .modal-body {
                    padding: 20px;
                }
                .close-btn {
                    background: none;
                    border: none;
                    color: #888;
                    font-size: 24px;
                    cursor: pointer;
                }
                .close-btn:hover {
                    color: white;
                }
                .small-btn {
                    background: var(--theme-color);
                    color: black;
                    border: none;
                    padding: 5px 10px;
                    border-radius: 3px;
                    cursor: pointer;
                    font-weight: bold;
                }
                .small-btn:hover {
                    opacity: 0.9;
                }
            `})]});class Fy extends _n.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?m.jsx("h1",{children:"Something went wrong."}):this.props.children}}const pm=T.createContext(null),jy=({children:a})=>{const t=T.useMemo(()=>{try{const r=new Worker(new URL(""+new URL("generators.worker-IWR7v-Yo.js",import.meta.url).href,import.meta.url),{type:"module"});return r.onerror=i=>{console.error("Generator Worker instantiation or internal error:",i)},r}catch(r){return console.error("Failed to create Generator Worker:",r),null}},[]);return T.useEffect(()=>{if(t)return()=>{t.terminate()}},[t]),m.jsx(pm.Provider,{value:t,children:a})},Py=()=>{const a=T.useContext(pm);if(a===void 0)throw new Error("useGeneratorWorker must be used within a GeneratorWorkerProvider");return a};var Gy=$0();const zy=Nf(Gy),Hy=()=>{const{isMapping:a,mappings:t,learningId:r}=su(),{isMapping:i,mappings:l,learningId:u}=Df()||{},{isMapping:f,mappings:h,learningId:d}=_f()||{},g=a||i||f,[v,E]=T.useState([]),y=T.useCallback(()=>{if(!g)return;const x=document.querySelectorAll("[data-mappable-id]"),S=Array.from(x).map(A=>{const N=A.getBoundingClientRect();return{id:A.getAttribute("data-mappable-id"),rect:{top:N.top,left:N.left,width:N.width,height:N.height}}});E(S)},[g]);return T.useEffect(()=>{if(g){y(),window.addEventListener("resize",y);const x=setTimeout(y,100);return()=>{window.removeEventListener("resize",y),clearTimeout(x)}}else E([])},[g,y]),g?zy.createPortal(m.jsx("div",{className:"midi-mapping-global-overlay-container",children:v.map(x=>{const S=t[x.id],A=l?l[x.id]:null,N=h?h[x.id]:null,D=a&&r===x.id||i&&u===x.id||f&&d===x.id;let L=null;return a?L=S?S.label:null:i?L=A?A.label:null:f&&(L=N?N.label:null),m.jsx("div",{className:`midi-mapping-label-box ${D?"learning":""} ${L?"mapped":""} ${i?"artnet-mapping":""} ${f?"keyboard-mapping":""}`,style:{position:"fixed",top:x.rect.top,left:x.rect.left,width:x.rect.width,height:x.rect.height,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:m.jsx("div",{className:"mapping-label",children:L||"+"})},x.id)})}),document.body):null};String.prototype.codePointAt||(function(){var a=(function(){try{var r={},i=Object.defineProperty,l=i(r,r,r)&&i}catch{}return l})(),t=function(r){if(this==null)throw TypeError();var i=String(this),l=i.length,u=r?Number(r):0;if(u!=u&&(u=0),!(u<0||u>=l)){var f=i.charCodeAt(u),h;return f>=55296&&f<=56319&&l>u+1&&(h=i.charCodeAt(u+1),h>=56320&&h<=57343)?(f-55296)*1024+h-56320+65536:f}};a?a(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t})();function hm(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var Yy=new hm,qy=new hm,mm=new Uint8Array(30),gm=new Uint16Array(30),Vy=new Uint8Array(30),Xy=new Uint16Array(30);function vm(a,t,r,i){var l,u;for(l=0;l<r;++l)a[l]=0;for(l=0;l<30-r;++l)a[l+r]=l/r|0;for(u=i,l=0;l<30;++l)t[l]=u,u+=1<<a[l]}function Zy(a,t){var r;for(r=0;r<7;++r)a.table[r]=0;for(a.table[7]=24,a.table[8]=152,a.table[9]=112,r=0;r<24;++r)a.trans[r]=256+r;for(r=0;r<144;++r)a.trans[24+r]=r;for(r=0;r<8;++r)a.trans[168+r]=280+r;for(r=0;r<112;++r)a.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}Zy(Yy,qy);vm(mm,gm,4,3);vm(Vy,Xy,2,1);mm[28]=0;gm[28]=258;function gs(a,t,r,i,l){return Math.pow(1-l,3)*a+3*Math.pow(1-l,2)*l*t+3*(1-l)*Math.pow(l,2)*r+Math.pow(l,3)*i}function Wr(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}Wr.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};Wr.prototype.addPoint=function(a,t){typeof a=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),typeof t=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))};Wr.prototype.addX=function(a){this.addPoint(a,null)};Wr.prototype.addY=function(a){this.addPoint(null,a)};Wr.prototype.addBezier=function(a,t,r,i,l,u,f,h){var d=[a,t],g=[r,i],v=[l,u],E=[f,h];this.addPoint(a,t),this.addPoint(f,h);for(var y=0;y<=1;y++){var x=6*d[y]-12*g[y]+6*v[y],S=-3*d[y]+9*g[y]-9*v[y]+3*E[y],A=3*g[y]-3*d[y];if(S===0){if(x===0)continue;var N=-A/x;0<N&&N<1&&(y===0&&this.addX(gs(d[y],g[y],v[y],E[y],N)),y===1&&this.addY(gs(d[y],g[y],v[y],E[y],N)));continue}var D=Math.pow(x,2)-4*A*S;if(!(D<0)){var L=(-x+Math.sqrt(D))/(2*S);0<L&&L<1&&(y===0&&this.addX(gs(d[y],g[y],v[y],E[y],L)),y===1&&this.addY(gs(d[y],g[y],v[y],E[y],L)));var M=(-x-Math.sqrt(D))/(2*S);0<M&&M<1&&(y===0&&this.addX(gs(d[y],g[y],v[y],E[y],M)),y===1&&this.addY(gs(d[y],g[y],v[y],E[y],M)))}}};Wr.prototype.addQuad=function(a,t,r,i,l,u){var f=a+.6666666666666666*(r-a),h=t+2/3*(i-t),d=f+1/3*(l-a),g=h+1/3*(u-t);this.addBezier(a,t,f,h,d,g,l,u)};function Wt(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}Wt.prototype.moveTo=function(a,t){this.commands.push({type:"M",x:a,y:t})};Wt.prototype.lineTo=function(a,t){this.commands.push({type:"L",x:a,y:t})};Wt.prototype.curveTo=Wt.prototype.bezierCurveTo=function(a,t,r,i,l,u){this.commands.push({type:"C",x1:a,y1:t,x2:r,y2:i,x:l,y:u})};Wt.prototype.quadTo=Wt.prototype.quadraticCurveTo=function(a,t,r,i){this.commands.push({type:"Q",x1:a,y1:t,x:r,y:i})};Wt.prototype.close=Wt.prototype.closePath=function(){this.commands.push({type:"Z"})};Wt.prototype.extend=function(a){if(a.commands)a=a.commands;else if(a instanceof Wr){var t=a;this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),this.close();return}Array.prototype.push.apply(this.commands,a)};Wt.prototype.getBoundingBox=function(){for(var a=new Wr,t=0,r=0,i=0,l=0,u=0;u<this.commands.length;u++){var f=this.commands[u];switch(f.type){case"M":a.addPoint(f.x,f.y),t=i=f.x,r=l=f.y;break;case"L":a.addPoint(f.x,f.y),i=f.x,l=f.y;break;case"Q":a.addQuad(i,l,f.x1,f.y1,f.x,f.y),i=f.x,l=f.y;break;case"C":a.addBezier(i,l,f.x1,f.y1,f.x2,f.y2,f.x,f.y),i=f.x,l=f.y;break;case"Z":i=t,l=r;break;default:throw new Error("Unexpected path command "+f.type)}}return a.isEmpty()&&a.addPoint(0,0),a};Wt.prototype.draw=function(a){a.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];r.type==="M"?a.moveTo(r.x,r.y):r.type==="L"?a.lineTo(r.x,r.y):r.type==="C"?a.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):r.type==="Q"?a.quadraticCurveTo(r.x1,r.y1,r.x,r.y):r.type==="Z"&&a.closePath()}this.fill&&(a.fillStyle=this.fill,a.fill()),this.stroke&&(a.strokeStyle=this.stroke,a.lineWidth=this.strokeWidth,a.stroke())};Wt.prototype.toPathData=function(a){a=a!==void 0?a:2;function t(f){return Math.round(f)===f?""+Math.round(f):f.toFixed(a)}function r(){for(var f=arguments,h="",d=0;d<arguments.length;d+=1){var g=f[d];g>=0&&d>0&&(h+=" "),h+=t(g)}return h}for(var i="",l=0;l<this.commands.length;l+=1){var u=this.commands[l];u.type==="M"?i+="M"+r(u.x,u.y):u.type==="L"?i+="L"+r(u.x,u.y):u.type==="C"?i+="C"+r(u.x1,u.y1,u.x2,u.y2,u.x,u.y):u.type==="Q"?i+="Q"+r(u.x1,u.y1,u.x,u.y):u.type==="Z"&&(i+="Z")}return i};Wt.prototype.toSVG=function(a){var t='<path d="';return t+=this.toPathData(a),t+='"',this.fill&&this.fill!=="black"&&(this.fill===null?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>",t};Wt.prototype.toDOMElement=function(a){var t=this.toPathData(a),r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",t),r};function ym(a){throw new Error(a)}function d0(a,t){a||ym(t)}var We={fail:ym,argument:d0,assert:d0},p0=32768,h0=2147483648,bs={},Ae={},Ze={};function xa(a){return function(){return a}}Ae.BYTE=function(a){return We.argument(a>=0&&a<=255,"Byte value should be between 0 and 255."),[a]};Ze.BYTE=xa(1);Ae.CHAR=function(a){return[a.charCodeAt(0)]};Ze.CHAR=xa(1);Ae.CHARARRAY=function(a){typeof a>"u"&&(a="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],r=0;r<a.length;r+=1)t[r]=a.charCodeAt(r);return t};Ze.CHARARRAY=function(a){return typeof a>"u"?0:a.length};Ae.USHORT=function(a){return[a>>8&255,a&255]};Ze.USHORT=xa(2);Ae.SHORT=function(a){return a>=p0&&(a=-(2*p0-a)),[a>>8&255,a&255]};Ze.SHORT=xa(2);Ae.UINT24=function(a){return[a>>16&255,a>>8&255,a&255]};Ze.UINT24=xa(3);Ae.ULONG=function(a){return[a>>24&255,a>>16&255,a>>8&255,a&255]};Ze.ULONG=xa(4);Ae.LONG=function(a){return a>=h0&&(a=-(2*h0-a)),[a>>24&255,a>>16&255,a>>8&255,a&255]};Ze.LONG=xa(4);Ae.FIXED=Ae.ULONG;Ze.FIXED=Ze.ULONG;Ae.FWORD=Ae.SHORT;Ze.FWORD=Ze.SHORT;Ae.UFWORD=Ae.USHORT;Ze.UFWORD=Ze.USHORT;Ae.LONGDATETIME=function(a){return[0,0,0,0,a>>24&255,a>>16&255,a>>8&255,a&255]};Ze.LONGDATETIME=xa(8);Ae.TAG=function(a){return We.argument(a.length===4,"Tag should be exactly 4 ASCII characters."),[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]};Ze.TAG=xa(4);Ae.Card8=Ae.BYTE;Ze.Card8=Ze.BYTE;Ae.Card16=Ae.USHORT;Ze.Card16=Ze.USHORT;Ae.OffSize=Ae.BYTE;Ze.OffSize=Ze.BYTE;Ae.SID=Ae.USHORT;Ze.SID=Ze.USHORT;Ae.NUMBER=function(a){return a>=-107&&a<=107?[a+139]:a>=108&&a<=1131?(a=a-108,[(a>>8)+247,a&255]):a>=-1131&&a<=-108?(a=-a-108,[(a>>8)+251,a&255]):a>=-32768&&a<=32767?Ae.NUMBER16(a):Ae.NUMBER32(a)};Ze.NUMBER=function(a){return Ae.NUMBER(a).length};Ae.NUMBER16=function(a){return[28,a>>8&255,a&255]};Ze.NUMBER16=xa(3);Ae.NUMBER32=function(a){return[29,a>>24&255,a>>16&255,a>>8&255,a&255]};Ze.NUMBER32=xa(5);Ae.REAL=function(a){var t=a.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(r){var i=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));t=(Math.round(a*i)/i).toString()}for(var l="",u=0,f=t.length;u<f;u+=1){var h=t[u];h==="e"?l+=t[++u]==="-"?"c":"b":h==="."?l+="a":h==="-"?l+="e":l+=h}l+=l.length&1?"f":"ff";for(var d=[30],g=0,v=l.length;g<v;g+=2)d.push(parseInt(l.substr(g,2),16));return d};Ze.REAL=function(a){return Ae.REAL(a).length};Ae.NAME=Ae.CHARARRAY;Ze.NAME=Ze.CHARARRAY;Ae.STRING=Ae.CHARARRAY;Ze.STRING=Ze.CHARARRAY;bs.UTF8=function(a,t,r){for(var i=[],l=r,u=0;u<l;u++,t+=1)i[u]=a.getUint8(t);return String.fromCharCode.apply(null,i)};bs.UTF16=function(a,t,r){for(var i=[],l=r/2,u=0;u<l;u++,t+=2)i[u]=a.getUint16(t);return String.fromCharCode.apply(null,i)};Ae.UTF16=function(a){for(var t=[],r=0;r<a.length;r+=1){var i=a.charCodeAt(r);t[t.length]=i>>8&255,t[t.length]=i&255}return t};Ze.UTF16=function(a){return a.length*2};var xf={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};bs.MACSTRING=function(a,t,r,i){var l=xf[i];if(l!==void 0){for(var u="",f=0;f<r;f++){var h=a.getUint8(t+f);h<=127?u+=String.fromCharCode(h):u+=l[h&127]}return u}};var qo=typeof WeakMap=="function"&&new WeakMap,Vo,Qy=function(a){if(!Vo){Vo={};for(var t in xf)Vo[t]=new String(t)}var r=Vo[a];if(r!==void 0){if(qo){var i=qo.get(r);if(i!==void 0)return i}var l=xf[a];if(l!==void 0){for(var u={},f=0;f<l.length;f++)u[l.charCodeAt(f)]=f+128;return qo&&qo.set(r,u),u}}};Ae.MACSTRING=function(a,t){var r=Qy(t);if(r!==void 0){for(var i=[],l=0;l<a.length;l++){var u=a.charCodeAt(l);if(u>=128&&(u=r[u],u===void 0))return;i[l]=u}return i}};Ze.MACSTRING=function(a,t){var r=Ae.MACSTRING(a,t);return r!==void 0?r.length:0};function Sf(a){return a>=-128&&a<=127}function $y(a,t,r){for(var i=0,l=a.length;t<l&&i<64&&a[t]===0;)++t,++i;return r.push(128|i-1),t}function Wy(a,t,r){for(var i=0,l=a.length,u=t;u<l&&i<64;){var f=a[u];if(!Sf(f)||f===0&&u+1<l&&a[u+1]===0)break;++u,++i}r.push(i-1);for(var h=t;h<u;++h)r.push(a[h]+256&255);return u}function Ky(a,t,r){for(var i=0,l=a.length,u=t;u<l&&i<64;){var f=a[u];if(f===0||Sf(f)&&u+1<l&&Sf(a[u+1]))break;++u,++i}r.push(64|i-1);for(var h=t;h<u;++h){var d=a[h];r.push(d+65536>>8&255,d+256&255)}return u}Ae.VARDELTAS=function(a){for(var t=0,r=[];t<a.length;){var i=a[t];i===0?t=$y(a,t,r):i>=-128&&i<=127?t=Wy(a,t,r):t=Ky(a,t,r)}return r};Ae.INDEX=function(a){for(var t=1,r=[t],i=[],l=0;l<a.length;l+=1){var u=Ae.OBJECT(a[l]);Array.prototype.push.apply(i,u),t+=u.length,r.push(t)}if(i.length===0)return[0,0];for(var f=[],h=1+Math.floor(Math.log(t)/Math.log(2))/8|0,d=[void 0,Ae.BYTE,Ae.USHORT,Ae.UINT24,Ae.ULONG][h],g=0;g<r.length;g+=1){var v=d(r[g]);Array.prototype.push.apply(f,v)}return Array.prototype.concat(Ae.Card16(a.length),Ae.OffSize(h),f,i)};Ze.INDEX=function(a){return Ae.INDEX(a).length};Ae.DICT=function(a){for(var t=[],r=Object.keys(a),i=r.length,l=0;l<i;l+=1){var u=parseInt(r[l],0),f=a[u];t=t.concat(Ae.OPERAND(f.value,f.type)),t=t.concat(Ae.OPERATOR(u))}return t};Ze.DICT=function(a){return Ae.DICT(a).length};Ae.OPERATOR=function(a){return a<1200?[a]:[12,a-1200]};Ae.OPERAND=function(a,t){var r=[];if(Array.isArray(t))for(var i=0;i<t.length;i+=1)We.argument(a.length===t.length,"Not enough arguments given for type"+t),r=r.concat(Ae.OPERAND(a[i],t[i]));else if(t==="SID")r=r.concat(Ae.NUMBER(a));else if(t==="offset")r=r.concat(Ae.NUMBER32(a));else if(t==="number")r=r.concat(Ae.NUMBER(a));else if(t==="real")r=r.concat(Ae.REAL(a));else throw new Error("Unknown operand type "+t);return r};Ae.OP=Ae.BYTE;Ze.OP=Ze.BYTE;var Xo=typeof WeakMap=="function"&&new WeakMap;Ae.CHARSTRING=function(a){if(Xo){var t=Xo.get(a);if(t!==void 0)return t}for(var r=[],i=a.length,l=0;l<i;l+=1){var u=a[l];r=r.concat(Ae[u.type](u.value))}return Xo&&Xo.set(a,r),r};Ze.CHARSTRING=function(a){return Ae.CHARSTRING(a).length};Ae.OBJECT=function(a){var t=Ae[a.type];return We.argument(t!==void 0,"No encoding function for type "+a.type),t(a.value)};Ze.OBJECT=function(a){var t=Ze[a.type];return We.argument(t!==void 0,"No sizeOf function for type "+a.type),t(a.value)};Ae.TABLE=function(a){for(var t=[],r=a.fields.length,i=[],l=[],u=0;u<r;u+=1){var f=a.fields[u],h=Ae[f.type];We.argument(h!==void 0,"No encoding function for field type "+f.type+" ("+f.name+")");var d=a[f.name];d===void 0&&(d=f.value);var g=h(d);f.type==="TABLE"?(l.push(t.length),t=t.concat([0,0]),i.push(g)):t=t.concat(g)}for(var v=0;v<i.length;v+=1){var E=l[v],y=t.length;We.argument(y<65536,"Table "+a.tableName+" too big."),t[E]=y>>8,t[E+1]=y&255,t=t.concat(i[v])}return t};Ze.TABLE=function(a){for(var t=0,r=a.fields.length,i=0;i<r;i+=1){var l=a.fields[i],u=Ze[l.type];We.argument(u!==void 0,"No sizeOf function for field type "+l.type+" ("+l.name+")");var f=a[l.name];f===void 0&&(f=l.value),t+=u(f),l.type==="TABLE"&&(t+=2)}return t};Ae.RECORD=Ae.TABLE;Ze.RECORD=Ze.TABLE;Ae.LITERAL=function(a){return a};Ze.LITERAL=function(a){return a.length};function nn(a,t,r){if(t.length&&(t[0].name!=="coverageFormat"||t[0].value===1))for(var i=0;i<t.length;i+=1){var l=t[i];this[l.name]=l.value}if(this.tableName=a,this.fields=t,r)for(var u=Object.keys(r),f=0;f<u.length;f+=1){var h=u[f],d=r[h];this[h]!==void 0&&(this[h]=d)}}nn.prototype.encode=function(){return Ae.TABLE(this)};nn.prototype.sizeOf=function(){return Ze.TABLE(this)};function Cl(a,t,r){r===void 0&&(r=t.length);var i=new Array(t.length+1);i[0]={name:a+"Count",type:"USHORT",value:r};for(var l=0;l<t.length;l++)i[l+1]={name:a+l,type:"USHORT",value:t[l]};return i}function Ef(a,t,r){var i=t.length,l=new Array(i+1);l[0]={name:a+"Count",type:"USHORT",value:i};for(var u=0;u<i;u++)l[u+1]={name:a+u,type:"TABLE",value:r(t[u],u)};return l}function Ml(a,t,r){var i=t.length,l=[];l[0]={name:a+"Count",type:"USHORT",value:i};for(var u=0;u<i;u++)l=l.concat(r(t[u],u));return l}function eu(a){a.format===1?nn.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Cl("glyph",a.glyphs))):a.format===2?nn.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(Ml("rangeRecord",a.ranges,function(t){return[{name:"startGlyphID",type:"USHORT",value:t.start},{name:"endGlyphID",type:"USHORT",value:t.end},{name:"startCoverageIndex",type:"USHORT",value:t.index}]}))):We.assert(!1,"Coverage format must be 1 or 2.")}eu.prototype=Object.create(nn.prototype);eu.prototype.constructor=eu;function tu(a){nn.call(this,"scriptListTable",Ml("scriptRecord",a,function(t,r){var i=t.script,l=i.defaultLangSys;return We.assert(!!l,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+r,type:"TAG",value:t.tag},{name:"script"+r,type:"TABLE",value:new nn("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new nn("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:l.reqFeatureIndex}].concat(Cl("featureIndex",l.featureIndexes)))}].concat(Ml("langSys",i.langSysRecords,function(u,f){var h=u.langSys;return[{name:"langSysTag"+f,type:"TAG",value:u.tag},{name:"langSys"+f,type:"TABLE",value:new nn("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:h.reqFeatureIndex}].concat(Cl("featureIndex",h.featureIndexes)))}]})))}]}))}tu.prototype=Object.create(nn.prototype);tu.prototype.constructor=tu;function nu(a){nn.call(this,"featureListTable",Ml("featureRecord",a,function(t,r){var i=t.feature;return[{name:"featureTag"+r,type:"TAG",value:t.tag},{name:"feature"+r,type:"TABLE",value:new nn("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(Cl("lookupListIndex",i.lookupListIndexes)))}]}))}nu.prototype=Object.create(nn.prototype);nu.prototype.constructor=nu;function au(a,t){nn.call(this,"lookupListTable",Ef("lookup",a,function(r){var i=t[r.lookupType];return We.assert(!!i,"Unable to write GSUB lookup type "+r.lookupType+" tables."),new nn("lookupTable",[{name:"lookupType",type:"USHORT",value:r.lookupType},{name:"lookupFlag",type:"USHORT",value:r.lookupFlag}].concat(Ef("subtable",r.subtables,i)))}))}au.prototype=Object.create(nn.prototype);au.prototype.constructor=au;var _e={Table:nn,Record:nn,Coverage:eu,ScriptList:tu,FeatureList:nu,LookupList:au,ushortList:Cl,tableList:Ef,recordList:Ml};function m0(a,t){return a.getUint8(t)}function ru(a,t){return a.getUint16(t,!1)}function Jy(a,t){return a.getInt16(t,!1)}function kf(a,t){return a.getUint32(t,!1)}function bm(a,t){var r=a.getInt16(t,!1),i=a.getUint16(t+2,!1);return r+i/65535}function e1(a,t){for(var r="",i=t;i<t+4;i+=1)r+=String.fromCharCode(a.getInt8(i));return r}function t1(a,t,r){for(var i=0,l=0;l<r;l+=1)i<<=8,i+=a.getUint8(t+l);return i}function n1(a,t,r){for(var i=[],l=t;l<r;l+=1)i.push(a.getUint8(l));return i}function a1(a){for(var t="",r=0;r<a.length;r+=1)t+=String.fromCharCode(a[r]);return t}var r1={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function re(a,t){this.data=a,this.offset=t,this.relativeOffset=0}re.prototype.parseByte=function(){var a=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,a};re.prototype.parseChar=function(){var a=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,a};re.prototype.parseCard8=re.prototype.parseByte;re.prototype.parseUShort=function(){var a=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,a};re.prototype.parseCard16=re.prototype.parseUShort;re.prototype.parseSID=re.prototype.parseUShort;re.prototype.parseOffset16=re.prototype.parseUShort;re.prototype.parseShort=function(){var a=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,a};re.prototype.parseF2Dot14=function(){var a=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,a};re.prototype.parseULong=function(){var a=kf(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,a};re.prototype.parseOffset32=re.prototype.parseULong;re.prototype.parseFixed=function(){var a=bm(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,a};re.prototype.parseString=function(a){var t=this.data,r=this.offset+this.relativeOffset,i="";this.relativeOffset+=a;for(var l=0;l<a;l++)i+=String.fromCharCode(t.getUint8(r+l));return i};re.prototype.parseTag=function(){return this.parseString(4)};re.prototype.parseLongDateTime=function(){var a=kf(this.data,this.offset+this.relativeOffset+4);return a-=2082844800,this.relativeOffset+=8,a};re.prototype.parseVersion=function(a){var t=ru(this.data,this.offset+this.relativeOffset),r=ru(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,a===void 0&&(a=4096),t+r/a/10};re.prototype.skip=function(a,t){t===void 0&&(t=1),this.relativeOffset+=r1[a]*t};re.prototype.parseULongList=function(a){a===void 0&&(a=this.parseULong());for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getUint32(i),i+=4;return this.relativeOffset+=a*4,t};re.prototype.parseOffset16List=re.prototype.parseUShortList=function(a){a===void 0&&(a=this.parseUShort());for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getUint16(i),i+=2;return this.relativeOffset+=a*2,t};re.prototype.parseShortList=function(a){for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getInt16(i),i+=2;return this.relativeOffset+=a*2,t};re.prototype.parseByteList=function(a){for(var t=new Array(a),r=this.data,i=this.offset+this.relativeOffset,l=0;l<a;l++)t[l]=r.getUint8(i++);return this.relativeOffset+=a,t};re.prototype.parseList=function(a,t){t||(t=a,a=this.parseUShort());for(var r=new Array(a),i=0;i<a;i++)r[i]=t.call(this);return r};re.prototype.parseList32=function(a,t){t||(t=a,a=this.parseULong());for(var r=new Array(a),i=0;i<a;i++)r[i]=t.call(this);return r};re.prototype.parseRecordList=function(a,t){t||(t=a,a=this.parseUShort());for(var r=new Array(a),i=Object.keys(t),l=0;l<a;l++){for(var u={},f=0;f<i.length;f++){var h=i[f],d=t[h];u[h]=d.call(this)}r[l]=u}return r};re.prototype.parseRecordList32=function(a,t){t||(t=a,a=this.parseULong());for(var r=new Array(a),i=Object.keys(t),l=0;l<a;l++){for(var u={},f=0;f<i.length;f++){var h=i[f],d=t[h];u[h]=d.call(this)}r[l]=u}return r};re.prototype.parseStruct=function(a){if(typeof a=="function")return a.call(this);for(var t=Object.keys(a),r={},i=0;i<t.length;i++){var l=t[i],u=a[l];r[l]=u.call(this)}return r};re.prototype.parseValueRecord=function(a){if(a===void 0&&(a=this.parseUShort()),a!==0){var t={};return a&1&&(t.xPlacement=this.parseShort()),a&2&&(t.yPlacement=this.parseShort()),a&4&&(t.xAdvance=this.parseShort()),a&8&&(t.yAdvance=this.parseShort()),a&16&&(t.xPlaDevice=void 0,this.parseShort()),a&32&&(t.yPlaDevice=void 0,this.parseShort()),a&64&&(t.xAdvDevice=void 0,this.parseShort()),a&128&&(t.yAdvDevice=void 0,this.parseShort()),t}};re.prototype.parseValueRecordList=function(){for(var a=this.parseUShort(),t=this.parseUShort(),r=new Array(t),i=0;i<t;i++)r[i]=this.parseValueRecord(a);return r};re.prototype.parsePointer=function(a){var t=this.parseOffset16();if(t>0)return new re(this.data,this.offset+t).parseStruct(a)};re.prototype.parsePointer32=function(a){var t=this.parseOffset32();if(t>0)return new re(this.data,this.offset+t).parseStruct(a)};re.prototype.parseListOfLists=function(a){for(var t=this.parseOffset16List(),r=t.length,i=this.relativeOffset,l=new Array(r),u=0;u<r;u++){var f=t[u];if(f===0){l[u]=void 0;continue}if(this.relativeOffset=f,a){for(var h=this.parseOffset16List(),d=new Array(h.length),g=0;g<h.length;g++)this.relativeOffset=f+h[g],d[g]=a.call(this);l[u]=d}else l[u]=this.parseUShortList()}return this.relativeOffset=i,l};re.prototype.parseCoverage=function(){var a=this.offset+this.relativeOffset,t=this.parseUShort(),r=this.parseUShort();if(t===1)return{format:1,glyphs:this.parseUShortList(r)};if(t===2){for(var i=new Array(r),l=0;l<r;l++)i[l]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}throw new Error("0x"+a.toString(16)+": Coverage format must be 1 or 2.")};re.prototype.parseClassDef=function(){var a=this.offset+this.relativeOffset,t=this.parseUShort();if(t===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(t===2)return{format:2,ranges:this.parseRecordList({start:re.uShort,end:re.uShort,classId:re.uShort})};throw new Error("0x"+a.toString(16)+": ClassDef format must be 1 or 2.")};re.list=function(a,t){return function(){return this.parseList(a,t)}};re.list32=function(a,t){return function(){return this.parseList32(a,t)}};re.recordList=function(a,t){return function(){return this.parseRecordList(a,t)}};re.recordList32=function(a,t){return function(){return this.parseRecordList32(a,t)}};re.pointer=function(a){return function(){return this.parsePointer(a)}};re.pointer32=function(a){return function(){return this.parsePointer32(a)}};re.tag=re.prototype.parseTag;re.byte=re.prototype.parseByte;re.uShort=re.offset16=re.prototype.parseUShort;re.uShortList=re.prototype.parseUShortList;re.uLong=re.offset32=re.prototype.parseULong;re.uLongList=re.prototype.parseULongList;re.struct=re.prototype.parseStruct;re.coverage=re.prototype.parseCoverage;re.classDef=re.prototype.parseClassDef;var g0={reserved:re.uShort,reqFeatureIndex:re.uShort,featureIndexes:re.uShortList};re.prototype.parseScriptList=function(){return this.parsePointer(re.recordList({tag:re.tag,script:re.pointer({defaultLangSys:re.pointer(g0),langSysRecords:re.recordList({tag:re.tag,langSys:re.pointer(g0)})})}))||[]};re.prototype.parseFeatureList=function(){return this.parsePointer(re.recordList({tag:re.tag,feature:re.pointer({featureParams:re.offset16,lookupListIndexes:re.uShortList})}))||[]};re.prototype.parseLookupList=function(a){return this.parsePointer(re.list(re.pointer(function(){var t=this.parseUShort();We.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var r=this.parseUShort(),i=r&16;return{lookupType:t,lookupFlag:r,subtables:this.parseList(re.pointer(a[t])),markFilteringSet:i?this.parseUShort():void 0}})))||[]};re.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var a=this.parseUShort(),t=this.parseUShort();We.argument(a===1&&t<1,"GPOS/GSUB feature variations table unknown.");var r=this.parseRecordList32({conditionSetOffset:re.offset32,featureTableSubstitutionOffset:re.offset32});return r})||[]};var et={getByte:m0,getCard8:m0,getUShort:ru,getCard16:ru,getShort:Jy,getULong:kf,getFixed:bm,getTag:e1,getOffset:t1,getBytes:n1,bytesToString:a1,Parser:re};function i1(a,t){t.parseUShort(),a.length=t.parseULong(),a.language=t.parseULong();var r;a.groupCount=r=t.parseULong(),a.glyphIndexMap={};for(var i=0;i<r;i+=1)for(var l=t.parseULong(),u=t.parseULong(),f=t.parseULong(),h=l;h<=u;h+=1)a.glyphIndexMap[h]=f,f++}function s1(a,t,r,i,l){a.length=t.parseUShort(),a.language=t.parseUShort();var u;a.segCount=u=t.parseUShort()>>1,t.skip("uShort",3),a.glyphIndexMap={};for(var f=new et.Parser(r,i+l+14),h=new et.Parser(r,i+l+16+u*2),d=new et.Parser(r,i+l+16+u*4),g=new et.Parser(r,i+l+16+u*6),v=i+l+16+u*8,E=0;E<u-1;E+=1)for(var y=void 0,x=f.parseUShort(),S=h.parseUShort(),A=d.parseShort(),N=g.parseUShort(),D=S;D<=x;D+=1)N!==0?(v=g.offset+g.relativeOffset-2,v+=N,v+=(D-S)*2,y=et.getUShort(r,v),y!==0&&(y=y+A&65535)):y=D+A&65535,a.glyphIndexMap[D]=y}function l1(a,t){var r={};r.version=et.getUShort(a,t),We.argument(r.version===0,"cmap table version should be 0."),r.numTables=et.getUShort(a,t+2);for(var i=-1,l=r.numTables-1;l>=0;l-=1){var u=et.getUShort(a,t+4+l*8),f=et.getUShort(a,t+4+l*8+2);if(u===3&&(f===0||f===1||f===10)||u===0&&(f===0||f===1||f===2||f===3||f===4)){i=et.getULong(a,t+4+l*8+4);break}}if(i===-1)throw new Error("No valid cmap sub-tables found.");var h=new et.Parser(a,t+i);if(r.format=h.parseUShort(),r.format===12)i1(r,h);else if(r.format===4)s1(r,h,a,t,i);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");return r}function o1(a,t,r){a.segments.push({end:t,start:t,delta:-(t-r),offset:0,glyphIndex:r})}function u1(a){a.segments.push({end:65535,start:65535,delta:1,offset:0})}function c1(a){var t=!0,r;for(r=a.length-1;r>0;r-=1){var i=a.get(r);if(i.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),t=!1;break}}var l=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:t?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:t?12:20}];t||(l=l.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),l=l.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var u=new _e.Table("cmap",l);for(u.segments=[],r=0;r<a.length;r+=1){for(var f=a.get(r),h=0;h<f.unicodes.length;h+=1)o1(u,f.unicodes[h],r);u.segments=u.segments.sort(function(L,M){return L.start-M.start})}u1(u);var d=u.segments.length,g=0,v=[],E=[],y=[],x=[],S=[],A=[];for(r=0;r<d;r+=1){var N=u.segments[r];N.end<=65535&&N.start<=65535?(v=v.concat({name:"end_"+r,type:"USHORT",value:N.end}),E=E.concat({name:"start_"+r,type:"USHORT",value:N.start}),y=y.concat({name:"idDelta_"+r,type:"SHORT",value:N.delta}),x=x.concat({name:"idRangeOffset_"+r,type:"USHORT",value:N.offset}),N.glyphId!==void 0&&(S=S.concat({name:"glyph_"+r,type:"USHORT",value:N.glyphId}))):g+=1,!t&&N.glyphIndex!==void 0&&(A=A.concat({name:"cmap12Start_"+r,type:"ULONG",value:N.start}),A=A.concat({name:"cmap12End_"+r,type:"ULONG",value:N.end}),A=A.concat({name:"cmap12Glyph_"+r,type:"ULONG",value:N.glyphIndex}))}if(u.segCountX2=(d-g)*2,u.searchRange=Math.pow(2,Math.floor(Math.log(d-g)/Math.log(2)))*2,u.entrySelector=Math.log(u.searchRange/2)/Math.log(2),u.rangeShift=u.segCountX2-u.searchRange,u.fields=u.fields.concat(v),u.fields.push({name:"reservedPad",type:"USHORT",value:0}),u.fields=u.fields.concat(E),u.fields=u.fields.concat(y),u.fields=u.fields.concat(x),u.fields=u.fields.concat(S),u.cmap4Length=14+v.length*2+2+E.length*2+y.length*2+x.length*2+S.length*2,!t){var D=16+A.length*4;u.cmap12Offset=20+u.cmap4Length,u.fields=u.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:D},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:A.length/3}]),u.fields=u.fields.concat(A)}return u}var f1={parse:l1,make:c1},Ko=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],d1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],p1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],v0=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function xm(a){this.font=a}xm.prototype.charToGlyphIndex=function(a){var t=a.codePointAt(0),r=this.font.glyphs;if(r){for(var i=0;i<r.length;i+=1)for(var l=r.get(i),u=0;u<l.unicodes.length;u+=1)if(l.unicodes[u]===t)return i}return null};function iu(a,t){this.encoding=a,this.charset=t}iu.prototype.charToGlyphIndex=function(a){var t=a.codePointAt(0),r=this.encoding[t];return this.charset.indexOf(r)};function h1(a,t,r,i,l){a.beginPath(),a.moveTo(t,r),a.lineTo(i,l),a.stroke()}var Ci={line:h1};function m1(a,t){var r=t||new Wt;return{configurable:!0,get:function(){return typeof r=="function"&&(r=r()),r},set:function(i){r=i}}}function ia(a){this.bindConstructorValues(a)}ia.prototype.bindConstructorValues=function(a){this.index=a.index||0,this.name=a.name||null,this.unicode=a.unicode||void 0,this.unicodes=a.unicodes||a.unicode!==void 0?[a.unicode]:[],"xMin"in a&&(this.xMin=a.xMin),"yMin"in a&&(this.yMin=a.yMin),"xMax"in a&&(this.xMax=a.xMax),"yMax"in a&&(this.yMax=a.yMax),"advanceWidth"in a&&(this.advanceWidth=a.advanceWidth),Object.defineProperty(this,"path",m1(this,a.path))};ia.prototype.addUnicode=function(a){this.unicodes.length===0&&(this.unicode=a),this.unicodes.push(a)};ia.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};ia.prototype.getPath=function(a,t,r,i,l){a=a!==void 0?a:0,t=t!==void 0?t:0,r=r!==void 0?r:72;var u,f;i||(i={});var h=i.xScale,d=i.yScale;if(i.hinting&&l&&l.hinting&&(f=this.path&&l.hinting.exec(this,r)),f)u=l.hinting.getCommands(f),a=Math.round(a),t=Math.round(t),h=d=1;else{u=this.path.commands;var g=1/(this.path.unitsPerEm||1e3)*r;h===void 0&&(h=g),d===void 0&&(d=g)}for(var v=new Wt,E=0;E<u.length;E+=1){var y=u[E];y.type==="M"?v.moveTo(a+y.x*h,t+-y.y*d):y.type==="L"?v.lineTo(a+y.x*h,t+-y.y*d):y.type==="Q"?v.quadraticCurveTo(a+y.x1*h,t+-y.y1*d,a+y.x*h,t+-y.y*d):y.type==="C"?v.curveTo(a+y.x1*h,t+-y.y1*d,a+y.x2*h,t+-y.y2*d,a+y.x*h,t+-y.y*d):y.type==="Z"&&v.closePath()}return v};ia.prototype.getContours=function(){if(this.points===void 0)return[];for(var a=[],t=[],r=0;r<this.points.length;r+=1){var i=this.points[r];t.push(i),i.lastPointOfContour&&(a.push(t),t=[])}return We.argument(t.length===0,"There are still points left in the current contour."),a};ia.prototype.getMetrics=function(){for(var a=this.path.commands,t=[],r=[],i=0;i<a.length;i+=1){var l=a[i];l.type!=="Z"&&(t.push(l.x),r.push(l.y)),(l.type==="Q"||l.type==="C")&&(t.push(l.x1),r.push(l.y1)),l.type==="C"&&(t.push(l.x2),r.push(l.y2))}var u={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(u.xMin)||(u.xMin=0),isFinite(u.xMax)||(u.xMax=this.advanceWidth),isFinite(u.yMin)||(u.yMin=0),isFinite(u.yMax)||(u.yMax=0),u.rightSideBearing=this.advanceWidth-u.leftSideBearing-(u.xMax-u.xMin),u};ia.prototype.draw=function(a,t,r,i,l){this.getPath(t,r,i,l).draw(a)};ia.prototype.drawPoints=function(a,t,r,i){function l(E,y,x,S){a.beginPath();for(var A=0;A<E.length;A+=1)a.moveTo(y+E[A].x*S,x+E[A].y*S),a.arc(y+E[A].x*S,x+E[A].y*S,2,0,Math.PI*2,!1);a.closePath(),a.fill()}t=t!==void 0?t:0,r=r!==void 0?r:0,i=i!==void 0?i:24;for(var u=1/this.path.unitsPerEm*i,f=[],h=[],d=this.path,g=0;g<d.commands.length;g+=1){var v=d.commands[g];v.x!==void 0&&f.push({x:v.x,y:-v.y}),v.x1!==void 0&&h.push({x:v.x1,y:-v.y1}),v.x2!==void 0&&h.push({x:v.x2,y:-v.y2})}a.fillStyle="blue",l(f,t,r,u),a.fillStyle="red",l(h,t,r,u)};ia.prototype.drawMetrics=function(a,t,r,i){var l;t=t!==void 0?t:0,r=r!==void 0?r:0,i=i!==void 0?i:24,l=1/this.path.unitsPerEm*i,a.lineWidth=1,a.strokeStyle="black",Ci.line(a,t,-1e4,t,1e4),Ci.line(a,-1e4,r,1e4,r);var u=this.xMin||0,f=this.yMin||0,h=this.xMax||0,d=this.yMax||0,g=this.advanceWidth||0;a.strokeStyle="blue",Ci.line(a,t+u*l,-1e4,t+u*l,1e4),Ci.line(a,t+h*l,-1e4,t+h*l,1e4),Ci.line(a,-1e4,r+-f*l,1e4,r+-f*l),Ci.line(a,-1e4,r+-d*l,1e4,r+-d*l),a.strokeStyle="green",Ci.line(a,t+g*l,-1e4,t+g*l,1e4)};function Zo(a,t,r){Object.defineProperty(a,t,{get:function(){return a.path,a[r]},set:function(i){a[r]=i},enumerable:!0,configurable:!0})}function Lf(a,t){if(this.font=a,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++){var i=t[r];i.path.unitsPerEm=a.unitsPerEm,this.glyphs[r]=i}this.length=t&&t.length||0}Lf.prototype.get=function(a){if(this.glyphs[a]===void 0){this.font._push(a),typeof this.glyphs[a]=="function"&&(this.glyphs[a]=this.glyphs[a]());var t=this.glyphs[a],r=this.font._IndexToUnicodeMap[a];if(r)for(var i=0;i<r.unicodes.length;i++)t.addUnicode(r.unicodes[i]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+a:t.name=this.font.cffEncoding.charset[a]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(a)),this.glyphs[a].advanceWidth=this.font._hmtxTableData[a].advanceWidth,this.glyphs[a].leftSideBearing=this.font._hmtxTableData[a].leftSideBearing}else typeof this.glyphs[a]=="function"&&(this.glyphs[a]=this.glyphs[a]());return this.glyphs[a]};Lf.prototype.push=function(a,t){this.glyphs[a]=t,this.length++};function g1(a,t){return new ia({index:t,font:a})}function v1(a,t,r,i,l,u){return function(){var f=new ia({index:t,font:a});return f.path=function(){r(f,i,l);var h=u(a.glyphs,f);return h.unitsPerEm=a.unitsPerEm,h},Zo(f,"xMin","_xMin"),Zo(f,"xMax","_xMax"),Zo(f,"yMin","_yMin"),Zo(f,"yMax","_yMax"),f}}function y1(a,t,r,i){return function(){var l=new ia({index:t,font:a});return l.path=function(){var u=r(a,l,i);return u.unitsPerEm=a.unitsPerEm,u},l}}var Ua={GlyphSet:Lf,glyphLoader:g1,ttfGlyphLoader:v1,cffGlyphLoader:y1};function Sm(a,t){if(a===t)return!0;if(Array.isArray(a)&&Array.isArray(t)){if(a.length!==t.length)return!1;for(var r=0;r<a.length;r+=1)if(!Sm(a[r],t[r]))return!1;return!0}else return!1}function wf(a){var t;return a.length<1240?t=107:a.length<33900?t=1131:t=32768,t}function Xr(a,t,r){var i=[],l=[],u=et.getCard16(a,t),f,h;if(u!==0){var d=et.getByte(a,t+2);f=t+(u+1)*d+2;for(var g=t+3,v=0;v<u+1;v+=1)i.push(et.getOffset(a,g,d)),g+=d;h=f+i[u]}else h=t+2;for(var E=0;E<i.length-1;E+=1){var y=et.getBytes(a,f+i[E],f+i[E+1]);r&&(y=r(y)),l.push(y)}return{objects:l,startOffset:t,endOffset:h}}function b1(a,t){var r=[],i=et.getCard16(a,t),l,u;if(i!==0){var f=et.getByte(a,t+2);l=t+(i+1)*f+2;for(var h=t+3,d=0;d<i+1;d+=1)r.push(et.getOffset(a,h,f)),h+=f;u=l+r[i]}else u=t+2;return{offsets:r,startOffset:t,endOffset:u}}function x1(a,t,r,i,l){var u=et.getCard16(r,i),f=0;if(u!==0){var h=et.getByte(r,i+2);f=i+(u+1)*h+2}var d=et.getBytes(r,f+t[a],f+t[a+1]);return d}function S1(a){for(var t="",r=15,i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var l=a.parseByte(),u=l>>4,f=l&15;if(u===r||(t+=i[u],f===r))break;t+=i[f]}return parseFloat(t)}function E1(a,t){var r,i,l,u;if(t===28)return r=a.parseByte(),i=a.parseByte(),r<<8|i;if(t===29)return r=a.parseByte(),i=a.parseByte(),l=a.parseByte(),u=a.parseByte(),r<<24|i<<16|l<<8|u;if(t===30)return S1(a);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return r=a.parseByte(),(t-247)*256+r+108;if(t>=251&&t<=254)return r=a.parseByte(),-(t-251)*256-r-108;throw new Error("Invalid b0 "+t)}function w1(a){for(var t={},r=0;r<a.length;r+=1){var i=a[r][0],l=a[r][1],u=void 0;if(l.length===1?u=l[0]:u=l,t.hasOwnProperty(i)&&!isNaN(t[i]))throw new Error("Object "+t+" already has key "+i);t[i]=u}return t}function Em(a,t,r){t=t!==void 0?t:0;var i=new et.Parser(a,t),l=[],u=[];for(r=r!==void 0?r:a.length;i.relativeOffset<r;){var f=i.parseByte();f<=21?(f===12&&(f=1200+i.parseByte()),l.push([f,u]),u=[]):u.push(E1(i,f))}return w1(l)}function El(a,t){return t<=390?t=Ko[t]:t=a[t-391],t}function wm(a,t,r){for(var i={},l,u=0;u<t.length;u+=1){var f=t[u];if(Array.isArray(f.type)){var h=[];h.length=f.type.length;for(var d=0;d<f.type.length;d++)l=a[f.op]!==void 0?a[f.op][d]:void 0,l===void 0&&(l=f.value!==void 0&&f.value[d]!==void 0?f.value[d]:null),f.type[d]==="SID"&&(l=El(r,l)),h[d]=l;i[f.name]=h}else l=a[f.op],l===void 0&&(l=f.value!==void 0?f.value:null),f.type==="SID"&&(l=El(r,l)),i[f.name]=l}return i}function A1(a,t){var r={};return r.formatMajor=et.getCard8(a,t),r.formatMinor=et.getCard8(a,t+1),r.size=et.getCard8(a,t+2),r.offsetSize=et.getCard8(a,t+3),r.startOffset=t,r.endOffset=t+4,r}var Am=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Tm=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function T1(a,t){var r=Em(a,0,a.byteLength);return wm(r,Am,t)}function Cm(a,t,r,i){var l=Em(a,t,r);return wm(l,Tm,i)}function y0(a,t,r,i){for(var l=[],u=0;u<r.length;u+=1){var f=new DataView(new Uint8Array(r[u]).buffer),h=T1(f,i);h._subrs=[],h._subrsBias=0,h._defaultWidthX=0,h._nominalWidthX=0;var d=h.private[0],g=h.private[1];if(d!==0&&g!==0){var v=Cm(a,g+t,d,i);if(h._defaultWidthX=v.defaultWidthX,h._nominalWidthX=v.nominalWidthX,v.subrs!==0){var E=g+v.subrs,y=Xr(a,E+t);h._subrs=y.objects,h._subrsBias=wf(h._subrs)}h._privateDict=v}l.push(h)}return l}function C1(a,t,r,i){var l,u,f=new et.Parser(a,t);r-=1;var h=[".notdef"],d=f.parseCard8();if(d===0)for(var g=0;g<r;g+=1)l=f.parseSID(),h.push(El(i,l));else if(d===1)for(;h.length<=r;){l=f.parseSID(),u=f.parseCard8();for(var v=0;v<=u;v+=1)h.push(El(i,l)),l+=1}else if(d===2)for(;h.length<=r;){l=f.parseSID(),u=f.parseCard16();for(var E=0;E<=u;E+=1)h.push(El(i,l)),l+=1}else throw new Error("Unknown charset format "+d);return h}function M1(a,t,r){var i,l={},u=new et.Parser(a,t),f=u.parseCard8();if(f===0)for(var h=u.parseCard8(),d=0;d<h;d+=1)i=u.parseCard8(),l[i]=d;else if(f===1){var g=u.parseCard8();i=1;for(var v=0;v<g;v+=1)for(var E=u.parseCard8(),y=u.parseCard8(),x=E;x<=E+y;x+=1)l[x]=i,i+=1}else throw new Error("Unknown encoding format "+f);return new iu(l,r)}function b0(a,t,r){var i,l,u,f,h=new Wt,d=[],g=0,v=!1,E=!1,y=0,x=0,S,A,N,D;if(a.isCIDFont){var L=a.tables.cff.topDict._fdSelect[t.index],M=a.tables.cff.topDict._fdArray[L];S=M._subrs,A=M._subrsBias,N=M._defaultWidthX,D=M._nominalWidthX}else S=a.tables.cff.topDict._subrs,A=a.tables.cff.topDict._subrsBias,N=a.tables.cff.topDict._defaultWidthX,D=a.tables.cff.topDict._nominalWidthX;var C=N;function B(de,ye){E&&h.closePath(),h.moveTo(de,ye),E=!0}function V(){var de;de=d.length%2!==0,de&&!v&&(C=d.shift()+D),g+=d.length>>1,d.length=0,v=!0}function te(de){for(var ye,pe,q,j,$,W,J,U,G,X,me,_,z=0;z<de.length;){var ie=de[z];switch(z+=1,ie){case 1:V();break;case 3:V();break;case 4:d.length>1&&!v&&(C=d.shift()+D,v=!0),x+=d.pop(),B(y,x);break;case 5:for(;d.length>0;)y+=d.shift(),x+=d.shift(),h.lineTo(y,x);break;case 6:for(;d.length>0&&(y+=d.shift(),h.lineTo(y,x),d.length!==0);)x+=d.shift(),h.lineTo(y,x);break;case 7:for(;d.length>0&&(x+=d.shift(),h.lineTo(y,x),d.length!==0);)y+=d.shift(),h.lineTo(y,x);break;case 8:for(;d.length>0;)i=y+d.shift(),l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),x=f+d.shift(),h.curveTo(i,l,u,f,y,x);break;case 10:$=d.pop()+A,W=S[$],W&&te(W);break;case 11:return;case 12:switch(ie=de[z],z+=1,ie){case 35:i=y+d.shift(),l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),J=u+d.shift(),U=f+d.shift(),G=J+d.shift(),X=U+d.shift(),me=G+d.shift(),_=X+d.shift(),y=me+d.shift(),x=_+d.shift(),d.shift(),h.curveTo(i,l,u,f,J,U),h.curveTo(G,X,me,_,y,x);break;case 34:i=y+d.shift(),l=x,u=i+d.shift(),f=l+d.shift(),J=u+d.shift(),U=f,G=J+d.shift(),X=f,me=G+d.shift(),_=x,y=me+d.shift(),h.curveTo(i,l,u,f,J,U),h.curveTo(G,X,me,_,y,x);break;case 36:i=y+d.shift(),l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),J=u+d.shift(),U=f,G=J+d.shift(),X=f,me=G+d.shift(),_=X+d.shift(),y=me+d.shift(),h.curveTo(i,l,u,f,J,U),h.curveTo(G,X,me,_,y,x);break;case 37:i=y+d.shift(),l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),J=u+d.shift(),U=f+d.shift(),G=J+d.shift(),X=U+d.shift(),me=G+d.shift(),_=X+d.shift(),Math.abs(me-y)>Math.abs(_-x)?y=me+d.shift():x=_+d.shift(),h.curveTo(i,l,u,f,J,U),h.curveTo(G,X,me,_,y,x);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+ie),d.length=0}break;case 14:d.length>0&&!v&&(C=d.shift()+D,v=!0),E&&(h.closePath(),E=!1);break;case 18:V();break;case 19:case 20:V(),z+=g+7>>3;break;case 21:d.length>2&&!v&&(C=d.shift()+D,v=!0),x+=d.pop(),y+=d.pop(),B(y,x);break;case 22:d.length>1&&!v&&(C=d.shift()+D,v=!0),y+=d.pop(),B(y,x);break;case 23:V();break;case 24:for(;d.length>2;)i=y+d.shift(),l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),x=f+d.shift(),h.curveTo(i,l,u,f,y,x);y+=d.shift(),x+=d.shift(),h.lineTo(y,x);break;case 25:for(;d.length>6;)y+=d.shift(),x+=d.shift(),h.lineTo(y,x);i=y+d.shift(),l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),x=f+d.shift(),h.curveTo(i,l,u,f,y,x);break;case 26:for(d.length%2&&(y+=d.shift());d.length>0;)i=y,l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u,x=f+d.shift(),h.curveTo(i,l,u,f,y,x);break;case 27:for(d.length%2&&(x+=d.shift());d.length>0;)i=y+d.shift(),l=x,u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),x=f,h.curveTo(i,l,u,f,y,x);break;case 28:ye=de[z],pe=de[z+1],d.push((ye<<24|pe<<16)>>16),z+=2;break;case 29:$=d.pop()+a.gsubrsBias,W=a.gsubrs[$],W&&te(W);break;case 30:for(;d.length>0&&(i=y,l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),x=f+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,x),d.length!==0);)i=y+d.shift(),l=x,u=i+d.shift(),f=l+d.shift(),x=f+d.shift(),y=u+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,x);break;case 31:for(;d.length>0&&(i=y+d.shift(),l=x,u=i+d.shift(),f=l+d.shift(),x=f+d.shift(),y=u+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,x),d.length!==0);)i=y,l=x+d.shift(),u=i+d.shift(),f=l+d.shift(),y=u+d.shift(),x=f+(d.length===1?d.shift():0),h.curveTo(i,l,u,f,y,x);break;default:ie<32?console.log("Glyph "+t.index+": unknown operator "+ie):ie<247?d.push(ie-139):ie<251?(ye=de[z],z+=1,d.push((ie-247)*256+ye+108)):ie<255?(ye=de[z],z+=1,d.push(-(ie-251)*256-ye-108)):(ye=de[z],pe=de[z+1],q=de[z+2],j=de[z+3],z+=4,d.push((ye<<24|pe<<16|q<<8|j)/65536))}}}return te(r),t.advanceWidth=C,h}function N1(a,t,r,i){var l=[],u,f=new et.Parser(a,t),h=f.parseCard8();if(h===0)for(var d=0;d<r;d++){if(u=f.parseCard8(),u>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+i+")");l.push(u)}else if(h===3){var g=f.parseCard16(),v=f.parseCard16();if(v!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+v);for(var E,y=0;y<g;y++){if(u=f.parseCard8(),E=f.parseCard16(),u>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+u+" (FD count "+i+")");if(E>r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+E);for(;v<E;v++)l.push(u);v=E}if(E!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+E)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+h);return l}function R1(a,t,r,i){r.tables.cff={};var l=A1(a,t),u=Xr(a,l.endOffset,et.bytesToString),f=Xr(a,u.endOffset),h=Xr(a,f.endOffset,et.bytesToString),d=Xr(a,h.endOffset);r.gsubrs=d.objects,r.gsubrsBias=wf(r.gsubrs);var g=y0(a,t,f.objects,h.objects);if(g.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+g.length);var v=g[0];if(r.tables.cff.topDict=v,v._privateDict&&(r.defaultWidthX=v._privateDict.defaultWidthX,r.nominalWidthX=v._privateDict.nominalWidthX),v.ros[0]!==void 0&&v.ros[1]!==void 0&&(r.isCIDFont=!0),r.isCIDFont){var E=v.fdArray,y=v.fdSelect;if(E===0||y===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");E+=t;var x=Xr(a,E),S=y0(a,t,x.objects,h.objects);v._fdArray=S,y+=t,v._fdSelect=N1(a,y,r.numGlyphs,S.length)}var A=t+v.private[1],N=Cm(a,A,v.private[0],h.objects);if(r.defaultWidthX=N.defaultWidthX,r.nominalWidthX=N.nominalWidthX,N.subrs!==0){var D=A+N.subrs,L=Xr(a,D);r.subrs=L.objects,r.subrsBias=wf(r.subrs)}else r.subrs=[],r.subrsBias=0;var M;i.lowMemory?(M=b1(a,t+v.charStrings),r.nGlyphs=M.offsets.length):(M=Xr(a,t+v.charStrings),r.nGlyphs=M.objects.length);var C=C1(a,t+v.charset,r.nGlyphs,h.objects);if(v.encoding===0?r.cffEncoding=new iu(d1,C):v.encoding===1?r.cffEncoding=new iu(p1,C):r.cffEncoding=M1(a,t+v.encoding,C),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new Ua.GlyphSet(r),i.lowMemory)r._push=function(te){var de=x1(te,M.offsets,a,t+v.charStrings);r.glyphs.push(te,Ua.cffGlyphLoader(r,te,b0,de))};else for(var B=0;B<r.nGlyphs;B+=1){var V=M.objects[B];r.glyphs.push(B,Ua.cffGlyphLoader(r,B,b0,V))}}function Mm(a,t){var r,i=Ko.indexOf(a);return i>=0&&(r=i),i=t.indexOf(a),i>=0?r=i+Ko.length:(r=Ko.length+t.length,t.push(a)),r}function D1(){return new _e.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function _1(a){var t=new _e.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<a.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:a[r]});return t}function Nm(a,t,r){for(var i={},l=0;l<a.length;l+=1){var u=a[l],f=t[u.name];f!==void 0&&!Sm(f,u.value)&&(u.type==="SID"&&(f=Mm(f,r)),i[u.op]={name:u.name,type:u.type,value:f})}return i}function x0(a,t){var r=new _e.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Nm(Am,a,t),r}function S0(a){var t=new _e.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:a}],t}function O1(a){var t=new _e.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<a.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:a[r]});return t}function k1(){return new _e.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function L1(a,t){for(var r=new _e.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<a.length;i+=1){var l=a[i],u=Mm(l,t);r.fields.push({name:"glyph_"+i,type:"SID",value:u})}return r}function U1(a){var t=[],r=a.path;t.push({name:"width",type:"NUMBER",value:a.advanceWidth});for(var i=0,l=0,u=0;u<r.commands.length;u+=1){var f=void 0,h=void 0,d=r.commands[u];if(d.type==="Q"){var g=.3333333333333333,v=2/3;d={type:"C",x:d.x,y:d.y,x1:Math.round(g*i+v*d.x1),y1:Math.round(g*l+v*d.y1),x2:Math.round(g*d.x+v*d.x1),y2:Math.round(g*d.y+v*d.y1)}}if(d.type==="M")f=Math.round(d.x-i),h=Math.round(d.y-l),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(d.x),l=Math.round(d.y);else if(d.type==="L")f=Math.round(d.x-i),h=Math.round(d.y-l),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rlineto",type:"OP",value:5}),i=Math.round(d.x),l=Math.round(d.y);else if(d.type==="C"){var E=Math.round(d.x1-i),y=Math.round(d.y1-l),x=Math.round(d.x2-d.x1),S=Math.round(d.y2-d.y1);f=Math.round(d.x-d.x2),h=Math.round(d.y-d.y2),t.push({name:"dx1",type:"NUMBER",value:E}),t.push({name:"dy1",type:"NUMBER",value:y}),t.push({name:"dx2",type:"NUMBER",value:x}),t.push({name:"dy2",type:"NUMBER",value:S}),t.push({name:"dx",type:"NUMBER",value:f}),t.push({name:"dy",type:"NUMBER",value:h}),t.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(d.x),l=Math.round(d.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function I1(a){for(var t=new _e.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<a.length;r+=1){var i=a.get(r),l=U1(i);t.charStrings.push({name:i.name,type:"CHARSTRING",value:l})}return t}function B1(a,t){var r=new _e.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Nm(Tm,a,t),r}function F1(a,t){for(var r=new _e.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/t.unitsPerEm,l={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},u={},f=[],h,d=1;d<a.length;d+=1)h=a.get(d),f.push(h.name);var g=[];r.header=D1(),r.nameIndex=_1([t.postScriptName]);var v=x0(l,g);r.topDictIndex=S0(v),r.globalSubrIndex=k1(),r.charsets=L1(f,g),r.charStringsIndex=I1(a),r.privateDict=B1(u,g),r.stringIndex=O1(g);var E=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return l.charset=E,l.encoding=0,l.charStrings=l.charset+r.charsets.sizeOf(),l.private[1]=l.charStrings+r.charStringsIndex.sizeOf(),v=x0(l,g),r.topDictIndex=S0(v),r}var j1={parse:R1,make:F1};function P1(a,t){var r={},i=new et.Parser(a,t);return r.version=i.parseVersion(),r.fontRevision=Math.round(i.parseFixed()*1e3)/1e3,r.checkSumAdjustment=i.parseULong(),r.magicNumber=i.parseULong(),We.argument(r.magicNumber===1594834165,"Font header has wrong magic number."),r.flags=i.parseUShort(),r.unitsPerEm=i.parseUShort(),r.created=i.parseLongDateTime(),r.modified=i.parseLongDateTime(),r.xMin=i.parseShort(),r.yMin=i.parseShort(),r.xMax=i.parseShort(),r.yMax=i.parseShort(),r.macStyle=i.parseUShort(),r.lowestRecPPEM=i.parseUShort(),r.fontDirectionHint=i.parseShort(),r.indexToLocFormat=i.parseShort(),r.glyphDataFormat=i.parseShort(),r}function G1(a){var t=Math.round(new Date().getTime()/1e3)+2082844800,r=t;return a.createdTimestamp&&(r=a.createdTimestamp+2082844800),new _e.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],a)}var z1={parse:P1,make:G1};function H1(a,t){var r={},i=new et.Parser(a,t);return r.version=i.parseVersion(),r.ascender=i.parseShort(),r.descender=i.parseShort(),r.lineGap=i.parseShort(),r.advanceWidthMax=i.parseUShort(),r.minLeftSideBearing=i.parseShort(),r.minRightSideBearing=i.parseShort(),r.xMaxExtent=i.parseShort(),r.caretSlopeRise=i.parseShort(),r.caretSlopeRun=i.parseShort(),r.caretOffset=i.parseShort(),i.relativeOffset+=8,r.metricDataFormat=i.parseShort(),r.numberOfHMetrics=i.parseUShort(),r}function Y1(a){return new _e.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],a)}var q1={parse:H1,make:Y1};function V1(a,t,r,i,l){for(var u,f,h=new et.Parser(a,t),d=0;d<i;d+=1){d<r&&(u=h.parseUShort(),f=h.parseShort());var g=l.get(d);g.advanceWidth=u,g.leftSideBearing=f}}function X1(a,t,r,i,l){a._hmtxTableData={};for(var u,f,h=new et.Parser(t,r),d=0;d<l;d+=1)d<i&&(u=h.parseUShort(),f=h.parseShort()),a._hmtxTableData[d]={advanceWidth:u,leftSideBearing:f}}function Z1(a,t,r,i,l,u,f){f.lowMemory?X1(a,t,r,i,l):V1(t,r,i,l,u)}function Q1(a){for(var t=new _e.Table("hmtx",[]),r=0;r<a.length;r+=1){var i=a.get(r),l=i.advanceWidth||0,u=i.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:l}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:u})}return t}var $1={parse:Z1,make:Q1};function W1(a){for(var t=new _e.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:a.length}]),r="",i=12+a.length*4,l=0;l<a.length;++l){var u=r.indexOf(a[l]);u<0&&(u=r.length,r+=a[l]),t.fields.push({name:"offset "+l,type:"USHORT",value:i+u}),t.fields.push({name:"length "+l,type:"USHORT",value:a[l].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t}function K1(a,t){var r=new et.Parser(a,t),i=r.parseULong();We.argument(i===1,"Unsupported ltag table version."),r.skip("uLong",1);for(var l=r.parseULong(),u=[],f=0;f<l;f++){for(var h="",d=t+r.parseUShort(),g=r.parseUShort(),v=d;v<d+g;++v)h+=String.fromCharCode(a.getInt8(v));u.push(h)}return u}var J1={make:W1,parse:K1};function eb(a,t){var r={},i=new et.Parser(a,t);return r.version=i.parseVersion(),r.numGlyphs=i.parseUShort(),r.version===1&&(r.maxPoints=i.parseUShort(),r.maxContours=i.parseUShort(),r.maxCompositePoints=i.parseUShort(),r.maxCompositeContours=i.parseUShort(),r.maxZones=i.parseUShort(),r.maxTwilightPoints=i.parseUShort(),r.maxStorage=i.parseUShort(),r.maxFunctionDefs=i.parseUShort(),r.maxInstructionDefs=i.parseUShort(),r.maxStackElements=i.parseUShort(),r.maxSizeOfInstructions=i.parseUShort(),r.maxComponentElements=i.parseUShort(),r.maxComponentDepth=i.parseUShort()),r}function tb(a){return new _e.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:a}])}var nb={parse:eb,make:tb},Rm=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Dm={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},ab={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},_m={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function rb(a,t,r){switch(a){case 0:if(t===65535)return"und";if(r)return r[t];break;case 1:return Dm[t];case 3:return _m[t]}}var Af="utf-16",ib={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},sb={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Om(a,t,r){switch(a){case 0:return Af;case 1:return sb[r]||ib[t];case 3:if(t===1||t===10)return Af;break}}function lb(a,t,r){for(var i={},l=new et.Parser(a,t),u=l.parseUShort(),f=l.parseUShort(),h=l.offset+l.parseUShort(),d=0;d<f;d++){var g=l.parseUShort(),v=l.parseUShort(),E=l.parseUShort(),y=l.parseUShort(),x=Rm[y]||y,S=l.parseUShort(),A=l.parseUShort(),N=rb(g,E,r),D=Om(g,v,E);if(D!==void 0&&N!==void 0){var L=void 0;if(D===Af?L=bs.UTF16(a,h+A,S):L=bs.MACSTRING(a,h+A,S,D),L){var M=i[x];M===void 0&&(M=i[x]={}),M[N]=L}}}return u===1&&l.parseUShort(),i}function lf(a){var t={};for(var r in a)t[a[r]]=parseInt(r);return t}function E0(a,t,r,i,l,u){return new _e.Record("NameRecord",[{name:"platformID",type:"USHORT",value:a},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:l},{name:"offset",type:"USHORT",value:u}])}function ob(a,t){var r=a.length,i=t.length-r+1;e:for(var l=0;l<i;l++)for(;l<i;l++){for(var u=0;u<r;u++)if(t[l+u]!==a[u])continue e;return l}return-1}function w0(a,t){var r=ob(a,t);if(r<0){r=t.length;for(var i=0,l=a.length;i<l;++i)t.push(a[i])}return r}function ub(a,t){var r,i=[],l={},u=lf(Rm);for(var f in a){var h=u[f];if(h===void 0&&(h=f),r=parseInt(h),isNaN(r))throw new Error('Name table entry "'+f+'" does not exist, see nameTableNames for complete list.');l[r]=a[f],i.push(r)}for(var d=lf(Dm),g=lf(_m),v=[],E=[],y=0;y<i.length;y++){r=i[y];var x=l[r];for(var S in x){var A=x[S],N=1,D=d[S],L=ab[D],M=Om(N,L,D),C=Ae.MACSTRING(A,M);C===void 0&&(N=0,D=t.indexOf(S),D<0&&(D=t.length,t.push(S)),L=4,C=Ae.UTF16(A));var B=w0(C,E);v.push(E0(N,L,D,r,C.length,B));var V=g[S];if(V!==void 0){var te=Ae.UTF16(A),de=w0(te,E);v.push(E0(3,1,V,r,te.length,de))}}}v.sort(function(q,j){return q.platformID-j.platformID||q.encodingID-j.encodingID||q.languageID-j.languageID||q.nameID-j.nameID});for(var ye=new _e.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:v.length},{name:"stringOffset",type:"USHORT",value:6+v.length*12}]),pe=0;pe<v.length;pe++)ye.fields.push({name:"record_"+pe,type:"RECORD",value:v[pe]});return ye.fields.push({name:"strings",type:"LITERAL",value:E}),ye}var cb={parse:lb,make:ub},Tf=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function fb(a){for(var t=0;t<Tf.length;t+=1){var r=Tf[t];if(a>=r.begin&&a<r.end)return t}return-1}function db(a,t){var r={},i=new et.Parser(a,t);r.version=i.parseUShort(),r.xAvgCharWidth=i.parseShort(),r.usWeightClass=i.parseUShort(),r.usWidthClass=i.parseUShort(),r.fsType=i.parseUShort(),r.ySubscriptXSize=i.parseShort(),r.ySubscriptYSize=i.parseShort(),r.ySubscriptXOffset=i.parseShort(),r.ySubscriptYOffset=i.parseShort(),r.ySuperscriptXSize=i.parseShort(),r.ySuperscriptYSize=i.parseShort(),r.ySuperscriptXOffset=i.parseShort(),r.ySuperscriptYOffset=i.parseShort(),r.yStrikeoutSize=i.parseShort(),r.yStrikeoutPosition=i.parseShort(),r.sFamilyClass=i.parseShort(),r.panose=[];for(var l=0;l<10;l++)r.panose[l]=i.parseByte();return r.ulUnicodeRange1=i.parseULong(),r.ulUnicodeRange2=i.parseULong(),r.ulUnicodeRange3=i.parseULong(),r.ulUnicodeRange4=i.parseULong(),r.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),r.fsSelection=i.parseUShort(),r.usFirstCharIndex=i.parseUShort(),r.usLastCharIndex=i.parseUShort(),r.sTypoAscender=i.parseShort(),r.sTypoDescender=i.parseShort(),r.sTypoLineGap=i.parseShort(),r.usWinAscent=i.parseUShort(),r.usWinDescent=i.parseUShort(),r.version>=1&&(r.ulCodePageRange1=i.parseULong(),r.ulCodePageRange2=i.parseULong()),r.version>=2&&(r.sxHeight=i.parseShort(),r.sCapHeight=i.parseShort(),r.usDefaultChar=i.parseUShort(),r.usBreakChar=i.parseUShort(),r.usMaxContent=i.parseUShort()),r}function pb(a){return new _e.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],a)}var A0={parse:db,make:pb,unicodeRanges:Tf,getUnicodeRange:fb};function hb(a,t){var r={},i=new et.Parser(a,t);switch(r.version=i.parseVersion(),r.italicAngle=i.parseFixed(),r.underlinePosition=i.parseShort(),r.underlineThickness=i.parseShort(),r.isFixedPitch=i.parseULong(),r.minMemType42=i.parseULong(),r.maxMemType42=i.parseULong(),r.minMemType1=i.parseULong(),r.maxMemType1=i.parseULong(),r.version){case 1:r.names=v0.slice();break;case 2:r.numberOfGlyphs=i.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var l=0;l<r.numberOfGlyphs;l++)r.glyphNameIndex[l]=i.parseUShort();r.names=[];for(var u=0;u<r.numberOfGlyphs;u++)if(r.glyphNameIndex[u]>=v0.length){var f=i.parseChar();r.names.push(i.parseString(f))}break;case 2.5:r.numberOfGlyphs=i.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var h=0;h<r.numberOfGlyphs;h++)r.offset[h]=i.parseChar();break}return r}function mb(){return new _e.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var gb={parse:hb,make:mb},ya=new Array(9);ya[1]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(re.coverage),deltaGlyphId:this.parseUShort()};if(r===2)return{substFormat:2,coverage:this.parsePointer(re.coverage),substitute:this.parseOffset16List()};We.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")};ya[2]=function(){var t=this.parseUShort();return We.argument(t===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),sequences:this.parseListOfLists()}};ya[3]=function(){var t=this.parseUShort();return We.argument(t===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),alternateSets:this.parseListOfLists()}};ya[4]=function(){var t=this.parseUShort();return We.argument(t===1,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var ys={sequenceIndex:re.uShort,lookupListIndex:re.uShort};ya[5]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:r,coverage:this.parsePointer(re.coverage),ruleSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{input:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,ys)}})};if(r===2)return{substFormat:r,coverage:this.parsePointer(re.coverage),classDef:this.parsePointer(re.classDef),classSets:this.parseListOfLists(function(){var u=this.parseUShort(),f=this.parseUShort();return{classes:this.parseUShortList(u-1),lookupRecords:this.parseRecordList(f,ys)}})};if(r===3){var i=this.parseUShort(),l=this.parseUShort();return{substFormat:r,coverages:this.parseList(i,re.pointer(re.coverage)),lookupRecords:this.parseRecordList(l,ys)}}We.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};ya[6]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(re.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ys)}})};if(r===2)return{substFormat:2,coverage:this.parsePointer(re.coverage),backtrackClassDef:this.parsePointer(re.classDef),inputClassDef:this.parsePointer(re.classDef),lookaheadClassDef:this.parsePointer(re.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ys)}})};if(r===3)return{substFormat:3,backtrackCoverage:this.parseList(re.pointer(re.coverage)),inputCoverage:this.parseList(re.pointer(re.coverage)),lookaheadCoverage:this.parseList(re.pointer(re.coverage)),lookupRecords:this.parseRecordList(ys)};We.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};ya[7]=function(){var t=this.parseUShort();We.argument(t===1,"GSUB Extension Substitution subtable identifier-format must be 1");var r=this.parseUShort(),i=new re(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:r,extension:ya[r].call(i)}};ya[8]=function(){var t=this.parseUShort();return We.argument(t===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(re.coverage),backtrackCoverage:this.parseList(re.pointer(re.coverage)),lookaheadCoverage:this.parseList(re.pointer(re.coverage)),substitutes:this.parseUShortList()}};function vb(a,t){t=t||0;var r=new re(a,t),i=r.parseVersion(1);return We.argument(i===1||i===1.1,"Unsupported GSUB table version."),i===1?{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(ya)}:{version:i,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(ya),variations:r.parseFeatureVariationsList()}}var xs=new Array(9);xs[1]=function(t){return t.substFormat===1?new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new _e.Coverage(t.coverage)}].concat(_e.ushortList("substitute",t.substitute)))};xs[2]=function(t){return We.assert(t.substFormat===1,"Lookup type 2 substFormat must be 1."),new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(t.coverage)}].concat(_e.tableList("seqSet",t.sequences,function(r){return new _e.Table("sequenceSetTable",_e.ushortList("sequence",r))})))};xs[3]=function(t){return We.assert(t.substFormat===1,"Lookup type 3 substFormat must be 1."),new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(t.coverage)}].concat(_e.tableList("altSet",t.alternateSets,function(r){return new _e.Table("alternateSetTable",_e.ushortList("alternate",r))})))};xs[4]=function(t){return We.assert(t.substFormat===1,"Lookup type 4 substFormat must be 1."),new _e.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new _e.Coverage(t.coverage)}].concat(_e.tableList("ligSet",t.ligatureSets,function(r){return new _e.Table("ligatureSetTable",_e.tableList("ligature",r,function(i){return new _e.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:i.ligGlyph}].concat(_e.ushortList("component",i.components,i.components.length+1)))}))})))};xs[6]=function(t){if(t.substFormat===1){var r=new _e.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:t.substFormat},{name:"coverage",type:"TABLE",value:new _e.Coverage(t.coverage)}].concat(_e.tableList("chainRuleSet",t.chainRuleSets,function(u){return new _e.Table("chainRuleSetTable",_e.tableList("chainRule",u,function(f){var h=_e.ushortList("backtrackGlyph",f.backtrack,f.backtrack.length).concat(_e.ushortList("inputGlyph",f.input,f.input.length+1)).concat(_e.ushortList("lookaheadGlyph",f.lookahead,f.lookahead.length)).concat(_e.ushortList("substitution",[],f.lookupRecords.length));return f.lookupRecords.forEach(function(d,g){h=h.concat({name:"sequenceIndex"+g,type:"USHORT",value:d.sequenceIndex}).concat({name:"lookupListIndex"+g,type:"USHORT",value:d.lookupListIndex})}),new _e.Table("chainRuleTable",h)}))})));return r}else if(t.substFormat===2)We.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(t.substFormat===3){var i=[{name:"substFormat",type:"USHORT",value:t.substFormat}];i.push({name:"backtrackGlyphCount",type:"USHORT",value:t.backtrackCoverage.length}),t.backtrackCoverage.forEach(function(u,f){i.push({name:"backtrackCoverage"+f,type:"TABLE",value:new _e.Coverage(u)})}),i.push({name:"inputGlyphCount",type:"USHORT",value:t.inputCoverage.length}),t.inputCoverage.forEach(function(u,f){i.push({name:"inputCoverage"+f,type:"TABLE",value:new _e.Coverage(u)})}),i.push({name:"lookaheadGlyphCount",type:"USHORT",value:t.lookaheadCoverage.length}),t.lookaheadCoverage.forEach(function(u,f){i.push({name:"lookaheadCoverage"+f,type:"TABLE",value:new _e.Coverage(u)})}),i.push({name:"substitutionCount",type:"USHORT",value:t.lookupRecords.length}),t.lookupRecords.forEach(function(u,f){i=i.concat({name:"sequenceIndex"+f,type:"USHORT",value:u.sequenceIndex}).concat({name:"lookupListIndex"+f,type:"USHORT",value:u.lookupListIndex})});var l=new _e.Table("chainContextTable",i);return l}We.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function yb(a){return new _e.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new _e.ScriptList(a.scripts)},{name:"features",type:"TABLE",value:new _e.FeatureList(a.features)},{name:"lookups",type:"TABLE",value:new _e.LookupList(a.lookups,xs)}])}var bb={parse:vb,make:yb};function xb(a,t){var r=new et.Parser(a,t),i=r.parseULong();We.argument(i===1,"Unsupported META table version."),r.parseULong(),r.parseULong();for(var l=r.parseULong(),u={},f=0;f<l;f++){var h=r.parseTag(),d=r.parseULong(),g=r.parseULong(),v=bs.UTF8(a,t+d,g);u[h]=v}return u}function Sb(a){var t=Object.keys(a).length,r="",i=16+t*12,l=new _e.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:t}]);for(var u in a){var f=r.length;r+=a[u],l.fields.push({name:"tag "+u,type:"TAG",value:u}),l.fields.push({name:"offset "+u,type:"ULONG",value:i+f}),l.fields.push({name:"length "+u,type:"ULONG",value:a[u].length})}return l.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),l}var Eb={parse:xb,make:Sb};function T0(a){return Math.log(a)/Math.log(2)|0}function Uf(a){for(;a.length%4!==0;)a.push(0);for(var t=0,r=0;r<a.length;r+=4)t+=(a[r]<<24)+(a[r+1]<<16)+(a[r+2]<<8)+a[r+3];return t%=Math.pow(2,32),t}function C0(a,t,r,i){return new _e.Record("Table Record",[{name:"tag",type:"TAG",value:a!==void 0?a:""},{name:"checkSum",type:"ULONG",value:t!==void 0?t:0},{name:"offset",type:"ULONG",value:r!==void 0?r:0},{name:"length",type:"ULONG",value:i!==void 0?i:0}])}function km(a){var t=new _e.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=a,t.numTables=a.length;var r=Math.pow(2,T0(t.numTables));t.searchRange=16*r,t.entrySelector=T0(r),t.rangeShift=t.numTables*16-t.searchRange;for(var i=[],l=[],u=t.sizeOf()+C0().sizeOf()*t.numTables;u%4!==0;)u+=1,l.push({name:"padding",type:"BYTE",value:0});for(var f=0;f<a.length;f+=1){var h=a[f];We.argument(h.tableName.length===4,"Table name"+h.tableName+" is invalid.");var d=h.sizeOf(),g=C0(h.tableName,Uf(h.encode()),u,d);for(i.push({name:g.tag+" Table Record",type:"RECORD",value:g}),l.push({name:h.tableName+" table",type:"RECORD",value:h}),u+=d,We.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!==0;)u+=1,l.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(v,E){return v.value.tag>E.value.tag?1:-1}),t.fields=t.fields.concat(i),t.fields=t.fields.concat(l),t}function M0(a,t,r){for(var i=0;i<t.length;i+=1){var l=a.charToGlyphIndex(t[i]);if(l>0){var u=a.glyphs.get(l);return u.getMetrics()}}return r}function wb(a){for(var t=0,r=0;r<a.length;r+=1)t+=a[r];return t/a.length}function Ab(a){for(var t=[],r=[],i=[],l=[],u=[],f=[],h=[],d,g=0,v=0,E=0,y=0,x=0,S=0;S<a.glyphs.length;S+=1){var A=a.glyphs.get(S),N=A.unicode|0;if(isNaN(A.advanceWidth))throw new Error("Glyph "+A.name+" ("+S+"): advanceWidth is not a number.");(d>N||d===void 0)&&N>0&&(d=N),g<N&&(g=N);var D=A0.getUnicodeRange(N);if(D<32)v|=1<<D;else if(D<64)E|=1<<D-32;else if(D<96)y|=1<<D-64;else if(D<123)x|=1<<D-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(A.name!==".notdef"){var L=A.getMetrics();t.push(L.xMin),r.push(L.yMin),i.push(L.xMax),l.push(L.yMax),f.push(L.leftSideBearing),h.push(L.rightSideBearing),u.push(A.advanceWidth)}}var M={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,l),advanceWidthMax:Math.max.apply(null,u),advanceWidthAvg:wb(u),minLeftSideBearing:Math.min.apply(null,f),maxLeftSideBearing:Math.max.apply(null,f),minRightSideBearing:Math.min.apply(null,h)};M.ascender=a.ascender,M.descender=a.descender;var C=z1.make({flags:3,unitsPerEm:a.unitsPerEm,xMin:M.xMin,yMin:M.yMin,xMax:M.xMax,yMax:M.yMax,lowestRecPPEM:3,createdTimestamp:a.createdTimestamp}),B=q1.make({ascender:M.ascender,descender:M.descender,advanceWidthMax:M.advanceWidthMax,minLeftSideBearing:M.minLeftSideBearing,minRightSideBearing:M.minRightSideBearing,xMaxExtent:M.maxLeftSideBearing+(M.xMax-M.xMin),numberOfHMetrics:a.glyphs.length}),V=nb.make(a.glyphs.length),te=A0.make(Object.assign({xAvgCharWidth:Math.round(M.advanceWidthAvg),usFirstCharIndex:d,usLastCharIndex:g,ulUnicodeRange1:v,ulUnicodeRange2:E,ulUnicodeRange3:y,ulUnicodeRange4:x,sTypoAscender:M.ascender,sTypoDescender:M.descender,sTypoLineGap:0,usWinAscent:M.yMax,usWinDescent:Math.abs(M.yMin),ulCodePageRange1:1,sxHeight:M0(a,"xyvw",{yMax:Math.round(M.ascender/2)}).yMax,sCapHeight:M0(a,"HIKLEFJMNTZBDPRAGOQSUVWXY",M).yMax,usDefaultChar:a.hasChar(" ")?32:0,usBreakChar:a.hasChar(" ")?32:0},a.tables.os2)),de=$1.make(a.glyphs),ye=f1.make(a.glyphs),pe=a.getEnglishName("fontFamily"),q=a.getEnglishName("fontSubfamily"),j=pe+" "+q,$=a.getEnglishName("postScriptName");$||($=pe.replace(/\s/g,"")+"-"+q);var W={};for(var J in a.names)W[J]=a.names[J];W.uniqueID||(W.uniqueID={en:a.getEnglishName("manufacturer")+":"+j}),W.postScriptName||(W.postScriptName={en:$}),W.preferredFamily||(W.preferredFamily=a.names.fontFamily),W.preferredSubfamily||(W.preferredSubfamily=a.names.fontSubfamily);var U=[],G=cb.make(W,U),X=U.length>0?J1.make(U):void 0,me=gb.make(),_=j1.make(a.glyphs,{version:a.getEnglishName("version"),fullName:j,familyName:pe,weightName:q,postScriptName:$,unitsPerEm:a.unitsPerEm,fontBBox:[0,M.yMin,M.ascender,M.advanceWidthMax]}),z=a.metas&&Object.keys(a.metas).length>0?Eb.make(a.metas):void 0,ie=[C,B,V,te,G,ye,me,_,de];X&&ie.push(X),a.tables.gsub&&ie.push(bb.make(a.tables.gsub)),z&&ie.push(z);for(var ve=km(ie),ne=ve.encode(),he=Uf(ne),xe=ve.fields,Ye=!1,Be=0;Be<xe.length;Be+=1)if(xe[Be].name==="head table"){xe[Be].value.checkSumAdjustment=2981146554-he,Ye=!0;break}if(!Ye)throw new Error("Could not find head table with checkSum to adjust.");return ve}var Tb={make:km,fontToTable:Ab,computeCheckSum:Uf};function of(a,t){for(var r=0,i=a.length-1;r<=i;){var l=r+i>>>1,u=a[l].tag;if(u===t)return l;u<t?r=l+1:i=l-1}return-r-1}function N0(a,t){for(var r=0,i=a.length-1;r<=i;){var l=r+i>>>1,u=a[l];if(u===t)return l;u<t?r=l+1:i=l-1}return-r-1}function R0(a,t){for(var r,i=0,l=a.length-1;i<=l;){var u=i+l>>>1;r=a[u];var f=r.start;if(f===t)return r;f<t?i=u+1:l=u-1}if(i>0)return r=a[i-1],t>r.end?0:r}function Dl(a,t){this.font=a,this.tableName=t}Dl.prototype={searchTag:of,binSearch:N0,getTable:function(a){var t=this.font.tables[this.tableName];return!t&&a&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var a=this.getTable();return a?a.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){var a=this.getTable();if(a){for(var t=!1,r=0;r<a.scripts.length;r++){var i=a.scripts[r].tag;if(i==="DFLT")return i;i==="latn"&&(t=!0)}if(t)return"latn"}},getScriptTable:function(a,t){var r=this.getTable(t);if(r){a=a||"DFLT";var i=r.scripts,l=of(r.scripts,a);if(l>=0)return i[l].script;if(t){var u={tag:a,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-l,0,u),u.script}}},getLangSysTable:function(a,t,r){var i=this.getScriptTable(a,r);if(i){if(!t||t==="dflt"||t==="DFLT")return i.defaultLangSys;var l=of(i.langSysRecords,t);if(l>=0)return i.langSysRecords[l].langSys;if(r){var u={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-l,0,u),u.langSys}}},getFeatureTable:function(a,t,r,i){var l=this.getLangSysTable(a,t,i);if(l){for(var u,f=l.featureIndexes,h=this.font.tables[this.tableName].features,d=0;d<f.length;d++)if(u=h[f[d]],u.tag===r)return u.feature;if(i){var g=h.length;return We.assert(g===0||r>=h[g-1].tag,"Features must be added in alphabetical order."),u={tag:r,feature:{params:0,lookupListIndexes:[]}},h.push(u),f.push(g),u.feature}}},getLookupTables:function(a,t,r,i,l){var u=this.getFeatureTable(a,t,r,l),f=[];if(u){for(var h,d=u.lookupListIndexes,g=this.font.tables[this.tableName].lookups,v=0;v<d.length;v++)h=g[d[v]],h.lookupType===i&&f.push(h);if(f.length===0&&l){h={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var E=g.length;return g.push(h),d.push(E),[h]}}return f},getGlyphClass:function(a,t){switch(a.format){case 1:return a.startGlyph<=t&&t<a.startGlyph+a.classes.length?a.classes[t-a.startGlyph]:0;case 2:var r=R0(a.ranges,t);return r?r.classId:0}},getCoverageIndex:function(a,t){switch(a.format){case 1:var r=N0(a.glyphs,t);return r>=0?r:-1;case 2:var i=R0(a.ranges,t);return i?i.index+t-i.start:-1}},expandCoverage:function(a){if(a.format===1)return a.glyphs;for(var t=[],r=a.ranges,i=0;i<r.length;i++)for(var l=r[i],u=l.start,f=l.end,h=u;h<=f;h++)t.push(h);return t}};function _l(a){Dl.call(this,a,"gpos")}_l.prototype=Dl.prototype;_l.prototype.init=function(){var a=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(a)};_l.prototype.getKerningValue=function(a,t,r){for(var i=0;i<a.length;i++)for(var l=a[i].subtables,u=0;u<l.length;u++){var f=l[u],h=this.getCoverageIndex(f.coverage,t);if(!(h<0))switch(f.posFormat){case 1:for(var d=f.pairSets[h],g=0;g<d.length;g++){var v=d[g];if(v.secondGlyph===r)return v.value1&&v.value1.xAdvance||0}break;case 2:var E=this.getGlyphClass(f.classDef1,t),y=this.getGlyphClass(f.classDef2,r),x=f.classRecords[E][y];return x.value1&&x.value1.xAdvance||0}}return 0};_l.prototype.getKerningTables=function(a,t){if(this.font.tables.gpos)return this.getLookupTables(a,t,"kern",2)};function zn(a){Dl.call(this,a,"gsub")}function Cb(a,t){var r=a.length;if(r!==t.length)return!1;for(var i=0;i<r;i++)if(a[i]!==t[i])return!1;return!0}function If(a,t,r){for(var i=a.subtables,l=0;l<i.length;l++){var u=i[l];if(u.substFormat===t)return u}if(r)return i.push(r),r}zn.prototype=Dl.prototype;zn.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};zn.prototype.getSingle=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,1),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++){var d=f[h],g=this.expandCoverage(d.coverage),v=void 0;if(d.substFormat===1){var E=d.deltaGlyphId;for(v=0;v<g.length;v++){var y=g[v];i.push({sub:y,by:y+E})}}else{var x=d.substitute;for(v=0;v<g.length;v++)i.push({sub:g[v],by:x[v]})}}return i};zn.prototype.getMultiple=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,2),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++){var d=f[h],g=this.expandCoverage(d.coverage),v=void 0;for(v=0;v<g.length;v++){var E=g[v],y=d.sequences[v];i.push({sub:E,by:y})}}return i};zn.prototype.getAlternates=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,3),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++)for(var d=f[h],g=this.expandCoverage(d.coverage),v=d.alternateSets,E=0;E<g.length;E++)i.push({sub:g[E],by:v[E]});return i};zn.prototype.getLigatures=function(a,t,r){for(var i=[],l=this.getLookupTables(t,r,a,4),u=0;u<l.length;u++)for(var f=l[u].subtables,h=0;h<f.length;h++)for(var d=f[h],g=this.expandCoverage(d.coverage),v=d.ligatureSets,E=0;E<g.length;E++)for(var y=g[E],x=v[E],S=0;S<x.length;S++){var A=x[S];i.push({sub:[y].concat(A.components),by:A.ligGlyph})}return i};zn.prototype.addSingle=function(a,t,r,i){var l=this.getLookupTables(r,i,a,1,!0)[0],u=If(l,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});We.assert(u.coverage.format===1,"Single: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.substitute.splice(h,0,0)),u.substitute[h]=t.by};zn.prototype.addMultiple=function(a,t,r,i){We.assert(t.by instanceof Array&&t.by.length>1,'Multiple: "by" must be an array of two or more ids');var l=this.getLookupTables(r,i,a,2,!0)[0],u=If(l,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});We.assert(u.coverage.format===1,"Multiple: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.sequences.splice(h,0,0)),u.sequences[h]=t.by};zn.prototype.addAlternate=function(a,t,r,i){var l=this.getLookupTables(r,i,a,3,!0)[0],u=If(l,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});We.assert(u.coverage.format===1,"Alternate: unable to modify coverage table format "+u.coverage.format);var f=t.sub,h=this.binSearch(u.coverage.glyphs,f);h<0&&(h=-1-h,u.coverage.glyphs.splice(h,0,f),u.alternateSets.splice(h,0,0)),u.alternateSets[h]=t.by};zn.prototype.addLigature=function(a,t,r,i){var l=this.getLookupTables(r,i,a,4,!0)[0],u=l.subtables[0];u||(u={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},l.subtables[0]=u),We.assert(u.coverage.format===1,"Ligature: unable to modify coverage table format "+u.coverage.format);var f=t.sub[0],h=t.sub.slice(1),d={ligGlyph:t.by,components:h},g=this.binSearch(u.coverage.glyphs,f);if(g>=0){for(var v=u.ligatureSets[g],E=0;E<v.length;E++)if(Cb(v[E].components,h))return;v.push(d)}else g=-1-g,u.coverage.glyphs.splice(g,0,f),u.ligatureSets.splice(g,0,[d])};zn.prototype.getFeature=function(a,t,r){if(/ss\d\d/.test(a))return this.getSingle(a,t,r);switch(a){case"aalt":case"salt":return this.getSingle(a,t,r).concat(this.getAlternates(a,t,r));case"dlig":case"liga":case"rlig":return this.getLigatures(a,t,r);case"ccmp":return this.getMultiple(a,t,r).concat(this.getLigatures(a,t,r));case"stch":return this.getMultiple(a,t,r)}};zn.prototype.add=function(a,t,r,i){if(/ss\d\d/.test(a))return this.addSingle(a,t,r,i);switch(a){case"aalt":case"salt":return typeof t.by=="number"?this.addSingle(a,t,r,i):this.addAlternate(a,t,r,i);case"dlig":case"liga":case"rlig":return this.addLigature(a,t,r,i);case"ccmp":return t.by instanceof Array?this.addMultiple(a,t,r,i):this.addLigature(a,t,r,i)}};function Mb(){return typeof window<"u"}function Nb(a){for(var t=new Buffer(a.byteLength),r=new Uint8Array(a),i=0;i<t.length;++i)t[i]=r[i];return t}function Sl(a,t){if(!a)throw t}function D0(a,t,r,i,l){var u;return(t&i)>0?(u=a.parseByte(),(t&l)===0&&(u=-u),u=r+u):(t&l)>0?u=r:u=r+a.parseShort(),u}function Lm(a,t,r){var i=new et.Parser(t,r);a.numberOfContours=i.parseShort(),a._xMin=i.parseShort(),a._yMin=i.parseShort(),a._xMax=i.parseShort(),a._yMax=i.parseShort();var l,u;if(a.numberOfContours>0){for(var f=a.endPointIndices=[],h=0;h<a.numberOfContours;h+=1)f.push(i.parseUShort());a.instructionLength=i.parseUShort(),a.instructions=[];for(var d=0;d<a.instructionLength;d+=1)a.instructions.push(i.parseByte());var g=f[f.length-1]+1;l=[];for(var v=0;v<g;v+=1)if(u=i.parseByte(),l.push(u),(u&8)>0)for(var E=i.parseByte(),y=0;y<E;y+=1)l.push(u),v+=1;if(We.argument(l.length===g,"Bad flags."),f.length>0){var x=[],S;if(g>0){for(var A=0;A<g;A+=1)u=l[A],S={},S.onCurve=!!(u&1),S.lastPointOfContour=f.indexOf(A)>=0,x.push(S);for(var N=0,D=0;D<g;D+=1)u=l[D],S=x[D],S.x=D0(i,u,N,2,16),N=S.x;for(var L=0,M=0;M<g;M+=1)u=l[M],S=x[M],S.y=D0(i,u,L,4,32),L=S.y}a.points=x}else a.points=[]}else if(a.numberOfContours===0)a.points=[];else{a.isComposite=!0,a.points=[],a.components=[];for(var C=!0;C;){l=i.parseUShort();var B={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(l&1)>0?(l&2)>0?(B.dx=i.parseShort(),B.dy=i.parseShort()):B.matchedPoints=[i.parseUShort(),i.parseUShort()]:(l&2)>0?(B.dx=i.parseChar(),B.dy=i.parseChar()):B.matchedPoints=[i.parseByte(),i.parseByte()],(l&8)>0?B.xScale=B.yScale=i.parseF2Dot14():(l&64)>0?(B.xScale=i.parseF2Dot14(),B.yScale=i.parseF2Dot14()):(l&128)>0&&(B.xScale=i.parseF2Dot14(),B.scale01=i.parseF2Dot14(),B.scale10=i.parseF2Dot14(),B.yScale=i.parseF2Dot14()),a.components.push(B),C=!!(l&32)}if(l&256){a.instructionLength=i.parseUShort(),a.instructions=[];for(var V=0;V<a.instructionLength;V+=1)a.instructions.push(i.parseByte())}}}function uf(a,t){for(var r=[],i=0;i<a.length;i+=1){var l=a[i],u={x:t.xScale*l.x+t.scale01*l.y+t.dx,y:t.scale10*l.x+t.yScale*l.y+t.dy,onCurve:l.onCurve,lastPointOfContour:l.lastPointOfContour};r.push(u)}return r}function Rb(a){for(var t=[],r=[],i=0;i<a.length;i+=1){var l=a[i];r.push(l),l.lastPointOfContour&&(t.push(r),r=[])}return We.argument(r.length===0,"There are still points left in the current contour."),t}function Um(a){var t=new Wt;if(!a)return t;for(var r=Rb(a),i=0;i<r.length;++i){var l=r[i],u=null,f=l[l.length-1],h=l[0];if(f.onCurve)t.moveTo(f.x,f.y);else if(h.onCurve)t.moveTo(h.x,h.y);else{var d={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5};t.moveTo(d.x,d.y)}for(var g=0;g<l.length;++g)if(u=f,f=h,h=l[(g+1)%l.length],f.onCurve)t.lineTo(f.x,f.y);else{var v=h;u.onCurve||((f.x+u.x)*.5,(f.y+u.y)*.5),h.onCurve||(v={x:(f.x+h.x)*.5,y:(f.y+h.y)*.5}),t.quadraticCurveTo(f.x,f.y,v.x,v.y)}t.closePath()}return t}function Im(a,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var i=t.components[r],l=a.get(i.glyphIndex);if(l.getPath(),l.points){var u=void 0;if(i.matchedPoints===void 0)u=uf(l.points,i);else{if(i.matchedPoints[0]>t.points.length-1||i.matchedPoints[1]>l.points.length-1)throw Error("Matched points out of range in "+t.name);var f=t.points[i.matchedPoints[0]],h=l.points[i.matchedPoints[1]],d={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};h=uf([h],d)[0],d.dx=f.x-h.x,d.dy=f.y-h.y,u=uf(l.points,d)}t.points=t.points.concat(u)}}return Um(t.points)}function Db(a,t,r,i){for(var l=new Ua.GlyphSet(i),u=0;u<r.length-1;u+=1){var f=r[u],h=r[u+1];f!==h?l.push(u,Ua.ttfGlyphLoader(i,u,Lm,a,t+f,Im)):l.push(u,Ua.glyphLoader(i,u))}return l}function _b(a,t,r,i){var l=new Ua.GlyphSet(i);return i._push=function(u){var f=r[u],h=r[u+1];f!==h?l.push(u,Ua.ttfGlyphLoader(i,u,Lm,a,t+f,Im)):l.push(u,Ua.glyphLoader(i,u))},l}function Ob(a,t,r,i,l){return l.lowMemory?_b(a,t,r,i):Db(a,t,r,i)}var kb={getPath:Um,parse:Ob},Bm,Ri,Fm,Cf;function jm(a){this.font=a,this.getCommands=function(t){return kb.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Lb(a){return a}function Pm(a){return Math.sign(a)*Math.round(Math.abs(a))}function Ub(a){return Math.sign(a)*Math.round(Math.abs(a*2))/2}function Ib(a){return Math.sign(a)*(Math.round(Math.abs(a)+.5)-.5)}function Bb(a){return Math.sign(a)*Math.ceil(Math.abs(a))}function Fb(a){return Math.sign(a)*Math.floor(Math.abs(a))}var Gm=function(a){var t=this.srPeriod,r=this.srPhase,i=this.srThreshold,l=1;return a<0&&(a=-a,l=-1),a+=i-r,a=Math.trunc(a/t)*t,a+=r,a<0?r*l:a*l},La={x:1,y:0,axis:"x",distance:function(a,t,r,i){return(r?a.xo:a.x)-(i?t.xo:t.x)},interpolate:function(a,t,r,i){var l,u,f,h,d,g,v;if(!i||i===this){if(l=a.xo-t.xo,u=a.xo-r.xo,d=t.x-t.xo,g=r.x-r.xo,f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){a.x=a.xo+(d+g)/2;return}a.x=a.xo+(d*h+g*f)/v;return}if(l=i.distance(a,t,!0,!0),u=i.distance(a,r,!0,!0),d=i.distance(t,t,!1,!0),g=i.distance(r,r,!1,!0),f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){La.setRelative(a,a,(d+g)/2,i,!0);return}La.setRelative(a,a,(d*h+g*f)/v,i,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(a,t,r,i,l){if(!i||i===this){a.x=(l?t.xo:t.x)+r;return}var u=l?t.xo:t.x,f=l?t.yo:t.y,h=u+r*i.x,d=f+r*i.y;a.x=h+(a.y-d)/i.normalSlope},slope:0,touch:function(a){a.xTouched=!0},touched:function(a){return a.xTouched},untouch:function(a){a.xTouched=!1}},dr={x:0,y:1,axis:"y",distance:function(a,t,r,i){return(r?a.yo:a.y)-(i?t.yo:t.y)},interpolate:function(a,t,r,i){var l,u,f,h,d,g,v;if(!i||i===this){if(l=a.yo-t.yo,u=a.yo-r.yo,d=t.y-t.yo,g=r.y-r.yo,f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){a.y=a.yo+(d+g)/2;return}a.y=a.yo+(d*h+g*f)/v;return}if(l=i.distance(a,t,!0,!0),u=i.distance(a,r,!0,!0),d=i.distance(t,t,!1,!0),g=i.distance(r,r,!1,!0),f=Math.abs(l),h=Math.abs(u),v=f+h,v===0){dr.setRelative(a,a,(d+g)/2,i,!0);return}dr.setRelative(a,a,(d*h+g*f)/v,i,!0)},normalSlope:0,setRelative:function(a,t,r,i,l){if(!i||i===this){a.y=(l?t.yo:t.y)+r;return}var u=l?t.xo:t.x,f=l?t.yo:t.y,h=u+r*i.x,d=f+r*i.y;a.y=d+i.normalSlope*(a.x-h)},slope:Number.POSITIVE_INFINITY,touch:function(a){a.yTouched=!0},touched:function(a){return a.yTouched},untouch:function(a){a.yTouched=!1}};Object.freeze(La);Object.freeze(dr);function Ol(a,t){this.x=a,this.y=t,this.axis=void 0,this.slope=t/a,this.normalSlope=-a/t,Object.freeze(this)}Ol.prototype.distance=function(a,t,r,i){return this.x*La.distance(a,t,r,i)+this.y*dr.distance(a,t,r,i)};Ol.prototype.interpolate=function(a,t,r,i){var l,u,f,h,d,g,v;if(f=i.distance(a,t,!0,!0),h=i.distance(a,r,!0,!0),l=i.distance(t,t,!1,!0),u=i.distance(r,r,!1,!0),d=Math.abs(f),g=Math.abs(h),v=d+g,v===0){this.setRelative(a,a,(l+u)/2,i,!0);return}this.setRelative(a,a,(l*g+u*d)/v,i,!0)};Ol.prototype.setRelative=function(a,t,r,i,l){i=i||this;var u=l?t.xo:t.x,f=l?t.yo:t.y,h=u+r*i.x,d=f+r*i.y,g=i.normalSlope,v=this.slope,E=a.x,y=a.y;a.x=(v*E-g*h+d-y)/(v-g),a.y=v*(a.x-E)+y};Ol.prototype.touch=function(a){a.xTouched=!0,a.yTouched=!0};function kl(a,t){var r=Math.sqrt(a*a+t*t);return a/=r,t/=r,a===1&&t===0?La:a===0&&t===1?dr:new Ol(a,t)}function pr(a,t,r,i){this.x=this.xo=Math.round(a*64)/64,this.y=this.yo=Math.round(t*64)/64,this.lastPointOfContour=r,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}pr.prototype.nextTouched=function(a){for(var t=this.nextPointOnContour;!a.touched(t)&&t!==this;)t=t.nextPointOnContour;return t};pr.prototype.prevTouched=function(a){for(var t=this.prevPointOnContour;!a.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var Nl=Object.freeze(new pr(0,0)),jb={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Zr(a,t){switch(this.env=a,this.stack=[],this.prog=t,a){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=La,this.round=Pm}}jm.prototype.exec=function(a,t){if(typeof t!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var r=this.font,i=this._prepState;if(!i||i.ppem!==t){var l=this._fpgmState;if(!l){Zr.prototype=jb,l=this._fpgmState=new Zr("fpgm",r.tables.fpgm),l.funcs=[],l.font=r,exports.DEBUG&&(console.log("---EXEC FPGM---"),l.step=-1);try{Ri(l)}catch(g){console.log("Hinting error in FPGM:"+g),this._errorState=3;return}}Zr.prototype=l,i=this._prepState=new Zr("prep",r.tables.prep),i.ppem=t;var u=r.tables.cvt;if(u)for(var f=i.cvt=new Array(u.length),h=t/r.unitsPerEm,d=0;d<u.length;d++)f[d]=u[d]*h;else i.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),i.step=-1);try{Ri(i)}catch(g){this._errorState<2&&console.log("Hinting error in PREP:"+g),this._errorState=2}}if(!(this._errorState>1))try{return Fm(a,i)}catch(g){this._errorState<1&&(console.log("Hinting error:"+g),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};Fm=function(a,t){var r=t.ppem/t.font.unitsPerEm,i=r,l=a.components,u,f,h;if(Zr.prototype=t,!l)h=new Zr("glyf",a.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),h.step=-1),Cf(a,h,r,i),f=h.gZone;else{var d=t.font;f=[],u=[];for(var g=0;g<l.length;g++){var v=l[g],E=d.glyphs.get(v.glyphIndex);h=new Zr("glyf",E.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+g+"---"),h.step=-1),Cf(E,h,r,i);for(var y=Math.round(v.dx*r),x=Math.round(v.dy*i),S=h.gZone,A=h.contours,N=0;N<S.length;N++){var D=S[N];D.xTouched=D.yTouched=!1,D.xo=D.x=D.x+y,D.yo=D.y=D.y+x}var L=f.length;f.push.apply(f,S);for(var M=0;M<A.length;M++)u.push(A[M]+L)}a.instructions&&!h.inhibitGridFit&&(h=new Zr("glyf",a.instructions),h.gZone=h.z0=h.z1=h.z2=f,h.contours=u,f.push(new pr(0,0),new pr(Math.round(a.advanceWidth*r),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),h.step=-1),Ri(h),f.length-=2)}return f};Cf=function(a,t,r,i){for(var l=a.points||[],u=l.length,f=t.gZone=t.z0=t.z1=t.z2=[],h=t.contours=[],d,g=0;g<u;g++)d=l[g],f[g]=new pr(d.x*r,d.y*i,d.lastPointOfContour,d.onCurve);for(var v,E,y=0;y<u;y++)d=f[y],v||(v=d,h.push(y)),d.lastPointOfContour?(d.nextPointOnContour=v,v.prevPointOnContour=d,v=void 0):(E=f[y+1],d.nextPointOnContour=E,E.prevPointOnContour=d);if(!t.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(var x=0;x<u;x++)console.log(x,f[x].x,f[x].y)}if(f.push(new pr(0,0),new pr(Math.round(a.advanceWidth*r),0)),Ri(t),f.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",t.stack);for(var S=0;S<u;S++)console.log(S,f[S].x,f[S].y)}}};Ri=function(a){var t=a.prog;if(t){var r=t.length,i;for(a.ip=0;a.ip<r;a.ip++){if(exports.DEBUG&&a.step++,i=Bm[t[a.ip]],!i)throw new Error("unknown instruction: 0x"+Number(t[a.ip]).toString(16));i(a)}}};function lu(a){for(var t=a.tZone=new Array(a.gZone.length),r=0;r<t.length;r++)t[r]=new pr(0,0)}function zm(a,t){var r=a.prog,i=a.ip,l=1,u;do if(u=r[++i],u===88)l++;else if(u===89)l--;else if(u===64)i+=r[i+1]+1;else if(u===65)i+=2*r[i+1]+1;else if(u>=176&&u<=183)i+=u-176+1;else if(u>=184&&u<=191)i+=(u-184+1)*2;else if(t&&l===1&&u===27)break;while(l>0);a.ip=i}function _0(a,t){exports.DEBUG&&console.log(t.step,"SVTCA["+a.axis+"]"),t.fv=t.pv=t.dpv=a}function O0(a,t){exports.DEBUG&&console.log(t.step,"SPVTCA["+a.axis+"]"),t.pv=t.dpv=a}function k0(a,t){exports.DEBUG&&console.log(t.step,"SFVTCA["+a.axis+"]"),t.fv=a}function L0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z2[i],f=t.z1[l];exports.DEBUG&&console.log("SPVTL["+a+"]",i,l);var h,d;a?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.pv=t.dpv=kl(h,d)}function U0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z2[i],f=t.z1[l];exports.DEBUG&&console.log("SFVTL["+a+"]",i,l);var h,d;a?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.fv=kl(h,d)}function Pb(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SPVFS[]",r,i),a.pv=a.dpv=kl(i,r)}function Gb(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SPVFS[]",r,i),a.fv=kl(i,r)}function zb(a){var t=a.stack,r=a.pv;exports.DEBUG&&console.log(a.step,"GPV[]"),t.push(r.x*16384),t.push(r.y*16384)}function Hb(a){var t=a.stack,r=a.fv;exports.DEBUG&&console.log(a.step,"GFV[]"),t.push(r.x*16384),t.push(r.y*16384)}function Yb(a){a.fv=a.pv,exports.DEBUG&&console.log(a.step,"SFVTPV[]")}function qb(a){var t=a.stack,r=t.pop(),i=t.pop(),l=t.pop(),u=t.pop(),f=t.pop(),h=a.z0,d=a.z1,g=h[r],v=h[i],E=d[l],y=d[u],x=a.z2[f];exports.DEBUG&&console.log("ISECT[], ",r,i,l,u,f);var S=g.x,A=g.y,N=v.x,D=v.y,L=E.x,M=E.y,C=y.x,B=y.y,V=(S-N)*(M-B)-(A-D)*(L-C),te=S*D-A*N,de=L*B-M*C;x.x=(te*(L-C)-de*(S-N))/V,x.y=(te*(M-B)-de*(A-D))/V}function Vb(a){a.rp0=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP0[]",a.rp0)}function Xb(a){a.rp1=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP1[]",a.rp1)}function Zb(a){a.rp2=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SRP2[]",a.rp2)}function Qb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP0[]",t),a.zp0=t,t){case 0:a.tZone||lu(a),a.z0=a.tZone;break;case 1:a.z0=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function $b(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP1[]",t),a.zp1=t,t){case 0:a.tZone||lu(a),a.z1=a.tZone;break;case 1:a.z1=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Wb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZP2[]",t),a.zp2=t,t){case 0:a.tZone||lu(a),a.z2=a.tZone;break;case 1:a.z2=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Kb(a){var t=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"SZPS[]",t),a.zp0=a.zp1=a.zp2=t,t){case 0:a.tZone||lu(a),a.z0=a.z1=a.z2=a.tZone;break;case 1:a.z0=a.z1=a.z2=a.gZone;break;default:throw new Error("Invalid zone pointer")}}function Jb(a){a.loop=a.stack.pop(),exports.DEBUG&&console.log(a.step,"SLOOP[]",a.loop)}function ex(a){exports.DEBUG&&console.log(a.step,"RTG[]"),a.round=Pm}function tx(a){exports.DEBUG&&console.log(a.step,"RTHG[]"),a.round=Ib}function nx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SMD[]",t),a.minDis=t/64}function ax(a){exports.DEBUG&&console.log(a.step,"ELSE[]"),zm(a,!1)}function rx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"JMPR[]",t),a.ip+=t-1}function ix(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCVTCI[]",t),a.cvCutIn=t/64}function sx(a){var t=a.stack;exports.DEBUG&&console.log(a.step,"DUP[]"),t.push(t[t.length-1])}function cf(a){exports.DEBUG&&console.log(a.step,"POP[]"),a.stack.pop()}function lx(a){exports.DEBUG&&console.log(a.step,"CLEAR[]"),a.stack.length=0}function ox(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SWAP[]"),t.push(r),t.push(i)}function ux(a){var t=a.stack;exports.DEBUG&&console.log(a.step,"DEPTH[]"),t.push(t.length)}function cx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"LOOPCALL[]",r,i);var l=a.ip,u=a.prog;a.prog=a.funcs[r];for(var f=0;f<i;f++)Ri(a),exports.DEBUG&&console.log(++a.step,f+1<i?"next loopcall":"done loopcall",f);a.ip=l,a.prog=u}function fx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"CALL[]",t);var r=a.ip,i=a.prog;a.prog=a.funcs[t],Ri(a),a.ip=r,a.prog=i,exports.DEBUG&&console.log(++a.step,"returning from",t)}function dx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"CINDEX[]",r),t.push(t[t.length-r])}function px(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"MINDEX[]",r),t.push(t.splice(t.length-r,1)[0])}function hx(a){if(a.env!=="fpgm")throw new Error("FDEF not allowed here");var t=a.stack,r=a.prog,i=a.ip,l=t.pop(),u=i;for(exports.DEBUG&&console.log(a.step,"FDEF[]",l);r[++i]!==45;);a.ip=i,a.funcs[l]=r.slice(u+1,i)}function I0(a,t){var r=t.stack.pop(),i=t.z0[r],l=t.fv,u=t.pv;exports.DEBUG&&console.log(t.step,"MDAP["+a+"]",r);var f=u.distance(i,Nl);a&&(f=t.round(f)),l.setRelative(i,Nl,f,u),l.touch(i),t.rp0=t.rp1=r}function B0(a,t){var r=t.z2,i=r.length-2,l,u,f;exports.DEBUG&&console.log(t.step,"IUP["+a.axis+"]");for(var h=0;h<i;h++)l=r[h],!a.touched(l)&&(u=l.prevTouched(a),u!==l&&(f=l.nextTouched(a),u===f&&a.setRelative(l,l,a.distance(u,u,!1,!0),a,!0),a.interpolate(l,u,f,a)))}function F0(a,t){for(var r=t.stack,i=a?t.rp1:t.rp2,l=(a?t.z0:t.z1)[i],u=t.fv,f=t.pv,h=t.loop,d=t.z2;h--;){var g=r.pop(),v=d[g],E=f.distance(l,l,!1,!0);u.setRelative(v,v,E,f),u.touch(v),exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-h)+": ":"")+"SHP["+(a?"rp1":"rp2")+"]",g)}t.loop=1}function j0(a,t){var r=t.stack,i=a?t.rp1:t.rp2,l=(a?t.z0:t.z1)[i],u=t.fv,f=t.pv,h=r.pop(),d=t.z2[t.contours[h]],g=d;exports.DEBUG&&console.log(t.step,"SHC["+a+"]",h);var v=f.distance(l,l,!1,!0);do g!==l&&u.setRelative(g,g,v,f),g=g.nextPointOnContour;while(g!==d)}function P0(a,t){var r=t.stack,i=a?t.rp1:t.rp2,l=(a?t.z0:t.z1)[i],u=t.fv,f=t.pv,h=r.pop();exports.DEBUG&&console.log(t.step,"SHZ["+a+"]",h);var d;switch(h){case 0:d=t.tZone;break;case 1:d=t.gZone;break;default:throw new Error("Invalid zone")}for(var g,v=f.distance(l,l,!1,!0),E=d.length-2,y=0;y<E;y++)g=d[y],u.setRelative(g,g,v,f)}function mx(a){for(var t=a.stack,r=a.loop,i=a.fv,l=t.pop()/64,u=a.z2;r--;){var f=t.pop(),h=u[f];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-r)+": ":"")+"SHPIX[]",f,l),i.setRelative(h,h,l),i.touch(h)}a.loop=1}function gx(a){for(var t=a.stack,r=a.rp1,i=a.rp2,l=a.loop,u=a.z0[r],f=a.z1[i],h=a.fv,d=a.dpv,g=a.z2;l--;){var v=t.pop(),E=g[v];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-l)+": ":"")+"IP[]",v,r,"<->",i),h.interpolate(E,u,f,d),h.touch(E)}a.loop=1}function G0(a,t){var r=t.stack,i=r.pop()/64,l=r.pop(),u=t.z1[l],f=t.z0[t.rp0],h=t.fv,d=t.pv;h.setRelative(u,f,i,d),h.touch(u),exports.DEBUG&&console.log(t.step,"MSIRP["+a+"]",i,l),t.rp1=t.rp0,t.rp2=l,a&&(t.rp0=l)}function vx(a){for(var t=a.stack,r=a.rp0,i=a.z0[r],l=a.loop,u=a.fv,f=a.pv,h=a.z1;l--;){var d=t.pop(),g=h[d];exports.DEBUG&&console.log(a.step,(a.loop>1?"loop "+(a.loop-l)+": ":"")+"ALIGNRP[]",d),u.setRelative(g,i,0,f),u.touch(g)}a.loop=1}function yx(a){exports.DEBUG&&console.log(a.step,"RTDG[]"),a.round=Ub}function z0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z0[l],f=t.fv,h=t.pv,d=t.cvt[i];exports.DEBUG&&console.log(t.step,"MIAP["+a+"]",i,"(",d,")",l);var g=h.distance(u,Nl);a&&(Math.abs(g-d)<t.cvCutIn&&(g=d),g=t.round(g)),f.setRelative(u,Nl,g,h),t.zp0===0&&(u.xo=u.x,u.yo=u.y),f.touch(u),t.rp0=t.rp1=l}function bx(a){var t=a.prog,r=a.ip,i=a.stack,l=t[++r];exports.DEBUG&&console.log(a.step,"NPUSHB[]",l);for(var u=0;u<l;u++)i.push(t[++r]);a.ip=r}function xx(a){var t=a.ip,r=a.prog,i=a.stack,l=r[++t];exports.DEBUG&&console.log(a.step,"NPUSHW[]",l);for(var u=0;u<l;u++){var f=r[++t]<<8|r[++t];f&32768&&(f=-((f^65535)+1)),i.push(f)}a.ip=t}function Sx(a){var t=a.stack,r=a.store;r||(r=a.store=[]);var i=t.pop(),l=t.pop();exports.DEBUG&&console.log(a.step,"WS",i,l),r[l]=i}function Ex(a){var t=a.stack,r=a.store,i=t.pop();exports.DEBUG&&console.log(a.step,"RS",i);var l=r&&r[i]||0;t.push(l)}function wx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"WCVTP",r,i),a.cvt[i]=r/64}function Ax(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"RCVT",r),t.push(a.cvt[r]*64)}function H0(a,t){var r=t.stack,i=r.pop(),l=t.z2[i];exports.DEBUG&&console.log(t.step,"GC["+a+"]",i),r.push(t.dpv.distance(l,Nl,a,!1)*64)}function Y0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z1[i],f=t.z0[l],h=t.dpv.distance(f,u,a,a);exports.DEBUG&&console.log(t.step,"MD["+a+"]",i,l,"->",h),t.stack.push(Math.round(h*64))}function Tx(a){exports.DEBUG&&console.log(a.step,"MPPEM[]"),a.stack.push(a.ppem)}function Cx(a){exports.DEBUG&&console.log(a.step,"FLIPON[]"),a.autoFlip=!0}function Mx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"LT[]",r,i),t.push(i<r?1:0)}function Nx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"LTEQ[]",r,i),t.push(i<=r?1:0)}function Rx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"GT[]",r,i),t.push(i>r?1:0)}function Dx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"GTEQ[]",r,i),t.push(i>=r?1:0)}function _x(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"EQ[]",r,i),t.push(r===i?1:0)}function Ox(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"NEQ[]",r,i),t.push(r!==i?1:0)}function kx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"ODD[]",r),t.push(Math.trunc(r)%2?1:0)}function Lx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"EVEN[]",r),t.push(Math.trunc(r)%2?0:1)}function Ux(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"IF[]",t),t||(zm(a,!0),exports.DEBUG&&console.log(a.step,"EIF[]"))}function Ix(a){exports.DEBUG&&console.log(a.step,"EIF[]")}function Bx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"AND[]",r,i),t.push(r&&i?1:0)}function Fx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"OR[]",r,i),t.push(r||i?1:0)}function jx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"NOT[]",r),t.push(r?0:1)}function ff(a,t){var r=t.stack,i=r.pop(),l=t.fv,u=t.pv,f=t.ppem,h=t.deltaBase+(a-1)*16,d=t.deltaShift,g=t.z0;exports.DEBUG&&console.log(t.step,"DELTAP["+a+"]",i,r);for(var v=0;v<i;v++){var E=r.pop(),y=r.pop(),x=h+((y&240)>>4);if(x===f){var S=(y&15)-8;S>=0&&S++,exports.DEBUG&&console.log(t.step,"DELTAPFIX",E,"by",S*d);var A=g[E];l.setRelative(A,A,S*d,u)}}}function Px(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"SDB[]",r),a.deltaBase=r}function Gx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"SDS[]",r),a.deltaShift=Math.pow(.5,r)}function zx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"ADD[]",r,i),t.push(i+r)}function Hx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"SUB[]",r,i),t.push(i-r)}function Yx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"DIV[]",r,i),t.push(i*64/r)}function qx(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"MUL[]",r,i),t.push(i*r/64)}function Vx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"ABS[]",r),t.push(Math.abs(r))}function Xx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"NEG[]",r),t.push(-r)}function Zx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"FLOOR[]",r),t.push(Math.floor(r/64)*64)}function Qx(a){var t=a.stack,r=t.pop();exports.DEBUG&&console.log(a.step,"CEILING[]",r),t.push(Math.ceil(r/64)*64)}function Qo(a,t){var r=t.stack,i=r.pop();exports.DEBUG&&console.log(t.step,"ROUND[]"),r.push(t.round(i/64)*64)}function $x(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"WCVTF[]",r,i),a.cvt[i]=r*a.ppem/a.font.unitsPerEm}function df(a,t){var r=t.stack,i=r.pop(),l=t.ppem,u=t.deltaBase+(a-1)*16,f=t.deltaShift;exports.DEBUG&&console.log(t.step,"DELTAC["+a+"]",i,r);for(var h=0;h<i;h++){var d=r.pop(),g=r.pop(),v=u+((g&240)>>4);if(v===l){var E=(g&15)-8;E>=0&&E++;var y=E*f;exports.DEBUG&&console.log(t.step,"DELTACFIX",d,"by",y),t.cvt[d]+=y}}}function Wx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SROUND[]",t),a.round=Gm;var r;switch(t&192){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(a.srPeriod=r,t&48){case 0:a.srPhase=0;break;case 16:a.srPhase=.25*r;break;case 32:a.srPhase=.5*r;break;case 48:a.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}t&=15,t===0?a.srThreshold=0:a.srThreshold=(t/8-.5)*r}function Kx(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"S45ROUND[]",t),a.round=Gm;var r;switch(t&192){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(a.srPeriod=r,t&48){case 0:a.srPhase=0;break;case 16:a.srPhase=.25*r;break;case 32:a.srPhase=.5*r;break;case 48:a.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}t&=15,t===0?a.srThreshold=0:a.srThreshold=(t/8-.5)*r}function Jx(a){exports.DEBUG&&console.log(a.step,"ROFF[]"),a.round=Lb}function eS(a){exports.DEBUG&&console.log(a.step,"RUTG[]"),a.round=Bb}function tS(a){exports.DEBUG&&console.log(a.step,"RDTG[]"),a.round=Fb}function nS(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCANCTRL[]",t)}function q0(a,t){var r=t.stack,i=r.pop(),l=r.pop(),u=t.z2[i],f=t.z1[l];exports.DEBUG&&console.log(t.step,"SDPVTL["+a+"]",i,l);var h,d;a?(h=u.y-f.y,d=f.x-u.x):(h=f.x-u.x,d=f.y-u.y),t.dpv=kl(h,d)}function aS(a){var t=a.stack,r=t.pop(),i=0;exports.DEBUG&&console.log(a.step,"GETINFO[]",r),r&1&&(i=35),r&32&&(i|=4096),t.push(i)}function rS(a){var t=a.stack,r=t.pop(),i=t.pop(),l=t.pop();exports.DEBUG&&console.log(a.step,"ROLL[]"),t.push(i),t.push(r),t.push(l)}function iS(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"MAX[]",r,i),t.push(Math.max(i,r))}function sS(a){var t=a.stack,r=t.pop(),i=t.pop();exports.DEBUG&&console.log(a.step,"MIN[]",r,i),t.push(Math.min(i,r))}function lS(a){var t=a.stack.pop();exports.DEBUG&&console.log(a.step,"SCANTYPE[]",t)}function oS(a){var t=a.stack.pop(),r=a.stack.pop();switch(exports.DEBUG&&console.log(a.step,"INSTCTRL[]",t,r),t){case 1:a.inhibitGridFit=!!r;return;case 2:a.ignoreCvt=!!r;return;default:throw new Error("invalid INSTCTRL[] selector")}}function qr(a,t){var r=t.stack,i=t.prog,l=t.ip;exports.DEBUG&&console.log(t.step,"PUSHB["+a+"]");for(var u=0;u<a;u++)r.push(i[++l]);t.ip=l}function Vr(a,t){var r=t.ip,i=t.prog,l=t.stack;exports.DEBUG&&console.log(t.ip,"PUSHW["+a+"]");for(var u=0;u<a;u++){var f=i[++r]<<8|i[++r];f&32768&&(f=-((f^65535)+1)),l.push(f)}t.ip=r}function De(a,t,r,i,l,u){var f=u.stack,h=a&&f.pop(),d=f.pop(),g=u.rp0,v=u.z0[g],E=u.z1[d],y=u.minDis,x=u.fv,S=u.dpv,A,N,D,L;N=A=S.distance(E,v,!0,!0),D=N>=0?1:-1,N=Math.abs(N),a&&(L=u.cvt[h],i&&Math.abs(N-L)<u.cvCutIn&&(N=L)),r&&N<y&&(N=y),i&&(N=u.round(N)),x.setRelative(E,v,D*N,S),x.touch(E),exports.DEBUG&&console.log(u.step,(a?"MIRP[":"MDRP[")+(t?"M":"m")+(r?">":"_")+(i?"R":"_")+(l===0?"Gr":l===1?"Bl":l===2?"Wh":"")+"]",a?h+"("+u.cvt[h]+","+L+")":"",d,"(d =",A,"->",D*N,")"),u.rp1=u.rp0,u.rp2=d,t&&(u.rp0=d)}Bm=[_0.bind(void 0,dr),_0.bind(void 0,La),O0.bind(void 0,dr),O0.bind(void 0,La),k0.bind(void 0,dr),k0.bind(void 0,La),L0.bind(void 0,0),L0.bind(void 0,1),U0.bind(void 0,0),U0.bind(void 0,1),Pb,Gb,zb,Hb,Yb,qb,Vb,Xb,Zb,Qb,$b,Wb,Kb,Jb,ex,tx,nx,ax,rx,ix,void 0,void 0,sx,cf,lx,ox,ux,dx,px,void 0,void 0,void 0,cx,fx,hx,void 0,I0.bind(void 0,0),I0.bind(void 0,1),B0.bind(void 0,dr),B0.bind(void 0,La),F0.bind(void 0,0),F0.bind(void 0,1),j0.bind(void 0,0),j0.bind(void 0,1),P0.bind(void 0,0),P0.bind(void 0,1),mx,gx,G0.bind(void 0,0),G0.bind(void 0,1),vx,yx,z0.bind(void 0,0),z0.bind(void 0,1),bx,xx,Sx,Ex,wx,Ax,H0.bind(void 0,0),H0.bind(void 0,1),void 0,Y0.bind(void 0,0),Y0.bind(void 0,1),Tx,void 0,Cx,void 0,void 0,Mx,Nx,Rx,Dx,_x,Ox,kx,Lx,Ux,Ix,Bx,Fx,jx,ff.bind(void 0,1),Px,Gx,zx,Hx,Yx,qx,Vx,Xx,Zx,Qx,Qo.bind(void 0,0),Qo.bind(void 0,1),Qo.bind(void 0,2),Qo.bind(void 0,3),void 0,void 0,void 0,void 0,$x,ff.bind(void 0,2),ff.bind(void 0,3),df.bind(void 0,1),df.bind(void 0,2),df.bind(void 0,3),Wx,Kx,void 0,void 0,Jx,void 0,eS,tS,cf,cf,void 0,void 0,void 0,void 0,void 0,nS,q0.bind(void 0,0),q0.bind(void 0,1),aS,void 0,rS,iS,sS,lS,oS,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,qr.bind(void 0,1),qr.bind(void 0,2),qr.bind(void 0,3),qr.bind(void 0,4),qr.bind(void 0,5),qr.bind(void 0,6),qr.bind(void 0,7),qr.bind(void 0,8),Vr.bind(void 0,1),Vr.bind(void 0,2),Vr.bind(void 0,3),Vr.bind(void 0,4),Vr.bind(void 0,5),Vr.bind(void 0,6),Vr.bind(void 0,7),Vr.bind(void 0,8),De.bind(void 0,0,0,0,0,0),De.bind(void 0,0,0,0,0,1),De.bind(void 0,0,0,0,0,2),De.bind(void 0,0,0,0,0,3),De.bind(void 0,0,0,0,1,0),De.bind(void 0,0,0,0,1,1),De.bind(void 0,0,0,0,1,2),De.bind(void 0,0,0,0,1,3),De.bind(void 0,0,0,1,0,0),De.bind(void 0,0,0,1,0,1),De.bind(void 0,0,0,1,0,2),De.bind(void 0,0,0,1,0,3),De.bind(void 0,0,0,1,1,0),De.bind(void 0,0,0,1,1,1),De.bind(void 0,0,0,1,1,2),De.bind(void 0,0,0,1,1,3),De.bind(void 0,0,1,0,0,0),De.bind(void 0,0,1,0,0,1),De.bind(void 0,0,1,0,0,2),De.bind(void 0,0,1,0,0,3),De.bind(void 0,0,1,0,1,0),De.bind(void 0,0,1,0,1,1),De.bind(void 0,0,1,0,1,2),De.bind(void 0,0,1,0,1,3),De.bind(void 0,0,1,1,0,0),De.bind(void 0,0,1,1,0,1),De.bind(void 0,0,1,1,0,2),De.bind(void 0,0,1,1,0,3),De.bind(void 0,0,1,1,1,0),De.bind(void 0,0,1,1,1,1),De.bind(void 0,0,1,1,1,2),De.bind(void 0,0,1,1,1,3),De.bind(void 0,1,0,0,0,0),De.bind(void 0,1,0,0,0,1),De.bind(void 0,1,0,0,0,2),De.bind(void 0,1,0,0,0,3),De.bind(void 0,1,0,0,1,0),De.bind(void 0,1,0,0,1,1),De.bind(void 0,1,0,0,1,2),De.bind(void 0,1,0,0,1,3),De.bind(void 0,1,0,1,0,0),De.bind(void 0,1,0,1,0,1),De.bind(void 0,1,0,1,0,2),De.bind(void 0,1,0,1,0,3),De.bind(void 0,1,0,1,1,0),De.bind(void 0,1,0,1,1,1),De.bind(void 0,1,0,1,1,2),De.bind(void 0,1,0,1,1,3),De.bind(void 0,1,1,0,0,0),De.bind(void 0,1,1,0,0,1),De.bind(void 0,1,1,0,0,2),De.bind(void 0,1,1,0,0,3),De.bind(void 0,1,1,0,1,0),De.bind(void 0,1,1,0,1,1),De.bind(void 0,1,1,0,1,2),De.bind(void 0,1,1,0,1,3),De.bind(void 0,1,1,1,0,0),De.bind(void 0,1,1,1,0,1),De.bind(void 0,1,1,1,0,2),De.bind(void 0,1,1,1,0,3),De.bind(void 0,1,1,1,1,0),De.bind(void 0,1,1,1,1,1),De.bind(void 0,1,1,1,1,2),De.bind(void 0,1,1,1,1,3)];function Ss(a){this.char=a,this.state={},this.activeState=null}function Bf(a,t,r){this.contextName=r,this.startIndex=a,this.endOffset=t}function uS(a,t,r){this.contextName=a,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=r}function ba(a,t){this.context=a,this.index=t,this.length=a.length,this.current=a[t],this.backtrack=a.slice(0,t),this.lookahead=a.slice(t+1)}function ou(a){this.eventId=a,this.subscribers=[]}function cS(a){var t=this,r=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];r.forEach(function(l){Object.defineProperty(t.events,l,{value:new ou(l)})}),a&&r.forEach(function(l){var u=a[l];typeof u=="function"&&t.events[l].subscribe(u)});var i=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];i.forEach(function(l){t.events[l].subscribe(t.updateContextsRanges)})}function Bt(a){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],cS.call(this,a)}Ss.prototype.setState=function(a,t){return this.state[a]=t,this.activeState={key:a,value:this.state[a]},this.activeState};Ss.prototype.getState=function(a){return this.state[a]||null};Bt.prototype.inboundIndex=function(a){return a>=0&&a<this.tokens.length};Bt.prototype.composeRUD=function(a){var t=this,r=!0,i=a.map(function(u){return t[u[0]].apply(t,u.slice(1).concat(r))}),l=function(u){return typeof u=="object"&&u.hasOwnProperty("FAIL")};if(i.every(l))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:i.filter(l)};this.dispatch("composeRUD",[i.filter(function(u){return!l(u)})])};Bt.prototype.replaceRange=function(a,t,r,i){t=t!==null?t:this.tokens.length;var l=r.every(function(f){return f instanceof Ss});if(!isNaN(a)&&this.inboundIndex(a)&&l){var u=this.tokens.splice.apply(this.tokens,[a,t].concat(r));return i||this.dispatch("replaceToken",[a,t,r]),[u,r]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};Bt.prototype.replaceToken=function(a,t,r){if(!isNaN(a)&&this.inboundIndex(a)&&t instanceof Ss){var i=this.tokens.splice(a,1,t);return r||this.dispatch("replaceToken",[a,t]),[i[0],t]}else return{FAIL:"replaceToken: invalid token or index."}};Bt.prototype.removeRange=function(a,t,r){t=isNaN(t)?this.tokens.length:t;var i=this.tokens.splice(a,t);return r||this.dispatch("removeRange",[i,a,t]),i};Bt.prototype.removeToken=function(a,t){if(!isNaN(a)&&this.inboundIndex(a)){var r=this.tokens.splice(a,1);return t||this.dispatch("removeToken",[r,a]),r}else return{FAIL:"removeToken: invalid token index."}};Bt.prototype.insertToken=function(a,t,r){var i=a.every(function(l){return l instanceof Ss});return i?(this.tokens.splice.apply(this.tokens,[t,0].concat(a)),r||this.dispatch("insertToken",[a,t]),a):{FAIL:"insertToken: invalid token(s)."}};Bt.prototype.registerModifier=function(a,t,r){this.events.newToken.subscribe(function(i,l){var u=[i,l],f=t===null||t.apply(this,u)===!0,h=[i,l];if(f){var d=r.apply(this,h);i.setState(a,d)}}),this.registeredModifiers.push(a)};ou.prototype.subscribe=function(a){return typeof a=="function"?this.subscribers.push(a)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};ou.prototype.unsubscribe=function(a){this.subscribers.splice(a,1)};ba.prototype.setCurrentIndex=function(a){this.index=a,this.current=this.context[a],this.backtrack=this.context.slice(0,a),this.lookahead=this.context.slice(a+1)};ba.prototype.get=function(a){switch(!0){case a===0:return this.current;case(a<0&&Math.abs(a)<=this.backtrack.length):return this.backtrack.slice(a)[0];case(a>0&&a<=this.lookahead.length):return this.lookahead[a-1];default:return null}};Bt.prototype.rangeToText=function(a){if(a instanceof Bf)return this.getRangeTokens(a).map(function(t){return t.char}).join("")};Bt.prototype.getText=function(){return this.tokens.map(function(a){return a.char}).join("")};Bt.prototype.getContext=function(a){var t=this.registeredContexts[a];return t||null};Bt.prototype.on=function(a,t){var r=this.events[a];return r?r.subscribe(t):null};Bt.prototype.dispatch=function(a,t){var r=this,i=this.events[a];i instanceof ou&&i.subscribers.forEach(function(l){l.apply(r,t||[])})};Bt.prototype.registerContextChecker=function(a,t,r){if(this.getContext(a))return{FAIL:"context name '"+a+"' is already registered."};if(typeof t!="function")return{FAIL:"missing context start check."};if(typeof r!="function")return{FAIL:"missing context end check."};var i=new uS(a,t,r);return this.registeredContexts[a]=i,this.contextCheckers.push(i),i};Bt.prototype.getRangeTokens=function(a){var t=a.startIndex+a.endOffset;return[].concat(this.tokens.slice(a.startIndex,t))};Bt.prototype.getContextRanges=function(a){var t=this.getContext(a);return t?t.ranges:{FAIL:"context checker '"+a+"' is not registered."}};Bt.prototype.resetContextsRanges=function(){var a=this.registeredContexts;for(var t in a)if(a.hasOwnProperty(t)){var r=a[t];r.ranges=[]}};Bt.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var a=this.tokens.map(function(i){return i.char}),t=0;t<a.length;t++){var r=new ba(a,t);this.runContextCheck(r)}this.dispatch("updateContextsRanges",[this.registeredContexts])};Bt.prototype.setEndOffset=function(a,t){var r=this.getContext(t).openRange.startIndex,i=new Bf(r,a,t),l=this.getContext(t).ranges;return i.rangeId=t+"."+l.length,l.push(i),this.getContext(t).openRange=null,i};Bt.prototype.runContextCheck=function(a){var t=this,r=a.index;this.contextCheckers.forEach(function(i){var l=i.contextName,u=t.getContext(l).openRange;if(!u&&i.checkStart(a)&&(u=new Bf(r,null,l),t.getContext(l).openRange=u,t.dispatch("contextStart",[l,r])),u&&i.checkEnd(a)){var f=r-u.startIndex+1,h=t.setEndOffset(f,l);t.dispatch("contextEnd",[l,h])}})};Bt.prototype.tokenize=function(a){this.tokens=[],this.resetContextsRanges();var t=Array.from(a);this.dispatch("start");for(var r=0;r<t.length;r++){var i=t[r],l=new ba(t,r);this.dispatch("next",[l]),this.runContextCheck(l);var u=new Ss(i);this.tokens.push(u),this.dispatch("newToken",[u,l])}return this.dispatch("end",[this.tokens]),this.tokens};function Qr(a){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(a)}function Hm(a){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(a)}function $r(a){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(a)}function Jo(a){return/[A-z]/.test(a)}function fS(a){return/\s/.test(a)}function Hn(a){this.font=a,this.features={}}function Ni(a){this.id=a.id,this.tag=a.tag,this.substitution=a.substitution}function Ll(a,t){if(!a)return-1;switch(t.format){case 1:return t.glyphs.indexOf(a);case 2:for(var r=t.ranges,i=0;i<r.length;i++){var l=r[i];if(a>=l.start&&a<=l.end){var u=a-l.start;return l.index+u}}break;default:return-1}return-1}function dS(a,t){var r=Ll(a,t.coverage);return r===-1?null:a+t.deltaGlyphId}function pS(a,t){var r=Ll(a,t.coverage);return r===-1?null:t.substitute[r]}function pf(a,t){for(var r=[],i=0;i<a.length;i++){var l=a[i],u=t.current;u=Array.isArray(u)?u[0]:u;var f=Ll(u,l);f!==-1&&r.push(f)}return r.length!==a.length?-1:r}function hS(a,t){var r=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(a.context.length<r)return[];var i=pf(t.inputCoverage,a);if(i===-1)return[];var l=t.inputCoverage.length-1;if(a.lookahead.length<t.lookaheadCoverage.length)return[];for(var u=a.lookahead.slice(l);u.length&&$r(u[0].char);)u.shift();var f=new ba(u,0),h=pf(t.lookaheadCoverage,f),d=[].concat(a.backtrack);for(d.reverse();d.length&&$r(d[0].char);)d.shift();if(d.length<t.backtrackCoverage.length)return[];var g=new ba(d,0),v=pf(t.backtrackCoverage,g),E=i.length===t.inputCoverage.length&&h.length===t.lookaheadCoverage.length&&v.length===t.backtrackCoverage.length,y=[];if(E)for(var x=0;x<t.lookupRecords.length;x++)for(var S=t.lookupRecords[x],A=S.lookupListIndex,N=this.getLookupByIndex(A),D=0;D<N.subtables.length;D++){var L=N.subtables[D],M=this.getLookupMethod(N,L),C=this.getSubstitutionType(N,L);if(C==="12")for(var B=0;B<i.length;B++){var V=a.get(B),te=M(V);te&&y.push(te)}}return y}function mS(a,t){var r=a.current,i=Ll(r,t.coverage);if(i===-1)return null;for(var l,u=t.ligatureSets[i],f=0;f<u.length;f++){l=u[f];for(var h=0;h<l.components.length;h++){var d=a.lookahead[h],g=l.components[h];if(d!==g)break;if(h===l.components.length-1)return l}}return null}function gS(a,t){var r=Ll(a,t.coverage);return r===-1?null:t.sequences[r]}Hn.prototype.getDefaultScriptFeaturesIndexes=function(){for(var a=this.font.tables.gsub.scripts,t=0;t<a.length;t++){var r=a[t];if(r.tag==="DFLT")return r.script.defaultLangSys.featureIndexes}return[]};Hn.prototype.getScriptFeaturesIndexes=function(a){var t=this.font.tables;if(!t.gsub)return[];if(!a)return this.getDefaultScriptFeaturesIndexes();for(var r=this.font.tables.gsub.scripts,i=0;i<r.length;i++){var l=r[i];if(l.tag===a&&l.script.defaultLangSys)return l.script.defaultLangSys.featureIndexes;var u=l.langSysRecords;if(u)for(var f=0;f<u.length;f++){var h=u[f];if(h.tag===a){var d=h.langSys;return d.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};Hn.prototype.mapTagsToFeatures=function(a,t){for(var r={},i=0;i<a.length;i++){var l=a[i].tag,u=a[i].feature;r[l]=u}this.features[t].tags=r};Hn.prototype.getScriptFeatures=function(a){var t=this.features[a];if(this.features.hasOwnProperty(a))return t;var r=this.getScriptFeaturesIndexes(a);if(!r)return null;var i=this.font.tables.gsub;return t=r.map(function(l){return i.features[l]}),this.features[a]=t,this.mapTagsToFeatures(t,a),t};Hn.prototype.getSubstitutionType=function(a,t){var r=a.lookupType.toString(),i=t.substFormat.toString();return r+i};Hn.prototype.getLookupMethod=function(a,t){var r=this,i=this.getSubstitutionType(a,t);switch(i){case"11":return function(l){return dS.apply(r,[l,t])};case"12":return function(l){return pS.apply(r,[l,t])};case"63":return function(l){return hS.apply(r,[l,t])};case"41":return function(l){return mS.apply(r,[l,t])};case"21":return function(l){return gS.apply(r,[l,t])};default:throw new Error("lookupType: "+a.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}};Hn.prototype.lookupFeature=function(a){var t=a.contextParams,r=t.index,i=this.getFeature({tag:a.tag,script:a.script});if(!i)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+a.tag+"' for script '"+a.script+"'.");for(var l=this.getFeatureLookups(i),u=[].concat(t.context),f=0;f<l.length;f++)for(var h=l[f],d=this.getLookupSubtables(h),g=0;g<d.length;g++){var v=d[g],E=this.getSubstitutionType(h,v),y=this.getLookupMethod(h,v),x=void 0;switch(E){case"11":x=y(t.current),x&&u.splice(r,1,new Ni({id:11,tag:a.tag,substitution:x}));break;case"12":x=y(t.current),x&&u.splice(r,1,new Ni({id:12,tag:a.tag,substitution:x}));break;case"63":x=y(t),Array.isArray(x)&&x.length&&u.splice(r,1,new Ni({id:63,tag:a.tag,substitution:x}));break;case"41":x=y(t),x&&u.splice(r,1,new Ni({id:41,tag:a.tag,substitution:x}));break;case"21":x=y(t.current),x&&u.splice(r,1,new Ni({id:21,tag:a.tag,substitution:x}));break}t=new ba(u,r),!(Array.isArray(x)&&!x.length)&&(x=null)}return u.length?u:null};Hn.prototype.supports=function(a){if(!a.script)return!1;this.getScriptFeatures(a.script);var t=this.features.hasOwnProperty(a.script);if(!a.tag)return t;var r=this.features[a.script].some(function(i){return i.tag===a.tag});return t&&r};Hn.prototype.getLookupSubtables=function(a){return a.subtables||null};Hn.prototype.getLookupByIndex=function(a){var t=this.font.tables.gsub.lookups;return t[a]||null};Hn.prototype.getFeatureLookups=function(a){return a.lookupListIndexes.map(this.getLookupByIndex.bind(this))};Hn.prototype.getFeature=function(t){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script);var r=this.features[t.script];return r?r.tags[t.tag]?this.features[t.script].tags[t.tag]:null:{FAIL:"No feature for script "+t.script}};function vS(a){var t=a.current,r=a.get(-1);return r===null&&Qr(t)||!Qr(r)&&Qr(t)}function yS(a){var t=a.get(1);return t===null||!Qr(t)}var bS={startCheck:vS,endCheck:yS};function xS(a){var t=a.current,r=a.get(-1);return(Qr(t)||$r(t))&&!Qr(r)}function SS(a){var t=a.get(1);switch(!0){case t===null:return!0;case(!Qr(t)&&!$r(t)):var r=fS(t);if(!r)return!0;if(r){var i=!1;if(i=a.lookahead.some(function(l){return Qr(l)||$r(l)}),!i)return!0}break;default:return!1}}var ES={startCheck:xS,endCheck:SS};function wS(a,t,r){t[r].setState(a.tag,a.substitution)}function AS(a,t,r){t[r].setState(a.tag,a.substitution)}function TS(a,t,r){a.substitution.forEach(function(i,l){var u=t[r+l];u.setState(a.tag,i)})}function CS(a,t,r){var i=t[r];i.setState(a.tag,a.substitution.ligGlyph);for(var l=a.substitution.components.length,u=0;u<l;u++)i=t[r+u+1],i.setState("deleted",!0)}var V0={11:wS,12:AS,63:TS,41:CS};function Ff(a,t,r){a instanceof Ni&&V0[a.id]&&V0[a.id](a,t,r)}function MS(a){for(var t=[].concat(a.backtrack),r=t.length-1;r>=0;r--){var i=t[r],l=Hm(i),u=$r(i);if(!l&&!u)return!0;if(l)return!1}return!1}function NS(a){if(Hm(a.current))return!1;for(var t=0;t<a.lookahead.length;t++){var r=a.lookahead[t],i=$r(r);if(!i)return!0}return!1}function RS(a){var t=this,r="arab",i=this.featuresTags[r],l=this.tokenizer.getRangeTokens(a);if(l.length!==1){var u=new ba(l.map(function(h){return h.getState("glyphIndex")}),0),f=new ba(l.map(function(h){return h.char}),0);l.forEach(function(h,d){if(!$r(h.char)){u.setCurrentIndex(d),f.setCurrentIndex(d);var g=0;MS(f)&&(g|=1),NS(f)&&(g|=2);var v;switch(g){case 1:v="fina";break;case 2:v="init";break;case 3:v="medi";break}if(i.indexOf(v)!==-1){var E=t.query.lookupFeature({tag:v,script:r,contextParams:u});if(E instanceof Error)return console.info(E.message);E.forEach(function(y,x){y instanceof Ni&&(Ff(y,l,x),u.context[x]=y.substitution)})}}})}}function X0(a,t){var r=a.map(function(i){return i.activeState.value});return new ba(r,0)}function DS(a){var t=this,r="arab",i=this.tokenizer.getRangeTokens(a),l=X0(i);l.context.forEach(function(u,f){l.setCurrentIndex(f);var h=t.query.lookupFeature({tag:"rlig",script:r,contextParams:l});h.length&&(h.forEach(function(d){return Ff(d,i,f)}),l=X0(i))})}function _S(a){var t=a.current,r=a.get(-1);return r===null&&Jo(t)||!Jo(r)&&Jo(t)}function OS(a){var t=a.get(1);return t===null||!Jo(t)}var kS={startCheck:_S,endCheck:OS};function Z0(a,t){var r=a.map(function(i){return i.activeState.value});return new ba(r,0)}function LS(a){var t=this,r="latn",i=this.tokenizer.getRangeTokens(a),l=Z0(i);l.context.forEach(function(u,f){l.setCurrentIndex(f);var h=t.query.lookupFeature({tag:"liga",script:r,contextParams:l});h.length&&(h.forEach(function(d){return Ff(d,i,f)}),l=Z0(i))})}function Sa(a){this.baseDir=a||"ltr",this.tokenizer=new Bt,this.featuresTags={}}Sa.prototype.setText=function(a){this.text=a};Sa.prototype.contextChecks={latinWordCheck:kS,arabicWordCheck:bS,arabicSentenceCheck:ES};function hf(a){var t=this.contextChecks[a+"Check"];return this.tokenizer.registerContextChecker(a,t.startCheck,t.endCheck)}function US(){return hf.call(this,"latinWord"),hf.call(this,"arabicWord"),hf.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function IS(){var a=this,t=this.tokenizer.getContextRanges("arabicSentence");t.forEach(function(r){var i=a.tokenizer.getRangeTokens(r);a.tokenizer.replaceRange(r.startIndex,r.endOffset,i.reverse())})}Sa.prototype.registerFeatures=function(a,t){var r=this,i=t.filter(function(l){return r.query.supports({script:a,tag:l})});this.featuresTags.hasOwnProperty(a)?this.featuresTags[a]=this.featuresTags[a].concat(i):this.featuresTags[a]=i};Sa.prototype.applyFeatures=function(a,t){if(!a)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Hn(a));for(var r=0;r<t.length;r++){var i=t[r];this.query.supports({script:i.script})&&this.registerFeatures(i.script,i.tags)}};Sa.prototype.registerModifier=function(a,t,r){this.tokenizer.registerModifier(a,t,r)};function jf(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function BS(){var a=this,t="arab";if(this.featuresTags.hasOwnProperty(t)){jf.call(this);var r=this.tokenizer.getContextRanges("arabicWord");r.forEach(function(i){RS.call(a,i)})}}function FS(){var a=this,t="arab";if(this.featuresTags.hasOwnProperty(t)){var r=this.featuresTags[t];if(r.indexOf("rlig")!==-1){jf.call(this);var i=this.tokenizer.getContextRanges("arabicWord");i.forEach(function(l){DS.call(a,l)})}}}function jS(){var a=this,t="latn";if(this.featuresTags.hasOwnProperty(t)){var r=this.featuresTags[t];if(r.indexOf("liga")!==-1){jf.call(this);var i=this.tokenizer.getContextRanges("latinWord");i.forEach(function(l){LS.call(a,l)})}}}Sa.prototype.checkContextReady=function(a){return!!this.tokenizer.getContext(a)};Sa.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(BS.call(this),FS.call(this)),this.checkContextReady("latinWord")&&jS.call(this),this.checkContextReady("arabicSentence")&&IS.call(this)};Sa.prototype.processText=function(a){(!this.text||this.text!==a)&&(this.setText(a),US.call(this),this.applyFeaturesToContexts())};Sa.prototype.getBidiText=function(a){return this.processText(a),this.tokenizer.getText()};Sa.prototype.getTextGlyphs=function(a){this.processText(a);for(var t=[],r=0;r<this.tokenizer.tokens.length;r++){var i=this.tokenizer.tokens[r];if(!i.state.deleted){var l=i.activeState.value;t.push(Array.isArray(l)?l[0]:l)}}return t};function Mt(a){a=a||{},a.tables=a.tables||{},a.empty||(Sl(a.familyName,"When creating a new Font object, familyName is required."),Sl(a.styleName,"When creating a new Font object, styleName is required."),Sl(a.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Sl(a.ascender,"When creating a new Font object, ascender is required."),Sl(a.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:a.familyName||" "},fontSubfamily:{en:a.styleName||" "},fullName:{en:a.fullName||a.familyName+" "+a.styleName},postScriptName:{en:a.postScriptName||(a.familyName+a.styleName).replace(/\s/g,"")},designer:{en:a.designer||" "},designerURL:{en:a.designerURL||" "},manufacturer:{en:a.manufacturer||" "},manufacturerURL:{en:a.manufacturerURL||" "},license:{en:a.license||" "},licenseURL:{en:a.licenseURL||" "},version:{en:a.version||"Version 0.1"},description:{en:a.description||" "},copyright:{en:a.copyright||" "},trademark:{en:a.trademark||" "}},this.unitsPerEm=a.unitsPerEm||1e3,this.ascender=a.ascender,this.descender=a.descender,this.createdTimestamp=a.createdTimestamp,this.tables=Object.assign(a.tables,{os2:Object.assign({usWeightClass:a.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:a.widthClass||this.usWidthClasses.MEDIUM,fsSelection:a.fsSelection||this.fsSelectionValues.REGULAR},a.tables.os2)})),this.supported=!0,this.glyphs=new Ua.GlyphSet(this,a.glyphs||[]),this.encoding=new xm(this),this.position=new _l(this),this.substitution=new zn(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new jm(this)}})}Mt.prototype.hasChar=function(a){return this.encoding.charToGlyphIndex(a)!==null};Mt.prototype.charToGlyphIndex=function(a){return this.encoding.charToGlyphIndex(a)};Mt.prototype.charToGlyph=function(a){var t=this.charToGlyphIndex(a),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r};Mt.prototype.updateFeatures=function(a){return this.defaultRenderOptions.features.map(function(t){return t.script==="latn"?{script:"latn",tags:t.tags.filter(function(r){return a[r]})}:t})};Mt.prototype.stringToGlyphs=function(a,t){var r=this,i=new Sa,l=function(E){return r.charToGlyphIndex(E.char)};i.registerModifier("glyphIndex",null,l);var u=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;i.applyFeatures(this,u);for(var f=i.getTextGlyphs(a),h=f.length,d=new Array(h),g=this.glyphs.get(0),v=0;v<h;v+=1)d[v]=this.glyphs.get(f[v])||g;return d};Mt.prototype.nameToGlyphIndex=function(a){return this.glyphNames.nameToGlyphIndex(a)};Mt.prototype.nameToGlyph=function(a){var t=this.nameToGlyphIndex(a),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r};Mt.prototype.glyphIndexToName=function(a){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(a):""};Mt.prototype.getKerningValue=function(a,t){a=a.index||a,t=t.index||t;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,a,t):this.kerningPairs[a+","+t]||0};Mt.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};Mt.prototype.forEachGlyph=function(a,t,r,i,l,u){t=t!==void 0?t:0,r=r!==void 0?r:0,i=i!==void 0?i:72,l=Object.assign({},this.defaultRenderOptions,l);var f=1/this.unitsPerEm*i,h=this.stringToGlyphs(a,l),d;if(l.kerning){var g=l.script||this.position.getDefaultScriptName();d=this.position.getKerningTables(g,l.language)}for(var v=0;v<h.length;v+=1){var E=h[v];if(u.call(this,E,t,r,i,l),E.advanceWidth&&(t+=E.advanceWidth*f),l.kerning&&v<h.length-1){var y=d?this.position.getKerningValue(d,E.index,h[v+1].index):this.getKerningValue(E,h[v+1]);t+=y*f}l.letterSpacing?t+=l.letterSpacing*i:l.tracking&&(t+=l.tracking/1e3*i)}return t};Mt.prototype.getPath=function(a,t,r,i,l){var u=new Wt;return this.forEachGlyph(a,t,r,i,l,function(f,h,d,g){var v=f.getPath(h,d,g,l,this);u.extend(v)}),u};Mt.prototype.getPaths=function(a,t,r,i,l){var u=[];return this.forEachGlyph(a,t,r,i,l,function(f,h,d,g){var v=f.getPath(h,d,g,l,this);u.push(v)}),u};Mt.prototype.getAdvanceWidth=function(a,t,r){return this.forEachGlyph(a,0,0,t,r,function(){})};Mt.prototype.draw=function(a,t,r,i,l,u){this.getPath(t,r,i,l,u).draw(a)};Mt.prototype.drawPoints=function(a,t,r,i,l,u){this.forEachGlyph(t,r,i,l,u,function(f,h,d,g){f.drawPoints(a,h,d,g)})};Mt.prototype.drawMetrics=function(a,t,r,i,l,u){this.forEachGlyph(t,r,i,l,u,function(f,h,d,g){f.drawMetrics(a,h,d,g)})};Mt.prototype.getEnglishName=function(a){var t=this.names[a];if(t)return t.en};Mt.prototype.validate=function(){var a=this;function t(i,l){}function r(i){var l=a.getEnglishName(i);l&&l.trim().length>0}r("fontFamily"),r("weightName"),r("manufacturer"),r("copyright"),r("version"),this.unitsPerEm>0};Mt.prototype.toTables=function(){return Tb.fontToTable(this)};Mt.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};Mt.prototype.toArrayBuffer=function(){for(var a=this.toTables(),t=a.encode(),r=new ArrayBuffer(t.length),i=new Uint8Array(r),l=0;l<t.length;l++)i[l]=t[l];return r};Mt.prototype.download=function(a){var t=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");a=a||t.replace(/\s/g,"")+"-"+r+".otf";var i=this.toArrayBuffer();if(Mb())if(window.URL=window.URL||window.webkitURL,window.URL){var l=new DataView(i),u=new Blob([l],{type:"font/opentype"}),f=document.createElement("a");f.href=window.URL.createObjectURL(u),f.download=a;var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!1),f.dispatchEvent(h)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var d=require("fs"),g=Nb(i);d.writeFileSync(a,g)}};Mt.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};Mt.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Mt.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var hr=new Array(10);hr[1]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{posFormat:1,coverage:this.parsePointer(re.coverage),value:this.parseValueRecord()};if(r===2)return{posFormat:2,coverage:this.parsePointer(re.coverage),values:this.parseValueRecordList()};We.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};hr[2]=function(){var t=this.offset+this.relativeOffset,r=this.parseUShort();We.assert(r===1||r===2,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var i=this.parsePointer(re.coverage),l=this.parseUShort(),u=this.parseUShort();if(r===1)return{posFormat:r,coverage:i,valueFormat1:l,valueFormat2:u,pairSets:this.parseList(re.pointer(re.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(l),value2:this.parseValueRecord(u)}})))};if(r===2){var f=this.parsePointer(re.classDef),h=this.parsePointer(re.classDef),d=this.parseUShort(),g=this.parseUShort();return{posFormat:r,coverage:i,valueFormat1:l,valueFormat2:u,classDef1:f,classDef2:h,class1Count:d,class2Count:g,classRecords:this.parseList(d,re.list(g,function(){return{value1:this.parseValueRecord(l),value2:this.parseValueRecord(u)}}))}}};hr[3]=function(){return{error:"GPOS Lookup 3 not supported"}};hr[4]=function(){return{error:"GPOS Lookup 4 not supported"}};hr[5]=function(){return{error:"GPOS Lookup 5 not supported"}};hr[6]=function(){return{error:"GPOS Lookup 6 not supported"}};hr[7]=function(){return{error:"GPOS Lookup 7 not supported"}};hr[8]=function(){return{error:"GPOS Lookup 8 not supported"}};hr[9]=function(){return{error:"GPOS Lookup 9 not supported"}};new Array(10);const Mf=()=>Math.random().toString(36).substr(2,9),PS=_n.memo(({playbackFps:a,onSpeedChange:t})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"range",paramName:"master_speed",targetType:"global",label:"SPEED",min:1,max:120,step:1}))};return m.jsxs("div",{className:"master-speed-slider",children:[m.jsxs("label",{htmlFor:"masterSpeedRange",draggable:!0,onDragStart:r,children:[a," FPS"]}),m.jsx(Nt,{id:"master_speed",children:m.jsx("input",{type:"range",min:"1",max:"120",value:a,className:"slider_hor",id:"masterSpeedRange",onChange:i=>t(parseInt(i.target.value))})})]})}),GS=_n.memo(({isWorldOutputActive:a,onToggleWorldOutput:t})=>{const r=i=>{i.dataTransfer.setData("application/x-truelazer-param",JSON.stringify({type:"toggle",paramName:"laser_output",targetType:"global",label:"LASER"}))};return m.jsx("div",{className:"container",draggable:!0,onDragStart:r,children:m.jsx(Nt,{id:"laser_output",children:m.jsx("input",{type:"checkbox",checked:a,onChange:t})})})}),wl=(a,t,r,i)=>!Array.isArray(a)||a.length!==t?Array(t).fill(null).map((l,u)=>Array(r).fill(null).map((f,h)=>i(u,h))):a.map((l,u)=>!Array.isArray(l)||l.length!==r?Array(r).fill(null).map((f,h)=>i(u,h)):l),Ym=a=>({columns:Array.from({length:8},(t,r)=>`Col ${r+1}`),layers:Array.from({length:5},(t,r)=>`Layer ${r+1}`),clipContents:wl(a?.clipContents,5,8,()=>({parsing:!1})),clipNames:wl(a?.clipNames,5,8,(t,r)=>`Clip ${t+1}-${r+1}`),thumbnailFrameIndexes:Array(5).fill(null).map(()=>Array(8).fill(0)),layerEffects:Array.from({length:5},()=>[]),layerAssignedDacs:a?.layerAssignedDacs??Array(5).fill([]),layerIntensities:Array(5).fill(1),layerAutopilots:Array(5).fill("off"),layerBlackouts:Array(5).fill(!1),layerSolos:Array(5).fill(!1),masterIntensity:1,globalBlackout:!1,selectedLayerIndex:null,selectedColIndex:null,notification:{message:"",visible:!1},dacs:[],selectedDac:a?.dacAssignment?.selectedDac??a?.selectedDac??null,ildaFrames:[],selectedIldaWorkerId:null,selectedIldaTotalFrames:0,bpm:a?.bpm??120,showBeamEffect:a?.renderSettings?.showBeamEffect??!0,beamAlpha:a?.renderSettings?.beamAlpha??.1,fadeAlpha:a?.renderSettings?.fadeAlpha??.13,playbackFps:a?.renderSettings?.playbackFps??60,previewScanRate:a?.renderSettings?.previewScanRate??1,beamRenderMode:a?.renderSettings?.beamRenderMode??"both",worldShowBeamEffect:a?.renderSettings?.worldShowBeamEffect??!0,worldBeamRenderMode:a?.renderSettings?.worldBeamRenderMode??"both",activeClipIndexes:Array(5).fill(null),isPlaying:!1,isStopped:!0,isWorldOutputActive:!1,thumbnailRenderMode:a?.thumbnailRenderMode??"still",theme:a?.theme??"orange",projectLoadTimestamp:null,clipClipboard:null,dacOutputSettings:a?.dacOutputSettings??{},quickAssigns:{knobs:Array(8).fill(null).map(()=>({value:0,label:null,link:null})),buttons:Array(8).fill(null).map(()=>({value:!1,label:null,link:null}))}});function zS(a,t){switch(t.type){case"SET_DAC_OUTPUT_SETTINGS":return{...a,dacOutputSettings:{...a.dacOutputSettings,[t.payload.id]:t.payload.settings}};case"SET_COLUMNS":return{...a,columns:t.payload};case"SET_COLUMN_NAME":{const r=[...a.columns];return r[t.payload.index]=t.payload.name,{...a,columns:r}}case"SET_LAYERS":return{...a,layers:t.payload};case"SET_LAYER_NAME":{const r=[...a.layers];return r[t.payload.index]=t.payload.name,{...a,layers:r}}case"SET_CLIP_CONTENT":{const{layerIndex:r,colIndex:i,content:l}=t.payload;if(r===void 0||i===void 0)return a;const u=[...a.clipContents];if(!u[r])return console.error(`Reducer Error: Layer array at index ${r} is undefined. Action:`,t),a;u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,...l},{...a,clipContents:u}}case"SET_CLIP_NAME":{const{layerIndex:r,colIndex:i,name:l}=t.payload;if(r===void 0||i===void 0)return a;const u=[...a.clipNames];return u[r]&&(u[r]=[...u[r]],u[r][i]=l),{...a,clipNames:u}}case"SET_THUMBNAIL_FRAME_INDEX":{const r=[...a.thumbnailFrameIndexes];return r[t.payload.layerIndex][t.payload.colIndex]=t.payload.index,{...a,thumbnailFrameIndexes:r}}case"ADD_LAYER_EFFECT":{const r=[...a.layerEffects],i={...t.payload.effect,instanceId:Mf(),params:{...t.payload.effect.defaultParams}};return r[t.payload.layerIndex].push(i),{...a,layerEffects:r}}case"ADD_CLIP_EFFECT":{const r=[...a.clipContents];if(!r[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),a;r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=r[t.payload.layerIndex][t.payload.colIndex]||{},l={...t.payload.effect,instanceId:Mf(),params:{...t.payload.effect.defaultParams}},u={...i,effects:[...i.effects||[],l]};return r[t.payload.layerIndex][t.payload.colIndex]=u,{...a,clipContents:r}}case"SET_SELECTED_CLIP":return{...a,selectedLayerIndex:t.payload.layerIndex,selectedColIndex:t.payload.colIndex};case"SET_NOTIFICATION":return{...a,notification:t.payload};case"SET_ILDA_FRAMES":return{...a,ildaFrames:t.payload};case"SET_SELECTED_ILDA_DATA":return{...a,selectedIldaWorkerId:t.payload.workerId,selectedIldaTotalFrames:t.payload.totalFrames,selectedGeneratorId:t.payload.generatorId,selectedGeneratorParams:t.payload.generatorParams};case"SET_ACTIVE_CLIP":{const r=[...a.activeClipIndexes];return r[t.payload.layerIndex]=t.payload.colIndex,{...a,activeClipIndexes:r}}case"CLEAR_CLIP":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]],r[t.payload.layerIndex][t.payload.colIndex]=null;const i=[...a.clipNames];i[t.payload.layerIndex][t.payload.colIndex]=`Clip ${t.payload.layerIndex+1}-${t.payload.colIndex+1}`;const l=[...a.thumbnailFrameIndexes];l[t.payload.layerIndex][t.payload.colIndex]=0;const u=[...a.activeClipIndexes];return u[t.payload.layerIndex]===t.payload.colIndex&&(u[t.payload.layerIndex]=null),a.selectedLayerIndex===t.payload.layerIndex&&a.selectedColIndex===t.payload.colIndex?{...a,clipContents:r,clipNames:i,thumbnailFrameIndexes:l,activeClipIndexes:u,selectedLayerIndex:null,selectedColIndex:null,selectedIldaWorkerId:null,selectedIldaTotalFrames:0,selectedGeneratorId:null,selectedGeneratorParams:{}}:{...a,clipContents:r,clipNames:i,thumbnailFrameIndexes:l,activeClipIndexes:u}}case"DEACTIVATE_LAYER_CLIPS":{const r=[...a.activeClipIndexes];return r[t.payload.layerIndex]=null,{...a,activeClipIndexes:r}}case"CLEAR_ALL_ACTIVE_CLIPS":return{...a,activeClipIndexes:Array(a.layers.length).fill(null)};case"SET_LAYER_INTENSITY":{const r=[...a.layerIntensities];return r[t.payload.layerIndex]=t.payload.intensity,{...a,layerIntensities:r}}case"SET_LAYER_AUTOPILOT":{const r=[...a.layerAutopilots];return r[t.payload.layerIndex]=t.payload.mode,{...a,layerAutopilots:r}}case"TOGGLE_LAYER_BLACKOUT":{const r=[...a.layerBlackouts];return r[t.payload.layerIndex]=!r[t.payload.layerIndex],{...a,layerBlackouts:r}}case"TOGGLE_LAYER_SOLO":{const r=[...a.layerSolos],i=r[t.payload.layerIndex];return r.fill(!1),i||(r[t.payload.layerIndex]=!0),{...a,layerSolos:r}}case"SET_MASTER_INTENSITY":return{...a,masterIntensity:t.payload};case"TOGGLE_GLOBAL_BLACKOUT":return{...a,globalBlackout:!a.globalBlackout};case"SET_RENDER_SETTING":return{...a,[t.payload.setting]:t.payload.value};case"REMOVE_CLIP_EFFECT":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};if(i&&i.effects){const l=[...i.effects];l.splice(t.payload.effectIndex,1),i.effects=l,r[t.payload.layerIndex][t.payload.colIndex]=i}return{...a,clipContents:r}}case"REORDER_CLIP_EFFECTS":{const{layerIndex:r,colIndex:i,oldIndex:l,newIndex:u}=t.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h&&h.effects){const d=[...h.effects],[g]=d.splice(l,1);d.splice(u,0,g),h.effects=d,f[r][i]=h}return{...a,clipContents:f}}case"REMOVE_LAYER_EFFECT":{const r=[...a.layerEffects];return r[t.payload.layerIndex]&&(r[t.payload.layerIndex]=[...r[t.payload.layerIndex]],r[t.payload.layerIndex].splice(t.payload.effectIndex,1)),{...a,layerEffects:r}}case"UPDATE_LAYER_EFFECT_PARAMETER":{const r=[...a.layerEffects];if(r[t.payload.layerIndex]){r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=t.payload.effectIndex;if(r[t.payload.layerIndex][i]){const l={...r[t.payload.layerIndex][i]};l.params={...l.params,[t.payload.paramName]:t.payload.newValue},r[t.payload.layerIndex][i]=l}}return{...a,layerEffects:r}}case"UPDATE_EFFECT_PARAMETER":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};if(i&&i.effects){const l=[...i.effects],u={...l[t.payload.effectIndex]};u.params={...u.params,[t.payload.paramName]:t.payload.newValue},l[t.payload.effectIndex]=u,i.effects=l,r[t.payload.layerIndex][t.payload.colIndex]=i}return{...a,clipContents:r}}case"UPDATE_CLIP_PLAYBACK_SETTINGS":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};return i&&(i.playbackSettings={...i.playbackSettings||{mode:"fps",duration:1,beats:8,speedMultiplier:1},...t.payload.settings},r[t.payload.layerIndex][t.payload.colIndex]=i),{...a,clipContents:r}}case"SET_CLIP_PARAM_SYNC":{const{layerIndex:r,colIndex:i,paramId:l,syncMode:u}=t.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h){const d=h.syncSettings||{},g=d[l]===u?null:u;h.syncSettings={...d,[l]:g},f[r][i]=h}return{...a,clipContents:f}}case"UPDATE_GENERATOR_PARAM":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i={...r[t.payload.layerIndex][t.payload.colIndex]};return i&&i.type==="generator"&&i.currentParams&&(i.currentParams={...i.currentParams,[t.payload.paramName]:t.payload.newValue},r[t.payload.layerIndex][t.payload.colIndex]=i,a.selectedLayerIndex===t.payload.layerIndex&&a.selectedColIndex===t.payload.colIndex)?{...a,clipContents:r,selectedGeneratorParams:i.currentParams}:{...a,clipContents:r}}case"SET_DACS":return{...a,dacs:t.payload};case"SET_BPM":return{...a,bpm:t.payload};case"SET_SELECTED_DAC":return{...a,selectedDac:t.payload};case"SET_IS_PLAYING":return{...a,isPlaying:t.payload};case"SET_IS_STOPPED":return{...a,isStopped:t.payload};case"SET_WORLD_OUTPUT_ACTIVE":return{...a,isWorldOutputActive:t.payload};case"TOGGLE_WORLD_OUTPUT_ACTIVE":return{...a,isWorldOutputActive:!a.isWorldOutputActive};case"SET_CLIPBOARD":return{...a,clipClipboard:t.payload};case"SET_CLIP_DAC":{const r=[...a.clipContents];if(!r[t.payload.layerIndex])return console.error(`Reducer Error: Layer array at index ${t.payload.layerIndex} is undefined. Action:`,t),a;r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const i=r[t.payload.layerIndex][t.payload.colIndex]||{};let l=i.assignedDacs||[];const u=[],f=d=>{const{channels:g,allChannels:v,...E}=d;return E};if(t.payload.dac.allChannels&&t.payload.dac.channels)t.payload.dac.channels.forEach(d=>{l.some(g=>g.ip===t.payload.dac.ip&&g.channel===d.serviceID)||u.push({...f(t.payload.dac),channel:d.serviceID,mirrorX:!1,mirrorY:!1})});else{const d=t.payload.dac.channel;d!==void 0&&!l.some(g=>g.ip===t.payload.dac.ip&&g.channel===d)&&u.push({...f(t.payload.dac),channel:d,mirrorX:!1,mirrorY:!1})}if(u.length===0)return a;const h={...i,assignedDacs:[...l,...u]};return r[t.payload.layerIndex][t.payload.colIndex]=h,{...a,clipContents:r}}case"SET_LAYER_DAC":{const{layerIndex:r,dac:i}=t.payload,l=[...a.layerAssignedDacs],u=l[r]||[];let f=[];const h=d=>{const{channels:g,allChannels:v,...E}=d;return E};if(i.allChannels&&i.channels)i.channels.forEach(d=>{u.some(g=>g.ip===i.ip&&g.channel===d.serviceID)||f.push({...h(i),channel:d.serviceID,mirrorX:!1,mirrorY:!1})});else{const d=i.channel;d!==void 0&&!u.some(g=>g.ip===i.ip&&g.channel===d)&&f.push({...h(i),channel:d,mirrorX:!1,mirrorY:!1})}return f.length===0?a:(l[r]=[...u,...f],{...a,layerAssignedDacs:l})}case"TOGGLE_CLIP_DAC_MIRROR":{const{layerIndex:r,colIndex:i,dacIndex:l,axis:u}=t.payload,f=[...a.clipContents];f[r]=[...f[r]];const h={...f[r][i]};if(h&&h.assignedDacs){const d=[...h.assignedDacs],g={...d[l]};return u==="x"&&(g.mirrorX=!g.mirrorX),u==="y"&&(g.mirrorY=!g.mirrorY),d[l]=g,h.assignedDacs=d,f[r][i]=h,{...a,clipContents:f}}return a}case"REMOVE_CLIP_DAC":{const r=[...a.clipContents];r[t.payload.layerIndex]=[...r[t.payload.layerIndex]];const{layerIndex:i,colIndex:l,dacIndex:u}=t.payload,f=r[i][l];if(f&&f.assignedDacs){const h=[...f.assignedDacs];return h.splice(u,1),r[t.payload.layerIndex][t.payload.colIndex]={...f,assignedDacs:h},{...a,clipContents:r}}return a}case"TOGGLE_LAYER_DAC_MIRROR":{const{layerIndex:r,dacIndex:i,axis:l}=t.payload,u=[...a.layerAssignedDacs],f=u[r]?[...u[r]]:[];if(f[i]){const h={...f[i]};return l==="x"&&(h.mirrorX=!h.mirrorX),l==="y"&&(h.mirrorY=!h.mirrorY),f[i]=h,u[r]=f,{...a,layerAssignedDacs:u}}return a}case"REMOVE_LAYER_DAC":{const{layerIndex:r,dacIndex:i}=t.payload,l=[...a.layerAssignedDacs];if(l[r]){const u=[...l[r]];return u.splice(i,1),l[r]=u,{...a,layerAssignedDacs:l}}return a}case"SET_CLIP_AUDIO":{const r=[...a.clipContents],{layerIndex:i,colIndex:l,audioFile:u}=t.payload;r[i]=[...r[i]];const f=r[i][l];return f?(r[i][l]={...f,audioFile:u,audioVolume:f.audioVolume!==void 0?f.audioVolume:1},{...a,clipContents:r}):a}case"SET_CLIP_AUDIO_VOLUME":{const r=[...a.clipContents],{layerIndex:i,colIndex:l,volume:u}=t.payload;r[i]=[...r[i]];const f=r[i][l];return f?(r[i][l]={...f,audioVolume:u},{...a,clipContents:r}):a}case"REMOVE_CLIP_AUDIO":{const r=[...a.clipContents],{layerIndex:i,colIndex:l}=t.payload;r[i]=[...r[i]];const u=r[i][l];return u?(r[i][l]={...u,audioFile:null},{...a,clipContents:r}):a}case"SET_CLIP_PARSING_STATUS":{const{layerIndex:r,colIndex:i,status:l}=t.payload,u=[...a.clipContents];if(u[r]){u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,parsing:l},{...a,clipContents:u}}return a}case"SET_BULK_PARSING_STATUS":{const r=[...a.clipContents];return new Set(t.payload.map(l=>l.layerIndex)).forEach(l=>{r[l]&&(r[l]=[...r[l]])}),t.payload.forEach(({layerIndex:l,colIndex:u,status:f})=>{if(r[l]){const h=r[l][u]||{};r[l][u]={...h,parsing:f}}}),{...a,clipContents:r}}case"SET_THUMBNAIL_RENDER_MODE":return{...a,thumbnailRenderMode:t.payload};case"SET_CLIP_TRIGGER_STYLE":{const{layerIndex:r,colIndex:i,style:l}=t.payload,u=[...a.clipContents];u[r]=[...u[r]];const f=u[r][i]||{};return u[r][i]={...f,triggerStyle:l},{...a,clipContents:u}}case"SET_THEME":return{...a,theme:t.payload};case"UPDATE_THUMBNAIL":{const{layerIndex:r,colIndex:i,frameIndex:l}=t.payload,u=[...a.thumbnailFrameIndexes];return u[r]=[...u[r]],u[r][i]=l,{...a,thumbnailFrameIndexes:u}}case"RESET_STATE":return Ym({});case"LOAD_PROJECT":{const r={...a,...t.payload};return r.clipContents=wl(r.clipContents,5,8,()=>({parsing:!1})),r.clipNames=wl(r.clipNames,5,8,(i,l)=>`Clip ${i+1}-${l+1}`),r.clipContents=r.clipContents.map(i=>i.map(l=>l&&l.type==="ilda"?{...l,workerId:null,parsing:!1}:l)),r.activeClipIndexes=Array(a.layers.length).fill(null),r.selectedLayerIndex=null,r.selectedColIndex=null,r.selectedIldaWorkerId=null,r.selectedIldaTotalFrames=0,r.selectedGeneratorId=null,r.selectedGeneratorParams={},r.projectLoadTimestamp=Date.now(),r}case"LOAD_SETTINGS":return{...a,showBeamEffect:t.payload.renderSettings?.showBeamEffect??a.showBeamEffect,beamAlpha:t.payload.renderSettings?.beamAlpha??a.beamAlpha,fadeAlpha:t.payload.renderSettings?.fadeAlpha??a.fadeAlpha,playbackFps:t.payload.renderSettings?.playbackFps??a.playbackFps,previewScanRate:t.payload.renderSettings?.previewScanRate??a.previewScanRate,beamRenderMode:t.payload.renderSettings?.beamRenderMode??a.beamRenderMode,theme:t.payload.theme??a.theme,thumbnailRenderMode:t.payload.thumbnailRenderMode??a.thumbnailRenderMode,selectedDac:t.payload.selectedDac??a.selectedDac,clipNames:t.payload.clipNames?wl(t.payload.clipNames,5,8,(r,i)=>`Clip ${r+1}-${i+1}`):a.clipNames,dacOutputSettings:t.payload.dacOutputSettings??a.dacOutputSettings};case"ASSIGN_QUICK_CONTROL":{const{type:r,index:i,link:l}=t.payload,u={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},f=r==="knob"?"knobs":"buttons";return u[f][i]={...u[f][i],label:l.paramName||l.paramId,link:l,min:l.min,max:l.max,step:l.step},{...a,quickAssigns:u}}case"UPDATE_QUICK_CONTROL":{const{type:r,index:i,value:l}=t.payload,u={knobs:[...a.quickAssigns.knobs],buttons:[...a.quickAssigns.buttons]},f=r==="knob"?"knobs":"buttons",h=u[f][i];u[f][i]={...h,value:l};let d={...a,quickAssigns:u};if(h.link){const{layerIndex:g,colIndex:v,effectIndex:E,targetType:y}=h.link,x=h.link.paramName||h.link.paramId;let S=l;if(r==="knob"&&h.min!==void 0&&h.max!==void 0&&(S=h.min+l*(h.max-h.min),h.step&&(S=Math.round(S/h.step)*h.step),S=parseFloat(S.toFixed(5))),console.log(`Updating ${y} param ${x} to ${S} (Link: L${g} C${v} E${E})`),y==="layerEffect"){const A=[...d.layerEffects];if(A[g]&&(A[g]=[...A[g]],A[g][E])){const N={...A[g][E]};N.params={...N.params,[x]:S},A[g][E]=N,d={...d,layerEffects:A}}}else if(y==="global")x==="master_intensity"?d={...d,masterIntensity:S}:x==="master_speed"&&(d={...d,playbackFps:S});else{const A=[...d.clipContents];if(A[g]){A[g]=[...A[g]];const N=A[g][v];if(N)if(y==="effect"&&N.effects&&N.effects[E]){const D=[...N.effects],L={...D[E]};L.params={...L.params,[x]:S},D[E]=L,A[g][v]={...N,effects:D}}else y==="generator"&&(A[g][v]={...N,currentParams:{...N.currentParams,[x]:S}});d.clipContents=A}}}return d}case"TOGGLE_QUICK_BUTTON":{const{index:r}=t.payload,l=!a.quickAssigns.buttons[r].value,u={...a.quickAssigns,buttons:[...a.quickAssigns.buttons]};u.buttons[r]={...u.buttons[r],value:l};let f={...a,quickAssigns:u};const h=u.buttons[r];if(h.link){const{layerIndex:d,colIndex:g,effectIndex:v,paramName:E,targetType:y}=h.link;if(y==="global"&&(E==="blackout"?f.globalBlackout=l:E==="laser_output"&&(f.isWorldOutputActive=l)),y==="layer"){if(E==="blackout"){const x=[...f.layerBlackouts];x[d]=l,f={...f,layerBlackouts:x}}else if(E==="solo"){const x=[...f.layerSolos];l?(x.fill(!1),x[d]=!0):x[d]=!1,f={...f,layerSolos:x}}else if(E==="clear"){if(l){const x=[...f.activeClipIndexes];x[d]=null,f={...f,activeClipIndexes:x},u.buttons[r].value=!1,f.quickAssigns=u}}else if(E==="autopilot"){const x=[...f.layerAutopilots];x[d]=l?"forward":"off",f={...f,layerAutopilots:x}}}else{const x=[...f.clipContents];if(x[d]){x[d]=[...x[d]];const S=x[d][g];if(S)if(y==="effect"&&S.effects&&S.effects[v]){const A=[...S.effects],N={...A[v]};N.params={...N.params,[E]:l},A[v]=N,x[d][g]={...S,effects:A}}else y==="generator"&&(x[d][g]={...S,currentParams:{...S.currentParams,[E]:l}});f.clipContents=x}}}return f}case"UPDATE_CLIP_FILE_PATH":{const{oldPath:r,newPath:i}=t.payload;console.log(`Reducer: Updating clip path from ${r} to ${i}`);const l=a.clipContents.map(u=>u.map(f=>{let h=f;return f&&f.filePath===r&&(h={...h,filePath:i,parsingFailed:!1}),f&&f.audioFile&&f.audioFile.path===r&&(h={...h,audioFile:{...f.audioFile,path:i}}),h}));return{...a,clipContents:l}}case"SET_CLIP_PARSING_FAILED":{const{layerIndex:r,colIndex:i,failed:l}=t.payload,u=[...a.clipContents];if(u[r]){u[r]=[...u[r]];const f=u[r][i];f&&(u[r][i]={...f,parsingFailed:l})}return{...a,clipContents:u}}default:return a}}const $o={orange:{full:60,dim:10},yellow:{full:74,dim:15},cyan:{full:36,dim:35},"light-blue":{full:41,dim:43},blue:{full:45,dim:47},magenta:{full:53,dim:55},red:{full:5,dim:7},green:{full:21,dim:23},white:{full:3,dim:1}},HS=({isPlaying:a,globalBlackout:t,layerBlackouts:r,layerSolos:i,isWorldOutputActive:l,clipContents:u,activeClipIndexes:f,theme:h,bpm:d,quickAssigns:g})=>{const{sendFeedback:v,mappings:E,selectedMidiInputId:y,midiInitialized:x}=su();return T.useEffect(()=>{if(!y||!x||!a){x&&y&&Wo(y,"F#6",0,1);return}let S=!1;const A=6e4/(d||120),N=setInterval(()=>{S=!S,Wo(y,"F#6",S?127:0,1)},A/2);return()=>{clearInterval(N),Wo(y,"F#6",0,1)}},[a,d,y,x]),T.useEffect(()=>{v("transport_play",a),v("transport_stop",!a)},[a,v]),T.useEffect(()=>{v("comp_blackout",t)},[t,v]),T.useEffect(()=>{v("laser_output",l)},[l,v]),T.useEffect(()=>{r.forEach((S,A)=>{v(`layer_${A}_blackout`,S)})},[r,v]),T.useEffect(()=>{i.forEach((S,A)=>{v(`layer_${A}_solo`,S)})},[i,v]),T.useEffect(()=>{if(!u||!f)return;const S=$o[h]||$o.orange;u.forEach((A,N)=>{A.forEach((D,L)=>{const M=`clip_${N}_${L}`;if(E[M]){const C=f[N]===L,B=D!==null&&(D.type==="ilda"||D.type==="generator"),V=D?.triggerStyle||"normal";let te=0,de=null;C?(te=S.full,V==="toggle"&&(de=10)):B&&(te=S.dim),v(M,te,de)}})})},[u,f,h,E,v]),T.useEffect(()=>{if(!g)return;const S=$o[h]||$o.orange;g.buttons.forEach((A,N)=>{v(`quick_btn_${N}`,A.value?S.full:0)})},[g,h,v]),null},mf=async(a,t,r,i)=>{if(!a||!a.points)return null;let l=a;try{t&&t.length>0&&(l=Tl(a,t,{progress:0,time:0,effectStates:{},assignedDacs:[]}))}catch(S){console.warn("Failed to apply effects for thumbnail:",S)}const u=128,f=128,h=document.createElement("canvas");h.width=u,h.height=f;const d=h.getContext("2d");d.fillStyle="#000000",d.fillRect(0,0,u,f);const g=l.points,v=l.isTypedArray||g instanceof Float32Array,E=v?g.length/8:g.length;d.lineWidth=1.5,d.lineCap="round";let y=null,x=null;for(let S=0;S<E;S++){let A,N,D,L,M,C;if(v)A=g[S*8],N=g[S*8+1],D=g[S*8+3],L=g[S*8+4],M=g[S*8+5],C=g[S*8+6]>.5;else{const te=g[S];A=te.x,N=te.y,D=te.r,L=te.g,M=te.b,C=te.blanking}const B=(A+1)*.5*u,V=(1-(N+1)*.5)*f;if(!C&&y!==null){d.beginPath(),d.moveTo(y,x),d.lineTo(B,V);const te=Math.floor(Math.max(0,Math.min(1,D))*255),de=Math.floor(Math.max(0,Math.min(1,L))*255),ye=Math.floor(Math.max(0,Math.min(1,M))*255);d.strokeStyle=`rgb(${te},${de},${ye})`,d.stroke()}y=B,x=V}try{const A=await(await new Promise(N=>h.toBlob(N,"image/png"))).arrayBuffer();if(window.electronAPI&&window.electronAPI.saveThumbnail){const N=`thumb_L${r}_C${i}.png`;return await window.electronAPI.saveThumbnail(A,N)}}catch(S){console.error("Error generating/saving thumbnail:",S)}return null},Q0=_n.memo(({type:a,previewFrameCountRef:t,totalPointsSentRef:r,activeChannelsCountRef:i,lastStatUpdateTimeRef:l})=>{const[u,f]=T.useState({cpu:"0.0",ram:"0",fps:0,pps:0,avgPps:0});return T.useEffect(()=>{const h=window.electronAPI?.onSystemStats(g=>{f(v=>({...v,...g}))});let d;return a==="performance"&&l&&t&&r&&i&&(d=setInterval(()=>{const g=performance.now(),v=(g-(l.current||0))/1e3;if(v>0){const E=Math.round((t.current||0)/v),y=Math.round((r.current||0)/v),x=(i.current||0)>0?Math.round(y/i.current):0;f(S=>({...S,fps:E,pps:y,avgPps:x})),t.current=0,r.current=0,l.current=g}},1e3)),()=>{h&&h(),d&&clearInterval(d)}},[a,t,r,i,l]),a==="system"?m.jsxs("div",{className:"systemStats",children:[m.jsxs("p",{className:"sysStats",children:["CPU: ",u.cpu,"%"]}),m.jsxs("p",{className:"sysStats",children:["RAM: ",u.ram,"MB"]})]}):m.jsxs("div",{className:"performanceStats",children:[m.jsxs("p",{className:"perfStats",children:["FPS: ",u.fps]}),m.jsxs("p",{className:"perfStats",children:["AnimPPS: ",u.avgPps," (Avg)"]})]})}),YS=_n.memo(({playbackFps:a,previewScanRate:t,previewFrameCountRef:r,totalPointsSentRef:i,activeChannelsCountRef:l,lastStatUpdateTimeRef:u})=>m.jsxs("div",{className:"system-monitor-grid",children:[m.jsx(Q0,{type:"performance",previewFrameCountRef:r,totalPointsSentRef:i,activeChannelsCountRef:l,lastStatUpdateTimeRef:u}),m.jsx(Q0,{type:"system",previewFrameCountRef:r,totalPointsSentRef:i,activeChannelsCountRef:l,lastStatUpdateTimeRef:u})]})),qS=_n.memo(({clipContents:a,activeClipIndexes:t,layerEffects:r,bpm:i,playbackFps:l,selectedLayerIndex:u,selectedColIndex:f,liveFramesRef:h,progressRef:d,selectedDac:g,liveDacOutputSettingsRef:v,dacOutputSettings:E,getAudioInfo:y,fftLevels:x,getFftLevels:S,effectStatesRef:A,clipActivationTimesRef:N,showBeamEffect:D,beamAlpha:L,fadeAlpha:M,previewScanRate:C,beamRenderMode:B,worldShowBeamEffect:V,worldBeamRenderMode:te,masterIntensity:de,layerIntensities:ye,globalBlackout:pe,layerSolos:q,layerBlackouts:j,handleToggleBeamEffect:$,handleCycleDisplayMode:W,previewFrameCountRef:J,totalPointsSentRef:U,activeChannelsCountRef:G,lastStatUpdateTimeRef:X,liveClipContentsRef:me})=>{const[_,z]=T.useState(0),ie=T.useRef(0),ve=T.useRef(performance.now()),ne=1e3/70;T.useEffect(()=>{let mt;const we=se=>{se-ie.current>ne&&(J.current++,ve.current=performance.now(),z(Fe=>Fe+1),ie.current=se),mt=requestAnimationFrame(we)};return mt=requestAnimationFrame(we),()=>cancelAnimationFrame(mt)},[ne,J]);const he=me?.current||a,xe=u!==null&&f!==null?he[u][f]:null,Ye=f!==null?xe?.type==="ilda"?xe?.workerId:`generator-${u}-${f}`:u!==null&&t[u]!==null?he[u][t[u]]?.type==="ilda"?he[u][t[u]]?.workerId:`generator-${u}-${t[u]}`:null,Be=Ye?h.current[Ye]:null,st=Ye&&d.current[Ye]||0;let At=[],Ie=1;if(u!==null){const mt=r[u]||[];if(f!==null)At=[...xe?.effects||[],...mt];else{const Fe=t[u];Fe!==null?At=[...he[u][Fe]?.effects||[],...mt]:At=mt}const we=q.some(Fe=>Fe);let se=ye[u];pe?se=0:we?se=q[u]?j[u]?0:se:0:j[u]&&(se=0),Ie=se*de}const Ke=T.useMemo(()=>{const mt={};return t.forEach((we,se)=>{if(we!==null){const Fe=he[se][we];if(Fe){let xt=Fe.type==="ilda"?Fe.workerId:`generator-${se}-${we}`;xt&&h.current[xt]&&(mt[xt]={frame:h.current[xt],effects:[...Fe.effects||[],...r[se]||[]],layerIndex:se,syncSettings:Fe.syncSettings||{},bpm:i,clipDuration:(()=>{const Rt=Fe.playbackSettings||{};return Rt.mode==="timeline"?Rt.duration||1:Rt.mode==="bpm"?(Rt.beats||8)*60/(i||120):(Fe.totalFrames||30)/(Fe.fps||l||30)})(),progress:d.current[xt]||0,effectStates:A.current,clipActivationTime:N.current[se]||0})}}}),mt},[t,he,_,i,r,l,h,d,A,N]),rt=T.useMemo(()=>{const mt=q.some(we=>we);return ye.map((we,se)=>pe?0:mt?q[se]?j[se]?0:we:0:j[se]?0:we)},[ye,j,q,pe]);return m.jsxs("div",{className:"side-panel",children:[m.jsx(Cy,{frame:Be,effects:At,showBeamEffect:D,beamAlpha:L,fadeAlpha:M,previewScanRate:C,beamRenderMode:B,intensity:Ie,syncSettings:xe?.syncSettings,bpm:i,clipDuration:(()=>{const mt=xe?.playbackSettings||{};return mt.mode==="timeline"?mt.duration||1:mt.mode==="bpm"?(mt.beats||8)*60/(i||120):(xe?.totalFrames||30)/(xe?.fps||l||30)})(),progress:st,previewTime:ve.current,fftLevels:S?S():x,effectStates:A.current,clipActivationTime:u!==null&&N.current[u]||0,onToggleBeamEffect:()=>$("clip"),onCycleDisplayMode:()=>W("clip")}),m.jsx(My,{activeFrames:Ke,showBeamEffect:V,beamAlpha:L,fadeAlpha:M,previewScanRate:C,beamRenderMode:te,layerIntensities:rt,masterIntensity:de,dacSettings:g?v.current?v.current[`${g.ip}:${g.channel}`]:E[`${g.ip}:${g.channel}`]:null,previewTime:ve.current,fftLevels:S?S():x,onToggleBeamEffect:()=>$("world"),onCycleDisplayMode:()=>W("world")})]})});function VS(){const a=im(),t=Py(),r=T.useRef(null),{fftLevels:i,getFftLevels:l}=Rl()||{};T.useEffect(()=>{const O=new Worker(new URL(""+new URL("ui-generators.worker-IWR7v-Yo.js",import.meta.url).href,import.meta.url),{type:"module"});r.current=O;const R=F=>{if(!F.data.browserFile){if(F.data.layerIndex!==void 0&&F.data.colIndex!==void 0){const k=`${F.data.layerIndex}-${F.data.colIndex}`;if(ua.current.set(k,!1),Ca.current.has(k)){const{message:H,transferables:ce}=Ca.current.get(k);Ca.current.delete(k),console.log(`[App.jsx] UI Generator ${k} free, processing pending seq ${H.seq}`),ua.current.set(k,!0),O.postMessage(H,ce)}}if(F.data.success){const{layerIndex:k,colIndex:H,frames:ce,generatorDefinition:ae,currentParams:Ee,isLive:Oe,seq:Xe}=F.data;if(k===void 0||H===void 0)return;if(Xe!==void 0){if(Xe<Li.current)return;Li.current=Xe}const ge=`generator-${k}-${H}`;if(D.current[ge]=ce[0],!Oe){se({type:"SET_CLIP_CONTENT",payload:{layerIndex:k,colIndex:H,content:{type:"generator",generatorDefinition:ae,frames:ce,currentParams:Ee,playbackSettings:{mode:"timeline",duration:5,beats:8,speedMultiplier:1}}}});const Me=ln.current[k][H],Te=`Clip ${k+1}-${H+1}`;Me===Te&&se({type:"SET_CLIP_NAME",payload:{layerIndex:k,colIndex:H,name:ae.name}})}}else Ft(`UI Generator error: ${F.data.error}`)}};return O.addEventListener("message",R),()=>{O.removeEventListener("message",R),O.terminate()}},[]);const{devices:u,selectedDeviceId:f,setSelectedDeviceId:h,playAudio:d,stopAudio:g,pauseAllAudio:v,resumeAllAudio:E,setPlaybackRate:y,resetAllAudio:x,stopAllAudio:S,getAudioInfo:A,setClipVolume:N}=dm();T.useRef(new Set),T.useRef(0);const D=T.useRef({}),L=T.useRef(new Map),M=T.useRef({}),C=T.useRef({}),B=T.useRef({}),V=T.useRef({}),[te,de]=T.useState(null),[ye,pe]=T.useState(!1),[q,j]=T.useState(!1),[$,W]=T.useState({midi:!1,artnet:!1,osc:!1,keyboard:!1}),[J,U]=T.useState(!1),[G,X]=T.useState(!1),[me,_]=T.useState(!1),[z,ie]=T.useState(!1),[ve,ne]=T.useState({title:"",initialValue:"",onSave:()=>{}}),[he,xe]=T.useState("files"),[Ye,Be]=T.useState("layer"),[st,At]=T.useState([]),Ie=T.useRef(0),Ke=T.useRef(0),rt=T.useRef(0),mt=T.useRef(performance.now()),[we,se]=T.useReducer(zS,Ym(ye?te:{})),Fe=T.useRef(new Map),xt=T.useCallback((O,R,F=30)=>{Fe.current.has(O)&&clearTimeout(Fe.current.get(O));const k=setTimeout(()=>{se(R),Fe.current.delete(O)},F);Fe.current.set(O,k)},[]),{columns:Rt,layers:Je,clipContents:Ue,clipNames:vn,thumbnailFrameIndexes:Yn,layerEffects:qn,layerAssignedDacs:Es,layerIntensities:Ea,layerAutopilots:an,layerBlackouts:yn,layerSolos:Ht,masterIntensity:Di,globalBlackout:mr,selectedLayerIndex:Ge,selectedColIndex:ft,notification:Kr,dacs:On,selectedDac:An,ildaFrames:_i,selectedIldaWorkerId:gr,selectedIldaTotalFrames:Oi,showBeamEffect:Ia,beamAlpha:wa,fadeAlpha:Vn,playbackFps:kn,previewScanRate:Aa,beamRenderMode:sa,worldShowBeamEffect:ws,worldBeamRenderMode:As,activeClipIndexes:Yt,isPlaying:la,isWorldOutputActive:rn,selectedGeneratorId:sn,selectedGeneratorParams:bn,thumbnailRenderMode:Ba,theme:vr,dacOutputSettings:Tn}=we,Fa=T.useMemo(()=>Je.map((O,R)=>{const F=Yt[R];if(F!==null){const k=Ue[R][F];if(k){let H,ce=null;if(k.type==="ilda"&&k.workerId&&k.totalFrames)return H=k.workerId,ce=k.stillFrame,{type:"ilda",workerId:H,totalFrames:k.totalFrames,effects:k.effects||[],dac:k.dac||null,assignedDacs:k.assignedDacs||[],ildaFormat:k.ildaFormat||0,stillFrame:ce,layerIndex:R,syncSettings:k.syncSettings||{},fps:k.fps||null};if(k.type==="generator"&&k.frames&&k.generatorDefinition)return H=`generator-${R}-${F}`,ce=k.stillFrame||k.frames?.[0]||null,{type:"generator",workerId:H,totalFrames:k.frames.length,effects:k.effects||[],dac:k.dac||null,assignedDacs:k.assignedDacs||[],ildaFormat:0,stillFrame:ce,layerIndex:R,syncSettings:k.syncSettings||{},fps:k.fps||null}}}return null}).filter(Boolean),[Je,Yt,Ue]),Zt=T.useRef(Ue),dt=T.useRef(null),Xn=T.useRef(!1),dn=T.useRef(null),Ta=T.useRef(!1);T.useEffect(()=>{Ue&&(dt.current=structuredClone(Ue))},[]),T.useEffect(()=>{Tn&&(dn.current=structuredClone(Tn))},[]);const ja=T.useRef(Ea),Pa=T.useRef(an),Dt=T.useRef(qn),Jr=T.useRef(Di),Ts=T.useRef(yn),oa=T.useRef(Ht),Ga=T.useRef(mr),Ul=T.useRef(kn),ei=T.useRef(Tn),Cs=T.useRef(On),Ms=T.useRef([]),Zn=T.useRef(Yt),ti=T.useRef(Es),ln=T.useRef(vn),ni=T.useRef(gr),Il=T.useRef(Oi),za=T.useRef({}),Ha=T.useRef(new Map),ai=T.useRef(new Map),ki=T.useRef(null),ri=T.useRef({}),qt=T.useRef(null),Ya=T.useRef(0),Li=T.useRef(0),ua=T.useRef(new Map),Ca=T.useRef(new Map);T.useRef(performance.now()),T.useEffect(()=>{if(Xn.current){Xn.current=!1;return}Ue&&(dt.current=structuredClone(Ue))},[Ue]),T.useEffect(()=>{if(Ta.current){Ta.current=!1;return}Tn&&(dn.current=structuredClone(Tn))},[Tn]),T.useEffect(()=>{ja.current=Ea,Pa.current=an,Dt.current=qn,Jr.current=Di,Ts.current=yn,oa.current=Ht,Ga.current=mr,Ul.current=kn,Cs.current=On,Ms.current=Fa,Zt.current=Ue,Zn.current=Yt,ti.current=Es,ln.current=vn,ni.current=gr,Il.current=Oi},[Ea,Es,an,qn,Di,yn,Ht,mr,Tn,On,Fa,Ue,Yt,vn,gr,Oi]);const Ui=T.useCallback(O=>{const R=1-O*2,F=[],k=100;for(let H=0;H<k;H++){const ce=H/(k-1)*2-1;F.push({x:ce,y:R,r:0,g:255,b:0,blanking:!1})}return{points:F,isTypedArray:!1}},[]),Bl=T.useCallback((O,R)=>{dn.current&&(dn.current[O]=R,Ta.current=!0),se({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:O,settings:R}})},[]),xn=T.useCallback(O=>{se({type:"SET_RENDER_SETTING",payload:{setting:"playbackFps",value:O}})},[]);T.useEffect(()=>{const O=kn/60;y(O)},[kn,y]);const Ft=O=>{se({type:"SET_NOTIFICATION",payload:{message:O,visible:!0}}),setTimeout(()=>{se({type:"SET_NOTIFICATION",payload:{message:"",visible:!1}})},3e3)};T.useEffect(()=>{const O={orange:"#ff5e00",yellow:"#ffd400",cyan:"#00fff3","light-blue":"#0089ff",blue:"#005aff",magenta:"#fb00ff",red:"#ff0000",green:"#00ff00",white:"#ffffff"},R=O[vr]||O.orange;document.documentElement.style.setProperty("--theme-color",R);const F=parseInt(R.slice(1,3),16),k=parseInt(R.slice(3,5),16),H=parseInt(R.slice(5,7),16);document.documentElement.style.setProperty("--theme-color-transparent",`rgba(${F}, ${k}, ${H}, 0.3)`),window.electronAPI&&window.electronAPI.setTheme&&window.electronAPI.setTheme(vr)},[vr]),T.useEffect(()=>{window.electronAPI&&window.electronAPI.setSelectedDac&&window.electronAPI.setSelectedDac(An)},[An]),T.useMemo(()=>{const O=new Set;return gr&&O.add(gr),Fa.forEach(R=>{R&&R.type==="ilda"&&R.workerId&&O.add(R.workerId)}),Array.from(O)},[gr,Fa]),T.useEffect(()=>{if(!a)return;const O=async ge=>{if(!ge.data.browserFile){if(ge.data.type==="get-frame"&&ge.data.success)if(ge.data.isStillFrame){const{workerId:ke,frame:Me,layerIndex:Te,colIndex:qe}=ge.data;if(Te===void 0||qe===void 0)return;let Ce=null;const Ne=(dt.current?dt.current:Zt.current)?.[Te]?.[qe],He=Ne?.effects||[];let Qe=null;const $e=Ne?.assignedDacs||[];if($e.length>0){const gt=$e[0],vt=`${gt.ip}:${gt.channel}`;Qe=ei.current[vt]}else if(An){const gt=`${An.ip}:${An.channel}`;Qe=ei.current[gt]}let tt=Me;Qe&&(tt=yf(Me,Qe)),Ce=await mf(tt,He,Te,qe),se({type:"SET_CLIP_CONTENT",payload:{layerIndex:Te,colIndex:qe,content:{stillFrame:Me,parsing:!1,thumbnailPath:Ce,thumbnailVersion:Date.now()}}})}else D.current[ge.data.workerId]=ge.data.frame;else if(ge.data.type==="parse-ilda"&&ge.data.success){const{workerId:ke,totalFrames:Me,ildaFormat:Te,fileName:qe,filePath:Ce,layerIndex:je,colIndex:Ne}=ge.data;if(je===void 0||Ne===void 0)return;const He={type:"ilda",workerId:ke,totalFrames:Me,ildaFormat:Te,fileName:qe,filePath:Ce,parsing:!0,playbackSettings:{mode:"fps",duration:Me/60,beats:8,speedMultiplier:1}};se({type:"SET_CLIP_CONTENT",payload:{layerIndex:je,colIndex:Ne,content:He}});const Qe=ln.current[je][Ne],$e=`Clip ${je+1}-${Ne+1}`;Qe===$e&&se({type:"SET_CLIP_NAME",payload:{layerIndex:je,colIndex:Ne,name:qe}})}else if(ge.data.type==="get-all-frames"&&ge.data.success){console.log("Received get-all-frames response:",ge.data);const{frames:ke,workerId:Me,layerIndex:Te,colIndex:qe}=ge.data;if(Te===void 0||qe===void 0)return;l0(async()=>{const{framesToIlda:Ce}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Ce}},[],import.meta.url).then(({framesToIlda:Ce})=>{const je=Ce(ke),He=Zt.current[Te][qe].fileName||"export.ild";window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(je,He).then(Qe=>{Qe.success?Ft(`Exported to ${Qe.filePath}`):Qe.error&&Ft(`Export failed: ${Qe.error}`)})}).catch(Ce=>console.error("Failed to load ilda-writer in response:",Ce))}else if(ge.data.success===!1){Ft(`Worker error: ${ge.data.error}`);const{layerIndex:ke,colIndex:Me}=ge.data;ke!==void 0&&Me!==void 0&&se({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:ke,colIndex:Me,status:!1}})}}};a.addEventListener("message",O);let R,F,k=0;const H=60,ce=1e3/H,ae=ge=>{if(ge.length===0)return null;if(ge.length===1)return ge[0];let ke=0;ge.forEach((qe,Ce)=>{const Ne=qe.points instanceof Float32Array||qe.isTypedArray?qe.points.length/8:qe.points.length;ke+=Ne,Ce<ge.length-1&&(ke+=2)});const Me=new Float32Array(ke*8);let Te=0;return ge.forEach((qe,Ce)=>{const je=qe.points instanceof Float32Array||qe.isTypedArray,Ne=je?qe.points.length/8:qe.points.length;for(let He=0;He<Ne;He++){const Qe=(Te+He)*8;if(je){const $e=He*8;Me.set(qe.points.subarray($e,$e+8),Qe)}else{const $e=qe.points[He];Me[Qe]=$e.x,Me[Qe+1]=$e.y,Me[Qe+2]=$e.z||0,Me[Qe+3]=$e.r,Me[Qe+4]=$e.g,Me[Qe+5]=$e.b,Me[Qe+6]=$e.blanking?1:0,Me[Qe+7]=$e.lastPoint?1:0}Me[Qe+7]=0}if(Te+=Ne,Ce<ge.length-1){const He=ge[Ce+1],Qe=He.points instanceof Float32Array||He.isTypedArray,$e=Me[(Te-1)*8],tt=Me[(Te-1)*8+1];let gt,vt;Qe?(gt=He.points[0],vt=He.points[1]):(gt=He.points[0].x,vt=He.points[0].y);let Lt=Te*8;Me[Lt]=$e,Me[Lt+1]=tt,Me[Lt+6]=1,Me[Lt+3]=0,Me[Lt+4]=0,Me[Lt+5]=0;let on=(Te+1)*8;Me[on]=gt,Me[on+1]=vt,Me[on+6]=1,Me[on+3]=0,Me[on+4]=0,Me[on+5]=0,Te+=2}}),Me[(ke-1)*8+7]=1,{points:Me,isTypedArray:!0}},Ee=ge=>{if(!rn){cancelAnimationFrame(F);return}if(ge-k>ce){if(window.electronAPI&&rn){const ke=new Map;Ms.current.forEach(Te=>{if(Te&&D.current[Te.workerId]){const qe=ti.current[Te.layerIndex]||[],Ce=Te.assignedDacs||[];let je=[...qe,...Ce];je.length===0&&An&&(je=[An]);const Ne=[],He=new Set;if(je.forEach(lt=>{const da=lt.channel!==void 0?lt.channel:lt.channels&&lt.channels.length>0?lt.channels[0].serviceID:0,Ln=`${lt.ip}:${da}`;He.has(Ln)||(He.add(Ln),Ne.push({...lt,channel:da}))}),Ne.length===0)return;const $e=(dt.current||Zt.current)[Te.layerIndex][Zn.current[Te.layerIndex]],tt=$e?$e.effects||[]:Te.effects||[],gt=Te.layerIndex,vt=Dt.current[gt]||[],Lt=[...tt,...vt],on=D.current[Te.workerId],jt=ja.current[Te.layerIndex],Cn=Ga.current,hn=Ts.current[Te.layerIndex],Qa=oa.current[Te.layerIndex],fa=oa.current.some(lt=>lt);let Kt=jt;Cn?Kt=0:fa?Qa?hn&&(Kt=0):Kt=0:hn&&(Kt=0);const Pt=Kt*Jr.current;if(Pt<=0)return;const $a=M.current[Te.workerId]||0;Te.syncSettings;const Pi={...on,points:Oe(on.points)?on.points:on.points.map(lt=>({...lt,r:Math.round(lt.r*Pt),g:Math.round(lt.g*Pt),b:Math.round(lt.b*Pt)}))};if(Oe(Pi.points)){const lt=Pi.points,da=lt.length/8,Ln=new Float32Array(lt);for(let $n=0;$n<da;$n++)Ln[$n*8+3]*=Pt,Ln[$n*8+4]*=Pt,Ln[$n*8+5]*=Pt;Pi.points=Ln}const Er=$e?$e.playbackSettings:Te.playbackSettings||{};let Wa=1;if(Er.mode==="timeline")Wa=Er.duration||1;else if(Er.mode==="bpm"){const lt=we.bpm||120;Wa=(Er.beats||8)*60/lt}else{const lt=Er.fps||Te.fps||kn||30;Wa=(Te.totalFrames||30)/lt}const wr=Er.speedMultiplier||1;wr!==0&&(Wa/=wr);const Ka=Tl(Pi,Lt,{progress:$a,time:ge,effectStates:L.current,assignedDacs:Ne,syncSettings:Te.syncSettings||{},bpm:we.bpm,clipDuration:Wa,fftLevels:l?l():i});Ne.forEach((lt,da)=>{const Ln=lt.ip,$n=lt.channel||(lt.channels&&lt.channels.length>0?lt.channels[0].serviceID:0);if($n!==void 0){const Gi=`${Ln}:${$n}`;ke.has(Gi)||ke.set(Gi,{ip:Ln,channel:$n,type:lt.type,frames:[]});let Mn=Ka;if(Ka.points&&Ka.points._channelDistributions){const pa=Ka.points._channelDistributions.get(da);if(pa){const ci=Ka.points.subarray(pa.start,pa.start+pa.length);Mn={...Ka,points:ci}}else Mn={...Ka,points:new Float32Array(0)}}if(lt.mirrorX||lt.mirrorY){const pa=Mn.points,ci=Mn.isTypedArray,uu=ci?pa.length/8:pa.length,Wn=ci?new Float32Array(pa):pa.map(Sn=>({...Sn}));for(let Sn=0;Sn<uu;Sn++)ci?(lt.mirrorX&&(Wn[Sn*8]=-Wn[Sn*8]),lt.mirrorY&&(Wn[Sn*8+1]=-Wn[Sn*8+1])):(lt.mirrorX&&(Wn[Sn].x=-Wn[Sn].x),lt.mirrorY&&(Wn[Sn].y=-Wn[Sn].y));Mn={...Mn,points:Wn}}ke.get(Gi).frames.push(Mn)}})}}),Cs.current.forEach(Te=>{(Te.channels&&Te.channels.length>0?Te.channels.map(Ce=>Ce.serviceID):[0]).forEach(Ce=>{const je=`${Te.ip}:${Ce}`,Ne=dn.current?dn.current[je]:ei.current[je];if(Ne){ke.has(je)||ke.set(je,{ip:Te.ip,channel:Ce,type:Te.type,frames:[]});const He=ke.get(je);if(Ne.testLineEnabled){const Qe=Ui(Ne.testLineY!==void 0?Ne.testLineY:.5);He.frames=[Qe]}}})});let Me=0;ke.forEach(Te=>{let qe=ae(Te.frames);const Ce=`${Te.ip}:${Te.channel}`,je=dn.current?dn.current[Ce]:ei.current[Ce];if(qe&&je){if(je.dimmer!==void 0&&je.dimmer<1){const Ne=je.dimmer,He=qe.points,Qe=qe.isTypedArray,$e=Qe?He.length/8:He.length;for(let tt=0;tt<$e;tt++)Qe?(He[tt*8+3]*=Ne,He[tt*8+4]*=Ne,He[tt*8+5]*=Ne):(He[tt].r*=Ne,He[tt].g*=Ne,He[tt].b*=Ne)}qe=yf(qe,je,!0)}if(qe){Me++;const Ne=Oe(qe.points)?qe.points.length/8:qe.points.length;Ke.current+=Ne,window.electronAPI.sendFrame(Te.ip,Te.channel,qe.points,H,Te.type)}}),rt.current=Me}k=ge}F=requestAnimationFrame(Ee)};function Oe(ge){return!!ge&&(ge instanceof Float32Array||ge.buffer instanceof ArrayBuffer)}const Xe=ge=>{const ke=1e3/kn,Me=we.bpm||120,Te=(Ce,je,Ne)=>{B.current[Ne]||(B.current[Ne]=ge);let He=ge-B.current[Ne];He>1e3&&(He=ke),la&&(ri.current[Ne]===void 0&&(ri.current[Ne]=0),ri.current[Ne]+=He);const Qe=ri.current[Ne]||0,$e=Zn.current[je]!==null?A(je):null;let tt=V.current[Ne]||0,gt=0;const vt=Ce.totalFrames||1,Lt=Ce.playbackSettings||{mode:"fps",duration:vt/60,beats:8,speedMultiplier:1};if($e&&la&&!$e.paused)gt=$e.duration>0?$e.currentTime/$e.duration:0,tt=Math.floor(gt*vt);else if(Lt.mode==="timeline"){const Cn=Lt.duration*1e3/(Lt.speedMultiplier||1);Cn>0&&(gt=Qe/Cn%1,tt=Math.floor(gt*vt))}else if(Lt.mode==="bpm"){const Cn=6e4/Me,hn=Lt.beats*Cn/(Lt.speedMultiplier||1);hn>0&&(gt=Qe/hn%1,tt=Math.floor(gt*vt))}else{const hn=1e3/((Lt.fps||60)*(Lt.speedMultiplier||1));if(He>=hn){const Qa=Math.floor(He/hn);la?(B.current[Ne]=ge-He%hn,tt=tt+Qa):B.current[Ne]=ge,gt=vt>0?tt%vt/vt:0}else return}Lt.mode!=="fps"&&(B.current[Ne]=ge),isNaN(tt)&&(tt=0),isNaN(gt)&&(gt=0);const jt=(za.current[Ne]||0)>.9&&gt<.1;if(za.current[Ne]=gt,M.current[Ne]=gt,vt>0&&(tt=tt%vt,tt<0&&(tt+=vt)),jt&&la){const Cn=Pa.current[je];if(Cn&&Cn!=="off"){const hn=Zt.current[je],Qa=Zn.current[je];let fa=-1;if(Cn==="forward")for(let Kt=1;Kt<hn.length;Kt++){const Pt=(Qa+Kt)%hn.length,$a=hn[Pt];if($a&&($a.type==="ilda"||$a.type==="generator")){fa=Pt;break}}else if(Cn==="random"){const Kt=hn.map((Pt,$a)=>Pt&&(Pt.type==="ilda"||Pt.type==="generator")?$a:-1).filter(Pt=>Pt!==-1);if(Kt.length>0){const Pt=Math.floor(Math.random()*Kt.length);fa=Kt[Pt],fa===Qa&&Kt.length>1&&(fa=Kt[(Pt+1)%Kt.length])}}fa!==-1&&fa!==Qa&&setTimeout(()=>{Va(je,fa)},0)}}(V.current[Ne]!==tt||!D.current[Ne])&&(V.current[Ne]=tt,Ce.type==="ilda"?a.postMessage({type:"get-frame",workerId:Ne,frameIndex:tt}):Ce.type==="generator"&&(Ce.frames&&Ce.frames.length>1?Ce.frames[tt%Ce.frames.length]&&(D.current[Ne]=Ce.frames[tt%Ce.frames.length]):!D.current[Ne]&&Ce.frames&&Ce.frames.length>0&&(D.current[Ne]=Ce.frames[0])))};Je.forEach((Ce,je)=>{const Ne=Zn.current[je];if(Ne===null)return;const Qe=(dt.current||Zt.current)[je][Ne];if(!Qe)return;let $e=Qe.type==="ilda"?Qe.workerId:Qe.type==="generator"?`generator-${je}-${Ne}`:null;$e&&Te(Qe,je,$e)});const qe=ni.current;if(qe&&!Ms.current.some(Ce=>Ce.workerId===qe)){const Ce=Ge,je=ft;if(Ce!==null&&je!==null){const He=(dt.current||Zt.current)[Ce][je];He&&Te(He,Ce,qe)}}if(qt.current){const{layerIndex:Ce,colIndex:je}=qt.current,Ne=Zn.current[Ce]===je,He=ni.current;if(!Ne){const $e=(dt.current||Zt.current)[Ce]?.[je];if($e){let tt=$e.type==="ilda"?$e.workerId:$e.type==="generator"?`generator-${Ce}-${je}`:null;tt&&tt!==He&&Te($e,Ce,tt)}}}R=requestAnimationFrame(Xe)};return R=requestAnimationFrame(Xe),rn?F=requestAnimationFrame(Ee):cancelAnimationFrame(F),()=>{a.removeEventListener("message",O),cancelAnimationFrame(R),cancelAnimationFrame(F)}},[a,kn,la,rn,An,A,we.bpm,Ge,ft]),T.useEffect(()=>{let O,R,F;return window.electronAPI&&(O=window.electronAPI.onClipContextMenuCommand((k,H,ce)=>{if(console.log(`Clip context menu command received: ${k} for ${H}-${ce}`),k==="export-ilda"){const ae=Zt.current[H][ce];console.log("Exporting clip:",ae),ae&&(ae.type==="ilda"&&ae.workerId&&a?(Ft("Preparing ILDA export..."),console.log("Requesting frames from worker:",ae.workerId),a.postMessage({type:"get-all-frames",workerId:ae.workerId,layerIndex:H,colIndex:ce})):ae.type==="generator"&&ae.frames?(console.log("Exporting generator frames with effects..."),l0(async()=>{const{framesToIlda:Ee}=await import("./ilda-writer-CBfXo8Rb.js");return{framesToIlda:Ee}},[],import.meta.url).then(({framesToIlda:Ee})=>{const Oe=kn||60;let Xe=2;if(ae.playbackSettings)if(ae.playbackSettings.mode==="timeline"&&ae.playbackSettings.duration)Xe=ae.playbackSettings.duration;else if(ae.playbackSettings.mode==="bpm"&&ae.playbackSettings.beats){const Ce=we.bpm||120;Xe=ae.playbackSettings.beats/Ce*60}else ae.playbackSettings.mode==="fps"&&ae.frames.length>1&&(Xe=ae.frames.length/Oe);const ge=Math.ceil(Xe*Oe),ke=[],Me=new Map;for(let Ce=0;Ce<ge;Ce++){const je=Ce*(1e3/Oe),Ne=Ce/ge,He=Math.floor(Ne*ae.frames.length)%ae.frames.length,Qe=ae.frames[He];if(Qe){const $e={...Qe},tt=(ae.effects||[]).filter(jt=>!((jt.id==="delay"||jt.id==="chase")&&jt.params?.mode==="channel")),gt=Tl($e,tt,{time:je,progress:Ne,effectStates:Me,syncSettings:ae.syncSettings||{},bpm:we.bpm,clipDuration:Xe,assignedDacs:ae.assignedDacs||[]}),vt=gt.points,Lt=vt.length/8,on=[];for(let jt=0;jt<Lt;jt++)on.push({x:vt[jt*8],y:vt[jt*8+1],z:vt[jt*8+2],r:vt[jt*8+3],g:vt[jt*8+4],b:vt[jt*8+5],blanking:vt[jt*8+6]>.5,lastPoint:vt[jt*8+7]>.5});ke.push({...gt,points:on,frameName:`Frame ${Ce}`,companyName:"TrueLazer"})}}const Te=Ee(ke),qe=`${ae.generatorDefinition?.name||"generator"}_export.ild`;window.electronAPI&&window.electronAPI.saveIldaFile&&window.electronAPI.saveIldaFile(Te,qe).then(Ce=>{Ce.success?Ft(`Exported to ${Ce.filePath}`):Ce.error&&Ft(`Export failed: ${Ce.error}`)})}).catch(Ee=>console.error("Failed to export generator:",Ee))):(console.warn("Clip type not supported for export or missing data:",ae.type,ae),ae.type==="ilda"&&!ae.workerId?Ft("Clip data not loaded. Please play the clip to load it."):ae.type==="generator"&&!ae.frames&&Ft("Generator not rendered yet.")))}else if(k==="update-thumbnail"){const ae=Ue[H][ce];if(ae){if(ae.type==="ilda"&&ae.workerId&&a){const Ee=V.current[ae.workerId]||0;a.postMessage({type:"get-frame",workerId:ae.workerId,frameIndex:Ee,isStillFrame:!0,layerIndex:H,colIndex:ce})}else if(ae.type==="generator"&&ae.generatorDefinition){const Ee=V.current[`generator-${H}-${ce}`]||0,Oe=ae.frames?.[Ee%ae.frames.length];if(Oe){const Xe=ae.effects||[];mf(Oe,Xe,H,ce).then(ge=>{se({type:"SET_CLIP_CONTENT",payload:{layerIndex:H,colIndex:ce,content:{stillFrame:Oe,thumbnailPath:ge,thumbnailVersion:Date.now()}}})})}}}}else if(k==="clear-clip")se({type:"CLEAR_CLIP",payload:{layerIndex:H,colIndex:ce}});else if(k==="rename-clip"){const ae=ln.current[H][ce];ne({title:"Rename Clip",initialValue:ae,onSave:Ee=>se({type:"SET_CLIP_NAME",payload:{layerIndex:H,colIndex:ce,name:Ee}})}),U(!0)}else if(k==="copy-clip"){const ae={content:Zt.current[H][ce],name:ln.current[H][ce]};se({type:"SET_CLIPBOARD",payload:ae}),Ft("Clip copied.")}else if(k==="cut-clip"){const ae={content:Zt.current[H][ce],name:ln.current[H][ce]};se({type:"SET_CLIPBOARD",payload:ae}),se({type:"CLEAR_CLIP",payload:{layerIndex:H,colIndex:ce}}),Ft("Clip cut.")}else if(k==="paste-clip")if(we.clipClipboard){const{content:ae,name:Ee}=we.clipClipboard;let Oe={...ae};Oe.type==="ilda"&&(Oe.workerId=null),se({type:"SET_CLIP_CONTENT",payload:{layerIndex:H,colIndex:ce,content:Oe}}),se({type:"SET_CLIP_NAME",payload:{layerIndex:H,colIndex:ce,name:Ee}}),Ft("Clip pasted."),setTimeout(()=>{const Xe=Oe;if(Xe.type==="generator"&&Xe.generatorDefinition){const ge=`${H}-${ce}`,ke={...Xe.generatorDefinition.defaultParams,...Xe.currentParams};Ha.current.set(ge,JSON.stringify(ke));const Me=++Ya.current;Qn(H,ce,Xe.generatorDefinition,Xe.currentParams,Me)}},100)}else Ft("Clipboard is empty.");else k==="set-trigger-style-normal"?se({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:H,colIndex:ce,style:"normal"}}):k==="set-trigger-style-toggle"?se({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:H,colIndex:ce,style:"toggle"}}):k==="set-trigger-style-flash"&&se({type:"SET_CLIP_TRIGGER_STYLE",payload:{layerIndex:H,colIndex:ce,style:"flash"}})}),R=window.electronAPI.onLayerFullContextMenuCommand((k,H)=>{if(console.log(`Layer context menu command received: ${k} for ${H}`),k==="layer-rename"){const ce=Je[H];ne({title:"Rename Layer",initialValue:ce,onSave:ae=>se({type:"SET_LAYER_NAME",payload:{index:H,name:ae}})}),U(!0)}else k==="layer-clear-clips"&&se({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:H}})}),F=window.electronAPI.onContextMenuActionFromMain(k=>{if(console.log("General context menu action received:",k),k.type==="rename-column"){const H=Rt[k.index];ne({title:"Rename Column",initialValue:H,onSave:ce=>se({type:"SET_COLUMN_NAME",payload:{index:k.index,name:ce}})}),U(!0)}else if(k.type==="rename-layer"){const H=Je[k.index];ne({title:"Rename Layer",initialValue:H,onSave:ce=>se({type:"SET_LAYER_NAME",payload:{index:k.index,name:ce}})}),U(!0)}})),()=>{O&&O(),R&&R(),F&&F()}},[Ue,vn,Je,Rt,a,t,we.clipClipboard]);const Ns=T.useRef(Yn);T.useEffect(()=>{for(let O=0;O<Je.length;O++)for(let R=0;R<Rt.length;R++){const F=Yn[O][R],k=Ns.current[O][R],H=Ue[O][R],ce=H?.workerId,ae=ai.current.get(`${O}-${R}`),Ee=F!==k;(Ee||ce&&!ae)&&H&&H.type==="ilda"&&ce&&(console.log(`[App.jsx] Fetching still frame for ${O}-${R} at index ${F}. Reason: ${Ee?"index change":"worker ready"}`),a.postMessage({type:"get-frame",workerId:ce,frameIndex:F,isStillFrame:!0,layerIndex:O,colIndex:R})),ce?ai.current.set(`${O}-${R}`,ce):ai.current.delete(`${O}-${R}`)}Ns.current=Yn},[Yn,Ue,Je.length,Rt.length,a]),T.useEffect(()=>{t&&Ue.forEach((O,R)=>{O.forEach((F,k)=>{if(F&&F.type==="generator"&&F.generatorDefinition){if(F.generatorDefinition.id==="ndi-source")return;const H=`${R}-${k}`,ce={...F.generatorDefinition.defaultParams,...F.currentParams||{}},ae=JSON.stringify(ce);if(Ha.current.get(H)!==ae){console.log(`[App.jsx] Generator ${H} params changed, regenerating...`);const Ee=++Ya.current;Qn(R,k,F.generatorDefinition,F.currentParams,Ee),Ha.current.set(H,ae)}}})})},[Ue,t]),T.useEffect(()=>{if(!we.projectLoadTimestamp||!a||!t)return;console.log("Project loaded, regenerating content...");const O=[];Ue.forEach((R,F)=>{R.forEach((k,H)=>{if(k){if(k.type==="ilda"&&k.filePath&&!k.workerId)console.log(`Reparsing ILDA file for clip ${F}-${H}: ${k.filePath}`),a.postMessage({type:"load-and-parse-ilda",fileName:k.fileName,filePath:k.filePath,layerIndex:F,colIndex:H});else if(k.type==="generator"&&k.generatorDefinition){console.log(`Regenerating generator clip ${F}-${H} on project load`);const ce=++Ya.current;Qn(F,H,k.generatorDefinition,k.currentParams,ce)}k.audioFile&&k.audioFile.path&&window.electronAPI&&window.electronAPI.checkFileExists&&O.push(window.electronAPI.checkFileExists(k.audioFile.path).then(ce=>{ce||At(ae=>{const Ee=`audio-${F}-${H}`;return ae.some(Oe=>Oe.requestId===Ee)?ae:[...ae,{filePath:k.audioFile.path,fileName:k.audioFile.name||k.audioFile.path.split(/[/\\]/).pop(),requestId:Ee,type:"audio"}]})}))}})})},[we.projectLoadTimestamp,a,t]),T.useEffect(()=>{if(window.electronAPI&&window.electronAPI.onUpdateThumbnailRenderMode){const O=window.electronAPI.onUpdateThumbnailRenderMode(R=>{console.log("App.jsx: Received thumbnail mode update:",R),se({type:"SET_THUMBNAIL_RENDER_MODE",payload:R})});return()=>O()}},[]);const Ma=T.useRef(we);T.useEffect(()=>{Ma.current=we},[we]),T.useEffect(()=>{let O,R,F,k,H;return window.electronAPI&&(O=window.electronAPI.on("new-project",()=>se({type:"RESET_STATE"})),R=window.electronAPI.on("open-project",()=>{}),F=window.electronAPI.on("save-project",()=>{console.log("Saving project with state:",Ma.current),window.electronAPI.send("save-project",Ma.current)}),k=window.electronAPI.on("save-project-as",()=>{console.log("Saving project AS with state:",Ma.current),window.electronAPI.send("save-project-as",Ma.current)}),H=window.electronAPI.on("load-project-data",ce=>{se({type:"LOAD_PROJECT",payload:ce})})),()=>{O&&O(),R&&R(),F&&F(),k&&k(),H&&H()}},[]),T.useEffect(()=>{let O,R;return(async()=>{if(window.electronAPI&&window.electronAPI.getAllSettings){const k=await window.electronAPI.getAllSettings();k&&(k.shortcutsState&&W(k.shortcutsState),se({type:"LOAD_SETTINGS",payload:k}))}})(),window.electronAPI&&(O=window.electronAPI.onMenuAction(k=>{if(console.log("Menu action received:",k),k==="output-settings")X(!0);else if(k==="settings-audio-output")_(!0);else if(k==="settings-audio-fft")ie(!0);else if(k.startsWith("set-theme-")){const H=k.split("set-theme-")[1];se({type:"SET_THEME",payload:H})}else if(k==="shortcuts-window"||k.startsWith("open-")&&k.endsWith("-settings"))j(!0);else if(k.startsWith("toggle-")){const H=k.split("-");if(H.length===3){const ce=H[1],ae=H[2]==="true";W(Ee=>({...Ee,[ce]:ae}))}}}),R=window.electronAPI.onRenderSettingsCommand(k=>{console.log("Render settings command received:",k),se({type:"SET_RENDER_SETTING",payload:{setting:k.setting,value:k.value}})})),()=>{O&&O(),R&&R()}},[]),T.useEffect(()=>{if(!a)return;const O=async R=>{if(R.data.type==="request-file-content"){const{filePath:F,requestId:k}=R.data;try{if(window.electronAPI&&window.electronAPI.checkFileExists&&!await window.electronAPI.checkFileExists(F))throw new Error(`File not found: ${F}`);const H=await window.electronAPI.readFileForWorker(F);a.postMessage({type:"file-content-response",requestId:k,arrayBuffer:H},[H])}catch(H){console.warn(`File missing or read error: ${F}`,H.message);const ce=F.split(/[/\\]/).pop();At(ae=>ae.some(Ee=>Ee.requestId===k)?ae:[...ae,{filePath:F,fileName:ce,requestId:k}])}}else if(R.data.type==="parsing-status"){const{layerIndex:F,colIndex:k,status:H}=R.data;F!==void 0&&k!==void 0&&(se({type:"SET_CLIP_PARSING_STATUS",payload:{layerIndex:F,colIndex:k,status:H}}),H||se({type:"SET_CLIP_PARSING_FAILED",payload:{layerIndex:F,colIndex:k,failed:!0}}))}};return a.addEventListener("message",O),()=>{a.removeEventListener("message",O)}},[a]),T.useEffect(()=>{if(!a)return;const O=[];Ue.forEach((R,F)=>{R.forEach((k,H)=>{k&&k.type==="ilda"&&k.filePath&&!k.workerId&&!k.parsing&&!k.parsingFailed&&O.push({layerIndex:F,colIndex:H,fileName:k.fileName,filePath:k.filePath})})}),O.length>0&&(console.log(`Triggering re-parse for ${O.length} clips.`),se({type:"SET_BULK_PARSING_STATUS",payload:O.map(R=>({layerIndex:R.layerIndex,colIndex:R.colIndex,status:!0}))}),O.forEach(R=>{a.postMessage({type:"load-and-parse-ilda",fileName:R.fileName,filePath:R.filePath,layerIndex:R.layerIndex,colIndex:R.colIndex})}))},[Ue,a]);const qa=dt.current||Ue;if(Ge!==null){const O=qn[Ge]||[];if(ft!==null)[...qa[Ge][ft]?.effects||[],...O];else{const R=Yt[Ge];R!==null&&[...qa[Ge][R]?.effects||[],...O]}}const Fl=T.useCallback((O,R,F,k,H)=>{if(dt.current&&dt.current[O]&&dt.current[O][R]){const ce=dt.current[O][R];ce&&ce.effects&&ce.effects[F]&&(ce.effects[F].params[k]=H,Xn.current=!0)}xt(`effect-${O}-${R}-${F}-${k}`,{type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:O,colIndex:R,effectIndex:F,paramName:k,newValue:H}})},[xt]);T.useEffect(()=>{if(!t)return;const O=R=>{if(!R.data.browserFile){if(R.data.layerIndex!==void 0&&R.data.colIndex!==void 0){const F=`${R.data.layerIndex}-${R.data.colIndex}`;if(ua.current.set(F,!1),Ca.current.has(F)){const{message:k,transferables:H}=Ca.current.get(F);Ca.current.delete(F),console.log(`[App.jsx] Generator ${F} free, processing pending seq ${k.seq}`),ua.current.set(F,!0),t.postMessage(k,H)}}if(R.data.success){const{layerIndex:F,colIndex:k,frames:H,generatorDefinition:ce,currentParams:ae,isLive:Ee,seq:Oe}=R.data;if(F===void 0||k===void 0)return;if(Oe!==void 0){if(Oe<Li.current)return;Li.current=Oe}const Xe=`generator-${F}-${k}`;if(D.current[Xe]=H[0],!Ee&&Oe===Ya.current){const ge={type:"generator",generatorDefinition:ce,frames:H,stillFrame:H[0],currentParams:ae,playbackSettings:{mode:"fps",duration:H.length/60,beats:8,speedMultiplier:1}};se({type:"SET_CLIP_CONTENT",payload:{layerIndex:F,colIndex:k,content:ge}});const ke=ln.current[F][k],Me=`Clip ${F+1}-${k+1}`;ke===Me&&se({type:"SET_CLIP_NAME",payload:{layerIndex:F,colIndex:k,name:ce.name}})}else window.electronAPI&&window.electronAPI.ndiSignalReady&&window.electronAPI.ndiSignalReady()}else Ft(`Error generating frames: ${R.data.error}`)}};return t.addEventListener("message",O),()=>{t.removeEventListener("message",O)}},[t,we.clipContents]);const jl=T.useCallback((O,R,F)=>{if(t){const k=`${O}-${R}`,H={...F.defaultParams};Ha.current.set(k,JSON.stringify(H));const ce=++Ya.current;Qn(O,R,F,F.defaultParams,ce)}},[t]),Qn=async(O,R,F,k,H)=>{const ce={...F.defaultParams,...k},ae=`${O}-${R}`;let Ee=null;if(["text","ndi-source","spout-receiver"].includes(F.id)){const ge="src/fonts/Geometr415 Blk BT Black.ttf";let ke=ce.fontUrl||ge;["https://raw.githubusercontent.com/google/fonts/main/ofl/roboto/Roboto-Regular.ttf","https://raw.githubusercontent.com/googlefonts/roboto-2/main/src/hinted/Roboto-Regular.ttf"].includes(ke)&&(ke=ge);try{if(ke.startsWith("http"))if(window.electronAPI&&window.electronAPI.fetchUrlAsArrayBuffer)Ee=await window.electronAPI.fetchUrlAsArrayBuffer(ke);else throw new Error("URL fetching API is not available.");else if(window.electronAPI&&window.electronAPI.readFileForWorker)Ee=await window.electronAPI.readFileForWorker(ke);else throw new Error("File reading API is not available.")}catch(Te){console.error(`Failed to load font for text generator at ${O}-${R}:`,Te),Ft(`Font error: ${Te.message}`);return}}const Oe={type:"generate",layerIndex:O,colIndex:R,generator:F,params:ce,fontBuffer:Ee,seq:H},Xe=Ee?[Ee]:[];ua.current.get(ae)?(console.log(`[App.jsx] Generator ${ae} busy, queuing seq ${H}`),Ca.current.set(ae,{message:Oe,transferables:Xe})):(ua.current.set(ae,!0),r.current&&r.current.postMessage(Oe,Xe))},Na=T.useCallback(O=>{g(O),se({type:"DEACTIVATE_LAYER_CLIPS",payload:{layerIndex:O}})},[g]),ii=T.useCallback(()=>{S(),se({type:"CLEAR_ALL_ACTIVE_CLIPS"})},[S]),si=T.useCallback(()=>{E(),Je.forEach((O,R)=>{const F=Yt[R];if(F!==null){const k=Ue[R][F];k&&k.audioFile&&!A(R)&&d(R,k.audioFile.path,k.audioVolume??1,!0)}}),se({type:"SET_IS_PLAYING",payload:!0}),se({type:"SET_IS_STOPPED",payload:!1})},[E,Je,Yt,Ue,A,d]),yr=T.useCallback(()=>{v(),se({type:"SET_IS_PLAYING",payload:!1}),se({type:"SET_IS_STOPPED",payload:!1})},[v]),Ii=T.useCallback(()=>{x(),v(),se({type:"SET_IS_PLAYING",payload:!1}),se({type:"SET_IS_STOPPED",payload:!0}),V.current={}},[x,v]),li=T.useCallback((O,R)=>{se({type:"SET_SELECTED_CLIP",payload:{layerIndex:O,colIndex:R}});const F=Ue[O][R];if(F&&F.type==="ilda")se({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:F.workerId,totalFrames:F.totalFrames,generatorId:null,generatorParams:{}}});else if(F&&F.type==="generator"){const k=`generator-${O}-${R}`;se({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:k,generatorId:F.generatorDefinition.id,generatorParams:F.currentParams,totalFrames:F.frames.length}})}else se({type:"SET_SELECTED_ILDA_DATA",payload:{workerId:null,totalFrames:0,generatorId:null,generatorParams:{}}})},[Ue]),Bi=T.useCallback((O,R,F)=>{F?qt.current={layerIndex:O,colIndex:R}:qt.current&&qt.current.layerIndex===O&&qt.current.colIndex===R&&(qt.current=null)},[]),Va=T.useCallback((O,R,F=!0)=>{const k=Ue[O][R];if(!k){F&&(li(O,R),Na(O));return}const H=k.triggerStyle||"normal",ce=Yt[O];if(H==="normal"){if(!F)return}else if(H==="toggle"){if(!F)return;if(ce===R){Na(O);return}}else if(H==="flash"&&!F){ce===R&&Na(O);return}if(k&&k.type==="generator"&&k.frames&&k.frames.length>0){const ae=`generator-${O}-${R}`;D.current[ae]=k.frames[0],B.current[ae]=performance.now(),V.current[ae]=0}else k&&k.type==="ilda"&&k.workerId&&(B.current[k.workerId]=performance.now(),V.current[k.workerId]=0);if(k&&k.audioFile?d(O,k.audioFile.path,k.audioVolume??1,la).catch(ae=>{console.warn(`Failed to play audio for clip ${O}-${R}:`,ae),At(Ee=>{const Oe=`audio-${O}-${R}`;return Ee.some(Xe=>Xe.requestId===Oe)?Ee:[...Ee,{filePath:k.audioFile.path,fileName:k.audioFile.name||k.audioFile.path.split(/[/\\]/).pop(),requestId:Oe,type:"audio"}]})}):g(O),C.current[O]=performance.now(),se({type:"SET_ACTIVE_CLIP",payload:{layerIndex:O,colIndex:R}}),k){if(k.type==="ilda"&&k.workerId){const ae=V.current[k.workerId]||0;se({type:"UPDATE_THUMBNAIL",payload:{layerIndex:O,colIndex:R,frameIndex:ae}})}else if(k.type==="generator"&&k.frames){const ae=V.current[`generator-${O}-${R}`]||0,Ee=k.frames[ae%k.frames.length];Ee&&se({type:"SET_CLIP_CONTENT",payload:{layerIndex:O,colIndex:R,content:{stillFrame:Ee}}})}}},[Ue,Yt,Na,d,la,g,li]),Rs=T.useCallback((O,R,F)=>{if(dt.current&&dt.current[O]&&dt.current[O][R]){const k=dt.current[O][R];if(k){const H={...F,instanceId:Mf(),params:{...F.defaultParams}};k.effects=[...k.effects||[],H],Xn.current=!0}}se({type:"ADD_CLIP_EFFECT",payload:{layerIndex:O,colIndex:R,effect:F}})},[]),br=T.useCallback((O,R)=>{const F=Al.find(k=>(k.id||k.name)===R);F&&se({type:"ADD_LAYER_EFFECT",payload:{layerIndex:O,effect:F}})},[]),xr=T.useCallback((O,R,F)=>{Xn.current=!0,se({type:"SET_CLIP_DAC",payload:{layerIndex:O,colIndex:R,dac:F}})},[]),Pl=T.useCallback((O,R)=>{se({type:"SET_LAYER_DAC",payload:{layerIndex:O,dac:R}})},[]),Ds=O=>{window.electronAPI&&window.electronAPI.showLayerFullContextMenu&&window.electronAPI.showLayerFullContextMenu(O)},Gl=O=>{window.electronAPI&&window.electronAPI.showColumnContextMenu&&window.electronAPI.showColumnContextMenu(O)},Xa=O=>{Je.forEach((R,F)=>{const k=Ue[F][O];k&&(k.type==="ilda"||k.type==="generator")?Va(F,O):Na(F)})},ca=T.useCallback(O=>{se({type:"SET_SELECTED_DAC",payload:O})},[]),_s=T.useCallback(O=>{se({type:"SET_DACS",payload:O})},[]),oi=(O,R)=>{if(Ge!==null&&ft!==null){let F=null,k={};if(dt.current&&dt.current[Ge]&&dt.current[Ge][ft]){const Ee=dt.current[Ge][ft];Ee&&Ee.currentParams&&(Ee.currentParams[O]=R,Xn.current=!0,F=Ee,k=Ee.currentParams)}if(F||(F=Ue[Ge][ft],F&&F.currentParams&&(k={...F.currentParams,[O]:R})),!F||!F.generatorDefinition)return;xt(`generator-${Ge}-${ft}-${O}`,{type:"UPDATE_GENERATOR_PARAM",payload:{layerIndex:Ge,colIndex:ft,paramName:O,newValue:R}});const H=`${Ge}-${ft}`,ce={...F.generatorDefinition.defaultParams,...k};Ha.current.set(H,JSON.stringify(ce));const ae=++Ya.current;Qn(Ge,ft,F.generatorDefinition,k,ae)}},kt=Ge!==null&&ft!==null?Ue[Ge][ft]:null;T.useEffect(()=>{if(!window.electronAPI||!t)return;(async()=>{let R=null;Je.forEach((k,H)=>{const ce=Yt[H];if(ce!==null){const ae=Ue[H][ce];ae&&ae.type==="generator"&&ae.generatorDefinition?.id==="ndi-source"&&(R=ae)}}),!R&&kt?.type==="generator"&&kt?.generatorDefinition?.id==="ndi-source"&&(R=kt);const F=R?.currentParams?.sourceName;F&&F!=="No Source"?F!==ki.current&&(console.log(`[NDI] Switching to source: ${F}`),await window.electronAPI.ndiCreateReceiver(F),ki.current=F):ki.current&&(console.log("[NDI] Destroying receiver"),await window.electronAPI.ndiDestroyReceiver(),ki.current=null)})()},[Yt,Ue,kt,Je]),T.useEffect(()=>{const O=[...Fa,kt].find(R=>R?.type==="generator"&&R?.generatorDefinition?.id==="ndi-source");if(O&&window.electronAPI?.ndiUpdateSettings){const{captureWidth:R,captureHeight:F}=O.currentParams||{};R&&F&&window.electronAPI.ndiUpdateSettings({width:R,height:F})}},[Fa,kt]),T.useEffect(()=>{if(!window.electronAPI||!t)return;const O=window.electronAPI.onNdiFrame(R=>{Zn.current.forEach((F,k)=>{if(F===null)return;const H=Zt.current[k][F];H&&H.type==="generator"&&H.generatorDefinition?.id==="ndi-source"&&t.postMessage({type:"generate",layerIndex:k,colIndex:F,generator:H.generatorDefinition,params:{...H.generatorDefinition.defaultParams,...H.currentParams},ndiFrame:R,isLive:!0})}),kt?.type==="generator"&&kt?.generatorDefinition?.id==="ndi-source"&&t.postMessage({type:"generate",layerIndex:Ge,colIndex:ft,generator:kt.generatorDefinition,params:{...kt.generatorDefinition.defaultParams,...kt.currentParams},ndiFrame:R,isLive:!0})});return()=>O()},[Yt,Ue,kt,Ge,ft,Je,t]);const Fi=T.useCallback((O,R,F)=>{const k=O==="knob"?"knobs":"buttons",H=we.quickAssigns[k][R];if(H.link){const{layerIndex:ce,colIndex:ae,effectIndex:Ee,targetType:Oe}=H.link,Xe=H.link.paramName||H.link.paramId;let ge=F;if(O==="knob"&&H.min!==void 0&&H.max!==void 0&&(ge=H.min+F*(H.max-H.min),H.step&&(ge=Math.round(ge/H.step)*H.step),ge=parseFloat(ge.toFixed(5))),Oe==="global")Xe==="master_intensity"?Jr.current=ge:Xe==="master_speed"&&(Ul.current=ge);else if(Oe==="layerEffect")Dt.current[ce]&&Dt.current[ce][Ee]&&(Dt.current[ce][Ee].params[Xe]=ge);else if((Oe==="effect"||Oe==="generator")&&dt.current&&dt.current[ce]&&dt.current[ce][ae]){const ke=dt.current[ce][ae];Oe==="effect"&&ke.effects&&ke.effects[Ee]?ke.effects[Ee].params[Xe]=ge:Oe==="generator"&&ke.currentParams&&(ke.currentParams[Xe]=ge),Xn.current=!0}}xt(`quick-${O}-${R}`,{type:"UPDATE_QUICK_CONTROL",payload:{type:O,index:R,value:F}})},[we.quickAssigns,xt]),Sr=T.useCallback((O,R,F=127,k="noteon")=>{if(R===0&&!O.endsWith("_intensity")&&O!=="master_intensity"&&O!=="master_speed"&&!O.startsWith("clip_")&&O!=="bpm_value"&&O!=="bpm_fine_up"&&O!=="bpm_fine_down"&&!O.startsWith("quick_")&&!O.startsWith("dimmer_"))return;const H=R/F;switch(O){case"transport_play":R>0&&si();break;case"transport_pause":R>0&&yr();break;case"transport_stop":R>0&&Ii();break;case"comp_blackout":R>0&&se({type:"TOGGLE_GLOBAL_BLACKOUT"});break;case"comp_clear":R>0&&ii();break;case"master_intensity":Jr.current=H,xt("master_intensity",{type:"SET_MASTER_INTENSITY",payload:H});break;case"master_speed":const ce=Math.max(1,Math.round(H*120));xt("master_speed",{type:"SET_RENDER_SETTING",payload:{setting:"playbackFps",value:ce}});break;case"laser_output":R>0&&se({type:"TOGGLE_WORLD_OUTPUT_ACTIVE"});break;case"bpm_value":if(k==="controlchange"){let ae=0;R<=10?ae=R:R>=118&&(ae=R-128),ae!==0&&se({type:"SET_BPM",payload:Math.max(1,Math.min(999,(we.bpm||120)+ae))})}break;case"bpm_fine_up":R>0&&se({type:"SET_BPM",payload:Math.min(999,(we.bpm||120)+.1)});break;case"bpm_fine_down":R>0&&se({type:"SET_BPM",payload:Math.max(1,(we.bpm||120)-.1)});break;case"bpm_tap":break;default:if(O.startsWith("layer_")){const ae=O.split("_"),Ee=parseInt(ae[1]),Oe=ae[2];Oe==="blackout"&&R>0?se({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:Ee}}):Oe==="solo"&&R>0?se({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:Ee}}):Oe==="intensity"?(ja.current[Ee]=H,xt(`layer_${Ee}_intensity`,{type:"SET_LAYER_INTENSITY",payload:{layerIndex:Ee,intensity:H}})):Oe==="clear"&&R>0&&Na(Ee)}else if(O.startsWith("clip_")){const ae=O.split("_"),Ee=parseInt(ae[1]),Oe=parseInt(ae[2]);ae[3]==="preview"?R>0&&li(Ee,Oe):Va(Ee,Oe,R>0)}else if(O.startsWith("column_")){const ae=O.split("_"),Ee=parseInt(ae[1]);R>0&&Xa(Ee)}else if(O.startsWith("quick_knob_")){const ae=parseInt(O.split("_")[2]);Fi("knob",ae,H)}else if(O.startsWith("quick_btn_")){const ae=parseInt(O.split("_")[2]);R>0&&se({type:"TOGGLE_QUICK_BUTTON",payload:{index:ae}})}else if(O.startsWith("dimmer_")){const ae=O.replace("dimmer_","").replace(/_/g,"."),Ee=Tn[ae]||{};se({type:"SET_DAC_OUTPUT_SETTINGS",payload:{id:ae,settings:{...Ee,dimmer:H}}})}else{const ae=O.split("_");if(ae.length>=2&&Ge!==null&&ft!==null){const Ee=Ue[Ge][ft];if(Ee&&Ee.effects){const Oe=ae[0],Xe=ae.slice(1).join("_"),ge=Ee.effects.findIndex(ke=>ke.id===Oe);if(ge!==-1){const Me=Al.find(Te=>Te.id===Oe)?.paramControls.find(Te=>Te.id===Xe);if(Me){let Te=H;Me.type==="range"||Me.type==="number"?Te=Me.min+(Me.max-Me.min)*H:Me.type==="checkbox"&&(Te=H>.5),se({type:"UPDATE_EFFECT_PARAMETER",payload:{layerIndex:Ge,colIndex:ft,effectIndex:ge,paramName:Xe,newValue:Te}})}}}}}}},[si,yr,Ii,ii,Na,xn,we.bpm,li,Va,Xa,Ue,Ge,ft,Tn]),zl=T.useCallback(O=>{if(O==="world"){const F=!(we.worldShowBeamEffect??!0);if(se({type:"SET_RENDER_SETTING",payload:{setting:"worldShowBeamEffect",value:F}}),window.electronAPI&&window.electronAPI.setRenderSettings){const k={...we.renderSettings,showBeamEffect:we.showBeamEffect,beamRenderMode:we.beamRenderMode,previewScanRate:we.previewScanRate,beamAlpha:we.beamAlpha,fadeAlpha:we.fadeAlpha,worldShowBeamEffect:F,worldBeamRenderMode:we.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(k)}}else{const R=!Ia;if(se({type:"SET_RENDER_SETTING",payload:{setting:"showBeamEffect",value:R}}),window.electronAPI&&window.electronAPI.setRenderSettings){const F={showBeamEffect:R,beamRenderMode:sa,previewScanRate:Aa,beamAlpha:wa,fadeAlpha:Vn,worldShowBeamEffect:we.worldShowBeamEffect??!0,worldBeamRenderMode:we.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(F)}}},[Ia,sa,Aa,wa,Vn,we.worldShowBeamEffect,we.worldBeamRenderMode]),ji=T.useCallback(O=>{if(O==="world"){const R=we.worldBeamRenderMode??"both";let F="points";if(R==="both"?F="points":R==="points"?F="lines":R==="lines"&&(F="both"),se({type:"SET_RENDER_SETTING",payload:{setting:"worldBeamRenderMode",value:F}}),window.electronAPI&&window.electronAPI.setRenderSettings){const k={showBeamEffect:Ia,beamRenderMode:sa,previewScanRate:Aa,beamAlpha:wa,fadeAlpha:Vn,worldShowBeamEffect:we.worldShowBeamEffect??!0,worldBeamRenderMode:F};window.electronAPI.setRenderSettings(k)}}else{let R="points";if(sa==="both"?R="points":sa==="points"?R="lines":sa==="lines"&&(R="both"),se({type:"SET_RENDER_SETTING",payload:{setting:"beamRenderMode",value:R}}),window.electronAPI&&window.electronAPI.setRenderSettings){const F={showBeamEffect:Ia,beamRenderMode:R,previewScanRate:Aa,beamAlpha:wa,fadeAlpha:Vn,worldShowBeamEffect:we.worldShowBeamEffect??!0,worldBeamRenderMode:we.worldBeamRenderMode??"both"};window.electronAPI.setRenderSettings(F)}}},[Ia,sa,Aa,wa,Vn,we.worldShowBeamEffect,we.worldBeamRenderMode]),ui=T.useCallback(()=>{const O=!rn;se({type:"SET_WORLD_OUTPUT_ACTIVE",payload:O}),window.electronAPI&&(O?we.dacs.forEach(R=>{window.electronAPI.startDacOutput(R.ip,R.type)}):we.dacs.forEach(R=>{window.electronAPI.stopDacOutput(R.ip,R.type)}))},[rn,we.dacs]),Hl=async O=>{if(!(!window.electronAPI||!window.electronAPI.showOpenDialog))try{const R=await window.electronAPI.showOpenDialog({title:`Locate missing file: ${O.fileName}`,defaultPath:O.filePath,filters:[{name:"ILDA Files",extensions:["ild"]},{name:"All Files",extensions:["*"]}],properties:["openFile"]});if(R){const F=R,k=window.electronAPI.pathSeparator||(F.includes("/")?"/":"\\");if(se({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:O.filePath,newPath:F}}),O.type!=="audio"){const ge=await window.electronAPI.readFileForWorker(F);a&&a.postMessage({type:"file-content-response",requestId:O.requestId,arrayBuffer:ge},[ge])}At(ge=>ge.filter(ke=>ke.requestId!==O.requestId));const H=ge=>ge.substring(0,ge.lastIndexOf(k)),ce=ge=>ge.substring(ge.lastIndexOf(k)+1),ae=H(O.filePath),Ee=H(F);console.log(`[Relocate] Scanning for other files moving from [${ae}] to [${Ee}]`);const Oe=Ma.current.clipContents.flat().filter(ge=>ge),Xe=new Set([O.filePath]);for(const ge of Oe){if(ge.type==="ilda"&&ge.filePath&&!Xe.has(ge.filePath)&&H(ge.filePath)===ae){const ke=ce(ge.filePath),Me=`${Ee}${k}${ke}`;ge.filePath!==Me&&await window.electronAPI.checkFileExists(Me)&&(console.log(`[Relocate] Auto-resolving ILDA: ${ke}`),se({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:ge.filePath,newPath:Me}}),Xe.add(ge.filePath),a&&At(qe=>qe.filter(Ce=>Ce.filePath!==ge.filePath)))}if(ge.audioFile&&ge.audioFile.path&&!Xe.has(ge.audioFile.path)&&H(ge.audioFile.path)===ae){const ke=ce(ge.audioFile.path),Me=`${Ee}${k}${ke}`;ge.audioFile.path!==Me&&await window.electronAPI.checkFileExists(Me)&&(console.log(`[Relocate] Auto-resolving Audio: ${ke}`),se({type:"UPDATE_CLIP_FILE_PATH",payload:{oldPath:ge.audioFile.path,newPath:Me}}),Xe.add(ge.audioFile.path),At(qe=>qe.filter(Ce=>Ce.filePath!==ge.audioFile.path)))}}}}catch(R){console.error("Relocation failed:",R),Ft(`Relocation failed: ${R.message}`)}},pn=T.useCallback((O,R)=>{console.log(`Thumbnail load error for ${O}-${R}, requesting regeneration...`);const F=Zt.current[O][R];if(F)if(F.type==="ilda"&&F.workerId&&a){const k=Yn[O][R]||0;a.postMessage({type:"get-frame",workerId:F.workerId,frameIndex:k,isStillFrame:!0,layerIndex:O,colIndex:R})}else F.type==="generator"&&F.stillFrame&&mf(F.stillFrame,F.effects,O,R).then(k=>{k&&se({type:"SET_CLIP_CONTENT",payload:{layerIndex:O,colIndex:R,content:{thumbnailPath:k,thumbnailVersion:Date.now()}}})})},[Zt,Yn,a]),Za=T.useCallback((O,R)=>{const F=Zt.current[O][R];F&&F.audioFile&&At(k=>{const H=`audio-${O}-${R}`;return k.some(ce=>ce.requestId===H)?k:[...k,{filePath:F.audioFile.path,fileName:F.audioFile.name||F.audioFile.path.split(/[/\\]/).pop(),requestId:H,type:"audio"}]})},[Zt]);return m.jsx(Iv,{onMidiCommand:Sr,children:m.jsx(Bv,{onArtnetCommand:(O,R)=>Sr(O,R,255),children:m.jsxs(Fv,{onCommand:Sr,enabled:$.keyboard,children:[m.jsx(HS,{isPlaying:la,globalBlackout:mr,layerBlackouts:yn,layerSolos:Ht,isWorldOutputActive:rn,clipContents:Ue,activeClipIndexes:Yt,theme:vr,bpm:we.bpm,quickAssigns:we.quickAssigns}),m.jsx(Hy,{}),m.jsx("div",{className:"app",children:m.jsxs(Fy,{children:[m.jsx(wy,{message:Kr.message,visible:Kr.visible}),m.jsx(Uy,{show:G,onClose:()=>X(!1),dacs:On,dacSettings:Tn,onUpdateDacSettings:Bl}),m.jsx(Iy,{show:me||z,onClose:()=>{_(!1),ie(!1)},initialTab:z?"fft":"output"}),m.jsx(ky,{show:J,title:ve.title,initialValue:ve.initialValue,onSave:ve.onSave,onClose:()=>j(!1)||U(!1)}),m.jsx(By,{missingFiles:st,onRelocate:Hl,onClose:()=>At([])}),m.jsxs("div",{className:"main-content",children:[m.jsxs("div",{className:"top-bar-left-area",children:[m.jsx(Pv,{masterIntensity:we.masterIntensity,onMasterIntensityChange:O=>se({type:"SET_MASTER_INTENSITY",payload:O}),onClearAllActive:ii,isGlobalBlackout:mr,onToggleGlobalBlackout:()=>se({type:"TOGGLE_GLOBAL_BLACKOUT"})}),m.jsx(GS,{isWorldOutputActive:rn,onToggleWorldOutput:ui})]}),m.jsxs("div",{className:"layer-controls-container",children:[Je.map((O,R)=>{const F=Fa.find(H=>{const ce=Yt[R];if(ce===null)return!1;const ae=Ue[R][ce];return ae?ae.type==="ilda"?H.workerId===ae.workerId:ae.type==="generator"?H.workerId===`generator-${R}-${ce}`:!1:!1})||null,k=F?D.current[F.workerId]:null;return m.jsx(sy,{layerName:O,index:R,onDropEffect:H=>br(R,H),onDropDac:(H,ce)=>Pl(H,ce),layerEffects:qn[R],activeClipData:F,liveFrame:k,thumbnailRenderMode:Ba,intensity:we.layerIntensities[R],onIntensityChange:H=>se({type:"SET_LAYER_INTENSITY",payload:{layerIndex:R,intensity:H}}),onDeactivateLayerClips:()=>Na(R),onShowLayerFullContextMenu:()=>Ds(R),isBlackout:yn[R],isSolo:Ht[R],onToggleBlackout:()=>se({type:"TOGGLE_LAYER_BLACKOUT",payload:{layerIndex:R}}),onToggleSolo:()=>se({type:"TOGGLE_LAYER_SOLO",payload:{layerIndex:R}}),onLayerSelect:H=>se({type:"SET_SELECTED_CLIP",payload:{layerIndex:H,colIndex:null}})},R)}),"          "]}),m.jsx("div",{className:"clip-deck-container",children:m.jsxs("div",{className:"clip-deck",children:[m.jsx("div",{className:"column-headers-container",children:Rt.map((O,R)=>m.jsx(Gv,{name:O,index:R,onTrigger:()=>Xa(R),onShowColumnHeaderContextMenu:()=>Gl(R)},R))}),Je.map((O,R)=>m.jsx("div",{className:"layer-row",children:Rt.map((F,k)=>{const H=Ue?.[R]?.[k];let ce=null;H&&H.type==="ilda"?ce=H.workerId:H&&H.type==="generator"&&(ce=`generator-${R}-${k}`);const ae=ce?D.current[ce]:null,Ee=H?.stillFrame||(H?.type==="generator"?H.frames?.[0]:null);return m.jsx(oy,{layerIndex:R,colIndex:k,clipName:vn?.[R]?.[k]||`Clip ${R+1}-${k+1}`,clipContent:H,thumbnailFrameIndex:Yn[R][k],thumbnailRenderMode:Ba,liveFrame:ae,stillFrame:Ee,onActivateClick:Oe=>Va(R,k,Oe),isActive:Yt[R]===k,onUnsupportedFile:Ft,onDropEffect:Oe=>Rs(R,k,Oe),onDropGenerator:jl,onDropDac:(Oe,Xe,ge)=>{xr(Oe,Xe,ge)},onLabelClick:()=>li(R,k),isSelected:Ge===R&&ft===k,ildaParserWorker:a,onClipHover:Bi,onThumbnailError:pn},k)})},R))]})}),m.jsx(qS,{clipContents:Ue,activeClipIndexes:Yt,layerEffects:qn,bpm:we.bpm,playbackFps:kn,selectedLayerIndex:Ge,selectedColIndex:ft,liveFramesRef:D,progressRef:M,selectedDac:An,liveDacOutputSettingsRef:dn,dacOutputSettings:Tn,getAudioInfo:A,fftLevels:i,getFftLevels:l,effectStatesRef:L,clipActivationTimesRef:C,showBeamEffect:Ia,beamAlpha:wa,fadeAlpha:Vn,previewScanRate:Aa,beamRenderMode:sa,worldShowBeamEffect:ws,worldBeamRenderMode:As,masterIntensity:Di,layerIntensities:Ea,globalBlackout:mr,layerSolos:Ht,layerBlackouts:yn,handleToggleBeamEffect:zl,handleCycleDisplayMode:ji,previewFrameCountRef:Ie,totalPointsSentRef:Ke,activeChannelsCountRef:rt,lastStatUpdateTimeRef:mt,liveClipContentsRef:dt}),m.jsxs("div",{className:"middle-bar",children:[m.jsx("div",{className:"middle-bar-left-area",children:m.jsx(Ny,{bpm:we.bpm,onBpmChange:O=>se({type:"SET_BPM",payload:O})})}),m.jsxs("div",{className:"middle-bar-mid-area",children:[m.jsx(Ry,{onPlay:si,onPause:yr,onStop:Ii,isPlaying:la,isStopped:we.isStopped}),m.jsx(PS,{playbackFps:kn,onSpeedChange:xn})]}),m.jsx("div",{className:"middle-bar-right-area"})]}),m.jsxs("div",{className:"bottom-panel",children:[m.jsxs("div",{className:"bottom-panel-tabs-container-1",children:[m.jsxs("div",{className:"bottom-panel-tabs-1",children:[m.jsx("button",{className:`tab-button-1 ${he==="files"?"active":""}`,onClick:()=>xe("files"),children:"Files"}),m.jsx("button",{className:`tab-button-1 ${he==="generators"?"active":""}`,onClick:()=>xe("generators"),children:"Generators"}),m.jsx("button",{className:`tab-button-1 ${he==="effects"?"active":""}`,onClick:()=>xe("effects"),children:"Effects"})]}),m.jsxs("div",{className:"bottom-panel-tab-content-1",children:[he==="files"&&m.jsx(cy,{onDropIld:(O,R,F)=>a.postMessage({type:"parse-ilda",file:F,layerIndex:O,colIndex:R})}),he==="generators"&&m.jsx(fy,{}),he==="effects"&&m.jsx(dy,{})]})]}),m.jsxs("div",{className:"bottom-panel-tabs-container-2",children:[m.jsxs("div",{className:"bottom-panel-tabs-2",children:[m.jsx("button",{className:`tab-button-2 ${Ye==="clip"?"active":""}`,onClick:()=>Be("clip"),children:"Clip-Settings"}),m.jsx("button",{className:`tab-button-2 ${Ye==="layer"?"active":""}`,onClick:()=>Be("layer"),children:"Layer-Settings"})]}),m.jsxs("div",{className:"bottom-panel-tab-content-2",children:[Ye==="clip"&&m.jsx(Sy,{selectedLayerIndex:Ge,selectedColIndex:ft,clip:kt,audioInfo:A(Ge),bpm:we.bpm,getFftLevels:l,onAssignAudio:async()=>{const O=await window.electronAPI.showAudioFileDialog();if(O){const R=O.split(/[\\/]/).pop();se({type:"SET_CLIP_AUDIO",payload:{layerIndex:Ge,colIndex:ft,audioFile:{path:O,name:R}}})}},onRemoveAudio:()=>{g(Ge),se({type:"REMOVE_CLIP_AUDIO",payload:{layerIndex:Ge,colIndex:ft}})},onUpdateAudioVolume:(O,R,F)=>{se({type:"SET_CLIP_AUDIO_VOLUME",payload:{layerIndex:O,colIndex:R,volume:F}}),N(O,F)},onUpdatePlaybackSettings:(O,R,F)=>se({type:"UPDATE_CLIP_PLAYBACK_SETTINGS",payload:{layerIndex:O,colIndex:R,settings:F}}),onSetParamSync:(O,R)=>se({type:"SET_CLIP_PARAM_SYNC",payload:{layerIndex:Ge,colIndex:ft,paramId:O,syncMode:R}}),onToggleDacMirror:(O,R,F,k)=>se({type:"TOGGLE_CLIP_DAC_MIRROR",payload:{layerIndex:O,colIndex:R,dacIndex:F,axis:k}}),onRemoveDac:O=>se({type:"REMOVE_CLIP_DAC",payload:{layerIndex:Ge,colIndex:ft,dacIndex:O}}),onRemoveEffect:(O,R,F)=>se({type:"REMOVE_CLIP_EFFECT",payload:{layerIndex:O,colIndex:R,effectIndex:F}}),onReorderEffects:(O,R,F,k)=>se({type:"REORDER_CLIP_EFFECTS",payload:{layerIndex:O,colIndex:R,oldIndex:F,newIndex:k}}),onAddEffect:O=>se({type:"ADD_CLIP_EFFECT",payload:{layerIndex:Ge,colIndex:ft,effect:O}}),onParameterChange:Fl,onGeneratorParameterChange:oi,progressRef:M,onAudioError:Za}),Ye==="layer"&&m.jsx(Ey,{selectedLayerIndex:Ge,autopilotMode:Ge!==null?we.layerAutopilots[Ge]:"off",onAutopilotChange:O=>se({type:"SET_LAYER_AUTOPILOT",payload:{layerIndex:Ge,mode:O}}),layerEffects:Ge!==null?qn[Ge]:[],assignedDacs:Ge!==null&&we.layerAssignedDacs?we.layerAssignedDacs[Ge]:[],onToggleDacMirror:(O,R,F)=>se({type:"TOGGLE_LAYER_DAC_MIRROR",payload:{layerIndex:O,dacIndex:R,axis:F}}),onRemoveDac:(O,R)=>se({type:"REMOVE_LAYER_DAC",payload:{layerIndex:O,dacIndex:R}}),onAddEffect:O=>Ge!==null&&se({type:"ADD_LAYER_EFFECT",payload:{layerIndex:Ge,effect:O}}),onRemoveEffect:O=>Ge!==null&&se({type:"REMOVE_LAYER_EFFECT",payload:{layerIndex:Ge,effectIndex:O}}),onParamChange:(O,R,F)=>Ge!==null&&se({type:"UPDATE_LAYER_EFFECT_PARAMETER",payload:{layerIndex:Ge,effectIndex:O,paramName:R,newValue:F}})})]})]}),m.jsx(py,{dacs:On,onDacSelected:ca,onDacsDiscovered:_s,dacSettings:Tn,onUpdateDacSettings:Bl}),m.jsx(Oy,{enabledShortcuts:$,onOpenOutputSettings:()=>X(!0),onOpenShortcutsSettings:()=>j(!0),quickAssigns:we.quickAssigns,onUpdateKnob:(O,R)=>{Fi("knob",O,R)},onToggleButton:O=>{const F=we.quickAssigns.buttons[O].link;F&&(F.targetType==="transport"?F.paramName==="play"?si():F.paramName==="pause"?yr():F.paramName==="stop"&&Ii():F.targetType==="global"?F.paramName==="laser_output"?ui():F.paramName==="clear"&&ii():Xn.current=!0),se({type:"TOGGLE_QUICK_BUTTON",payload:{index:O}})},onAssign:(O,R,F)=>se({type:"ASSIGN_QUICK_CONTROL",payload:{type:O,index:R,link:F}})})]}),m.jsx("div",{className:"SystemMonitor",children:m.jsx(YS,{playbackFps:kn,previewScanRate:Aa,previewFrameCountRef:Ie,totalPointsSentRef:Ke,activeChannelsCountRef:rt,lastStatUpdateTimeRef:mt})})]})]})})]})})})}Tv.createRoot(document.getElementById("root")).render(m.jsx(Ay,{children:m.jsx(uy,{children:m.jsxs(jy,{children:[" ",m.jsx(by,{children:m.jsx(VS,{})})]})})}));
